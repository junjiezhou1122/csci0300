"use strict";var _De=Object.create;var RT=Object.defineProperty;var Zte=Object.getOwnPropertyDescriptor;var xDe=Object.getOwnPropertyNames;var SDe=Object.getPrototypeOf,IDe=Object.prototype.hasOwnProperty;var R=(t,e)=>()=>(t&&(e=t(t=0)),e);var M=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),mn=(t,e)=>{for(var r in e)RT(t,r,{get:e[r],enumerable:!0})},ere=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of xDe(e))!IDe.call(t,o)&&o!==r&&RT(t,o,{get:()=>e[o],enumerable:!(n=Zte(e,o))||n.enumerable});return t};var z=(t,e,r)=>(r=t!=null?_De(SDe(t)):{},ere(e||!t||!t.__esModule?RT(r,"default",{value:t,enumerable:!0}):r,t)),$i=t=>ere(RT({},"__esModule",{value:!0}),t),O=(t,e,r,n)=>{for(var o=n>1?void 0:n?Zte(e,r):e,s=t.length-1,a;s>=0;s--)(a=t[s])&&(o=(n?a(e,r,o):a(o))||o);return n&&o&&RT(e,r,o),o},x=(t,e)=>(r,n)=>e(r,n,t);var Qt=M((rut,ire)=>{"use strict";var tU=Object.defineProperty,CDe=Object.getOwnPropertyDescriptor,EDe=Object.getOwnPropertyNames,TDe=Object.prototype.hasOwnProperty,wDe=(t,e)=>{for(var r in e)tU(t,r,{get:e[r],enumerable:!0})},RDe=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of EDe(e))!TDe.call(t,o)&&o!==r&&tU(t,o,{get:()=>e[o],enumerable:!(n=CDe(e,o))||n.enumerable});return t},kDe=t=>RDe(tU({},"__esModule",{value:!0}),t),rre={};wDe(rre,{config:()=>LDe,t:()=>nre});ire.exports=kDe(rre);var PDe=require("fs"),ADe=require("fs/promises");async function DDe(t){if(t.protocol==="file:")return await(0,ADe.readFile)(t,"utf8");if(t.protocol==="http:"||t.protocol==="https:"){let e=await fetch(t.toString(),{headers:{"Accept-Encoding":"gzip, deflate",Accept:"application/json"},redirect:"follow"});if(!e.ok){let n=`Unexpected ${e.status} response while trying to read ${t}`;try{n+=`: ${await e.text()}`}catch{}throw new Error(n)}return await e.text()}throw new Error("Unsupported protocol")}function NDe(t){return(0,PDe.readFileSync)(t,"utf8")}var kT;function LDe(t){if("contents"in t){typeof t.contents=="string"?kT=JSON.parse(t.contents):kT=t.contents;return}if("fsPath"in t){let e=NDe(t.fsPath),r=JSON.parse(e);kT=tre(r)?r.contents.bundle:r;return}if(t.uri){let e=t.uri;return typeof t.uri=="string"&&(e=new URL(t.uri)),new Promise((r,n)=>{let o=DDe(e).then(s=>{try{let a=JSON.parse(s);kT=tre(a)?a.contents.bundle:a}catch(a){n(a)}}).catch(s=>{n(s)});r(o)})}}function nre(...t){let e=t[0],r,n,o;if(typeof e=="string")r=e,n=e,t.splice(0,1),o=!t||typeof t[0]!="object"?t:t[0];else if(e instanceof Array){let a=t.slice(1);if(e.length!==a.length+1)throw new Error("expected a string as the first argument to l10n.t");let c=e[0];for(let u=1;u<e.length;u++)c+=`{${u-1}}`+e[u];return nre(c,...a)}else n=e.message,r=n,e.comment&&e.comment.length>0&&(r+=`/${Array.isArray(e.comment)?e.comment.join(""):e.comment}`),o=e.args??{};let s=kT?.[r];return s?typeof s=="string"?DA(s,o):s.comment?DA(s.message,o):DA(n,o):DA(n,o)}var ODe=/{([^}]+)}/g;function DA(t,e){return Object.keys(e).length===0?t:t.replace(ODe,(r,n)=>e[n]??r)}function tre(t){return typeof t?.contents?.bundle=="object"&&typeof t?.version=="string"}});var YT=M(od=>{"use strict";Object.defineProperty(od,"__esModule",{value:!0});od.BaseTokensPerName=od.BaseTokensPerMessage=od.BaseTokensPerCompletion=od.ChatRole=void 0;var one;(function(t){t.System="system",t.User="user",t.Assistant="assistant",t.Function="function"})(one||(od.ChatRole=one={}));od.BaseTokensPerCompletion=3;od.BaseTokensPerMessage=3;od.BaseTokensPerName=1});var ane=M(()=>{"use strict";function JNe(t,e,...r){return{ctor:t,props:e,children:r.flat()}}function sne(){throw new Error("This should not be invoked!")}sne.isFragment=!0;globalThis.vscpp=JNe;globalThis.vscppf=sne});var MU=M(_D=>{"use strict";Object.defineProperty(_D,"__esModule",{value:!0});_D.PromptElement=void 0;ane();var OU=class{get priority(){return this.props.priority??Number.MAX_SAFE_INTEGER}get insertLineBreakBefore(){return!0}constructor(e){this.props=e}};_D.PromptElement=OU});var HU=M(Lo=>{"use strict";Object.defineProperty(Lo,"__esModule",{value:!0});Lo.PrioritizedList=Lo.TextChunk=Lo.FunctionMessage=Lo.AssistantMessage=Lo.UserMessage=Lo.SystemMessage=Lo.BaseChatMessage=Lo.isChatMessagePromptElement=void 0;var CD=YT(),qU=MU();function ZNe(t){return t instanceof xD||t instanceof SD||t instanceof ID}Lo.isChatMessagePromptElement=ZNe;var D0=class extends qU.PromptElement{render(){return vscpp(vscppf,null,this.props.children)}};Lo.BaseChatMessage=D0;var xD=class extends D0{constructor(e){e.role=CD.ChatRole.System,super(e)}};Lo.SystemMessage=xD;var SD=class extends D0{constructor(e){e.role=CD.ChatRole.User,super(e)}};Lo.UserMessage=SD;var ID=class extends D0{constructor(e){e.role=CD.ChatRole.Assistant,super(e)}};Lo.AssistantMessage=ID;var eLe=/\s+/g,FU=class extends D0{constructor(e){e.role=CD.ChatRole.Function,super(e)}};Lo.FunctionMessage=FU;var UU=class extends qU.PromptElement{async prepare(e,r,n){let o=this.props.breakOnWhitespace?eLe:this.props.breakOn;if(!o)return vscpp(vscppf,null,this.props.children);let s="",a=[];for(let u of this.props.children||[])if(u&&typeof u=="object"){if(typeof u.ctor!="string")throw new Error("TextChunk children must be text literals or intrinsic attributes.");u.ctor==="br"?s+=`
`:a.push(u)}else u!=null&&(s+=u);let c=await tLe(e,o,s,n);return vscpp(vscppf,null,a,c)}render(e){return e}};Lo.TextChunk=UU;async function tLe(t,e,r,n){if(e instanceof RegExp){if(!e.global)throw new Error(`\`breakOn\` expression must have the global flag set (got ${e})`);e.lastIndex=0}let o="",s=-1;for(;s<r.length;){let a;typeof e=="string"?a=r.indexOf(e,s===-1?0:s+e.length):a=e.exec(r)?.index??-1,a===-1&&(a=r.length);let c=o+r.slice(Math.max(0,s),a);if(await t.countTokens(c,n)>t.tokenBudget)return o;o=c,s=a}return o}var BU=class extends qU.PromptElement{render(){let e=this.props.children;if(e)return vscpp(vscppf,null,e.map((r,n)=>(r.props??(r.props={}),r.props.priority=this.props.descending?this.props.priority-n:this.props.priority-e.length+n,r)))}};Lo.PrioritizedList=BU});var cne=M(ED=>{"use strict";Object.defineProperty(ED,"__esModule",{value:!0});ED.coalesce=void 0;function rLe(t){return t.filter(e=>!!e)}ED.coalesce=rLe});var YU=M(j_=>{"use strict";Object.defineProperty(j_,"__esModule",{value:!0});j_.PromptRenderer=j_.MetadataMap=void 0;var TD=HU(),QT=cne(),une;(function(t){t.empty={get:()=>{}}})(une||(j_.MetadataMap=une={}));var jU=class{constructor(e,r,n,o){this._endpoint=e,this._ctor=r,this._props=n,this._tokenizer=o,this._meta=new Map,this._usedContext=[],this._ignoredFiles=[],this._root=new WU(null,0),this._references=[]}getAllMeta(){let e=this._meta;return{get(r){return e.get(r)}}}getIgnoredFiles(){return Array.from(new Set(this._ignoredFiles))}getMeta(e){return this._meta.get(e)}getUsedContext(){return this._usedContext}createElement(e){return new e.ctor(e.props)}async _processPromptPieces(e,r,n,o){let s=new Map;for(let[u,l]of r.entries()){if(Array.isArray(l.children)&&(l.props=l.props??{},l.props.children=l.children),!l.ctor)throw new Error("Invalid ChatMessage child! Child must be a TSX component that extends PromptElement.");let d=this.createElement(l);l.node.setObj(d);let p=l.props.flexGrow??1/0,f=s.get(p);f||(f=[],s.set(p,f)),f.push({element:l,promptElementInstance:d})}let a=[...s.entries()].sort(([u],[l])=>l-u).map(([u,l])=>l),c=(u,l)=>{let d=l?1:-1;for(let p=u+1;p<a.length;p++)for(let{element:f}of a[p])f.props.flexReserve&&e.consume(d*f.props.flexReserve)};for(let[u,l]of a.entries()){c(u,!0);let d=0;for(let{element:m}of l)d+=(m.props.flex||m.props.flexBasis)??1;let p=l.map(m=>{let h=(m.element.props.flexBasis??1)/d;return{tokenBudget:Math.floor(e.remainingTokenBudget*h),endpoint:e.endpoint,countTokens:(g,v)=>this._tokenizer.tokenLength(g,v)}});c(u,!1),await Promise.all(l.map(async({element:m,promptElementInstance:h},g)=>{let v=await h.prepare?.(p[g],n,o);m.node.setState(v)}));let f=await Promise.all(l.map(async({element:m,promptElementInstance:h},g)=>{let v=p[g];return await h.render(m.node.getState(),v)}));for(let[m,{element:h,promptElementInstance:g}]of l.entries()){let v=p[m],y=f[m];if(!y)continue;let b=lne(y),_=new wD(v.tokenBudget,this._endpoint),{tokensConsumed:S}=await nLe(this._tokenizer,h,g,b);_.consume(S),await this._handlePromptChildren(h,b,_,n,o),e.consume(_.consumed)}}}async _prioritize(e,r,n){let o=[],s=[],a=0;for(;a<e.length;){if(!e[a].isImplicitLinebreak){let l=e[a-1]?.isImplicitLinebreak?{index:a,precedingLinebreak:a-1}:{index:a};o.push(l),s[a]=null}a+=1}o.sort((l,d)=>r(e[l.index],e[d.index]));let c=this._endpoint.modelMaxPromptTokens,u=[];for(;o.length>0;){let l=o.shift(),d=l.index,p=e[d],f=await n(p),m;if(l.precedingLinebreak&&(m=e[l.precedingLinebreak],f+=await n(m)),f>c){u.push(p);break}s[d]=p,l.precedingLinebreak&&m&&(s[l.precedingLinebreak]=m),c-=f}for(let l of o){let d=l.index,p=e[d];u.push(p)}return{result:(0,QT.coalesce)(s),tokenCount:this._endpoint.modelMaxPromptTokens-c,omittedChunks:u}}async render(e,r){await this._processPromptPieces(new wD(this._endpoint.modelMaxPromptTokens,this._endpoint),[{node:this._root,ctor:this._ctor,props:this._props,children:[]}],e,r);let{result:n,resultChunks:o}=this._root.materialize(),s=new Set,{result:a,omittedChunks:c}=await this._prioritize(o,(v,y)=>N0.cmp(v,y),async v=>{let y=await this._tokenizer.tokenLength(v.text);return s.has(v.message)||(s.add(v.message),y=await this._tokenizer.countMessageTokens(v.toChatMessage())),y}),u=new Map;for(let v of(0,QT.coalesce)(a)){let y=u.get(v.message)??[];y[v.childIndex]=v,u.set(v.message,y)}let l=[];for(let v of n){let y=u.get(v);if(y){v.chunks=(0,QT.coalesce)(y);for(let b of y)b&&b.references.length>0&&v.references.push(...b.references);l.push(v)}}let{result:d,tokenCount:p}=await this._prioritize(l,(v,y)=>RD.cmp(v,y),async v=>this._tokenizer.countMessageTokens(v.toChatMessage())),f=d.map(v=>v?.toChatMessage()),{references:m,names:h}=d.reduce((v,y)=>([...this._references,...y.references].forEach(b=>{let _="variableName"in b.anchor;_&&!v.names.has(b.anchor.variableName)?(v.references.push(b),v.names.add(b.anchor.variableName)):_||v.references.push(b)}),v),{references:[],names:new Set}),{references:g}=c.reduce((v,y)=>(y.references.forEach(b=>{let _="variableName"in b.anchor;_&&!h.has(b.anchor.variableName)?(v.references.push(b),h.add(b.anchor.variableName)):_||v.references.push(b)}),v),{references:[]});return{messages:f,hasIgnoredFiles:this._ignoredFiles.length>0,tokenCount:p,references:(0,QT.coalesce)(m),omittedReferences:(0,QT.coalesce)(g)}}_handlePromptChildren(e,r,n,o,s){if(e.ctor===TD.TextChunk){this._handleExtrinsicTextChunkChildren(e.node.parent,e.node,e.props,r);return}let a=[];for(let c of r){if(c.kind==="literal"){e.node.appendStringChild(c.value,e.props.priority??Number.MAX_SAFE_INTEGER);continue}if(c.kind==="intrinsic"){this._handleIntrinsic(e.node,c.name,{priority:e.props.priority??Number.MAX_SAFE_INTEGER,...c.props},VU(c.children));continue}let u=e.node.createChild();a.push({node:u,ctor:c.ctor,props:{priority:e.props.priority,...c.props},children:c.children})}return this._processPromptPieces(n,a,o,s)}_handleIntrinsic(e,r,n,o,s){switch(r){case"meta":return this._handleIntrinsicMeta(e,n,o);case"br":return this._handleIntrinsicLineBreak(e,n,o,n.priority,s);case"usedContext":return this._handleIntrinsicUsedContext(e,n,o);case"references":return this._handleIntrinsicReferences(e,n,o);case"ignoredFiles":return this._handleIntrinsicIgnoredFiles(e,n,o)}throw new Error(`Unknown intrinsic element ${r}!`)}_handleIntrinsicMeta(e,r,n){if(n.length>0)throw new Error("<meta /> must not have children!");let o=Object.getPrototypeOf(r.value).constructor;if(this._meta.has(o))throw new Error(`Duplicate metadata ${o.name}!`);this._meta.set(o,r.value)}_handleIntrinsicLineBreak(e,r,n,o,s){if(n.length>0)throw new Error("<br /> must not have children!");e.appendLineBreak(!0,o??Number.MAX_SAFE_INTEGER,s)}_handleIntrinsicUsedContext(e,r,n){if(n.length>0)throw new Error("<usedContext /> must not have children!");this._usedContext.push(...r.value)}_handleIntrinsicReferences(e,r,n){if(n.length>0)throw new Error("<reference /> must not have children!");e.addReferences(r.value),this._references.push(...r.value)}_handleIntrinsicIgnoredFiles(e,r,n){if(n.length>0)throw new Error("<ignoredFiles /> must not have children!");this._ignoredFiles.push(...r.value)}_handleExtrinsicTextChunkChildren(e,r,n,o){let s=[],a=[];for(let c of o){if(c.kind==="extrinsic")throw new Error("TextChunk cannot have extrinsic children!");c.kind==="literal"&&s.push(c.value),c.kind==="intrinsic"&&(c.name==="br"?s.push(`
`):c.name==="references"?a.push(...c.props.value):this._handleIntrinsic(e,c.name,c.props,VU(c.children),r.childIndex))}e.appendLineBreak(!1,void 0,r.childIndex),e.appendStringChild(s.join(""),n?.priority??Number.MAX_SAFE_INTEGER,a,r.childIndex)}};j_.PromptRenderer=jU;async function nLe(t,e,r,n){let o=0;if((0,TD.isChatMessagePromptElement)(r)){o+=await t.countMessageTokens({role:e.props.role,content:"",...e.props.name?{name:e.props.name}:void 0});for(let s of n)s.kind==="literal"&&(o+=await t.tokenLength(s.value))}return{tokensConsumed:o}}function lne(t){return typeof t>"u"||typeof t=="boolean"?[]:typeof t=="string"||typeof t=="number"?[new $U(String(t))]:iLe(t)?[...VU(t.children)]:typeof t.ctor=="string"?[new GU(t.ctor,t.props,t.children)]:[new zU(t.ctor,t.props,t.children)]}function VU(t){return(t??[]).reduce((e,r)=>(e.push(...lne(r)),e),[])}var GU=class{constructor(e,r,n){this.name=e,this.props=r,this.children=n,this.kind="intrinsic"}},zU=class{constructor(e,r,n){this.ctor=e,this.props=r,this.children=n,this.kind="extrinsic"}},$U=class{constructor(e,r){this.value=e,this.priority=r,this.kind="literal"}},wD=class{constructor(e,r){this.tokenBudget=e,this.endpoint=r,this._consumed=0}get consumed(){return this._consumed>this.tokenBudget?this.tokenBudget:this._consumed}get remainingTokenBudget(){return Math.max(0,this.tokenBudget-this._consumed)}consume(e){this._consumed+=e}},WU=class t{constructor(e=null,r){this.parent=e,this.childIndex=r,this.kind=0,this._obj=null,this._state=void 0,this._children=[],this._references=[]}setObj(e){this._obj=e}setState(e){this._state=e}getState(){return this._state}createChild(){let e=new t(this,this._children.length);return this._children.push(e),e}appendStringChild(e,r,n,o=this._children.length){this._children.push(new KU(this,o,e,r,n))}appendLineBreak(e=!0,r,n=this._children.length){this._children.push(new kD(this,n,e,r))}materialize(){let e=[],r=[];return this._materialize(e,r),{result:e,resultChunks:r}}_materialize(e,r){if(this._children.sort((n,o)=>n.childIndex-o.childIndex),this._obj instanceof TD.BaseChatMessage){if(!this._obj.props.role)throw new Error("Invalid ChatMessage!");let n=[];for(let c of this._children)c.collectLeafs(n);let o=[],s=new RD(this._obj.props.role,this._obj.props.name,this._obj.props.priority,this.childIndex,o),a=r.length;n.forEach((c,u)=>{c.kind===1?o.push(new N0(s,c.text,c.priority,a++,!1,c.references??this._references)):c.isExplicit?o.push(new N0(s,`
`,c.priority,a++)):(o.length>0&&o[o.length-1].text!==`
`||o[u-1]&&o[u-1].text!==`
`)&&o.push(new N0(s,`
`,c.priority,a++,!0))}),r.push(...o),e.push(s)}else for(let n of this._children){if(n.kind===1)throw new Error(`Cannot have a text node outside a ChatMessage. Text: "${n.text}"`);if(n.kind===2)throw new Error("Cannot have a line break node outside a ChatMessage!");n._materialize(e,r)}}collectLeafs(e){if(this._obj instanceof TD.BaseChatMessage)throw new Error("Cannot have a ChatMessage nested inside a ChatMessage!");this._obj?.insertLineBreakBefore&&e.push(new kD(this,0,!1));for(let r of this._children)r.collectLeafs(e)}addReferences(e){this._references.push(...e)}},N0=class{constructor(e,r,n,o,s=!1,a=[]){this.message=e,this.text=r,this.priority=n,this.childIndex=o,this.isImplicitLinebreak=s,this.references=a}static cmp(e,r){return e.priority!==void 0&&r.priority!==void 0&&e.priority===r.priority?e.message===r.message?e.childIndex-r.childIndex:r.childIndex-e.childIndex:e.priority!==void 0&&r.priority!==void 0&&e.priority!==r.priority?r.priority-e.priority:e.childIndex-r.childIndex}toChatMessage(){return{role:this.message.role,content:this.text,...this.message.name?{name:this.message.name}:{}}}},RD=class{constructor(e,r,n,o,s,a=[]){this.role=e,this.name=r,this.priority=n,this.childIndex=o,this._chunks=s,this.references=a}set chunks(e){this._chunks=e.sort(N0.cmp)}get text(){return this._chunks.reduce((e,r,n)=>((n!==this._chunks.length-1||!r.isImplicitLinebreak)&&(e+=r.text),e),"")}toChatMessage(){return{role:this.role,content:this.text,...this.name?{name:this.name}:{}}}static cmp(e,r){return e.priority!==r.priority?(r.priority||0)-(e.priority||0):r.childIndex-e.childIndex}},KU=class{constructor(e,r,n,o,s){this.parent=e,this.childIndex=r,this.text=n,this.priority=o,this.references=s,this.kind=1}collectLeafs(e){e.push(this)}},kD=class{constructor(e,r,n,o){this.parent=e,this.childIndex=r,this.isExplicit=n,this.priority=o,this.kind=2}collectLeafs(e){e.push(this)}};function iLe(t){return(typeof t.ctor=="function"&&t.ctor.isFragment)??!1}});var dne=M(AD=>{"use strict";Object.defineProperty(AD,"__esModule",{value:!0});AD.AnyTokenizer=void 0;var PD=YT(),QU=class{constructor(e){this.countTokens=e}async tokenLength(e,r){return this.countTokens(e,r)}async countMessageTokens(e){return this.countTokens({role:this.toChatRole(e.role),content:e.content,name:e.name})}toChatRole(e){switch(e){case PD.ChatRole.User:return 1;case PD.ChatRole.Assistant:return 2;case PD.ChatRole.System:return 1;case PD.ChatRole.Function:return 1}}};AD.AnyTokenizer=QU});var fne=M(ih=>{"use strict";Object.defineProperty(ih,"__esModule",{value:!0});ih.PromptReference=ih.ChatResponseReferencePartStatusKind=ih.PromptMetadata=void 0;var XU=class{toString(){return Object.getPrototypeOf(this).constructor.name}};ih.PromptMetadata=XU;var pne;(function(t){t[t.Complete=1]="Complete",t[t.Partial=2]="Partial",t[t.Omitted=3]="Omitted"})(pne||(ih.ChatResponseReferencePartStatusKind=pne={}));var JU=class{constructor(e,r,n){this.anchor=e,this.iconPath=r,this.options=n}};ih.PromptReference=JU});var hne=M(mne=>{"use strict";Object.defineProperty(mne,"__esModule",{value:!0})});var vne=M(gne=>{"use strict";Object.defineProperty(gne,"__esModule",{value:!0})});var at=M(Dr=>{"use strict";var oLe=Dr&&Dr.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),eB=Dr&&Dr.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&oLe(e,t,r)};Object.defineProperty(Dr,"__esModule",{value:!0});Dr.toVsCodeChatMessages=Dr.renderPrompt=Dr.PromptRenderer=Dr.MetadataMap=Dr.PromptElement=Dr.UserMessage=Dr.TextChunk=Dr.SystemMessage=Dr.PrioritizedList=Dr.FunctionMessage=Dr.AssistantMessage=Dr.ChatRole=void 0;var ZU=YT(),sLe=YU(),aLe=dne(),cLe=YT();Object.defineProperty(Dr,"ChatRole",{enumerable:!0,get:function(){return cLe.ChatRole}});eB(fne(),Dr);eB(hne(),Dr);eB(vne(),Dr);var V_=HU();Object.defineProperty(Dr,"AssistantMessage",{enumerable:!0,get:function(){return V_.AssistantMessage}});Object.defineProperty(Dr,"FunctionMessage",{enumerable:!0,get:function(){return V_.FunctionMessage}});Object.defineProperty(Dr,"PrioritizedList",{enumerable:!0,get:function(){return V_.PrioritizedList}});Object.defineProperty(Dr,"SystemMessage",{enumerable:!0,get:function(){return V_.SystemMessage}});Object.defineProperty(Dr,"TextChunk",{enumerable:!0,get:function(){return V_.TextChunk}});Object.defineProperty(Dr,"UserMessage",{enumerable:!0,get:function(){return V_.UserMessage}});var uLe=MU();Object.defineProperty(Dr,"PromptElement",{enumerable:!0,get:function(){return uLe.PromptElement}});var yne=YU();Object.defineProperty(Dr,"MetadataMap",{enumerable:!0,get:function(){return yne.MetadataMap}});Object.defineProperty(Dr,"PromptRenderer",{enumerable:!0,get:function(){return yne.PromptRenderer}});async function lLe(t,e,r,n,o,s,a="vscode"){let c="countTokens"in n?new aLe.AnyTokenizer((h,g)=>n.countTokens(h,g)):n,u=new sLe.PromptRenderer(r,t,e,c),{messages:l,tokenCount:d,references:p}=await u.render(o,s),f=u.getAllMeta(),m=u.getUsedContext();return a==="vscode"&&(l=bne(l)),{messages:l,tokenCount:d,metadatas:f,usedContext:m,references:p}}Dr.renderPrompt=lLe;function bne(t){let e=require("vscode");return t.map(r=>{switch(r.role){case ZU.ChatRole.Assistant:return e.LanguageModelChatMessage.Assistant(r.content,r.name);case ZU.ChatRole.User:return e.LanguageModelChatMessage.User(r.content,r.name);case ZU.ChatRole.Function:{let n=e.LanguageModelChatMessage.User("");return n.content2=new e.LanguageModelChatMessageFunctionResultPart(r.name,r.content),n}default:throw new Error(`Converting chat message with role ${r.role} to VS Code chat message is not supported.`)}})}Dr.toVsCodeChatMessages=bne});var _ne=M(ad=>{"use strict";Object.defineProperty(ad,"__esModule",{value:!0});ad.bytePairEncode=ad.BinaryMap=ad.binaryMapKey=void 0;var dLe=(t,e,r)=>{let n=r-e,o=16777215>>>Math.max(0,(3-n)*8),s=(t[e+0]|t[e+1]<<8|t[e+2]<<16)&o,a=16777215>>>Math.min(31,Math.max(0,(6-n)*8)),c=(t[e+3]|t[e+4]<<8|t[e+5]<<16)&a;return s+16777216*c};ad.binaryMapKey=dLe;var tB=class t{constructor(){this.nested=new Map,this.final=new Map}get(e,r=0,n=e.length){let o=n<6+r,s=(0,ad.binaryMapKey)(e,r,n);return o?this.final.get(s):this.nested.get(s)?.get(e,6+r,n)}set(e,r){let n=(0,ad.binaryMapKey)(e,0,e.length);if(e.length<6){this.final.set(n,r);return}let s=this.nested.get(n);if(s instanceof t)s.set(e.subarray(6),r);else{let a=new t;a.set(e.subarray(6),r),this.nested.set(n,a)}}};ad.BinaryMap=tB;var sd=new Int32Array(128),Ks=new Int32Array(128);function pLe(t,e,r){if(r===1)return[e.get(t)];let n=2147483647,o=-1;for(;sd.length<r*2;)Ks=new Int32Array(Ks.length*2),sd=new Int32Array(sd.length*2);for(let u=0;u<r-1;u++){let l=e.get(t,u,u+2)??2147483647;l<n&&(n=l,o=u),Ks[u]=u,sd[u]=l}Ks[r-1]=r-1,sd[r-1]=2147483647,Ks[r]=r,sd[r]=2147483647;let s=r+1;function a(u,l=0){if(u+l+2<s){let d=e.get(t,Ks[u],Ks[u+l+2]);if(d!==void 0)return d}return 2147483647}for(;n!==2147483647;){sd[Ks[o]]=a(o,1),o>0&&(sd[Ks[o-1]]=a(o-1,1));for(let u=o+1;u<s-1;u++)Ks[u]=Ks[u+1];s--,o=-1,n=2147483647;for(let u=0;u<s-1;u++){let l=sd[Ks[u]];sd[Ks[u]]<n&&(n=l,o=u)}}let c=[];for(let u=0;u<s-1;u++)c.push(e.get(t,Ks[u],Ks[u+1]));return c}ad.bytePairEncode=pLe});var xne=M(DD=>{"use strict";Object.defineProperty(DD,"__esModule",{value:!0});DD.makeTextEncoder=void 0;var rB=class{constructor(){this.length=0,this.encoder=new TextEncoder}encode(e){let r=this.encoder.encode(e);return this.length=r.length,r}},nB=class{constructor(){this.buffer=Buffer.alloc(256),this.length=0}encode(e){for(;;){if(this.length=this.buffer.write(e,"utf8"),this.length<this.buffer.length-4)return this.buffer;this.buffer=Buffer.alloc(this.length*2),this.length=this.buffer.write(e)}}},fLe=()=>typeof Buffer<"u"?new nB:new rB;DD.makeTextEncoder=fLe});var Sne=M(ND=>{"use strict";Object.defineProperty(ND,"__esModule",{value:!0});ND.LRUCache=void 0;var iB=class{constructor(e){this.size=e,this.nodes=new Map}get(e){let r=this.nodes.get(e);if(r)return this.moveToHead(r),r.value}set(e,r){let n=this.nodes.get(e);if(n)n.value=r,this.moveToHead(n);else{let o=new oB(e,r);this.nodes.set(e,o),this.addNode(o),this.nodes.size>this.size&&(this.nodes.delete(this.tail.key),this.removeNode(this.tail))}}moveToHead(e){this.removeNode(e),this.addNode(e)}addNode(e){this.head&&(this.head.prev=e,e.next=this.head),this.tail||(this.tail=e),this.head=e}removeNode(e){e.prev?e.prev.next=e.next:this.head=e.next,e.next?e.next.prev=e.prev:this.tail=e.prev}};ND.LRUCache=iB;var oB=class{constructor(e,r){this.key=e,this.value=r}}});var aB=M(OD=>{"use strict";Object.defineProperty(OD,"__esModule",{value:!0});OD.TikTokenizer=void 0;var mLe=require("fs"),hLe=require("util"),LD=_ne(),gLe=xne(),vLe=Sne();function yLe(t){let e=new Map;try{let n=mLe.readFileSync(t,"utf-8");return r(n),e}catch(n){throw new Error(`Failed to load from BPE encoder file stream: ${n}`)}function r(n){for(let o of n.split(/[\r\n]+/)){if(o.trim()==="")continue;let s=o.split(" ");if(s.length!==2)throw new Error("Invalid format in the BPE encoder file stream");let a=new Uint8Array(Buffer.from(s[0],"base64")),c=parseInt(s[1]);if(!isNaN(c))e.set(a,c);else throw new Error(`Can't parse ${s[1]} to integer`)}}}function bLe(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}var sB=class{constructor(e,r,n,o=8192){this.textEncoder=(0,gLe.makeTextEncoder)(),this.textDecoder=new hLe.TextDecoder("utf-8"),this.cache=new vLe.LRUCache(o);let s=typeof e=="string"?yLe(e):e;this.init(s,r,n)}init(e,r,n){this.encoder=new LD.BinaryMap;for(let[o,s]of e)this.encoder.set(o,s);this.regex=new RegExp(n,"gu"),this.specialTokensRegex=new RegExp(Array.from(r.keys()).map(o=>bLe(o)).join("|")),this.specialTokensEncoder=r,this.decoder=new Map;for(let[o,s]of e)this.decoder.set(s,o);if(e.size!==this.decoder.size)throw new Error("Encoder and decoder sizes do not match");this.specialTokensDecoder=new Map;for(let[o,s]of r)this.specialTokensDecoder.set(s,o)}findNextSpecialToken(e,r,n){let o=r,s=null;if(n&&this.specialTokensRegex)for(;s=e.slice(o).match(this.specialTokensRegex),!(!s||n&&n.includes(s[0]));)o+=s.index+1;let a=s?o+s.index:e.length;return[s,a]}encode(e,r){let n=[],o=0;for(;;){let s,a;if([s,a]=this.findNextSpecialToken(e,o,r),a>o&&this.encodeByIndex(e,n,o,a),s){if(o=o+this.encodeSpecialToken(n,s),o>=e.length)break}else break}return n}encodeSpecialToken(e,r){let n=this.specialTokensEncoder?.get(r[0]);return e.push(n),r.index+r[0].length}encodeByIndex(e,r,n,o){let s,a=e.substring(n,o);for(this.regex.lastIndex=0;s=this.regex.exec(a);){let c=this.cache.get(s[0]);if(c)for(let u of c)r.push(u);else{let u=this.textEncoder.encode(s[0]),l=this.encoder.get(u,0,this.textEncoder.length);if(l!==void 0)r.push(l),this.cache.set(s[0],[l]);else{let d=(0,LD.bytePairEncode)(u,this.encoder,this.textEncoder.length);for(let p of d)r.push(p);this.cache.set(s[0],d)}}}}encodeTrimSuffixByIndex(e,r,n,o,s,a,c){let u,l=e.substring(n,o);for(this.regex.lastIndex=0;u=this.regex.exec(l);){let d=u[0],p=this.cache.get(d);if(p)if(a+p.length<=s)a+=p.length,c+=d.length,r.push(...p);else{let f=s-a;a+=f,c+=d.length,r.push(...p.slice(0,f));break}else{let f=this.textEncoder.encode(d),m=this.encoder.get(f,0,f.length);if(m!==void 0)if(this.cache.set(d,[m]),a+1<=s)a++,c+=d.length,r.push(m);else break;else{let h=(0,LD.bytePairEncode)(f,this.encoder,this.textEncoder.length);if(this.cache.set(d,h),a+h.length<=s){a+=h.length,c+=d.length;for(let g of h)r.push(g)}else{let g=s-a;a+=g,c+=d.length;for(let v=0;v<g;v++)r.push(h[v]);break}}}if(a>=s)break}return{tokenCount:a,encodeLength:c}}encodeTrimSuffix(e,r,n){let o=[],s=0,a=0,c=0;for(;;){let l,d;if([l,d]=this.findNextSpecialToken(e,s,n),d>s){let{tokenCount:p,encodeLength:f}=this.encodeTrimSuffixByIndex(e,o,s,d,r,a,c);if(a=p,c=f,a>=r)break}if(l!==null){if(a++,a<=r&&(s=s+this.encodeSpecialToken(o,l),c+=l[0].length,s>=e.length)||a>=r)break}else break}let u=c===e.length?e:e.slice(0,c);return{tokenIds:o,text:u}}encodeTrimPrefix(e,r,n){let o=[],s=0,a=0,c=0,u=new Map;for(u.set(a,c);;){let f,m;if([f,m]=this.findNextSpecialToken(e,s,n),m>s){let h,g=e.substring(s,m);for(this.regex.lastIndex=0;h=this.regex.exec(g);){let v=h[0],y=this.cache.get(v);if(y)a+=y.length,c+=v.length,o.push(...y),u.set(a,c);else{let b=this.textEncoder.encode(v),_=this.encoder.get(b);if(_!==void 0)this.cache.set(v,[_]),a++,c+=v.length,o.push(_),u.set(a,c);else{let S=(0,LD.bytePairEncode)(b,this.encoder,this.textEncoder.length);this.cache.set(v,S),a+=S.length,c+=v.length;for(let I of S)o.push(I);u.set(a,c)}}}}if(f!==null){if(s=s+this.encodeSpecialToken(o,f),a++,c+=f[0].length,u.set(a,c),s>=e.length)break}else break}if(a<=r)return{tokenIds:o,text:e};let l=a-r,d=0,p=0;for(let[f,m]of u)if(f>=l){d=f,p=m;break}if(d>r){let f=this.encode(e,n),m=f.slice(f.length-r);return{tokenIds:m,text:this.decode(m)}}return{tokenIds:o.slice(d),text:e.slice(p)}}decode(e){let r=[];for(let n of e){let o=[],s=this.decoder?.get(n);if(s!==void 0)o=Array.from(s);else{let a=this.specialTokensDecoder?.get(n);if(a!==void 0){let c=this.textEncoder.encode(a);o=Array.from(c.subarray(0,this.textEncoder.length))}}r.push(...o)}return this.textDecoder.decode(new Uint8Array(r))}};OD.TikTokenizer=sB});var Dne=M(Ki=>{"use strict";Object.defineProperty(Ki,"__esModule",{value:!0});Ki.createTokenizer=Ki.createByEncoderName=Ki.createByModelName=Ki.getRegexByModel=Ki.getRegexByEncoder=Ki.getSpecialTokensByModel=Ki.getSpecialTokensByEncoder=Ki.MODEL_TO_ENCODING=void 0;var FD=require("fs"),cB=require("path"),_Le=aB(),xLe=new Map([["gpt-4o-","o200k_base"],["gpt-4-","cl100k_base"],["gpt-3.5-turbo-","cl100k_base"],["gpt-35-turbo-","cl100k_base"]]);Ki.MODEL_TO_ENCODING=new Map([["gpt-4o","o200k_base"],["gpt-4","cl100k_base"],["gpt-3.5-turbo","cl100k_base"],["text-davinci-003","p50k_base"],["text-davinci-002","p50k_base"],["text-davinci-001","r50k_base"],["text-curie-001","r50k_base"],["text-babbage-001","r50k_base"],["text-ada-001","r50k_base"],["davinci","r50k_base"],["curie","r50k_base"],["babbage","r50k_base"],["ada","r50k_base"],["code-davinci-002","p50k_base"],["code-davinci-001","p50k_base"],["code-cushman-002","p50k_base"],["code-cushman-001","p50k_base"],["davinci-codex","p50k_base"],["cushman-codex","p50k_base"],["text-davinci-edit-001","p50k_edit"],["code-davinci-edit-001","p50k_edit"],["text-embedding-ada-002","cl100k_base"],["text-similarity-davinci-001","r50k_base"],["text-similarity-curie-001","r50k_base"],["text-similarity-babbage-001","r50k_base"],["text-similarity-ada-001","r50k_base"],["text-search-davinci-doc-001","r50k_base"],["text-search-curie-doc-001","r50k_base"],["text-search-babbage-doc-001","r50k_base"],["text-search-ada-doc-001","r50k_base"],["code-search-babbage-code-001","r50k_base"],["code-search-ada-code-001","r50k_base"],["gpt2","gpt2"]]);var MD="<|endoftext|>",Ine="<|fim_prefix|>",Cne="<|fim_middle|>",Ene="<|fim_suffix|>",Tne="<|endofprompt|>",XT="'s|'t|'re|'ve|'m|'ll|'d| ?\\p{L}+| ?\\p{N}+| ?[^\\s\\p{L}\\p{N}]+|\\s+(?!\\S)|\\s+",wne="(?:'s|'S|'t|'T|'re|'RE|'Re|'eR|'ve|'VE|'vE|'Ve|'m|'M|'ll|'lL|'Ll|'LL|'d|'D)|[^\\r\\n\\p{L}\\p{N}]?\\p{L}+|\\p{N}{1,3}| ?[^\\s\\p{L}\\p{N}]+[\\r\\n]*|\\s*[\\r\\n]+|\\s+(?!\\S)|\\s+",SLe=[`[^\r
\\p{L}\\p{N}]?[\\p{Lu}\\p{Lt}\\p{Lm}\\p{Lo}\\p{M}]*[\\p{Ll}\\p{Lm}\\p{Lo}\\p{M}]+(?:'s|'S|'t|'T|'re|'RE|'Re|'eR|'ve|'VE|'vE|'Ve|'m|'M|'ll|'lL|'Ll|'LL|'d|'D)?`,`[^\r
\\p{L}\\p{N}]?[\\p{Lu}\\p{Lt}\\p{Lm}\\p{Lo}\\p{M}]+[\\p{Ll}\\p{Lm}\\p{Lo}\\p{M}]*(?:'s|'S|'t|'T|'re|'RE|'Re|'eR|'ve|'VE|'vE|'Ve|'m|'M|'ll|'lL|'Ll|'LL|'d|'D)?`,"\\p{N}{1,3}"," ?[^\\s\\p{L}\\p{N}]+[\\r\\n/]*","\\s*[\\r\\n]+","\\s+(?!\\S)","\\s+"],Rne=SLe.join("|");function uB(t){let e="";if(Ki.MODEL_TO_ENCODING.has(t))e=Ki.MODEL_TO_ENCODING.get(t);else for(let[r,n]of xLe)if(t.startsWith(r)){e=n;break}return e}async function ILe(t,e){let r=await fetch(t);if(!r.ok)throw new Error(`Failed to fetch file from ${t}. Status code: ${r.status}`);let n=await r.text();FD.writeFileSync(e,n)}function lB(t){let e=new Map([[MD,50256]]);switch(t){case"o200k_base":e=new Map([[MD,199999],[Tne,200018]]);break;case"cl100k_base":e=new Map([[MD,100257],[Ine,100258],[Cne,100259],[Ene,100260],[Tne,100276]]);break;case"p50k_edit":e=new Map([[MD,50256],[Ine,50281],[Cne,50282],[Ene,50283]]);break;default:break}return e}Ki.getSpecialTokensByEncoder=lB;function CLe(t){let e=uB(t);return lB(e)}Ki.getSpecialTokensByModel=CLe;function kne(t){switch(t){case"o200k_base":return Rne;case"cl100k_base":return wne;default:break}return XT}Ki.getRegexByEncoder=kne;function ELe(t){let e=uB(t);return kne(e)}Ki.getRegexByModel=ELe;async function TLe(t,e=null){return Pne(uB(t),e)}Ki.createByModelName=TLe;async function Pne(t,e=null){let r,n,o=lB(t);switch(t){case"o200k_base":r=Rne,n="https://openaipublic.blob.core.windows.net/encodings/o200k_base.tiktoken";break;case"cl100k_base":r=wne,n="https://openaipublic.blob.core.windows.net/encodings/cl100k_base.tiktoken";break;case"p50k_base":r=XT,n="https://openaipublic.blob.core.windows.net/encodings/p50k_base.tiktoken";break;case"p50k_edit":r=XT,n="https://openaipublic.blob.core.windows.net/encodings/p50k_base.tiktoken";break;case"r50k_base":r=XT,n="https://openaipublic.blob.core.windows.net/encodings/r50k_base.tiktoken";break;case"gpt2":r=XT,n="https://raw.githubusercontent.com/microsoft/Tokenizer/main/model/gpt2.tiktoken";break;default:throw new Error(`Doesn't support this encoder [${t}]`)}e!==null&&(o=new Map([...o,...e]));let s=cB.basename(n),a=cB.resolve(__dirname,"..","model");FD.existsSync(a)||FD.mkdirSync(a,{recursive:!0});let c=cB.resolve(a,s);return FD.existsSync(c)||(console.log(`Downloading file from ${n}`),await ILe(n,c),console.log(`Saved file to ${c}`)),Ane(c,o,r)}Ki.createByEncoderName=Pne;function Ane(t,e,r,n=8192){return new _Le.TikTokenizer(t,e,r,n)}Ki.createTokenizer=Ane});var Nne=M(Yi=>{"use strict";Object.defineProperty(Yi,"__esModule",{value:!0});Yi.createTokenizer=Yi.createByEncoderName=Yi.createByModelName=Yi.getSpecialTokensByModel=Yi.getSpecialTokensByEncoder=Yi.getRegexByModel=Yi.getRegexByEncoder=Yi.MODEL_TO_ENCODING=Yi.TikTokenizer=void 0;var wLe=aB();Object.defineProperty(Yi,"TikTokenizer",{enumerable:!0,get:function(){return wLe.TikTokenizer}});var oh=Dne();Object.defineProperty(Yi,"MODEL_TO_ENCODING",{enumerable:!0,get:function(){return oh.MODEL_TO_ENCODING}});Object.defineProperty(Yi,"getRegexByEncoder",{enumerable:!0,get:function(){return oh.getRegexByEncoder}});Object.defineProperty(Yi,"getRegexByModel",{enumerable:!0,get:function(){return oh.getRegexByModel}});Object.defineProperty(Yi,"getSpecialTokensByEncoder",{enumerable:!0,get:function(){return oh.getSpecialTokensByEncoder}});Object.defineProperty(Yi,"getSpecialTokensByModel",{enumerable:!0,get:function(){return oh.getSpecialTokensByModel}});Object.defineProperty(Yi,"createByModelName",{enumerable:!0,get:function(){return oh.createByModelName}});Object.defineProperty(Yi,"createByEncoderName",{enumerable:!0,get:function(){return oh.createByEncoderName}});Object.defineProperty(Yi,"createTokenizer",{enumerable:!0,get:function(){return oh.createTokenizer}})});var _ie=M((Ymt,bie)=>{function die(t){return Array.isArray(t)?t:[t]}var hie="",pie=" ",bB="\\",DLe=/^\s+$/,NLe=/(?:[^\\]|^)\\$/,LLe=/^\\!/,OLe=/^\\#/,MLe=/\r?\n/g,FLe=/^\.*\/|^\.+$/,_B="/",gie="node-ignore";typeof Symbol<"u"&&(gie=Symbol.for("node-ignore"));var fie=gie,ULe=(t,e,r)=>Object.defineProperty(t,e,{value:r}),BLe=/([0-z])-([0-z])/g,vie=()=>!1,qLe=t=>t.replace(BLe,(e,r,n)=>r.charCodeAt(0)<=n.charCodeAt(0)?e:hie),HLe=t=>{let{length:e}=t;return t.slice(0,e-e%2)},jLe=[[/\\?\s+$/,t=>t.indexOf("\\")===0?pie:hie],[/\\\s/g,()=>pie],[/[\\$.|*+(){^]/g,t=>`\\${t}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(t,e,r)=>e+6<r.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(t,e,r)=>{let n=r.replace(/\\\*/g,"[^\\/]*");return e+n}],[/\\\\\\(?=[$.|*+(){^])/g,()=>bB],[/\\\\/g,()=>bB],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(t,e,r,n,o)=>e===bB?`\\[${r}${HLe(n)}${o}`:o==="]"&&n.length%2===0?`[${qLe(r)}${n}]`:"[]"],[/(?:[^*])$/,t=>/\/$/.test(t)?`${t}$`:`${t}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(t,e)=>`${e?`${e}[^/]+`:"[^/]*"}(?=$|\\/$)`]],mie=Object.create(null),VLe=(t,e)=>{let r=mie[t];return r||(r=jLe.reduce((n,o)=>n.replace(o[0],o[1].bind(t)),t),mie[t]=r),e?new RegExp(r,"i"):new RegExp(r)},IB=t=>typeof t=="string",GLe=t=>t&&IB(t)&&!DLe.test(t)&&!NLe.test(t)&&t.indexOf("#")!==0,zLe=t=>t.split(MLe),xB=class{constructor(e,r,n,o){this.origin=e,this.pattern=r,this.negative=n,this.regex=o}},$Le=(t,e)=>{let r=t,n=!1;t.indexOf("!")===0&&(n=!0,t=t.substr(1)),t=t.replace(LLe,"!").replace(OLe,"#");let o=VLe(t,e);return new xB(r,t,n,o)},WLe=(t,e)=>{throw new e(t)},of=(t,e,r)=>IB(t)?t?of.isNotRelative(t)?r(`path should be a \`path.relative()\`d string, but got "${e}"`,RangeError):!0:r("path must not be empty",TypeError):r(`path must be a string, but got \`${e}\``,TypeError),yie=t=>FLe.test(t);of.isNotRelative=yie;of.convert=t=>t;var SB=class{constructor({ignorecase:e=!0,ignoreCase:r=e,allowRelativePaths:n=!1}={}){ULe(this,fie,!0),this._rules=[],this._ignoreCase=r,this._allowRelativePaths=n,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(e){if(e&&e[fie]){this._rules=this._rules.concat(e._rules),this._added=!0;return}if(GLe(e)){let r=$Le(e,this._ignoreCase);this._added=!0,this._rules.push(r)}}add(e){return this._added=!1,die(IB(e)?zLe(e):e).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(e){return this.add(e)}_testOne(e,r){let n=!1,o=!1;return this._rules.forEach(s=>{let{negative:a}=s;if(o===a&&n!==o||a&&!n&&!o&&!r)return;s.regex.test(e)&&(n=!a,o=a)}),{ignored:n,unignored:o}}_test(e,r,n,o){let s=e&&of.convert(e);return of(s,e,this._allowRelativePaths?vie:WLe),this._t(s,r,n,o)}_t(e,r,n,o){if(e in r)return r[e];if(o||(o=e.split(_B)),o.pop(),!o.length)return r[e]=this._testOne(e,n);let s=this._t(o.join(_B)+_B,r,n,o);return r[e]=s.ignored?s:this._testOne(e,n)}ignores(e){return this._test(e,this._ignoreCache,!1).ignored}createFilter(){return e=>!this.ignores(e)}filter(e){return die(e).filter(this.createFilter())}test(e){return this._test(e,this._testCache,!0)}},ZD=t=>new SB(t),KLe=t=>of(t&&of.convert(t),t,vie);ZD.isPathValid=KLe;ZD.default=ZD;bie.exports=ZD;if(typeof process<"u"&&(process.env&&process.env.IGNORE_TEST_WIN32||process.platform==="win32")){let t=r=>/^\\\\\?\\/.test(r)||/["<>|\u0000-\u001F]+/u.test(r)?r:r.replace(/\\/g,"/");of.convert=t;let e=/^[a-z]:\//i;of.isNotRelative=r=>e.test(r)||yie(r)}});var wie=M((eht,Tie)=>{"use strict";Tie.exports=Cie;function Cie(t,e,r){t instanceof RegExp&&(t=Iie(t,r)),e instanceof RegExp&&(e=Iie(e,r));var n=Eie(t,e,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+t.length,n[1]),post:r.slice(n[1]+e.length)}}function Iie(t,e){var r=e.match(t);return r?r[0]:null}Cie.range=Eie;function Eie(t,e,r){var n,o,s,a,c,u=r.indexOf(t),l=r.indexOf(e,u+1),d=u;if(u>=0&&l>0){if(t===e)return[u,l];for(n=[],s=r.length;d>=0&&!c;)d==u?(n.push(d),u=r.indexOf(t,d+1)):n.length==1?c=[n.pop(),l]:(o=n.pop(),o<s&&(s=o,a=l),l=r.indexOf(e,d+1)),d=u<l&&u>=0?u:l;n.length&&(c=[s,a])}return c}});var Oie=M((tht,Lie)=>{var Rie=wie();Lie.exports=XLe;var kie="\0SLASH"+Math.random()+"\0",Pie="\0OPEN"+Math.random()+"\0",EB="\0CLOSE"+Math.random()+"\0",Aie="\0COMMA"+Math.random()+"\0",Die="\0PERIOD"+Math.random()+"\0";function CB(t){return parseInt(t,10)==t?parseInt(t,10):t.charCodeAt(0)}function YLe(t){return t.split("\\\\").join(kie).split("\\{").join(Pie).split("\\}").join(EB).split("\\,").join(Aie).split("\\.").join(Die)}function QLe(t){return t.split(kie).join("\\").split(Pie).join("{").split(EB).join("}").split(Aie).join(",").split(Die).join(".")}function Nie(t){if(!t)return[""];var e=[],r=Rie("{","}",t);if(!r)return t.split(",");var n=r.pre,o=r.body,s=r.post,a=n.split(",");a[a.length-1]+="{"+o+"}";var c=Nie(s);return s.length&&(a[a.length-1]+=c.shift(),a.push.apply(a,c)),e.push.apply(e,a),e}function XLe(t){return t?(t.substr(0,2)==="{}"&&(t="\\{\\}"+t.substr(2)),uw(YLe(t),!0).map(QLe)):[]}function JLe(t){return"{"+t+"}"}function ZLe(t){return/^-?0\d/.test(t)}function e4e(t,e){return t<=e}function t4e(t,e){return t>=e}function uw(t,e){var r=[],n=Rie("{","}",t);if(!n)return[t];var o=n.pre,s=n.post.length?uw(n.post,!1):[""];if(/\$$/.test(n.pre))for(var a=0;a<s.length;a++){var c=o+"{"+n.body+"}"+s[a];r.push(c)}else{var u=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),l=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),d=u||l,p=n.body.indexOf(",")>=0;if(!d&&!p)return n.post.match(/,.*\}/)?(t=n.pre+"{"+n.body+EB+n.post,uw(t)):[t];var f;if(d)f=n.body.split(/\.\./);else if(f=Nie(n.body),f.length===1&&(f=uw(f[0],!1).map(JLe),f.length===1))return s.map(function(F){return n.pre+f[0]+F});var m;if(d){var h=CB(f[0]),g=CB(f[1]),v=Math.max(f[0].length,f[1].length),y=f.length==3?Math.abs(CB(f[2])):1,b=e4e,_=g<h;_&&(y*=-1,b=t4e);var S=f.some(ZLe);m=[];for(var I=h;b(I,g);I+=y){var T;if(l)T=String.fromCharCode(I),T==="\\"&&(T="");else if(T=String(I),S){var A=v-T.length;if(A>0){var B=new Array(A+1).join("0");I<0?T="-"+B+T.slice(1):T=B+T}}m.push(T)}}else{m=[];for(var j=0;j<f.length;j++)m.push.apply(m,uw(f[j],!1))}for(var j=0;j<m.length;j++)for(var a=0;a<s.length;a++){var c=o+m[j]+s[a];(!e||d||c)&&r.push(c)}}return r}});var Lw=M((xEt,Xse)=>{"use strict";var Sd="\\\\/",Wse=`[^${Sd}]`,pf="\\.",w5e="\\+",R5e="\\?",pL="\\/",k5e="(?=.)",Kse="[^/]",cH=`(?:${pL}|$)`,Yse=`(?:^|${pL})`,uH=`${pf}{1,2}${cH}`,P5e=`(?!${pf})`,A5e=`(?!${Yse}${uH})`,D5e=`(?!${pf}{0,1}${cH})`,N5e=`(?!${uH})`,L5e=`[^.${pL}]`,O5e=`${Kse}*?`,M5e="/",Qse={DOT_LITERAL:pf,PLUS_LITERAL:w5e,QMARK_LITERAL:R5e,SLASH_LITERAL:pL,ONE_CHAR:k5e,QMARK:Kse,END_ANCHOR:cH,DOTS_SLASH:uH,NO_DOT:P5e,NO_DOTS:A5e,NO_DOT_SLASH:D5e,NO_DOTS_SLASH:N5e,QMARK_NO_DOT:L5e,STAR:O5e,START_ANCHOR:Yse,SEP:M5e},F5e={...Qse,SLASH_LITERAL:`[${Sd}]`,QMARK:Wse,STAR:`${Wse}*?`,DOTS_SLASH:`${pf}{1,2}(?:[${Sd}]|$)`,NO_DOT:`(?!${pf})`,NO_DOTS:`(?!(?:^|[${Sd}])${pf}{1,2}(?:[${Sd}]|$))`,NO_DOT_SLASH:`(?!${pf}{0,1}(?:[${Sd}]|$))`,NO_DOTS_SLASH:`(?!${pf}{1,2}(?:[${Sd}]|$))`,QMARK_NO_DOT:`[^.${Sd}]`,START_ANCHOR:`(?:^|[${Sd}])`,END_ANCHOR:`(?:[${Sd}]|$)`,SEP:"\\"},U5e={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",ascii:"\\x00-\\x7F",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E ",punct:"\\-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};Xse.exports={MAX_LENGTH:1024*64,POSIX_REGEX_SOURCE:U5e,REGEX_BACKSLASH:/\\(?![*+?^${}(|)[\]])/g,REGEX_NON_SPECIAL_CHARS:/^[^@![\].,$*+?^{}()|\\/]+/,REGEX_SPECIAL_CHARS:/[-*+?.^${}(|)[\]]/,REGEX_SPECIAL_CHARS_BACKREF:/(\\?)((\W)(\3*))/g,REGEX_SPECIAL_CHARS_GLOBAL:/([-*+?.^${}(|)[\]])/g,REGEX_REMOVE_BACKSLASH:/(?:\[.*?[^\\]\]|\\(?=.))/g,REPLACEMENTS:{"***":"*","**/**":"**","**/**/**":"**"},CHAR_0:48,CHAR_9:57,CHAR_UPPERCASE_A:65,CHAR_LOWERCASE_A:97,CHAR_UPPERCASE_Z:90,CHAR_LOWERCASE_Z:122,CHAR_LEFT_PARENTHESES:40,CHAR_RIGHT_PARENTHESES:41,CHAR_ASTERISK:42,CHAR_AMPERSAND:38,CHAR_AT:64,CHAR_BACKWARD_SLASH:92,CHAR_CARRIAGE_RETURN:13,CHAR_CIRCUMFLEX_ACCENT:94,CHAR_COLON:58,CHAR_COMMA:44,CHAR_DOT:46,CHAR_DOUBLE_QUOTE:34,CHAR_EQUAL:61,CHAR_EXCLAMATION_MARK:33,CHAR_FORM_FEED:12,CHAR_FORWARD_SLASH:47,CHAR_GRAVE_ACCENT:96,CHAR_HASH:35,CHAR_HYPHEN_MINUS:45,CHAR_LEFT_ANGLE_BRACKET:60,CHAR_LEFT_CURLY_BRACE:123,CHAR_LEFT_SQUARE_BRACKET:91,CHAR_LINE_FEED:10,CHAR_NO_BREAK_SPACE:160,CHAR_PERCENT:37,CHAR_PLUS:43,CHAR_QUESTION_MARK:63,CHAR_RIGHT_ANGLE_BRACKET:62,CHAR_RIGHT_CURLY_BRACE:125,CHAR_RIGHT_SQUARE_BRACKET:93,CHAR_SEMICOLON:59,CHAR_SINGLE_QUOTE:39,CHAR_SPACE:32,CHAR_TAB:9,CHAR_UNDERSCORE:95,CHAR_VERTICAL_LINE:124,CHAR_ZERO_WIDTH_NOBREAK_SPACE:65279,extglobChars(t){return{"!":{type:"negate",open:"(?:(?!(?:",close:`))${t.STAR})`},"?":{type:"qmark",open:"(?:",close:")?"},"+":{type:"plus",open:"(?:",close:")+"},"*":{type:"star",open:"(?:",close:")*"},"@":{type:"at",open:"(?:",close:")"}}},globChars(t){return t===!0?F5e:Qse}}});var fL=M(Aa=>{"use strict";var{REGEX_BACKSLASH:B5e,REGEX_REMOVE_BACKSLASH:q5e,REGEX_SPECIAL_CHARS:H5e,REGEX_SPECIAL_CHARS_GLOBAL:j5e}=Lw();Aa.isObject=t=>t!==null&&typeof t=="object"&&!Array.isArray(t);Aa.hasRegexChars=t=>H5e.test(t);Aa.isRegexChar=t=>t.length===1&&Aa.hasRegexChars(t);Aa.escapeRegex=t=>t.replace(j5e,"\\$1");Aa.toPosixSlashes=t=>t.replace(B5e,"/");Aa.removeBackslashes=t=>t.replace(q5e,e=>e==="\\"?"":e);Aa.supportsLookbehinds=()=>{if(typeof process<"u"){let t=process.version.slice(1).split(".").map(Number);if(t.length===3&&t[0]>=9||t[0]===8&&t[1]>=10)return!0}return!1};Aa.escapeLast=(t,e,r)=>{let n=t.lastIndexOf(e,r);return n===-1?t:t[n-1]==="\\"?Aa.escapeLast(t,e,n-1):`${t.slice(0,n)}\\${t.slice(n)}`};Aa.removePrefix=(t,e={})=>{let r=t;return r.startsWith("./")&&(r=r.slice(2),e.prefix="./"),r};Aa.wrapOutput=(t,e={},r={})=>{let n=r.contains?"":"^",o=r.contains?"":"$",s=`${n}(?:${t})${o}`;return e.negated===!0&&(s=`(?:^(?!${s}).*$)`),s};Aa.basename=(t,{windows:e}={})=>{let r=t.split(e?/[\\/]/:"/"),n=r[r.length-1];return n===""?r[r.length-2]:n}});var oae=M((IEt,iae)=>{"use strict";var Jse=fL(),{CHAR_ASTERISK:lH,CHAR_AT:V5e,CHAR_BACKWARD_SLASH:Ow,CHAR_COMMA:G5e,CHAR_DOT:dH,CHAR_EXCLAMATION_MARK:pH,CHAR_FORWARD_SLASH:nae,CHAR_LEFT_CURLY_BRACE:fH,CHAR_LEFT_PARENTHESES:mH,CHAR_LEFT_SQUARE_BRACKET:z5e,CHAR_PLUS:$5e,CHAR_QUESTION_MARK:Zse,CHAR_RIGHT_CURLY_BRACE:W5e,CHAR_RIGHT_PARENTHESES:eae,CHAR_RIGHT_SQUARE_BRACKET:K5e}=Lw(),tae=t=>t===nae||t===Ow,rae=t=>{t.isPrefix!==!0&&(t.depth=t.isGlobstar?1/0:1)},Y5e=(t,e)=>{let r=e||{},n=t.length-1,o=r.parts===!0||r.scanToEnd===!0,s=[],a=[],c=[],u=t,l=-1,d=0,p=0,f=!1,m=!1,h=!1,g=!1,v=!1,y=!1,b=!1,_=!1,S=!1,I=!1,T=0,A,B,j={value:"",depth:0,isGlob:!1},F=()=>l>=n,ne=()=>u.charCodeAt(l+1),Y=()=>(A=B,u.charCodeAt(++l));for(;l<n;){B=Y();let U;if(B===Ow){b=j.backslashes=!0,B=Y(),B===fH&&(y=!0);continue}if(y===!0||B===fH){for(T++;F()!==!0&&(B=Y());){if(B===Ow){b=j.backslashes=!0,Y();continue}if(B===fH){T++;continue}if(y!==!0&&B===dH&&(B=Y())===dH){if(f=j.isBrace=!0,h=j.isGlob=!0,I=!0,o===!0)continue;break}if(y!==!0&&B===G5e){if(f=j.isBrace=!0,h=j.isGlob=!0,I=!0,o===!0)continue;break}if(B===W5e&&(T--,T===0)){y=!1,f=j.isBrace=!0,I=!0;break}}if(o===!0)continue;break}if(B===nae){if(s.push(l),a.push(j),j={value:"",depth:0,isGlob:!1},I===!0)continue;if(A===dH&&l===d+1){d+=2;continue}p=l+1;continue}if(r.noext!==!0&&(B===$5e||B===V5e||B===lH||B===Zse||B===pH)===!0&&ne()===mH){if(h=j.isGlob=!0,g=j.isExtglob=!0,I=!0,B===pH&&l===d&&(S=!0),o===!0){for(;F()!==!0&&(B=Y());){if(B===Ow){b=j.backslashes=!0,B=Y();continue}if(B===eae){h=j.isGlob=!0,I=!0;break}}continue}break}if(B===lH){if(A===lH&&(v=j.isGlobstar=!0),h=j.isGlob=!0,I=!0,o===!0)continue;break}if(B===Zse){if(h=j.isGlob=!0,I=!0,o===!0)continue;break}if(B===z5e){for(;F()!==!0&&(U=Y());){if(U===Ow){b=j.backslashes=!0,Y();continue}if(U===K5e){m=j.isBracket=!0,h=j.isGlob=!0,I=!0;break}}if(o===!0)continue;break}if(r.nonegate!==!0&&B===pH&&l===d){_=j.negated=!0,d++;continue}if(r.noparen!==!0&&B===mH){if(h=j.isGlob=!0,o===!0){for(;F()!==!0&&(B=Y());){if(B===mH){b=j.backslashes=!0,B=Y();continue}if(B===eae){I=!0;break}}continue}break}if(h===!0){if(I=!0,o===!0)continue;break}}r.noext===!0&&(g=!1,h=!1);let N=u,w="",P="";d>0&&(w=u.slice(0,d),u=u.slice(d),p-=d),N&&h===!0&&p>0?(N=u.slice(0,p),P=u.slice(p)):h===!0?(N="",P=u):N=u,N&&N!==""&&N!=="/"&&N!==u&&tae(N.charCodeAt(N.length-1))&&(N=N.slice(0,-1)),r.unescape===!0&&(P&&(P=Jse.removeBackslashes(P)),N&&b===!0&&(N=Jse.removeBackslashes(N)));let q={prefix:w,input:t,start:d,base:N,glob:P,isBrace:f,isBracket:m,isGlob:h,isExtglob:g,isGlobstar:v,negated:_,negatedExtglob:S};if(r.tokens===!0&&(q.maxDepth=0,tae(B)||a.push(j),q.tokens=a),r.parts===!0||r.tokens===!0){let U;for(let Z=0;Z<s.length;Z++){let le=U?U+1:d,re=s[Z],X=t.slice(le,re);r.tokens&&(Z===0&&d!==0?(a[Z].isPrefix=!0,a[Z].value=w):a[Z].value=X,rae(a[Z]),q.maxDepth+=a[Z].depth),(Z!==0||X!=="")&&c.push(X),U=re}if(U&&U+1<t.length){let Z=t.slice(U+1);c.push(Z),r.tokens&&(a[a.length-1].value=Z,rae(a[a.length-1]),q.maxDepth+=a[a.length-1].depth)}q.slashes=s,q.parts=c}return q};iae.exports=Y5e});var cae=M((CEt,aae)=>{"use strict";var mL=Lw(),gl=fL(),{MAX_LENGTH:hL,POSIX_REGEX_SOURCE:Q5e,REGEX_NON_SPECIAL_CHARS:X5e,REGEX_SPECIAL_CHARS_BACKREF:J5e,REPLACEMENTS:sae}=mL,Z5e=(t,e)=>{if(typeof e.expandRange=="function")return e.expandRange(...t,e);t.sort();let r=`[${t.join("-")}]`;try{new RegExp(r)}catch{return t.map(o=>gl.escapeRegex(o)).join("..")}return r},Bx=(t,e)=>`Missing ${t}: "${e}" - use "\\\\${e}" to match literal characters`,hH=(t,e)=>{if(typeof t!="string")throw new TypeError("Expected a string");t=sae[t]||t;let r={...e},n=typeof r.maxLength=="number"?Math.min(hL,r.maxLength):hL,o=t.length;if(o>n)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${n}`);let s={type:"bos",value:"",output:r.prepend||""},a=[s],c=r.capture?"":"?:",u=mL.globChars(r.windows),l=mL.extglobChars(u),{DOT_LITERAL:d,PLUS_LITERAL:p,SLASH_LITERAL:f,ONE_CHAR:m,DOTS_SLASH:h,NO_DOT:g,NO_DOT_SLASH:v,NO_DOTS_SLASH:y,QMARK:b,QMARK_NO_DOT:_,STAR:S,START_ANCHOR:I}=u,T=be=>`(${c}(?:(?!${I}${be.dot?h:d}).)*?)`,A=r.dot?"":g,B=r.dot?b:_,j=r.bash===!0?T(r):S;r.capture&&(j=`(${j})`),typeof r.noext=="boolean"&&(r.noextglob=r.noext);let F={input:t,index:-1,start:0,dot:r.dot===!0,consumed:"",output:"",prefix:"",backtrack:!1,negated:!1,brackets:0,braces:0,parens:0,quotes:0,globstar:!1,tokens:a};t=gl.removePrefix(t,F),o=t.length;let ne=[],Y=[],N=[],w=s,P,q=()=>F.index===o-1,U=F.peek=(be=1)=>t[F.index+be],Z=F.advance=()=>t[++F.index]||"",le=()=>t.slice(F.index+1),re=(be="",ct=0)=>{F.consumed+=be,F.index+=ct},X=be=>{F.output+=be.output!=null?be.output:be.value,re(be.value)},Ve=()=>{let be=1;for(;U()==="!"&&(U(2)!=="("||U(3)==="?");)Z(),F.start++,be++;return be%2===0?!1:(F.negated=!0,F.start++,!0)},ie=be=>{F[be]++,N.push(be)},yt=be=>{F[be]--,N.pop()},Ye=be=>{if(w.type==="globstar"){let ct=F.braces>0&&(be.type==="comma"||be.type==="brace"),H=be.extglob===!0||ne.length&&(be.type==="pipe"||be.type==="paren");be.type!=="slash"&&be.type!=="paren"&&!ct&&!H&&(F.output=F.output.slice(0,-w.output.length),w.type="star",w.value="*",w.output=j,F.output+=w.output)}if(ne.length&&be.type!=="paren"&&(ne[ne.length-1].inner+=be.value),(be.value||be.output)&&X(be),w&&w.type==="text"&&be.type==="text"){w.value+=be.value,w.output=(w.output||"")+be.value;return}be.prev=w,a.push(be),w=be},Et=(be,ct)=>{let H={...l[ct],conditions:1,inner:""};H.prev=w,H.parens=F.parens,H.output=F.output;let de=(r.capture?"(":"")+H.open;ie("parens"),Ye({type:be,value:ct,output:F.output?"":m}),Ye({type:"paren",extglob:!0,value:Z(),output:de}),ne.push(H)},Cr=be=>{let ct=be.close+(r.capture?")":""),H;if(be.type==="negate"){let de=j;if(be.inner&&be.inner.length>1&&be.inner.includes("/")&&(de=T(r)),(de!==j||q()||/^\)+$/.test(le()))&&(ct=be.close=`)$))${de}`),be.inner.includes("*")&&(H=le())&&/^\.[^\\/.]+$/.test(H)){let he=hH(H,{...e,fastpaths:!1}).output;ct=be.close=`)${he})${de})`}be.prev.type==="bos"&&(F.negatedExtglob=!0)}Ye({type:"paren",extglob:!0,value:P,output:ct}),yt("parens")};if(r.fastpaths!==!1&&!/(^[*!]|[/()[\]{}"])/.test(t)){let be=!1,ct=t.replace(J5e,(H,de,he,ke,Ie,ut)=>ke==="\\"?(be=!0,H):ke==="?"?de?de+ke+(Ie?b.repeat(Ie.length):""):ut===0?B+(Ie?b.repeat(Ie.length):""):b.repeat(he.length):ke==="."?d.repeat(he.length):ke==="*"?de?de+ke+(Ie?j:""):j:de?H:`\\${H}`);return be===!0&&(r.unescape===!0?ct=ct.replace(/\\/g,""):ct=ct.replace(/\\+/g,H=>H.length%2===0?"\\\\":H?"\\":"")),ct===t&&r.contains===!0?(F.output=t,F):(F.output=gl.wrapOutput(ct,F,e),F)}for(;!q();){if(P=Z(),P==="\0")continue;if(P==="\\"){let H=U();if(H==="/"&&r.bash!==!0||H==="."||H===";")continue;if(!H){P+="\\",Ye({type:"text",value:P});continue}let de=/^\\+/.exec(le()),he=0;if(de&&de[0].length>2&&(he=de[0].length,F.index+=he,he%2!==0&&(P+="\\")),r.unescape===!0?P=Z():P+=Z(),F.brackets===0){Ye({type:"text",value:P});continue}}if(F.brackets>0&&(P!=="]"||w.value==="["||w.value==="[^")){if(r.posix!==!1&&P===":"){let H=w.value.slice(1);if(H.includes("[")&&(w.posix=!0,H.includes(":"))){let de=w.value.lastIndexOf("["),he=w.value.slice(0,de),ke=w.value.slice(de+2),Ie=Q5e[ke];if(Ie){w.value=he+Ie,F.backtrack=!0,Z(),!s.output&&a.indexOf(w)===1&&(s.output=m);continue}}}(P==="["&&U()!==":"||P==="-"&&U()==="]")&&(P=`\\${P}`),P==="]"&&(w.value==="["||w.value==="[^")&&(P=`\\${P}`),r.posix===!0&&P==="!"&&w.value==="["&&(P="^"),w.value+=P,X({value:P});continue}if(F.quotes===1&&P!=='"'){P=gl.escapeRegex(P),w.value+=P,X({value:P});continue}if(P==='"'){F.quotes=F.quotes===1?0:1,r.keepQuotes===!0&&Ye({type:"text",value:P});continue}if(P==="("){ie("parens"),Ye({type:"paren",value:P});continue}if(P===")"){if(F.parens===0&&r.strictBrackets===!0)throw new SyntaxError(Bx("opening","("));let H=ne[ne.length-1];if(H&&F.parens===H.parens+1){Cr(ne.pop());continue}Ye({type:"paren",value:P,output:F.parens?")":"\\)"}),yt("parens");continue}if(P==="["){if(r.nobracket===!0||!le().includes("]")){if(r.nobracket!==!0&&r.strictBrackets===!0)throw new SyntaxError(Bx("closing","]"));P=`\\${P}`}else ie("brackets");Ye({type:"bracket",value:P});continue}if(P==="]"){if(r.nobracket===!0||w&&w.type==="bracket"&&w.value.length===1){Ye({type:"text",value:P,output:`\\${P}`});continue}if(F.brackets===0){if(r.strictBrackets===!0)throw new SyntaxError(Bx("opening","["));Ye({type:"text",value:P,output:`\\${P}`});continue}yt("brackets");let H=w.value.slice(1);if(w.posix!==!0&&H[0]==="^"&&!H.includes("/")&&(P=`/${P}`),w.value+=P,X({value:P}),r.literalBrackets===!1||gl.hasRegexChars(H))continue;let de=gl.escapeRegex(w.value);if(F.output=F.output.slice(0,-w.value.length),r.literalBrackets===!0){F.output+=de,w.value=de;continue}w.value=`(${c}${de}|${w.value})`,F.output+=w.value;continue}if(P==="{"&&r.nobrace!==!0){ie("braces");let H={type:"brace",value:P,output:"(",outputIndex:F.output.length,tokensIndex:F.tokens.length};Y.push(H),Ye(H);continue}if(P==="}"){let H=Y[Y.length-1];if(r.nobrace===!0||!H){Ye({type:"text",value:P,output:P});continue}let de=")";if(H.dots===!0){let he=a.slice(),ke=[];for(let Ie=he.length-1;Ie>=0&&(a.pop(),he[Ie].type!=="brace");Ie--)he[Ie].type!=="dots"&&ke.unshift(he[Ie].value);de=Z5e(ke,r),F.backtrack=!0}if(H.comma!==!0&&H.dots!==!0){let he=F.output.slice(0,H.outputIndex),ke=F.tokens.slice(H.tokensIndex);H.value=H.output="\\{",P=de="\\}",F.output=he;for(let Ie of ke)F.output+=Ie.output||Ie.value}Ye({type:"brace",value:P,output:de}),yt("braces"),Y.pop();continue}if(P==="|"){ne.length>0&&ne[ne.length-1].conditions++,Ye({type:"text",value:P});continue}if(P===","){let H=P,de=Y[Y.length-1];de&&N[N.length-1]==="braces"&&(de.comma=!0,H="|"),Ye({type:"comma",value:P,output:H});continue}if(P==="/"){if(w.type==="dot"&&F.index===F.start+1){F.start=F.index+1,F.consumed="",F.output="",a.pop(),w=s;continue}Ye({type:"slash",value:P,output:f});continue}if(P==="."){if(F.braces>0&&w.type==="dot"){w.value==="."&&(w.output=d);let H=Y[Y.length-1];w.type="dots",w.output+=P,w.value+=P,H.dots=!0;continue}if(F.braces+F.parens===0&&w.type!=="bos"&&w.type!=="slash"){Ye({type:"text",value:P,output:d});continue}Ye({type:"dot",value:P,output:d});continue}if(P==="?"){if(!(w&&w.value==="(")&&r.noextglob!==!0&&U()==="("&&U(2)!=="?"){Et("qmark",P);continue}if(w&&w.type==="paren"){let de=U(),he=P;if(de==="<"&&!gl.supportsLookbehinds())throw new Error("Node.js v10 or higher is required for regex lookbehinds");(w.value==="("&&!/[!=<:]/.test(de)||de==="<"&&!/<([!=]|\w+>)/.test(le()))&&(he=`\\${P}`),Ye({type:"text",value:P,output:he});continue}if(r.dot!==!0&&(w.type==="slash"||w.type==="bos")){Ye({type:"qmark",value:P,output:_});continue}Ye({type:"qmark",value:P,output:b});continue}if(P==="!"){if(r.noextglob!==!0&&U()==="("&&(U(2)!=="?"||!/[!=<:]/.test(U(3)))){Et("negate",P);continue}if(r.nonegate!==!0&&F.index===0){Ve();continue}}if(P==="+"){if(r.noextglob!==!0&&U()==="("&&U(2)!=="?"){Et("plus",P);continue}if(w&&w.value==="("||r.regex===!1){Ye({type:"plus",value:P,output:p});continue}if(w&&(w.type==="bracket"||w.type==="paren"||w.type==="brace")||F.parens>0){Ye({type:"plus",value:P});continue}Ye({type:"plus",value:p});continue}if(P==="@"){if(r.noextglob!==!0&&U()==="("&&U(2)!=="?"){Ye({type:"at",extglob:!0,value:P,output:""});continue}Ye({type:"text",value:P});continue}if(P!=="*"){(P==="$"||P==="^")&&(P=`\\${P}`);let H=X5e.exec(le());H&&(P+=H[0],F.index+=H[0].length),Ye({type:"text",value:P});continue}if(w&&(w.type==="globstar"||w.star===!0)){w.type="star",w.star=!0,w.value+=P,w.output=j,F.backtrack=!0,F.globstar=!0,re(P);continue}let be=le();if(r.noextglob!==!0&&/^\([^?]/.test(be)){Et("star",P);continue}if(w.type==="star"){if(r.noglobstar===!0){re(P);continue}let H=w.prev,de=H.prev,he=H.type==="slash"||H.type==="bos",ke=de&&(de.type==="star"||de.type==="globstar");if(r.bash===!0&&(!he||be[0]&&be[0]!=="/")){Ye({type:"star",value:P,output:""});continue}let Ie=F.braces>0&&(H.type==="comma"||H.type==="brace"),ut=ne.length&&(H.type==="pipe"||H.type==="paren");if(!he&&H.type!=="paren"&&!Ie&&!ut){Ye({type:"star",value:P,output:""});continue}for(;be.slice(0,3)==="/**";){let It=t[F.index+4];if(It&&It!=="/")break;be=be.slice(3),re("/**",3)}if(H.type==="bos"&&q()){w.type="globstar",w.value+=P,w.output=T(r),F.output=w.output,F.globstar=!0,re(P);continue}if(H.type==="slash"&&H.prev.type!=="bos"&&!ke&&q()){F.output=F.output.slice(0,-(H.output+w.output).length),H.output=`(?:${H.output}`,w.type="globstar",w.output=T(r)+(r.strictSlashes?")":"|$)"),w.value+=P,F.globstar=!0,F.output+=H.output+w.output,re(P);continue}if(H.type==="slash"&&H.prev.type!=="bos"&&be[0]==="/"){let It=be[1]!==void 0?"|$":"";F.output=F.output.slice(0,-(H.output+w.output).length),H.output=`(?:${H.output}`,w.type="globstar",w.output=`${T(r)}${f}|${f}${It})`,w.value+=P,F.output+=H.output+w.output,F.globstar=!0,re(P+Z()),Ye({type:"slash",value:"/",output:""});continue}if(H.type==="bos"&&be[0]==="/"){w.type="globstar",w.value+=P,w.output=`(?:^|${f}|${T(r)}${f})`,F.output=w.output,F.globstar=!0,re(P+Z()),Ye({type:"slash",value:"/",output:""});continue}F.output=F.output.slice(0,-w.output.length),w.type="globstar",w.output=T(r),w.value+=P,F.output+=w.output,F.globstar=!0,re(P);continue}let ct={type:"star",value:P,output:j};if(r.bash===!0){ct.output=".*?",(w.type==="bos"||w.type==="slash")&&(ct.output=A+ct.output),Ye(ct);continue}if(w&&(w.type==="bracket"||w.type==="paren")&&r.regex===!0){ct.output=P,Ye(ct);continue}(F.index===F.start||w.type==="slash"||w.type==="dot")&&(w.type==="dot"?(F.output+=v,w.output+=v):r.dot===!0?(F.output+=y,w.output+=y):(F.output+=A,w.output+=A),U()!=="*"&&(F.output+=m,w.output+=m)),Ye(ct)}for(;F.brackets>0;){if(r.strictBrackets===!0)throw new SyntaxError(Bx("closing","]"));F.output=gl.escapeLast(F.output,"["),yt("brackets")}for(;F.parens>0;){if(r.strictBrackets===!0)throw new SyntaxError(Bx("closing",")"));F.output=gl.escapeLast(F.output,"("),yt("parens")}for(;F.braces>0;){if(r.strictBrackets===!0)throw new SyntaxError(Bx("closing","}"));F.output=gl.escapeLast(F.output,"{"),yt("braces")}if(r.strictSlashes!==!0&&(w.type==="star"||w.type==="bracket")&&Ye({type:"maybe_slash",value:"",output:`${f}?`}),F.backtrack===!0){F.output="";for(let be of F.tokens)F.output+=be.output!=null?be.output:be.value,be.suffix&&(F.output+=be.suffix)}return F};hH.fastpaths=(t,e)=>{let r={...e},n=typeof r.maxLength=="number"?Math.min(hL,r.maxLength):hL,o=t.length;if(o>n)throw new SyntaxError(`Input length: ${o}, exceeds maximum allowed length: ${n}`);t=sae[t]||t;let{DOT_LITERAL:s,SLASH_LITERAL:a,ONE_CHAR:c,DOTS_SLASH:u,NO_DOT:l,NO_DOTS:d,NO_DOTS_SLASH:p,STAR:f,START_ANCHOR:m}=mL.globChars(r.windows),h=r.dot?d:l,g=r.dot?p:l,v=r.capture?"":"?:",y={negated:!1,prefix:""},b=r.bash===!0?".*?":f;r.capture&&(b=`(${b})`);let _=A=>A.noglobstar===!0?b:`(${v}(?:(?!${m}${A.dot?u:s}).)*?)`,S=A=>{switch(A){case"*":return`${h}${c}${b}`;case".*":return`${s}${c}${b}`;case"*.*":return`${h}${b}${s}${c}${b}`;case"*/*":return`${h}${b}${a}${c}${g}${b}`;case"**":return h+_(r);case"**/*":return`(?:${h}${_(r)}${a})?${g}${c}${b}`;case"**/*.*":return`(?:${h}${_(r)}${a})?${g}${b}${s}${c}${b}`;case"**/.*":return`(?:${h}${_(r)}${a})?${s}${c}${b}`;default:{let B=/^(.*?)\.(\w+)$/.exec(A);if(!B)return;let j=S(B[1]);return j?j+s+B[2]:void 0}}},I=gl.removePrefix(t,y),T=S(I);return T&&r.strictSlashes!==!0&&(T+=`${a}?`),T};aae.exports=hH});var dae=M((EEt,lae)=>{"use strict";var e6e=oae(),gH=cae(),uae=fL(),t6e=Lw(),r6e=t=>t&&typeof t=="object"&&!Array.isArray(t),Oi=(t,e,r=!1)=>{if(Array.isArray(t)){let d=t.map(f=>Oi(f,e,r));return f=>{for(let m of d){let h=m(f);if(h)return h}return!1}}let n=r6e(t)&&t.tokens&&t.input;if(t===""||typeof t!="string"&&!n)throw new TypeError("Expected pattern to be a non-empty string");let o=e||{},s=o.windows,a=n?Oi.compileRe(t,e):Oi.makeRe(t,e,!1,!0),c=a.state;delete a.state;let u=()=>!1;if(o.ignore){let d={...e,ignore:null,onMatch:null,onResult:null};u=Oi(o.ignore,d,r)}let l=(d,p=!1)=>{let{isMatch:f,match:m,output:h}=Oi.test(d,a,e,{glob:t,posix:s}),g={glob:t,state:c,regex:a,posix:s,input:d,output:h,match:m,isMatch:f};return typeof o.onResult=="function"&&o.onResult(g),f===!1?(g.isMatch=!1,p?g:!1):u(d)?(typeof o.onIgnore=="function"&&o.onIgnore(g),g.isMatch=!1,p?g:!1):(typeof o.onMatch=="function"&&o.onMatch(g),p?g:!0)};return r&&(l.state=c),l};Oi.test=(t,e,r,{glob:n,posix:o}={})=>{if(typeof t!="string")throw new TypeError("Expected input to be a string");if(t==="")return{isMatch:!1,output:""};let s=r||{},a=s.format||(o?uae.toPosixSlashes:null),c=t===n,u=c&&a?a(t):t;return c===!1&&(u=a?a(t):t,c=u===n),(c===!1||s.capture===!0)&&(s.matchBase===!0||s.basename===!0?c=Oi.matchBase(t,e,r,o):c=e.exec(u)),{isMatch:!!c,match:c,output:u}};Oi.matchBase=(t,e,r)=>(e instanceof RegExp?e:Oi.makeRe(e,r)).test(uae.basename(t));Oi.isMatch=(t,e,r)=>Oi(e,r)(t);Oi.parse=(t,e)=>Array.isArray(t)?t.map(r=>Oi.parse(r,e)):gH(t,{...e,fastpaths:!1});Oi.scan=(t,e)=>e6e(t,e);Oi.compileRe=(t,e,r=!1,n=!1)=>{if(r===!0)return t.output;let o=e||{},s=o.contains?"":"^",a=o.contains?"":"$",c=`${s}(?:${t.output})${a}`;t&&t.negated===!0&&(c=`^(?!${c}).*$`);let u=Oi.toRegex(c,e);return n===!0&&(u.state=t),u};Oi.makeRe=(t,e={},r=!1,n=!1)=>{if(!t||typeof t!="string")throw new TypeError("Expected a non-empty string");let o={negated:!1,fastpaths:!0};return e.fastpaths!==!1&&(t[0]==="."||t[0]==="*")&&(o.output=gH.fastpaths(t,e)),o.output||(o=gH(t,e)),Oi.compileRe(o,e,r,n)};Oi.toRegex=(t,e)=>{try{let r=e||{};return new RegExp(t,r.flags||(r.nocase?"i":""))}catch(r){if(e&&e.debug===!0)throw r;return/$^/}};Oi.constants=t6e;lae.exports=Oi});var pae=M((TEt,Id)=>{"use strict";var n6e=require("os"),ff=dae(),i6e=n6e.platform()==="win32";function o6e(t,e,r=!1){return e&&(e.windows===null||e.windows===void 0)&&(e={...e,windows:i6e}),ff(t,e,r)}Id.exports=o6e;Id.exports.test=ff.test;Id.exports.matchBase=ff.matchBase;Id.exports.isMatch=ff.isMatch;Id.exports.parse=ff.parse;Id.exports.scan=ff.scan;Id.exports.compileRe=ff.compileRe;Id.exports.toRegex=ff.toRegex;Id.exports.makeRe=ff.makeRe});var vae=M(Ph=>{"use strict";var s6e=Ph&&Ph.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})};Object.defineProperty(Ph,"__esModule",{value:!0});Ph.isBinaryFileSync=Ph.isBinaryFile=void 0;var kh=require("fs"),_H=require("util"),a6e=_H.promisify(kh.stat),c6e=_H.promisify(kh.open),u6e=_H.promisify(kh.close),Mw=512,bH=class{constructor(e,r){this.fileBuffer=e,this.size=r,this.offset=0,this.error=!1}hasError(){return this.error}nextByte(){return this.offset===this.size||this.hasError()?(this.error=!0,255):this.fileBuffer[this.offset++]}next(e){let r=new Array;for(let n=0;n<e;n++)r[n]=this.nextByte();return r}};function yH(t){let e=0,r=0;for(;!t.hasError();){let n=t.nextByte();if(r=r|(n&127)<<7*e,!(n&128))break;e++}return r}function l6e(t){switch(yH(t)&7){case 0:return yH(t),!0;case 1:return t.next(8),!0;case 2:let n=yH(t);return t.next(n),!0;case 5:return t.next(4),!0}return!1}function d6e(t,e){let r=new bH(t,e),n=0;for(;;){if(!l6e(r)&&!r.hasError())return!1;if(r.hasError())break;n++}return n>0}function p6e(t,e){return s6e(this,void 0,void 0,function*(){if(hae(t)){let r=yield a6e(t);gae(r);let n=yield c6e(t,"r"),o=Buffer.alloc(Mw);return new Promise((s,a)=>{kh.read(n,o,0,Mw,0,(c,u,l)=>{u6e(n),c?a(c):s(bL(o,u))})})}else return e===void 0&&(e=t.length),bL(t,e)})}Ph.isBinaryFile=p6e;function f6e(t,e){if(hae(t)){let r=kh.statSync(t);gae(r);let n=kh.openSync(t,"r"),o=Buffer.alloc(Mw),s=kh.readSync(n,o,0,Mw,0);return kh.closeSync(n),bL(o,s)}else return e===void 0&&(e=t.length),bL(t,e)}Ph.isBinaryFileSync=f6e;function bL(t,e){if(e===0)return!1;let r=0,n=Math.min(e,Mw);if(e>=3&&t[0]===239&&t[1]===187&&t[2]===191||e>=4&&t[0]===0&&t[1]===0&&t[2]===254&&t[3]===255||e>=4&&t[0]===255&&t[1]===254&&t[2]===0&&t[3]===0||e>=4&&t[0]===132&&t[1]===49&&t[2]===149&&t[3]===51)return!1;if(n>=5&&t.slice(0,5).toString()==="%PDF-")return!0;if(e>=2&&t[0]===254&&t[1]===255||e>=2&&t[0]===255&&t[1]===254)return!1;for(let o=0;o<n;o++){if(t[o]===0)return!0;if((t[o]<7||t[o]>14)&&(t[o]<32||t[o]>127)){if(t[o]>193&&t[o]<224&&o+1<n){if(o++,t[o]>127&&t[o]<192)continue}else if(t[o]>223&&t[o]<240&&o+2<n&&(o++,t[o]>127&&t[o]<192&&t[o+1]>127&&t[o+1]<192)){o++;continue}if(r++,o>=32&&r*100/n>10)return!0}}return!!(r*100/n>10||r>1&&d6e(t,n))}function hae(t){return typeof t=="string"}function gae(t){if(!t.isFile())throw new Error("Path provided was not a file!")}});var cle=M((lnr,ale)=>{var qS=1e3,HS=qS*60,jS=HS*60,fy=jS*24,dFe=fy*7,pFe=fy*365.25;ale.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return fFe(t);if(r==="number"&&isFinite(t))return e.long?hFe(t):mFe(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function fFe(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*pFe;case"weeks":case"week":case"w":return r*dFe;case"days":case"day":case"d":return r*fy;case"hours":case"hour":case"hrs":case"hr":case"h":return r*jS;case"minutes":case"minute":case"mins":case"min":case"m":return r*HS;case"seconds":case"second":case"secs":case"sec":case"s":return r*qS;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function mFe(t){var e=Math.abs(t);return e>=fy?Math.round(t/fy)+"d":e>=jS?Math.round(t/jS)+"h":e>=HS?Math.round(t/HS)+"m":e>=qS?Math.round(t/qS)+"s":t+"ms"}function hFe(t){var e=Math.abs(t);return e>=fy?CO(t,e,fy,"day"):e>=jS?CO(t,e,jS,"hour"):e>=HS?CO(t,e,HS,"minute"):e>=qS?CO(t,e,qS,"second"):t+" ms"}function CO(t,e,r,n){var o=e>=r*1.5;return Math.round(t/r)+" "+n+(o?"s":"")}});var SV=M((dnr,ule)=>{function gFe(t){r.debug=r,r.default=r,r.coerce=u,r.disable=s,r.enable=o,r.enabled=a,r.humanize=cle(),r.destroy=l,Object.keys(t).forEach(d=>{r[d]=t[d]}),r.names=[],r.skips=[],r.formatters={};function e(d){let p=0;for(let f=0;f<d.length;f++)p=(p<<5)-p+d.charCodeAt(f),p|=0;return r.colors[Math.abs(p)%r.colors.length]}r.selectColor=e;function r(d){let p,f=null,m,h;function g(...v){if(!g.enabled)return;let y=g,b=Number(new Date),_=b-(p||b);y.diff=_,y.prev=p,y.curr=b,p=b,v[0]=r.coerce(v[0]),typeof v[0]!="string"&&v.unshift("%O");let S=0;v[0]=v[0].replace(/%([a-zA-Z%])/g,(T,A)=>{if(T==="%%")return"%";S++;let B=r.formatters[A];if(typeof B=="function"){let j=v[S];T=B.call(y,j),v.splice(S,1),S--}return T}),r.formatArgs.call(y,v),(y.log||r.log).apply(y,v)}return g.namespace=d,g.useColors=r.useColors(),g.color=r.selectColor(d),g.extend=n,g.destroy=r.destroy,Object.defineProperty(g,"enabled",{enumerable:!0,configurable:!1,get:()=>f!==null?f:(m!==r.namespaces&&(m=r.namespaces,h=r.enabled(d)),h),set:v=>{f=v}}),typeof r.init=="function"&&r.init(g),g}function n(d,p){let f=r(this.namespace+(typeof p>"u"?":":p)+d);return f.log=this.log,f}function o(d){r.save(d),r.namespaces=d,r.names=[],r.skips=[];let p,f=(typeof d=="string"?d:"").split(/[\s,]+/),m=f.length;for(p=0;p<m;p++)f[p]&&(d=f[p].replace(/\*/g,".*?"),d[0]==="-"?r.skips.push(new RegExp("^"+d.slice(1)+"$")):r.names.push(new RegExp("^"+d+"$")))}function s(){let d=[...r.names.map(c),...r.skips.map(c).map(p=>"-"+p)].join(",");return r.enable(""),d}function a(d){if(d[d.length-1]==="*")return!0;let p,f;for(p=0,f=r.skips.length;p<f;p++)if(r.skips[p].test(d))return!1;for(p=0,f=r.names.length;p<f;p++)if(r.names[p].test(d))return!0;return!1}function c(d){return d.toString().substring(2,d.toString().length-2).replace(/\.\*\?$/,"*")}function u(d){return d instanceof Error?d.stack||d.message:d}function l(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}ule.exports=gFe});var lle=M((Ic,EO)=>{Ic.formatArgs=yFe;Ic.save=bFe;Ic.load=_Fe;Ic.useColors=vFe;Ic.storage=xFe();Ic.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();Ic.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function vFe(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function yFe(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+EO.exports.humanize(this.diff),!this.useColors)return;let e="color: "+this.color;t.splice(1,0,e,"color: inherit");let r=0,n=0;t[0].replace(/%[a-zA-Z%]/g,o=>{o!=="%%"&&(r++,o==="%c"&&(n=r))}),t.splice(n,0,e)}Ic.log=console.debug||console.log||(()=>{});function bFe(t){try{t?Ic.storage.setItem("debug",t):Ic.storage.removeItem("debug")}catch{}}function _Fe(){let t;try{t=Ic.storage.getItem("debug")}catch{}return!t&&typeof process<"u"&&"env"in process&&(t=process.env.DEBUG),t}function xFe(){try{return localStorage}catch{}}EO.exports=SV()(Ic);var{formatters:SFe}=EO.exports;SFe.j=function(t){try{return JSON.stringify(t)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}});var ple=M((pnr,dle)=>{"use strict";dle.exports=(t,e=process.argv)=>{let r=t.startsWith("-")?"":t.length===1?"-":"--",n=e.indexOf(r+t),o=e.indexOf("--");return n!==-1&&(o===-1||n<o)}});var hle=M((fnr,mle)=>{"use strict";var IFe=require("os"),fle=require("tty"),mu=ple(),{env:Ho}=process,hg;mu("no-color")||mu("no-colors")||mu("color=false")||mu("color=never")?hg=0:(mu("color")||mu("colors")||mu("color=true")||mu("color=always"))&&(hg=1);"FORCE_COLOR"in Ho&&(Ho.FORCE_COLOR==="true"?hg=1:Ho.FORCE_COLOR==="false"?hg=0:hg=Ho.FORCE_COLOR.length===0?1:Math.min(parseInt(Ho.FORCE_COLOR,10),3));function IV(t){return t===0?!1:{level:t,hasBasic:!0,has256:t>=2,has16m:t>=3}}function CV(t,e){if(hg===0)return 0;if(mu("color=16m")||mu("color=full")||mu("color=truecolor"))return 3;if(mu("color=256"))return 2;if(t&&!e&&hg===void 0)return 0;let r=hg||0;if(Ho.TERM==="dumb")return r;if(process.platform==="win32"){let n=IFe.release().split(".");return Number(n[0])>=10&&Number(n[2])>=10586?Number(n[2])>=14931?3:2:1}if("CI"in Ho)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","GITHUB_ACTIONS","BUILDKITE"].some(n=>n in Ho)||Ho.CI_NAME==="codeship"?1:r;if("TEAMCITY_VERSION"in Ho)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(Ho.TEAMCITY_VERSION)?1:0;if(Ho.COLORTERM==="truecolor")return 3;if("TERM_PROGRAM"in Ho){let n=parseInt((Ho.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(Ho.TERM_PROGRAM){case"iTerm.app":return n>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(Ho.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(Ho.TERM)||"COLORTERM"in Ho?1:r}function CFe(t){let e=CV(t,t&&t.isTTY);return IV(e)}mle.exports={supportsColor:CFe,stdout:IV(CV(!0,fle.isatty(1))),stderr:IV(CV(!0,fle.isatty(2)))}});var vle=M((is,wO)=>{var EFe=require("tty"),TO=require("util");is.init=DFe;is.log=kFe;is.formatArgs=wFe;is.save=PFe;is.load=AFe;is.useColors=TFe;is.destroy=TO.deprecate(()=>{},"Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.");is.colors=[6,2,3,4,5,1];try{let t=hle();t&&(t.stderr||t).level>=2&&(is.colors=[20,21,26,27,32,33,38,39,40,41,42,43,44,45,56,57,62,63,68,69,74,75,76,77,78,79,80,81,92,93,98,99,112,113,128,129,134,135,148,149,160,161,162,163,164,165,166,167,168,169,170,171,172,173,178,179,184,185,196,197,198,199,200,201,202,203,204,205,206,207,208,209,214,215,220,221])}catch{}is.inspectOpts=Object.keys(process.env).filter(t=>/^debug_/i.test(t)).reduce((t,e)=>{let r=e.substring(6).toLowerCase().replace(/_([a-z])/g,(o,s)=>s.toUpperCase()),n=process.env[e];return/^(yes|on|true|enabled)$/i.test(n)?n=!0:/^(no|off|false|disabled)$/i.test(n)?n=!1:n==="null"?n=null:n=Number(n),t[r]=n,t},{});function TFe(){return"colors"in is.inspectOpts?!!is.inspectOpts.colors:EFe.isatty(process.stderr.fd)}function wFe(t){let{namespace:e,useColors:r}=this;if(r){let n=this.color,o="\x1B[3"+(n<8?n:"8;5;"+n),s=`  ${o};1m${e} \x1B[0m`;t[0]=s+t[0].split(`
`).join(`
`+s),t.push(o+"m+"+wO.exports.humanize(this.diff)+"\x1B[0m")}else t[0]=RFe()+e+" "+t[0]}function RFe(){return is.inspectOpts.hideDate?"":new Date().toISOString()+" "}function kFe(...t){return process.stderr.write(TO.format(...t)+`
`)}function PFe(t){t?process.env.DEBUG=t:delete process.env.DEBUG}function AFe(){return process.env.DEBUG}function DFe(t){t.inspectOpts={};let e=Object.keys(is.inspectOpts);for(let r=0;r<e.length;r++)t.inspectOpts[e[r]]=is.inspectOpts[e[r]]}wO.exports=SV()(is);var{formatters:gle}=wO.exports;gle.o=function(t){return this.inspectOpts.colors=this.useColors,TO.inspect(t,this.inspectOpts).split(`
`).map(e=>e.trim()).join(" ")};gle.O=function(t){return this.inspectOpts.colors=this.useColors,TO.inspect(t,this.inspectOpts)}});var Sl=M((mnr,EV)=>{typeof process>"u"||process.type==="renderer"||process.browser===!0||process.__nwjs?EV.exports=lle():EV.exports=vle()});var AV=M((vnr,xle)=>{var KR=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,NFe=typeof AbortController=="function",RO=NFe?AbortController:class{constructor(){this.signal=new yle}abort(){this.signal.dispatchEvent("abort")}},LFe=typeof AbortSignal=="function",OFe=typeof RO.AbortSignal=="function",yle=LFe?AbortSignal:OFe?RO.AbortController:class{constructor(){this.aborted=!1,this._listeners=[]}dispatchEvent(e){if(e==="abort"){this.aborted=!0;let r={type:e,target:this};this.onabort(r),this._listeners.forEach(n=>n(r),this)}}onabort(){}addEventListener(e,r){e==="abort"&&this._listeners.push(r)}removeEventListener(e,r){e==="abort"&&(this._listeners=this._listeners.filter(n=>n!==r))}},kV=new Set,TV=(t,e)=>{let r=`LRU_CACHE_OPTION_${t}`;kO(r)&&PV(r,`${t} option`,`options.${e}`,GS)},wV=(t,e)=>{let r=`LRU_CACHE_METHOD_${t}`;if(kO(r)){let{prototype:n}=GS,{get:o}=Object.getOwnPropertyDescriptor(n,t);PV(r,`${t} method`,`cache.${e}()`,o)}},MFe=(t,e)=>{let r=`LRU_CACHE_PROPERTY_${t}`;if(kO(r)){let{prototype:n}=GS,{get:o}=Object.getOwnPropertyDescriptor(n,t);PV(r,`${t} property`,`cache.${e}`,o)}},ble=(...t)=>{typeof process=="object"&&process&&typeof process.emitWarning=="function"?process.emitWarning(...t):console.error(...t)},kO=t=>!kV.has(t),PV=(t,e,r,n)=>{kV.add(t);let o=`The ${e} is deprecated. Please use ${r} instead.`;ble(o,"DeprecationWarning",t,n)},my=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),_le=t=>my(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?VS:null:null,VS=class extends Array{constructor(e){super(e),this.fill(0)}},RV=class{constructor(e){if(e===0)return[];let r=_le(e);this.heap=new r(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},GS=class t{constructor(e={}){let{max:r=0,ttl:n,ttlResolution:o=1,ttlAutopurge:s,updateAgeOnGet:a,updateAgeOnHas:c,allowStale:u,dispose:l,disposeAfter:d,noDisposeOnSet:p,noUpdateTTL:f,maxSize:m=0,sizeCalculation:h,fetchMethod:g,fetchContext:v,noDeleteOnFetchRejection:y,noDeleteOnStaleGet:b}=e,{length:_,maxAge:S,stale:I}=e instanceof t?{}:e;if(r!==0&&!my(r))throw new TypeError("max option must be a nonnegative integer");let T=r?_le(r):Array;if(!T)throw new Error("invalid max value: "+r);if(this.max=r,this.maxSize=m,this.sizeCalculation=h||_,this.sizeCalculation){if(!this.maxSize)throw new TypeError("cannot set sizeCalculation without setting maxSize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=g||null,this.fetchMethod&&typeof this.fetchMethod!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=v,!this.fetchMethod&&v!==void 0)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(r).fill(null),this.valList=new Array(r).fill(null),this.next=new T(r),this.prev=new T(r),this.head=0,this.tail=0,this.free=new RV(r),this.initialFill=1,this.size=0,typeof l=="function"&&(this.dispose=l),typeof d=="function"?(this.disposeAfter=d,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!p,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!y,this.maxSize!==0){if(!my(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!u||!!I,this.noDeleteOnStaleGet=!!b,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!c,this.ttlResolution=my(o)||o===0?o:1,this.ttlAutopurge=!!s,this.ttl=n||S||0,this.ttl){if(!my(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){let A="LRU_CACHE_UNBOUNDED";kO(A)&&(kV.add(A),ble("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",A,t))}I&&TV("stale","allowStale"),S&&TV("maxAge","ttl"),_&&TV("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new VS(this.max),this.starts=new VS(this.max),this.setItemTTL=(n,o,s=KR.now())=>{if(this.starts[n]=o!==0?s:0,this.ttls[n]=o,o!==0&&this.ttlAutopurge){let a=setTimeout(()=>{this.isStale(n)&&this.delete(this.keyList[n])},o+1);a.unref&&a.unref()}},this.updateItemAge=n=>{this.starts[n]=this.ttls[n]!==0?KR.now():0};let e=0,r=()=>{let n=KR.now();if(this.ttlResolution>0){e=n;let o=setTimeout(()=>e=0,this.ttlResolution);o.unref&&o.unref()}return n};this.getRemainingTTL=n=>{let o=this.keyMap.get(n);return o===void 0?0:this.ttls[o]===0||this.starts[o]===0?1/0:this.starts[o]+this.ttls[o]-(e||r())},this.isStale=n=>this.ttls[n]!==0&&this.starts[n]!==0&&(e||r())-this.starts[n]>this.ttls[n]}updateItemAge(e){}setItemTTL(e,r,n){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new VS(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,r,n,o)=>{if(!my(n))if(o){if(typeof o!="function")throw new TypeError("sizeCalculation must be a function");if(n=o(r,e),!my(n))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer)");return n},this.addItemSize=(e,r)=>{this.sizes[e]=r;let n=this.maxSize-this.sizes[e];for(;this.calculatedSize>n;)this.evict(!0);this.calculatedSize+=this.sizes[e]}}removeItemSize(e){}addItemSize(e,r){}requireSize(e,r,n,o){if(n||o)throw new TypeError("cannot set size without setting maxSize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let r=this.tail;!(!this.isValidIndex(r)||((e||!this.isStale(r))&&(yield r),r===this.head));)r=this.prev[r]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let r=this.head;!(!this.isValidIndex(r)||((e||!this.isStale(r))&&(yield r),r===this.tail));)r=this.next[r]}isValidIndex(e){return this.keyMap.get(this.keyList[e])===e}*entries(){for(let e of this.indexes())yield[this.keyList[e],this.valList[e]]}*rentries(){for(let e of this.rindexes())yield[this.keyList[e],this.valList[e]]}*keys(){for(let e of this.indexes())yield this.keyList[e]}*rkeys(){for(let e of this.rindexes())yield this.keyList[e]}*values(){for(let e of this.indexes())yield this.valList[e]}*rvalues(){for(let e of this.rindexes())yield this.valList[e]}[Symbol.iterator](){return this.entries()}find(e,r={}){for(let n of this.indexes())if(e(this.valList[n],this.keyList[n],this))return this.get(this.keyList[n],r)}forEach(e,r=this){for(let n of this.indexes())e.call(r,this.valList[n],this.keyList[n],this)}rforEach(e,r=this){for(let n of this.rindexes())e.call(r,this.valList[n],this.keyList[n],this)}get prune(){return wV("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(let r of this.rindexes({allowStale:!0}))this.isStale(r)&&(this.delete(this.keyList[r]),e=!0);return e}dump(){let e=[];for(let r of this.indexes({allowStale:!0})){let n=this.keyList[r],o=this.valList[r],a={value:this.isBackgroundFetch(o)?o.__staleWhileFetching:o};if(this.ttls){a.ttl=this.ttls[r];let c=KR.now()-this.starts[r];a.start=Math.floor(Date.now()-c)}this.sizes&&(a.size=this.sizes[r]),e.unshift([n,a])}return e}load(e){this.clear();for(let[r,n]of e){if(n.start){let o=Date.now()-n.start;n.start=KR.now()-o}this.set(r,n.value,n)}}dispose(e,r,n){}set(e,r,{ttl:n=this.ttl,start:o,noDisposeOnSet:s=this.noDisposeOnSet,size:a=0,sizeCalculation:c=this.sizeCalculation,noUpdateTTL:u=this.noUpdateTTL}={}){if(a=this.requireSize(e,r,a,c),this.maxSize&&a>this.maxSize)return this;let l=this.size===0?void 0:this.keyMap.get(e);if(l===void 0)l=this.newIndex(),this.keyList[l]=e,this.valList[l]=r,this.keyMap.set(e,l),this.next[this.tail]=l,this.prev[l]=this.tail,this.tail=l,this.size++,this.addItemSize(l,a),u=!1;else{let d=this.valList[l];r!==d&&(this.isBackgroundFetch(d)?d.__abortController.abort():s||(this.dispose(d,e,"set"),this.disposeAfter&&this.disposed.push([d,e,"set"])),this.removeItemSize(l),this.valList[l]=r,this.addItemSize(l,a)),this.moveToTail(l)}if(n!==0&&this.ttl===0&&!this.ttls&&this.initializeTTLTracking(),u||this.setItemTTL(l,n,o),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return this.size===0?this.tail:this.size===this.max&&this.max!==0?this.evict(!1):this.free.length!==0?this.free.pop():this.initialFill++}pop(){if(this.size){let e=this.valList[this.head];return this.evict(!0),e}}evict(e){let r=this.head,n=this.keyList[r],o=this.valList[r];return this.isBackgroundFetch(o)?o.__abortController.abort():(this.dispose(o,n,"evict"),this.disposeAfter&&this.disposed.push([o,n,"evict"])),this.removeItemSize(r),e&&(this.keyList[r]=null,this.valList[r]=null,this.free.push(r)),this.head=this.next[r],this.keyMap.delete(n),this.size--,r}has(e,{updateAgeOnHas:r=this.updateAgeOnHas}={}){let n=this.keyMap.get(e);return n!==void 0&&!this.isStale(n)?(r&&this.updateItemAge(n),!0):!1}peek(e,{allowStale:r=this.allowStale}={}){let n=this.keyMap.get(e);if(n!==void 0&&(r||!this.isStale(n))){let o=this.valList[n];return this.isBackgroundFetch(o)?o.__staleWhileFetching:o}}backgroundFetch(e,r,n,o){let s=r===void 0?void 0:this.valList[r];if(this.isBackgroundFetch(s))return s;let a=new RO,c={signal:a.signal,options:n,context:o},u=f=>(a.signal.aborted||this.set(e,f,c.options),f),l=f=>{if(this.valList[r]===p&&(!n.noDeleteOnFetchRejection||p.__staleWhileFetching===void 0?this.delete(e):this.valList[r]=p.__staleWhileFetching),p.__returned===p)throw f},d=f=>f(this.fetchMethod(e,s,c)),p=new Promise(d).then(u,l);return p.__abortController=a,p.__staleWhileFetching=s,p.__returned=null,r===void 0?(this.set(e,p,c.options),r=this.keyMap.get(e)):this.valList[r]=p,p}isBackgroundFetch(e){return e&&typeof e=="object"&&typeof e.then=="function"&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||e.__returned===null)}async fetch(e,{allowStale:r=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,ttl:s=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:c=0,sizeCalculation:u=this.sizeCalculation,noUpdateTTL:l=this.noUpdateTTL,noDeleteOnFetchRejection:d=this.noDeleteOnFetchRejection,fetchContext:p=this.fetchContext,forceRefresh:f=!1}={}){if(!this.fetchMethod)return this.get(e,{allowStale:r,updateAgeOnGet:n,noDeleteOnStaleGet:o});let m={allowStale:r,updateAgeOnGet:n,noDeleteOnStaleGet:o,ttl:s,noDisposeOnSet:a,size:c,sizeCalculation:u,noUpdateTTL:l,noDeleteOnFetchRejection:d},h=this.keyMap.get(e);if(h===void 0){let g=this.backgroundFetch(e,h,m,p);return g.__returned=g}else{let g=this.valList[h];if(this.isBackgroundFetch(g))return r&&g.__staleWhileFetching!==void 0?g.__staleWhileFetching:g.__returned=g;if(!f&&!this.isStale(h))return this.moveToTail(h),n&&this.updateItemAge(h),g;let v=this.backgroundFetch(e,h,m,p);return r&&v.__staleWhileFetching!==void 0?v.__staleWhileFetching:v.__returned=v}}get(e,{allowStale:r=this.allowStale,updateAgeOnGet:n=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet}={}){let s=this.keyMap.get(e);if(s!==void 0){let a=this.valList[s],c=this.isBackgroundFetch(a);return this.isStale(s)?c?r?a.__staleWhileFetching:void 0:(o||this.delete(e),r?a:void 0):c?void 0:(this.moveToTail(s),n&&this.updateItemAge(s),a)}}connect(e,r){this.prev[r]=e,this.next[e]=r}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return wV("del","delete"),this.delete}delete(e){let r=!1;if(this.size!==0){let n=this.keyMap.get(e);if(n!==void 0)if(r=!0,this.size===1)this.clear();else{this.removeItemSize(n);let o=this.valList[n];this.isBackgroundFetch(o)?o.__abortController.abort():(this.dispose(o,e,"delete"),this.disposeAfter&&this.disposed.push([o,e,"delete"])),this.keyMap.delete(e),this.keyList[n]=null,this.valList[n]=null,n===this.tail?this.tail=this.prev[n]:n===this.head?this.head=this.next[n]:(this.next[this.prev[n]]=this.next[n],this.prev[this.next[n]]=this.prev[n]),this.size--,this.free.push(n)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return r}clear(){for(let e of this.rindexes({allowStale:!0})){let r=this.valList[e];if(this.isBackgroundFetch(r))r.__abortController.abort();else{let n=this.keyList[e];this.dispose(r,n,"delete"),this.disposeAfter&&this.disposed.push([r,n,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return wV("reset","clear"),this.clear}get length(){return MFe("length","size"),this.size}static get AbortController(){return RO}static get AbortSignal(){return yle}};xle.exports=GS});var LV=M((ynr,Sle)=>{"use strict";var YR=class extends Error{constructor(e,r){super(e),this.type=r}get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}},DV=class extends YR{constructor(e,r,n){super(e,r),n&&(this.code=n.code,this.errno=n.errno,this.erroredSysCall=n.syscall)}},NV=class extends YR{constructor(e,r="aborted"){super(e,r)}};Sle.exports={FetchBaseError:YR,FetchError:DV,AbortError:NV}});var Rf=M((bnr,Cle)=>{"use strict";var{constants:{MAX_LENGTH:FFe}}=require("buffer"),{pipeline:PO,PassThrough:UFe}=require("stream"),{promisify:BFe}=require("util"),{createGunzip:qFe,createInflate:HFe,createBrotliDecompress:jFe,constants:{Z_SYNC_FLUSH:Ile}}=require("zlib"),VFe=Sl()("helix-fetch:utils"),GFe=BFe(PO),zFe=(t,e)=>t===204||t===304||+e["content-length"]==0?!1:/^\s*(?:(x-)?deflate|(x-)?gzip|br)\s*$/.test(e["content-encoding"]),$Fe=(t,e,r,n)=>{if(!zFe(t,e))return r;let o=s=>{s&&(VFe(`encountered error while decoding stream: ${s}`),n(s))};switch(e["content-encoding"].trim()){case"gzip":case"x-gzip":return PO(r,qFe({flush:Ile,finishFlush:Ile}),o);case"deflate":case"x-deflate":return PO(r,HFe(),o);case"br":return PO(r,jFe(),o);default:return r}},WFe=t=>{if(!t||typeof t!="object"||Object.prototype.toString.call(t)!=="[object Object]")return!1;if(Object.getPrototypeOf(t)===null)return!0;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e},AO=(t,e)=>{if(Buffer.isBuffer(t))return t.length;switch(typeof t){case"string":return t.length*2;case"boolean":return 4;case"number":return 8;case"symbol":return Symbol.keyFor(t)?Symbol.keyFor(t).length*2:(t.toString().length-8)*2;case"object":return Array.isArray(t)?KFe(t,e):YFe(t,e);default:return 0}},KFe=(t,e)=>(e.add(t),t.map(r=>e.has(r)?0:AO(r,e)).reduce((r,n)=>r+n,0)),YFe=(t,e)=>{if(t==null)return 0;e.add(t);let r=0,n=[];for(let o in t)n.push(o);return n.push(...Object.getOwnPropertySymbols(t)),n.forEach(o=>{if(r+=AO(o,e),typeof t[o]=="object"&&t[o]!==null){if(e.has(t[o]))return;e.add(t[o])}r+=AO(t[o],e)}),r},QFe=t=>AO(t,new WeakSet),XFe=async t=>{let e=new UFe,r=0,n=[];return e.on("data",o=>{if(r+o.length>FFe)throw new Error("Buffer.constants.MAX_SIZE exceeded");n.push(o),r+=o.length}),await GFe(t,e),Buffer.concat(n,r)};Cle.exports={decodeStream:$Fe,isPlainObject:WFe,sizeof:QFe,streamToBuffer:XFe}});var NO=M((_nr,Rle)=>{"use strict";var{PassThrough:Ele,Readable:kf}=require("stream"),{types:{isAnyArrayBuffer:wle}}=require("util"),{FetchError:JFe,FetchBaseError:ZFe}=LV(),{streamToBuffer:e9e}=Rf(),t9e=Buffer.alloc(0),hu=Symbol("Body internals"),r9e=t=>t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength),Tle=async t=>{if(t[hu].disturbed)throw new TypeError("Already read");if(t[hu].error)throw new TypeError(`Stream had error: ${t[hu].error.message}`);t[hu].disturbed=!0;let{stream:e}=t[hu];return e===null?t9e:e9e(e)},DO=class{constructor(e){let r;e==null?r=null:e instanceof URLSearchParams?r=kf.from(e.toString()):e instanceof kf?r=e:Buffer.isBuffer(e)?r=kf.from(e):wle(e)?r=kf.from(Buffer.from(e)):typeof e=="string"||e instanceof String?r=kf.from(e):r=kf.from(String(e)),this[hu]={stream:r,disturbed:!1,error:null},e instanceof kf&&r.on("error",n=>{let o=n instanceof ZFe?n:new JFe(`Invalid response body while trying to fetch ${this.url}: ${n.message}`,"system",n);this[hu].error=o})}get body(){return this[hu].stream}get bodyUsed(){return this[hu].disturbed}async buffer(){return Tle(this)}async arrayBuffer(){return r9e(await this.buffer())}async text(){return(await Tle(this)).toString()}async json(){return JSON.parse(await this.text())}};Object.defineProperties(DO.prototype,{body:{enumerable:!0},bodyUsed:{enumerable:!0},arrayBuffer:{enumerable:!0},json:{enumerable:!0},text:{enumerable:!0}});var n9e=t=>{if(t[hu].disturbed)throw new TypeError("Cannot clone: already read");let{stream:e}=t[hu],r=e;if(e instanceof kf){r=new Ele;let n=new Ele;e.pipe(r),e.pipe(n),t[hu].stream=n}return r},i9e=t=>t===null?null:typeof t=="string"?"text/plain; charset=utf-8":t instanceof URLSearchParams?"application/x-www-form-urlencoded; charset=utf-8":Buffer.isBuffer(t)||wle(t)||t instanceof kf?null:"text/plain; charset=utf-8";Rle.exports={Body:DO,cloneStream:n9e,guessContentType:i9e}});var zS=M((xnr,Dle)=>{"use strict";var{validateHeaderName:kle,validateHeaderValue:Ple}=require("http"),{isPlainObject:o9e}=Rf(),Pf=Symbol("Headers internals"),QR=t=>{let e=typeof t!="string"?String(t):t;if(typeof kle=="function")kle(e);else if(!/^[\^`\-\w!#$%&'*+.|~]+$/.test(e)){let r=new TypeError(`Header name must be a valid HTTP token [${e}]`);throw Object.defineProperty(r,"code",{value:"ERR_INVALID_HTTP_TOKEN"}),r}return e.toLowerCase()},Ale=(t,e)=>{let r=typeof t!="string"?String(t):t;if(typeof Ple=="function")Ple(e,r);else if(/[^\t\u0020-\u007E\u0080-\u00FF]/.test(r)){let n=new TypeError(`Invalid character in header content ["${e}"]`);throw Object.defineProperty(n,"code",{value:"ERR_INVALID_CHAR"}),n}return r},LO=class t{constructor(e={}){if(this[Pf]={map:new Map},e instanceof t)e.forEach((r,n)=>{this.append(n,r)});else if(Array.isArray(e))e.forEach(([r,n])=>{this.append(r,n)});else if(o9e(e))for(let[r,n]of Object.entries(e))this.append(r,n)}set(e,r){this[Pf].map.set(QR(e),Ale(r,e))}has(e){return this[Pf].map.has(QR(e))}get(e){let r=this[Pf].map.get(QR(e));return r===void 0?null:r}append(e,r){let n=QR(e),o=Ale(r,e),s=this[Pf].map.get(n);this[Pf].map.set(n,s?`${s}, ${o}`:o)}delete(e){this[Pf].map.delete(QR(e))}forEach(e,r){for(let n of this.keys())e.call(r,this.get(n),n)}keys(){return Array.from(this[Pf].map.keys()).sort()}*values(){for(let e of this.keys())yield this.get(e)}*entries(){for(let e of this.keys())yield[e,this.get(e)]}[Symbol.iterator](){return this.entries()}get[Symbol.toStringTag](){return this.constructor.name}plain(){return Object.fromEntries(this[Pf].map)}};Object.defineProperties(LO.prototype,["append","delete","entries","forEach","get","has","keys","set","values"].reduce((t,e)=>(t[e]={enumerable:!0},t),{}));Dle.exports={Headers:LO}});var OV=M((Snr,Nle)=>{"use strict";var{EventEmitter:s9e}=require("events"),Il=Symbol("AbortSignal internals"),$S=class{constructor(){this[Il]={eventEmitter:new s9e,onabort:null,aborted:!1}}get aborted(){return this[Il].aborted}get onabort(){return this[Il].onabort}set onabort(e){this[Il].onabort=e}get[Symbol.toStringTag](){return this.constructor.name}removeEventListener(e,r){this[Il].eventEmitter.removeListener(e,r)}addEventListener(e,r){this[Il].eventEmitter.on(e,r)}dispatchEvent(e){let r={type:e,target:this},n=`on${e}`;typeof this[Il][n]=="function"&&this[n](r),this[Il].eventEmitter.emit(e,r)}fire(){this[Il].aborted=!0,this.dispatchEvent("abort")}};Object.defineProperties($S.prototype,{addEventListener:{enumerable:!0},removeEventListener:{enumerable:!0},dispatchEvent:{enumerable:!0},aborted:{enumerable:!0},onabort:{enumerable:!0}});var MO=class extends $S{constructor(e){if(!Number.isInteger(e))throw new TypeError(`Expected an integer, got ${typeof e}`);super(),this[Il].timerId=setTimeout(()=>{this.fire()},e)}clear(){clearTimeout(this[Il].timerId)}};Object.defineProperties(MO.prototype,{clear:{enumerable:!0}});var OO=Symbol("AbortController internals"),FO=class{constructor(){this[OO]={signal:new $S}}get signal(){return this[OO].signal}get[Symbol.toStringTag](){return this.constructor.name}abort(){this[OO].signal.aborted||this[OO].signal.fire()}};Object.defineProperties(FO.prototype,{signal:{enumerable:!0},abort:{enumerable:!0}});Nle.exports={AbortController:FO,AbortSignal:$S,TimeoutSignal:MO}});var XR=M((Inr,Mle)=>{"use strict";var{randomBytes:a9e}=require("crypto"),{Readable:c9e}=require("stream"),FV=t=>typeof t=="object"&&["arrayBuffer","stream","text","slice","constructor"].map(e=>typeof t[e]).filter(e=>e!=="function").length===0&&typeof t.type=="string"&&typeof t.size=="number"&&/^(Blob|File)$/.test(t[Symbol.toStringTag]),u9e=t=>t!=null&&typeof t=="object"&&["append","delete","get","getAll","has","set","keys","values","entries","constructor"].map(e=>typeof t[e]).filter(e=>e!=="function").length===0&&t[Symbol.toStringTag]==="FormData",Lle=t=>`--${t}--\r
\r
`,Ole=(t,e,r)=>{let n="";return n+=`--${t}\r
`,n+=`Content-Disposition: form-data; name="${e}"`,FV(r)&&(n+=`; filename="${r.name}"\r
`,n+=`Content-Type: ${r.type||"application/octet-stream"}`),`${n}\r
\r
`};async function*l9e(t,e){for(let[r,n]of t)yield Ole(e,r,n),FV(n)?yield*n.stream():yield n,yield`\r
`;yield Lle(e)}var d9e=(t,e)=>{let r=0;for(let[n,o]of t)r+=Buffer.byteLength(Ole(e,n,o)),r+=FV(o)?o.size:Buffer.byteLength(String(o)),r+=Buffer.byteLength(`\r
`);return r+=Buffer.byteLength(Lle(e)),r},MV=class{constructor(e){this.fd=e,this.boundary=a9e(8).toString("hex")}length(){return typeof this._length>"u"&&(this._length=d9e(this.fd,this.boundary)),this._length}contentType(){return`multipart/form-data; boundary=${this.boundary}`}stream(){return c9e.from(l9e(this.fd,this.boundary))}};Mle.exports={isFormData:u9e,FormDataSerializer:MV}});var Ule=M((Cnr,Fle)=>{"use strict";var{AbortSignal:p9e}=OV(),{Body:f9e,cloneStream:m9e,guessContentType:h9e}=NO(),{Headers:g9e}=zS(),{isPlainObject:v9e}=Rf(),{isFormData:y9e,FormDataSerializer:b9e}=XR(),_9e=20,gg=Symbol("Request internals"),UO=class t extends f9e{constructor(e,r={}){let n=e instanceof t?e:null,o=n?new URL(n.url):new URL(e),s=r.method||n&&n.method||"GET";if(s=s.toUpperCase(),(r.body!=null||n&&n.body!==null)&&["GET","HEAD"].includes(s))throw new TypeError("Request with GET/HEAD method cannot have body");let a=r.body||(n&&n.body?m9e(n):null),c=new g9e(r.headers||n&&n.headers||{});if(y9e(a)&&!c.has("content-type")){let p=new b9e(a);a=p.stream(),c.set("content-type",p.contentType()),!c.has("transfer-encoding")&&!c.has("content-length")&&c.set("content-length",p.length())}if(!c.has("content-type"))if(v9e(a))a=JSON.stringify(a),c.set("content-type","application/json");else{let p=h9e(a);p&&c.set("content-type",p)}super(a);let u=n?n.signal:null;if("signal"in r&&(u=r.signal),u&&!(u instanceof p9e))throw new TypeError("signal needs to be an instance of AbortSignal");let l=r.redirect||n&&n.redirect||"follow";if(!["follow","error","manual"].includes(l))throw new TypeError(`'${l}' is not a valid redirect option`);let d=r.cache||n&&n.cache||"default";if(!["default","no-store","reload","no-cache","force-cache","only-if-cached"].includes(d))throw new TypeError(`'${d}' is not a valid cache option`);this[gg]={init:{...r},method:s,redirect:l,cache:d,headers:c,parsedURL:o,signal:u},r.follow===void 0?!n||n.follow===void 0?this.follow=_9e:this.follow=n.follow:this.follow=r.follow,this.counter=r.counter||n&&n.counter||0,r.compress===void 0?!n||n.compress===void 0?this.compress=!0:this.compress=n.compress:this.compress=r.compress,r.decode===void 0?!n||n.decode===void 0?this.decode=!0:this.decode=n.decode:this.decode=r.decode}get method(){return this[gg].method}get url(){return this[gg].parsedURL.toString()}get headers(){return this[gg].headers}get redirect(){return this[gg].redirect}get cache(){return this[gg].cache}get signal(){return this[gg].signal}clone(){return new t(this)}get init(){return this[gg].init}get[Symbol.toStringTag](){return this.constructor.name}};Object.defineProperties(UO.prototype,{method:{enumerable:!0},url:{enumerable:!0},headers:{enumerable:!0},redirect:{enumerable:!0},cache:{enumerable:!0},clone:{enumerable:!0},signal:{enumerable:!0}});Fle.exports={Request:UO}});var UV=M((Enr,Ble)=>{"use strict";var{Body:x9e,cloneStream:S9e,guessContentType:I9e}=NO(),{Headers:C9e}=zS(),{isPlainObject:E9e}=Rf(),{isFormData:T9e,FormDataSerializer:w9e}=XR(),Cl=Symbol("Response internals"),BO=class t extends x9e{constructor(e=null,r={}){let n=new C9e(r.headers),o=e;if(T9e(o)&&!n.has("content-type")){let s=new w9e(o);o=s.stream(),n.set("content-type",s.contentType()),!n.has("transfer-encoding")&&!n.has("content-length")&&n.set("content-length",s.length())}if(o!==null&&!n.has("content-type"))if(E9e(o))o=JSON.stringify(o),n.set("content-type","application/json");else{let s=I9e(o);s&&n.set("content-type",s)}super(o),this[Cl]={url:r.url,status:r.status||200,statusText:r.statusText||"",headers:n,httpVersion:r.httpVersion,decoded:r.decoded,counter:r.counter}}get url(){return this[Cl].url||""}get status(){return this[Cl].status}get statusText(){return this[Cl].statusText}get ok(){return this[Cl].status>=200&&this[Cl].status<300}get redirected(){return this[Cl].counter>0}get headers(){return this[Cl].headers}get httpVersion(){return this[Cl].httpVersion}get decoded(){return this[Cl].decoded}static redirect(e,r=302){if(![301,302,303,307,308].includes(r))throw new RangeError("Invalid status code");return new t(null,{headers:{location:new URL(e).toString()},status:r})}clone(){if(this.bodyUsed)throw new TypeError("Cannot clone: already read");return new t(S9e(this),{...this[Cl]})}get[Symbol.toStringTag](){return this.constructor.name}};Object.defineProperties(BO.prototype,{url:{enumerable:!0},status:{enumerable:!0},ok:{enumerable:!0},redirected:{enumerable:!0},statusText:{enumerable:!0},headers:{enumerable:!0},clone:{enumerable:!0}});Ble.exports={Response:BO}});var Hle=M((wnr,qle)=>{"use strict";var R9e=new Set([200,203,204,206,300,301,308,404,405,410,414,501]),k9e=new Set([200,203,204,300,301,302,303,307,308,404,405,410,414,501]),P9e=new Set([500,502,503,504]),A9e={date:!0,connection:!0,"keep-alive":!0,"proxy-authenticate":!0,"proxy-authorization":!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0},D9e={"content-length":!0,"content-encoding":!0,"transfer-encoding":!0,"content-range":!0};function hy(t){let e=parseInt(t,10);return isFinite(e)?e:0}function N9e(t){return t?P9e.has(t.status):!0}function BV(t){let e={};if(!t)return e;let r=t.trim().split(/,/);for(let n of r){let[o,s]=n.split(/=/,2);e[o.trim()]=s===void 0?!0:s.trim().replace(/^"|"$/g,"")}return e}function L9e(t){let e=[];for(let r in t){let n=t[r];e.push(n===!0?r:r+"="+n)}if(e.length)return e.join(", ")}qle.exports=class{constructor(e,r,{shared:n,cacheHeuristic:o,immutableMinTimeToLive:s,ignoreCargoCult:a,_fromObject:c}={}){if(c){this._fromObject(c);return}if(!r||!r.headers)throw Error("Response headers missing");this._assertRequestHasHeaders(e),this._responseTime=this.now(),this._isShared=n!==!1,this._cacheHeuristic=o!==void 0?o:.1,this._immutableMinTtl=s!==void 0?s:24*3600*1e3,this._status="status"in r?r.status:200,this._resHeaders=r.headers,this._rescc=BV(r.headers["cache-control"]),this._method="method"in e?e.method:"GET",this._url=e.url,this._host=e.headers.host,this._noAuthorization=!e.headers.authorization,this._reqHeaders=r.headers.vary?e.headers:null,this._reqcc=BV(e.headers["cache-control"]),a&&"pre-check"in this._rescc&&"post-check"in this._rescc&&(delete this._rescc["pre-check"],delete this._rescc["post-check"],delete this._rescc["no-cache"],delete this._rescc["no-store"],delete this._rescc["must-revalidate"],this._resHeaders=Object.assign({},this._resHeaders,{"cache-control":L9e(this._rescc)}),delete this._resHeaders.expires,delete this._resHeaders.pragma),r.headers["cache-control"]==null&&/no-cache/.test(r.headers.pragma)&&(this._rescc["no-cache"]=!0)}now(){return Date.now()}storable(){return!!(!this._reqcc["no-store"]&&(this._method==="GET"||this._method==="HEAD"||this._method==="POST"&&this._hasExplicitExpiration())&&k9e.has(this._status)&&!this._rescc["no-store"]&&(!this._isShared||!this._rescc.private)&&(!this._isShared||this._noAuthorization||this._allowsStoringAuthenticated())&&(this._resHeaders.expires||this._rescc["max-age"]||this._isShared&&this._rescc["s-maxage"]||this._rescc.public||R9e.has(this._status)))}_hasExplicitExpiration(){return this._isShared&&this._rescc["s-maxage"]||this._rescc["max-age"]||this._resHeaders.expires}_assertRequestHasHeaders(e){if(!e||!e.headers)throw Error("Request headers missing")}satisfiesWithoutRevalidation(e){this._assertRequestHasHeaders(e);let r=BV(e.headers["cache-control"]);return r["no-cache"]||/no-cache/.test(e.headers.pragma)||r["max-age"]&&this.age()>r["max-age"]||r["min-fresh"]&&this.timeToLive()<1e3*r["min-fresh"]||this.stale()&&!(r["max-stale"]&&!this._rescc["must-revalidate"]&&(r["max-stale"]===!0||r["max-stale"]>this.age()-this.maxAge()))?!1:this._requestMatches(e,!1)}_requestMatches(e,r){return(!this._url||this._url===e.url)&&this._host===e.headers.host&&(!e.method||this._method===e.method||r&&e.method==="HEAD")&&this._varyMatches(e)}_allowsStoringAuthenticated(){return this._rescc["must-revalidate"]||this._rescc.public||this._rescc["s-maxage"]}_varyMatches(e){if(!this._resHeaders.vary)return!0;if(this._resHeaders.vary==="*")return!1;let r=this._resHeaders.vary.trim().toLowerCase().split(/\s*,\s*/);for(let n of r)if(e.headers[n]!==this._reqHeaders[n])return!1;return!0}_copyWithoutHopByHopHeaders(e){let r={};for(let n in e)A9e[n]||(r[n]=e[n]);if(e.connection){let n=e.connection.trim().split(/\s*,\s*/);for(let o of n)delete r[o]}if(r.warning){let n=r.warning.split(/,/).filter(o=>!/^\s*1[0-9][0-9]/.test(o));n.length?r.warning=n.join(",").trim():delete r.warning}return r}responseHeaders(){let e=this._copyWithoutHopByHopHeaders(this._resHeaders),r=this.age();return r>3600*24&&!this._hasExplicitExpiration()&&this.maxAge()>3600*24&&(e.warning=(e.warning?`${e.warning}, `:"")+'113 - "rfc7234 5.5.4"'),e.age=`${Math.round(r)}`,e.date=new Date(this.now()).toUTCString(),e}date(){let e=Date.parse(this._resHeaders.date);return isFinite(e)?e:this._responseTime}age(){let e=this._ageValue(),r=(this.now()-this._responseTime)/1e3;return e+r}_ageValue(){return hy(this._resHeaders.age)}maxAge(){if(!this.storable()||this._rescc["no-cache"]||this._isShared&&this._resHeaders["set-cookie"]&&!this._rescc.public&&!this._rescc.immutable||this._resHeaders.vary==="*")return 0;if(this._isShared){if(this._rescc["proxy-revalidate"])return 0;if(this._rescc["s-maxage"])return hy(this._rescc["s-maxage"])}if(this._rescc["max-age"])return hy(this._rescc["max-age"]);let e=this._rescc.immutable?this._immutableMinTtl:0,r=this.date();if(this._resHeaders.expires){let n=Date.parse(this._resHeaders.expires);return Number.isNaN(n)||n<r?0:Math.max(e,(n-r)/1e3)}if(this._resHeaders["last-modified"]){let n=Date.parse(this._resHeaders["last-modified"]);if(isFinite(n)&&r>n)return Math.max(e,(r-n)/1e3*this._cacheHeuristic)}return e}timeToLive(){let e=this.maxAge()-this.age(),r=e+hy(this._rescc["stale-if-error"]),n=e+hy(this._rescc["stale-while-revalidate"]);return Math.max(0,e,r,n)*1e3}stale(){return this.maxAge()<=this.age()}_useStaleIfError(){return this.maxAge()+hy(this._rescc["stale-if-error"])>this.age()}useStaleWhileRevalidate(){return this.maxAge()+hy(this._rescc["stale-while-revalidate"])>this.age()}static fromObject(e){return new this(void 0,void 0,{_fromObject:e})}_fromObject(e){if(this._responseTime)throw Error("Reinitialized");if(!e||e.v!==1)throw Error("Invalid serialization");this._responseTime=e.t,this._isShared=e.sh,this._cacheHeuristic=e.ch,this._immutableMinTtl=e.imm!==void 0?e.imm:24*3600*1e3,this._status=e.st,this._resHeaders=e.resh,this._rescc=e.rescc,this._method=e.m,this._url=e.u,this._host=e.h,this._noAuthorization=e.a,this._reqHeaders=e.reqh,this._reqcc=e.reqcc}toObject(){return{v:1,t:this._responseTime,sh:this._isShared,ch:this._cacheHeuristic,imm:this._immutableMinTtl,st:this._status,resh:this._resHeaders,rescc:this._rescc,m:this._method,u:this._url,h:this._host,a:this._noAuthorization,reqh:this._reqHeaders,reqcc:this._reqcc}}revalidationHeaders(e){this._assertRequestHasHeaders(e);let r=this._copyWithoutHopByHopHeaders(e.headers);if(delete r["if-range"],!this._requestMatches(e,!0)||!this.storable())return delete r["if-none-match"],delete r["if-modified-since"],r;if(this._resHeaders.etag&&(r["if-none-match"]=r["if-none-match"]?`${r["if-none-match"]}, ${this._resHeaders.etag}`:this._resHeaders.etag),r["accept-ranges"]||r["if-match"]||r["if-unmodified-since"]||this._method&&this._method!="GET"){if(delete r["if-modified-since"],r["if-none-match"]){let o=r["if-none-match"].split(/,/).filter(s=>!/^\s*W\//.test(s));o.length?r["if-none-match"]=o.join(",").trim():delete r["if-none-match"]}}else this._resHeaders["last-modified"]&&!r["if-modified-since"]&&(r["if-modified-since"]=this._resHeaders["last-modified"]);return r}revalidatedPolicy(e,r){if(this._assertRequestHasHeaders(e),this._useStaleIfError()&&N9e(r))return{modified:!1,matches:!1,policy:this};if(!r||!r.headers)throw Error("Response headers missing");let n=!1;if(r.status!==void 0&&r.status!=304?n=!1:r.headers.etag&&!/^\s*W\//.test(r.headers.etag)?n=this._resHeaders.etag&&this._resHeaders.etag.replace(/^\s*W\//,"")===r.headers.etag:this._resHeaders.etag&&r.headers.etag?n=this._resHeaders.etag.replace(/^\s*W\//,"")===r.headers.etag.replace(/^\s*W\//,""):this._resHeaders["last-modified"]?n=this._resHeaders["last-modified"]===r.headers["last-modified"]:!this._resHeaders.etag&&!this._resHeaders["last-modified"]&&!r.headers.etag&&!r.headers["last-modified"]&&(n=!0),!n)return{policy:new this.constructor(e,r),modified:r.status!=304,matches:!1};let o={};for(let a in this._resHeaders)o[a]=a in r.headers&&!D9e[a]?r.headers[a]:this._resHeaders[a];let s=Object.assign({},r,{status:this._status,method:this._method,headers:o});return{policy:new this.constructor(e,s,{shared:this._isShared,cacheHeuristic:this._cacheHeuristic,immutableMinTimeToLive:this._immutableMinTtl}),modified:!1,matches:!0}}}});var zle=M((Rnr,Gle)=>{"use strict";var O9e=Hle(),{Headers:M9e}=zS(),jle=t=>({url:t.url,method:t.method,headers:t.headers.plain()}),Vle=t=>({status:t.status,headers:t.headers.plain()}),qV=class{constructor(e,r,n){this.policy=new O9e(jle(e),Vle(r),n)}storable(){return this.policy.storable()}satisfiesWithoutRevalidation(e){return this.policy.satisfiesWithoutRevalidation(jle(e))}responseHeaders(e){return new M9e(this.policy.responseHeaders(Vle(e)))}timeToLive(){return this.policy.timeToLive()}};Gle.exports=qV});var Kle=M((knr,Wle)=>{"use strict";var{Readable:F9e}=require("stream"),{Headers:$le}=zS(),{Response:U9e}=UV(),vg=Symbol("CacheableResponse internals"),B9e=t=>t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength),HV=class t extends U9e{constructor(e,r){super(e,r);let n=new $le(r.headers);this[vg]={headers:n,bufferedBody:e}}get headers(){return this[vg].headers}set headers(e){if(e instanceof $le)this[vg].headers=e;else throw new TypeError("instance of Headers expected")}get body(){return F9e.from(this[vg].bufferedBody)}get bodyUsed(){return!1}async buffer(){return this[vg].bufferedBody}async arrayBuffer(){return B9e(this[vg].bufferedBody)}async text(){return this[vg].bufferedBody.toString()}async json(){return JSON.parse(await this.text())}clone(){let{url:e,status:r,statusText:n,headers:o,httpVersion:s,decoded:a,counter:c}=this;return new t(this[vg].bufferedBody,{url:e,status:r,statusText:n,headers:o,httpVersion:s,decoded:a,counter:c})}get[Symbol.toStringTag](){return this.constructor.name}},q9e=async t=>{let e=await t.buffer(),{url:r,status:n,statusText:o,headers:s,httpVersion:a,decoded:c,counter:u}=t;return new HV(e,{url:r,status:n,statusText:o,headers:s,httpVersion:a,decoded:c,counter:u})};Wle.exports={cacheableResponse:q9e}});var qO=M((Pnr,Yle)=>{"use strict";var jV=class extends Error{get name(){return this.constructor.name}get[Symbol.toStringTag](){return this.constructor.name}};Yle.exports={RequestAbortedError:jV}});var ede=M((Anr,Zle)=>{"use strict";var Xle=require("http"),Jle=require("https"),{Readable:H9e}=require("stream"),Af=Sl()("helix-fetch:h1"),{RequestAbortedError:Qle}=qO(),{decodeStream:j9e}=Rf(),V9e=(t,e)=>{let{h1:r,options:{h1:n,rejectUnauthorized:o}}=t;return e==="https:"?r.httpsAgent?r.httpsAgent:n||typeof o=="boolean"?(r.httpsAgent=new Jle.Agent(typeof o=="boolean"?{...n||{},rejectUnauthorized:o}:n),r.httpsAgent):void 0:r.httpAgent?r.httpAgent:n?(r.httpAgent=new Xle.Agent(n),r.httpAgent):void 0},G9e=t=>{t.h1={}},z9e=async({h1:t})=>{t.httpAgent&&(Af("resetContext: destroying httpAgent"),t.httpAgent.destroy(),delete t.httpAgent),t.httpsAgent&&(Af("resetContext: destroying httpsAgent"),t.httpsAgent.destroy(),delete t.httpsAgent)},$9e=(t,e,r)=>{let{statusCode:n,statusMessage:o,httpVersion:s,httpVersionMajor:a,httpVersionMinor:c,headers:u}=t,l=e?j9e(n,u,t,r):t;return{statusCode:n,statusText:o,httpVersion:s,httpVersionMajor:a,httpVersionMinor:c,headers:u,readable:l,decoded:!!(e&&l!==t)}},W9e=async(t,e,r)=>{let{request:n}=e.protocol==="https:"?Jle:Xle,o=V9e(t,e.protocol),s={...r,agent:o},{socket:a,body:c}=s;return a&&(delete s.socket,a.assigned||(a.assigned=!0,o?s.agent=new Proxy(o,{get:(u,l)=>l==="createConnection"&&!a.inUse?(d,p)=>{Af(`agent reusing socket #${a.id} (${a.servername})`),a.inUse=!0,p(null,a)}:u[l]}):s.createConnection=(u,l)=>{Af(`reusing socket #${a.id} (${a.servername})`),a.inUse=!0,l(null,a)})),new Promise((u,l)=>{Af(`${s.method} ${e.href}`);let d,{signal:p}=s,f=()=>{p.removeEventListener("abort",f),a&&!a.inUse&&(Af(`discarding redundant socket used for ALPN: #${a.id} ${a.servername}`),a.destroy()),l(new Qle),d&&d.abort()};if(p){if(p.aborted){l(new Qle);return}p.addEventListener("abort",f)}d=n(e,s),d.once("response",m=>{p&&p.removeEventListener("abort",f),a&&!a.inUse&&(Af(`discarding redundant socket used for ALPN: #${a.id} ${a.servername}`),a.destroy()),u($9e(m,s.decode,l))}),d.once("error",m=>{p&&p.removeEventListener("abort",f),a&&!a.inUse&&(Af(`discarding redundant socket used for ALPN: #${a.id} ${a.servername}`),a.destroy()),d.aborted||(Af(`${s.method} ${e.href} failed with: ${m.message}`),d.abort(),l(m))}),c instanceof H9e?c.pipe(d):(c&&d.write(c),d.end())})};Zle.exports={request:W9e,setupContext:G9e,resetContext:z9e}});var ide=M((Dnr,nde)=>{"use strict";var{connect:K9e,constants:Y9e}=require("http2"),{Readable:Q9e}=require("stream"),Un=Sl()("helix-fetch:h2"),{RequestAbortedError:tde}=qO(),{decodeStream:X9e}=Rf(),{NGHTTP2_CANCEL:JR}=Y9e,J9e=5*60*1e3,Z9e=5e3,e7e=t=>{t.h2={sessionCache:{}}},t7e=async({h2:t})=>Promise.all(Object.values(t.sessionCache).map(e=>new Promise(r=>{e.on("close",r),Un(`resetContext: destroying session (socket #${e.socket&&e.socket.id}, ${e.socket&&e.socket.servername})`),e.destroy()}))),rde=(t,e,r,n=()=>{})=>{let o={...t},s=o[":status"];delete o[":status"];let a=r?X9e(s,t,e,n):e;return{statusCode:s,statusText:"",httpVersion:"2.0",httpVersionMajor:2,httpVersionMinor:0,headers:o,readable:a,decoded:!!(r&&a!==e)}},r7e=(t,e,r,n,o,s)=>{let{options:{h2:{pushPromiseHandler:a,pushHandler:c,pushedStreamIdleTimeout:u=Z9e}}}=t,l=o[":path"],d=`${e}${l}`;Un(`received PUSH_PROMISE: ${d}, stream #${n.id}, headers: ${JSON.stringify(o)}, flags: ${s}`),a&&a(d,o,()=>{n.close(JR)}),n.on("push",(p,f)=>{Un(`received push headers for ${e}${l}, stream #${n.id}, headers: ${JSON.stringify(p)}, flags: ${f}`),n.setTimeout(u,()=>{Un(`closing pushed stream #${n.id} after ${u} ms of inactivity`),n.close(JR)}),c&&c(d,o,rde(p,n,r))}),n.on("aborted",()=>{Un(`pushed stream #${n.id} aborted`)}),n.on("error",p=>{Un(`pushed stream #${n.id} encountered error: ${p}`)}),n.on("frameError",(p,f,m)=>{Un(`pushed stream #${n.id} encountered frameError: type: ${p}, code: ${f}, id: ${m}`)})},n7e=async(t,e,r)=>{let{origin:n,pathname:o,search:s,hash:a}=e,c=`${o}${s}${a}`,{options:{h2:u={}},h2:{sessionCache:l}}=t,{idleSessionTimeout:d=J9e,pushPromiseHandler:p,pushHandler:f}=u,m={...r},{method:h,headers:g,socket:v,body:y,decode:b}=m;return v&&delete m.socket,g.host&&(g[":authority"]=g.host,delete g.host),new Promise((_,S)=>{let I=l[n];if(!I||I.closed||I.destroyed){let F=!(t.options.rejectUnauthorized===!1||u.rejectUnauthorized===!1),ne={...u,rejectUnauthorized:F};v&&!v.inUse&&(ne.createConnection=()=>(Un(`reusing socket #${v.id} (${v.servername})`),v.inUse=!0,v)),I=K9e(n,{...ne,settings:{enablePush:!!(p||f)}}),I.setMaxListeners(1e3),I.setTimeout(d,()=>{Un(`closing session ${n} after ${d} ms of inactivity`),I.close()}),I.once("connect",()=>{Un(`session ${n} established`),Un(`caching session ${n}`),l[n]=I}),I.on("localSettings",N=>{Un(`session ${n} localSettings: ${JSON.stringify(N)}`)}),I.on("remoteSettings",N=>{Un(`session ${n} remoteSettings: ${JSON.stringify(N)}`)}),I.once("close",()=>{Un(`session ${n} closed`),l[n]===I&&(Un(`discarding cached session ${n}`),delete l[n])}),I.once("error",N=>{Un(`session ${n} encountered error: ${N}`),l[n]===I&&(Un(`discarding cached session ${n}`),delete l[n])}),I.on("frameError",(N,w,P)=>{Un(`session ${n} encountered frameError: type: ${N}, code: ${w}, id: ${P}`)}),I.once("goaway",(N,w,P)=>{Un(`session ${n} received GOAWAY frame: errorCode: ${N}, lastStreamID: ${w}, opaqueData: ${P?P.toString():void 0}`)}),I.on("stream",(N,w,P)=>{r7e(t,n,b,N,w,P)})}else v&&v.id!==I.socket.id&&!v.inUse&&(Un(`discarding redundant socket used for ALPN: #${v.id} ${v.servername}`),v.destroy());Un(`${h} ${e.host}${c}`);let T,{signal:A}=m,B=()=>{A.removeEventListener("abort",B),S(new tde),T&&T.close(JR)};if(A){if(A.aborted){S(new tde);return}A.addEventListener("abort",B)}let j=F=>{Un(`session ${n} encountered error during ${m.method} ${e.href}: ${F}`),S(F)};I.once("error",j),T=I.request({":method":h,":path":c,...g}),T.once("response",F=>{I.off("error",j),A&&A.removeEventListener("abort",B),_(rde(F,T,m.decode,S))}),T.once("error",F=>{I.off("error",j),A&&A.removeEventListener("abort",B),T.rstCode!==JR&&(Un(`${m.method} ${e.href} failed with: ${F.message}`),T.close(JR),S(F))}),T.once("frameError",(F,ne,Y)=>{I.off("error",j),Un(`encountered frameError during ${m.method} ${e.href}: type: ${F}, code: ${ne}, id: ${Y}`)}),T.on("push",(F,ne)=>{Un(`received 'push' event: headers: ${JSON.stringify(F)}, flags: ${ne}`)}),y instanceof Q9e?y.pipe(T):(y&&T.write(y),T.end())})};nde.exports={request:n7e,setupContext:e7e,resetContext:t7e}});var sde=M((Nnr,ode)=>{"use strict";var{EventEmitter:i7e}=require("events"),o7e=()=>{let t={},e=new i7e;return e.setMaxListeners(0),{acquire:r=>new Promise(n=>{if(!t[r]){t[r]=!0,n();return}let o=s=>{t[r]||(t[r]=!0,e.removeListener(r,o),n(s))};e.on(r,o)}),release:(r,n)=>{Reflect.deleteProperty(t,r),setImmediate(()=>e.emit(r,n))}}};ode.exports=o7e});var ade=M((Lnr,s7e)=>{s7e.exports={name:"@adobe/helix-fetch",version:"3.1.1",description:"Light-weight Fetch implementation transparently supporting both HTTP/1(.1) and HTTP/2",main:"src/index.js",scripts:{test:"nyc mocha",lint:"./node_modules/.bin/eslint .","semantic-release":"semantic-release"},mocha:{timeout:"5000",recursive:"true",reporter:"mocha-multi-reporters","reporter-options":"configFile=.mocha-multi.json"},engines:{node:">=12.0"},types:"src/index.d.ts",exports:{import:"./src/index.mjs",require:"./src/index.js"},repository:{type:"git",url:"https://github.com/adobe/helix-fetch"},author:"",license:"Apache-2.0",bugs:{url:"https://github.com/adobe/helix-fetch/issues"},homepage:"https://github.com/adobe/helix-fetch#readme",keywords:["fetch","whatwg","Fetch API","http","https","http2","h2","promise","async","request","RFC 7234","7234","caching","cache"],dependencies:{debug:"4.3.4","http-cache-semantics":"^4.1.1","lru-cache":"7.13.1"},devDependencies:{"@adobe/eslint-config-helix":"1.3.2","@semantic-release/changelog":"6.0.1","@semantic-release/git":"10.0.1",chai:"4.3.6","chai-as-promised":"7.1.1","chai-bytes":"0.1.2","chai-iterator":"3.0.2",eslint:"8.21.0","eslint-plugin-header":"3.1.1","eslint-plugin-import":"2.26.0","formdata-node":"4.3.3","lint-staged":"13.0.3",mocha:"10.0.0","mocha-multi-reporters":"1.5.1",nock:"13.2.9",nyc:"15.1.0","parse-cache-control":"1.0.1",pem:"1.14.6",proxy:"^1.0.2","semantic-release":"19.0.3",sinon:"14.0.0","stream-buffers":"3.0.2",tunnel:"^0.0.6"},"lint-staged":{"*.js":"eslint"},config:{commitizen:{path:"node_modules/cz-conventional-changelog"},ghooks:{"pre-commit":"npx lint-staged"}}}});var pde=M((Onr,dde)=>{"use strict";var{Readable:a7e}=require("stream"),c7e=require("tls"),{types:{isAnyArrayBuffer:u7e}}=require("util"),l7e=AV(),VV=Sl()("helix-fetch:core"),{RequestAbortedError:HO}=qO(),GV=ede(),jO=ide(),d7e=sde(),{isPlainObject:p7e}=Rf(),{isFormData:f7e,FormDataSerializer:m7e}=XR(),{version:h7e}=ade(),zV="h2",$V="h2c",WV="http/1.0",gy="http/1.1",g7e=100,v7e=60*60*1e3,y7e=[zV,gy,WV],b7e=`helix-fetch/${h7e}`,_7e={method:"GET",compress:!0,decode:!0},cde=0,ude=d7e(),lde=(t,e)=>new Promise((r,n)=>{let{signal:o}=e,s,a=()=>{o.removeEventListener("abort",a);let l=new HO;n(l),s&&s.destroy(l)};if(o){if(o.aborted){n(new HO);return}o.addEventListener("abort",a)}let c=+t.port||443,u=l=>{o&&o.removeEventListener("abort",a),l instanceof HO||(VV(`connecting to ${t.hostname}:${c} failed with: ${l.message}`),n(l))};s=c7e.connect(c,t.hostname,e),s.once("secureConnect",()=>{o&&o.removeEventListener("abort",a),s.off("error",u),cde+=1,s.id=cde,s.secureConnecting=!1,VV(`established TLS connection: #${s.id} (${s.servername})`),r(s)}),s.once("error",u)}),x7e=async(t,e)=>{let r=await ude.acquire(t.origin);try{return r||(r=await lde(t,e)),r}finally{ude.release(t.origin,r)}},S7e=async(t,e,r)=>{let n=`${e.protocol}//${e.host}`,o=t.alpnCache.get(n);if(o)return{protocol:o};switch(e.protocol){case"http:":return o=gy,t.alpnCache.set(n,o),{protocol:o};case"http2:":return o=$V,t.alpnCache.set(n,o),{protocol:o};case"https:":break;default:throw new TypeError(`unsupported protocol: ${e.protocol}`)}let{options:{rejectUnauthorized:s,h1:a={},h2:c={}}}=t,u=!(s===!1||a.rejectUnauthorized===!1||c.rejectUnauthorized===!1),l={servername:e.hostname,ALPNProtocols:t.alpnProtocols,signal:r,rejectUnauthorized:u};t.options.ca&&(l.ca=t.options.ca);let d=await x7e(e,l);return o=d.alpnProtocol,o||(o=gy),t.alpnCache.set(n,o),{protocol:o,socket:d}},I7e=t=>{let e={};return Object.keys(t).forEach(r=>{e[r.toLowerCase()]=t[r]}),e},C7e=async(t,e,r,n)=>{let o=e.protocol==="https:",s;e.port?s=e.port:o?s=443:s=80;let a={...r,host:e.host,hostname:e.hostname,port:s},c=await t(a);if(o){let l={...a,ALPNProtocols:n};l.socket=c,l.servername=a.host;let d=await lde(e,l);return{protocol:d.alpnProtocol||gy,socket:d}}return{protocol:c.alpnProtocol||gy,socket:c}},E7e=async(t,e,r)=>{let n=new URL(e),o={..._7e,...r||{}};typeof o.method=="string"&&(o.method=o.method.toUpperCase()),o.headers=I7e(o.headers||{}),o.headers.host===void 0&&(o.headers.host=n.host),t.userAgent&&o.headers["user-agent"]===void 0&&(o.headers["user-agent"]=t.userAgent);let s;if(o.body instanceof URLSearchParams)s="application/x-www-form-urlencoded; charset=utf-8",o.body=o.body.toString();else if(f7e(o.body)){let l=new m7e(o.body);s=l.contentType(),o.body=l.stream(),o.headers["transfer-encoding"]===void 0&&o.headers["content-length"]===void 0&&(o.headers["content-length"]=String(l.length()))}else typeof o.body=="string"||o.body instanceof String?s="text/plain; charset=utf-8":p7e(o.body)?(o.body=JSON.stringify(o.body),s="application/json"):u7e(o.body)&&(o.body=Buffer.from(o.body));o.headers["content-type"]===void 0&&s!==void 0&&(o.headers["content-type"]=s),o.body!=null&&(o.body instanceof a7e||(!(typeof o.body=="string"||o.body instanceof String)&&!Buffer.isBuffer(o.body)&&(o.body=String(o.body)),o.headers["transfer-encoding"]===void 0&&o.headers["content-length"]===void 0&&(o.headers["content-length"]=String(Buffer.isBuffer(o.body)?o.body.length:Buffer.byteLength(o.body,"utf-8"))))),o.headers.accept===void 0&&(o.headers.accept="*/*"),o.body==null&&["POST","PUT"].includes(o.method)&&(o.headers["content-length"]="0"),o.compress&&o.headers["accept-encoding"]===void 0&&(o.headers["accept-encoding"]="gzip,deflate,br");let{signal:a}=o,{protocol:c,socket:u=null}=t.socketFactory?await C7e(t.socketFactory,n,o,t.alpnProtocols):await S7e(t,n,a);switch(VV(`${n.host} -> ${c}`),c){case zV:try{return await jO.request(t,n,u?{...o,socket:u}:o)}catch(l){let{code:d,message:p}=l;throw d==="ERR_HTTP2_ERROR"&&p==="Protocol error"&&t.alpnCache.delete(`${n.protocol}//${n.host}`),l}case $V:return jO.request(t,new URL(`http://${n.host}${n.pathname}${n.hash}${n.search}`),u?{...o,socket:u}:o);case WV:case gy:return GV.request(t,n,u?{...o,socket:u}:o);default:throw new TypeError(`unsupported protocol: ${c}`)}},T7e=async t=>(t.alpnCache.clear(),Promise.all([GV.resetContext(t),jO.resetContext(t)])),w7e=t=>{let{options:{alpnProtocols:e=y7e,alpnCacheTTL:r=v7e,alpnCacheSize:n=g7e,userAgent:o=b7e,socketFactory:s}}=t;t.alpnProtocols=e,t.alpnCache=new l7e({max:n,ttl:r}),t.userAgent=o,t.socketFactory=s,GV.setupContext(t),jO.setupContext(t)};dde.exports={request:E7e,setupContext:w7e,resetContext:T7e,RequestAbortedError:HO,ALPN_HTTP2:zV,ALPN_HTTP2C:$V,ALPN_HTTP1_1:gy,ALPN_HTTP1_0:WV}});var mde=M((Mnr,fde)=>{"use strict";var R7e=Sl()("helix-fetch:core"),{request:k7e,setupContext:P7e,resetContext:A7e,RequestAbortedError:D7e,ALPN_HTTP2:N7e,ALPN_HTTP2C:L7e,ALPN_HTTP1_1:O7e,ALPN_HTTP1_0:M7e}=pde(),KV=class t{constructor(e){this.options={...e||{}},P7e(this)}api(){return{request:async(e,r)=>this.request(e,r),context:(e={})=>new t(e).api(),setCA:e=>this.setCA(e),reset:async()=>this.reset(),RequestAbortedError:D7e,ALPN_HTTP2:N7e,ALPN_HTTP2C:L7e,ALPN_HTTP1_1:O7e,ALPN_HTTP1_0:M7e}}async request(e,r){return k7e(this,e,r)}setCA(e){this.options.ca=e}async reset(){return R7e("resetting context"),A7e(this)}};fde.exports=new KV().api()});var bde=M((Fnr,yde)=>{"use strict";var{EventEmitter:F7e}=require("events"),{Readable:ZR}=require("stream"),YV=Sl()("helix-fetch"),U7e=AV(),{Body:B7e}=NO(),{Headers:ZV}=zS(),{Request:vy}=Ule(),{Response:XV}=UV(),{FetchBaseError:q7e,FetchError:ek,AbortError:VO}=LV(),{AbortController:H7e,AbortSignal:j7e,TimeoutSignal:V7e}=OV(),G7e=zle(),{cacheableResponse:z7e}=Kle(),{sizeof:$7e}=Rf(),{isFormData:W7e}=XR(),{context:K7e,RequestAbortedError:Y7e}=mde(),hde=["GET","HEAD"],Q7e=500,X7e=100*1024*1024,QV="push",gde=async(t,e,r)=>{let{request:n}=t.context,o=e instanceof vy&&typeof r>"u"?e:new vy(e,r),{method:s,body:a,signal:c,compress:u,decode:l,follow:d,redirect:p,init:{body:f}}=o,m;if(c&&c.aborted){let I=new VO("The operation was aborted.");throw o.init.body instanceof ZR&&o.init.body.destroy(I),I}try{m=await n(o.url,{...r,method:s,headers:o.headers.plain(),body:f&&!(f instanceof ZR)&&!W7e(f)?f:a,compress:u,decode:l,follow:d,redirect:p,signal:c})}catch(I){throw f instanceof ZR&&f.destroy(I),I instanceof TypeError?I:I instanceof Y7e?new VO("The operation was aborted."):new ek(I.message,"system",I)}let h=()=>{c.removeEventListener("abort",h);let I=new VO("The operation was aborted.");o.init.body instanceof ZR&&o.init.body.destroy(I),m.readable.emit("error",I)};c&&c.addEventListener("abort",h);let{statusCode:g,statusText:v,httpVersion:y,headers:b,readable:_,decoded:S}=m;if([301,302,303,307,308].includes(g)){let{location:I}=b,T=I==null?null:new URL(I,o.url);switch(o.redirect){case"manual":break;case"error":throw c&&c.removeEventListener("abort",h),new ek(`uri requested responds with a redirect, redirect mode is set to 'error': ${o.url}`,"no-redirect");case"follow":{if(T===null)break;if(o.counter>=o.follow)throw c&&c.removeEventListener("abort",h),new ek(`maximum redirect reached at: ${o.url}`,"max-redirect");let A={headers:new ZV(o.headers),follow:o.follow,compress:o.compress,decode:o.decode,counter:o.counter+1,method:o.method,body:o.body,signal:o.signal};if(g!==303&&o.body&&o.init.body instanceof ZR)throw c&&c.removeEventListener("abort",h),new ek("Cannot follow redirect with body being a readable stream","unsupported-redirect");return(g===303||(g===301||g===302)&&o.method==="POST")&&(A.method="GET",A.body=void 0,A.headers.delete("content-length")),c&&c.removeEventListener("abort",h),gde(t,new vy(T,A))}default:}}return c&&(_.once("end",()=>{c.removeEventListener("abort",h)}),_.once("error",()=>{c.removeEventListener("abort",h)})),new XV(_,{url:o.url,status:g,statusText:v,headers:b,httpVersion:y,decoded:S,counter:o.counter})},vde=async(t,e,r)=>{if(t.options.maxCacheSize===0||!hde.includes(e.method))return r;let n=new G7e(e,r,{shared:!1});if(n.storable()){let o=await z7e(r);return t.cache.set(e.url,{policy:n,response:o},n.timeToLive()),o}else return r},J7e=async(t,e,r)=>{let n=new vy(e,r);if(t.options.maxCacheSize!==0&&hde.includes(n.method)&&!["no-store","reload"].includes(n.cache)){let{policy:a,response:c}=t.cache.get(n.url)||{};if(a&&a.satisfiesWithoutRevalidation(n)){c.headers=new ZV(a.responseHeaders(c));let u=c.clone();return u.fromCache=!0,u}}let s=await gde(t,n);return n.cache!=="no-store"?vde(t,n,s):s},Z7e=(t,e={})=>{let r=new URL(t);if(typeof e!="object"||Array.isArray(e))throw new TypeError("qs: object expected");return Object.entries(e).forEach(([n,o])=>{Array.isArray(o)?o.forEach(s=>r.searchParams.append(n,s)):r.searchParams.append(n,o)}),r.href},eUe=t=>new V7e(t),JV=class t{constructor(e){this.options={...e};let{maxCacheSize:r}=this.options,n=typeof r=="number"&&r>=0?r:X7e,o=Q7e;n===0&&(n=1,o=1);let s=({response:c},u)=>$7e(c);this.cache=new U7e({max:o,maxSize:n,sizeCalculation:s}),this.eventEmitter=new F7e,this.options.h2=this.options.h2||{},typeof this.options.h2.enablePush>"u"&&(this.options.h2.enablePush=!0);let{enablePush:a}=this.options.h2;a&&(this.options.h2.pushPromiseHandler=(c,u,l)=>{let d={...u};Object.keys(d).filter(p=>p.startsWith(":")).forEach(p=>delete d[p]),this.pushPromiseHandler(c,d,l)},this.options.h2.pushHandler=(c,u,l)=>{let d={...u};Object.keys(d).filter(y=>y.startsWith(":")).forEach(y=>delete d[y]);let{statusCode:p,statusText:f,httpVersion:m,headers:h,readable:g,decoded:v}=l;this.pushHandler(c,d,new XV(g,{url:c,status:p,statusText:f,headers:h,httpVersion:m,decoded:v}))}),this.context=K7e(this.options)}api(){return{fetch:async(e,r)=>this.fetch(e,r),Body:B7e,Headers:ZV,Request:vy,Response:XV,AbortController:H7e,AbortSignal:j7e,FetchBaseError:q7e,FetchError:ek,AbortError:VO,context:(e={})=>new t(e).api(),setCA:e=>this.setCA(e),noCache:(e={})=>new t({...e,maxCacheSize:0}).api(),h1:(e={})=>new t({...e,alpnProtocols:[this.context.ALPN_HTTP1_1]}).api(),keepAlive:(e={})=>new t({...e,alpnProtocols:[this.context.ALPN_HTTP1_1],h1:{keepAlive:!0}}).api(),h1NoCache:(e={})=>new t({...e,maxCacheSize:0,alpnProtocols:[this.context.ALPN_HTTP1_1]}).api(),keepAliveNoCache:(e={})=>new t({...e,maxCacheSize:0,alpnProtocols:[this.context.ALPN_HTTP1_1],h1:{keepAlive:!0}}).api(),reset:async()=>this.context.reset(),onPush:e=>this.onPush(e),offPush:e=>this.offPush(e),createUrl:Z7e,timeoutSignal:eUe,clearCache:()=>this.clearCache(),cacheStats:()=>this.cacheStats(),ALPN_HTTP2:this.context.ALPN_HTTP2,ALPN_HTTP2C:this.context.ALPN_HTTP2C,ALPN_HTTP1_1:this.context.ALPN_HTTP1_1,ALPN_HTTP1_0:this.context.ALPN_HTTP1_0}}async fetch(e,r){return J7e(this,e,r)}setCA(e){this.options.ca=e,this.context.setCA(e)}onPush(e){return this.eventEmitter.on(QV,e)}offPush(e){return this.eventEmitter.off(QV,e)}clearCache(){this.cache.clear()}cacheStats(){return{size:this.cache.calculatedSize,count:this.cache.size}}pushPromiseHandler(e,r,n){YV(`received server push promise: ${e}, headers: ${JSON.stringify(r)}`);let o=new vy(e,{headers:r}),{policy:s}=this.cache.get(e)||{};s&&s.satisfiesWithoutRevalidation(o)&&(YV(`already cached, reject push promise: ${e}, headers: ${JSON.stringify(r)}`),n())}async pushHandler(e,r,n){YV(`caching resource pushed by server: ${e}, reqHeaders: ${JSON.stringify(r)}, status: ${n.status}, respHeaders: ${JSON.stringify(n.headers)}`);let o=await vde(this,new vy(e,{headers:r}),n);this.eventEmitter.emit(QV,e,o)}};yde.exports=new JV().api()});var xde=M((Unr,_de)=>{"use strict";_de.exports=bde()});var rr=M((dir,Ede)=>{Ede.exports={options:{usePureJavaScript:!1}}});var Rde=M((pir,wde)=>{var tG={};wde.exports=tG;var Tde={};tG.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=rUe(t,e);else{var o=0,s=e.length,a=e.charAt(0),c=[0];for(o=0;o<t.length;++o){for(var u=0,l=t[o];u<c.length;++u)l+=c[u]<<8,c[u]=l%s,l=l/s|0;for(;l>0;)c.push(l%s),l=l/s|0}for(o=0;t[o]===0&&o<t.length-1;++o)n+=a;for(o=c.length-1;o>=0;--o)n+=e[c[o]]}if(r){var d=new RegExp(".{1,"+r+"}","g");n=n.match(d).join(`\r
`)}return n};tG.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=Tde[e];if(!r){r=Tde[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var o=e.length,s=e.charAt(0),a=[0],n=0;n<t.length;n++){var c=r[t.charCodeAt(n)];if(c===void 0)return;for(var u=0,l=c;u<a.length;++u)l+=a[u]*o,a[u]=l&255,l>>=8;for(;l>0;)a.push(l&255),l>>=8}for(var d=0;t[d]===s&&d<t.length-1;++d)a.push(0);return typeof Buffer<"u"?Buffer.from(a.reverse()):new Uint8Array(a.reverse())};function rUe(t,e){var r=0,n=e.length,o=e.charAt(0),s=[0];for(r=0;r<t.length();++r){for(var a=0,c=t.at(r);a<s.length;++a)c+=s[a]<<8,s[a]=c%n,c=c/n|0;for(;c>0;)s.push(c%n),c=c/n|0}var u="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)u+=o;for(r=s.length-1;r>=0;--r)u+=e[s[r]];return u}});var Lr=M((fir,Dde)=>{var kde=rr(),Pde=Rde(),K=Dde.exports=kde.util=kde.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){K.nextTick=process.nextTick,typeof setImmediate=="function"?K.setImmediate=setImmediate:K.setImmediate=K.nextTick;return}if(typeof setImmediate=="function"){K.setImmediate=function(){return setImmediate.apply(void 0,arguments)},K.nextTick=function(c){return setImmediate(c)};return}if(K.setImmediate=function(c){setTimeout(c,0)},typeof window<"u"&&typeof window.postMessage=="function"){let c=function(u){if(u.source===window&&u.data===t){u.stopPropagation();var l=e.slice();e.length=0,l.forEach(function(d){d()})}};var a=c,t="forge.setImmediate",e=[];K.setImmediate=function(u){e.push(u),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",c,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,o=document.createElement("div"),e=[];new MutationObserver(function(){var u=e.slice();e.length=0,u.forEach(function(l){l()})}).observe(o,{attributes:!0});var s=K.setImmediate;K.setImmediate=function(u){Date.now()-r>15?(r=Date.now(),s(u)):(e.push(u),e.length===1&&o.setAttribute("a",n=!n))}}K.nextTick=K.setImmediate})();K.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;K.globalScope=function(){return K.isNodejs?global:typeof self>"u"?window:self}();K.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};K.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};K.isArrayBufferView=function(t){return t&&K.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function tk(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}K.ByteBuffer=rG;function rG(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(K.isArrayBuffer(t)||K.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof rG||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}K.ByteStringBuffer=rG;var nUe=4096;K.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>nUe&&(this.data.substr(0,1),this._constructedStringLength=0)};K.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};K.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};K.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};K.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};K.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};K.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(K.encodeUtf8(t))};K.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};K.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};K.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};K.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};K.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};K.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};K.ByteStringBuffer.prototype.putInt=function(t,e){tk(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};K.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};K.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};K.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};K.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};K.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};K.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};K.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};K.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};K.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};K.ByteStringBuffer.prototype.getInt=function(t){tk(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};K.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};K.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};K.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};K.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};K.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};K.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};K.ByteStringBuffer.prototype.copy=function(){var t=K.createBuffer(this.data);return t.read=this.read,t};K.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};K.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};K.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};K.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};K.ByteStringBuffer.prototype.toString=function(){return K.decodeUtf8(this.bytes())};function iUe(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=K.isArrayBuffer(t),n=K.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}K.DataBuffer=iUe;K.DataBuffer.prototype.length=function(){return this.write-this.read};K.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};K.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};K.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};K.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};K.DataBuffer.prototype.putBytes=function(t,e){if(K.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var o=new Uint8Array(this.data.buffer,this.write);return o.set(r),this.write+=n,this}if(K.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var o=new Uint8Array(this.data.buffer);return o.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof K.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&K.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var o=new Uint8Array(t.data.byteLength,this.write);return o.set(r),this.write+=r.byteLength,this}if(t instanceof K.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var s;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=K.binary.hex.decode(t,s,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=K.binary.base64.decode(t,s,this.write),this;if(e==="utf8"&&(t=K.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=K.binary.raw.decode(s),this;if(e==="utf16")return this.accommodate(t.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=K.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};K.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};K.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};K.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};K.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};K.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};K.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};K.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};K.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};K.DataBuffer.prototype.putInt=function(t,e){tk(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};K.DataBuffer.prototype.putSignedInt=function(t,e){return tk(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};K.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};K.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};K.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};K.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};K.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};K.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};K.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};K.DataBuffer.prototype.getInt=function(t){tk(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};K.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};K.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};K.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};K.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};K.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};K.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};K.DataBuffer.prototype.copy=function(){return new K.DataBuffer(this)};K.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};K.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};K.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};K.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};K.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return K.binary.raw.encode(e);if(t==="hex")return K.binary.hex.encode(e);if(t==="base64")return K.binary.base64.encode(e);if(t==="utf8")return K.text.utf8.decode(e);if(t==="utf16")return K.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};K.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=K.encodeUtf8(t)),new K.ByteBuffer(t)};K.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};K.xorBytes=function(t,e,r){for(var n="",o="",s="",a=0,c=0;r>0;--r,++a)o=t.charCodeAt(a)^e.charCodeAt(a),c>=10&&(n+=s,s="",c=0),s+=String.fromCharCode(o),++c;return n+=s,n};K.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};K.bytesToHex=function(t){return K.createBuffer(t).toHex()};K.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var yg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bg=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Ade="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";K.encode64=function(t,e){for(var r="",n="",o,s,a,c=0;c<t.length;)o=t.charCodeAt(c++),s=t.charCodeAt(c++),a=t.charCodeAt(c++),r+=yg.charAt(o>>2),r+=yg.charAt((o&3)<<4|s>>4),isNaN(s)?r+="==":(r+=yg.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":yg.charAt(a&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};K.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,o,s,a=0;a<t.length;)r=bg[t.charCodeAt(a++)-43],n=bg[t.charCodeAt(a++)-43],o=bg[t.charCodeAt(a++)-43],s=bg[t.charCodeAt(a++)-43],e+=String.fromCharCode(r<<2|n>>4),o!==64&&(e+=String.fromCharCode((n&15)<<4|o>>2),s!==64&&(e+=String.fromCharCode((o&3)<<6|s)));return e};K.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};K.decodeUtf8=function(t){return decodeURIComponent(escape(t))};K.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Pde.encode,decode:Pde.decode}};K.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};K.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var o=r,s=0;s<t.length;++s)n[o++]=t.charCodeAt(s);return e?o-r:n};K.binary.hex.encode=K.bytesToHex;K.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var o=0,s=r;for(t.length&1&&(o=1,n[s++]=parseInt(t[0],16));o<t.length;o+=2)n[s++]=parseInt(t.substr(o,2),16);return e?s-r:n};K.binary.base64.encode=function(t,e){for(var r="",n="",o,s,a,c=0;c<t.byteLength;)o=t[c++],s=t[c++],a=t[c++],r+=yg.charAt(o>>2),r+=yg.charAt((o&3)<<4|s>>4),isNaN(s)?r+="==":(r+=yg.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":yg.charAt(a&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};K.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var o,s,a,c,u=0,l=r;u<t.length;)o=bg[t.charCodeAt(u++)-43],s=bg[t.charCodeAt(u++)-43],a=bg[t.charCodeAt(u++)-43],c=bg[t.charCodeAt(u++)-43],n[l++]=o<<2|s>>4,a!==64&&(n[l++]=(s&15)<<4|a>>2,c!==64&&(n[l++]=(a&3)<<6|c));return e?l-r:n.subarray(0,l)};K.binary.base58.encode=function(t,e){return K.binary.baseN.encode(t,Ade,e)};K.binary.base58.decode=function(t,e){return K.binary.baseN.decode(t,Ade,e)};K.text={utf8:{},utf16:{}};K.text.utf8.encode=function(t,e,r){t=K.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var o=r,s=0;s<t.length;++s)n[o++]=t.charCodeAt(s);return e?o-r:n};K.text.utf8.decode=function(t){return K.decodeUtf8(String.fromCharCode.apply(null,t))};K.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var o=new Uint16Array(n.buffer);r=r||0;for(var s=r,a=r,c=0;c<t.length;++c)o[a++]=t.charCodeAt(c),s+=2;return e?s-r:n};K.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};K.deflate=function(t,e,r){if(e=K.decode64(t.deflate(K.encode64(e)).rval),r){var n=2,o=e.charCodeAt(1);o&32&&(n=6),e=e.substring(n,e.length-4)}return e};K.inflate=function(t,e,r){var n=t.inflate(K.encode64(e)).rval;return n===null?null:K.decode64(n)};var nG=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=K.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var o=new Error(n.error.message);throw o.id=n.error.id,o.name=n.error.name,o}},iG=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(K.decode64(r))),r},oUe=function(t,e,r,n){var o=iG(t,e);o===null&&(o={}),o[r]=n,nG(t,e,o)},sUe=function(t,e,r){var n=iG(t,e);return n!==null&&(n=r in n?n[r]:null),n},aUe=function(t,e,r){var n=iG(t,e);if(n!==null&&r in n){delete n[r];var o=!0;for(var s in n){o=!1;break}o&&(n=null),nG(t,e,n)}},cUe=function(t,e){nG(t,e,null)},zO=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var o,s=!1,a=null;for(var c in r){o=r[c];try{if(o==="flash"||o==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),s=o==="flash"}(o==="web"||o==="both")&&(e[0]=localStorage,n=t.apply(this,e),s=!0)}catch(u){a=u}if(s)break}if(!s)throw a;return n};K.setItem=function(t,e,r,n,o){zO(oUe,arguments,o)};K.getItem=function(t,e,r,n){return zO(sUe,arguments,n)};K.removeItem=function(t,e,r,n){zO(aUe,arguments,n)};K.clearItems=function(t,e,r){zO(cUe,arguments,r)};K.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};K.format=function(t){for(var e=/%./g,r,n,o=0,s=[],a=0;r=e.exec(t);){n=t.substring(a,e.lastIndex-2),n.length>0&&s.push(n),a=e.lastIndex;var c=r[0][1];switch(c){case"s":case"o":o<arguments.length?s.push(arguments[o+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+c+"?>")}}return s.push(t.substring(a)),s.join("")};K.formatNumber=function(t,e,r,n){var o=t,s=isNaN(e=Math.abs(e))?2:e,a=r===void 0?",":r,c=n===void 0?".":n,u=o<0?"-":"",l=parseInt(o=Math.abs(+o||0).toFixed(s),10)+"",d=l.length>3?l.length%3:0;return u+(d?l.substr(0,d)+c:"")+l.substr(d).replace(/(\d{3})(?=\d)/g,"$1"+c)+(s?a+Math.abs(o-l).toFixed(s).slice(2):"")};K.formatSize=function(t){return t>=1073741824?t=K.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=K.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=K.formatNumber(t/1024,0)+" KiB":t=K.formatNumber(t,0)+" bytes",t};K.bytesFromIP=function(t){return t.indexOf(".")!==-1?K.bytesFromIPv4(t):t.indexOf(":")!==-1?K.bytesFromIPv6(t):null};K.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=K.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};K.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(a){return a.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=K.createBuffer(),o=0;o<8;++o){if(!t[o]||t[o].length===0){n.fillWithByte(0,r),r=0;continue}var s=K.hexToBytes(t[o]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};K.bytesToIP=function(t){return t.length===4?K.bytesToIPv4(t):t.length===16?K.bytesToIPv6(t):null};K.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};K.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,o=0;o<t.length;o+=2){for(var s=K.bytesToHex(t[o]+t[o+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var a=r[r.length-1],c=e.length;!a||c!==a.end+1?r.push({start:c,end:c}):(a.end=c,a.end-a.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(s)}if(r.length>0){var u=r[n];u.end-u.start>0&&(e.splice(u.start,u.end-u.start+1,""),u.start===0&&e.unshift(""),u.end===7&&e.push(""))}return e.join(":")};K.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in K&&!t.update)return e(null,K.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return K.cores=navigator.hardwareConcurrency,e(null,K.cores);if(typeof Worker>"u")return K.cores=1,e(null,K.cores);if(typeof Blob>"u")return K.cores=2,e(null,K.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){for(var c=Date.now(),u=c+4;Date.now()<u;);self.postMessage({st:c,et:u})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(a,c,u){if(c===0){var l=Math.floor(a.reduce(function(d,p){return d+p},0)/a.length);return K.cores=Math.max(1,l),URL.revokeObjectURL(r),e(null,K.cores)}o(u,function(d,p){a.push(s(u,p)),n(a,c-1,u)})}function o(a,c){for(var u=[],l=[],d=0;d<a;++d){var p=new Worker(r);p.addEventListener("message",function(f){if(l.push(f.data),l.length===a){for(var m=0;m<a;++m)u[m].terminate();c(null,l)}}),u.push(p)}for(var d=0;d<a;++d)u[d].postMessage(d)}function s(a,c){for(var u=[],l=0;l<a;++l)for(var d=c[l],p=u[l]=[],f=0;f<a;++f)if(l!==f){var m=c[f];(d.st>m.st&&d.st<m.et||m.st>d.st&&m.st<d.et)&&p.push(f)}return u.reduce(function(h,g){return Math.max(h,g.length)},0)}}});var $O=M((mir,Nde)=>{var jo=rr();Lr();Nde.exports=jo.cipher=jo.cipher||{};jo.cipher.algorithms=jo.cipher.algorithms||{};jo.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=jo.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new jo.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};jo.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=jo.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new jo.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};jo.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),jo.cipher.algorithms[t]=e};jo.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in jo.cipher.algorithms?jo.cipher.algorithms[t]:null};var oG=jo.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};oG.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=jo.util.createBuffer(),this.output=t.output||jo.util.createBuffer(),this.mode.start(e)};oG.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};oG.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var aG=M((hir,Lde)=>{var Vo=rr();Lr();Vo.cipher=Vo.cipher||{};var fr=Lde.exports=Vo.cipher.modes=Vo.cipher.modes||{};fr.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};fr.ecb.prototype.start=function(t){};fr.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};fr.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};fr.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};fr.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};fr.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};fr.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=WO(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};fr.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};fr.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};fr.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};fr.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};fr.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Vo.util.createBuffer(),this._partialBytes=0};fr.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=WO(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};fr.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var o=0;o<this._ints;++o)this._inBlock[o]=t.getInt32()^this._outBlock[o],e.putInt32(this._inBlock[o]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialBlock[o]=t.getInt32()^this._outBlock[o],this._partialOutput.putInt32(this._partialBlock[o]);if(s>0)t.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._partialBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};fr.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var o=0;o<this._ints;++o)this._inBlock[o]=t.getInt32(),e.putInt32(this._inBlock[o]^this._outBlock[o]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialBlock[o]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[o]^this._outBlock[o]);if(s>0)t.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._partialBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};fr.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Vo.util.createBuffer(),this._partialBytes=0};fr.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=WO(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};fr.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var o=0;o<this._ints;++o)e.putInt32(t.getInt32()^this._outBlock[o]),this._inBlock[o]=this._outBlock[o];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(t.getInt32()^this._outBlock[o]);if(s>0)t.read-=this.blockSize;else for(var o=0;o<this._ints;++o)this._inBlock[o]=this._outBlock[o];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};fr.ofb.prototype.decrypt=fr.ofb.prototype.encrypt;fr.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Vo.util.createBuffer(),this._partialBytes=0};fr.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=WO(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};fr.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var o=0;o<this._ints;++o)e.putInt32(t.getInt32()^this._outBlock[o]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(t.getInt32()^this._outBlock[o]);if(s>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}KO(this._inBlock)};fr.ctr.prototype.decrypt=fr.ctr.prototype.encrypt;fr.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Vo.util.createBuffer(),this._partialBytes=0,this._R=3774873600};fr.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=Vo.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=Vo.util.createBuffer(t.additionalData):r=Vo.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=Vo.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(sG(n*8)))}this._inBlock=this._j0.slice(0),KO(this._inBlock),this._partialBytes=0,r=Vo.util.createBuffer(r),this._aDataLength=sG(r.length()*8);var o=r.length()%this.blockSize;for(o&&r.fillWithByte(0,this.blockSize-o),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};fr.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var o=0;o<this._ints;++o)e.putInt32(this._outBlock[o]^=t.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var o=0;o<this._ints;++o)this._partialOutput.putInt32(t.getInt32()^this._outBlock[o]);if(s<=0||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(var o=0;o<this._ints;++o)this._outBlock[o]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),KO(this._inBlock)};fr.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),KO(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var o=0;o<this._ints;++o)e.putInt32(this._outBlock[o]^this._hashBlock[o]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};fr.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=Vo.util.createBuffer();var n=this._aDataLength.concat(sG(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var o=[];this.cipher.encrypt(this._j0,o);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^o[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};fr.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),o=0;o<128;++o){var s=t[o/32|0]&1<<31-o%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};fr.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};fr.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,o=t[n]>>>(7-r%8)*4&15,s=this._m[r][o];e[0]^=s[0],e[1]^=s[1],e[2]^=s[2],e[3]^=s[3]}return e};fr.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};fr.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,o=16*r,s=new Array(o),a=0;a<o;++a){var c=[0,0,0,0],u=a/n|0,l=(n-1-a%n)*e;c[u]=1<<e-1<<l,s[a]=this.generateSubHashTable(this.multiply(c,t),e)}return s};fr.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,o=new Array(r);o[n]=t.slice(0);for(var s=n>>>1;s>0;)this.pow(o[2*s],o[s]=[]),s>>=1;for(s=2;s<n;){for(var a=1;a<s;++a){var c=o[s],u=o[a];o[s+a]=[c[0]^u[0],c[1]^u[1],c[2]^u[2],c[3]^u[3]]}s*=2}for(o[0]=[0,0,0,0],s=n+1;s<r;++s){var l=o[s^n];o[s]=[t[0]^l[0],t[1]^l[1],t[2]^l[2],t[3]^l[3]]}return o};function WO(t,e){if(typeof t=="string"&&(t=Vo.util.createBuffer(t)),Vo.util.isArray(t)&&t.length>4){var r=t;t=Vo.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!Vo.util.isArray(t)){for(var o=[],s=e/4,n=0;n<s;++n)o.push(t.getInt32());t=o}return t}function KO(t){t[t.length-1]=t[t.length-1]+1&4294967295}function sG(t){return[t/4294967296|0,t&4294967295]}});var _g=M((gir,Ude)=>{var Cn=rr();$O();aG();Lr();Ude.exports=Cn.aes=Cn.aes||{};Cn.aes.startEncrypting=function(t,e,r,n){var o=YO({key:t,output:r,decrypt:!1,mode:n});return o.start(e),o};Cn.aes.createEncryptionCipher=function(t,e){return YO({key:t,output:null,decrypt:!1,mode:e})};Cn.aes.startDecrypting=function(t,e,r,n){var o=YO({key:t,output:r,decrypt:!0,mode:n});return o.start(e),o};Cn.aes.createDecryptionCipher=function(t,e){return YO({key:t,output:null,decrypt:!0,mode:e})};Cn.aes.Algorithm=function(t,e){lG||Mde();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,o){return uG(r._w,n,o,!1)},decrypt:function(n,o){return uG(r._w,n,o,!0)}}}),r._init=!1};Cn.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=Cn.util.createBuffer(e);else if(Cn.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=Cn.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!Cn.util.isArray(e)){r=e,e=[];var o=r.length();if(o===16||o===24||o===32){o=o>>>2;for(var n=0;n<o;++n)e.push(r.getInt32())}}if(!Cn.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,a=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=Fde(e,t.decrypt&&!a),this._init=!0}};Cn.aes._expandKey=function(t,e){return lG||Mde(),Fde(t,e)};Cn.aes._updateBlock=uG;YS("AES-ECB",Cn.cipher.modes.ecb);YS("AES-CBC",Cn.cipher.modes.cbc);YS("AES-CFB",Cn.cipher.modes.cfb);YS("AES-OFB",Cn.cipher.modes.ofb);YS("AES-CTR",Cn.cipher.modes.ctr);YS("AES-GCM",Cn.cipher.modes.gcm);function YS(t,e){var r=function(){return new Cn.aes.Algorithm(t,e)};Cn.cipher.registerAlgorithm(t,r)}var lG=!1,KS=4,na,cG,Ode,yy,El;function Mde(){lG=!0,Ode=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;na=new Array(256),cG=new Array(256),yy=new Array(4),El=new Array(4);for(var e=0;e<4;++e)yy[e]=new Array(256),El[e]=new Array(256);for(var r=0,n=0,o,s,a,c,u,l,d,e=0;e<256;++e){c=n^n<<1^n<<2^n<<3^n<<4,c=c>>8^c&255^99,na[r]=c,cG[c]=r,u=t[c],o=t[r],s=t[o],a=t[s],l=u<<24^c<<16^c<<8^(c^u),d=(o^s^a)<<24^(r^a)<<16^(r^s^a)<<8^(r^o^a);for(var p=0;p<4;++p)yy[p][r]=l,El[p][c]=d,l=l<<24|l>>>8,d=d<<24|d>>>8;r===0?r=n=1:(r=o^t[t[t[o^a]]],n^=t[t[n]])}}function Fde(t,e){for(var r=t.slice(0),n,o=1,s=r.length,a=s+6+1,c=KS*a,u=s;u<c;++u)n=r[u-1],u%s===0?(n=na[n>>>16&255]<<24^na[n>>>8&255]<<16^na[n&255]<<8^na[n>>>24]^Ode[o]<<24,o++):s>6&&u%s===4&&(n=na[n>>>24]<<24^na[n>>>16&255]<<16^na[n>>>8&255]<<8^na[n&255]),r[u]=r[u-s]^n;if(e){var l,d=El[0],p=El[1],f=El[2],m=El[3],h=r.slice(0);c=r.length;for(var u=0,g=c-KS;u<c;u+=KS,g-=KS)if(u===0||u===c-KS)h[u]=r[g],h[u+1]=r[g+3],h[u+2]=r[g+2],h[u+3]=r[g+1];else for(var v=0;v<KS;++v)l=r[g+v],h[u+(3&-v)]=d[na[l>>>24]]^p[na[l>>>16&255]]^f[na[l>>>8&255]]^m[na[l&255]];r=h}return r}function uG(t,e,r,n){var o=t.length/4-1,s,a,c,u,l;n?(s=El[0],a=El[1],c=El[2],u=El[3],l=cG):(s=yy[0],a=yy[1],c=yy[2],u=yy[3],l=na);var d,p,f,m,h,g,v;d=e[0]^t[0],p=e[n?3:1]^t[1],f=e[2]^t[2],m=e[n?1:3]^t[3];for(var y=3,b=1;b<o;++b)h=s[d>>>24]^a[p>>>16&255]^c[f>>>8&255]^u[m&255]^t[++y],g=s[p>>>24]^a[f>>>16&255]^c[m>>>8&255]^u[d&255]^t[++y],v=s[f>>>24]^a[m>>>16&255]^c[d>>>8&255]^u[p&255]^t[++y],m=s[m>>>24]^a[d>>>16&255]^c[p>>>8&255]^u[f&255]^t[++y],d=h,p=g,f=v;r[0]=l[d>>>24]<<24^l[p>>>16&255]<<16^l[f>>>8&255]<<8^l[m&255]^t[++y],r[n?3:1]=l[p>>>24]<<24^l[f>>>16&255]<<16^l[m>>>8&255]<<8^l[d&255]^t[++y],r[2]=l[f>>>24]<<24^l[m>>>16&255]<<16^l[d>>>8&255]<<8^l[p&255]^t[++y],r[n?1:3]=l[m>>>24]<<24^l[d>>>16&255]<<16^l[p>>>8&255]<<8^l[f&255]^t[++y]}function YO(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=Cn.cipher.createDecipher(r,t.key):n=Cn.cipher.createCipher(r,t.key);var o=n.start;return n.start=function(s,a){var c=null;a instanceof Cn.util.ByteBuffer&&(c=a,a={}),a=a||{},a.output=c,a.iv=s,o.call(n,a)},n}});var xg=M((vir,Bde)=>{var rk=rr();rk.pki=rk.pki||{};var dG=Bde.exports=rk.pki.oids=rk.oids=rk.oids||{};function Ae(t,e){dG[t]=e,dG[e]=t}function rn(t,e){dG[t]=e}Ae("1.2.840.113549.1.1.1","rsaEncryption");Ae("1.2.840.113549.1.1.4","md5WithRSAEncryption");Ae("1.2.840.113549.1.1.5","sha1WithRSAEncryption");Ae("1.2.840.113549.1.1.7","RSAES-OAEP");Ae("1.2.840.113549.1.1.8","mgf1");Ae("1.2.840.113549.1.1.9","pSpecified");Ae("1.2.840.113549.1.1.10","RSASSA-PSS");Ae("1.2.840.113549.1.1.11","sha256WithRSAEncryption");Ae("1.2.840.113549.1.1.12","sha384WithRSAEncryption");Ae("1.2.840.113549.1.1.13","sha512WithRSAEncryption");Ae("1.3.101.112","EdDSA25519");Ae("1.2.840.10040.4.3","dsa-with-sha1");Ae("1.3.14.3.2.7","desCBC");Ae("1.3.14.3.2.26","sha1");Ae("1.3.14.3.2.29","sha1WithRSASignature");Ae("2.16.840.1.101.3.4.2.1","sha256");Ae("2.16.840.1.101.3.4.2.2","sha384");Ae("2.16.840.1.101.3.4.2.3","sha512");Ae("2.16.840.1.101.3.4.2.4","sha224");Ae("2.16.840.1.101.3.4.2.5","sha512-224");Ae("2.16.840.1.101.3.4.2.6","sha512-256");Ae("1.2.840.113549.2.2","md2");Ae("1.2.840.113549.2.5","md5");Ae("1.2.840.113549.1.7.1","data");Ae("1.2.840.113549.1.7.2","signedData");Ae("1.2.840.113549.1.7.3","envelopedData");Ae("1.2.840.113549.1.7.4","signedAndEnvelopedData");Ae("1.2.840.113549.1.7.5","digestedData");Ae("1.2.840.113549.1.7.6","encryptedData");Ae("1.2.840.113549.1.9.1","emailAddress");Ae("1.2.840.113549.1.9.2","unstructuredName");Ae("1.2.840.113549.1.9.3","contentType");Ae("1.2.840.113549.1.9.4","messageDigest");Ae("1.2.840.113549.1.9.5","signingTime");Ae("1.2.840.113549.1.9.6","counterSignature");Ae("1.2.840.113549.1.9.7","challengePassword");Ae("1.2.840.113549.1.9.8","unstructuredAddress");Ae("1.2.840.113549.1.9.14","extensionRequest");Ae("1.2.840.113549.1.9.20","friendlyName");Ae("1.2.840.113549.1.9.21","localKeyId");Ae("1.2.840.113549.1.9.22.1","x509Certificate");Ae("1.2.840.113549.1.12.10.1.1","keyBag");Ae("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");Ae("1.2.840.113549.1.12.10.1.3","certBag");Ae("1.2.840.113549.1.12.10.1.4","crlBag");Ae("1.2.840.113549.1.12.10.1.5","secretBag");Ae("1.2.840.113549.1.12.10.1.6","safeContentsBag");Ae("1.2.840.113549.1.5.13","pkcs5PBES2");Ae("1.2.840.113549.1.5.12","pkcs5PBKDF2");Ae("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");Ae("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");Ae("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");Ae("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");Ae("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");Ae("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");Ae("1.2.840.113549.2.7","hmacWithSHA1");Ae("1.2.840.113549.2.8","hmacWithSHA224");Ae("1.2.840.113549.2.9","hmacWithSHA256");Ae("1.2.840.113549.2.10","hmacWithSHA384");Ae("1.2.840.113549.2.11","hmacWithSHA512");Ae("1.2.840.113549.3.7","des-EDE3-CBC");Ae("2.16.840.1.101.3.4.1.2","aes128-CBC");Ae("2.16.840.1.101.3.4.1.22","aes192-CBC");Ae("2.16.840.1.101.3.4.1.42","aes256-CBC");Ae("2.5.4.3","commonName");Ae("2.5.4.4","surname");Ae("2.5.4.5","serialNumber");Ae("2.5.4.6","countryName");Ae("2.5.4.7","localityName");Ae("2.5.4.8","stateOrProvinceName");Ae("2.5.4.9","streetAddress");Ae("2.5.4.10","organizationName");Ae("2.5.4.11","organizationalUnitName");Ae("2.5.4.12","title");Ae("2.5.4.13","description");Ae("2.5.4.15","businessCategory");Ae("2.5.4.17","postalCode");Ae("2.5.4.42","givenName");Ae("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");Ae("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");Ae("2.16.840.1.113730.1.1","nsCertType");Ae("2.16.840.1.113730.1.13","nsComment");rn("2.5.29.1","authorityKeyIdentifier");rn("2.5.29.2","keyAttributes");rn("2.5.29.3","certificatePolicies");rn("2.5.29.4","keyUsageRestriction");rn("2.5.29.5","policyMapping");rn("2.5.29.6","subtreesConstraint");rn("2.5.29.7","subjectAltName");rn("2.5.29.8","issuerAltName");rn("2.5.29.9","subjectDirectoryAttributes");rn("2.5.29.10","basicConstraints");rn("2.5.29.11","nameConstraints");rn("2.5.29.12","policyConstraints");rn("2.5.29.13","basicConstraints");Ae("2.5.29.14","subjectKeyIdentifier");Ae("2.5.29.15","keyUsage");rn("2.5.29.16","privateKeyUsagePeriod");Ae("2.5.29.17","subjectAltName");Ae("2.5.29.18","issuerAltName");Ae("2.5.29.19","basicConstraints");rn("2.5.29.20","cRLNumber");rn("2.5.29.21","cRLReason");rn("2.5.29.22","expirationDate");rn("2.5.29.23","instructionCode");rn("2.5.29.24","invalidityDate");rn("2.5.29.25","cRLDistributionPoints");rn("2.5.29.26","issuingDistributionPoint");rn("2.5.29.27","deltaCRLIndicator");rn("2.5.29.28","issuingDistributionPoint");rn("2.5.29.29","certificateIssuer");rn("2.5.29.30","nameConstraints");Ae("2.5.29.31","cRLDistributionPoints");Ae("2.5.29.32","certificatePolicies");rn("2.5.29.33","policyMappings");rn("2.5.29.34","policyConstraints");Ae("2.5.29.35","authorityKeyIdentifier");rn("2.5.29.36","policyConstraints");Ae("2.5.29.37","extKeyUsage");rn("2.5.29.46","freshestCRL");rn("2.5.29.54","inhibitAnyPolicy");Ae("1.3.6.1.4.1.11129.2.4.2","timestampList");Ae("1.3.6.1.5.5.7.1.1","authorityInfoAccess");Ae("1.3.6.1.5.5.7.3.1","serverAuth");Ae("1.3.6.1.5.5.7.3.2","clientAuth");Ae("1.3.6.1.5.5.7.3.3","codeSigning");Ae("1.3.6.1.5.5.7.3.4","emailProtection");Ae("1.3.6.1.5.5.7.3.8","timeStamping")});var Tl=M((yir,Hde)=>{var Bn=rr();Lr();xg();var Ke=Hde.exports=Bn.asn1=Bn.asn1||{};Ke.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};Ke.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};Ke.create=function(t,e,r,n,o){if(Bn.util.isArray(n)){for(var s=[],a=0;a<n.length;++a)n[a]!==void 0&&s.push(n[a]);n=s}var c={tagClass:t,type:e,constructed:r,composed:r||Bn.util.isArray(n),value:n};return o&&"bitStringContents"in o&&(c.bitStringContents=o.bitStringContents,c.original=Ke.copy(c)),c};Ke.copy=function(t,e){var r;if(Bn.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(Ke.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:Ke.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};Ke.equals=function(t,e,r){if(Bn.util.isArray(t)){if(!Bn.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!Ke.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var o=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&Ke.equals(t.value,e.value);return r&&r.includeBitStringContents&&(o=o&&t.bitStringContents===e.bitStringContents),o};Ke.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function nk(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var uUe=function(t,e){var r=t.getByte();if(e--,r!==128){var n,o=r&128;if(!o)n=r;else{var s=r&127;nk(t,e,s),n=t.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};Ke.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=Bn.util.createBuffer(t));var r=t.length(),n=QO(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var o=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw o.byteCount=r,o.remaining=t.length(),o}return n};function QO(t,e,r,n){var o;nk(t,e,2);var s=t.getByte();e--;var a=s&192,c=s&31;o=t.length();var u=uUe(t,e);if(e-=o-t.length(),u!==void 0&&u>e){if(n.strict){var l=new Error("Too few bytes to read ASN.1 value.");throw l.available=t.length(),l.remaining=e,l.requested=u,l}u=e}var d,p,f=(s&32)===32;if(f)if(d=[],u===void 0)for(;;){if(nk(t,e,2),t.bytes(2)==="\0\0"){t.getBytes(2),e-=2;break}o=t.length(),d.push(QO(t,e,r+1,n)),e-=o-t.length()}else for(;u>0;)o=t.length(),d.push(QO(t,u,r+1,n)),e-=o-t.length(),u-=o-t.length();if(d===void 0&&a===Ke.Class.UNIVERSAL&&c===Ke.Type.BITSTRING&&(p=t.bytes(u)),d===void 0&&n.decodeBitStrings&&a===Ke.Class.UNIVERSAL&&c===Ke.Type.BITSTRING&&u>1){var m=t.read,h=e,g=0;if(c===Ke.Type.BITSTRING&&(nk(t,e,1),g=t.getByte(),e--),g===0)try{o=t.length();var v={strict:!0,decodeBitStrings:!0},y=QO(t,e,r+1,v),b=o-t.length();e-=b,c==Ke.Type.BITSTRING&&b++;var _=y.tagClass;b===u&&(_===Ke.Class.UNIVERSAL||_===Ke.Class.CONTEXT_SPECIFIC)&&(d=[y])}catch{}d===void 0&&(t.read=m,e=h)}if(d===void 0){if(u===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");u=e}if(c===Ke.Type.BMPSTRING)for(d="";u>0;u-=2)nk(t,e,2),d+=String.fromCharCode(t.getInt16()),e-=2;else d=t.getBytes(u),e-=u}var S=p===void 0?null:{bitStringContents:p};return Ke.create(a,c,f,d,S)}Ke.toDer=function(t){var e=Bn.util.createBuffer(),r=t.tagClass|t.type,n=Bn.util.createBuffer(),o=!1;if("bitStringContents"in t&&(o=!0,t.original&&(o=Ke.equals(t,t.original))),o)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var s=0;s<t.value.length;++s)t.value[s]!==void 0&&n.putBuffer(Ke.toDer(t.value[s]))}else if(t.type===Ke.Type.BMPSTRING)for(var s=0;s<t.value.length;++s)n.putInt16(t.value.charCodeAt(s));else t.type===Ke.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var a=n.length(),c="";do c+=String.fromCharCode(a&255),a=a>>>8;while(a>0);e.putByte(c.length|128);for(var s=c.length-1;s>=0;--s)e.putByte(c.charCodeAt(s))}return e.putBuffer(n),e};Ke.oidToDer=function(t){var e=t.split("."),r=Bn.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,o,s,a,c=2;c<e.length;++c){n=!0,o=[],s=parseInt(e[c],10);do a=s&127,s=s>>>7,n||(a|=128),o.push(a),n=!1;while(s>0);for(var u=o.length-1;u>=0;--u)r.putByte(o[u])}return r};Ke.derToOid=function(t){var e;typeof t=="string"&&(t=Bn.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};Ke.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,o=parseInt(t.substr(4,2),10),s=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),c=0;if(t.length>11){var u=t.charAt(10),l=10;u!=="+"&&u!=="-"&&(c=parseInt(t.substr(10,2),10),l+=2)}if(e.setUTCFullYear(r,n,o),e.setUTCHours(s,a,c,0),l&&(u=t.charAt(l),u==="+"||u==="-")){var d=parseInt(t.substr(l+1,2),10),p=parseInt(t.substr(l+4,2),10),f=d*60+p;f*=6e4,u==="+"?e.setTime(+e-f):e.setTime(+e+f)}return e};Ke.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,o=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),a=parseInt(t.substr(10,2),10),c=parseInt(t.substr(12,2),10),u=0,l=0,d=!1;t.charAt(t.length-1)==="Z"&&(d=!0);var p=t.length-5,f=t.charAt(p);if(f==="+"||f==="-"){var m=parseInt(t.substr(p+1,2),10),h=parseInt(t.substr(p+4,2),10);l=m*60+h,l*=6e4,f==="+"&&(l*=-1),d=!0}return t.charAt(14)==="."&&(u=parseFloat(t.substr(14),10)*1e3),d?(e.setUTCFullYear(r,n,o),e.setUTCHours(s,a,c,u),e.setTime(+e+l)):(e.setFullYear(r,n,o),e.setHours(s,a,c,u)),e};Ke.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};Ke.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};Ke.integerToDer=function(t){var e=Bn.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};Ke.derToInteger=function(t){typeof t=="string"&&(t=Bn.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};Ke.validate=function(t,e,r,n){var o=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(o=!0,e.value&&Bn.util.isArray(e.value))for(var s=0,a=0;o&&a<e.value.length;++a)o=e.value[a].optional||!1,t.value[s]&&(o=Ke.validate(t.value[s],e.value[a],r,n),o?++s:e.value[a].optional&&(o=!0)),!o&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(o&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var c;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var u=t.bitStringContents.charCodeAt(0);if(u!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return o};var qde=/[^\\u0000-\\u00ff]/;Ke.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var o="",s=0;s<e*r;++s)o+=" ";switch(n+=o+"Tag: ",t.tagClass){case Ke.Class.UNIVERSAL:n+="Universal:";break;case Ke.Class.APPLICATION:n+="Application:";break;case Ke.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case Ke.Class.PRIVATE:n+="Private:";break}if(t.tagClass===Ke.Class.UNIVERSAL)switch(n+=t.type,t.type){case Ke.Type.NONE:n+=" (None)";break;case Ke.Type.BOOLEAN:n+=" (Boolean)";break;case Ke.Type.INTEGER:n+=" (Integer)";break;case Ke.Type.BITSTRING:n+=" (Bit string)";break;case Ke.Type.OCTETSTRING:n+=" (Octet string)";break;case Ke.Type.NULL:n+=" (Null)";break;case Ke.Type.OID:n+=" (Object Identifier)";break;case Ke.Type.ODESC:n+=" (Object Descriptor)";break;case Ke.Type.EXTERNAL:n+=" (External or Instance of)";break;case Ke.Type.REAL:n+=" (Real)";break;case Ke.Type.ENUMERATED:n+=" (Enumerated)";break;case Ke.Type.EMBEDDED:n+=" (Embedded PDV)";break;case Ke.Type.UTF8:n+=" (UTF8)";break;case Ke.Type.ROID:n+=" (Relative Object Identifier)";break;case Ke.Type.SEQUENCE:n+=" (Sequence)";break;case Ke.Type.SET:n+=" (Set)";break;case Ke.Type.PRINTABLESTRING:n+=" (Printable String)";break;case Ke.Type.IA5String:n+=" (IA5String (ASCII))";break;case Ke.Type.UTCTIME:n+=" (UTC time)";break;case Ke.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case Ke.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=o+"Constructed: "+t.constructed+`
`,t.composed){for(var a=0,c="",s=0;s<t.value.length;++s)t.value[s]!==void 0&&(a+=1,c+=Ke.prettyPrint(t.value[s],e+1,r),s+1<t.value.length&&(c+=","));n+=o+"Sub values: "+a+c}else{if(n+=o+"Value: ",t.type===Ke.Type.OID){var u=Ke.derToOid(t.value);n+=u,Bn.pki&&Bn.pki.oids&&u in Bn.pki.oids&&(n+=" ("+Bn.pki.oids[u]+") ")}if(t.type===Ke.Type.INTEGER)try{n+=Ke.derToInteger(t.value)}catch{n+="0x"+Bn.util.bytesToHex(t.value)}else if(t.type===Ke.Type.BITSTRING){if(t.value.length>1?n+="0x"+Bn.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var l=t.value.charCodeAt(0);l==1?n+=" (1 unused bit shown)":l>1&&(n+=" ("+l+" unused bits shown)")}}else if(t.type===Ke.Type.OCTETSTRING)qde.test(t.value)||(n+="("+t.value+") "),n+="0x"+Bn.util.bytesToHex(t.value);else if(t.type===Ke.Type.UTF8)try{n+=Bn.util.decodeUtf8(t.value)}catch(d){if(d.message==="URI malformed")n+="0x"+Bn.util.bytesToHex(t.value)+" (malformed UTF8)";else throw d}else t.type===Ke.Type.PRINTABLESTRING||t.type===Ke.Type.IA5String?n+=t.value:qde.test(t.value)?n+="0x"+Bn.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var Ad=M((bir,jde)=>{var XO=rr();jde.exports=XO.md=XO.md||{};XO.md.algorithms=XO.md.algorithms||{}});var QS=M((_ir,Vde)=>{var Df=rr();Ad();Lr();var lUe=Vde.exports=Df.hmac=Df.hmac||{};lUe.create=function(){var t=null,e=null,r=null,n=null,o={};return o.start=function(s,a){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Df.md.algorithms)e=Df.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else e=s;if(a===null)a=t;else{if(typeof a=="string")a=Df.util.createBuffer(a);else if(Df.util.isArray(a)){var c=a;a=Df.util.createBuffer();for(var u=0;u<c.length;++u)a.putByte(c[u])}var l=a.length();l>e.blockLength&&(e.start(),e.update(a.bytes()),a=e.digest()),r=Df.util.createBuffer(),n=Df.util.createBuffer(),l=a.length();for(var u=0;u<l;++u){var c=a.at(u);r.putByte(54^c),n.putByte(92^c)}if(l<e.blockLength)for(var c=e.blockLength-l,u=0;u<c;++u)r.putByte(54),n.putByte(92);t=a,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},o.update=function(s){e.update(s)},o.getMac=function(){var s=e.digest().bytes();return e.start(),e.update(n),e.update(s),e.digest()},o.digest=o.getMac,o}});var ZO=M((xir,Wde)=>{var Dd=rr();Ad();Lr();var zde=Wde.exports=Dd.md5=Dd.md5||{};Dd.md.md5=Dd.md.algorithms.md5=zde;zde.create=function(){$de||dUe();var t=null,e=Dd.util.createBuffer(),r=new Array(16),n={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var o=n.messageLengthSize/4,s=0;s<o;++s)n.fullMessageLength.push(0);return e=Dd.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},n},n.start(),n.update=function(o,s){s==="utf8"&&(o=Dd.util.encodeUtf8(o));var a=o.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=n.fullMessageLength.length-1;c>=0;--c)n.fullMessageLength[c]+=a[1],a[1]=a[0]+(n.fullMessageLength[c]/4294967296>>>0),n.fullMessageLength[c]=n.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(o),Gde(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var o=Dd.util.createBuffer();o.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;o.putBytes(pG.substr(0,n.blockLength-a));for(var c,u=0,l=n.fullMessageLength.length-1;l>=0;--l)c=n.fullMessageLength[l]*8+u,u=c/4294967296>>>0,o.putInt32Le(c>>>0);var d={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3};Gde(d,r,o);var p=Dd.util.createBuffer();return p.putInt32Le(d.h0),p.putInt32Le(d.h1),p.putInt32Le(d.h2),p.putInt32Le(d.h3),p},n};var pG=null,JO=null,ik=null,XS=null,$de=!1;function dUe(){pG="\x80",pG+=Dd.util.fillString("\0",64),JO=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],ik=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],XS=new Array(64);for(var t=0;t<64;++t)XS[t]=Math.floor(Math.abs(Math.sin(t+1))*4294967296);$de=!0}function Gde(t,e,r){for(var n,o,s,a,c,u,l,d,p=r.length();p>=64;){for(o=t.h0,s=t.h1,a=t.h2,c=t.h3,d=0;d<16;++d)e[d]=r.getInt32Le(),u=c^s&(a^c),n=o+u+XS[d]+e[d],l=ik[d],o=c,c=a,a=s,s+=n<<l|n>>>32-l;for(;d<32;++d)u=a^c&(s^a),n=o+u+XS[d]+e[JO[d]],l=ik[d],o=c,c=a,a=s,s+=n<<l|n>>>32-l;for(;d<48;++d)u=s^a^c,n=o+u+XS[d]+e[JO[d]],l=ik[d],o=c,c=a,a=s,s+=n<<l|n>>>32-l;for(;d<64;++d)u=a^(s|~c),n=o+u+XS[d]+e[JO[d]],l=ik[d],o=c,c=a,a=s,s+=n<<l|n>>>32-l;t.h0=t.h0+o|0,t.h1=t.h1+s|0,t.h2=t.h2+a|0,t.h3=t.h3+c|0,p-=64}}});var by=M((Sir,Yde)=>{var t3=rr();Lr();var Kde=Yde.exports=t3.pem=t3.pem||{};Kde.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=e3(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=e3(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=e3(n)),t.headers)for(var o=0;o<t.headers.length;++o)r+=e3(t.headers[o]);return t.procType&&(r+=`\r
`),r+=t3.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};Kde.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,o=/\r?\n/,s;s=r.exec(t),!!s;){var a=s[1];a==="NEW CERTIFICATE REQUEST"&&(a="CERTIFICATE REQUEST");var c={type:a,procType:null,contentDomain:null,dekInfo:null,headers:[],body:t3.util.decode64(s[3])};if(e.push(c),!!s[2]){for(var u=s[2].split(o),l=0;s&&l<u.length;){for(var d=u[l].replace(/\s+$/,""),p=l+1;p<u.length;++p){var f=u[p];if(!/\s/.test(f[0]))break;d+=f,l=p}if(s=d.match(n),s){for(var m={name:s[1],values:[]},h=s[2].split(","),g=0;g<h.length;++g)m.values.push(pUe(h[g]));if(c.procType)if(!c.contentDomain&&m.name==="Content-Domain")c.contentDomain=h[0]||"";else if(!c.dekInfo&&m.name==="DEK-Info"){if(m.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');c.dekInfo={algorithm:h[0],parameters:h[1]||null}}else c.headers.push(m);else{if(m.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(m.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');c.procType={version:h[0],type:h[1]}}}++l}if(c.procType==="ENCRYPTED"&&!c.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function e3(t){for(var e=t.name+": ",r=[],n=function(u,l){return" "+l},o=0;o<t.values.length;++o)r.push(t.values[o].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var s=0,a=-1,o=0;o<e.length;++o,++s)if(s>65&&a!==-1){var c=e[a];c===","?(++a,e=e.substr(0,a)+`\r
 `+e.substr(a)):e=e.substr(0,a)+`\r
`+c+e.substr(a+1),s=o-a-1,a=-1,++o}else(e[o]===" "||e[o]==="	"||e[o]===",")&&(a=o);return e}function pUe(t){return t.replace(/^\s+/,"")}});var ok=M((Iir,Xde)=>{var Kn=rr();$O();aG();Lr();Xde.exports=Kn.des=Kn.des||{};Kn.des.startEncrypting=function(t,e,r,n){var o=r3({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return o.start(e),o};Kn.des.createEncryptionCipher=function(t,e){return r3({key:t,output:null,decrypt:!1,mode:e})};Kn.des.startDecrypting=function(t,e,r,n){var o=r3({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return o.start(e),o};Kn.des.createDecryptionCipher=function(t,e){return r3({key:t,output:null,decrypt:!0,mode:e})};Kn.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,o){return Qde(r._keys,n,o,!1)},decrypt:function(n,o){return Qde(r._keys,n,o,!0)}}}),r._init=!1};Kn.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=Kn.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=xUe(e),this._init=!0}};Nd("DES-ECB",Kn.cipher.modes.ecb);Nd("DES-CBC",Kn.cipher.modes.cbc);Nd("DES-CFB",Kn.cipher.modes.cfb);Nd("DES-OFB",Kn.cipher.modes.ofb);Nd("DES-CTR",Kn.cipher.modes.ctr);Nd("3DES-ECB",Kn.cipher.modes.ecb);Nd("3DES-CBC",Kn.cipher.modes.cbc);Nd("3DES-CFB",Kn.cipher.modes.cfb);Nd("3DES-OFB",Kn.cipher.modes.ofb);Nd("3DES-CTR",Kn.cipher.modes.ctr);function Nd(t,e){var r=function(){return new Kn.des.Algorithm(t,e)};Kn.cipher.registerAlgorithm(t,r)}var fUe=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],mUe=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],hUe=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],gUe=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],vUe=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],yUe=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],bUe=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],_Ue=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function xUe(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],o=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],c=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],u=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],l=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],d=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],p=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],f=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],m=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],h=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,v=[],y=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],b=0,_,S=0;S<g;S++){var I=t.getInt32(),T=t.getInt32();_=(I>>>4^T)&252645135,T^=_,I^=_<<4,_=(T>>>-16^I)&65535,I^=_,T^=_<<-16,_=(I>>>2^T)&858993459,T^=_,I^=_<<2,_=(T>>>-16^I)&65535,I^=_,T^=_<<-16,_=(I>>>1^T)&1431655765,T^=_,I^=_<<1,_=(T>>>8^I)&16711935,I^=_,T^=_<<8,_=(I>>>1^T)&1431655765,T^=_,I^=_<<1,_=I<<8|T>>>20&240,I=T<<24|T<<8&16711680|T>>>8&65280|T>>>24&240,T=_;for(var A=0;A<y.length;++A){y[A]?(I=I<<2|I>>>26,T=T<<2|T>>>26):(I=I<<1|I>>>27,T=T<<1|T>>>27),I&=-15,T&=-15;var B=e[I>>>28]|r[I>>>24&15]|n[I>>>20&15]|o[I>>>16&15]|s[I>>>12&15]|a[I>>>8&15]|c[I>>>4&15],j=u[T>>>28]|l[T>>>24&15]|d[T>>>20&15]|p[T>>>16&15]|f[T>>>12&15]|m[T>>>8&15]|h[T>>>4&15];_=(j>>>16^B)&65535,v[b++]=B^_,v[b++]=j^_<<16}}return v}function Qde(t,e,r,n){var o=t.length===32?3:9,s;o===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var a,c=e[0],u=e[1];a=(c>>>4^u)&252645135,u^=a,c^=a<<4,a=(c>>>16^u)&65535,u^=a,c^=a<<16,a=(u>>>2^c)&858993459,c^=a,u^=a<<2,a=(u>>>8^c)&16711935,c^=a,u^=a<<8,a=(c>>>1^u)&1431655765,u^=a,c^=a<<1,c=c<<1|c>>>31,u=u<<1|u>>>31;for(var l=0;l<o;l+=3){for(var d=s[l+1],p=s[l+2],f=s[l];f!=d;f+=p){var m=u^t[f],h=(u>>>4|u<<28)^t[f+1];a=c,c=u,u=a^(mUe[m>>>24&63]|gUe[m>>>16&63]|yUe[m>>>8&63]|_Ue[m&63]|fUe[h>>>24&63]|hUe[h>>>16&63]|vUe[h>>>8&63]|bUe[h&63])}a=c,c=u,u=a}c=c>>>1|c<<31,u=u>>>1|u<<31,a=(c>>>1^u)&1431655765,u^=a,c^=a<<1,a=(u>>>8^c)&16711935,c^=a,u^=a<<8,a=(u>>>2^c)&858993459,c^=a,u^=a<<2,a=(c>>>16^u)&65535,u^=a,c^=a<<16,a=(c>>>4^u)&252645135,u^=a,c^=a<<4,r[0]=c,r[1]=u}function r3(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=Kn.cipher.createDecipher(r,t.key):n=Kn.cipher.createCipher(r,t.key);var o=n.start;return n.start=function(s,a){var c=null;a instanceof Kn.util.ByteBuffer&&(c=a,a={}),a=a||{},a.output=c,a.iv=s,o.call(n,a)},n}});var n3=M((Cir,Jde)=>{var ia=rr();QS();Ad();Lr();var SUe=ia.pkcs5=ia.pkcs5||{},Nf;ia.util.isNodejs&&!ia.options.usePureJavaScript&&(Nf=require("crypto"));Jde.exports=ia.pbkdf2=SUe.pbkdf2=function(t,e,r,n,o,s){if(typeof o=="function"&&(s=o,o=null),ia.util.isNodejs&&!ia.options.usePureJavaScript&&Nf.pbkdf2&&(o===null||typeof o!="object")&&(Nf.pbkdf2Sync.length>4||!o||o==="sha1"))return typeof o!="string"&&(o="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),s?Nf.pbkdf2Sync.length===4?Nf.pbkdf2(t,e,r,n,function(_,S){if(_)return s(_);s(null,S.toString("binary"))}):Nf.pbkdf2(t,e,r,n,o,function(_,S){if(_)return s(_);s(null,S.toString("binary"))}):Nf.pbkdf2Sync.length===4?Nf.pbkdf2Sync(t,e,r,n).toString("binary"):Nf.pbkdf2Sync(t,e,r,n,o).toString("binary");if((typeof o>"u"||o===null)&&(o="sha1"),typeof o=="string"){if(!(o in ia.md.algorithms))throw new Error("Unknown hash algorithm: "+o);o=ia.md[o].create()}var a=o.digestLength;if(n>4294967295*a){var c=new Error("Derived key is too long.");if(s)return s(c);throw c}var u=Math.ceil(n/a),l=n-(u-1)*a,d=ia.hmac.create();d.start(o,t);var p="",f,m,h;if(!s){for(var g=1;g<=u;++g){d.start(null,null),d.update(e),d.update(ia.util.int32ToBytes(g)),f=h=d.digest().getBytes();for(var v=2;v<=r;++v)d.start(null,null),d.update(h),m=d.digest().getBytes(),f=ia.util.xorBytes(f,m,a),h=m;p+=g<u?f:f.substr(0,l)}return p}var g=1,v;function y(){if(g>u)return s(null,p);d.start(null,null),d.update(e),d.update(ia.util.int32ToBytes(g)),f=h=d.digest().getBytes(),v=2,b()}function b(){if(v<=r)return d.start(null,null),d.update(h),m=d.digest().getBytes(),f=ia.util.xorBytes(f,m,a),h=m,++v,ia.util.setImmediate(b);p+=g<u?f:f.substr(0,l),++g,y()}y()}});var mG=M((Eir,npe)=>{var Ld=rr();Ad();Lr();var epe=npe.exports=Ld.sha256=Ld.sha256||{};Ld.md.sha256=Ld.md.algorithms.sha256=epe;epe.create=function(){tpe||IUe();var t=null,e=Ld.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var o=n.messageLengthSize/4,s=0;s<o;++s)n.fullMessageLength.push(0);return e=Ld.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(o,s){s==="utf8"&&(o=Ld.util.encodeUtf8(o));var a=o.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=n.fullMessageLength.length-1;c>=0;--c)n.fullMessageLength[c]+=a[1],a[1]=a[0]+(n.fullMessageLength[c]/4294967296>>>0),n.fullMessageLength[c]=n.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(o),Zde(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var o=Ld.util.createBuffer();o.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;o.putBytes(fG.substr(0,n.blockLength-a));for(var c,u,l=n.fullMessageLength[0]*8,d=0;d<n.fullMessageLength.length-1;++d)c=n.fullMessageLength[d+1]*8,u=c/4294967296>>>0,l+=u,o.putInt32(l>>>0),l=c>>>0;o.putInt32(l);var p={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};Zde(p,r,o);var f=Ld.util.createBuffer();return f.putInt32(p.h0),f.putInt32(p.h1),f.putInt32(p.h2),f.putInt32(p.h3),f.putInt32(p.h4),f.putInt32(p.h5),f.putInt32(p.h6),f.putInt32(p.h7),f},n};var fG=null,tpe=!1,rpe=null;function IUe(){fG="\x80",fG+=Ld.util.fillString("\0",64),rpe=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],tpe=!0}function Zde(t,e,r){for(var n,o,s,a,c,u,l,d,p,f,m,h,g,v,y,b=r.length();b>=64;){for(l=0;l<16;++l)e[l]=r.getInt32();for(;l<64;++l)n=e[l-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,o=e[l-15],o=(o>>>7|o<<25)^(o>>>18|o<<14)^o>>>3,e[l]=n+e[l-7]+o+e[l-16]|0;for(d=t.h0,p=t.h1,f=t.h2,m=t.h3,h=t.h4,g=t.h5,v=t.h6,y=t.h7,l=0;l<64;++l)a=(h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7),c=v^h&(g^v),s=(d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),u=d&p|f&(d^p),n=y+a+c+rpe[l]+e[l],o=s+u,y=v,v=g,g=h,h=m+n>>>0,m=f,f=p,p=d,d=n+o>>>0;t.h0=t.h0+d|0,t.h1=t.h1+p|0,t.h2=t.h2+f|0,t.h3=t.h3+m|0,t.h4=t.h4+h|0,t.h5=t.h5+g|0,t.h6=t.h6+v|0,t.h7=t.h7+y|0,b-=64}}});var hG=M((Tir,ipe)=>{var Od=rr();Lr();var i3=null;Od.util.isNodejs&&!Od.options.usePureJavaScript&&!process.versions["node-webkit"]&&(i3=require("crypto"));var CUe=ipe.exports=Od.prng=Od.prng||{};CUe.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),o=0;o<32;++o)n[o]=r.create();e.pools=n,e.pool=0,e.generate=function(l,d){if(!d)return e.generateSync(l);var p=e.plugin.cipher,f=e.plugin.increment,m=e.plugin.formatKey,h=e.plugin.formatSeed,g=Od.util.createBuffer();e.key=null,v();function v(y){if(y)return d(y);if(g.length()>=l)return d(null,g.getBytes(l));if(e.generated>1048575&&(e.key=null),e.key===null)return Od.util.nextTick(function(){s(v)});var b=p(e.key,e.seed);e.generated+=b.length,g.putBytes(b),e.key=m(p(e.key,f(e.seed))),e.seed=h(p(e.key,e.seed)),Od.util.setImmediate(v)}},e.generateSync=function(l){var d=e.plugin.cipher,p=e.plugin.increment,f=e.plugin.formatKey,m=e.plugin.formatSeed;e.key=null;for(var h=Od.util.createBuffer();h.length()<l;){e.generated>1048575&&(e.key=null),e.key===null&&a();var g=d(e.key,e.seed);e.generated+=g.length,h.putBytes(g),e.key=f(d(e.key,p(e.seed))),e.seed=m(d(e.key,e.seed))}return h.getBytes(l)};function s(l){if(e.pools[0].messageLength>=32)return c(),l();var d=32-e.pools[0].messageLength<<5;e.seedFile(d,function(p,f){if(p)return l(p);e.collect(f),c(),l()})}function a(){if(e.pools[0].messageLength>=32)return c();var l=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(l)),c()}function c(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var l=e.plugin.md.create();l.update(e.keyBytes);for(var d=1,p=0;p<32;++p)e.reseeds%d===0&&(l.update(e.pools[p].digest().getBytes()),e.pools[p].start()),d=d<<1;e.keyBytes=l.digest().getBytes(),l.start(),l.update(e.keyBytes);var f=l.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(f),e.generated=0}function u(l){var d=null,p=Od.util.globalScope,f=p.crypto||p.msCrypto;f&&f.getRandomValues&&(d=function(I){return f.getRandomValues(I)});var m=Od.util.createBuffer();if(d)for(;m.length()<l;){var h=Math.max(1,Math.min(l-m.length(),65536)/4),g=new Uint32Array(Math.floor(h));try{d(g);for(var v=0;v<g.length;++v)m.putInt32(g[v])}catch(I){if(!(typeof QuotaExceededError<"u"&&I instanceof QuotaExceededError))throw I}}if(m.length()<l)for(var y,b,_,S=Math.floor(Math.random()*65536);m.length()<l;){b=16807*(S&65535),y=16807*(S>>16),b+=(y&32767)<<16,b+=y>>15,b=(b&2147483647)+(b>>31),S=b&4294967295;for(var v=0;v<3;++v)_=S>>>(v<<3),_^=Math.floor(Math.random()*256),m.putByte(_&255)}return m.getBytes(l)}return i3?(e.seedFile=function(l,d){i3.randomBytes(l,function(p,f){if(p)return d(p);d(null,f.toString())})},e.seedFileSync=function(l){return i3.randomBytes(l).toString()}):(e.seedFile=function(l,d){try{d(null,u(l))}catch(p){d(p)}},e.seedFileSync=u),e.collect=function(l){for(var d=l.length,p=0;p<d;++p)e.pools[e.pool].update(l.substr(p,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(l,d){for(var p="",f=0;f<d;f+=8)p+=String.fromCharCode(l>>f&255);e.collect(p)},e.registerWorker=function(l){if(l===self)e.seedFile=function(p,f){function m(h){var g=h.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",m),f(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",m),self.postMessage({forge:{prng:{needed:p}}})};else{var d=function(p){var f=p.data;f.forge&&f.forge.prng&&e.seedFile(f.forge.prng.needed,function(m,h){l.postMessage({forge:{prng:{err:m,bytes:h}}})})};l.addEventListener("message",d)}},e}});var gu=M((wir,gG)=>{var Go=rr();_g();mG();hG();Lr();(function(){if(Go.random&&Go.random.getBytes){gG.exports=Go.random;return}(function(t){var e={},r=new Array(4),n=Go.util.createBuffer();e.formatKey=function(p){var f=Go.util.createBuffer(p);return p=new Array(4),p[0]=f.getInt32(),p[1]=f.getInt32(),p[2]=f.getInt32(),p[3]=f.getInt32(),Go.aes._expandKey(p,!1)},e.formatSeed=function(p){var f=Go.util.createBuffer(p);return p=new Array(4),p[0]=f.getInt32(),p[1]=f.getInt32(),p[2]=f.getInt32(),p[3]=f.getInt32(),p},e.cipher=function(p,f){return Go.aes._updateBlock(p,f,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(p){return++p[3],p},e.md=Go.md.sha256;function o(){var p=Go.prng.create(e);return p.getBytes=function(f,m){return p.generate(f,m)},p.getBytesSync=function(f){return p.generate(f)},p}var s=o(),a=null,c=Go.util.globalScope,u=c.crypto||c.msCrypto;if(u&&u.getRandomValues&&(a=function(p){return u.getRandomValues(p)}),Go.options.usePureJavaScript||!Go.util.isNodejs&&!a){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var l="";for(var d in navigator)try{typeof navigator[d]=="string"&&(l+=navigator[d])}catch{}s.collect(l),l=null}t&&(t().mousemove(function(p){s.collectInt(p.clientX,16),s.collectInt(p.clientY,16)}),t().keypress(function(p){s.collectInt(p.charCode,8)}))}if(!Go.random)Go.random=s;else for(var d in s)Go.random[d]=s[d];Go.random.createInstance=o,gG.exports=Go.random})(typeof jQuery<"u"?jQuery:null)})()});var yG=M((Rir,ape)=>{var La=rr();Lr();var vG=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],ope=[1,2,3,5],EUe=function(t,e){return t<<e&65535|(t&65535)>>16-e},TUe=function(t,e){return(t&65535)>>e|t<<16-e&65535};ape.exports=La.rc2=La.rc2||{};La.rc2.expandKey=function(t,e){typeof t=="string"&&(t=La.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),o=e,s=Math.ceil(o/8),a=255>>(o&7),c;for(c=n;c<128;c++)r.putByte(vG[r.at(c-1)+r.at(c-n)&255]);for(r.setAt(128-s,vG[r.at(128-s)&a]),c=127-s;c>=0;c--)r.setAt(c,vG[r.at(c+1)^r.at(c+s)]);return r};var spe=function(t,e,r){var n=!1,o=null,s=null,a=null,c,u,l,d,p=[];for(t=La.rc2.expandKey(t,e),l=0;l<64;l++)p.push(t.getInt16Le());r?(c=function(h){for(l=0;l<4;l++)h[l]+=p[d]+(h[(l+3)%4]&h[(l+2)%4])+(~h[(l+3)%4]&h[(l+1)%4]),h[l]=EUe(h[l],ope[l]),d++},u=function(h){for(l=0;l<4;l++)h[l]+=p[h[(l+3)%4]&63]}):(c=function(h){for(l=3;l>=0;l--)h[l]=TUe(h[l],ope[l]),h[l]-=p[d]+(h[(l+3)%4]&h[(l+2)%4])+(~h[(l+3)%4]&h[(l+1)%4]),d--},u=function(h){for(l=3;l>=0;l--)h[l]-=p[h[(l+3)%4]&63]});var f=function(h){var g=[];for(l=0;l<4;l++){var v=o.getInt16Le();a!==null&&(r?v^=a.getInt16Le():a.putInt16Le(v)),g.push(v&65535)}d=r?0:63;for(var y=0;y<h.length;y++)for(var b=0;b<h[y][0];b++)h[y][1](g);for(l=0;l<4;l++)a!==null&&(r?a.putInt16Le(g[l]):g[l]^=a.getInt16Le()),s.putInt16Le(g[l])},m=null;return m={start:function(h,g){h&&typeof h=="string"&&(h=La.util.createBuffer(h)),n=!1,o=La.util.createBuffer(),s=g||new La.util.createBuffer,a=h,m.output=s},update:function(h){for(n||o.putBuffer(h);o.length()>=8;)f([[5,c],[1,u],[6,c],[1,u],[5,c]])},finish:function(h){var g=!0;if(r)if(h)g=h(8,o,!r);else{var v=o.length()===8?8:8-o.length();o.fillWithByte(v,v)}if(g&&(n=!0,m.update()),!r&&(g=o.length()===0,g))if(h)g=h(8,s,!r);else{var y=s.length(),b=s.at(y-1);b>y?g=!1:s.truncate(b)}return g}},m};La.rc2.startEncrypting=function(t,e,r){var n=La.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};La.rc2.createEncryptionCipher=function(t,e){return spe(t,e,!0)};La.rc2.startDecrypting=function(t,e,r){var n=La.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};La.rc2.createDecryptionCipher=function(t,e){return spe(t,e,!1)}});var ak=M((kir,hpe)=>{var bG=rr();hpe.exports=bG.jsbn=bG.jsbn||{};var Lf,wUe=0xdeadbeefcafe,cpe=(wUe&16777215)==15715070;function xe(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}bG.jsbn.BigInteger=xe;function Or(){return new xe(null)}function RUe(t,e,r,n,o,s){for(;--s>=0;){var a=e*this.data[t++]+r.data[n]+o;o=Math.floor(a/67108864),r.data[n++]=a&67108863}return o}function kUe(t,e,r,n,o,s){for(var a=e&32767,c=e>>15;--s>=0;){var u=this.data[t]&32767,l=this.data[t++]>>15,d=c*u+l*a;u=a*u+((d&32767)<<15)+r.data[n]+(o&1073741823),o=(u>>>30)+(d>>>15)+c*l+(o>>>30),r.data[n++]=u&1073741823}return o}function upe(t,e,r,n,o,s){for(var a=e&16383,c=e>>14;--s>=0;){var u=this.data[t]&16383,l=this.data[t++]>>14,d=c*u+l*a;u=a*u+((d&16383)<<14)+r.data[n]+o,o=(u>>28)+(d>>14)+c*l,r.data[n++]=u&268435455}return o}typeof navigator>"u"?(xe.prototype.am=upe,Lf=28):cpe&&navigator.appName=="Microsoft Internet Explorer"?(xe.prototype.am=kUe,Lf=30):cpe&&navigator.appName!="Netscape"?(xe.prototype.am=RUe,Lf=26):(xe.prototype.am=upe,Lf=28);xe.prototype.DB=Lf;xe.prototype.DM=(1<<Lf)-1;xe.prototype.DV=1<<Lf;var _G=52;xe.prototype.FV=Math.pow(2,_G);xe.prototype.F1=_G-Lf;xe.prototype.F2=2*Lf-_G;var PUe="0123456789abcdefghijklmnopqrstuvwxyz",o3=new Array,JS,vu;JS=48;for(vu=0;vu<=9;++vu)o3[JS++]=vu;JS=97;for(vu=10;vu<36;++vu)o3[JS++]=vu;JS=65;for(vu=10;vu<36;++vu)o3[JS++]=vu;function lpe(t){return PUe.charAt(t)}function dpe(t,e){var r=o3[t.charCodeAt(e)];return r??-1}function AUe(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function DUe(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function Sg(t){var e=Or();return e.fromInt(t),e}function NUe(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,o=!1,s=0;--n>=0;){var a=r==8?t[n]&255:dpe(t,n);if(a<0){t.charAt(n)=="-"&&(o=!0);continue}o=!1,s==0?this.data[this.t++]=a:s+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this.data[this.t++]=a>>this.DB-s):this.data[this.t-1]|=a<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&t[0]&128&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&xe.ZERO.subTo(this,this)}function LUe(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function OUe(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,o=!1,s="",a=this.t,c=this.DB-a*this.DB%e;if(a-- >0)for(c<this.DB&&(n=this.data[a]>>c)>0&&(o=!0,s=lpe(n));a>=0;)c<e?(n=(this.data[a]&(1<<c)-1)<<e-c,n|=this.data[--a]>>(c+=this.DB-e)):(n=this.data[a]>>(c-=e)&r,c<=0&&(c+=this.DB,--a)),n>0&&(o=!0),o&&(s+=lpe(n));return o?s:"0"}function MUe(){var t=Or();return xe.ZERO.subTo(this,t),t}function FUe(){return this.s<0?this.negate():this}function UUe(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function s3(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function BUe(){return this.t<=0?0:this.DB*(this.t-1)+s3(this.data[this.t-1]^this.s&this.DM)}function qUe(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function HUe(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function jUe(t,e){var r=t%this.DB,n=this.DB-r,o=(1<<n)-1,s=Math.floor(t/this.DB),a=this.s<<r&this.DM,c;for(c=this.t-1;c>=0;--c)e.data[c+s+1]=this.data[c]>>n|a,a=(this.data[c]&o)<<r;for(c=s-1;c>=0;--c)e.data[c]=0;e.data[s]=a,e.t=this.t+s+1,e.s=this.s,e.clamp()}function VUe(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,o=this.DB-n,s=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var a=r+1;a<this.t;++a)e.data[a-r-1]|=(this.data[a]&s)<<o,e.data[a-r]=this.data[a]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&s)<<o),e.t=this.t-r,e.clamp()}function GUe(t,e){for(var r=0,n=0,o=Math.min(t.t,this.t);r<o;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function zUe(t,e){var r=this.abs(),n=t.abs(),o=r.t;for(e.t=o+n.t;--o>=0;)e.data[o]=0;for(o=0;o<n.t;++o)e.data[o+r.t]=r.am(0,n.data[o],e,o,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&xe.ZERO.subTo(e,e)}function $Ue(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function WUe(t,e,r){var n=t.abs();if(!(n.t<=0)){var o=this.abs();if(o.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=Or());var s=Or(),a=this.s,c=t.s,u=this.DB-s3(n.data[n.t-1]);u>0?(n.lShiftTo(u,s),o.lShiftTo(u,r)):(n.copyTo(s),o.copyTo(r));var l=s.t,d=s.data[l-1];if(d!=0){var p=d*(1<<this.F1)+(l>1?s.data[l-2]>>this.F2:0),f=this.FV/p,m=(1<<this.F1)/p,h=1<<this.F2,g=r.t,v=g-l,y=e??Or();for(s.dlShiftTo(v,y),r.compareTo(y)>=0&&(r.data[r.t++]=1,r.subTo(y,r)),xe.ONE.dlShiftTo(l,y),y.subTo(s,s);s.t<l;)s.data[s.t++]=0;for(;--v>=0;){var b=r.data[--g]==d?this.DM:Math.floor(r.data[g]*f+(r.data[g-1]+h)*m);if((r.data[g]+=s.am(0,b,r,v,0,l))<b)for(s.dlShiftTo(v,y),r.subTo(y,r);r.data[g]<--b;)r.subTo(y,r)}e!=null&&(r.drShiftTo(l,e),a!=c&&xe.ZERO.subTo(e,e)),r.t=l,r.clamp(),u>0&&r.rShiftTo(u,r),a<0&&xe.ZERO.subTo(r,r)}}}function KUe(t){var e=Or();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(xe.ZERO)>0&&t.subTo(e,e),e}function _y(t){this.m=t}function YUe(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function QUe(t){return t}function XUe(t){t.divRemTo(this.m,null,t)}function JUe(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function ZUe(t,e){t.squareTo(e),this.reduce(e)}_y.prototype.convert=YUe;_y.prototype.revert=QUe;_y.prototype.reduce=XUe;_y.prototype.mulTo=JUe;_y.prototype.sqrTo=ZUe;function eBe(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function xy(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function tBe(t){var e=Or();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(xe.ZERO)>0&&this.m.subTo(e,e),e}function rBe(t){var e=Or();return t.copyTo(e),this.reduce(e),e}function nBe(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function iBe(t,e){t.squareTo(e),this.reduce(e)}function oBe(t,e,r){t.multiplyTo(e,r),this.reduce(r)}xy.prototype.convert=tBe;xy.prototype.revert=rBe;xy.prototype.reduce=nBe;xy.prototype.mulTo=oBe;xy.prototype.sqrTo=iBe;function sBe(){return(this.t>0?this.data[0]&1:this.s)==0}function aBe(t,e){if(t>4294967295||t<1)return xe.ONE;var r=Or(),n=Or(),o=e.convert(this),s=s3(t)-1;for(o.copyTo(r);--s>=0;)if(e.sqrTo(r,n),(t&1<<s)>0)e.mulTo(n,o,r);else{var a=r;r=n,n=a}return e.revert(r)}function cBe(t,e){var r;return t<256||e.isEven()?r=new _y(e):r=new xy(e),this.exp(t,r)}xe.prototype.copyTo=AUe;xe.prototype.fromInt=DUe;xe.prototype.fromString=NUe;xe.prototype.clamp=LUe;xe.prototype.dlShiftTo=qUe;xe.prototype.drShiftTo=HUe;xe.prototype.lShiftTo=jUe;xe.prototype.rShiftTo=VUe;xe.prototype.subTo=GUe;xe.prototype.multiplyTo=zUe;xe.prototype.squareTo=$Ue;xe.prototype.divRemTo=WUe;xe.prototype.invDigit=eBe;xe.prototype.isEven=sBe;xe.prototype.exp=aBe;xe.prototype.toString=OUe;xe.prototype.negate=MUe;xe.prototype.abs=FUe;xe.prototype.compareTo=UUe;xe.prototype.bitLength=BUe;xe.prototype.mod=KUe;xe.prototype.modPowInt=cBe;xe.ZERO=Sg(0);xe.ONE=Sg(1);function uBe(){var t=Or();return this.copyTo(t),t}function lBe(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function dBe(){return this.t==0?this.s:this.data[0]<<24>>24}function pBe(){return this.t==0?this.s:this.data[0]<<16>>16}function fBe(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function mBe(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function hBe(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=Sg(r),o=Or(),s=Or(),a="";for(this.divRemTo(n,o,s);o.signum()>0;)a=(r+s.intValue()).toString(t).substr(1)+a,o.divRemTo(n,o,s);return s.intValue().toString(t)+a}function gBe(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),o=!1,s=0,a=0,c=0;c<t.length;++c){var u=dpe(t,c);if(u<0){t.charAt(c)=="-"&&this.signum()==0&&(o=!0);continue}a=e*a+u,++s>=r&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0)}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(a,0)),o&&xe.ZERO.subTo(this,this)}function vBe(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(xe.ONE.shiftLeft(t-1),xG,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(xe.ONE.shiftLeft(t-1),this);else{var n=new Array,o=t&7;n.length=(t>>3)+1,e.nextBytes(n),o>0?n[0]&=(1<<o)-1:n[0]=0,this.fromString(n,256)}}function yBe(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,o=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[o++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),o==0&&(this.s&128)!=(n&128)&&++o,(o>0||n!=this.s)&&(e[o++]=n);return e}function bBe(t){return this.compareTo(t)==0}function _Be(t){return this.compareTo(t)<0?this:t}function xBe(t){return this.compareTo(t)>0?this:t}function SBe(t,e,r){var n,o,s=Math.min(t.t,this.t);for(n=0;n<s;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(o=t.s&this.DM,n=s;n<this.t;++n)r.data[n]=e(this.data[n],o);r.t=this.t}else{for(o=this.s&this.DM,n=s;n<t.t;++n)r.data[n]=e(o,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function IBe(t,e){return t&e}function CBe(t){var e=Or();return this.bitwiseTo(t,IBe,e),e}function xG(t,e){return t|e}function EBe(t){var e=Or();return this.bitwiseTo(t,xG,e),e}function ppe(t,e){return t^e}function TBe(t){var e=Or();return this.bitwiseTo(t,ppe,e),e}function fpe(t,e){return t&~e}function wBe(t){var e=Or();return this.bitwiseTo(t,fpe,e),e}function RBe(){for(var t=Or(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function kBe(t){var e=Or();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function PBe(t){var e=Or();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function ABe(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function DBe(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+ABe(this.data[t]);return this.s<0?this.t*this.DB:-1}function NBe(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function LBe(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=NBe(this.data[r]^e);return t}function OBe(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function MBe(t,e){var r=xe.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function FBe(t){return this.changeBit(t,xG)}function UBe(t){return this.changeBit(t,fpe)}function BBe(t){return this.changeBit(t,ppe)}function qBe(t,e){for(var r=0,n=0,o=Math.min(t.t,this.t);r<o;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function HBe(t){var e=Or();return this.addTo(t,e),e}function jBe(t){var e=Or();return this.subTo(t,e),e}function VBe(t){var e=Or();return this.multiplyTo(t,e),e}function GBe(t){var e=Or();return this.divRemTo(t,e,null),e}function zBe(t){var e=Or();return this.divRemTo(t,null,e),e}function $Be(t){var e=Or(),r=Or();return this.divRemTo(t,e,r),new Array(e,r)}function WBe(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function KBe(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function sk(){}function mpe(t){return t}function YBe(t,e,r){t.multiplyTo(e,r)}function QBe(t,e){t.squareTo(e)}sk.prototype.convert=mpe;sk.prototype.revert=mpe;sk.prototype.mulTo=YBe;sk.prototype.sqrTo=QBe;function XBe(t){return this.exp(t,new sk)}function JBe(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var o;for(o=r.t-this.t;n<o;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(o=Math.min(t.t,e);n<o;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function ZBe(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function ZS(t){this.r2=Or(),this.q3=Or(),xe.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function eqe(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=Or();return t.copyTo(e),this.reduce(e),e}function tqe(t){return t}function rqe(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function nqe(t,e){t.squareTo(e),this.reduce(e)}function iqe(t,e,r){t.multiplyTo(e,r),this.reduce(r)}ZS.prototype.convert=eqe;ZS.prototype.revert=tqe;ZS.prototype.reduce=rqe;ZS.prototype.mulTo=iqe;ZS.prototype.sqrTo=nqe;function oqe(t,e){var r=t.bitLength(),n,o=Sg(1),s;if(r<=0)return o;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new _y(e):e.isEven()?s=new ZS(e):s=new xy(e);var a=new Array,c=3,u=n-1,l=(1<<n)-1;if(a[1]=s.convert(this),n>1){var d=Or();for(s.sqrTo(a[1],d);c<=l;)a[c]=Or(),s.mulTo(d,a[c-2],a[c]),c+=2}var p=t.t-1,f,m=!0,h=Or(),g;for(r=s3(t.data[p])-1;p>=0;){for(r>=u?f=t.data[p]>>r-u&l:(f=(t.data[p]&(1<<r+1)-1)<<u-r,p>0&&(f|=t.data[p-1]>>this.DB+r-u)),c=n;!(f&1);)f>>=1,--c;if((r-=c)<0&&(r+=this.DB,--p),m)a[f].copyTo(o),m=!1;else{for(;c>1;)s.sqrTo(o,h),s.sqrTo(h,o),c-=2;c>0?s.sqrTo(o,h):(g=o,o=h,h=g),s.mulTo(h,a[f],o)}for(;p>=0&&!(t.data[p]&1<<r);)s.sqrTo(o,h),g=o,o=h,h=g,--r<0&&(r=this.DB-1,--p)}return s.revert(o)}function sqe(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var o=e.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return e;for(o<s&&(s=o),s>0&&(e.rShiftTo(s,e),r.rShiftTo(s,r));e.signum()>0;)(o=e.getLowestSetBit())>0&&e.rShiftTo(o,e),(o=r.getLowestSetBit())>0&&r.rShiftTo(o,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function aqe(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function cqe(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return xe.ZERO;for(var r=t.clone(),n=this.clone(),o=Sg(1),s=Sg(0),a=Sg(0),c=Sg(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!o.isEven()||!s.isEven())&&(o.addTo(this,o),s.subTo(t,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?((!a.isEven()||!c.isEven())&&(a.addTo(this,a),c.subTo(t,c)),a.rShiftTo(1,a)):c.isEven()||c.subTo(t,c),c.rShiftTo(1,c);r.compareTo(n)>=0?(r.subTo(n,r),e&&o.subTo(a,o),s.subTo(c,s)):(n.subTo(r,n),e&&a.subTo(o,a),c.subTo(s,c))}if(n.compareTo(xe.ONE)!=0)return xe.ZERO;if(c.compareTo(t)>=0)return c.subtract(t);if(c.signum()<0)c.addTo(t,c);else return c;return c.signum()<0?c.add(t):c}var wl=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],uqe=(1<<26)/wl[wl.length-1];function lqe(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=wl[wl.length-1]){for(e=0;e<wl.length;++e)if(r.data[0]==wl[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<wl.length;){for(var n=wl[e],o=e+1;o<wl.length&&n<uqe;)n*=wl[o++];for(n=r.modInt(n);e<o;)if(n%wl[e++]==0)return!1}return r.millerRabin(t)}function dqe(t){var e=this.subtract(xe.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),o=pqe(),s,a=0;a<t;++a){do s=new xe(this.bitLength(),o);while(s.compareTo(xe.ONE)<=0||s.compareTo(e)>=0);var c=s.modPow(n,this);if(c.compareTo(xe.ONE)!=0&&c.compareTo(e)!=0){for(var u=1;u++<r&&c.compareTo(e)!=0;)if(c=c.modPowInt(2,this),c.compareTo(xe.ONE)==0)return!1;if(c.compareTo(e)!=0)return!1}}return!0}function pqe(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}xe.prototype.chunkSize=fBe;xe.prototype.toRadix=hBe;xe.prototype.fromRadix=gBe;xe.prototype.fromNumber=vBe;xe.prototype.bitwiseTo=SBe;xe.prototype.changeBit=MBe;xe.prototype.addTo=qBe;xe.prototype.dMultiply=WBe;xe.prototype.dAddOffset=KBe;xe.prototype.multiplyLowerTo=JBe;xe.prototype.multiplyUpperTo=ZBe;xe.prototype.modInt=aqe;xe.prototype.millerRabin=dqe;xe.prototype.clone=uBe;xe.prototype.intValue=lBe;xe.prototype.byteValue=dBe;xe.prototype.shortValue=pBe;xe.prototype.signum=mBe;xe.prototype.toByteArray=yBe;xe.prototype.equals=bBe;xe.prototype.min=_Be;xe.prototype.max=xBe;xe.prototype.and=CBe;xe.prototype.or=EBe;xe.prototype.xor=TBe;xe.prototype.andNot=wBe;xe.prototype.not=RBe;xe.prototype.shiftLeft=kBe;xe.prototype.shiftRight=PBe;xe.prototype.getLowestSetBit=DBe;xe.prototype.bitCount=LBe;xe.prototype.testBit=OBe;xe.prototype.setBit=FBe;xe.prototype.clearBit=UBe;xe.prototype.flipBit=BBe;xe.prototype.add=HBe;xe.prototype.subtract=jBe;xe.prototype.multiply=VBe;xe.prototype.divide=GBe;xe.prototype.remainder=zBe;xe.prototype.divideAndRemainder=$Be;xe.prototype.modPow=oqe;xe.prototype.modInverse=cqe;xe.prototype.pow=XBe;xe.prototype.gcd=sqe;xe.prototype.isProbablePrime=lqe});var eI=M((Pir,bpe)=>{var Md=rr();Ad();Lr();var vpe=bpe.exports=Md.sha1=Md.sha1||{};Md.md.sha1=Md.md.algorithms.sha1=vpe;vpe.create=function(){ype||fqe();var t=null,e=Md.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var o=n.messageLengthSize/4,s=0;s<o;++s)n.fullMessageLength.push(0);return e=Md.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(o,s){s==="utf8"&&(o=Md.util.encodeUtf8(o));var a=o.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var c=n.fullMessageLength.length-1;c>=0;--c)n.fullMessageLength[c]+=a[1],a[1]=a[0]+(n.fullMessageLength[c]/4294967296>>>0),n.fullMessageLength[c]=n.fullMessageLength[c]>>>0,a[0]=a[1]/4294967296>>>0;return e.putBytes(o),gpe(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var o=Md.util.createBuffer();o.putBytes(e.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;o.putBytes(SG.substr(0,n.blockLength-a));for(var c,u,l=n.fullMessageLength[0]*8,d=0;d<n.fullMessageLength.length-1;++d)c=n.fullMessageLength[d+1]*8,u=c/4294967296>>>0,l+=u,o.putInt32(l>>>0),l=c>>>0;o.putInt32(l);var p={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};gpe(p,r,o);var f=Md.util.createBuffer();return f.putInt32(p.h0),f.putInt32(p.h1),f.putInt32(p.h2),f.putInt32(p.h3),f.putInt32(p.h4),f},n};var SG=null,ype=!1;function fqe(){SG="\x80",SG+=Md.util.fillString("\0",64),ype=!0}function gpe(t,e,r){for(var n,o,s,a,c,u,l,d,p=r.length();p>=64;){for(o=t.h0,s=t.h1,a=t.h2,c=t.h3,u=t.h4,d=0;d<16;++d)n=r.getInt32(),e[d]=n,l=c^s&(a^c),n=(o<<5|o>>>27)+l+u+1518500249+n,u=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;for(;d<20;++d)n=e[d-3]^e[d-8]^e[d-14]^e[d-16],n=n<<1|n>>>31,e[d]=n,l=c^s&(a^c),n=(o<<5|o>>>27)+l+u+1518500249+n,u=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;for(;d<32;++d)n=e[d-3]^e[d-8]^e[d-14]^e[d-16],n=n<<1|n>>>31,e[d]=n,l=s^a^c,n=(o<<5|o>>>27)+l+u+1859775393+n,u=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;for(;d<40;++d)n=e[d-6]^e[d-16]^e[d-28]^e[d-32],n=n<<2|n>>>30,e[d]=n,l=s^a^c,n=(o<<5|o>>>27)+l+u+1859775393+n,u=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;for(;d<60;++d)n=e[d-6]^e[d-16]^e[d-28]^e[d-32],n=n<<2|n>>>30,e[d]=n,l=s&a|c&(s^a),n=(o<<5|o>>>27)+l+u+2400959708+n,u=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;for(;d<80;++d)n=e[d-6]^e[d-16]^e[d-28]^e[d-32],n=n<<2|n>>>30,e[d]=n,l=s^a^c,n=(o<<5|o>>>27)+l+u+3395469782+n,u=c,c=a,a=(s<<30|s>>>2)>>>0,s=o,o=n;t.h0=t.h0+o|0,t.h1=t.h1+s|0,t.h2=t.h2+a|0,t.h3=t.h3+c|0,t.h4=t.h4+u|0,p-=64}}});var IG=M((Air,xpe)=>{var Fd=rr();Lr();gu();eI();var _pe=xpe.exports=Fd.pkcs1=Fd.pkcs1||{};_pe.encode_rsa_oaep=function(t,e,r){var n,o,s,a;typeof r=="string"?(n=r,o=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,o=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md)),s?s.start():s=Fd.md.sha1.create(),a||(a=s);var c=Math.ceil(t.n.bitLength()/8),u=c-2*s.digestLength-2;if(e.length>u){var l=new Error("RSAES-OAEP input message length is too long.");throw l.length=e.length,l.maxLength=u,l}n||(n=""),s.update(n,"raw");for(var d=s.digest(),p="",f=u-e.length,m=0;m<f;m++)p+="\0";var h=d.getBytes()+p+""+e;if(!o)o=Fd.random.getBytes(s.digestLength);else if(o.length!==s.digestLength){var l=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw l.seedLength=o.length,l.digestLength=s.digestLength,l}var g=a3(o,c-s.digestLength-1,a),v=Fd.util.xorBytes(h,g,h.length),y=a3(v,s.digestLength,a),b=Fd.util.xorBytes(o,y,o.length);return"\0"+b+v};_pe.decode_rsa_oaep=function(t,e,r){var n,o,s;typeof r=="string"?(n=r,o=arguments[3]||void 0):r&&(n=r.label||void 0,o=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var a=Math.ceil(t.n.bitLength()/8);if(e.length!==a){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=e.length,v.expectedLength=a,v}if(o===void 0?o=Fd.md.sha1.create():o.start(),s||(s=o),a<2*o.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),o.update(n,"raw");for(var c=o.digest().getBytes(),u=e.charAt(0),l=e.substring(1,o.digestLength+1),d=e.substring(1+o.digestLength),p=a3(d,o.digestLength,s),f=Fd.util.xorBytes(l,p,l.length),m=a3(f,a-o.digestLength-1,s),h=Fd.util.xorBytes(d,m,d.length),g=h.substring(0,o.digestLength),v=u!=="\0",y=0;y<o.digestLength;++y)v|=c.charAt(y)!==g.charAt(y);for(var b=1,_=o.digestLength,S=o.digestLength;S<h.length;S++){var I=h.charCodeAt(S),T=I&1^1,A=b?65534:0;v|=I&A,b=b&T,_+=b}if(v||h.charCodeAt(_)!==1)throw new Error("Invalid RSAES-OAEP padding.");return h.substring(_+1)};function a3(t,e,r){r||(r=Fd.md.sha1.create());for(var n="",o=Math.ceil(e/r.digestLength),s=0;s<o;++s){var a=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(t+a),n+=r.digest().getBytes()}return n.substring(0,e)}});var EG=M((Dir,CG)=>{var Ig=rr();Lr();ak();gu();(function(){if(Ig.prime){CG.exports=Ig.prime;return}var t=CG.exports=Ig.prime=Ig.prime||{},e=Ig.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var o=function(p,f){return p|f};t.generateProbablePrime=function(p,f,m){typeof f=="function"&&(m=f,f={}),f=f||{};var h=f.algorithm||"PRIMEINC";typeof h=="string"&&(h={name:h}),h.options=h.options||{};var g=f.prng||Ig.random,v={nextBytes:function(y){for(var b=g.getBytesSync(y.length),_=0;_<y.length;++_)y[_]=b.charCodeAt(_)}};if(h.name==="PRIMEINC")return s(p,v,h.options,m);throw new Error("Invalid prime generation algorithm: "+h.name)};function s(p,f,m,h){return"workers"in m?u(p,f,m,h):a(p,f,m,h)}function a(p,f,m,h){var g=l(p,f),v=0,y=d(g.bitLength());"millerRabinTests"in m&&(y=m.millerRabinTests);var b=10;"maxBlockTime"in m&&(b=m.maxBlockTime),c(g,p,f,v,y,b,h)}function c(p,f,m,h,g,v,y){var b=+new Date;do{if(p.bitLength()>f&&(p=l(f,m)),p.isProbablePrime(g))return y(null,p);p.dAddOffset(r[h++%8],0)}while(v<0||+new Date-b<v);Ig.util.setImmediate(function(){c(p,f,m,h,g,v,y)})}function u(p,f,m,h){if(typeof Worker>"u")return a(p,f,m,h);var g=l(p,f),v=m.workers,y=m.workLoad||100,b=y*30/8,_=m.workerScript||"forge/prime.worker.js";if(v===-1)return Ig.util.estimateCores(function(I,T){I&&(T=2),v=T-1,S()});S();function S(){v=Math.max(1,v);for(var I=[],T=0;T<v;++T)I[T]=new Worker(_);for(var A=v,T=0;T<v;++T)I[T].addEventListener("message",j);var B=!1;function j(F){if(!B){--A;var ne=F.data;if(ne.found){for(var Y=0;Y<I.length;++Y)I[Y].terminate();return B=!0,h(null,new e(ne.prime,16))}g.bitLength()>p&&(g=l(p,f));var N=g.toString(16);F.target.postMessage({hex:N,workLoad:y}),g.dAddOffset(b,0)}}}}function l(p,f){var m=new e(p,f),h=p-1;return m.testBit(h)||m.bitwiseTo(e.ONE.shiftLeft(h),o,m),m.dAddOffset(31-m.mod(n).byteValue(),0),m}function d(p){return p<=100?27:p<=150?18:p<=200?15:p<=250?12:p<=300?9:p<=350?8:p<=400?7:p<=500?6:p<=600?5:p<=800?4:p<=1250?3:2}})()});var ck=M((Nir,Rpe)=>{var _t=rr();Tl();ak();xg();IG();EG();gu();Lr();typeof Rr>"u"&&(Rr=_t.jsbn.BigInteger);var Rr,TG=_t.util.isNodejs?require("crypto"):null,oe=_t.asn1,yu=_t.util;_t.pki=_t.pki||{};Rpe.exports=_t.pki.rsa=_t.rsa=_t.rsa||{};var Wt=_t.pki,mqe=[6,4,2,4,2,4,6,2],hqe={name:"PrivateKeyInfo",tagClass:oe.Class.UNIVERSAL,type:oe.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:oe.Class.UNIVERSAL,type:oe.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:oe.Class.UNIVERSAL,type:oe.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:oe.Class.UNIVERSAL,type:oe.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:oe.Class.UNIVERSAL,type:oe.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},gqe={name:"RSAPrivateKey",tagClass:oe.Class.UNIVERSAL,type:oe.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:oe.Class.UNIVERSAL,type:oe.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:oe.Class.UNIVERSAL,type:oe.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:oe.Class.UNIVERSAL,type:oe.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:oe.Class.UNIVERSAL,type:oe.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:oe.Class.UNIVERSAL,type:oe.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:oe.Class.UNIVERSAL,type:oe.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:oe.Class.UNIVERSAL,type:oe.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:oe.Class.UNIVERSAL,type:oe.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:oe.Class.UNIVERSAL,type:oe.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},vqe={name:"RSAPublicKey",tagClass:oe.Class.UNIVERSAL,type:oe.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:oe.Class.UNIVERSAL,type:oe.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:oe.Class.UNIVERSAL,type:oe.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},yqe=_t.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:oe.Class.UNIVERSAL,type:oe.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:oe.Class.UNIVERSAL,type:oe.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:oe.Class.UNIVERSAL,type:oe.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:oe.Class.UNIVERSAL,type:oe.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:oe.Class.UNIVERSAL,type:oe.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},bqe={name:"DigestInfo",tagClass:oe.Class.UNIVERSAL,type:oe.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:oe.Class.UNIVERSAL,type:oe.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:oe.Class.UNIVERSAL,type:oe.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:oe.Class.UNIVERSAL,type:oe.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:oe.Class.UNIVERSAL,type:oe.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},_qe=function(t){var e;if(t.algorithm in Wt.oids)e=Wt.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=oe.oidToDer(e).getBytes(),o=oe.create(oe.Class.UNIVERSAL,oe.Type.SEQUENCE,!0,[]),s=oe.create(oe.Class.UNIVERSAL,oe.Type.SEQUENCE,!0,[]);s.value.push(oe.create(oe.Class.UNIVERSAL,oe.Type.OID,!1,n)),s.value.push(oe.create(oe.Class.UNIVERSAL,oe.Type.NULL,!1,""));var a=oe.create(oe.Class.UNIVERSAL,oe.Type.OCTETSTRING,!1,t.digest().getBytes());return o.value.push(s),o.value.push(a),oe.toDer(o).getBytes()},Tpe=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(Rr.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(Rr.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new Rr(_t.util.bytesToHex(_t.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(Rr.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var o=t.mod(e.p).modPow(e.dP,e.p),s=t.mod(e.q).modPow(e.dQ,e.q);o.compareTo(s)<0;)o=o.add(e.p);var a=o.subtract(s).multiply(e.qInv).mod(e.p).multiply(e.q).add(s);return a=a.multiply(n.modInverse(e.n)).mod(e.n),a};Wt.rsa.encrypt=function(t,e,r){var n=r,o,s=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,o=wpe(t,e,r)):(o=_t.util.createBuffer(),o.putBytes(t));for(var a=new Rr(o.toHex(),16),c=Tpe(a,e,n),u=c.toString(16),l=_t.util.createBuffer(),d=s-Math.ceil(u.length/2);d>0;)l.putByte(0),--d;return l.putBytes(_t.util.hexToBytes(u)),l.getBytes()};Wt.rsa.decrypt=function(t,e,r,n){var o=Math.ceil(e.n.bitLength()/8);if(t.length!==o){var s=new Error("Encrypted message length is invalid.");throw s.length=t.length,s.expected=o,s}var a=new Rr(_t.util.createBuffer(t).toHex(),16);if(a.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var c=Tpe(a,e,r),u=c.toString(16),l=_t.util.createBuffer(),d=o-Math.ceil(u.length/2);d>0;)l.putByte(0),--d;return l.putBytes(_t.util.hexToBytes(u)),n!==!1?c3(l.getBytes(),e,r):l.getBytes()};Wt.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||_t.random,o={nextBytes:function(c){for(var u=n.getBytesSync(c.length),l=0;l<c.length;++l)c[l]=u.charCodeAt(l)}},s=r.algorithm||"PRIMEINC",a;if(s==="PRIMEINC")a={algorithm:s,state:0,bits:t,rng:o,eInt:e||65537,e:new Rr(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},a.e.fromInt(a.eInt);else throw new Error("Invalid key generation algorithm: "+s);return a};Wt.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new Rr(null);r.fromInt(30);for(var n=0,o=function(p,f){return p|f},s=+new Date,a,c=0;t.keys===null&&(e<=0||c<e);){if(t.state===0){var u=t.p===null?t.pBits:t.qBits,l=u-1;t.pqState===0?(t.num=new Rr(u,t.rng),t.num.testBit(l)||t.num.bitwiseTo(Rr.ONE.shiftLeft(l),o,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>u?t.pqState=0:t.num.isProbablePrime(Sqe(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(mqe[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(Rr.ONE).gcd(t.e).compareTo(Rr.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(Rr.ONE),t.q1=t.q.subtract(Rr.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(Rr.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var d=t.e.modInverse(t.phi);t.keys={privateKey:Wt.rsa.setPrivateKey(t.n,t.e,d,t.p,t.q,d.mod(t.p1),d.mod(t.q1),t.q.modInverse(t.p)),publicKey:Wt.rsa.setPublicKey(t.n,t.e)}}a=+new Date,c+=a-s,s=a}return t.keys!==null};Wt.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!_t.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(Spe("generateKeyPair"))return TG.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(c,u,l){if(c)return n(c);n(null,{privateKey:Wt.privateKeyFromPem(l),publicKey:Wt.publicKeyFromPem(u)})});if(Ipe("generateKey")&&Ipe("exportKey"))return yu.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Epe(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(c){return yu.globalScope.crypto.subtle.exportKey("pkcs8",c.privateKey)}).then(void 0,function(c){n(c)}).then(function(c){if(c){var u=Wt.privateKeyFromAsn1(oe.fromDer(_t.util.createBuffer(c)));n(null,{privateKey:u,publicKey:Wt.setRsaPublicKey(u.n,u.e)})}});if(Cpe("generateKey")&&Cpe("exportKey")){var o=yu.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:Epe(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);o.oncomplete=function(c){var u=c.target.result,l=yu.globalScope.msCrypto.subtle.exportKey("pkcs8",u.privateKey);l.oncomplete=function(d){var p=d.target.result,f=Wt.privateKeyFromAsn1(oe.fromDer(_t.util.createBuffer(p)));n(null,{privateKey:f,publicKey:Wt.setRsaPublicKey(f.n,f.e)})},l.onerror=function(d){n(d)}},o.onerror=function(c){n(c)};return}}else if(Spe("generateKeyPairSync")){var s=TG.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:Wt.privateKeyFromPem(s.privateKey),publicKey:Wt.publicKeyFromPem(s.publicKey)}}}var a=Wt.rsa.createKeyPairGenerationState(t,e,r);if(!n)return Wt.rsa.stepKeyPairGenerationState(a,0),a.keys;xqe(a,r,n)};Wt.setRsaPublicKey=Wt.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,o,s){if(typeof o=="string"?o=o.toUpperCase():o===void 0&&(o="RSAES-PKCS1-V1_5"),o==="RSAES-PKCS1-V1_5")o={encode:function(c,u,l){return wpe(c,u,2).getBytes()}};else if(o==="RSA-OAEP"||o==="RSAES-OAEP")o={encode:function(c,u){return _t.pkcs1.encode_rsa_oaep(u,c,s)}};else if(["RAW","NONE","NULL",null].indexOf(o)!==-1)o={encode:function(c){return c}};else if(typeof o=="string")throw new Error('Unsupported encryption scheme: "'+o+'".');var a=o.encode(n,r,!0);return Wt.rsa.encrypt(a,r,!0)},r.verify=function(n,o,s,a){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),a===void 0&&(a={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in a||(a._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(u,l){l=c3(l,r,!0);var d=oe.fromDer(l,{parseAllBytes:a._parseAllDigestBytes}),p={},f=[];if(!oe.validate(d,bqe,p,f)){var m=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw m.errors=f,m}var h=oe.derToOid(p.algorithmIdentifier);if(!(h===_t.oids.md2||h===_t.oids.md5||h===_t.oids.sha1||h===_t.oids.sha224||h===_t.oids.sha256||h===_t.oids.sha384||h===_t.oids.sha512||h===_t.oids["sha512-224"]||h===_t.oids["sha512-256"])){var m=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw m.oid=h,m}if((h===_t.oids.md2||h===_t.oids.md5)&&!("parameters"in p))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return u===p.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(u,l){return l=c3(l,r,!0),u===l}});var c=Wt.rsa.decrypt(o,r,!0,!1);return s.verify(n,c,r.n.bitLength())},r};Wt.setRsaPrivateKey=Wt.rsa.setPrivateKey=function(t,e,r,n,o,s,a,c){var u={n:t,e,d:r,p:n,q:o,dP:s,dQ:a,qInv:c};return u.decrypt=function(l,d,p){typeof d=="string"?d=d.toUpperCase():d===void 0&&(d="RSAES-PKCS1-V1_5");var f=Wt.rsa.decrypt(l,u,!1,!1);if(d==="RSAES-PKCS1-V1_5")d={decode:c3};else if(d==="RSA-OAEP"||d==="RSAES-OAEP")d={decode:function(m,h){return _t.pkcs1.decode_rsa_oaep(h,m,p)}};else if(["RAW","NONE","NULL",null].indexOf(d)!==-1)d={decode:function(m){return m}};else throw new Error('Unsupported encryption scheme: "'+d+'".');return d.decode(f,u,!1)},u.sign=function(l,d){var p=!1;typeof d=="string"&&(d=d.toUpperCase()),d===void 0||d==="RSASSA-PKCS1-V1_5"?(d={encode:_qe},p=1):(d==="NONE"||d==="NULL"||d===null)&&(d={encode:function(){return l}},p=1);var f=d.encode(l,u.n.bitLength());return Wt.rsa.encrypt(f,u,p)},u};Wt.wrapRsaPrivateKey=function(t){return oe.create(oe.Class.UNIVERSAL,oe.Type.SEQUENCE,!0,[oe.create(oe.Class.UNIVERSAL,oe.Type.INTEGER,!1,oe.integerToDer(0).getBytes()),oe.create(oe.Class.UNIVERSAL,oe.Type.SEQUENCE,!0,[oe.create(oe.Class.UNIVERSAL,oe.Type.OID,!1,oe.oidToDer(Wt.oids.rsaEncryption).getBytes()),oe.create(oe.Class.UNIVERSAL,oe.Type.NULL,!1,"")]),oe.create(oe.Class.UNIVERSAL,oe.Type.OCTETSTRING,!1,oe.toDer(t).getBytes())])};Wt.privateKeyFromAsn1=function(t){var e={},r=[];if(oe.validate(t,hqe,e,r)&&(t=oe.fromDer(_t.util.createBuffer(e.privateKey))),e={},r=[],!oe.validate(t,gqe,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var o,s,a,c,u,l,d,p;return o=_t.util.createBuffer(e.privateKeyModulus).toHex(),s=_t.util.createBuffer(e.privateKeyPublicExponent).toHex(),a=_t.util.createBuffer(e.privateKeyPrivateExponent).toHex(),c=_t.util.createBuffer(e.privateKeyPrime1).toHex(),u=_t.util.createBuffer(e.privateKeyPrime2).toHex(),l=_t.util.createBuffer(e.privateKeyExponent1).toHex(),d=_t.util.createBuffer(e.privateKeyExponent2).toHex(),p=_t.util.createBuffer(e.privateKeyCoefficient).toHex(),Wt.setRsaPrivateKey(new Rr(o,16),new Rr(s,16),new Rr(a,16),new Rr(c,16),new Rr(u,16),new Rr(l,16),new Rr(d,16),new Rr(p,16))};Wt.privateKeyToAsn1=Wt.privateKeyToRSAPrivateKey=function(t){return oe.create(oe.Class.UNIVERSAL,oe.Type.SEQUENCE,!0,[oe.create(oe.Class.UNIVERSAL,oe.Type.INTEGER,!1,oe.integerToDer(0).getBytes()),oe.create(oe.Class.UNIVERSAL,oe.Type.INTEGER,!1,Ud(t.n)),oe.create(oe.Class.UNIVERSAL,oe.Type.INTEGER,!1,Ud(t.e)),oe.create(oe.Class.UNIVERSAL,oe.Type.INTEGER,!1,Ud(t.d)),oe.create(oe.Class.UNIVERSAL,oe.Type.INTEGER,!1,Ud(t.p)),oe.create(oe.Class.UNIVERSAL,oe.Type.INTEGER,!1,Ud(t.q)),oe.create(oe.Class.UNIVERSAL,oe.Type.INTEGER,!1,Ud(t.dP)),oe.create(oe.Class.UNIVERSAL,oe.Type.INTEGER,!1,Ud(t.dQ)),oe.create(oe.Class.UNIVERSAL,oe.Type.INTEGER,!1,Ud(t.qInv))])};Wt.publicKeyFromAsn1=function(t){var e={},r=[];if(oe.validate(t,yqe,e,r)){var n=oe.derToOid(e.publicKeyOid);if(n!==Wt.oids.rsaEncryption){var o=new Error("Cannot read public key. Unknown OID.");throw o.oid=n,o}t=e.rsaPublicKey}if(r=[],!oe.validate(t,vqe,e,r)){var o=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw o.errors=r,o}var s=_t.util.createBuffer(e.publicKeyModulus).toHex(),a=_t.util.createBuffer(e.publicKeyExponent).toHex();return Wt.setRsaPublicKey(new Rr(s,16),new Rr(a,16))};Wt.publicKeyToAsn1=Wt.publicKeyToSubjectPublicKeyInfo=function(t){return oe.create(oe.Class.UNIVERSAL,oe.Type.SEQUENCE,!0,[oe.create(oe.Class.UNIVERSAL,oe.Type.SEQUENCE,!0,[oe.create(oe.Class.UNIVERSAL,oe.Type.OID,!1,oe.oidToDer(Wt.oids.rsaEncryption).getBytes()),oe.create(oe.Class.UNIVERSAL,oe.Type.NULL,!1,"")]),oe.create(oe.Class.UNIVERSAL,oe.Type.BITSTRING,!1,[Wt.publicKeyToRSAPublicKey(t)])])};Wt.publicKeyToRSAPublicKey=function(t){return oe.create(oe.Class.UNIVERSAL,oe.Type.SEQUENCE,!0,[oe.create(oe.Class.UNIVERSAL,oe.Type.INTEGER,!1,Ud(t.n)),oe.create(oe.Class.UNIVERSAL,oe.Type.INTEGER,!1,Ud(t.e))])};function wpe(t,e,r){var n=_t.util.createBuffer(),o=Math.ceil(e.n.bitLength()/8);if(t.length>o-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=t.length,s.max=o-11,s}n.putByte(0),n.putByte(r);var a=o-3-t.length,c;if(r===0||r===1){c=r===0?0:255;for(var u=0;u<a;++u)n.putByte(c)}else for(;a>0;){for(var l=0,d=_t.random.getBytes(a),u=0;u<a;++u)c=d.charCodeAt(u),c===0?++l:n.putByte(c);a=l}return n.putByte(0),n.putBytes(t),n}function c3(t,e,r,n){var o=Math.ceil(e.n.bitLength()/8),s=_t.util.createBuffer(t),a=s.getByte(),c=s.getByte();if(a!==0||r&&c!==0&&c!==1||!r&&c!=2||r&&c===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var u=0;if(c===0){u=o-3-n;for(var l=0;l<u;++l)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(c===1)for(u=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++u}else if(c===2)for(u=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++u}var d=s.getByte();if(d!==0||u!==o-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function xqe(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),o();function o(){s(t.pBits,function(c,u){if(c)return r(c);if(t.p=u,t.q!==null)return a(c,t.q);s(t.qBits,a)})}function s(c,u){_t.prime.generateProbablePrime(c,n,u)}function a(c,u){if(c)return r(c);if(t.q=u,t.p.compareTo(t.q)<0){var l=t.p;t.p=t.q,t.q=l}if(t.p.subtract(Rr.ONE).gcd(t.e).compareTo(Rr.ONE)!==0){t.p=null,o();return}if(t.q.subtract(Rr.ONE).gcd(t.e).compareTo(Rr.ONE)!==0){t.q=null,s(t.qBits,a);return}if(t.p1=t.p.subtract(Rr.ONE),t.q1=t.q.subtract(Rr.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(Rr.ONE)!==0){t.p=t.q=null,o();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,s(t.qBits,a);return}var d=t.e.modInverse(t.phi);t.keys={privateKey:Wt.rsa.setPrivateKey(t.n,t.e,d,t.p,t.q,d.mod(t.p1),d.mod(t.q1),t.q.modInverse(t.p)),publicKey:Wt.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function Ud(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=_t.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Sqe(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function Spe(t){return _t.util.isNodejs&&typeof TG[t]=="function"}function Ipe(t){return typeof yu.globalScope<"u"&&typeof yu.globalScope.crypto=="object"&&typeof yu.globalScope.crypto.subtle=="object"&&typeof yu.globalScope.crypto.subtle[t]=="function"}function Cpe(t){return typeof yu.globalScope<"u"&&typeof yu.globalScope.msCrypto=="object"&&typeof yu.globalScope.msCrypto.subtle=="object"&&typeof yu.globalScope.msCrypto.subtle[t]=="function"}function Epe(t){for(var e=_t.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var wG=M((Lir,Npe)=>{var rt=rr();_g();Tl();ok();Ad();xg();n3();by();gu();yG();ck();Lr();typeof kpe>"u"&&(kpe=rt.jsbn.BigInteger);var kpe,ge=rt.asn1,er=rt.pki=rt.pki||{};Npe.exports=er.pbe=rt.pbe=rt.pbe||{};var Sy=er.oids,Iqe={name:"EncryptedPrivateKeyInfo",tagClass:ge.Class.UNIVERSAL,type:ge.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:ge.Class.UNIVERSAL,type:ge.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:ge.Class.UNIVERSAL,type:ge.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:ge.Class.UNIVERSAL,type:ge.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:ge.Class.UNIVERSAL,type:ge.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Cqe={name:"PBES2Algorithms",tagClass:ge.Class.UNIVERSAL,type:ge.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:ge.Class.UNIVERSAL,type:ge.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:ge.Class.UNIVERSAL,type:ge.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:ge.Class.UNIVERSAL,type:ge.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:ge.Class.UNIVERSAL,type:ge.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:ge.Class.UNIVERSAL,type:ge.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:ge.Class.UNIVERSAL,type:ge.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:ge.Class.UNIVERSAL,type:ge.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:ge.Class.UNIVERSAL,type:ge.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:ge.Class.UNIVERSAL,type:ge.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:ge.Class.UNIVERSAL,type:ge.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:ge.Class.UNIVERSAL,type:ge.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Eqe={name:"pkcs-12PbeParams",tagClass:ge.Class.UNIVERSAL,type:ge.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:ge.Class.UNIVERSAL,type:ge.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:ge.Class.UNIVERSAL,type:ge.Type.INTEGER,constructed:!1,capture:"iterations"}]};er.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=rt.random.getBytesSync(r.saltSize),o=r.count,s=ge.integerToDer(o),a,c,u;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var l,d,p;switch(r.algorithm){case"aes128":a=16,l=16,d=Sy["aes128-CBC"],p=rt.aes.createEncryptionCipher;break;case"aes192":a=24,l=16,d=Sy["aes192-CBC"],p=rt.aes.createEncryptionCipher;break;case"aes256":a=32,l=16,d=Sy["aes256-CBC"],p=rt.aes.createEncryptionCipher;break;case"des":a=8,l=8,d=Sy.desCBC,p=rt.des.createEncryptionCipher;break;default:var f=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw f.algorithm=r.algorithm,f}var m="hmacWith"+r.prfAlgorithm.toUpperCase(),h=Dpe(m),g=rt.pkcs5.pbkdf2(e,n,o,a,h),v=rt.random.getBytesSync(l),y=p(g);y.start(v),y.update(ge.toDer(t)),y.finish(),u=y.output.getBytes();var b=Tqe(n,s,a,m);c=ge.create(ge.Class.UNIVERSAL,ge.Type.SEQUENCE,!0,[ge.create(ge.Class.UNIVERSAL,ge.Type.OID,!1,ge.oidToDer(Sy.pkcs5PBES2).getBytes()),ge.create(ge.Class.UNIVERSAL,ge.Type.SEQUENCE,!0,[ge.create(ge.Class.UNIVERSAL,ge.Type.SEQUENCE,!0,[ge.create(ge.Class.UNIVERSAL,ge.Type.OID,!1,ge.oidToDer(Sy.pkcs5PBKDF2).getBytes()),b]),ge.create(ge.Class.UNIVERSAL,ge.Type.SEQUENCE,!0,[ge.create(ge.Class.UNIVERSAL,ge.Type.OID,!1,ge.oidToDer(d).getBytes()),ge.create(ge.Class.UNIVERSAL,ge.Type.OCTETSTRING,!1,v)])])])}else if(r.algorithm==="3des"){a=24;var _=new rt.util.ByteBuffer(n),g=er.pbe.generatePkcs12Key(e,_,1,o,a),v=er.pbe.generatePkcs12Key(e,_,2,o,a),y=rt.des.createEncryptionCipher(g);y.start(v),y.update(ge.toDer(t)),y.finish(),u=y.output.getBytes(),c=ge.create(ge.Class.UNIVERSAL,ge.Type.SEQUENCE,!0,[ge.create(ge.Class.UNIVERSAL,ge.Type.OID,!1,ge.oidToDer(Sy["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),ge.create(ge.Class.UNIVERSAL,ge.Type.SEQUENCE,!0,[ge.create(ge.Class.UNIVERSAL,ge.Type.OCTETSTRING,!1,n),ge.create(ge.Class.UNIVERSAL,ge.Type.INTEGER,!1,s.getBytes())])])}else{var f=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw f.algorithm=r.algorithm,f}var S=ge.create(ge.Class.UNIVERSAL,ge.Type.SEQUENCE,!0,[c,ge.create(ge.Class.UNIVERSAL,ge.Type.OCTETSTRING,!1,u)]);return S};er.decryptPrivateKeyInfo=function(t,e){var r=null,n={},o=[];if(!ge.validate(t,Iqe,n,o)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=o,s}var a=ge.derToOid(n.encryptionOid),c=er.pbe.getCipher(a,n.encryptionParams,e),u=rt.util.createBuffer(n.encryptedData);return c.update(u),c.finish()&&(r=ge.fromDer(c.output)),r};er.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:ge.toDer(t).getBytes()};return rt.pem.encode(r,{maxline:e})};er.encryptedPrivateKeyFromPem=function(t){var e=rt.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return ge.fromDer(e.body)};er.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=er.wrapRsaPrivateKey(er.privateKeyToAsn1(t));return n=er.encryptPrivateKeyInfo(n,e,r),er.encryptedPrivateKeyToPem(n)}var o,s,a,c;switch(r.algorithm){case"aes128":o="AES-128-CBC",a=16,s=rt.random.getBytesSync(16),c=rt.aes.createEncryptionCipher;break;case"aes192":o="AES-192-CBC",a=24,s=rt.random.getBytesSync(16),c=rt.aes.createEncryptionCipher;break;case"aes256":o="AES-256-CBC",a=32,s=rt.random.getBytesSync(16),c=rt.aes.createEncryptionCipher;break;case"3des":o="DES-EDE3-CBC",a=24,s=rt.random.getBytesSync(8),c=rt.des.createEncryptionCipher;break;case"des":o="DES-CBC",a=8,s=rt.random.getBytesSync(8),c=rt.des.createEncryptionCipher;break;default:var u=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw u.algorithm=r.algorithm,u}var l=rt.pbe.opensslDeriveBytes(e,s.substr(0,8),a),d=c(l);d.start(s),d.update(ge.toDer(er.privateKeyToAsn1(t))),d.finish();var p={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:o,parameters:rt.util.bytesToHex(s).toUpperCase()},body:d.output.getBytes()};return rt.pem.encode(p)};er.decryptRsaPrivateKey=function(t,e){var r=null,n=rt.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var o=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw o.headerType=o,o}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,a;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,a=rt.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,a=rt.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,a=rt.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,a=rt.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,a=rt.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,a=function(p){return rt.rc2.createDecryptionCipher(p,40)};break;case"RC2-64-CBC":s=8,a=function(p){return rt.rc2.createDecryptionCipher(p,64)};break;case"RC2-128-CBC":s=16,a=function(p){return rt.rc2.createDecryptionCipher(p,128)};break;default:var o=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw o.algorithm=n.dekInfo.algorithm,o}var c=rt.util.hexToBytes(n.dekInfo.parameters),u=rt.pbe.opensslDeriveBytes(e,c.substr(0,8),s),l=a(u);if(l.start(c),l.update(rt.util.createBuffer(n.body)),l.finish())r=l.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=er.decryptPrivateKeyInfo(ge.fromDer(r),e):r=ge.fromDer(r),r!==null&&(r=er.privateKeyFromAsn1(r)),r};er.pbe.generatePkcs12Key=function(t,e,r,n,o,s){var a,c;if(typeof s>"u"||s===null){if(!("sha1"in rt.md))throw new Error('"sha1" hash algorithm unavailable.');s=rt.md.sha1.create()}var u=s.digestLength,l=s.blockLength,d=new rt.util.ByteBuffer,p=new rt.util.ByteBuffer;if(t!=null){for(c=0;c<t.length;c++)p.putInt16(t.charCodeAt(c));p.putInt16(0)}var f=p.length(),m=e.length(),h=new rt.util.ByteBuffer;h.fillWithByte(r,l);var g=l*Math.ceil(m/l),v=new rt.util.ByteBuffer;for(c=0;c<g;c++)v.putByte(e.at(c%m));var y=l*Math.ceil(f/l),b=new rt.util.ByteBuffer;for(c=0;c<y;c++)b.putByte(p.at(c%f));var _=v;_.putBuffer(b);for(var S=Math.ceil(o/u),I=1;I<=S;I++){var T=new rt.util.ByteBuffer;T.putBytes(h.bytes()),T.putBytes(_.bytes());for(var A=0;A<n;A++)s.start(),s.update(T.getBytes()),T=s.digest();var B=new rt.util.ByteBuffer;for(c=0;c<l;c++)B.putByte(T.at(c%u));var j=Math.ceil(m/l)+Math.ceil(f/l),F=new rt.util.ByteBuffer;for(a=0;a<j;a++){var ne=new rt.util.ByteBuffer(_.getBytes(l)),Y=511;for(c=B.length()-1;c>=0;c--)Y=Y>>8,Y+=B.at(c)+ne.at(c),ne.setAt(c,Y&255);F.putBuffer(ne)}_=F,d.putBuffer(T)}return d.truncate(d.length()-o),d};er.pbe.getCipher=function(t,e,r){switch(t){case er.oids.pkcs5PBES2:return er.pbe.getCipherForPBES2(t,e,r);case er.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case er.oids["pbewithSHAAnd40BitRC2-CBC"]:return er.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};er.pbe.getCipherForPBES2=function(t,e,r){var n={},o=[];if(!ge.validate(e,Cqe,n,o)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=o,s}if(t=ge.derToOid(n.kdfOid),t!==er.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=t,s.supportedOids=["pkcs5PBKDF2"],s}if(t=ge.derToOid(n.encOid),t!==er.oids["aes128-CBC"]&&t!==er.oids["aes192-CBC"]&&t!==er.oids["aes256-CBC"]&&t!==er.oids["des-EDE3-CBC"]&&t!==er.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=t,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var a=n.kdfSalt,c=rt.util.createBuffer(n.kdfIterationCount);c=c.getInt(c.length()<<3);var u,l;switch(er.oids[t]){case"aes128-CBC":u=16,l=rt.aes.createDecryptionCipher;break;case"aes192-CBC":u=24,l=rt.aes.createDecryptionCipher;break;case"aes256-CBC":u=32,l=rt.aes.createDecryptionCipher;break;case"des-EDE3-CBC":u=24,l=rt.des.createDecryptionCipher;break;case"desCBC":u=8,l=rt.des.createDecryptionCipher;break}var d=Ape(n.prfOid),p=rt.pkcs5.pbkdf2(r,a,c,u,d),f=n.encIv,m=l(p);return m.start(f),m};er.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},o=[];if(!ge.validate(e,Eqe,n,o)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=o,s}var a=rt.util.createBuffer(n.salt),c=rt.util.createBuffer(n.iterations);c=c.getInt(c.length()<<3);var u,l,d;switch(t){case er.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:u=24,l=8,d=rt.des.startDecrypting;break;case er.oids["pbewithSHAAnd40BitRC2-CBC"]:u=5,l=8,d=function(g,v){var y=rt.rc2.createDecryptionCipher(g,40);return y.start(v,null),y};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=t,s}var p=Ape(n.prfOid),f=er.pbe.generatePkcs12Key(r,a,1,c,u,p);p.start();var m=er.pbe.generatePkcs12Key(r,a,2,c,l,p);return d(f,m)};er.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in rt.md))throw new Error('"md5" hash algorithm unavailable.');n=rt.md.md5.create()}e===null&&(e="");for(var o=[Ppe(n,t+e)],s=16,a=1;s<r;++a,s+=16)o.push(Ppe(n,o[a-1]+t+e));return o.join("").substr(0,r)};function Ppe(t,e){return t.start().update(e).digest().getBytes()}function Ape(t){var e;if(!t)e="hmacWithSHA1";else if(e=er.oids[ge.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return Dpe(e)}function Dpe(t){var e=rt.md;switch(t){case"hmacWithSHA224":e=rt.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function Tqe(t,e,r,n){var o=ge.create(ge.Class.UNIVERSAL,ge.Type.SEQUENCE,!0,[ge.create(ge.Class.UNIVERSAL,ge.Type.OCTETSTRING,!1,t),ge.create(ge.Class.UNIVERSAL,ge.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&o.value.push(ge.create(ge.Class.UNIVERSAL,ge.Type.INTEGER,!1,rt.util.hexToBytes(r.toString(16))),ge.create(ge.Class.UNIVERSAL,ge.Type.SEQUENCE,!0,[ge.create(ge.Class.UNIVERSAL,ge.Type.OID,!1,ge.oidToDer(er.oids[n]).getBytes()),ge.create(ge.Class.UNIVERSAL,ge.Type.NULL,!1,"")])),o}});var RG=M((Oir,Mpe)=>{var tI=rr();Tl();Lr();var Xe=tI.asn1,rI=Mpe.exports=tI.pkcs7asn1=tI.pkcs7asn1||{};tI.pkcs7=tI.pkcs7||{};tI.pkcs7.asn1=rI;var Lpe={name:"ContentInfo",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:Xe.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};rI.contentInfoValidator=Lpe;var Ope={name:"EncryptedContentInfo",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:Xe.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:Xe.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};rI.envelopedDataValidator={name:"EnvelopedData",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(Ope)};rI.encryptedDataValidator={name:"EncryptedData",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.INTEGER,constructed:!1,capture:"version"}].concat(Ope)};var wqe={name:"SignerInfo",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:Xe.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:Xe.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:Xe.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};rI.signedDataValidator={name:"SignedData",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},Lpe,{name:"SignedData.Certificates",tagClass:Xe.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:Xe.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SET,capture:"signerInfos",optional:!0,value:[wqe]}]};rI.recipientInfoValidator={name:"RecipientInfo",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:Xe.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:Xe.Class.UNIVERSAL,type:Xe.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var kG=M((Mir,Fpe)=>{var Iy=rr();Lr();Iy.mgf=Iy.mgf||{};var Rqe=Fpe.exports=Iy.mgf.mgf1=Iy.mgf1=Iy.mgf1||{};Rqe.create=function(t){var e={generate:function(r,n){for(var o=new Iy.util.ByteBuffer,s=Math.ceil(n/t.digestLength),a=0;a<s;a++){var c=new Iy.util.ByteBuffer;c.putInt32(a),t.start(),t.update(r+c.getBytes()),o.putBuffer(t.digest())}return o.truncate(o.length()-n),o.getBytes()}};return e}});var Bpe=M((Fir,Upe)=>{var u3=rr();kG();Upe.exports=u3.mgf=u3.mgf||{};u3.mgf.mgf1=u3.mgf1});var l3=M((Uir,qpe)=>{var Cy=rr();gu();Lr();var kqe=qpe.exports=Cy.pss=Cy.pss||{};kqe.create=function(t){arguments.length===3&&(t={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]});var e=t.md,r=t.mgf,n=e.digestLength,o=t.salt||null;typeof o=="string"&&(o=Cy.util.createBuffer(o));var s;if("saltLength"in t)s=t.saltLength;else if(o!==null)s=o.length();else throw new Error("Salt length not specified or specific salt not given.");if(o!==null&&o.length()!==s)throw new Error("Given salt length does not match length of given salt.");var a=t.prng||Cy.random,c={};return c.encode=function(u,l){var d,p=l-1,f=Math.ceil(p/8),m=u.digest().getBytes();if(f<n+s+2)throw new Error("Message is too long to encrypt.");var h;o===null?h=a.getBytesSync(s):h=o.bytes();var g=new Cy.util.ByteBuffer;g.fillWithByte(0,8),g.putBytes(m),g.putBytes(h),e.start(),e.update(g.getBytes());var v=e.digest().getBytes(),y=new Cy.util.ByteBuffer;y.fillWithByte(0,f-s-n-2),y.putByte(1),y.putBytes(h);var b=y.getBytes(),_=f-n-1,S=r.generate(v,_),I="";for(d=0;d<_;d++)I+=String.fromCharCode(b.charCodeAt(d)^S.charCodeAt(d));var T=65280>>8*f-p&255;return I=String.fromCharCode(I.charCodeAt(0)&~T)+I.substr(1),I+v+"\xBC"},c.verify=function(u,l,d){var p,f=d-1,m=Math.ceil(f/8);if(l=l.substr(-m),m<n+s+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(l.charCodeAt(m-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var h=m-n-1,g=l.substr(0,h),v=l.substr(h,n),y=65280>>8*m-f&255;if(g.charCodeAt(0)&y)throw new Error("Bits beyond keysize not zero as expected.");var b=r.generate(v,h),_="";for(p=0;p<h;p++)_+=String.fromCharCode(g.charCodeAt(p)^b.charCodeAt(p));_=String.fromCharCode(_.charCodeAt(0)&~y)+_.substr(1);var S=m-n-s-2;for(p=0;p<S;p++)if(_.charCodeAt(p)!==0)throw new Error("Leftmost octets not zero as expected");if(_.charCodeAt(S)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var I=_.substr(-s),T=new Cy.util.ByteBuffer;T.fillWithByte(0,8),T.putBytes(u),T.putBytes(I),e.start(),e.update(T.getBytes());var A=e.digest().getBytes();return v===A},c}});var f3=M((Bir,zpe)=>{var xt=rr();_g();Tl();ok();Ad();Bpe();xg();by();l3();ck();Lr();var k=xt.asn1,qe=zpe.exports=xt.pki=xt.pki||{},kr=qe.oids,bi={};bi.CN=kr.commonName;bi.commonName="CN";bi.C=kr.countryName;bi.countryName="C";bi.L=kr.localityName;bi.localityName="L";bi.ST=kr.stateOrProvinceName;bi.stateOrProvinceName="ST";bi.O=kr.organizationName;bi.organizationName="O";bi.OU=kr.organizationalUnitName;bi.organizationalUnitName="OU";bi.E=kr.emailAddress;bi.emailAddress="E";var jpe=xt.pki.rsa.publicKeyValidator,Pqe={name:"Certificate",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:k.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:k.Class.UNIVERSAL,type:k.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:k.Class.UNIVERSAL,type:k.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:k.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:k.Class.UNIVERSAL,type:k.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:k.Class.UNIVERSAL,type:k.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:k.Class.UNIVERSAL,type:k.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:k.Class.UNIVERSAL,type:k.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},jpe,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:k.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:k.Class.UNIVERSAL,type:k.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:k.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:k.Class.UNIVERSAL,type:k.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:k.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:k.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:k.Class.UNIVERSAL,type:k.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},Aqe={name:"rsapss",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:k.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:k.Class.UNIVERSAL,type:k.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:k.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:k.Class.UNIVERSAL,type:k.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:k.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:k.Class.UNIVERSAL,type:k.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:k.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:k.Class.UNIVERSAL,type:k.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},Dqe={name:"CertificationRequestInfo",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:k.Class.UNIVERSAL,type:k.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},jpe,{name:"CertificationRequestInfo.attributes",tagClass:k.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:k.Class.UNIVERSAL,type:k.Type.SET,constructed:!0}]}]}]},Nqe={name:"CertificationRequest",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[Dqe,{name:"CertificationRequest.signatureAlgorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:k.Class.UNIVERSAL,type:k.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:k.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:k.Class.UNIVERSAL,type:k.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};qe.RDNAttributesAsArray=function(t,e){for(var r=[],n,o,s,a=0;a<t.value.length;++a){n=t.value[a];for(var c=0;c<n.value.length;++c)s={},o=n.value[c],s.type=k.derToOid(o.value[0].value),s.value=o.value[1].value,s.valueTagClass=o.value[1].type,s.type in kr&&(s.name=kr[s.type],s.name in bi&&(s.shortName=bi[s.name])),e&&(e.update(s.type),e.update(s.value)),r.push(s)}return r};qe.CRIAttributesAsArray=function(t){for(var e=[],r=0;r<t.length;++r)for(var n=t[r],o=k.derToOid(n.value[0].value),s=n.value[1].value,a=0;a<s.length;++a){var c={};if(c.type=o,c.value=s[a].value,c.valueTagClass=s[a].type,c.type in kr&&(c.name=kr[c.type],c.name in bi&&(c.shortName=bi[c.name])),c.type===kr.extensionRequest){c.extensions=[];for(var u=0;u<c.value.length;++u)c.extensions.push(qe.certificateExtensionFromAsn1(c.value[u]))}e.push(c)}return e};function Cg(t,e){typeof e=="string"&&(e={shortName:e});for(var r=null,n,o=0;r===null&&o<t.attributes.length;++o)n=t.attributes[o],(e.type&&e.type===n.type||e.name&&e.name===n.name||e.shortName&&e.shortName===n.shortName)&&(r=n);return r}var d3=function(t,e,r){var n={};if(t!==kr["RSASSA-PSS"])return n;r&&(n={hash:{algorithmOid:kr.sha1},mgf:{algorithmOid:kr.mgf1,hash:{algorithmOid:kr.sha1}},saltLength:20});var o={},s=[];if(!k.validate(e,Aqe,o,s)){var a=new Error("Cannot read RSASSA-PSS parameter block.");throw a.errors=s,a}return o.hashOid!==void 0&&(n.hash=n.hash||{},n.hash.algorithmOid=k.derToOid(o.hashOid)),o.maskGenOid!==void 0&&(n.mgf=n.mgf||{},n.mgf.algorithmOid=k.derToOid(o.maskGenOid),n.mgf.hash=n.mgf.hash||{},n.mgf.hash.algorithmOid=k.derToOid(o.maskGenHashOid)),o.saltLength!==void 0&&(n.saltLength=o.saltLength.charCodeAt(0)),n},p3=function(t){switch(kr[t.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return xt.md.sha1.create();case"md5WithRSAEncryption":return xt.md.md5.create();case"sha256WithRSAEncryption":return xt.md.sha256.create();case"sha384WithRSAEncryption":return xt.md.sha384.create();case"sha512WithRSAEncryption":return xt.md.sha512.create();case"RSASSA-PSS":return xt.md.sha256.create();default:var e=new Error("Could not compute "+t.type+" digest. Unknown signature OID.");throw e.signatureOid=t.signatureOid,e}},Vpe=function(t){var e=t.certificate,r;switch(e.signatureOid){case kr.sha1WithRSAEncryption:case kr.sha1WithRSASignature:break;case kr["RSASSA-PSS"]:var n,o;if(n=kr[e.signatureParameters.mgf.hash.algorithmOid],n===void 0||xt.md[n]===void 0){var s=new Error("Unsupported MGF hash function.");throw s.oid=e.signatureParameters.mgf.hash.algorithmOid,s.name=n,s}if(o=kr[e.signatureParameters.mgf.algorithmOid],o===void 0||xt.mgf[o]===void 0){var s=new Error("Unsupported MGF function.");throw s.oid=e.signatureParameters.mgf.algorithmOid,s.name=o,s}if(o=xt.mgf[o].create(xt.md[n].create()),n=kr[e.signatureParameters.hash.algorithmOid],n===void 0||xt.md[n]===void 0){var s=new Error("Unsupported RSASSA-PSS hash function.");throw s.oid=e.signatureParameters.hash.algorithmOid,s.name=n,s}r=xt.pss.create(xt.md[n].create(),o,e.signatureParameters.saltLength);break}return e.publicKey.verify(t.md.digest().getBytes(),t.signature,r)};qe.certificateFromPem=function(t,e,r){var n=xt.pem.decode(t)[0];if(n.type!=="CERTIFICATE"&&n.type!=="X509 CERTIFICATE"&&n.type!=="TRUSTED CERTIFICATE"){var o=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw o.headerType=n.type,o}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var s=k.fromDer(n.body,r);return qe.certificateFromAsn1(s,e)};qe.certificateToPem=function(t,e){var r={type:"CERTIFICATE",body:k.toDer(qe.certificateToAsn1(t)).getBytes()};return xt.pem.encode(r,{maxline:e})};qe.publicKeyFromPem=function(t){var e=xt.pem.decode(t)[0];if(e.type!=="PUBLIC KEY"&&e.type!=="RSA PUBLIC KEY"){var r=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var n=k.fromDer(e.body);return qe.publicKeyFromAsn1(n)};qe.publicKeyToPem=function(t,e){var r={type:"PUBLIC KEY",body:k.toDer(qe.publicKeyToAsn1(t)).getBytes()};return xt.pem.encode(r,{maxline:e})};qe.publicKeyToRSAPublicKeyPem=function(t,e){var r={type:"RSA PUBLIC KEY",body:k.toDer(qe.publicKeyToRSAPublicKey(t)).getBytes()};return xt.pem.encode(r,{maxline:e})};qe.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||xt.md.sha1.create(),n=e.type||"RSAPublicKey",o;switch(n){case"RSAPublicKey":o=k.toDer(qe.publicKeyToRSAPublicKey(t)).getBytes();break;case"SubjectPublicKeyInfo":o=k.toDer(qe.publicKeyToAsn1(t)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+e.type+'".')}r.start(),r.update(o);var s=r.digest();if(e.encoding==="hex"){var a=s.toHex();return e.delimiter?a.match(/.{2}/g).join(e.delimiter):a}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};qe.certificationRequestFromPem=function(t,e,r){var n=xt.pem.decode(t)[0];if(n.type!=="CERTIFICATE REQUEST"){var o=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw o.headerType=n.type,o}if(n.procType&&n.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var s=k.fromDer(n.body,r);return qe.certificationRequestFromAsn1(s,e)};qe.certificationRequestToPem=function(t,e){var r={type:"CERTIFICATE REQUEST",body:k.toDer(qe.certificationRequestToAsn1(t)).getBytes()};return xt.pem.encode(r,{maxline:e})};qe.createCertificate=function(){var t={};return t.version=2,t.serialNumber="00",t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.validity={},t.validity.notBefore=new Date,t.validity.notAfter=new Date,t.issuer={},t.issuer.getField=function(e){return Cg(t.issuer,e)},t.issuer.addField=function(e){bu([e]),t.issuer.attributes.push(e)},t.issuer.attributes=[],t.issuer.hash=null,t.subject={},t.subject.getField=function(e){return Cg(t.subject,e)},t.subject.addField=function(e){bu([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.extensions=[],t.publicKey=null,t.md=null,t.setSubject=function(e,r){bu(e),t.subject.attributes=e,delete t.subject.uniqueId,r&&(t.subject.uniqueId=r),t.subject.hash=null},t.setIssuer=function(e,r){bu(e),t.issuer.attributes=e,delete t.issuer.uniqueId,r&&(t.issuer.uniqueId=r),t.issuer.hash=null},t.setExtensions=function(e){for(var r=0;r<e.length;++r)Gpe(e[r],{cert:t});t.extensions=e},t.getExtension=function(e){typeof e=="string"&&(e={name:e});for(var r=null,n,o=0;r===null&&o<t.extensions.length;++o)n=t.extensions[o],(e.id&&n.id===e.id||e.name&&n.name===e.name)&&(r=n);return r},t.sign=function(e,r){t.md=r||xt.md.sha1.create();var n=kr[t.md.algorithm+"WithRSAEncryption"];if(!n){var o=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw o.algorithm=t.md.algorithm,o}t.signatureOid=t.siginfo.algorithmOid=n,t.tbsCertificate=qe.getTBSCertificate(t);var s=k.toDer(t.tbsCertificate);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(e){var r=!1;if(!t.issued(e)){var n=e.issuer,o=t.subject,s=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw s.expectedIssuer=o.attributes,s.actualIssuer=n.attributes,s}var a=e.md;if(a===null){a=p3({signatureOid:e.signatureOid,type:"certificate"});var c=e.tbsCertificate||qe.getTBSCertificate(e),u=k.toDer(c);a.update(u.getBytes())}return a!==null&&(r=Vpe({certificate:t,md:a,signature:e.signature})),r},t.isIssuer=function(e){var r=!1,n=t.issuer,o=e.subject;if(n.hash&&o.hash)r=n.hash===o.hash;else if(n.attributes.length===o.attributes.length){r=!0;for(var s,a,c=0;r&&c<n.attributes.length;++c)s=n.attributes[c],a=o.attributes[c],(s.type!==a.type||s.value!==a.value)&&(r=!1)}return r},t.issued=function(e){return e.isIssuer(t)},t.generateSubjectKeyIdentifier=function(){return qe.getPublicKeyFingerprint(t.publicKey,{type:"RSAPublicKey"})},t.verifySubjectKeyIdentifier=function(){for(var e=kr.subjectKeyIdentifier,r=0;r<t.extensions.length;++r){var n=t.extensions[r];if(n.id===e){var o=t.generateSubjectKeyIdentifier().getBytes();return xt.util.hexToBytes(n.subjectKeyIdentifier)===o}}return!1},t};qe.certificateFromAsn1=function(t,e){var r={},n=[];if(!k.validate(t,Pqe,r,n)){var o=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw o.errors=n,o}var s=k.derToOid(r.publicKeyOid);if(s!==qe.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var a=qe.createCertificate();a.version=r.certVersion?r.certVersion.charCodeAt(0):0;var c=xt.util.createBuffer(r.certSerialNumber);a.serialNumber=c.toHex(),a.signatureOid=xt.asn1.derToOid(r.certSignatureOid),a.signatureParameters=d3(a.signatureOid,r.certSignatureParams,!0),a.siginfo.algorithmOid=xt.asn1.derToOid(r.certinfoSignatureOid),a.siginfo.parameters=d3(a.siginfo.algorithmOid,r.certinfoSignatureParams,!1),a.signature=r.certSignature;var u=[];if(r.certValidity1UTCTime!==void 0&&u.push(k.utcTimeToDate(r.certValidity1UTCTime)),r.certValidity2GeneralizedTime!==void 0&&u.push(k.generalizedTimeToDate(r.certValidity2GeneralizedTime)),r.certValidity3UTCTime!==void 0&&u.push(k.utcTimeToDate(r.certValidity3UTCTime)),r.certValidity4GeneralizedTime!==void 0&&u.push(k.generalizedTimeToDate(r.certValidity4GeneralizedTime)),u.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(u.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(a.validity.notBefore=u[0],a.validity.notAfter=u[1],a.tbsCertificate=r.tbsCertificate,e){a.md=p3({signatureOid:a.signatureOid,type:"certificate"});var l=k.toDer(a.tbsCertificate);a.md.update(l.getBytes())}var d=xt.md.sha1.create(),p=k.toDer(r.certIssuer);d.update(p.getBytes()),a.issuer.getField=function(h){return Cg(a.issuer,h)},a.issuer.addField=function(h){bu([h]),a.issuer.attributes.push(h)},a.issuer.attributes=qe.RDNAttributesAsArray(r.certIssuer),r.certIssuerUniqueId&&(a.issuer.uniqueId=r.certIssuerUniqueId),a.issuer.hash=d.digest().toHex();var f=xt.md.sha1.create(),m=k.toDer(r.certSubject);return f.update(m.getBytes()),a.subject.getField=function(h){return Cg(a.subject,h)},a.subject.addField=function(h){bu([h]),a.subject.attributes.push(h)},a.subject.attributes=qe.RDNAttributesAsArray(r.certSubject),r.certSubjectUniqueId&&(a.subject.uniqueId=r.certSubjectUniqueId),a.subject.hash=f.digest().toHex(),r.certExtensions?a.extensions=qe.certificateExtensionsFromAsn1(r.certExtensions):a.extensions=[],a.publicKey=qe.publicKeyFromAsn1(r.subjectPublicKeyInfo),a};qe.certificateExtensionsFromAsn1=function(t){for(var e=[],r=0;r<t.value.length;++r)for(var n=t.value[r],o=0;o<n.value.length;++o)e.push(qe.certificateExtensionFromAsn1(n.value[o]));return e};qe.certificateExtensionFromAsn1=function(t){var e={};if(e.id=k.derToOid(t.value[0].value),e.critical=!1,t.value[1].type===k.Type.BOOLEAN?(e.critical=t.value[1].value.charCodeAt(0)!==0,e.value=t.value[2].value):e.value=t.value[1].value,e.id in kr){if(e.name=kr[e.id],e.name==="keyUsage"){var r=k.fromDer(e.value),n=0,o=0;r.value.length>1&&(n=r.value.charCodeAt(1),o=r.value.length>2?r.value.charCodeAt(2):0),e.digitalSignature=(n&128)===128,e.nonRepudiation=(n&64)===64,e.keyEncipherment=(n&32)===32,e.dataEncipherment=(n&16)===16,e.keyAgreement=(n&8)===8,e.keyCertSign=(n&4)===4,e.cRLSign=(n&2)===2,e.encipherOnly=(n&1)===1,e.decipherOnly=(o&128)===128}else if(e.name==="basicConstraints"){var r=k.fromDer(e.value);r.value.length>0&&r.value[0].type===k.Type.BOOLEAN?e.cA=r.value[0].value.charCodeAt(0)!==0:e.cA=!1;var s=null;r.value.length>0&&r.value[0].type===k.Type.INTEGER?s=r.value[0].value:r.value.length>1&&(s=r.value[1].value),s!==null&&(e.pathLenConstraint=k.derToInteger(s))}else if(e.name==="extKeyUsage")for(var r=k.fromDer(e.value),a=0;a<r.value.length;++a){var c=k.derToOid(r.value[a].value);c in kr?e[kr[c]]=!0:e[c]=!0}else if(e.name==="nsCertType"){var r=k.fromDer(e.value),n=0;r.value.length>1&&(n=r.value.charCodeAt(1)),e.client=(n&128)===128,e.server=(n&64)===64,e.email=(n&32)===32,e.objsign=(n&16)===16,e.reserved=(n&8)===8,e.sslCA=(n&4)===4,e.emailCA=(n&2)===2,e.objCA=(n&1)===1}else if(e.name==="subjectAltName"||e.name==="issuerAltName"){e.altNames=[];for(var u,r=k.fromDer(e.value),l=0;l<r.value.length;++l){u=r.value[l];var d={type:u.type,value:u.value};switch(e.altNames.push(d),u.type){case 1:case 2:case 6:break;case 7:d.ip=xt.util.bytesToIP(u.value);break;case 8:d.oid=k.derToOid(u.value);break;default:}}}else if(e.name==="subjectKeyIdentifier"){var r=k.fromDer(e.value);e.subjectKeyIdentifier=xt.util.bytesToHex(r.value)}}return e};qe.certificationRequestFromAsn1=function(t,e){var r={},n=[];if(!k.validate(t,Nqe,r,n)){var o=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw o.errors=n,o}var s=k.derToOid(r.publicKeyOid);if(s!==qe.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var a=qe.createCertificationRequest();if(a.version=r.csrVersion?r.csrVersion.charCodeAt(0):0,a.signatureOid=xt.asn1.derToOid(r.csrSignatureOid),a.signatureParameters=d3(a.signatureOid,r.csrSignatureParams,!0),a.siginfo.algorithmOid=xt.asn1.derToOid(r.csrSignatureOid),a.siginfo.parameters=d3(a.siginfo.algorithmOid,r.csrSignatureParams,!1),a.signature=r.csrSignature,a.certificationRequestInfo=r.certificationRequestInfo,e){a.md=p3({signatureOid:a.signatureOid,type:"certification request"});var c=k.toDer(a.certificationRequestInfo);a.md.update(c.getBytes())}var u=xt.md.sha1.create();return a.subject.getField=function(l){return Cg(a.subject,l)},a.subject.addField=function(l){bu([l]),a.subject.attributes.push(l)},a.subject.attributes=qe.RDNAttributesAsArray(r.certificationRequestInfoSubject,u),a.subject.hash=u.digest().toHex(),a.publicKey=qe.publicKeyFromAsn1(r.subjectPublicKeyInfo),a.getAttribute=function(l){return Cg(a,l)},a.addAttribute=function(l){bu([l]),a.attributes.push(l)},a.attributes=qe.CRIAttributesAsArray(r.certificationRequestInfoAttributes||[]),a};qe.createCertificationRequest=function(){var t={};return t.version=0,t.signatureOid=null,t.signature=null,t.siginfo={},t.siginfo.algorithmOid=null,t.subject={},t.subject.getField=function(e){return Cg(t.subject,e)},t.subject.addField=function(e){bu([e]),t.subject.attributes.push(e)},t.subject.attributes=[],t.subject.hash=null,t.publicKey=null,t.attributes=[],t.getAttribute=function(e){return Cg(t,e)},t.addAttribute=function(e){bu([e]),t.attributes.push(e)},t.md=null,t.setSubject=function(e){bu(e),t.subject.attributes=e,t.subject.hash=null},t.setAttributes=function(e){bu(e),t.attributes=e},t.sign=function(e,r){t.md=r||xt.md.sha1.create();var n=kr[t.md.algorithm+"WithRSAEncryption"];if(!n){var o=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw o.algorithm=t.md.algorithm,o}t.signatureOid=t.siginfo.algorithmOid=n,t.certificationRequestInfo=qe.getCertificationRequestInfo(t);var s=k.toDer(t.certificationRequestInfo);t.md.update(s.getBytes()),t.signature=e.sign(t.md)},t.verify=function(){var e=!1,r=t.md;if(r===null){r=p3({signatureOid:t.signatureOid,type:"certification request"});var n=t.certificationRequestInfo||qe.getCertificationRequestInfo(t),o=k.toDer(n);r.update(o.getBytes())}return r!==null&&(e=Vpe({certificate:t,md:r,signature:t.signature})),e},t};function nI(t){for(var e=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]),r,n,o=t.attributes,s=0;s<o.length;++s){r=o[s];var a=r.value,c=k.Type.PRINTABLESTRING;"valueTagClass"in r&&(c=r.valueTagClass,c===k.Type.UTF8&&(a=xt.util.encodeUtf8(a))),n=k.create(k.Class.UNIVERSAL,k.Type.SET,!0,[k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(r.type).getBytes()),k.create(k.Class.UNIVERSAL,c,!1,a)])]),e.value.push(n)}return e}function bu(t){for(var e,r=0;r<t.length;++r){if(e=t[r],typeof e.name>"u"&&(e.type&&e.type in qe.oids?e.name=qe.oids[e.type]:e.shortName&&e.shortName in bi&&(e.name=qe.oids[bi[e.shortName]])),typeof e.type>"u")if(e.name&&e.name in qe.oids)e.type=qe.oids[e.name];else{var n=new Error("Attribute type not specified.");throw n.attribute=e,n}if(typeof e.shortName>"u"&&e.name&&e.name in bi&&(e.shortName=bi[e.name]),e.type===kr.extensionRequest&&(e.valueConstructed=!0,e.valueTagClass=k.Type.SEQUENCE,!e.value&&e.extensions)){e.value=[];for(var o=0;o<e.extensions.length;++o)e.value.push(qe.certificateExtensionToAsn1(Gpe(e.extensions[o])))}if(typeof e.value>"u"){var n=new Error("Attribute value not specified.");throw n.attribute=e,n}}}function Gpe(t,e){if(e=e||{},typeof t.name>"u"&&t.id&&t.id in qe.oids&&(t.name=qe.oids[t.id]),typeof t.id>"u")if(t.name&&t.name in qe.oids)t.id=qe.oids[t.name];else{var r=new Error("Extension ID not specified.");throw r.extension=t,r}if(typeof t.value<"u")return t;if(t.name==="keyUsage"){var n=0,o=0,s=0;t.digitalSignature&&(o|=128,n=7),t.nonRepudiation&&(o|=64,n=6),t.keyEncipherment&&(o|=32,n=5),t.dataEncipherment&&(o|=16,n=4),t.keyAgreement&&(o|=8,n=3),t.keyCertSign&&(o|=4,n=2),t.cRLSign&&(o|=2,n=1),t.encipherOnly&&(o|=1,n=0),t.decipherOnly&&(s|=128,n=7);var a=String.fromCharCode(n);s!==0?a+=String.fromCharCode(o)+String.fromCharCode(s):o!==0&&(a+=String.fromCharCode(o)),t.value=k.create(k.Class.UNIVERSAL,k.Type.BITSTRING,!1,a)}else if(t.name==="basicConstraints")t.value=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]),t.cA&&t.value.value.push(k.create(k.Class.UNIVERSAL,k.Type.BOOLEAN,!1,"\xFF")),"pathLenConstraint"in t&&t.value.value.push(k.create(k.Class.UNIVERSAL,k.Type.INTEGER,!1,k.integerToDer(t.pathLenConstraint).getBytes()));else if(t.name==="extKeyUsage"){t.value=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]);var c=t.value.value;for(var u in t)t[u]===!0&&(u in kr?c.push(k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(kr[u]).getBytes())):u.indexOf(".")!==-1&&c.push(k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(u).getBytes())))}else if(t.name==="nsCertType"){var n=0,o=0;t.client&&(o|=128,n=7),t.server&&(o|=64,n=6),t.email&&(o|=32,n=5),t.objsign&&(o|=16,n=4),t.reserved&&(o|=8,n=3),t.sslCA&&(o|=4,n=2),t.emailCA&&(o|=2,n=1),t.objCA&&(o|=1,n=0);var a=String.fromCharCode(n);o!==0&&(a+=String.fromCharCode(o)),t.value=k.create(k.Class.UNIVERSAL,k.Type.BITSTRING,!1,a)}else if(t.name==="subjectAltName"||t.name==="issuerAltName"){t.value=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]);for(var l,d=0;d<t.altNames.length;++d){l=t.altNames[d];var a=l.value;if(l.type===7&&l.ip){if(a=xt.util.bytesFromIP(l.ip),a===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else l.type===8&&(l.oid?a=k.oidToDer(k.oidToDer(l.oid)):a=k.oidToDer(a));t.value.value.push(k.create(k.Class.CONTEXT_SPECIFIC,l.type,!1,a))}}else if(t.name==="nsComment"&&e.cert){if(!/^[\x00-\x7F]*$/.test(t.comment)||t.comment.length<1||t.comment.length>128)throw new Error('Invalid "nsComment" content.');t.value=k.create(k.Class.UNIVERSAL,k.Type.IA5STRING,!1,t.comment)}else if(t.name==="subjectKeyIdentifier"&&e.cert){var p=e.cert.generateSubjectKeyIdentifier();t.subjectKeyIdentifier=p.toHex(),t.value=k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,p.getBytes())}else if(t.name==="authorityKeyIdentifier"&&e.cert){t.value=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]);var c=t.value.value;if(t.keyIdentifier){var f=t.keyIdentifier===!0?e.cert.generateSubjectKeyIdentifier().getBytes():t.keyIdentifier;c.push(k.create(k.Class.CONTEXT_SPECIFIC,0,!1,f))}if(t.authorityCertIssuer){var m=[k.create(k.Class.CONTEXT_SPECIFIC,4,!0,[nI(t.authorityCertIssuer===!0?e.cert.issuer:t.authorityCertIssuer)])];c.push(k.create(k.Class.CONTEXT_SPECIFIC,1,!0,m))}if(t.serialNumber){var h=xt.util.hexToBytes(t.serialNumber===!0?e.cert.serialNumber:t.serialNumber);c.push(k.create(k.Class.CONTEXT_SPECIFIC,2,!1,h))}}else if(t.name==="cRLDistributionPoints"){t.value=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]);for(var c=t.value.value,g=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]),v=k.create(k.Class.CONTEXT_SPECIFIC,0,!0,[]),l,d=0;d<t.altNames.length;++d){l=t.altNames[d];var a=l.value;if(l.type===7&&l.ip){if(a=xt.util.bytesFromIP(l.ip),a===null){var r=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw r.extension=t,r}}else l.type===8&&(l.oid?a=k.oidToDer(k.oidToDer(l.oid)):a=k.oidToDer(a));v.value.push(k.create(k.Class.CONTEXT_SPECIFIC,l.type,!1,a))}g.value.push(k.create(k.Class.CONTEXT_SPECIFIC,0,!0,[v])),c.push(g)}if(typeof t.value>"u"){var r=new Error("Extension value not specified.");throw r.extension=t,r}return t}function PG(t,e){switch(t){case kr["RSASSA-PSS"]:var r=[];return e.hash.algorithmOid!==void 0&&r.push(k.create(k.Class.CONTEXT_SPECIFIC,0,!0,[k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(e.hash.algorithmOid).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.NULL,!1,"")])])),e.mgf.algorithmOid!==void 0&&r.push(k.create(k.Class.CONTEXT_SPECIFIC,1,!0,[k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(e.mgf.algorithmOid).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(e.mgf.hash.algorithmOid).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.NULL,!1,"")])])])),e.saltLength!==void 0&&r.push(k.create(k.Class.CONTEXT_SPECIFIC,2,!0,[k.create(k.Class.UNIVERSAL,k.Type.INTEGER,!1,k.integerToDer(e.saltLength).getBytes())])),k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,r);default:return k.create(k.Class.UNIVERSAL,k.Type.NULL,!1,"")}}function Lqe(t){var e=k.create(k.Class.CONTEXT_SPECIFIC,0,!0,[]);if(t.attributes.length===0)return e;for(var r=t.attributes,n=0;n<r.length;++n){var o=r[n],s=o.value,a=k.Type.UTF8;"valueTagClass"in o&&(a=o.valueTagClass),a===k.Type.UTF8&&(s=xt.util.encodeUtf8(s));var c=!1;"valueConstructed"in o&&(c=o.valueConstructed);var u=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(o.type).getBytes()),k.create(k.Class.UNIVERSAL,k.Type.SET,!0,[k.create(k.Class.UNIVERSAL,a,c,s)])]);e.value.push(u)}return e}var Oqe=new Date("1950-01-01T00:00:00Z"),Mqe=new Date("2050-01-01T00:00:00Z");function Hpe(t){return t>=Oqe&&t<Mqe?k.create(k.Class.UNIVERSAL,k.Type.UTCTIME,!1,k.dateToUtcTime(t)):k.create(k.Class.UNIVERSAL,k.Type.GENERALIZEDTIME,!1,k.dateToGeneralizedTime(t))}qe.getTBSCertificate=function(t){var e=Hpe(t.validity.notBefore),r=Hpe(t.validity.notAfter),n=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.CONTEXT_SPECIFIC,0,!0,[k.create(k.Class.UNIVERSAL,k.Type.INTEGER,!1,k.integerToDer(t.version).getBytes())]),k.create(k.Class.UNIVERSAL,k.Type.INTEGER,!1,xt.util.hexToBytes(t.serialNumber)),k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(t.siginfo.algorithmOid).getBytes()),PG(t.siginfo.algorithmOid,t.siginfo.parameters)]),nI(t.issuer),k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[e,r]),nI(t.subject),qe.publicKeyToAsn1(t.publicKey)]);return t.issuer.uniqueId&&n.value.push(k.create(k.Class.CONTEXT_SPECIFIC,1,!0,[k.create(k.Class.UNIVERSAL,k.Type.BITSTRING,!1,"\0"+t.issuer.uniqueId)])),t.subject.uniqueId&&n.value.push(k.create(k.Class.CONTEXT_SPECIFIC,2,!0,[k.create(k.Class.UNIVERSAL,k.Type.BITSTRING,!1,"\0"+t.subject.uniqueId)])),t.extensions.length>0&&n.value.push(qe.certificateExtensionsToAsn1(t.extensions)),n};qe.getCertificationRequestInfo=function(t){var e=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.INTEGER,!1,k.integerToDer(t.version).getBytes()),nI(t.subject),qe.publicKeyToAsn1(t.publicKey),Lqe(t)]);return e};qe.distinguishedNameToAsn1=function(t){return nI(t)};qe.certificateToAsn1=function(t){var e=t.tbsCertificate||qe.getTBSCertificate(t);return k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[e,k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(t.signatureOid).getBytes()),PG(t.signatureOid,t.signatureParameters)]),k.create(k.Class.UNIVERSAL,k.Type.BITSTRING,!1,"\0"+t.signature)])};qe.certificateExtensionsToAsn1=function(t){var e=k.create(k.Class.CONTEXT_SPECIFIC,3,!0,[]),r=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]);e.value.push(r);for(var n=0;n<t.length;++n)r.value.push(qe.certificateExtensionToAsn1(t[n]));return e};qe.certificateExtensionToAsn1=function(t){var e=k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[]);e.value.push(k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(t.id).getBytes())),t.critical&&e.value.push(k.create(k.Class.UNIVERSAL,k.Type.BOOLEAN,!1,"\xFF"));var r=t.value;return typeof t.value!="string"&&(r=k.toDer(r).getBytes()),e.value.push(k.create(k.Class.UNIVERSAL,k.Type.OCTETSTRING,!1,r)),e};qe.certificationRequestToAsn1=function(t){var e=t.certificationRequestInfo||qe.getCertificationRequestInfo(t);return k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[e,k.create(k.Class.UNIVERSAL,k.Type.SEQUENCE,!0,[k.create(k.Class.UNIVERSAL,k.Type.OID,!1,k.oidToDer(t.signatureOid).getBytes()),PG(t.signatureOid,t.signatureParameters)]),k.create(k.Class.UNIVERSAL,k.Type.BITSTRING,!1,"\0"+t.signature)])};qe.createCaStore=function(t){var e={certs:{}};e.getIssuer=function(a){var c=r(a.issuer);return c},e.addCertificate=function(a){if(typeof a=="string"&&(a=xt.pki.certificateFromPem(a)),n(a.subject),!e.hasCertificate(a))if(a.subject.hash in e.certs){var c=e.certs[a.subject.hash];xt.util.isArray(c)||(c=[c]),c.push(a),e.certs[a.subject.hash]=c}else e.certs[a.subject.hash]=a},e.hasCertificate=function(a){typeof a=="string"&&(a=xt.pki.certificateFromPem(a));var c=r(a.subject);if(!c)return!1;xt.util.isArray(c)||(c=[c]);for(var u=k.toDer(qe.certificateToAsn1(a)).getBytes(),l=0;l<c.length;++l){var d=k.toDer(qe.certificateToAsn1(c[l])).getBytes();if(u===d)return!0}return!1},e.listAllCertificates=function(){var a=[];for(var c in e.certs)if(e.certs.hasOwnProperty(c)){var u=e.certs[c];if(!xt.util.isArray(u))a.push(u);else for(var l=0;l<u.length;++l)a.push(u[l])}return a},e.removeCertificate=function(a){var c;if(typeof a=="string"&&(a=xt.pki.certificateFromPem(a)),n(a.subject),!e.hasCertificate(a))return null;var u=r(a.subject);if(!xt.util.isArray(u))return c=e.certs[a.subject.hash],delete e.certs[a.subject.hash],c;for(var l=k.toDer(qe.certificateToAsn1(a)).getBytes(),d=0;d<u.length;++d){var p=k.toDer(qe.certificateToAsn1(u[d])).getBytes();l===p&&(c=u[d],u.splice(d,1))}return u.length===0&&delete e.certs[a.subject.hash],c};function r(a){return n(a),e.certs[a.hash]||null}function n(a){if(!a.hash){var c=xt.md.sha1.create();a.attributes=qe.RDNAttributesAsArray(nI(a),c),a.hash=c.digest().toHex()}}if(t)for(var o=0;o<t.length;++o){var s=t[o];e.addCertificate(s)}return e};qe.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};qe.verifyCertificateChain=function(t,e,r){typeof r=="function"&&(r={verify:r}),r=r||{},e=e.slice(0);var n=e.slice(0),o=r.validityCheckDate;typeof o>"u"&&(o=new Date);var s=!0,a=null,c=0;do{var u=e.shift(),l=null,d=!1;if(o&&(o<u.validity.notBefore||o>u.validity.notAfter)&&(a={message:"Certificate is not valid yet or has expired.",error:qe.certificateError.certificate_expired,notBefore:u.validity.notBefore,notAfter:u.validity.notAfter,now:o}),a===null){if(l=e[0]||t.getIssuer(u),l===null&&u.isIssuer(u)&&(d=!0,l=u),l){var p=l;xt.util.isArray(p)||(p=[p]);for(var f=!1;!f&&p.length>0;){l=p.shift();try{f=l.verify(u)}catch{}}f||(a={message:"Certificate signature is invalid.",error:qe.certificateError.bad_certificate})}a===null&&(!l||d)&&!t.hasCertificate(u)&&(a={message:"Certificate is not trusted.",error:qe.certificateError.unknown_ca})}if(a===null&&l&&!u.isIssuer(l)&&(a={message:"Certificate issuer is invalid.",error:qe.certificateError.bad_certificate}),a===null)for(var m={keyUsage:!0,basicConstraints:!0},h=0;a===null&&h<u.extensions.length;++h){var g=u.extensions[h];g.critical&&!(g.name in m)&&(a={message:"Certificate has an unsupported critical extension.",error:qe.certificateError.unsupported_certificate})}if(a===null&&(!s||e.length===0&&(!l||d))){var v=u.getExtension("basicConstraints"),y=u.getExtension("keyUsage");if(y!==null&&(!y.keyCertSign||v===null)&&(a={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:qe.certificateError.bad_certificate}),a===null&&v!==null&&!v.cA&&(a={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:qe.certificateError.bad_certificate}),a===null&&y!==null&&"pathLenConstraint"in v){var b=c-1;b>v.pathLenConstraint&&(a={message:"Certificate basicConstraints pathLenConstraint violated.",error:qe.certificateError.bad_certificate})}}var _=a===null?!0:a.error,S=r.verify?r.verify(_,c,n):_;if(S===!0)a=null;else throw _===!0&&(a={message:"The application rejected the certificate.",error:qe.certificateError.bad_certificate}),(S||S===0)&&(typeof S=="object"&&!xt.util.isArray(S)?(S.message&&(a.message=S.message),S.error&&(a.error=S.error)):typeof S=="string"&&(a.error=S)),a;s=!1,++c}while(e.length>0);return!0}});var DG=M((qir,Wpe)=>{var En=rr();Tl();QS();xg();RG();wG();gu();ck();eI();Lr();f3();var V=En.asn1,mr=En.pki,lk=Wpe.exports=En.pkcs12=En.pkcs12||{},$pe={name:"ContentInfo",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:V.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},Fqe={name:"PFX",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"version"},$pe,{name:"PFX.macData",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:V.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:V.Class.UNIVERSAL,type:V.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:V.Class.UNIVERSAL,type:V.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},Uqe={name:"SafeBag",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:V.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:V.Class.UNIVERSAL,type:V.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},Bqe={name:"Attribute",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:V.Class.UNIVERSAL,type:V.Type.SET,constructed:!0,capture:"values"}]},qqe={name:"CertBag",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:V.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:V.Class.UNIVERSAL,type:V.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function uk(t,e,r,n){for(var o=[],s=0;s<t.length;s++)for(var a=0;a<t[s].safeBags.length;a++){var c=t[s].safeBags[a];if(!(n!==void 0&&c.type!==n)){if(e===null){o.push(c);continue}c.attributes[e]!==void 0&&c.attributes[e].indexOf(r)>=0&&o.push(c)}}return o}lk.pkcs12FromAsn1=function(t,e,r){typeof e=="string"?(r=e,e=!0):e===void 0&&(e=!0);var n={},o=[];if(!V.validate(t,Fqe,n,o)){var s=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw s.errors=s,s}var a={version:n.version.charCodeAt(0),safeContents:[],getBags:function(v){var y={},b;return"localKeyId"in v?b=v.localKeyId:"localKeyIdHex"in v&&(b=En.util.hexToBytes(v.localKeyIdHex)),b===void 0&&!("friendlyName"in v)&&"bagType"in v&&(y[v.bagType]=uk(a.safeContents,null,null,v.bagType)),b!==void 0&&(y.localKeyId=uk(a.safeContents,"localKeyId",b,v.bagType)),"friendlyName"in v&&(y.friendlyName=uk(a.safeContents,"friendlyName",v.friendlyName,v.bagType)),y},getBagsByFriendlyName:function(v,y){return uk(a.safeContents,"friendlyName",v,y)},getBagsByLocalKeyId:function(v,y){return uk(a.safeContents,"localKeyId",v,y)}};if(n.version.charCodeAt(0)!==3){var s=new Error("PKCS#12 PFX of version other than 3 not supported.");throw s.version=n.version.charCodeAt(0),s}if(V.derToOid(n.contentType)!==mr.oids.data){var s=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw s.oid=V.derToOid(n.contentType),s}var c=n.content.value[0];if(c.tagClass!==V.Class.UNIVERSAL||c.type!==V.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(c=AG(c),n.mac){var u=null,l=0,d=V.derToOid(n.macAlgorithm);switch(d){case mr.oids.sha1:u=En.md.sha1.create(),l=20;break;case mr.oids.sha256:u=En.md.sha256.create(),l=32;break;case mr.oids.sha384:u=En.md.sha384.create(),l=48;break;case mr.oids.sha512:u=En.md.sha512.create(),l=64;break;case mr.oids.md5:u=En.md.md5.create(),l=16;break}if(u===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+d);var p=new En.util.ByteBuffer(n.macSalt),f="macIterations"in n?parseInt(En.util.bytesToHex(n.macIterations),16):1,m=lk.generateKey(r,p,3,f,l,u),h=En.hmac.create();h.start(u,m),h.update(c.value);var g=h.getMac();if(g.getBytes()!==n.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return Hqe(a,c.value,e,r),a};function AG(t){if(t.composed||t.constructed){for(var e=En.util.createBuffer(),r=0;r<t.value.length;++r)e.putBytes(t.value[r].value);t.composed=t.constructed=!1,t.value=e.getBytes()}return t}function Hqe(t,e,r,n){if(e=V.fromDer(e,r),e.tagClass!==V.Class.UNIVERSAL||e.type!==V.Type.SEQUENCE||e.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var o=0;o<e.value.length;o++){var s=e.value[o],a={},c=[];if(!V.validate(s,$pe,a,c)){var u=new Error("Cannot read ContentInfo.");throw u.errors=c,u}var l={encrypted:!1},d=null,p=a.content.value[0];switch(V.derToOid(a.contentType)){case mr.oids.data:if(p.tagClass!==V.Class.UNIVERSAL||p.type!==V.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");d=AG(p).value;break;case mr.oids.encryptedData:d=jqe(p,n),l.encrypted=!0;break;default:var u=new Error("Unsupported PKCS#12 contentType.");throw u.contentType=V.derToOid(a.contentType),u}l.safeBags=Vqe(d,r,n),t.safeContents.push(l)}}function jqe(t,e){var r={},n=[];if(!V.validate(t,En.pkcs7.asn1.encryptedDataValidator,r,n)){var o=new Error("Cannot read EncryptedContentInfo.");throw o.errors=n,o}var s=V.derToOid(r.contentType);if(s!==mr.oids.data){var o=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw o.oid=s,o}s=V.derToOid(r.encAlgorithm);var a=mr.pbe.getCipher(s,r.encParameter,e),c=AG(r.encryptedContentAsn1),u=En.util.createBuffer(c.value);if(a.update(u),!a.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return a.output.getBytes()}function Vqe(t,e,r){if(!e&&t.length===0)return[];if(t=V.fromDer(t,e),t.tagClass!==V.Class.UNIVERSAL||t.type!==V.Type.SEQUENCE||t.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");for(var n=[],o=0;o<t.value.length;o++){var s=t.value[o],a={},c=[];if(!V.validate(s,Uqe,a,c)){var u=new Error("Cannot read SafeBag.");throw u.errors=c,u}var l={type:V.derToOid(a.bagId),attributes:Gqe(a.bagAttributes)};n.push(l);var d,p,f=a.bagValue.value[0];switch(l.type){case mr.oids.pkcs8ShroudedKeyBag:if(f=mr.decryptPrivateKeyInfo(f,r),f===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case mr.oids.keyBag:try{l.key=mr.privateKeyFromAsn1(f)}catch{l.key=null,l.asn1=f}continue;case mr.oids.certBag:d=qqe,p=function(){if(V.derToOid(a.certId)!==mr.oids.x509Certificate){var h=new Error("Unsupported certificate type, only X.509 supported.");throw h.oid=V.derToOid(a.certId),h}var g=V.fromDer(a.cert,e);try{l.cert=mr.certificateFromAsn1(g,!0)}catch{l.cert=null,l.asn1=g}};break;default:var u=new Error("Unsupported PKCS#12 SafeBag type.");throw u.oid=l.type,u}if(d!==void 0&&!V.validate(f,d,a,c)){var u=new Error("Cannot read PKCS#12 "+d.name);throw u.errors=c,u}p()}return n}function Gqe(t){var e={};if(t!==void 0)for(var r=0;r<t.length;++r){var n={},o=[];if(!V.validate(t[r],Bqe,n,o)){var s=new Error("Cannot read PKCS#12 BagAttribute.");throw s.errors=o,s}var a=V.derToOid(n.oid);if(mr.oids[a]!==void 0){e[mr.oids[a]]=[];for(var c=0;c<n.values.length;++c)e[mr.oids[a]].push(n.values[c].value)}}return e}lk.toPkcs12Asn1=function(t,e,r,n){n=n||{},n.saltSize=n.saltSize||8,n.count=n.count||2048,n.algorithm=n.algorithm||n.encAlgorithm||"aes128","useMac"in n||(n.useMac=!0),"localKeyId"in n||(n.localKeyId=null),"generateLocalKeyId"in n||(n.generateLocalKeyId=!0);var o=n.localKeyId,s;if(o!==null)o=En.util.hexToBytes(o);else if(n.generateLocalKeyId)if(e){var a=En.util.isArray(e)?e[0]:e;typeof a=="string"&&(a=mr.certificateFromPem(a));var c=En.md.sha1.create();c.update(V.toDer(mr.certificateToAsn1(a)).getBytes()),o=c.digest().getBytes()}else o=En.random.getBytes(20);var u=[];o!==null&&u.push(V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(mr.oids.localKeyId).getBytes()),V.create(V.Class.UNIVERSAL,V.Type.SET,!0,[V.create(V.Class.UNIVERSAL,V.Type.OCTETSTRING,!1,o)])])),"friendlyName"in n&&u.push(V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(mr.oids.friendlyName).getBytes()),V.create(V.Class.UNIVERSAL,V.Type.SET,!0,[V.create(V.Class.UNIVERSAL,V.Type.BMPSTRING,!1,n.friendlyName)])])),u.length>0&&(s=V.create(V.Class.UNIVERSAL,V.Type.SET,!0,u));var l=[],d=[];e!==null&&(En.util.isArray(e)?d=e:d=[e]);for(var p=[],f=0;f<d.length;++f){e=d[f],typeof e=="string"&&(e=mr.certificateFromPem(e));var m=f===0?s:void 0,h=mr.certificateToAsn1(e),g=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(mr.oids.certBag).getBytes()),V.create(V.Class.CONTEXT_SPECIFIC,0,!0,[V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(mr.oids.x509Certificate).getBytes()),V.create(V.Class.CONTEXT_SPECIFIC,0,!0,[V.create(V.Class.UNIVERSAL,V.Type.OCTETSTRING,!1,V.toDer(h).getBytes())])])]),m]);p.push(g)}if(p.length>0){var v=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,p),y=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(mr.oids.data).getBytes()),V.create(V.Class.CONTEXT_SPECIFIC,0,!0,[V.create(V.Class.UNIVERSAL,V.Type.OCTETSTRING,!1,V.toDer(v).getBytes())])]);l.push(y)}var b=null;if(t!==null){var _=mr.wrapRsaPrivateKey(mr.privateKeyToAsn1(t));r===null?b=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(mr.oids.keyBag).getBytes()),V.create(V.Class.CONTEXT_SPECIFIC,0,!0,[_]),s]):b=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(mr.oids.pkcs8ShroudedKeyBag).getBytes()),V.create(V.Class.CONTEXT_SPECIFIC,0,!0,[mr.encryptPrivateKeyInfo(_,r,n)]),s]);var S=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[b]),I=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(mr.oids.data).getBytes()),V.create(V.Class.CONTEXT_SPECIFIC,0,!0,[V.create(V.Class.UNIVERSAL,V.Type.OCTETSTRING,!1,V.toDer(S).getBytes())])]);l.push(I)}var T=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,l),A;if(n.useMac){var c=En.md.sha1.create(),B=new En.util.ByteBuffer(En.random.getBytes(n.saltSize)),j=n.count,t=lk.generateKey(r,B,3,j,20),F=En.hmac.create();F.start(c,t),F.update(V.toDer(T).getBytes());var ne=F.getMac();A=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(mr.oids.sha1).getBytes()),V.create(V.Class.UNIVERSAL,V.Type.NULL,!1,"")]),V.create(V.Class.UNIVERSAL,V.Type.OCTETSTRING,!1,ne.getBytes())]),V.create(V.Class.UNIVERSAL,V.Type.OCTETSTRING,!1,B.getBytes()),V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,V.integerToDer(j).getBytes())])}return V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,V.integerToDer(3).getBytes()),V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(mr.oids.data).getBytes()),V.create(V.Class.CONTEXT_SPECIFIC,0,!0,[V.create(V.Class.UNIVERSAL,V.Type.OCTETSTRING,!1,V.toDer(T).getBytes())])]),A])};lk.generateKey=En.pbe.generatePkcs12Key});var LG=M((Hir,Kpe)=>{var Eg=rr();Tl();xg();wG();by();n3();DG();l3();ck();Lr();f3();var NG=Eg.asn1,iI=Kpe.exports=Eg.pki=Eg.pki||{};iI.pemToDer=function(t){var e=Eg.pem.decode(t)[0];if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return Eg.util.createBuffer(e.body)};iI.privateKeyFromPem=function(t){var e=Eg.pem.decode(t)[0];if(e.type!=="PRIVATE KEY"&&e.type!=="RSA PRIVATE KEY"){var r=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var n=NG.fromDer(e.body);return iI.privateKeyFromAsn1(n)};iI.privateKeyToPem=function(t,e){var r={type:"RSA PRIVATE KEY",body:NG.toDer(iI.privateKeyToAsn1(t)).getBytes()};return Eg.pem.encode(r,{maxline:e})};iI.privateKeyInfoToPem=function(t,e){var r={type:"PRIVATE KEY",body:NG.toDer(t).getBytes()};return Eg.pem.encode(r,{maxline:e})}});var qG=M((jir,rfe)=>{var Se=rr();Tl();QS();ZO();by();LG();gu();eI();Lr();var v3=function(t,e,r,n){var o=Se.util.createBuffer(),s=t.length>>1,a=s+(t.length&1),c=t.substr(0,a),u=t.substr(s,a),l=Se.util.createBuffer(),d=Se.hmac.create();r=e+r;var p=Math.ceil(n/16),f=Math.ceil(n/20);d.start("MD5",c);var m=Se.util.createBuffer();l.putBytes(r);for(var h=0;h<p;++h)d.start(null,null),d.update(l.getBytes()),l.putBuffer(d.digest()),d.start(null,null),d.update(l.bytes()+r),m.putBuffer(d.digest());d.start("SHA1",u);var g=Se.util.createBuffer();l.clear(),l.putBytes(r);for(var h=0;h<f;++h)d.start(null,null),d.update(l.getBytes()),l.putBuffer(d.digest()),d.start(null,null),d.update(l.bytes()+r),g.putBuffer(d.digest());return o.putBytes(Se.util.xorBytes(m.getBytes(),g.getBytes(),n)),o},zqe=function(t,e,r){var n=Se.hmac.create();n.start("SHA1",t);var o=Se.util.createBuffer();return o.putInt32(e[0]),o.putInt32(e[1]),o.putByte(r.type),o.putByte(r.version.major),o.putByte(r.version.minor),o.putInt16(r.length),o.putBytes(r.fragment.bytes()),n.update(o.getBytes()),n.digest().getBytes()},$qe=function(t,e,r){var n=!1;try{var o=t.deflate(e.fragment.getBytes());e.fragment=Se.util.createBuffer(o),e.length=o.length,n=!0}catch{}return n},Wqe=function(t,e,r){var n=!1;try{var o=t.inflate(e.fragment.getBytes());e.fragment=Se.util.createBuffer(o),e.length=o.length,n=!0}catch{}return n},Cc=function(t,e){var r=0;switch(e){case 1:r=t.getByte();break;case 2:r=t.getInt16();break;case 3:r=t.getInt24();break;case 4:r=t.getInt32();break}return Se.util.createBuffer(t.getBytes(r))},_u=function(t,e,r){t.putInt(r.length(),e<<3),t.putBuffer(r)},L={};L.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};L.SupportedVersions=[L.Versions.TLS_1_1,L.Versions.TLS_1_0];L.Version=L.SupportedVersions[0];L.MaxFragment=15360;L.ConnectionEnd={server:0,client:1};L.PRFAlgorithm={tls_prf_sha256:0};L.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};L.CipherType={stream:0,block:1,aead:2};L.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};L.CompressionMethod={none:0,deflate:1};L.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};L.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};L.Alert={};L.Alert.Level={warning:1,fatal:2};L.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};L.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};L.CipherSuites={};L.getCipherSuite=function(t){var e=null;for(var r in L.CipherSuites){var n=L.CipherSuites[r];if(n.id[0]===t.charCodeAt(0)&&n.id[1]===t.charCodeAt(1)){e=n;break}}return e};L.handleUnexpected=function(t,e){var r=!t.open&&t.entity===L.ConnectionEnd.client;r||t.error(t,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.unexpected_message}})};L.handleHelloRequest=function(t,e,r){!t.handshaking&&t.handshakes>0&&(L.queue(t,L.createAlert(t,{level:L.Alert.Level.warning,description:L.Alert.Description.no_renegotiation})),L.flush(t)),t.process()};L.parseHelloMessage=function(t,e,r){var n=null,o=t.entity===L.ConnectionEnd.client;if(r<38)t.error(t,{message:o?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.illegal_parameter}});else{var s=e.fragment,a=s.length();if(n={version:{major:s.getByte(),minor:s.getByte()},random:Se.util.createBuffer(s.getBytes(32)),session_id:Cc(s,1),extensions:[]},o?(n.cipher_suite=s.getBytes(2),n.compression_method=s.getByte()):(n.cipher_suites=Cc(s,2),n.compression_methods=Cc(s,1)),a=r-(a-s.length()),a>0){for(var c=Cc(s,2);c.length()>0;)n.extensions.push({type:[c.getByte(),c.getByte()],data:Cc(c,2)});if(!o)for(var u=0;u<n.extensions.length;++u){var l=n.extensions[u];if(l.type[0]===0&&l.type[1]===0)for(var d=Cc(l.data,2);d.length()>0;){var p=d.getByte();if(p!==0)break;t.session.extensions.server_name.serverNameList.push(Cc(d,2).getBytes())}}}if(t.session.version&&(n.version.major!==t.session.version.major||n.version.minor!==t.session.version.minor))return t.error(t,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.protocol_version}});if(o)t.session.cipherSuite=L.getCipherSuite(n.cipher_suite);else for(var f=Se.util.createBuffer(n.cipher_suites.bytes());f.length()>0&&(t.session.cipherSuite=L.getCipherSuite(f.getBytes(2)),t.session.cipherSuite===null););if(t.session.cipherSuite===null)return t.error(t,{message:"No cipher suites in common.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.handshake_failure},cipherSuite:Se.util.bytesToHex(n.cipher_suite)});o?t.session.compressionMethod=n.compression_method:t.session.compressionMethod=L.CompressionMethod.none}return n};L.createSecurityParameters=function(t,e){var r=t.entity===L.ConnectionEnd.client,n=e.random.bytes(),o=r?t.session.sp.client_random:n,s=r?n:L.createRandom().getBytes();t.session.sp={entity:t.entity,prf_algorithm:L.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:t.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:o,server_random:s}};L.handleServerHello=function(t,e,r){var n=L.parseHelloMessage(t,e,r);if(!t.fail){if(n.version.minor<=t.version.minor)t.version.minor=n.version.minor;else return t.error(t,{message:"Incompatible TLS version.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.protocol_version}});t.session.version=t.version;var o=n.session_id.bytes();o.length>0&&o===t.session.id?(t.expect=Xpe,t.session.resuming=!0,t.session.sp.server_random=n.random.bytes()):(t.expect=Yqe,t.session.resuming=!1,L.createSecurityParameters(t,n)),t.session.id=o,t.process()}};L.handleClientHello=function(t,e,r){var n=L.parseHelloMessage(t,e,r);if(!t.fail){var o=n.session_id.bytes(),s=null;if(t.sessionCache&&(s=t.sessionCache.getSession(o),s===null?o="":(s.version.major!==n.version.major||s.version.minor>n.version.minor)&&(s=null,o="")),o.length===0&&(o=Se.random.getBytes(32)),t.session.id=o,t.session.clientHelloVersion=n.version,t.session.sp={},s)t.version=t.session.version=s.version,t.session.sp=s.sp;else{for(var a,c=1;c<L.SupportedVersions.length&&(a=L.SupportedVersions[c],!(a.minor<=n.version.minor));++c);t.version={major:a.major,minor:a.minor},t.session.version=t.version}s!==null?(t.expect=UG,t.session.resuming=!0,t.session.sp.client_random=n.random.bytes()):(t.expect=t.verifyClient!==!1?rHe:FG,t.session.resuming=!1,L.createSecurityParameters(t,n)),t.open=!0,L.queue(t,L.createRecord(t,{type:L.ContentType.handshake,data:L.createServerHello(t)})),t.session.resuming?(L.queue(t,L.createRecord(t,{type:L.ContentType.change_cipher_spec,data:L.createChangeCipherSpec()})),t.state.pending=L.createConnectionState(t),t.state.current.write=t.state.pending.write,L.queue(t,L.createRecord(t,{type:L.ContentType.handshake,data:L.createFinished(t)}))):(L.queue(t,L.createRecord(t,{type:L.ContentType.handshake,data:L.createCertificate(t)})),t.fail||(L.queue(t,L.createRecord(t,{type:L.ContentType.handshake,data:L.createServerKeyExchange(t)})),t.verifyClient!==!1&&L.queue(t,L.createRecord(t,{type:L.ContentType.handshake,data:L.createCertificateRequest(t)})),L.queue(t,L.createRecord(t,{type:L.ContentType.handshake,data:L.createServerHelloDone(t)})))),L.flush(t),t.process()}};L.handleCertificate=function(t,e,r){if(r<3)return t.error(t,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.illegal_parameter}});var n=e.fragment,o={certificate_list:Cc(n,3)},s,a,c=[];try{for(;o.certificate_list.length()>0;)s=Cc(o.certificate_list,3),a=Se.asn1.fromDer(s),s=Se.pki.certificateFromAsn1(a,!0),c.push(s)}catch(l){return t.error(t,{message:"Could not parse certificate list.",cause:l,send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.bad_certificate}})}var u=t.entity===L.ConnectionEnd.client;(u||t.verifyClient===!0)&&c.length===0?t.error(t,{message:u?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.illegal_parameter}}):c.length===0?t.expect=u?Ype:FG:(u?t.session.serverCertificate=c[0]:t.session.clientCertificate=c[0],L.verifyCertificateChain(t,c)&&(t.expect=u?Ype:FG)),t.process()};L.handleServerKeyExchange=function(t,e,r){if(r>0)return t.error(t,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.unsupported_certificate}});t.expect=Qqe,t.process()};L.handleClientKeyExchange=function(t,e,r){if(r<48)return t.error(t,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.unsupported_certificate}});var n=e.fragment,o={enc_pre_master_secret:Cc(n,2).getBytes()},s=null;if(t.getPrivateKey)try{s=t.getPrivateKey(t,t.session.serverCertificate),s=Se.pki.privateKeyFromPem(s)}catch(u){t.error(t,{message:"Could not get private key.",cause:u,send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.internal_error}})}if(s===null)return t.error(t,{message:"No private key set.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.internal_error}});try{var a=t.session.sp;a.pre_master_secret=s.decrypt(o.enc_pre_master_secret);var c=t.session.clientHelloVersion;if(c.major!==a.pre_master_secret.charCodeAt(0)||c.minor!==a.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch{a.pre_master_secret=Se.random.getBytes(48)}t.expect=UG,t.session.clientCertificate!==null&&(t.expect=nHe),t.process()};L.handleCertificateRequest=function(t,e,r){if(r<3)return t.error(t,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.illegal_parameter}});var n=e.fragment,o={certificate_types:Cc(n,1),certificate_authorities:Cc(n,2)};t.session.certificateRequest=o,t.expect=Xqe,t.process()};L.handleCertificateVerify=function(t,e,r){if(r<2)return t.error(t,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.illegal_parameter}});var n=e.fragment;n.read-=4;var o=n.bytes();n.read+=4;var s={signature:Cc(n,2).getBytes()},a=Se.util.createBuffer();a.putBuffer(t.session.md5.digest()),a.putBuffer(t.session.sha1.digest()),a=a.getBytes();try{var c=t.session.clientCertificate;if(!c.publicKey.verify(a,s.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");t.session.md5.update(o),t.session.sha1.update(o)}catch{return t.error(t,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.handshake_failure}})}t.expect=UG,t.process()};L.handleServerHelloDone=function(t,e,r){if(r>0)return t.error(t,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.record_overflow}});if(t.serverCertificate===null){var n={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.insufficient_security}},o=0,s=t.verify(t,n.alert.description,o,[]);if(s!==!0)return(s||s===0)&&(typeof s=="object"&&!Se.util.isArray(s)?(s.message&&(n.message=s.message),s.alert&&(n.alert.description=s.alert)):typeof s=="number"&&(n.alert.description=s)),t.error(t,n)}t.session.certificateRequest!==null&&(e=L.createRecord(t,{type:L.ContentType.handshake,data:L.createCertificate(t)}),L.queue(t,e)),e=L.createRecord(t,{type:L.ContentType.handshake,data:L.createClientKeyExchange(t)}),L.queue(t,e),t.expect=eHe;var a=function(c,u){c.session.certificateRequest!==null&&c.session.clientCertificate!==null&&L.queue(c,L.createRecord(c,{type:L.ContentType.handshake,data:L.createCertificateVerify(c,u)})),L.queue(c,L.createRecord(c,{type:L.ContentType.change_cipher_spec,data:L.createChangeCipherSpec()})),c.state.pending=L.createConnectionState(c),c.state.current.write=c.state.pending.write,L.queue(c,L.createRecord(c,{type:L.ContentType.handshake,data:L.createFinished(c)})),c.expect=Xpe,L.flush(c),c.process()};if(t.session.certificateRequest===null||t.session.clientCertificate===null)return a(t,null);L.getClientSignature(t,a)};L.handleChangeCipherSpec=function(t,e){if(e.fragment.getByte()!==1)return t.error(t,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.illegal_parameter}});var r=t.entity===L.ConnectionEnd.client;(t.session.resuming&&r||!t.session.resuming&&!r)&&(t.state.pending=L.createConnectionState(t)),t.state.current.read=t.state.pending.read,(!t.session.resuming&&r||t.session.resuming&&!r)&&(t.state.pending=null),t.expect=r?Jqe:iHe,t.process()};L.handleFinished=function(t,e,r){var n=e.fragment;n.read-=4;var o=n.bytes();n.read+=4;var s=e.fragment.getBytes();n=Se.util.createBuffer(),n.putBuffer(t.session.md5.digest()),n.putBuffer(t.session.sha1.digest());var a=t.entity===L.ConnectionEnd.client,c=a?"server finished":"client finished",u=t.session.sp,l=12,d=v3;if(n=d(u.master_secret,c,n.getBytes(),l),n.getBytes()!==s)return t.error(t,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.decrypt_error}});t.session.md5.update(o),t.session.sha1.update(o),(t.session.resuming&&a||!t.session.resuming&&!a)&&(L.queue(t,L.createRecord(t,{type:L.ContentType.change_cipher_spec,data:L.createChangeCipherSpec()})),t.state.current.write=t.state.pending.write,t.state.pending=null,L.queue(t,L.createRecord(t,{type:L.ContentType.handshake,data:L.createFinished(t)}))),t.expect=a?Zqe:oHe,t.handshaking=!1,++t.handshakes,t.peerCertificate=a?t.session.serverCertificate:t.session.clientCertificate,L.flush(t),t.isConnected=!0,t.connected(t),t.process()};L.handleAlert=function(t,e){var r=e.fragment,n={level:r.getByte(),description:r.getByte()},o;switch(n.description){case L.Alert.Description.close_notify:o="Connection closed.";break;case L.Alert.Description.unexpected_message:o="Unexpected message.";break;case L.Alert.Description.bad_record_mac:o="Bad record MAC.";break;case L.Alert.Description.decryption_failed:o="Decryption failed.";break;case L.Alert.Description.record_overflow:o="Record overflow.";break;case L.Alert.Description.decompression_failure:o="Decompression failed.";break;case L.Alert.Description.handshake_failure:o="Handshake failure.";break;case L.Alert.Description.bad_certificate:o="Bad certificate.";break;case L.Alert.Description.unsupported_certificate:o="Unsupported certificate.";break;case L.Alert.Description.certificate_revoked:o="Certificate revoked.";break;case L.Alert.Description.certificate_expired:o="Certificate expired.";break;case L.Alert.Description.certificate_unknown:o="Certificate unknown.";break;case L.Alert.Description.illegal_parameter:o="Illegal parameter.";break;case L.Alert.Description.unknown_ca:o="Unknown certificate authority.";break;case L.Alert.Description.access_denied:o="Access denied.";break;case L.Alert.Description.decode_error:o="Decode error.";break;case L.Alert.Description.decrypt_error:o="Decrypt error.";break;case L.Alert.Description.export_restriction:o="Export restriction.";break;case L.Alert.Description.protocol_version:o="Unsupported protocol version.";break;case L.Alert.Description.insufficient_security:o="Insufficient security.";break;case L.Alert.Description.internal_error:o="Internal error.";break;case L.Alert.Description.user_canceled:o="User canceled.";break;case L.Alert.Description.no_renegotiation:o="Renegotiation not supported.";break;default:o="Unknown error.";break}if(n.description===L.Alert.Description.close_notify)return t.close();t.error(t,{message:o,send:!1,origin:t.entity===L.ConnectionEnd.client?"server":"client",alert:n}),t.process()};L.handleHandshake=function(t,e){var r=e.fragment,n=r.getByte(),o=r.getInt24();if(o>r.length())return t.fragmented=e,e.fragment=Se.util.createBuffer(),r.read-=4,t.process();t.fragmented=null,r.read-=4;var s=r.bytes(o+4);r.read+=4,n in g3[t.entity][t.expect]?(t.entity===L.ConnectionEnd.server&&!t.open&&!t.fail&&(t.handshaking=!0,t.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:Se.md.md5.create(),sha1:Se.md.sha1.create()}),n!==L.HandshakeType.hello_request&&n!==L.HandshakeType.certificate_verify&&n!==L.HandshakeType.finished&&(t.session.md5.update(s),t.session.sha1.update(s)),g3[t.entity][t.expect][n](t,e,o)):L.handleUnexpected(t,e)};L.handleApplicationData=function(t,e){t.data.putBuffer(e.fragment),t.dataReady(t),t.process()};L.handleHeartbeat=function(t,e){var r=e.fragment,n=r.getByte(),o=r.getInt16(),s=r.getBytes(o);if(n===L.HeartbeatMessageType.heartbeat_request){if(t.handshaking||o>s.length)return t.process();L.queue(t,L.createRecord(t,{type:L.ContentType.heartbeat,data:L.createHeartbeat(L.HeartbeatMessageType.heartbeat_response,s)})),L.flush(t)}else if(n===L.HeartbeatMessageType.heartbeat_response){if(s!==t.expectedHeartbeatPayload)return t.process();t.heartbeatReceived&&t.heartbeatReceived(t,Se.util.createBuffer(s))}t.process()};var Kqe=0,Yqe=1,Ype=2,Qqe=3,Xqe=4,Xpe=5,Jqe=6,Zqe=7,eHe=8,tHe=0,rHe=1,FG=2,nHe=3,UG=4,iHe=5,oHe=6,D=L.handleUnexpected,Jpe=L.handleChangeCipherSpec,os=L.handleAlert,oa=L.handleHandshake,Zpe=L.handleApplicationData,ss=L.handleHeartbeat,BG=[];BG[L.ConnectionEnd.client]=[[D,os,oa,D,ss],[D,os,oa,D,ss],[D,os,oa,D,ss],[D,os,oa,D,ss],[D,os,oa,D,ss],[Jpe,os,D,D,ss],[D,os,oa,D,ss],[D,os,oa,Zpe,ss],[D,os,oa,D,ss]];BG[L.ConnectionEnd.server]=[[D,os,oa,D,ss],[D,os,oa,D,ss],[D,os,oa,D,ss],[D,os,oa,D,ss],[Jpe,os,D,D,ss],[D,os,oa,D,ss],[D,os,oa,Zpe,ss],[D,os,oa,D,ss]];var Tg=L.handleHelloRequest,sHe=L.handleServerHello,efe=L.handleCertificate,Qpe=L.handleServerKeyExchange,OG=L.handleCertificateRequest,m3=L.handleServerHelloDone,tfe=L.handleFinished,g3=[];g3[L.ConnectionEnd.client]=[[D,D,sHe,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D],[Tg,D,D,D,D,D,D,D,D,D,D,efe,Qpe,OG,m3,D,D,D,D,D,D],[Tg,D,D,D,D,D,D,D,D,D,D,D,Qpe,OG,m3,D,D,D,D,D,D],[Tg,D,D,D,D,D,D,D,D,D,D,D,D,OG,m3,D,D,D,D,D,D],[Tg,D,D,D,D,D,D,D,D,D,D,D,D,D,m3,D,D,D,D,D,D],[Tg,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D],[Tg,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,tfe],[Tg,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D],[Tg,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D]];var aHe=L.handleClientHello,cHe=L.handleClientKeyExchange,uHe=L.handleCertificateVerify;g3[L.ConnectionEnd.server]=[[D,aHe,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D],[D,D,D,D,D,D,D,D,D,D,D,efe,D,D,D,D,D,D,D,D,D],[D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,cHe,D,D,D,D],[D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,uHe,D,D,D,D,D],[D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D],[D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,tfe],[D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D],[D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D,D]];L.generateKeys=function(t,e){var r=v3,n=e.client_random+e.server_random;t.session.resuming||(e.master_secret=r(e.pre_master_secret,"master secret",n,48).bytes(),e.pre_master_secret=null),n=e.server_random+e.client_random;var o=2*e.mac_key_length+2*e.enc_key_length,s=t.version.major===L.Versions.TLS_1_0.major&&t.version.minor===L.Versions.TLS_1_0.minor;s&&(o+=2*e.fixed_iv_length);var a=r(e.master_secret,"key expansion",n,o),c={client_write_MAC_key:a.getBytes(e.mac_key_length),server_write_MAC_key:a.getBytes(e.mac_key_length),client_write_key:a.getBytes(e.enc_key_length),server_write_key:a.getBytes(e.enc_key_length)};return s&&(c.client_write_IV=a.getBytes(e.fixed_iv_length),c.server_write_IV=a.getBytes(e.fixed_iv_length)),c};L.createConnectionState=function(t){var e=t.entity===L.ConnectionEnd.client,r=function(){var s={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(a){return!0},compressionState:null,compressFunction:function(a){return!0},updateSequenceNumber:function(){s.sequenceNumber[1]===4294967295?(s.sequenceNumber[1]=0,++s.sequenceNumber[0]):++s.sequenceNumber[1]}};return s},n={read:r(),write:r()};if(n.read.update=function(s,a){return n.read.cipherFunction(a,n.read)?n.read.compressFunction(s,a,n.read)||s.error(s,{message:"Could not decompress record.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.decompression_failure}}):s.error(s,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.bad_record_mac}}),!s.fail},n.write.update=function(s,a){return n.write.compressFunction(s,a,n.write)?n.write.cipherFunction(a,n.write)||s.error(s,{message:"Could not encrypt record.",send:!1,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.internal_error}}):s.error(s,{message:"Could not compress record.",send:!1,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.internal_error}}),!s.fail},t.session){var o=t.session.sp;switch(t.session.cipherSuite.initSecurityParameters(o),o.keys=L.generateKeys(t,o),n.read.macKey=e?o.keys.server_write_MAC_key:o.keys.client_write_MAC_key,n.write.macKey=e?o.keys.client_write_MAC_key:o.keys.server_write_MAC_key,t.session.cipherSuite.initConnectionState(n,t,o),o.compression_algorithm){case L.CompressionMethod.none:break;case L.CompressionMethod.deflate:n.read.compressFunction=Wqe,n.write.compressFunction=$qe;break;default:throw new Error("Unsupported compression algorithm.")}}return n};L.createRandom=function(){var t=new Date,e=+t+t.getTimezoneOffset()*6e4,r=Se.util.createBuffer();return r.putInt32(e),r.putBytes(Se.random.getBytes(28)),r};L.createRecord=function(t,e){if(!e.data)return null;var r={type:e.type,version:{major:t.version.major,minor:t.version.minor},length:e.data.length(),fragment:e.data};return r};L.createAlert=function(t,e){var r=Se.util.createBuffer();return r.putByte(e.level),r.putByte(e.description),L.createRecord(t,{type:L.ContentType.alert,data:r})};L.createClientHello=function(t){t.session.clientHelloVersion={major:t.version.major,minor:t.version.minor};for(var e=Se.util.createBuffer(),r=0;r<t.cipherSuites.length;++r){var n=t.cipherSuites[r];e.putByte(n.id[0]),e.putByte(n.id[1])}var o=e.length(),s=Se.util.createBuffer();s.putByte(L.CompressionMethod.none);var a=s.length(),c=Se.util.createBuffer();if(t.virtualHost){var u=Se.util.createBuffer();u.putByte(0),u.putByte(0);var l=Se.util.createBuffer();l.putByte(0),_u(l,2,Se.util.createBuffer(t.virtualHost));var d=Se.util.createBuffer();_u(d,2,l),_u(u,2,d),c.putBuffer(u)}var p=c.length();p>0&&(p+=2);var f=t.session.id,m=f.length+1+2+4+28+2+o+1+a+p,h=Se.util.createBuffer();return h.putByte(L.HandshakeType.client_hello),h.putInt24(m),h.putByte(t.version.major),h.putByte(t.version.minor),h.putBytes(t.session.sp.client_random),_u(h,1,Se.util.createBuffer(f)),_u(h,2,e),_u(h,1,s),p>0&&_u(h,2,c),h};L.createServerHello=function(t){var e=t.session.id,r=e.length+1+2+4+28+2+1,n=Se.util.createBuffer();return n.putByte(L.HandshakeType.server_hello),n.putInt24(r),n.putByte(t.version.major),n.putByte(t.version.minor),n.putBytes(t.session.sp.server_random),_u(n,1,Se.util.createBuffer(e)),n.putByte(t.session.cipherSuite.id[0]),n.putByte(t.session.cipherSuite.id[1]),n.putByte(t.session.compressionMethod),n};L.createCertificate=function(t){var e=t.entity===L.ConnectionEnd.client,r=null;if(t.getCertificate){var n;e?n=t.session.certificateRequest:n=t.session.extensions.server_name.serverNameList,r=t.getCertificate(t,n)}var o=Se.util.createBuffer();if(r!==null)try{Se.util.isArray(r)||(r=[r]);for(var s=null,a=0;a<r.length;++a){var c=Se.pem.decode(r[a])[0];if(c.type!=="CERTIFICATE"&&c.type!=="X509 CERTIFICATE"&&c.type!=="TRUSTED CERTIFICATE"){var u=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw u.headerType=c.type,u}if(c.procType&&c.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var l=Se.util.createBuffer(c.body);s===null&&(s=Se.asn1.fromDer(l.bytes(),!1));var d=Se.util.createBuffer();_u(d,3,l),o.putBuffer(d)}r=Se.pki.certificateFromAsn1(s),e?t.session.clientCertificate=r:t.session.serverCertificate=r}catch(m){return t.error(t,{message:"Could not send certificate list.",cause:m,send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.bad_certificate}})}var p=3+o.length(),f=Se.util.createBuffer();return f.putByte(L.HandshakeType.certificate),f.putInt24(p),_u(f,3,o),f};L.createClientKeyExchange=function(t){var e=Se.util.createBuffer();e.putByte(t.session.clientHelloVersion.major),e.putByte(t.session.clientHelloVersion.minor),e.putBytes(Se.random.getBytes(46));var r=t.session.sp;r.pre_master_secret=e.getBytes();var n=t.session.serverCertificate.publicKey;e=n.encrypt(r.pre_master_secret);var o=e.length+2,s=Se.util.createBuffer();return s.putByte(L.HandshakeType.client_key_exchange),s.putInt24(o),s.putInt16(e.length),s.putBytes(e),s};L.createServerKeyExchange=function(t){var e=0,r=Se.util.createBuffer();return e>0&&(r.putByte(L.HandshakeType.server_key_exchange),r.putInt24(e)),r};L.getClientSignature=function(t,e){var r=Se.util.createBuffer();r.putBuffer(t.session.md5.digest()),r.putBuffer(t.session.sha1.digest()),r=r.getBytes(),t.getSignature=t.getSignature||function(n,o,s){var a=null;if(n.getPrivateKey)try{a=n.getPrivateKey(n,n.session.clientCertificate),a=Se.pki.privateKeyFromPem(a)}catch(c){n.error(n,{message:"Could not get private key.",cause:c,send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.internal_error}})}a===null?n.error(n,{message:"No private key set.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.internal_error}}):o=a.sign(o,null),s(n,o)},t.getSignature(t,r,e)};L.createCertificateVerify=function(t,e){var r=e.length+2,n=Se.util.createBuffer();return n.putByte(L.HandshakeType.certificate_verify),n.putInt24(r),n.putInt16(e.length),n.putBytes(e),n};L.createCertificateRequest=function(t){var e=Se.util.createBuffer();e.putByte(1);var r=Se.util.createBuffer();for(var n in t.caStore.certs){var o=t.caStore.certs[n],s=Se.pki.distinguishedNameToAsn1(o.subject),a=Se.asn1.toDer(s);r.putInt16(a.length()),r.putBuffer(a)}var c=1+e.length()+2+r.length(),u=Se.util.createBuffer();return u.putByte(L.HandshakeType.certificate_request),u.putInt24(c),_u(u,1,e),_u(u,2,r),u};L.createServerHelloDone=function(t){var e=Se.util.createBuffer();return e.putByte(L.HandshakeType.server_hello_done),e.putInt24(0),e};L.createChangeCipherSpec=function(){var t=Se.util.createBuffer();return t.putByte(1),t};L.createFinished=function(t){var e=Se.util.createBuffer();e.putBuffer(t.session.md5.digest()),e.putBuffer(t.session.sha1.digest());var r=t.entity===L.ConnectionEnd.client,n=t.session.sp,o=12,s=v3,a=r?"client finished":"server finished";e=s(n.master_secret,a,e.getBytes(),o);var c=Se.util.createBuffer();return c.putByte(L.HandshakeType.finished),c.putInt24(e.length()),c.putBuffer(e),c};L.createHeartbeat=function(t,e,r){typeof r>"u"&&(r=e.length);var n=Se.util.createBuffer();n.putByte(t),n.putInt16(r),n.putBytes(e);var o=n.length(),s=Math.max(16,o-r-3);return n.putBytes(Se.random.getBytes(s)),n};L.queue=function(t,e){if(e&&!(e.fragment.length()===0&&(e.type===L.ContentType.handshake||e.type===L.ContentType.alert||e.type===L.ContentType.change_cipher_spec))){if(e.type===L.ContentType.handshake){var r=e.fragment.bytes();t.session.md5.update(r),t.session.sha1.update(r),r=null}var n;if(e.fragment.length()<=L.MaxFragment)n=[e];else{n=[];for(var o=e.fragment.bytes();o.length>L.MaxFragment;)n.push(L.createRecord(t,{type:e.type,data:Se.util.createBuffer(o.slice(0,L.MaxFragment))})),o=o.slice(L.MaxFragment);o.length>0&&n.push(L.createRecord(t,{type:e.type,data:Se.util.createBuffer(o)}))}for(var s=0;s<n.length&&!t.fail;++s){var a=n[s],c=t.state.current.write;c.update(t,a)&&t.records.push(a)}}};L.flush=function(t){for(var e=0;e<t.records.length;++e){var r=t.records[e];t.tlsData.putByte(r.type),t.tlsData.putByte(r.version.major),t.tlsData.putByte(r.version.minor),t.tlsData.putInt16(r.fragment.length()),t.tlsData.putBuffer(t.records[e].fragment)}return t.records=[],t.tlsDataReady(t)};var MG=function(t){switch(t){case!0:return!0;case Se.pki.certificateError.bad_certificate:return L.Alert.Description.bad_certificate;case Se.pki.certificateError.unsupported_certificate:return L.Alert.Description.unsupported_certificate;case Se.pki.certificateError.certificate_revoked:return L.Alert.Description.certificate_revoked;case Se.pki.certificateError.certificate_expired:return L.Alert.Description.certificate_expired;case Se.pki.certificateError.certificate_unknown:return L.Alert.Description.certificate_unknown;case Se.pki.certificateError.unknown_ca:return L.Alert.Description.unknown_ca;default:return L.Alert.Description.bad_certificate}},lHe=function(t){switch(t){case!0:return!0;case L.Alert.Description.bad_certificate:return Se.pki.certificateError.bad_certificate;case L.Alert.Description.unsupported_certificate:return Se.pki.certificateError.unsupported_certificate;case L.Alert.Description.certificate_revoked:return Se.pki.certificateError.certificate_revoked;case L.Alert.Description.certificate_expired:return Se.pki.certificateError.certificate_expired;case L.Alert.Description.certificate_unknown:return Se.pki.certificateError.certificate_unknown;case L.Alert.Description.unknown_ca:return Se.pki.certificateError.unknown_ca;default:return Se.pki.certificateError.bad_certificate}};L.verifyCertificateChain=function(t,e){try{var r={};for(var n in t.verifyOptions)r[n]=t.verifyOptions[n];r.verify=function(s,a,c){var u=MG(s),l=t.verify(t,s,a,c);if(l!==!0){if(typeof l=="object"&&!Se.util.isArray(l)){var d=new Error("The application rejected the certificate.");throw d.send=!0,d.alert={level:L.Alert.Level.fatal,description:L.Alert.Description.bad_certificate},l.message&&(d.message=l.message),l.alert&&(d.alert.description=l.alert),d}l!==s&&(l=lHe(l))}return l},Se.pki.verifyCertificateChain(t.caStore,e,r)}catch(s){var o=s;(typeof o!="object"||Se.util.isArray(o))&&(o={send:!0,alert:{level:L.Alert.Level.fatal,description:MG(s)}}),"send"in o||(o.send=!0),"alert"in o||(o.alert={level:L.Alert.Level.fatal,description:MG(o.error)}),t.error(t,o)}return!t.fail};L.createSessionCache=function(t,e){var r=null;if(t&&t.getSession&&t.setSession&&t.order)r=t;else{r={},r.cache=t||{},r.capacity=Math.max(e||100,1),r.order=[];for(var n in t)r.order.length<=e?r.order.push(n):delete t[n];r.getSession=function(o){var s=null,a=null;if(o?a=Se.util.bytesToHex(o):r.order.length>0&&(a=r.order[0]),a!==null&&a in r.cache){s=r.cache[a],delete r.cache[a];for(var c in r.order)if(r.order[c]===a){r.order.splice(c,1);break}}return s},r.setSession=function(o,s){if(r.order.length===r.capacity){var a=r.order.shift();delete r.cache[a]}var a=Se.util.bytesToHex(o);r.order.push(a),r.cache[a]=s}}return r};L.createConnection=function(t){var e=null;t.caStore?Se.util.isArray(t.caStore)?e=Se.pki.createCaStore(t.caStore):e=t.caStore:e=Se.pki.createCaStore();var r=t.cipherSuites||null;if(r===null){r=[];for(var n in L.CipherSuites)r.push(L.CipherSuites[n])}var o=t.server?L.ConnectionEnd.server:L.ConnectionEnd.client,s=t.sessionCache?L.createSessionCache(t.sessionCache):null,a={version:{major:L.Version.major,minor:L.Version.minor},entity:o,sessionId:t.sessionId,caStore:e,sessionCache:s,cipherSuites:r,connected:t.connected,virtualHost:t.virtualHost||null,verifyClient:t.verifyClient||!1,verify:t.verify||function(d,p,f,m){return p},verifyOptions:t.verifyOptions||{},getCertificate:t.getCertificate||null,getPrivateKey:t.getPrivateKey||null,getSignature:t.getSignature||null,input:Se.util.createBuffer(),tlsData:Se.util.createBuffer(),data:Se.util.createBuffer(),tlsDataReady:t.tlsDataReady,dataReady:t.dataReady,heartbeatReceived:t.heartbeatReceived,closed:t.closed,error:function(d,p){p.origin=p.origin||(d.entity===L.ConnectionEnd.client?"client":"server"),p.send&&(L.queue(d,L.createAlert(d,p.alert)),L.flush(d));var f=p.fatal!==!1;f&&(d.fail=!0),t.error(d,p),f&&d.close(!1)},deflate:t.deflate||null,inflate:t.inflate||null};a.reset=function(d){a.version={major:L.Version.major,minor:L.Version.minor},a.record=null,a.session=null,a.peerCertificate=null,a.state={pending:null,current:null},a.expect=a.entity===L.ConnectionEnd.client?Kqe:tHe,a.fragmented=null,a.records=[],a.open=!1,a.handshakes=0,a.handshaking=!1,a.isConnected=!1,a.fail=!(d||typeof d>"u"),a.input.clear(),a.tlsData.clear(),a.data.clear(),a.state.current=L.createConnectionState(a)},a.reset();var c=function(d,p){var f=p.type-L.ContentType.change_cipher_spec,m=BG[d.entity][d.expect];f in m?m[f](d,p):L.handleUnexpected(d,p)},u=function(d){var p=0,f=d.input,m=f.length();if(m<5)p=5-m;else{d.record={type:f.getByte(),version:{major:f.getByte(),minor:f.getByte()},length:f.getInt16(),fragment:Se.util.createBuffer(),ready:!1};var h=d.record.version.major===d.version.major;h&&d.session&&d.session.version&&(h=d.record.version.minor===d.version.minor),h||d.error(d,{message:"Incompatible TLS version.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.protocol_version}})}return p},l=function(d){var p=0,f=d.input,m=f.length();if(m<d.record.length)p=d.record.length-m;else{d.record.fragment.putBytes(f.getBytes(d.record.length)),f.compact();var h=d.state.current.read;h.update(d,d.record)&&(d.fragmented!==null&&(d.fragmented.type===d.record.type?(d.fragmented.fragment.putBuffer(d.record.fragment),d.record=d.fragmented):d.error(d,{message:"Invalid fragmented record.",send:!0,alert:{level:L.Alert.Level.fatal,description:L.Alert.Description.unexpected_message}})),d.record.ready=!0)}return p};return a.handshake=function(d){if(a.entity!==L.ConnectionEnd.client)a.error(a,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(a.handshaking)a.error(a,{message:"Handshake already in progress.",fatal:!1});else{a.fail&&!a.open&&a.handshakes===0&&(a.fail=!1),a.handshaking=!0,d=d||"";var p=null;d.length>0&&(a.sessionCache&&(p=a.sessionCache.getSession(d)),p===null&&(d="")),d.length===0&&a.sessionCache&&(p=a.sessionCache.getSession(),p!==null&&(d=p.id)),a.session={id:d,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:Se.md.md5.create(),sha1:Se.md.sha1.create()},p&&(a.version=p.version,a.session.sp=p.sp),a.session.sp.client_random=L.createRandom().getBytes(),a.open=!0,L.queue(a,L.createRecord(a,{type:L.ContentType.handshake,data:L.createClientHello(a)})),L.flush(a)}},a.process=function(d){var p=0;return d&&a.input.putBytes(d),a.fail||(a.record!==null&&a.record.ready&&a.record.fragment.isEmpty()&&(a.record=null),a.record===null&&(p=u(a)),!a.fail&&a.record!==null&&!a.record.ready&&(p=l(a)),!a.fail&&a.record!==null&&a.record.ready&&c(a,a.record)),p},a.prepare=function(d){return L.queue(a,L.createRecord(a,{type:L.ContentType.application_data,data:Se.util.createBuffer(d)})),L.flush(a)},a.prepareHeartbeatRequest=function(d,p){return d instanceof Se.util.ByteBuffer&&(d=d.bytes()),typeof p>"u"&&(p=d.length),a.expectedHeartbeatPayload=d,L.queue(a,L.createRecord(a,{type:L.ContentType.heartbeat,data:L.createHeartbeat(L.HeartbeatMessageType.heartbeat_request,d,p)})),L.flush(a)},a.close=function(d){if(!a.fail&&a.sessionCache&&a.session){var p={id:a.session.id,version:a.session.version,sp:a.session.sp};p.sp.keys=null,a.sessionCache.setSession(p.id,p)}a.open&&(a.open=!1,a.input.clear(),(a.isConnected||a.handshaking)&&(a.isConnected=a.handshaking=!1,L.queue(a,L.createAlert(a,{level:L.Alert.Level.warning,description:L.Alert.Description.close_notify})),L.flush(a)),a.closed(a)),a.reset(d)},a};rfe.exports=Se.tls=Se.tls||{};for(h3 in L)typeof L[h3]!="function"&&(Se.tls[h3]=L[h3]);var h3;Se.tls.prf_tls1=v3;Se.tls.hmac_sha1=zqe;Se.tls.createSessionCache=L.createSessionCache;Se.tls.createConnection=L.createConnection});var ofe=M((Vir,ife)=>{var wg=rr();_g();qG();var xu=ife.exports=wg.tls;xu.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(t){t.bulk_cipher_algorithm=xu.BulkCipherAlgorithm.aes,t.cipher_type=xu.CipherType.block,t.enc_key_length=16,t.block_length=16,t.fixed_iv_length=16,t.record_iv_length=16,t.mac_algorithm=xu.MACAlgorithm.hmac_sha1,t.mac_length=20,t.mac_key_length=20},initConnectionState:nfe};xu.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(t){t.bulk_cipher_algorithm=xu.BulkCipherAlgorithm.aes,t.cipher_type=xu.CipherType.block,t.enc_key_length=32,t.block_length=16,t.fixed_iv_length=16,t.record_iv_length=16,t.mac_algorithm=xu.MACAlgorithm.hmac_sha1,t.mac_length=20,t.mac_key_length=20},initConnectionState:nfe};function nfe(t,e,r){var n=e.entity===wg.tls.ConnectionEnd.client;t.read.cipherState={init:!1,cipher:wg.cipher.createDecipher("AES-CBC",n?r.keys.server_write_key:r.keys.client_write_key),iv:n?r.keys.server_write_IV:r.keys.client_write_IV},t.write.cipherState={init:!1,cipher:wg.cipher.createCipher("AES-CBC",n?r.keys.client_write_key:r.keys.server_write_key),iv:n?r.keys.client_write_IV:r.keys.server_write_IV},t.read.cipherFunction=mHe,t.write.cipherFunction=dHe,t.read.macLength=t.write.macLength=r.mac_length,t.read.macFunction=t.write.macFunction=xu.hmac_sha1}function dHe(t,e){var r=!1,n=e.macFunction(e.macKey,e.sequenceNumber,t);t.fragment.putBytes(n),e.updateSequenceNumber();var o;t.version.minor===xu.Versions.TLS_1_0.minor?o=e.cipherState.init?null:e.cipherState.iv:o=wg.random.getBytesSync(16),e.cipherState.init=!0;var s=e.cipherState.cipher;return s.start({iv:o}),t.version.minor>=xu.Versions.TLS_1_1.minor&&s.output.putBytes(o),s.update(t.fragment),s.finish(pHe)&&(t.fragment=s.output,t.length=t.fragment.length(),r=!0),r}function pHe(t,e,r){if(!r){var n=t-e.length()%t;e.fillWithByte(n-1,n)}return!0}function fHe(t,e,r){var n=!0;if(r){for(var o=e.length(),s=e.last(),a=o-1-s;a<o-1;++a)n=n&&e.at(a)==s;n&&e.truncate(s+1)}return n}function mHe(t,e){var r=!1,n;t.version.minor===xu.Versions.TLS_1_0.minor?n=e.cipherState.init?null:e.cipherState.iv:n=t.fragment.getBytes(16),e.cipherState.init=!0;var o=e.cipherState.cipher;o.start({iv:n}),o.update(t.fragment),r=o.finish(fHe);var s=e.macLength,a=wg.random.getBytesSync(s),c=o.output.length();c>=s?(t.fragment=o.output.getBytes(c-s),a=o.output.getBytes(s)):t.fragment=o.output.getBytes(),t.fragment=wg.util.createBuffer(t.fragment),t.length=t.fragment.length();var u=e.macFunction(e.macKey,e.sequenceNumber,t);return e.updateSequenceNumber(),r=hHe(e.macKey,a,u)&&r,r}function hHe(t,e,r){var n=wg.hmac.create();return n.start("SHA1",t),n.update(e),e=n.digest().getBytes(),n.start(null,null),n.update(r),r=n.digest().getBytes(),e===r}});var VG=M((Gir,ufe)=>{var qn=rr();Ad();Lr();var dk=ufe.exports=qn.sha512=qn.sha512||{};qn.md.sha512=qn.md.algorithms.sha512=dk;var afe=qn.sha384=qn.sha512.sha384=qn.sha512.sha384||{};afe.create=function(){return dk.create("SHA-384")};qn.md.sha384=qn.md.algorithms.sha384=afe;qn.sha512.sha256=qn.sha512.sha256||{create:function(){return dk.create("SHA-512/256")}};qn.md["sha512/256"]=qn.md.algorithms["sha512/256"]=qn.sha512.sha256;qn.sha512.sha224=qn.sha512.sha224||{create:function(){return dk.create("SHA-512/224")}};qn.md["sha512/224"]=qn.md.algorithms["sha512/224"]=qn.sha512.sha224;dk.create=function(t){if(cfe||gHe(),typeof t>"u"&&(t="SHA-512"),!(t in Ey))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=Ey[t],r=null,n=qn.util.createBuffer(),o=new Array(80),s=0;s<80;++s)o[s]=new Array(2);var a=64;switch(t){case"SHA-384":a=48;break;case"SHA-512/256":a=32;break;case"SHA-512/224":a=28;break}var c={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:a,messageLength:0,fullMessageLength:null,messageLengthSize:16};return c.start=function(){c.messageLength=0,c.fullMessageLength=c.messageLength128=[];for(var u=c.messageLengthSize/4,l=0;l<u;++l)c.fullMessageLength.push(0);n=qn.util.createBuffer(),r=new Array(e.length);for(var l=0;l<e.length;++l)r[l]=e[l].slice(0);return c},c.start(),c.update=function(u,l){l==="utf8"&&(u=qn.util.encodeUtf8(u));var d=u.length;c.messageLength+=d,d=[d/4294967296>>>0,d>>>0];for(var p=c.fullMessageLength.length-1;p>=0;--p)c.fullMessageLength[p]+=d[1],d[1]=d[0]+(c.fullMessageLength[p]/4294967296>>>0),c.fullMessageLength[p]=c.fullMessageLength[p]>>>0,d[0]=d[1]/4294967296>>>0;return n.putBytes(u),sfe(r,o,n),(n.read>2048||n.length()===0)&&n.compact(),c},c.digest=function(){var u=qn.util.createBuffer();u.putBytes(n.bytes());var l=c.fullMessageLength[c.fullMessageLength.length-1]+c.messageLengthSize,d=l&c.blockLength-1;u.putBytes(HG.substr(0,c.blockLength-d));for(var p,f,m=c.fullMessageLength[0]*8,h=0;h<c.fullMessageLength.length-1;++h)p=c.fullMessageLength[h+1]*8,f=p/4294967296>>>0,m+=f,u.putInt32(m>>>0),m=p>>>0;u.putInt32(m);for(var g=new Array(r.length),h=0;h<r.length;++h)g[h]=r[h].slice(0);sfe(g,o,u);var v=qn.util.createBuffer(),y;t==="SHA-512"?y=g.length:t==="SHA-384"?y=g.length-2:y=g.length-4;for(var h=0;h<y;++h)v.putInt32(g[h][0]),(h!==y-1||t!=="SHA-512/224")&&v.putInt32(g[h][1]);return v},c};var HG=null,cfe=!1,jG=null,Ey=null;function gHe(){HG="\x80",HG+=qn.util.fillString("\0",128),jG=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Ey={},Ey["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Ey["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Ey["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Ey["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],cfe=!0}function sfe(t,e,r){for(var n,o,s,a,c,u,l,d,p,f,m,h,g,v,y,b,_,S,I,T,A,B,j,F,ne,Y,N,w,P,q,U,Z,le,re,X,Ve=r.length();Ve>=128;){for(P=0;P<16;++P)e[P][0]=r.getInt32()>>>0,e[P][1]=r.getInt32()>>>0;for(;P<80;++P)Z=e[P-2],q=Z[0],U=Z[1],n=((q>>>19|U<<13)^(U>>>29|q<<3)^q>>>6)>>>0,o=((q<<13|U>>>19)^(U<<3|q>>>29)^(q<<26|U>>>6))>>>0,re=e[P-15],q=re[0],U=re[1],s=((q>>>1|U<<31)^(q>>>8|U<<24)^q>>>7)>>>0,a=((q<<31|U>>>1)^(q<<24|U>>>8)^(q<<25|U>>>7))>>>0,le=e[P-7],X=e[P-16],U=o+le[1]+a+X[1],e[P][0]=n+le[0]+s+X[0]+(U/4294967296>>>0)>>>0,e[P][1]=U>>>0;for(g=t[0][0],v=t[0][1],y=t[1][0],b=t[1][1],_=t[2][0],S=t[2][1],I=t[3][0],T=t[3][1],A=t[4][0],B=t[4][1],j=t[5][0],F=t[5][1],ne=t[6][0],Y=t[6][1],N=t[7][0],w=t[7][1],P=0;P<80;++P)l=((A>>>14|B<<18)^(A>>>18|B<<14)^(B>>>9|A<<23))>>>0,d=((A<<18|B>>>14)^(A<<14|B>>>18)^(B<<23|A>>>9))>>>0,p=(ne^A&(j^ne))>>>0,f=(Y^B&(F^Y))>>>0,c=((g>>>28|v<<4)^(v>>>2|g<<30)^(v>>>7|g<<25))>>>0,u=((g<<4|v>>>28)^(v<<30|g>>>2)^(v<<25|g>>>7))>>>0,m=(g&y|_&(g^y))>>>0,h=(v&b|S&(v^b))>>>0,U=w+d+f+jG[P][1]+e[P][1],n=N+l+p+jG[P][0]+e[P][0]+(U/4294967296>>>0)>>>0,o=U>>>0,U=u+h,s=c+m+(U/4294967296>>>0)>>>0,a=U>>>0,N=ne,w=Y,ne=j,Y=F,j=A,F=B,U=T+o,A=I+n+(U/4294967296>>>0)>>>0,B=U>>>0,I=_,T=S,_=y,S=b,y=g,b=v,U=o+a,g=n+s+(U/4294967296>>>0)>>>0,v=U>>>0;U=t[0][1]+v,t[0][0]=t[0][0]+g+(U/4294967296>>>0)>>>0,t[0][1]=U>>>0,U=t[1][1]+b,t[1][0]=t[1][0]+y+(U/4294967296>>>0)>>>0,t[1][1]=U>>>0,U=t[2][1]+S,t[2][0]=t[2][0]+_+(U/4294967296>>>0)>>>0,t[2][1]=U>>>0,U=t[3][1]+T,t[3][0]=t[3][0]+I+(U/4294967296>>>0)>>>0,t[3][1]=U>>>0,U=t[4][1]+B,t[4][0]=t[4][0]+A+(U/4294967296>>>0)>>>0,t[4][1]=U>>>0,U=t[5][1]+F,t[5][0]=t[5][0]+j+(U/4294967296>>>0)>>>0,t[5][1]=U>>>0,U=t[6][1]+Y,t[6][0]=t[6][0]+ne+(U/4294967296>>>0)>>>0,t[6][1]=U>>>0,U=t[7][1]+w,t[7][0]=t[7][0]+N+(U/4294967296>>>0)>>>0,t[7][1]=U>>>0,Ve-=128}}});var lfe=M(GG=>{var vHe=rr();Tl();var zo=vHe.asn1;GG.privateKeyValidator={name:"PrivateKeyInfo",tagClass:zo.Class.UNIVERSAL,type:zo.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:zo.Class.UNIVERSAL,type:zo.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:zo.Class.UNIVERSAL,type:zo.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:zo.Class.UNIVERSAL,type:zo.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:zo.Class.UNIVERSAL,type:zo.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};GG.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:zo.Class.UNIVERSAL,type:zo.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:zo.Class.UNIVERSAL,type:zo.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:zo.Class.UNIVERSAL,type:zo.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:zo.Class.UNIVERSAL,type:zo.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var Ife=M(($ir,Sfe)=>{var as=rr();ak();gu();VG();Lr();var gfe=lfe(),yHe=gfe.publicKeyValidator,bHe=gfe.privateKeyValidator;typeof dfe>"u"&&(dfe=as.jsbn.BigInteger);var dfe,WG=as.util.ByteBuffer,Oa=typeof Buffer>"u"?Uint8Array:Buffer;as.pki=as.pki||{};Sfe.exports=as.pki.ed25519=as.ed25519=as.ed25519||{};var hr=as.ed25519;hr.constants={};hr.constants.PUBLIC_KEY_BYTE_LENGTH=32;hr.constants.PRIVATE_KEY_BYTE_LENGTH=64;hr.constants.SEED_BYTE_LENGTH=32;hr.constants.SIGN_BYTE_LENGTH=64;hr.constants.HASH_BYTE_LENGTH=64;hr.generateKeyPair=function(t){t=t||{};var e=t.seed;if(e===void 0)e=as.random.getBytesSync(hr.constants.SEED_BYTE_LENGTH);else if(typeof e=="string"){if(e.length!==hr.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+hr.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');e=Of({message:e,encoding:"binary"});for(var r=new Oa(hr.constants.PUBLIC_KEY_BYTE_LENGTH),n=new Oa(hr.constants.PRIVATE_KEY_BYTE_LENGTH),o=0;o<32;++o)n[o]=e[o];return IHe(r,n),{publicKey:r,privateKey:n}};hr.privateKeyFromAsn1=function(t){var e={},r=[],n=as.asn1.validate(t,bHe,e,r);if(!n){var o=new Error("Invalid Key.");throw o.errors=r,o}var s=as.asn1.derToOid(e.privateKeyOid),a=as.oids.EdDSA25519;if(s!==a)throw new Error('Invalid OID "'+s+'"; OID must be "'+a+'".');var c=e.privateKey,u=Of({message:as.asn1.fromDer(c).value,encoding:"binary"});return{privateKeyBytes:u}};hr.publicKeyFromAsn1=function(t){var e={},r=[],n=as.asn1.validate(t,yHe,e,r);if(!n){var o=new Error("Invalid Key.");throw o.errors=r,o}var s=as.asn1.derToOid(e.publicKeyOid),a=as.oids.EdDSA25519;if(s!==a)throw new Error('Invalid OID "'+s+'"; OID must be "'+a+'".');var c=e.ed25519PublicKey;if(c.length!==hr.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return Of({message:c,encoding:"binary"})};hr.publicKeyFromPrivateKey=function(t){t=t||{};var e=Of({message:t.privateKey,encoding:"binary"});if(e.length!==hr.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+hr.constants.PRIVATE_KEY_BYTE_LENGTH);for(var r=new Oa(hr.constants.PUBLIC_KEY_BYTE_LENGTH),n=0;n<r.length;++n)r[n]=e[32+n];return r};hr.sign=function(t){t=t||{};var e=Of(t),r=Of({message:t.privateKey,encoding:"binary"});if(r.length===hr.constants.SEED_BYTE_LENGTH){var n=hr.generateKeyPair({seed:r});r=n.privateKey}else if(r.length!==hr.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+hr.constants.SEED_BYTE_LENGTH+" or "+hr.constants.PRIVATE_KEY_BYTE_LENGTH);var o=new Oa(hr.constants.SIGN_BYTE_LENGTH+e.length);CHe(o,e,e.length,r);for(var s=new Oa(hr.constants.SIGN_BYTE_LENGTH),a=0;a<s.length;++a)s[a]=o[a];return s};hr.verify=function(t){t=t||{};var e=Of(t);if(t.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var r=Of({message:t.signature,encoding:"binary"});if(r.length!==hr.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+hr.constants.SIGN_BYTE_LENGTH);var n=Of({message:t.publicKey,encoding:"binary"});if(n.length!==hr.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+hr.constants.PUBLIC_KEY_BYTE_LENGTH);var o=new Oa(hr.constants.SIGN_BYTE_LENGTH+e.length),s=new Oa(hr.constants.SIGN_BYTE_LENGTH+e.length),a;for(a=0;a<hr.constants.SIGN_BYTE_LENGTH;++a)o[a]=r[a];for(a=0;a<e.length;++a)o[a+hr.constants.SIGN_BYTE_LENGTH]=e[a];return EHe(s,o,o.length,n)>=0};function Of(t){var e=t.message;if(e instanceof Uint8Array||e instanceof Oa)return e;var r=t.encoding;if(e===void 0)if(t.md)e=t.md.digest().getBytes(),r="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof e=="string"&&!r)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.from(e,r);e=new WG(e,r)}else if(!(e instanceof WG))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');for(var n=new Oa(e.length()),o=0;o<n.length;++o)n[o]=e.at(o);return n}var KG=wt(),y3=wt([1]),_He=wt([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),xHe=wt([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),pfe=wt([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),ffe=wt([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),zG=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),SHe=wt([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function pk(t,e){var r=as.md.sha512.create(),n=new WG(t);r.update(n.getBytes(e),"binary");var o=r.digest().getBytes();if(typeof Buffer<"u")return Buffer.from(o,"binary");for(var s=new Oa(hr.constants.HASH_BYTE_LENGTH),a=0;a<64;++a)s[a]=o.charCodeAt(a);return s}function IHe(t,e){var r=[wt(),wt(),wt(),wt()],n,o=pk(e,32);for(o[0]&=248,o[31]&=127,o[31]|=64,JG(r,o),XG(t,r),n=0;n<32;++n)e[n+32]=t[n];return 0}function CHe(t,e,r,n){var o,s,a=new Float64Array(64),c=[wt(),wt(),wt(),wt()],u=pk(n,32);u[0]&=248,u[31]&=127,u[31]|=64;var l=r+64;for(o=0;o<r;++o)t[64+o]=e[o];for(o=0;o<32;++o)t[32+o]=u[32+o];var d=pk(t.subarray(32),r+32);for(YG(d),JG(c,d),XG(t,c),o=32;o<64;++o)t[o]=n[o];var p=pk(t,r+64);for(YG(p),o=32;o<64;++o)a[o]=0;for(o=0;o<32;++o)a[o]=d[o];for(o=0;o<32;++o)for(s=0;s<32;s++)a[o+s]+=p[o]*u[s];return vfe(t.subarray(32),a),l}function EHe(t,e,r,n){var o,s,a=new Oa(32),c=[wt(),wt(),wt(),wt()],u=[wt(),wt(),wt(),wt()];if(s=-1,r<64||THe(u,n))return-1;for(o=0;o<r;++o)t[o]=e[o];for(o=0;o<32;++o)t[o+32]=n[o];var l=pk(t,r);if(YG(l),_fe(c,u,l),JG(u,e.subarray(32)),QG(c,u),XG(a,c),r-=64,yfe(e,0,a,0)){for(o=0;o<r;++o)t[o]=0;return-1}for(o=0;o<r;++o)t[o]=e[o+64];return s=r,s}function vfe(t,e){var r,n,o,s;for(n=63;n>=32;--n){for(r=0,o=n-32,s=n-12;o<s;++o)e[o]+=r-16*e[n]*zG[o-(n-32)],r=e[o]+128>>8,e[o]-=r*256;e[o]+=r,e[n]=0}for(r=0,o=0;o<32;++o)e[o]+=r-(e[31]>>4)*zG[o],r=e[o]>>8,e[o]&=255;for(o=0;o<32;++o)e[o]-=r*zG[o];for(n=0;n<32;++n)e[n+1]+=e[n]>>8,t[n]=e[n]&255}function YG(t){for(var e=new Float64Array(64),r=0;r<64;++r)e[r]=t[r],t[r]=0;vfe(t,e)}function QG(t,e){var r=wt(),n=wt(),o=wt(),s=wt(),a=wt(),c=wt(),u=wt(),l=wt(),d=wt();sI(r,t[1],t[0]),sI(d,e[1],e[0]),bn(r,r,d),oI(n,t[0],t[1]),oI(d,e[0],e[1]),bn(n,n,d),bn(o,t[3],e[3]),bn(o,o,xHe),bn(s,t[2],e[2]),oI(s,s,s),sI(a,n,r),sI(c,s,o),oI(u,s,o),oI(l,n,r),bn(t[0],a,c),bn(t[1],l,u),bn(t[2],u,c),bn(t[3],a,l)}function mfe(t,e,r){for(var n=0;n<4;++n)xfe(t[n],e[n],r)}function XG(t,e){var r=wt(),n=wt(),o=wt();PHe(o,e[2]),bn(r,e[0],o),bn(n,e[1],o),b3(t,n),t[31]^=bfe(r)<<7}function b3(t,e){var r,n,o,s=wt(),a=wt();for(r=0;r<16;++r)a[r]=e[r];for($G(a),$G(a),$G(a),n=0;n<2;++n){for(s[0]=a[0]-65517,r=1;r<15;++r)s[r]=a[r]-65535-(s[r-1]>>16&1),s[r-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),o=s[15]>>16&1,s[14]&=65535,xfe(a,s,1-o)}for(r=0;r<16;r++)t[2*r]=a[r]&255,t[2*r+1]=a[r]>>8}function THe(t,e){var r=wt(),n=wt(),o=wt(),s=wt(),a=wt(),c=wt(),u=wt();return Rg(t[2],y3),wHe(t[1],e),Ty(o,t[1]),bn(s,o,_He),sI(o,o,t[2]),oI(s,t[2],s),Ty(a,s),Ty(c,a),bn(u,c,a),bn(r,u,o),bn(r,r,s),RHe(r,r),bn(r,r,o),bn(r,r,s),bn(r,r,s),bn(t[0],r,s),Ty(n,t[0]),bn(n,n,s),hfe(n,o)&&bn(t[0],t[0],SHe),Ty(n,t[0]),bn(n,n,s),hfe(n,o)?-1:(bfe(t[0])===e[31]>>7&&sI(t[0],KG,t[0]),bn(t[3],t[0],t[1]),0)}function wHe(t,e){var r;for(r=0;r<16;++r)t[r]=e[2*r]+(e[2*r+1]<<8);t[15]&=32767}function RHe(t,e){var r=wt(),n;for(n=0;n<16;++n)r[n]=e[n];for(n=250;n>=0;--n)Ty(r,r),n!==1&&bn(r,r,e);for(n=0;n<16;++n)t[n]=r[n]}function hfe(t,e){var r=new Oa(32),n=new Oa(32);return b3(r,t),b3(n,e),yfe(r,0,n,0)}function yfe(t,e,r,n){return kHe(t,e,r,n,32)}function kHe(t,e,r,n,o){var s,a=0;for(s=0;s<o;++s)a|=t[e+s]^r[n+s];return(1&a-1>>>8)-1}function bfe(t){var e=new Oa(32);return b3(e,t),e[0]&1}function _fe(t,e,r){var n,o;for(Rg(t[0],KG),Rg(t[1],y3),Rg(t[2],y3),Rg(t[3],KG),o=255;o>=0;--o)n=r[o/8|0]>>(o&7)&1,mfe(t,e,n),QG(e,t),QG(t,t),mfe(t,e,n)}function JG(t,e){var r=[wt(),wt(),wt(),wt()];Rg(r[0],pfe),Rg(r[1],ffe),Rg(r[2],y3),bn(r[3],pfe,ffe),_fe(t,r,e)}function Rg(t,e){var r;for(r=0;r<16;r++)t[r]=e[r]|0}function PHe(t,e){var r=wt(),n;for(n=0;n<16;++n)r[n]=e[n];for(n=253;n>=0;--n)Ty(r,r),n!==2&&n!==4&&bn(r,r,e);for(n=0;n<16;++n)t[n]=r[n]}function $G(t){var e,r,n=1;for(e=0;e<16;++e)r=t[e]+n+65535,n=Math.floor(r/65536),t[e]=r-n*65536;t[0]+=n-1+37*(n-1)}function xfe(t,e,r){for(var n,o=~(r-1),s=0;s<16;++s)n=o&(t[s]^e[s]),t[s]^=n,e[s]^=n}function wt(t){var e,r=new Float64Array(16);if(t)for(e=0;e<t.length;++e)r[e]=t[e];return r}function oI(t,e,r){for(var n=0;n<16;++n)t[n]=e[n]+r[n]}function sI(t,e,r){for(var n=0;n<16;++n)t[n]=e[n]-r[n]}function Ty(t,e){bn(t,e,e)}function bn(t,e,r){var n,o,s=0,a=0,c=0,u=0,l=0,d=0,p=0,f=0,m=0,h=0,g=0,v=0,y=0,b=0,_=0,S=0,I=0,T=0,A=0,B=0,j=0,F=0,ne=0,Y=0,N=0,w=0,P=0,q=0,U=0,Z=0,le=0,re=r[0],X=r[1],Ve=r[2],ie=r[3],yt=r[4],Ye=r[5],Et=r[6],Cr=r[7],be=r[8],ct=r[9],H=r[10],de=r[11],he=r[12],ke=r[13],Ie=r[14],ut=r[15];n=e[0],s+=n*re,a+=n*X,c+=n*Ve,u+=n*ie,l+=n*yt,d+=n*Ye,p+=n*Et,f+=n*Cr,m+=n*be,h+=n*ct,g+=n*H,v+=n*de,y+=n*he,b+=n*ke,_+=n*Ie,S+=n*ut,n=e[1],a+=n*re,c+=n*X,u+=n*Ve,l+=n*ie,d+=n*yt,p+=n*Ye,f+=n*Et,m+=n*Cr,h+=n*be,g+=n*ct,v+=n*H,y+=n*de,b+=n*he,_+=n*ke,S+=n*Ie,I+=n*ut,n=e[2],c+=n*re,u+=n*X,l+=n*Ve,d+=n*ie,p+=n*yt,f+=n*Ye,m+=n*Et,h+=n*Cr,g+=n*be,v+=n*ct,y+=n*H,b+=n*de,_+=n*he,S+=n*ke,I+=n*Ie,T+=n*ut,n=e[3],u+=n*re,l+=n*X,d+=n*Ve,p+=n*ie,f+=n*yt,m+=n*Ye,h+=n*Et,g+=n*Cr,v+=n*be,y+=n*ct,b+=n*H,_+=n*de,S+=n*he,I+=n*ke,T+=n*Ie,A+=n*ut,n=e[4],l+=n*re,d+=n*X,p+=n*Ve,f+=n*ie,m+=n*yt,h+=n*Ye,g+=n*Et,v+=n*Cr,y+=n*be,b+=n*ct,_+=n*H,S+=n*de,I+=n*he,T+=n*ke,A+=n*Ie,B+=n*ut,n=e[5],d+=n*re,p+=n*X,f+=n*Ve,m+=n*ie,h+=n*yt,g+=n*Ye,v+=n*Et,y+=n*Cr,b+=n*be,_+=n*ct,S+=n*H,I+=n*de,T+=n*he,A+=n*ke,B+=n*Ie,j+=n*ut,n=e[6],p+=n*re,f+=n*X,m+=n*Ve,h+=n*ie,g+=n*yt,v+=n*Ye,y+=n*Et,b+=n*Cr,_+=n*be,S+=n*ct,I+=n*H,T+=n*de,A+=n*he,B+=n*ke,j+=n*Ie,F+=n*ut,n=e[7],f+=n*re,m+=n*X,h+=n*Ve,g+=n*ie,v+=n*yt,y+=n*Ye,b+=n*Et,_+=n*Cr,S+=n*be,I+=n*ct,T+=n*H,A+=n*de,B+=n*he,j+=n*ke,F+=n*Ie,ne+=n*ut,n=e[8],m+=n*re,h+=n*X,g+=n*Ve,v+=n*ie,y+=n*yt,b+=n*Ye,_+=n*Et,S+=n*Cr,I+=n*be,T+=n*ct,A+=n*H,B+=n*de,j+=n*he,F+=n*ke,ne+=n*Ie,Y+=n*ut,n=e[9],h+=n*re,g+=n*X,v+=n*Ve,y+=n*ie,b+=n*yt,_+=n*Ye,S+=n*Et,I+=n*Cr,T+=n*be,A+=n*ct,B+=n*H,j+=n*de,F+=n*he,ne+=n*ke,Y+=n*Ie,N+=n*ut,n=e[10],g+=n*re,v+=n*X,y+=n*Ve,b+=n*ie,_+=n*yt,S+=n*Ye,I+=n*Et,T+=n*Cr,A+=n*be,B+=n*ct,j+=n*H,F+=n*de,ne+=n*he,Y+=n*ke,N+=n*Ie,w+=n*ut,n=e[11],v+=n*re,y+=n*X,b+=n*Ve,_+=n*ie,S+=n*yt,I+=n*Ye,T+=n*Et,A+=n*Cr,B+=n*be,j+=n*ct,F+=n*H,ne+=n*de,Y+=n*he,N+=n*ke,w+=n*Ie,P+=n*ut,n=e[12],y+=n*re,b+=n*X,_+=n*Ve,S+=n*ie,I+=n*yt,T+=n*Ye,A+=n*Et,B+=n*Cr,j+=n*be,F+=n*ct,ne+=n*H,Y+=n*de,N+=n*he,w+=n*ke,P+=n*Ie,q+=n*ut,n=e[13],b+=n*re,_+=n*X,S+=n*Ve,I+=n*ie,T+=n*yt,A+=n*Ye,B+=n*Et,j+=n*Cr,F+=n*be,ne+=n*ct,Y+=n*H,N+=n*de,w+=n*he,P+=n*ke,q+=n*Ie,U+=n*ut,n=e[14],_+=n*re,S+=n*X,I+=n*Ve,T+=n*ie,A+=n*yt,B+=n*Ye,j+=n*Et,F+=n*Cr,ne+=n*be,Y+=n*ct,N+=n*H,w+=n*de,P+=n*he,q+=n*ke,U+=n*Ie,Z+=n*ut,n=e[15],S+=n*re,I+=n*X,T+=n*Ve,A+=n*ie,B+=n*yt,j+=n*Ye,F+=n*Et,ne+=n*Cr,Y+=n*be,N+=n*ct,w+=n*H,P+=n*de,q+=n*he,U+=n*ke,Z+=n*Ie,le+=n*ut,s+=38*I,a+=38*T,c+=38*A,u+=38*B,l+=38*j,d+=38*F,p+=38*ne,f+=38*Y,m+=38*N,h+=38*w,g+=38*P,v+=38*q,y+=38*U,b+=38*Z,_+=38*le,o=1,n=s+o+65535,o=Math.floor(n/65536),s=n-o*65536,n=a+o+65535,o=Math.floor(n/65536),a=n-o*65536,n=c+o+65535,o=Math.floor(n/65536),c=n-o*65536,n=u+o+65535,o=Math.floor(n/65536),u=n-o*65536,n=l+o+65535,o=Math.floor(n/65536),l=n-o*65536,n=d+o+65535,o=Math.floor(n/65536),d=n-o*65536,n=p+o+65535,o=Math.floor(n/65536),p=n-o*65536,n=f+o+65535,o=Math.floor(n/65536),f=n-o*65536,n=m+o+65535,o=Math.floor(n/65536),m=n-o*65536,n=h+o+65535,o=Math.floor(n/65536),h=n-o*65536,n=g+o+65535,o=Math.floor(n/65536),g=n-o*65536,n=v+o+65535,o=Math.floor(n/65536),v=n-o*65536,n=y+o+65535,o=Math.floor(n/65536),y=n-o*65536,n=b+o+65535,o=Math.floor(n/65536),b=n-o*65536,n=_+o+65535,o=Math.floor(n/65536),_=n-o*65536,n=S+o+65535,o=Math.floor(n/65536),S=n-o*65536,s+=o-1+37*(o-1),o=1,n=s+o+65535,o=Math.floor(n/65536),s=n-o*65536,n=a+o+65535,o=Math.floor(n/65536),a=n-o*65536,n=c+o+65535,o=Math.floor(n/65536),c=n-o*65536,n=u+o+65535,o=Math.floor(n/65536),u=n-o*65536,n=l+o+65535,o=Math.floor(n/65536),l=n-o*65536,n=d+o+65535,o=Math.floor(n/65536),d=n-o*65536,n=p+o+65535,o=Math.floor(n/65536),p=n-o*65536,n=f+o+65535,o=Math.floor(n/65536),f=n-o*65536,n=m+o+65535,o=Math.floor(n/65536),m=n-o*65536,n=h+o+65535,o=Math.floor(n/65536),h=n-o*65536,n=g+o+65535,o=Math.floor(n/65536),g=n-o*65536,n=v+o+65535,o=Math.floor(n/65536),v=n-o*65536,n=y+o+65535,o=Math.floor(n/65536),y=n-o*65536,n=b+o+65535,o=Math.floor(n/65536),b=n-o*65536,n=_+o+65535,o=Math.floor(n/65536),_=n-o*65536,n=S+o+65535,o=Math.floor(n/65536),S=n-o*65536,s+=o-1+37*(o-1),t[0]=s,t[1]=a,t[2]=c,t[3]=u,t[4]=l,t[5]=d,t[6]=p,t[7]=f,t[8]=m,t[9]=h,t[10]=g,t[11]=v,t[12]=y,t[13]=b,t[14]=_,t[15]=S}});var wfe=M((Wir,Tfe)=>{var Ec=rr();Lr();gu();ak();Tfe.exports=Ec.kem=Ec.kem||{};var Cfe=Ec.jsbn.BigInteger;Ec.kem.rsa={};Ec.kem.rsa.create=function(t,e){e=e||{};var r=e.prng||Ec.random,n={};return n.encrypt=function(o,s){var a=Math.ceil(o.n.bitLength()/8),c;do c=new Cfe(Ec.util.bytesToHex(r.getBytesSync(a)),16).mod(o.n);while(c.compareTo(Cfe.ONE)<=0);c=Ec.util.hexToBytes(c.toString(16));var u=a-c.length;u>0&&(c=Ec.util.fillString("\0",u)+c);var l=o.encrypt(c,"NONE"),d=t.generate(c,s);return{encapsulation:l,key:d}},n.decrypt=function(o,s,a){var c=o.decrypt(s,"NONE");return t.generate(c,a)},n};Ec.kem.kdf1=function(t,e){Efe(this,t,0,e||t.digestLength)};Ec.kem.kdf2=function(t,e){Efe(this,t,1,e||t.digestLength)};function Efe(t,e,r,n){t.generate=function(o,s){for(var a=new Ec.util.ByteBuffer,c=Math.ceil(s/n)+r,u=new Ec.util.ByteBuffer,l=r;l<c;++l){u.putInt32(l),e.start(),e.update(o+u.getBytes());var d=e.digest();a.putBytes(d.getBytes(n))}return a.truncate(a.length()-s),a.getBytes()}}});var Afe=M((Kir,Pfe)=>{var _r=rr();Lr();Pfe.exports=_r.log=_r.log||{};_r.log.levels=["none","error","warning","info","debug","verbose","max"];var _3={},tz=[],mk=null;_r.log.LEVEL_LOCKED=2;_r.log.NO_LEVEL_CHECK=4;_r.log.INTERPOLATE=8;for(Bd=0;Bd<_r.log.levels.length;++Bd)ZG=_r.log.levels[Bd],_3[ZG]={index:Bd,name:ZG.toUpperCase()};var ZG,Bd;_r.log.logMessage=function(t){for(var e=_3[t.level].index,r=0;r<tz.length;++r){var n=tz[r];if(n.flags&_r.log.NO_LEVEL_CHECK)n.f(t);else{var o=_3[n.level].index;e<=o&&n.f(n,t)}}};_r.log.prepareStandard=function(t){"standard"in t||(t.standard=_3[t.level].name+" ["+t.category+"] "+t.message)};_r.log.prepareFull=function(t){if(!("full"in t)){var e=[t.message];e=e.concat([]),t.full=_r.util.format.apply(this,e)}};_r.log.prepareStandardFull=function(t){"standardFull"in t||(_r.log.prepareStandard(t),t.standardFull=t.standard)};for(ez=["error","warning","info","debug","verbose"],Bd=0;Bd<ez.length;++Bd)(function(e){_r.log[e]=function(r,n){var o=Array.prototype.slice.call(arguments).slice(2),s={timestamp:new Date,level:e,category:r,message:n,arguments:o};_r.log.logMessage(s)}})(ez[Bd]);var ez,Bd;_r.log.makeLogger=function(t){var e={flags:0,f:t};return _r.log.setLevel(e,"none"),e};_r.log.setLevel=function(t,e){var r=!1;if(t&&!(t.flags&_r.log.LEVEL_LOCKED))for(var n=0;n<_r.log.levels.length;++n){var o=_r.log.levels[n];if(e==o){t.level=e,r=!0;break}}return r};_r.log.lock=function(t,e){typeof e>"u"||e?t.flags|=_r.log.LEVEL_LOCKED:t.flags&=~_r.log.LEVEL_LOCKED};_r.log.addLogger=function(t){tz.push(t)};typeof console<"u"&&"log"in console?(console.error&&console.warn&&console.info&&console.debug?(Rfe={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},hk=function(t,e){_r.log.prepareStandard(e);var r=Rfe[e.level],n=[e.standard];n=n.concat(e.arguments.slice()),r.apply(console,n)},aI=_r.log.makeLogger(hk)):(hk=function(e,r){_r.log.prepareStandardFull(r),console.log(r.standardFull)},aI=_r.log.makeLogger(hk)),_r.log.setLevel(aI,"debug"),_r.log.addLogger(aI),mk=aI):console={log:function(){}};var aI,Rfe,hk;mk!==null&&typeof window<"u"&&window.location&&(fk=new URL(window.location.href).searchParams,fk.has("console.level")&&_r.log.setLevel(mk,fk.get("console.level").slice(-1)[0]),fk.has("console.lock")&&(kfe=fk.get("console.lock").slice(-1)[0],kfe=="true"&&_r.log.lock(mk)));var fk,kfe;_r.log.consoleLogger=mk});var Nfe=M((Yir,Dfe)=>{Dfe.exports=Ad();ZO();eI();mG();VG()});var Mfe=M((Qir,Ofe)=>{var ze=rr();_g();Tl();ok();xg();by();RG();gu();Lr();f3();var W=ze.asn1,sa=Ofe.exports=ze.pkcs7=ze.pkcs7||{};sa.messageFromPem=function(t){var e=ze.pem.decode(t)[0];if(e.type!=="PKCS7"){var r=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var n=W.fromDer(e.body);return sa.messageFromAsn1(n)};sa.messageToPem=function(t,e){var r={type:"PKCS7",body:W.toDer(t.toAsn1()).getBytes()};return ze.pem.encode(r,{maxline:e})};sa.messageFromAsn1=function(t){var e={},r=[];if(!W.validate(t,sa.asn1.contentInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw n.errors=r,n}var o=W.derToOid(e.contentType),s;switch(o){case ze.pki.oids.envelopedData:s=sa.createEnvelopedData();break;case ze.pki.oids.encryptedData:s=sa.createEncryptedData();break;case ze.pki.oids.signedData:s=sa.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+o+" is not (yet) supported.")}return s.fromAsn1(e.content.value[0]),s};sa.createSignedData=function(){var t=null;return t={type:ze.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(n){if(nz(t,n,sa.asn1.signedDataValidator),t.certificates=[],t.crls=[],t.digestAlgorithmIdentifiers=[],t.contentInfo=null,t.signerInfos=[],t.rawCapture.certificates)for(var o=t.rawCapture.certificates.value,s=0;s<o.length;++s)t.certificates.push(ze.pki.certificateFromAsn1(o[s]))},toAsn1:function(){t.contentInfo||t.sign();for(var n=[],o=0;o<t.certificates.length;++o)n.push(ze.pki.certificateToAsn1(t.certificates[o]));var s=[],a=W.create(W.Class.CONTEXT_SPECIFIC,0,!0,[W.create(W.Class.UNIVERSAL,W.Type.SEQUENCE,!0,[W.create(W.Class.UNIVERSAL,W.Type.INTEGER,!1,W.integerToDer(t.version).getBytes()),W.create(W.Class.UNIVERSAL,W.Type.SET,!0,t.digestAlgorithmIdentifiers),t.contentInfo])]);return n.length>0&&a.value[0].value.push(W.create(W.Class.CONTEXT_SPECIFIC,0,!0,n)),s.length>0&&a.value[0].value.push(W.create(W.Class.CONTEXT_SPECIFIC,1,!0,s)),a.value[0].value.push(W.create(W.Class.UNIVERSAL,W.Type.SET,!0,t.signerInfos)),W.create(W.Class.UNIVERSAL,W.Type.SEQUENCE,!0,[W.create(W.Class.UNIVERSAL,W.Type.OID,!1,W.oidToDer(t.type).getBytes()),a])},addSigner:function(n){var o=n.issuer,s=n.serialNumber;if(n.certificate){var a=n.certificate;typeof a=="string"&&(a=ze.pki.certificateFromPem(a)),o=a.issuer.attributes,s=a.serialNumber}var c=n.key;if(!c)throw new Error("Could not add PKCS#7 signer; no private key specified.");typeof c=="string"&&(c=ze.pki.privateKeyFromPem(c));var u=n.digestAlgorithm||ze.pki.oids.sha1;switch(u){case ze.pki.oids.sha1:case ze.pki.oids.sha256:case ze.pki.oids.sha384:case ze.pki.oids.sha512:case ze.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+u)}var l=n.authenticatedAttributes||[];if(l.length>0){for(var d=!1,p=!1,f=0;f<l.length;++f){var m=l[f];if(!d&&m.type===ze.pki.oids.contentType){if(d=!0,p)break;continue}if(!p&&m.type===ze.pki.oids.messageDigest){if(p=!0,d)break;continue}}if(!d||!p)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}t.signers.push({key:c,version:1,issuer:o,serialNumber:s,digestAlgorithm:u,signatureAlgorithm:ze.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:l,unauthenticatedAttributes:[]})},sign:function(n){if(n=n||{},(typeof t.content!="object"||t.contentInfo===null)&&(t.contentInfo=W.create(W.Class.UNIVERSAL,W.Type.SEQUENCE,!0,[W.create(W.Class.UNIVERSAL,W.Type.OID,!1,W.oidToDer(ze.pki.oids.data).getBytes())]),"content"in t)){var o;t.content instanceof ze.util.ByteBuffer?o=t.content.bytes():typeof t.content=="string"&&(o=ze.util.encodeUtf8(t.content)),n.detached?t.detachedContent=W.create(W.Class.UNIVERSAL,W.Type.OCTETSTRING,!1,o):t.contentInfo.value.push(W.create(W.Class.CONTEXT_SPECIFIC,0,!0,[W.create(W.Class.UNIVERSAL,W.Type.OCTETSTRING,!1,o)]))}if(t.signers.length!==0){var s=e();r(s)}},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(n){typeof n=="string"&&(n=ze.pki.certificateFromPem(n)),t.certificates.push(n)},addCertificateRevokationList:function(n){throw new Error("PKCS#7 CRL support not yet implemented.")}},t;function e(){for(var n={},o=0;o<t.signers.length;++o){var s=t.signers[o],a=s.digestAlgorithm;a in n||(n[a]=ze.md[ze.pki.oids[a]].create()),s.authenticatedAttributes.length===0?s.md=n[a]:s.md=ze.md[ze.pki.oids[a]].create()}t.digestAlgorithmIdentifiers=[];for(var a in n)t.digestAlgorithmIdentifiers.push(W.create(W.Class.UNIVERSAL,W.Type.SEQUENCE,!0,[W.create(W.Class.UNIVERSAL,W.Type.OID,!1,W.oidToDer(a).getBytes()),W.create(W.Class.UNIVERSAL,W.Type.NULL,!1,"")]));return n}function r(n){var o;if(t.detachedContent?o=t.detachedContent:(o=t.contentInfo.value[1],o=o.value[0]),!o)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var s=W.derToOid(t.contentInfo.value[0].value),a=W.toDer(o);a.getByte(),W.getBerValueLength(a),a=a.getBytes();for(var c in n)n[c].start().update(a);for(var u=new Date,l=0;l<t.signers.length;++l){var d=t.signers[l];if(d.authenticatedAttributes.length===0){if(s!==ze.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{d.authenticatedAttributesAsn1=W.create(W.Class.CONTEXT_SPECIFIC,0,!0,[]);for(var p=W.create(W.Class.UNIVERSAL,W.Type.SET,!0,[]),f=0;f<d.authenticatedAttributes.length;++f){var m=d.authenticatedAttributes[f];m.type===ze.pki.oids.messageDigest?m.value=n[d.digestAlgorithm].digest():m.type===ze.pki.oids.signingTime&&(m.value||(m.value=u)),p.value.push(rz(m)),d.authenticatedAttributesAsn1.value.push(rz(m))}a=W.toDer(p).getBytes(),d.md.start().update(a)}d.signature=d.key.sign(d.md,"RSASSA-PKCS1-V1_5")}t.signerInfos=MHe(t.signers)}};sa.createEncryptedData=function(){var t=null;return t={type:ze.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:ze.pki.oids["aes256-CBC"]},fromAsn1:function(e){nz(t,e,sa.asn1.encryptedDataValidator)},decrypt:function(e){e!==void 0&&(t.encryptedContent.key=e),Lfe(t)}},t};sa.createEnvelopedData=function(){var t=null;return t={type:ze.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:ze.pki.oids["aes256-CBC"]},fromAsn1:function(e){var r=nz(t,e,sa.asn1.envelopedDataValidator);t.recipients=NHe(r.recipientInfos.value)},toAsn1:function(){return W.create(W.Class.UNIVERSAL,W.Type.SEQUENCE,!0,[W.create(W.Class.UNIVERSAL,W.Type.OID,!1,W.oidToDer(t.type).getBytes()),W.create(W.Class.CONTEXT_SPECIFIC,0,!0,[W.create(W.Class.UNIVERSAL,W.Type.SEQUENCE,!0,[W.create(W.Class.UNIVERSAL,W.Type.INTEGER,!1,W.integerToDer(t.version).getBytes()),W.create(W.Class.UNIVERSAL,W.Type.SET,!0,LHe(t.recipients)),W.create(W.Class.UNIVERSAL,W.Type.SEQUENCE,!0,FHe(t.encryptedContent))])])])},findRecipient:function(e){for(var r=e.issuer.attributes,n=0;n<t.recipients.length;++n){var o=t.recipients[n],s=o.issuer;if(o.serialNumber===e.serialNumber&&s.length===r.length){for(var a=!0,c=0;c<r.length;++c)if(s[c].type!==r[c].type||s[c].value!==r[c].value){a=!1;break}if(a)return o}}return null},decrypt:function(e,r){if(t.encryptedContent.key===void 0&&e!==void 0&&r!==void 0)switch(e.encryptedContent.algorithm){case ze.pki.oids.rsaEncryption:case ze.pki.oids.desCBC:var n=r.decrypt(e.encryptedContent.content);t.encryptedContent.key=ze.util.createBuffer(n);break;default:throw new Error("Unsupported asymmetric cipher, OID "+e.encryptedContent.algorithm)}Lfe(t)},addRecipient:function(e){t.recipients.push({version:0,issuer:e.issuer.attributes,serialNumber:e.serialNumber,encryptedContent:{algorithm:ze.pki.oids.rsaEncryption,key:e.publicKey}})},encrypt:function(e,r){if(t.encryptedContent.content===void 0){r=r||t.encryptedContent.algorithm,e=e||t.encryptedContent.key;var n,o,s;switch(r){case ze.pki.oids["aes128-CBC"]:n=16,o=16,s=ze.aes.createEncryptionCipher;break;case ze.pki.oids["aes192-CBC"]:n=24,o=16,s=ze.aes.createEncryptionCipher;break;case ze.pki.oids["aes256-CBC"]:n=32,o=16,s=ze.aes.createEncryptionCipher;break;case ze.pki.oids["des-EDE3-CBC"]:n=24,o=8,s=ze.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+r)}if(e===void 0)e=ze.util.createBuffer(ze.random.getBytes(n));else if(e.length()!=n)throw new Error("Symmetric key has wrong length; got "+e.length()+" bytes, expected "+n+".");t.encryptedContent.algorithm=r,t.encryptedContent.key=e,t.encryptedContent.parameter=ze.util.createBuffer(ze.random.getBytes(o));var a=s(e);if(a.start(t.encryptedContent.parameter.copy()),a.update(t.content),!a.finish())throw new Error("Symmetric encryption failed.");t.encryptedContent.content=a.output}for(var c=0;c<t.recipients.length;++c){var u=t.recipients[c];if(u.encryptedContent.content===void 0)switch(u.encryptedContent.algorithm){case ze.pki.oids.rsaEncryption:u.encryptedContent.content=u.encryptedContent.key.encrypt(t.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+u.encryptedContent.algorithm)}}}},t};function AHe(t){var e={},r=[];if(!W.validate(t,sa.asn1.recipientInfoValidator,e,r)){var n=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw n.errors=r,n}return{version:e.version.charCodeAt(0),issuer:ze.pki.RDNAttributesAsArray(e.issuer),serialNumber:ze.util.createBuffer(e.serial).toHex(),encryptedContent:{algorithm:W.derToOid(e.encAlgorithm),parameter:e.encParameter?e.encParameter.value:void 0,content:e.encKey}}}function DHe(t){return W.create(W.Class.UNIVERSAL,W.Type.SEQUENCE,!0,[W.create(W.Class.UNIVERSAL,W.Type.INTEGER,!1,W.integerToDer(t.version).getBytes()),W.create(W.Class.UNIVERSAL,W.Type.SEQUENCE,!0,[ze.pki.distinguishedNameToAsn1({attributes:t.issuer}),W.create(W.Class.UNIVERSAL,W.Type.INTEGER,!1,ze.util.hexToBytes(t.serialNumber))]),W.create(W.Class.UNIVERSAL,W.Type.SEQUENCE,!0,[W.create(W.Class.UNIVERSAL,W.Type.OID,!1,W.oidToDer(t.encryptedContent.algorithm).getBytes()),W.create(W.Class.UNIVERSAL,W.Type.NULL,!1,"")]),W.create(W.Class.UNIVERSAL,W.Type.OCTETSTRING,!1,t.encryptedContent.content)])}function NHe(t){for(var e=[],r=0;r<t.length;++r)e.push(AHe(t[r]));return e}function LHe(t){for(var e=[],r=0;r<t.length;++r)e.push(DHe(t[r]));return e}function OHe(t){var e=W.create(W.Class.UNIVERSAL,W.Type.SEQUENCE,!0,[W.create(W.Class.UNIVERSAL,W.Type.INTEGER,!1,W.integerToDer(t.version).getBytes()),W.create(W.Class.UNIVERSAL,W.Type.SEQUENCE,!0,[ze.pki.distinguishedNameToAsn1({attributes:t.issuer}),W.create(W.Class.UNIVERSAL,W.Type.INTEGER,!1,ze.util.hexToBytes(t.serialNumber))]),W.create(W.Class.UNIVERSAL,W.Type.SEQUENCE,!0,[W.create(W.Class.UNIVERSAL,W.Type.OID,!1,W.oidToDer(t.digestAlgorithm).getBytes()),W.create(W.Class.UNIVERSAL,W.Type.NULL,!1,"")])]);if(t.authenticatedAttributesAsn1&&e.value.push(t.authenticatedAttributesAsn1),e.value.push(W.create(W.Class.UNIVERSAL,W.Type.SEQUENCE,!0,[W.create(W.Class.UNIVERSAL,W.Type.OID,!1,W.oidToDer(t.signatureAlgorithm).getBytes()),W.create(W.Class.UNIVERSAL,W.Type.NULL,!1,"")])),e.value.push(W.create(W.Class.UNIVERSAL,W.Type.OCTETSTRING,!1,t.signature)),t.unauthenticatedAttributes.length>0){for(var r=W.create(W.Class.CONTEXT_SPECIFIC,1,!0,[]),n=0;n<t.unauthenticatedAttributes.length;++n){var o=t.unauthenticatedAttributes[n];r.values.push(rz(o))}e.value.push(r)}return e}function MHe(t){for(var e=[],r=0;r<t.length;++r)e.push(OHe(t[r]));return e}function rz(t){var e;if(t.type===ze.pki.oids.contentType)e=W.create(W.Class.UNIVERSAL,W.Type.OID,!1,W.oidToDer(t.value).getBytes());else if(t.type===ze.pki.oids.messageDigest)e=W.create(W.Class.UNIVERSAL,W.Type.OCTETSTRING,!1,t.value.bytes());else if(t.type===ze.pki.oids.signingTime){var r=new Date("1950-01-01T00:00:00Z"),n=new Date("2050-01-01T00:00:00Z"),o=t.value;if(typeof o=="string"){var s=Date.parse(o);isNaN(s)?o.length===13?o=W.utcTimeToDate(o):o=W.generalizedTimeToDate(o):o=new Date(s)}o>=r&&o<n?e=W.create(W.Class.UNIVERSAL,W.Type.UTCTIME,!1,W.dateToUtcTime(o)):e=W.create(W.Class.UNIVERSAL,W.Type.GENERALIZEDTIME,!1,W.dateToGeneralizedTime(o))}return W.create(W.Class.UNIVERSAL,W.Type.SEQUENCE,!0,[W.create(W.Class.UNIVERSAL,W.Type.OID,!1,W.oidToDer(t.type).getBytes()),W.create(W.Class.UNIVERSAL,W.Type.SET,!0,[e])])}function FHe(t){return[W.create(W.Class.UNIVERSAL,W.Type.OID,!1,W.oidToDer(ze.pki.oids.data).getBytes()),W.create(W.Class.UNIVERSAL,W.Type.SEQUENCE,!0,[W.create(W.Class.UNIVERSAL,W.Type.OID,!1,W.oidToDer(t.algorithm).getBytes()),t.parameter?W.create(W.Class.UNIVERSAL,W.Type.OCTETSTRING,!1,t.parameter.getBytes()):void 0]),W.create(W.Class.CONTEXT_SPECIFIC,0,!0,[W.create(W.Class.UNIVERSAL,W.Type.OCTETSTRING,!1,t.content.getBytes())])]}function nz(t,e,r){var n={},o=[];if(!W.validate(e,r,n,o)){var s=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw s.errors=s,s}var a=W.derToOid(n.contentType);if(a!==ze.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(n.encryptedContent){var c="";if(ze.util.isArray(n.encryptedContent))for(var u=0;u<n.encryptedContent.length;++u){if(n.encryptedContent[u].type!==W.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");c+=n.encryptedContent[u].value}else c=n.encryptedContent;t.encryptedContent={algorithm:W.derToOid(n.encAlgorithm),parameter:ze.util.createBuffer(n.encParameter.value),content:ze.util.createBuffer(c)}}if(n.content){var c="";if(ze.util.isArray(n.content))for(var u=0;u<n.content.length;++u){if(n.content[u].type!==W.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");c+=n.content[u].value}else c=n.content;t.content=ze.util.createBuffer(c)}return t.version=n.version.charCodeAt(0),t.rawCapture=n,n}function Lfe(t){if(t.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(t.content===void 0){var e;switch(t.encryptedContent.algorithm){case ze.pki.oids["aes128-CBC"]:case ze.pki.oids["aes192-CBC"]:case ze.pki.oids["aes256-CBC"]:e=ze.aes.createDecryptionCipher(t.encryptedContent.key);break;case ze.pki.oids.desCBC:case ze.pki.oids["des-EDE3-CBC"]:e=ze.des.createDecryptionCipher(t.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+t.encryptedContent.algorithm)}if(e.start(t.encryptedContent.parameter),e.update(t.encryptedContent.content),!e.finish())throw new Error("Symmetric decryption failed.");t.content=e.output}}});var Ufe=M((Xir,Ffe)=>{var to=rr();_g();QS();ZO();eI();Lr();var S3=Ffe.exports=to.ssh=to.ssh||{};S3.privateKeyToPutty=function(t,e,r){r=r||"",e=e||"";var n="ssh-rsa",o=e===""?"none":"aes256-cbc",s="PuTTY-User-Key-File-2: "+n+`\r
`;s+="Encryption: "+o+`\r
`,s+="Comment: "+r+`\r
`;var a=to.util.createBuffer();cI(a,n),qd(a,t.e),qd(a,t.n);var c=to.util.encode64(a.bytes(),64),u=Math.floor(c.length/66)+1;s+="Public-Lines: "+u+`\r
`,s+=c;var l=to.util.createBuffer();qd(l,t.d),qd(l,t.p),qd(l,t.q),qd(l,t.qInv);var d;if(!e)d=to.util.encode64(l.bytes(),64);else{var p=l.length()+16-1;p-=p%16;var f=x3(l.bytes());f.truncate(f.length()-p+l.length()),l.putBuffer(f);var m=to.util.createBuffer();m.putBuffer(x3("\0\0\0\0",e)),m.putBuffer(x3("\0\0\0",e));var h=to.aes.createEncryptionCipher(m.truncate(8),"CBC");h.start(to.util.createBuffer().fillWithByte(0,16)),h.update(l.copy()),h.finish();var g=h.output;g.truncate(16),d=to.util.encode64(g.bytes(),64)}u=Math.floor(d.length/66)+1,s+=`\r
Private-Lines: `+u+`\r
`,s+=d;var v=x3("putty-private-key-file-mac-key",e),y=to.util.createBuffer();cI(y,n),cI(y,o),cI(y,r),y.putInt32(a.length()),y.putBuffer(a),y.putInt32(l.length()),y.putBuffer(l);var b=to.hmac.create();return b.start("sha1",v),b.update(y.bytes()),s+=`\r
Private-MAC: `+b.digest().toHex()+`\r
`,s};S3.publicKeyToOpenSSH=function(t,e){var r="ssh-rsa";e=e||"";var n=to.util.createBuffer();return cI(n,r),qd(n,t.e),qd(n,t.n),r+" "+to.util.encode64(n.bytes())+" "+e};S3.privateKeyToOpenSSH=function(t,e){return e?to.pki.encryptRsaPrivateKey(t,e,{legacy:!0,algorithm:"aes128"}):to.pki.privateKeyToPem(t)};S3.getPublicKeyFingerprint=function(t,e){e=e||{};var r=e.md||to.md.md5.create(),n="ssh-rsa",o=to.util.createBuffer();cI(o,n),qd(o,t.e),qd(o,t.n),r.start(),r.update(o.getBytes());var s=r.digest();if(e.encoding==="hex"){var a=s.toHex();return e.delimiter?a.match(/.{2}/g).join(e.delimiter):a}else{if(e.encoding==="binary")return s.getBytes();if(e.encoding)throw new Error('Unknown encoding "'+e.encoding+'".')}return s};function qd(t,e){var r=e.toString(16);r[0]>="8"&&(r="00"+r);var n=to.util.hexToBytes(r);t.putInt32(n.length),t.putBytes(n)}function cI(t,e){t.putInt32(e.length),t.putString(e)}function x3(){for(var t=to.md.sha1.create(),e=arguments.length,r=0;r<e;++r)t.update(arguments[r]);return t.digest()}});var qfe=M((Jir,Bfe)=>{Bfe.exports=rr();_g();ofe();Tl();$O();ok();Ife();QS();wfe();Afe();Nfe();kG();n3();by();IG();DG();Mfe();LG();EG();hG();l3();gu();yG();Ufe();qG();Lr()});var Hfe=M((Zir,UHe)=>{UHe.exports={name:"@roamhq/mac-ca",version:"1.0.7",description:"Get Mac OS Root certificates",main:"index.js",repository:{type:"git",url:"https://github.com/WonderInventions/mac-ca.git"},scripts:{test:'echo "Error: no test specified" && exit 1',lint:"eslint ."},license:"BSD-3-Clause",dependencies:{"node-forge":"^1.3.1"},devDependencies:{eslint:"^8.22.0"}}});var Gfe=M((eor,iz)=>{var C3=qfe(),jfe=Hfe(),I3=iz.exports.validFormats={der:0,pem:1,txt:2,asn1:3};function Vfe(t){let e=C3.pki.pemToDer(t),r=C3.asn1,n=r.fromDer(e.data.toString("binary")).value[0].value,o=n[0],s=o.tagClass===r.Class.CONTEXT_SPECIFIC&&o.type===0&&o.constructed,a=n.slice(s);return{serial:a[0],issuer:a[2],valid:a[3],subject:a[4]}}function BHe(t){let e=Vfe(t),r=new Date,n=e.subject.value.map(a=>a.value[0].value[1].value).join("/"),o=e.valid.value.map(a=>a.value).join(" - "),s=r.toTimeString().replace(/\s*\(.*\)\s*/,"");return[`Subject	${n}`,`Valid	${o}`,`Saved	${r.toLocaleDateString()} ${s} by ${jfe.name}@${jfe.version}`,String(t)].join(`
`)}iz.exports.transform=function(t){return function(e){try{switch(t){case I3.der:return C3.pki.pemToDer(e);case I3.pem:return e;case I3.txt:return BHe(e);case I3.asn1:return Vfe(e);default:return C3.pki.certificateFromPem(e)}}catch{return}}}});var zfe=M((tor,uI)=>{var oz=require("https"),sz=Gfe();if(process.platform!=="darwin")uI.exports.all=()=>[],uI.exports.each=()=>{};else{let c=function(l,d,p){return p.indexOf(l)===d};qHe=c;let t=require("child_process"),e=/(?=-----BEGIN\sCERTIFICATE-----)/g,r="/System/Library/Keychains/SystemRootCertificates.keychain",n=["find-certificate","-a","-p"],o=t.spawnSync("/usr/bin/security",n).stdout.toString().split(e),s=t.spawnSync("/usr/bin/security",n.concat(r)).stdout.toString().split(e);oz.globalAgent.options.ca=oz.globalAgent.options.ca||[];let a=oz.globalAgent.options.ca,u=o.concat(s);u.filter(c).forEach(l=>a.push(l)),uI.exports.der2=sz.validFormats,uI.exports.all=function(l){return u.map(sz.transform(l)).filter(d=>d)},uI.exports.each=function(l,d){return typeof l=="function"&&(d=l,l=void 0),u.map(sz.transform(l)).filter(p=>p).forEach(d)}}var qHe});var Ame=M((exports,module)=>{var Module=Module!==void 0?Module:{},TreeSitter=function(){var initPromise,document=typeof window=="object"?{currentScript:window.document.currentScript}:null;class Parser{constructor(){this.initialize()}initialize(){throw new Error("cannot construct a Parser before calling `init()`")}static init(moduleOptions){return initPromise||(Module=Object.assign({},Module,moduleOptions),initPromise=new Promise(resolveInitPromise=>{var moduleOverrides=Object.assign({},Module),arguments_=[],thisProgram="./this.program",quit_=(t,e)=>{throw e},ENVIRONMENT_IS_WEB=typeof window=="object",ENVIRONMENT_IS_WORKER=typeof importScripts=="function",ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",scriptDirectory="",read_,readAsync,readBinary;function locateFile(t){return Module.locateFile?Module.locateFile(t,scriptDirectory):scriptDirectory+t}if(ENVIRONMENT_IS_NODE){var fs=require("fs"),nodePath=require("path");scriptDirectory=ENVIRONMENT_IS_WORKER?nodePath.dirname(scriptDirectory)+"/":__dirname+"/",read_=(t,e)=>(t=isFileURI(t)?new URL(t):nodePath.normalize(t),fs.readFileSync(t,e?void 0:"utf8")),readBinary=t=>{var e=read_(t,!0);return e.buffer||(e=new Uint8Array(e)),e},readAsync=(t,e,r,n=!0)=>{t=isFileURI(t)?new URL(t):nodePath.normalize(t),fs.readFile(t,n?void 0:"utf8",(o,s)=>{o?r(o):e(n?s.buffer:s)})},!Module.thisProgram&&process.argv.length>1&&(thisProgram=process.argv[1].replace(/\\/g,"/")),arguments_=process.argv.slice(2),typeof module<"u"&&(module.exports=Module),quit_=(t,e)=>{throw process.exitCode=t,e}}else(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)&&(ENVIRONMENT_IS_WORKER?scriptDirectory=self.location.href:document!==void 0&&document.currentScript&&(scriptDirectory=document.currentScript.src),scriptDirectory=scriptDirectory.startsWith("blob:")?"":scriptDirectory.substr(0,scriptDirectory.replace(/[?#].*/,"").lastIndexOf("/")+1),read_=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},ENVIRONMENT_IS_WORKER&&(readBinary=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),readAsync=(t,e,r)=>{var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=()=>{n.status==200||n.status==0&&n.response?e(n.response):r()},n.onerror=r,n.send(null)});var out=Module.print||console.log.bind(console),err=Module.printErr||console.error.bind(console);Object.assign(Module,moduleOverrides),moduleOverrides=null,Module.arguments&&(arguments_=Module.arguments),Module.thisProgram&&(thisProgram=Module.thisProgram),Module.quit&&(quit_=Module.quit);var dynamicLibraries=Module.dynamicLibraries||[],wasmBinary,wasmMemory;Module.wasmBinary&&(wasmBinary=Module.wasmBinary),typeof WebAssembly!="object"&&abort("no native wasm support detected");var ABORT=!1,EXITSTATUS,HEAP8,HEAPU8,HEAP16,HEAPU16,HEAP32,HEAPU32,HEAPF32,HEAPF64;function updateMemoryViews(){var t=wasmMemory.buffer;Module.HEAP8=HEAP8=new Int8Array(t),Module.HEAP16=HEAP16=new Int16Array(t),Module.HEAPU8=HEAPU8=new Uint8Array(t),Module.HEAPU16=HEAPU16=new Uint16Array(t),Module.HEAP32=HEAP32=new Int32Array(t),Module.HEAPU32=HEAPU32=new Uint32Array(t),Module.HEAPF32=HEAPF32=new Float32Array(t),Module.HEAPF64=HEAPF64=new Float64Array(t)}var INITIAL_MEMORY=Module.INITIAL_MEMORY||33554432;wasmMemory=Module.wasmMemory?Module.wasmMemory:new WebAssembly.Memory({initial:INITIAL_MEMORY/65536,maximum:32768}),updateMemoryViews(),INITIAL_MEMORY=wasmMemory.buffer.byteLength;var __ATPRERUN__=[],__ATINIT__=[],__ATMAIN__=[],__ATPOSTRUN__=[],__RELOC_FUNCS__=[],runtimeInitialized=!1;function preRun(){if(Module.preRun)for(typeof Module.preRun=="function"&&(Module.preRun=[Module.preRun]);Module.preRun.length;)addOnPreRun(Module.preRun.shift());callRuntimeCallbacks(__ATPRERUN__)}function initRuntime(){runtimeInitialized=!0,callRuntimeCallbacks(__RELOC_FUNCS__),callRuntimeCallbacks(__ATINIT__)}function preMain(){callRuntimeCallbacks(__ATMAIN__)}function postRun(){if(Module.postRun)for(typeof Module.postRun=="function"&&(Module.postRun=[Module.postRun]);Module.postRun.length;)addOnPostRun(Module.postRun.shift());callRuntimeCallbacks(__ATPOSTRUN__)}function addOnPreRun(t){__ATPRERUN__.unshift(t)}function addOnInit(t){__ATINIT__.unshift(t)}function addOnPostRun(t){__ATPOSTRUN__.unshift(t)}var runDependencies=0,runDependencyWatcher=null,dependenciesFulfilled=null;function getUniqueRunDependency(t){return t}function addRunDependency(t){runDependencies++,Module.monitorRunDependencies?.(runDependencies)}function removeRunDependency(t){if(runDependencies--,Module.monitorRunDependencies?.(runDependencies),runDependencies==0&&(runDependencyWatcher!==null&&(clearInterval(runDependencyWatcher),runDependencyWatcher=null),dependenciesFulfilled)){var e=dependenciesFulfilled;dependenciesFulfilled=null,e()}}function abort(t){throw Module.onAbort?.(t),err(t="Aborted("+t+")"),ABORT=!0,EXITSTATUS=1,t+=". Build with -sASSERTIONS for more info.",new WebAssembly.RuntimeError(t)}var dataURIPrefix="data:application/octet-stream;base64,",isDataURI=t=>t.startsWith(dataURIPrefix),isFileURI=t=>t.startsWith("file://"),wasmBinaryFile;function getBinarySync(t){if(t==wasmBinaryFile&&wasmBinary)return new Uint8Array(wasmBinary);if(readBinary)return readBinary(t);throw"both async and sync fetching of the wasm failed"}function getBinaryPromise(t){if(!wasmBinary&&(ENVIRONMENT_IS_WEB||ENVIRONMENT_IS_WORKER)){if(typeof fetch=="function"&&!isFileURI(t))return fetch(t,{credentials:"same-origin"}).then(e=>{if(!e.ok)throw`failed to load wasm binary file at '${t}'`;return e.arrayBuffer()}).catch(()=>getBinarySync(t));if(readAsync)return new Promise((e,r)=>{readAsync(t,n=>e(new Uint8Array(n)),r)})}return Promise.resolve().then(()=>getBinarySync(t))}function instantiateArrayBuffer(t,e,r){return getBinaryPromise(t).then(n=>WebAssembly.instantiate(n,e)).then(r,n=>{err(`failed to asynchronously prepare wasm: ${n}`),abort(n)})}function instantiateAsync(t,e,r,n){return t||typeof WebAssembly.instantiateStreaming!="function"||isDataURI(e)||isFileURI(e)||ENVIRONMENT_IS_NODE||typeof fetch!="function"?instantiateArrayBuffer(e,r,n):fetch(e,{credentials:"same-origin"}).then(o=>WebAssembly.instantiateStreaming(o,r).then(n,function(s){return err(`wasm streaming compile failed: ${s}`),err("falling back to ArrayBuffer instantiation"),instantiateArrayBuffer(e,r,n)}))}function createWasm(){var t={env:wasmImports,wasi_snapshot_preview1:wasmImports,"GOT.mem":new Proxy(wasmImports,GOTHandler),"GOT.func":new Proxy(wasmImports,GOTHandler)};function e(r,n){wasmExports=r.exports,wasmExports=relocateExports(wasmExports,1024);var o=getDylinkMetadata(n);return o.neededDynlibs&&(dynamicLibraries=o.neededDynlibs.concat(dynamicLibraries)),mergeLibSymbols(wasmExports,"main"),LDSO.init(),loadDylibs(),addOnInit(wasmExports.__wasm_call_ctors),__RELOC_FUNCS__.push(wasmExports.__wasm_apply_data_relocs),removeRunDependency("wasm-instantiate"),wasmExports}if(addRunDependency("wasm-instantiate"),Module.instantiateWasm)try{return Module.instantiateWasm(t,e)}catch(r){return err(`Module.instantiateWasm callback failed with error: ${r}`),!1}return instantiateAsync(wasmBinary,wasmBinaryFile,t,function(r){e(r.instance,r.module)}),{}}wasmBinaryFile="tree-sitter.wasm",isDataURI(wasmBinaryFile)||(wasmBinaryFile=locateFile(wasmBinaryFile));var ASM_CONSTS={};function ExitStatus(t){this.name="ExitStatus",this.message=`Program terminated with exit(${t})`,this.status=t}var GOT={},currentModuleWeakSymbols=new Set([]),GOTHandler={get(t,e){var r=GOT[e];return r||(r=GOT[e]=new WebAssembly.Global({value:"i32",mutable:!0})),currentModuleWeakSymbols.has(e)||(r.required=!0),r}},callRuntimeCallbacks=t=>{for(;t.length>0;)t.shift()(Module)},UTF8Decoder=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,UTF8ArrayToString=(t,e,r)=>{for(var n=e+r,o=e;t[o]&&!(o>=n);)++o;if(o-e>16&&t.buffer&&UTF8Decoder)return UTF8Decoder.decode(t.subarray(e,o));for(var s="";e<o;){var a=t[e++];if(128&a){var c=63&t[e++];if((224&a)!=192){var u=63&t[e++];if((a=(240&a)==224?(15&a)<<12|c<<6|u:(7&a)<<18|c<<12|u<<6|63&t[e++])<65536)s+=String.fromCharCode(a);else{var l=a-65536;s+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else s+=String.fromCharCode((31&a)<<6|c)}else s+=String.fromCharCode(a)}return s},getDylinkMetadata=t=>{var e=0,r=0;function n(){for(var y=0,b=1;;){var _=t[e++];if(y+=(127&_)*b,b*=128,!(128&_))break}return y}function o(){var y=n();return UTF8ArrayToString(t,(e+=y)-y,y)}function s(y,b){if(y)throw new Error(b)}var a="dylink.0";if(t instanceof WebAssembly.Module){var c=WebAssembly.Module.customSections(t,a);c.length===0&&(a="dylink",c=WebAssembly.Module.customSections(t,a)),s(c.length===0,"need dylink section"),r=(t=new Uint8Array(c[0])).length}else{s(new Uint32Array(new Uint8Array(t.subarray(0,24)).buffer)[0]!=1836278016,"need to see wasm magic number"),s(t[8]!==0,"need the dylink section to be first"),e=9;var u=n();r=e+u,a=o()}var l={neededDynlibs:[],tlsExports:new Set,weakImports:new Set};if(a=="dylink"){l.memorySize=n(),l.memoryAlign=n(),l.tableSize=n(),l.tableAlign=n();for(var d=n(),p=0;p<d;++p){var f=o();l.neededDynlibs.push(f)}}else for(s(a!=="dylink.0");e<r;){var m=t[e++],h=n();if(m===1)l.memorySize=n(),l.memoryAlign=n(),l.tableSize=n(),l.tableAlign=n();else if(m===2)for(d=n(),p=0;p<d;++p)f=o(),l.neededDynlibs.push(f);else if(m===3)for(var g=n();g--;){var v=o();256&n()&&l.tlsExports.add(v)}else if(m===4)for(g=n();g--;)o(),v=o(),(3&n())==1&&l.weakImports.add(v);else e+=h}return l};function getValue(t,e="i8"){switch(e.endsWith("*")&&(e="*"),e){case"i1":case"i8":return HEAP8[t];case"i16":return HEAP16[t>>1];case"i32":return HEAP32[t>>2];case"i64":abort("to do getValue(i64) use WASM_BIGINT");case"float":return HEAPF32[t>>2];case"double":return HEAPF64[t>>3];case"*":return HEAPU32[t>>2];default:abort(`invalid type for getValue: ${e}`)}}var newDSO=(t,e,r)=>{var n={refcount:1/0,name:t,exports:r,global:!0};return LDSO.loadedLibsByName[t]=n,e!=null&&(LDSO.loadedLibsByHandle[e]=n),n},LDSO={loadedLibsByName:{},loadedLibsByHandle:{},init(){newDSO("__main__",0,wasmImports)}},___heap_base=78096,zeroMemory=(t,e)=>(HEAPU8.fill(0,t,t+e),t),alignMemory=(t,e)=>Math.ceil(t/e)*e,getMemory=t=>{if(runtimeInitialized)return zeroMemory(_malloc(t),t);var e=___heap_base,r=e+alignMemory(t,16);return ___heap_base=r,GOT.__heap_base.value=r,e},isInternalSym=t=>["__cpp_exception","__c_longjmp","__wasm_apply_data_relocs","__dso_handle","__tls_size","__tls_align","__set_stack_limits","_emscripten_tls_init","__wasm_init_tls","__wasm_call_ctors","__start_em_asm","__stop_em_asm","__start_em_js","__stop_em_js"].includes(t)||t.startsWith("__em_js__"),uleb128Encode=(t,e)=>{t<128?e.push(t):e.push(t%128|128,t>>7)},sigToWasmTypes=t=>{for(var e={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},r={parameters:[],results:t[0]=="v"?[]:[e[t[0]]]},n=1;n<t.length;++n)r.parameters.push(e[t[n]]);return r},generateFuncType=(t,e)=>{var r=t.slice(0,1),n=t.slice(1),o={i:127,p:127,j:126,f:125,d:124,e:111};e.push(96),uleb128Encode(n.length,e);for(var s=0;s<n.length;++s)e.push(o[n[s]]);r=="v"?e.push(0):e.push(1,o[r])},convertJsFunctionToWasm=(t,e)=>{if(typeof WebAssembly.Function=="function")return new WebAssembly.Function(sigToWasmTypes(e),t);var r=[1];generateFuncType(e,r);var n=[0,97,115,109,1,0,0,0,1];uleb128Encode(r.length,n),n.push(...r),n.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var o=new WebAssembly.Module(new Uint8Array(n));return new WebAssembly.Instance(o,{e:{f:t}}).exports.f},wasmTableMirror=[],wasmTable=new WebAssembly.Table({initial:27,element:"anyfunc"}),getWasmTableEntry=t=>{var e=wasmTableMirror[t];return e||(t>=wasmTableMirror.length&&(wasmTableMirror.length=t+1),wasmTableMirror[t]=e=wasmTable.get(t)),e},updateTableMap=(t,e)=>{if(functionsInTableMap)for(var r=t;r<t+e;r++){var n=getWasmTableEntry(r);n&&functionsInTableMap.set(n,r)}},functionsInTableMap,getFunctionAddress=t=>(functionsInTableMap||(functionsInTableMap=new WeakMap,updateTableMap(0,wasmTable.length)),functionsInTableMap.get(t)||0),freeTableIndexes=[],getEmptyTableSlot=()=>{if(freeTableIndexes.length)return freeTableIndexes.pop();try{wasmTable.grow(1)}catch(t){throw t instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":t}return wasmTable.length-1},setWasmTableEntry=(t,e)=>{wasmTable.set(t,e),wasmTableMirror[t]=wasmTable.get(t)},addFunction=(t,e)=>{var r=getFunctionAddress(t);if(r)return r;var n=getEmptyTableSlot();try{setWasmTableEntry(n,t)}catch(s){if(!(s instanceof TypeError))throw s;var o=convertJsFunctionToWasm(t,e);setWasmTableEntry(n,o)}return functionsInTableMap.set(t,n),n},updateGOT=(t,e)=>{for(var r in t)if(!isInternalSym(r)){var n=t[r];r.startsWith("orig$")&&(r=r.split("$")[1],e=!0),GOT[r]||=new WebAssembly.Global({value:"i32",mutable:!0}),(e||GOT[r].value==0)&&(typeof n=="function"?GOT[r].value=addFunction(n):typeof n=="number"?GOT[r].value=n:err(`unhandled export type for '${r}': ${typeof n}`))}},relocateExports=(t,e,r)=>{var n={};for(var o in t){var s=t[o];typeof s=="object"&&(s=s.value),typeof s=="number"&&(s+=e),n[o]=s}return updateGOT(n,r),n},isSymbolDefined=t=>{var e=wasmImports[t];return!(!e||e.stub)},dynCallLegacy=(t,e,r)=>(0,Module["dynCall_"+t])(e,...r),dynCall=(t,e,r=[])=>t.includes("j")?dynCallLegacy(t,e,r):getWasmTableEntry(e)(...r),createInvokeFunction=t=>function(){var e=stackSave();try{return dynCall(t,arguments[0],Array.prototype.slice.call(arguments,1))}catch(r){if(stackRestore(e),r!==r+0)throw r;_setThrew(1,0)}},resolveGlobalSymbol=(t,e=!1)=>{var r;return e&&"orig$"+t in wasmImports&&(t="orig$"+t),isSymbolDefined(t)?r=wasmImports[t]:t.startsWith("invoke_")&&(r=wasmImports[t]=createInvokeFunction(t.split("_")[1])),{sym:r,name:t}},UTF8ToString=(t,e)=>t?UTF8ArrayToString(HEAPU8,t,e):"",loadWebAssemblyModule=(binary,flags,libName,localScope,handle)=>{var metadata=getDylinkMetadata(binary);function loadModule(){var firstLoad=!handle||!HEAP8[handle+8];if(firstLoad){var memAlign=Math.pow(2,metadata.memoryAlign),memoryBase=metadata.memorySize?alignMemory(getMemory(metadata.memorySize+memAlign),memAlign):0,tableBase=metadata.tableSize?wasmTable.length:0;handle&&(HEAP8[handle+8]=1,HEAPU32[handle+12>>2]=memoryBase,HEAP32[handle+16>>2]=metadata.memorySize,HEAPU32[handle+20>>2]=tableBase,HEAP32[handle+24>>2]=metadata.tableSize)}else memoryBase=HEAPU32[handle+12>>2],tableBase=HEAPU32[handle+20>>2];var tableGrowthNeeded=tableBase+metadata.tableSize-wasmTable.length,moduleExports;function resolveSymbol(t){var e=resolveGlobalSymbol(t).sym;return!e&&localScope&&(e=localScope[t]),e||(e=moduleExports[t]),e}tableGrowthNeeded>0&&wasmTable.grow(tableGrowthNeeded);var proxyHandler={get(t,e){switch(e){case"__memory_base":return memoryBase;case"__table_base":return tableBase}if(e in wasmImports&&!wasmImports[e].stub)return wasmImports[e];var r;return e in t||(t[e]=(...n)=>(r||=resolveSymbol(e),r(...n))),t[e]}},proxy=new Proxy({},proxyHandler),info={"GOT.mem":new Proxy({},GOTHandler),"GOT.func":new Proxy({},GOTHandler),env:proxy,wasi_snapshot_preview1:proxy};function postInstantiation(module,instance){function addEmAsm(addr,body){for(var args=[],arity=0;arity<16&&body.indexOf("$"+arity)!=-1;arity++)args.push("$"+arity);args=args.join(",");var func=`(${args}) => { ${body} };`;ASM_CONSTS[start]=eval(func)}if(updateTableMap(tableBase,metadata.tableSize),moduleExports=relocateExports(instance.exports,memoryBase),flags.allowUndefined||reportUndefinedSymbols(),"__start_em_asm"in moduleExports)for(var start=moduleExports.__start_em_asm,stop=moduleExports.__stop_em_asm;start<stop;){var jsString=UTF8ToString(start);addEmAsm(start,jsString),start=HEAPU8.indexOf(0,start)+1}function addEmJs(name,cSig,body){var jsArgs=[];if(cSig=cSig.slice(1,-1),cSig!="void")for(var i in cSig=cSig.split(","),cSig){var jsArg=cSig[i].split(" ").pop();jsArgs.push(jsArg.replace("*",""))}var func=`(${jsArgs}) => ${body};`;moduleExports[name]=eval(func)}for(var name in moduleExports)if(name.startsWith("__em_js__")){var start=moduleExports[name],jsString=UTF8ToString(start),parts=jsString.split("<::>");addEmJs(name.replace("__em_js__",""),parts[0],parts[1]),delete moduleExports[name]}var applyRelocs=moduleExports.__wasm_apply_data_relocs;applyRelocs&&(runtimeInitialized?applyRelocs():__RELOC_FUNCS__.push(applyRelocs));var init=moduleExports.__wasm_call_ctors;return init&&(runtimeInitialized?init():__ATINIT__.push(init)),moduleExports}if(flags.loadAsync){if(binary instanceof WebAssembly.Module){var instance=new WebAssembly.Instance(binary,info);return Promise.resolve(postInstantiation(binary,instance))}return WebAssembly.instantiate(binary,info).then(t=>postInstantiation(t.module,t.instance))}var module=binary instanceof WebAssembly.Module?binary:new WebAssembly.Module(binary),instance=new WebAssembly.Instance(module,info);return postInstantiation(module,instance)}return currentModuleWeakSymbols=metadata.weakImports,flags.loadAsync?metadata.neededDynlibs.reduce((t,e)=>t.then(()=>loadDynamicLibrary(e,flags)),Promise.resolve()).then(loadModule):(metadata.neededDynlibs.forEach(t=>loadDynamicLibrary(t,flags,localScope)),loadModule())},mergeLibSymbols=(t,e)=>{for(var[r,n]of Object.entries(t)){let o=a=>{isSymbolDefined(a)||(wasmImports[a]=n)};o(r);let s="__main_argc_argv";r=="main"&&o(s),r==s&&o("main"),r.startsWith("dynCall_")&&!Module.hasOwnProperty(r)&&(Module[r]=n)}},asyncLoad=(t,e,r,n)=>{var o=n?"":`al ${t}`;readAsync(t,s=>{e(new Uint8Array(s)),o&&removeRunDependency(o)},s=>{if(!r)throw`Loading data file "${t}" failed.`;r()}),o&&addRunDependency(o)};function loadDynamicLibrary(t,e={global:!0,nodelete:!0},r,n){var o=LDSO.loadedLibsByName[t];if(o)return e.global?o.global||(o.global=!0,mergeLibSymbols(o.exports,t)):r&&Object.assign(r,o.exports),e.nodelete&&o.refcount!==1/0&&(o.refcount=1/0),o.refcount++,n&&(LDSO.loadedLibsByHandle[n]=o),!e.loadAsync||Promise.resolve(!0);function s(){if(n){var u=HEAPU32[n+28>>2],l=HEAPU32[n+32>>2];if(u&&l){var d=HEAP8.slice(u,u+l);return e.loadAsync?Promise.resolve(d):d}}var p=locateFile(t);if(e.loadAsync)return new Promise(function(f,m){asyncLoad(p,f,m)});if(!readBinary)throw new Error(`${p}: file not found, and synchronous loading of external files is not available`);return readBinary(p)}function a(){return e.loadAsync?s().then(u=>loadWebAssemblyModule(u,e,t,r,n)):loadWebAssemblyModule(s(),e,t,r,n)}function c(u){o.global?mergeLibSymbols(u,t):r&&Object.assign(r,u),o.exports=u}return(o=newDSO(t,n,"loading")).refcount=e.nodelete?1/0:1,o.global=e.global,e.loadAsync?a().then(u=>(c(u),!0)):(c(a()),!0)}var reportUndefinedSymbols=()=>{for(var[t,e]of Object.entries(GOT))if(e.value==0){var r=resolveGlobalSymbol(t,!0).sym;if(!r&&!e.required)continue;if(typeof r=="function")e.value=addFunction(r,r.sig);else{if(typeof r!="number")throw new Error(`bad export type for '${t}': ${typeof r}`);e.value=r}}},loadDylibs=()=>{dynamicLibraries.length?(addRunDependency("loadDylibs"),dynamicLibraries.reduce((t,e)=>t.then(()=>loadDynamicLibrary(e,{loadAsync:!0,global:!0,nodelete:!0,allowUndefined:!0})),Promise.resolve()).then(()=>{reportUndefinedSymbols(),removeRunDependency("loadDylibs")})):reportUndefinedSymbols()},noExitRuntime=Module.noExitRuntime||!0;function setValue(t,e,r="i8"){switch(r.endsWith("*")&&(r="*"),r){case"i1":case"i8":HEAP8[t]=e;break;case"i16":HEAP16[t>>1]=e;break;case"i32":HEAP32[t>>2]=e;break;case"i64":abort("to do setValue(i64) use WASM_BIGINT");case"float":HEAPF32[t>>2]=e;break;case"double":HEAPF64[t>>3]=e;break;case"*":HEAPU32[t>>2]=e;break;default:abort(`invalid type for setValue: ${r}`)}}var ___memory_base=new WebAssembly.Global({value:"i32",mutable:!1},1024),___stack_pointer=new WebAssembly.Global({value:"i32",mutable:!0},78096),___table_base=new WebAssembly.Global({value:"i32",mutable:!1},1),nowIsMonotonic=1,__emscripten_get_now_is_monotonic=()=>nowIsMonotonic;__emscripten_get_now_is_monotonic.sig="i";var _abort=()=>{abort("")};_abort.sig="v";var _emscripten_date_now=()=>Date.now(),_emscripten_get_now;_emscripten_date_now.sig="d",_emscripten_get_now=()=>performance.now(),_emscripten_get_now.sig="d";var _emscripten_memcpy_js=(t,e,r)=>HEAPU8.copyWithin(t,e,e+r);_emscripten_memcpy_js.sig="vppp";var getHeapMax=()=>2147483648,growMemory=t=>{var e=(t-wasmMemory.buffer.byteLength+65535)/65536;try{return wasmMemory.grow(e),updateMemoryViews(),1}catch{}},_emscripten_resize_heap=t=>{var e=HEAPU8.length;t>>>=0;var r=getHeapMax();if(t>r)return!1;for(var n,o,s=1;s<=4;s*=2){var a=e*(1+.2/s);a=Math.min(a,t+100663296);var c=Math.min(r,(n=Math.max(t,a))+((o=65536)-n%o)%o);if(growMemory(c))return!0}return!1};_emscripten_resize_heap.sig="ip";var _fd_close=t=>52;_fd_close.sig="ii";var convertI32PairToI53Checked=(t,e)=>e+2097152>>>0<4194305-!!t?(t>>>0)+4294967296*e:NaN;function _fd_seek(t,e,r,n,o){return convertI32PairToI53Checked(e,r),70}_fd_seek.sig="iiiiip";var printCharBuffers=[null,[],[]],printChar=(t,e)=>{var r=printCharBuffers[t];e===0||e===10?((t===1?out:err)(UTF8ArrayToString(r,0)),r.length=0):r.push(e)},SYSCALLS={varargs:void 0,get(){var t=HEAP32[+SYSCALLS.varargs>>2];return SYSCALLS.varargs+=4,t},getp:()=>SYSCALLS.get(),getStr:t=>UTF8ToString(t)},_fd_write=(t,e,r,n)=>{for(var o=0,s=0;s<r;s++){var a=HEAPU32[e>>2],c=HEAPU32[e+4>>2];e+=8;for(var u=0;u<c;u++)printChar(t,HEAPU8[a+u]);o+=c}return HEAPU32[n>>2]=o,0};function _tree_sitter_log_callback(t,e){if(currentLogCallback){let r=UTF8ToString(e);currentLogCallback(r,t!==0)}}function _tree_sitter_parse_callback(t,e,r,n,o){let s=currentParseCallback(e,{row:r,column:n});typeof s=="string"?(setValue(o,s.length,"i32"),stringToUTF16(s,t,10240)):setValue(o,0,"i32")}_fd_write.sig="iippp";var runtimeKeepaliveCounter=0,keepRuntimeAlive=()=>noExitRuntime||runtimeKeepaliveCounter>0,_proc_exit=t=>{EXITSTATUS=t,keepRuntimeAlive()||(Module.onExit?.(t),ABORT=!0),quit_(t,new ExitStatus(t))};_proc_exit.sig="vi";var exitJS=(t,e)=>{EXITSTATUS=t,_proc_exit(t)},handleException=t=>{if(t instanceof ExitStatus||t=="unwind")return EXITSTATUS;quit_(1,t)},lengthBytesUTF8=t=>{for(var e=0,r=0;r<t.length;++r){var n=t.charCodeAt(r);n<=127?e++:n<=2047?e+=2:n>=55296&&n<=57343?(e+=4,++r):e+=3}return e},stringToUTF8Array=(t,e,r,n)=>{if(!(n>0))return 0;for(var o=r,s=r+n-1,a=0;a<t.length;++a){var c=t.charCodeAt(a);if(c>=55296&&c<=57343&&(c=65536+((1023&c)<<10)|1023&t.charCodeAt(++a)),c<=127){if(r>=s)break;e[r++]=c}else if(c<=2047){if(r+1>=s)break;e[r++]=192|c>>6,e[r++]=128|63&c}else if(c<=65535){if(r+2>=s)break;e[r++]=224|c>>12,e[r++]=128|c>>6&63,e[r++]=128|63&c}else{if(r+3>=s)break;e[r++]=240|c>>18,e[r++]=128|c>>12&63,e[r++]=128|c>>6&63,e[r++]=128|63&c}}return e[r]=0,r-o},stringToUTF8=(t,e,r)=>stringToUTF8Array(t,HEAPU8,e,r),stringToUTF8OnStack=t=>{var e=lengthBytesUTF8(t)+1,r=stackAlloc(e);return stringToUTF8(t,r,e),r},stringToUTF16=(t,e,r)=>{if(r??=2147483647,r<2)return 0;for(var n=e,o=(r-=2)<2*t.length?r/2:t.length,s=0;s<o;++s){var a=t.charCodeAt(s);HEAP16[e>>1]=a,e+=2}return HEAP16[e>>1]=0,e-n},AsciiToString=t=>{for(var e="";;){var r=HEAPU8[t++];if(!r)return e;e+=String.fromCharCode(r)}},wasmImports={__heap_base:___heap_base,__indirect_function_table:wasmTable,__memory_base:___memory_base,__stack_pointer:___stack_pointer,__table_base:___table_base,_emscripten_get_now_is_monotonic:__emscripten_get_now_is_monotonic,abort:_abort,emscripten_get_now:_emscripten_get_now,emscripten_memcpy_js:_emscripten_memcpy_js,emscripten_resize_heap:_emscripten_resize_heap,fd_close:_fd_close,fd_seek:_fd_seek,fd_write:_fd_write,memory:wasmMemory,tree_sitter_log_callback:_tree_sitter_log_callback,tree_sitter_parse_callback:_tree_sitter_parse_callback},wasmExports=createWasm(),___wasm_call_ctors=()=>(___wasm_call_ctors=wasmExports.__wasm_call_ctors)(),___wasm_apply_data_relocs=()=>(___wasm_apply_data_relocs=wasmExports.__wasm_apply_data_relocs)(),_malloc=Module._malloc=t=>(_malloc=Module._malloc=wasmExports.malloc)(t),_calloc=Module._calloc=(t,e)=>(_calloc=Module._calloc=wasmExports.calloc)(t,e),_realloc=Module._realloc=(t,e)=>(_realloc=Module._realloc=wasmExports.realloc)(t,e),_free=Module._free=t=>(_free=Module._free=wasmExports.free)(t),_ts_language_symbol_count=Module._ts_language_symbol_count=t=>(_ts_language_symbol_count=Module._ts_language_symbol_count=wasmExports.ts_language_symbol_count)(t),_ts_language_state_count=Module._ts_language_state_count=t=>(_ts_language_state_count=Module._ts_language_state_count=wasmExports.ts_language_state_count)(t),_ts_language_version=Module._ts_language_version=t=>(_ts_language_version=Module._ts_language_version=wasmExports.ts_language_version)(t),_ts_language_field_count=Module._ts_language_field_count=t=>(_ts_language_field_count=Module._ts_language_field_count=wasmExports.ts_language_field_count)(t),_ts_language_next_state=Module._ts_language_next_state=(t,e,r)=>(_ts_language_next_state=Module._ts_language_next_state=wasmExports.ts_language_next_state)(t,e,r),_ts_language_symbol_name=Module._ts_language_symbol_name=(t,e)=>(_ts_language_symbol_name=Module._ts_language_symbol_name=wasmExports.ts_language_symbol_name)(t,e),_ts_language_symbol_for_name=Module._ts_language_symbol_for_name=(t,e,r,n)=>(_ts_language_symbol_for_name=Module._ts_language_symbol_for_name=wasmExports.ts_language_symbol_for_name)(t,e,r,n),_strncmp=Module._strncmp=(t,e,r)=>(_strncmp=Module._strncmp=wasmExports.strncmp)(t,e,r),_ts_language_symbol_type=Module._ts_language_symbol_type=(t,e)=>(_ts_language_symbol_type=Module._ts_language_symbol_type=wasmExports.ts_language_symbol_type)(t,e),_ts_language_field_name_for_id=Module._ts_language_field_name_for_id=(t,e)=>(_ts_language_field_name_for_id=Module._ts_language_field_name_for_id=wasmExports.ts_language_field_name_for_id)(t,e),_ts_lookahead_iterator_new=Module._ts_lookahead_iterator_new=(t,e)=>(_ts_lookahead_iterator_new=Module._ts_lookahead_iterator_new=wasmExports.ts_lookahead_iterator_new)(t,e),_ts_lookahead_iterator_delete=Module._ts_lookahead_iterator_delete=t=>(_ts_lookahead_iterator_delete=Module._ts_lookahead_iterator_delete=wasmExports.ts_lookahead_iterator_delete)(t),_ts_lookahead_iterator_reset_state=Module._ts_lookahead_iterator_reset_state=(t,e)=>(_ts_lookahead_iterator_reset_state=Module._ts_lookahead_iterator_reset_state=wasmExports.ts_lookahead_iterator_reset_state)(t,e),_ts_lookahead_iterator_reset=Module._ts_lookahead_iterator_reset=(t,e,r)=>(_ts_lookahead_iterator_reset=Module._ts_lookahead_iterator_reset=wasmExports.ts_lookahead_iterator_reset)(t,e,r),_ts_lookahead_iterator_next=Module._ts_lookahead_iterator_next=t=>(_ts_lookahead_iterator_next=Module._ts_lookahead_iterator_next=wasmExports.ts_lookahead_iterator_next)(t),_ts_lookahead_iterator_current_symbol=Module._ts_lookahead_iterator_current_symbol=t=>(_ts_lookahead_iterator_current_symbol=Module._ts_lookahead_iterator_current_symbol=wasmExports.ts_lookahead_iterator_current_symbol)(t),_memset=Module._memset=(t,e,r)=>(_memset=Module._memset=wasmExports.memset)(t,e,r),_memcpy=Module._memcpy=(t,e,r)=>(_memcpy=Module._memcpy=wasmExports.memcpy)(t,e,r),_ts_parser_delete=Module._ts_parser_delete=t=>(_ts_parser_delete=Module._ts_parser_delete=wasmExports.ts_parser_delete)(t),_ts_parser_reset=Module._ts_parser_reset=t=>(_ts_parser_reset=Module._ts_parser_reset=wasmExports.ts_parser_reset)(t),_ts_parser_set_language=Module._ts_parser_set_language=(t,e)=>(_ts_parser_set_language=Module._ts_parser_set_language=wasmExports.ts_parser_set_language)(t,e),_ts_parser_timeout_micros=Module._ts_parser_timeout_micros=t=>(_ts_parser_timeout_micros=Module._ts_parser_timeout_micros=wasmExports.ts_parser_timeout_micros)(t),_ts_parser_set_timeout_micros=Module._ts_parser_set_timeout_micros=(t,e,r)=>(_ts_parser_set_timeout_micros=Module._ts_parser_set_timeout_micros=wasmExports.ts_parser_set_timeout_micros)(t,e,r),_ts_parser_set_included_ranges=Module._ts_parser_set_included_ranges=(t,e,r)=>(_ts_parser_set_included_ranges=Module._ts_parser_set_included_ranges=wasmExports.ts_parser_set_included_ranges)(t,e,r),_memmove=Module._memmove=(t,e,r)=>(_memmove=Module._memmove=wasmExports.memmove)(t,e,r),_memcmp=Module._memcmp=(t,e,r)=>(_memcmp=Module._memcmp=wasmExports.memcmp)(t,e,r),_ts_query_new=Module._ts_query_new=(t,e,r,n,o)=>(_ts_query_new=Module._ts_query_new=wasmExports.ts_query_new)(t,e,r,n,o),_ts_query_delete=Module._ts_query_delete=t=>(_ts_query_delete=Module._ts_query_delete=wasmExports.ts_query_delete)(t),_iswspace=Module._iswspace=t=>(_iswspace=Module._iswspace=wasmExports.iswspace)(t),_iswalnum=Module._iswalnum=t=>(_iswalnum=Module._iswalnum=wasmExports.iswalnum)(t),_ts_query_pattern_count=Module._ts_query_pattern_count=t=>(_ts_query_pattern_count=Module._ts_query_pattern_count=wasmExports.ts_query_pattern_count)(t),_ts_query_capture_count=Module._ts_query_capture_count=t=>(_ts_query_capture_count=Module._ts_query_capture_count=wasmExports.ts_query_capture_count)(t),_ts_query_string_count=Module._ts_query_string_count=t=>(_ts_query_string_count=Module._ts_query_string_count=wasmExports.ts_query_string_count)(t),_ts_query_capture_name_for_id=Module._ts_query_capture_name_for_id=(t,e,r)=>(_ts_query_capture_name_for_id=Module._ts_query_capture_name_for_id=wasmExports.ts_query_capture_name_for_id)(t,e,r),_ts_query_string_value_for_id=Module._ts_query_string_value_for_id=(t,e,r)=>(_ts_query_string_value_for_id=Module._ts_query_string_value_for_id=wasmExports.ts_query_string_value_for_id)(t,e,r),_ts_query_predicates_for_pattern=Module._ts_query_predicates_for_pattern=(t,e,r)=>(_ts_query_predicates_for_pattern=Module._ts_query_predicates_for_pattern=wasmExports.ts_query_predicates_for_pattern)(t,e,r),_ts_query_disable_capture=Module._ts_query_disable_capture=(t,e,r)=>(_ts_query_disable_capture=Module._ts_query_disable_capture=wasmExports.ts_query_disable_capture)(t,e,r),_ts_tree_copy=Module._ts_tree_copy=t=>(_ts_tree_copy=Module._ts_tree_copy=wasmExports.ts_tree_copy)(t),_ts_tree_delete=Module._ts_tree_delete=t=>(_ts_tree_delete=Module._ts_tree_delete=wasmExports.ts_tree_delete)(t),_ts_init=Module._ts_init=()=>(_ts_init=Module._ts_init=wasmExports.ts_init)(),_ts_parser_new_wasm=Module._ts_parser_new_wasm=()=>(_ts_parser_new_wasm=Module._ts_parser_new_wasm=wasmExports.ts_parser_new_wasm)(),_ts_parser_enable_logger_wasm=Module._ts_parser_enable_logger_wasm=(t,e)=>(_ts_parser_enable_logger_wasm=Module._ts_parser_enable_logger_wasm=wasmExports.ts_parser_enable_logger_wasm)(t,e),_ts_parser_parse_wasm=Module._ts_parser_parse_wasm=(t,e,r,n,o)=>(_ts_parser_parse_wasm=Module._ts_parser_parse_wasm=wasmExports.ts_parser_parse_wasm)(t,e,r,n,o),_ts_parser_included_ranges_wasm=Module._ts_parser_included_ranges_wasm=t=>(_ts_parser_included_ranges_wasm=Module._ts_parser_included_ranges_wasm=wasmExports.ts_parser_included_ranges_wasm)(t),_ts_language_type_is_named_wasm=Module._ts_language_type_is_named_wasm=(t,e)=>(_ts_language_type_is_named_wasm=Module._ts_language_type_is_named_wasm=wasmExports.ts_language_type_is_named_wasm)(t,e),_ts_language_type_is_visible_wasm=Module._ts_language_type_is_visible_wasm=(t,e)=>(_ts_language_type_is_visible_wasm=Module._ts_language_type_is_visible_wasm=wasmExports.ts_language_type_is_visible_wasm)(t,e),_ts_tree_root_node_wasm=Module._ts_tree_root_node_wasm=t=>(_ts_tree_root_node_wasm=Module._ts_tree_root_node_wasm=wasmExports.ts_tree_root_node_wasm)(t),_ts_tree_root_node_with_offset_wasm=Module._ts_tree_root_node_with_offset_wasm=t=>(_ts_tree_root_node_with_offset_wasm=Module._ts_tree_root_node_with_offset_wasm=wasmExports.ts_tree_root_node_with_offset_wasm)(t),_ts_tree_edit_wasm=Module._ts_tree_edit_wasm=t=>(_ts_tree_edit_wasm=Module._ts_tree_edit_wasm=wasmExports.ts_tree_edit_wasm)(t),_ts_tree_included_ranges_wasm=Module._ts_tree_included_ranges_wasm=t=>(_ts_tree_included_ranges_wasm=Module._ts_tree_included_ranges_wasm=wasmExports.ts_tree_included_ranges_wasm)(t),_ts_tree_get_changed_ranges_wasm=Module._ts_tree_get_changed_ranges_wasm=(t,e)=>(_ts_tree_get_changed_ranges_wasm=Module._ts_tree_get_changed_ranges_wasm=wasmExports.ts_tree_get_changed_ranges_wasm)(t,e),_ts_tree_cursor_new_wasm=Module._ts_tree_cursor_new_wasm=t=>(_ts_tree_cursor_new_wasm=Module._ts_tree_cursor_new_wasm=wasmExports.ts_tree_cursor_new_wasm)(t),_ts_tree_cursor_delete_wasm=Module._ts_tree_cursor_delete_wasm=t=>(_ts_tree_cursor_delete_wasm=Module._ts_tree_cursor_delete_wasm=wasmExports.ts_tree_cursor_delete_wasm)(t),_ts_tree_cursor_reset_wasm=Module._ts_tree_cursor_reset_wasm=t=>(_ts_tree_cursor_reset_wasm=Module._ts_tree_cursor_reset_wasm=wasmExports.ts_tree_cursor_reset_wasm)(t),_ts_tree_cursor_reset_to_wasm=Module._ts_tree_cursor_reset_to_wasm=(t,e)=>(_ts_tree_cursor_reset_to_wasm=Module._ts_tree_cursor_reset_to_wasm=wasmExports.ts_tree_cursor_reset_to_wasm)(t,e),_ts_tree_cursor_goto_first_child_wasm=Module._ts_tree_cursor_goto_first_child_wasm=t=>(_ts_tree_cursor_goto_first_child_wasm=Module._ts_tree_cursor_goto_first_child_wasm=wasmExports.ts_tree_cursor_goto_first_child_wasm)(t),_ts_tree_cursor_goto_last_child_wasm=Module._ts_tree_cursor_goto_last_child_wasm=t=>(_ts_tree_cursor_goto_last_child_wasm=Module._ts_tree_cursor_goto_last_child_wasm=wasmExports.ts_tree_cursor_goto_last_child_wasm)(t),_ts_tree_cursor_goto_first_child_for_index_wasm=Module._ts_tree_cursor_goto_first_child_for_index_wasm=t=>(_ts_tree_cursor_goto_first_child_for_index_wasm=Module._ts_tree_cursor_goto_first_child_for_index_wasm=wasmExports.ts_tree_cursor_goto_first_child_for_index_wasm)(t),_ts_tree_cursor_goto_first_child_for_position_wasm=Module._ts_tree_cursor_goto_first_child_for_position_wasm=t=>(_ts_tree_cursor_goto_first_child_for_position_wasm=Module._ts_tree_cursor_goto_first_child_for_position_wasm=wasmExports.ts_tree_cursor_goto_first_child_for_position_wasm)(t),_ts_tree_cursor_goto_next_sibling_wasm=Module._ts_tree_cursor_goto_next_sibling_wasm=t=>(_ts_tree_cursor_goto_next_sibling_wasm=Module._ts_tree_cursor_goto_next_sibling_wasm=wasmExports.ts_tree_cursor_goto_next_sibling_wasm)(t),_ts_tree_cursor_goto_previous_sibling_wasm=Module._ts_tree_cursor_goto_previous_sibling_wasm=t=>(_ts_tree_cursor_goto_previous_sibling_wasm=Module._ts_tree_cursor_goto_previous_sibling_wasm=wasmExports.ts_tree_cursor_goto_previous_sibling_wasm)(t),_ts_tree_cursor_goto_descendant_wasm=Module._ts_tree_cursor_goto_descendant_wasm=(t,e)=>(_ts_tree_cursor_goto_descendant_wasm=Module._ts_tree_cursor_goto_descendant_wasm=wasmExports.ts_tree_cursor_goto_descendant_wasm)(t,e),_ts_tree_cursor_goto_parent_wasm=Module._ts_tree_cursor_goto_parent_wasm=t=>(_ts_tree_cursor_goto_parent_wasm=Module._ts_tree_cursor_goto_parent_wasm=wasmExports.ts_tree_cursor_goto_parent_wasm)(t),_ts_tree_cursor_current_node_type_id_wasm=Module._ts_tree_cursor_current_node_type_id_wasm=t=>(_ts_tree_cursor_current_node_type_id_wasm=Module._ts_tree_cursor_current_node_type_id_wasm=wasmExports.ts_tree_cursor_current_node_type_id_wasm)(t),_ts_tree_cursor_current_node_state_id_wasm=Module._ts_tree_cursor_current_node_state_id_wasm=t=>(_ts_tree_cursor_current_node_state_id_wasm=Module._ts_tree_cursor_current_node_state_id_wasm=wasmExports.ts_tree_cursor_current_node_state_id_wasm)(t),_ts_tree_cursor_current_node_is_named_wasm=Module._ts_tree_cursor_current_node_is_named_wasm=t=>(_ts_tree_cursor_current_node_is_named_wasm=Module._ts_tree_cursor_current_node_is_named_wasm=wasmExports.ts_tree_cursor_current_node_is_named_wasm)(t),_ts_tree_cursor_current_node_is_missing_wasm=Module._ts_tree_cursor_current_node_is_missing_wasm=t=>(_ts_tree_cursor_current_node_is_missing_wasm=Module._ts_tree_cursor_current_node_is_missing_wasm=wasmExports.ts_tree_cursor_current_node_is_missing_wasm)(t),_ts_tree_cursor_current_node_id_wasm=Module._ts_tree_cursor_current_node_id_wasm=t=>(_ts_tree_cursor_current_node_id_wasm=Module._ts_tree_cursor_current_node_id_wasm=wasmExports.ts_tree_cursor_current_node_id_wasm)(t),_ts_tree_cursor_start_position_wasm=Module._ts_tree_cursor_start_position_wasm=t=>(_ts_tree_cursor_start_position_wasm=Module._ts_tree_cursor_start_position_wasm=wasmExports.ts_tree_cursor_start_position_wasm)(t),_ts_tree_cursor_end_position_wasm=Module._ts_tree_cursor_end_position_wasm=t=>(_ts_tree_cursor_end_position_wasm=Module._ts_tree_cursor_end_position_wasm=wasmExports.ts_tree_cursor_end_position_wasm)(t),_ts_tree_cursor_start_index_wasm=Module._ts_tree_cursor_start_index_wasm=t=>(_ts_tree_cursor_start_index_wasm=Module._ts_tree_cursor_start_index_wasm=wasmExports.ts_tree_cursor_start_index_wasm)(t),_ts_tree_cursor_end_index_wasm=Module._ts_tree_cursor_end_index_wasm=t=>(_ts_tree_cursor_end_index_wasm=Module._ts_tree_cursor_end_index_wasm=wasmExports.ts_tree_cursor_end_index_wasm)(t),_ts_tree_cursor_current_field_id_wasm=Module._ts_tree_cursor_current_field_id_wasm=t=>(_ts_tree_cursor_current_field_id_wasm=Module._ts_tree_cursor_current_field_id_wasm=wasmExports.ts_tree_cursor_current_field_id_wasm)(t),_ts_tree_cursor_current_depth_wasm=Module._ts_tree_cursor_current_depth_wasm=t=>(_ts_tree_cursor_current_depth_wasm=Module._ts_tree_cursor_current_depth_wasm=wasmExports.ts_tree_cursor_current_depth_wasm)(t),_ts_tree_cursor_current_descendant_index_wasm=Module._ts_tree_cursor_current_descendant_index_wasm=t=>(_ts_tree_cursor_current_descendant_index_wasm=Module._ts_tree_cursor_current_descendant_index_wasm=wasmExports.ts_tree_cursor_current_descendant_index_wasm)(t),_ts_tree_cursor_current_node_wasm=Module._ts_tree_cursor_current_node_wasm=t=>(_ts_tree_cursor_current_node_wasm=Module._ts_tree_cursor_current_node_wasm=wasmExports.ts_tree_cursor_current_node_wasm)(t),_ts_node_symbol_wasm=Module._ts_node_symbol_wasm=t=>(_ts_node_symbol_wasm=Module._ts_node_symbol_wasm=wasmExports.ts_node_symbol_wasm)(t),_ts_node_field_name_for_child_wasm=Module._ts_node_field_name_for_child_wasm=(t,e)=>(_ts_node_field_name_for_child_wasm=Module._ts_node_field_name_for_child_wasm=wasmExports.ts_node_field_name_for_child_wasm)(t,e),_ts_node_children_by_field_id_wasm=Module._ts_node_children_by_field_id_wasm=(t,e)=>(_ts_node_children_by_field_id_wasm=Module._ts_node_children_by_field_id_wasm=wasmExports.ts_node_children_by_field_id_wasm)(t,e),_ts_node_first_child_for_byte_wasm=Module._ts_node_first_child_for_byte_wasm=t=>(_ts_node_first_child_for_byte_wasm=Module._ts_node_first_child_for_byte_wasm=wasmExports.ts_node_first_child_for_byte_wasm)(t),_ts_node_first_named_child_for_byte_wasm=Module._ts_node_first_named_child_for_byte_wasm=t=>(_ts_node_first_named_child_for_byte_wasm=Module._ts_node_first_named_child_for_byte_wasm=wasmExports.ts_node_first_named_child_for_byte_wasm)(t),_ts_node_grammar_symbol_wasm=Module._ts_node_grammar_symbol_wasm=t=>(_ts_node_grammar_symbol_wasm=Module._ts_node_grammar_symbol_wasm=wasmExports.ts_node_grammar_symbol_wasm)(t),_ts_node_child_count_wasm=Module._ts_node_child_count_wasm=t=>(_ts_node_child_count_wasm=Module._ts_node_child_count_wasm=wasmExports.ts_node_child_count_wasm)(t),_ts_node_named_child_count_wasm=Module._ts_node_named_child_count_wasm=t=>(_ts_node_named_child_count_wasm=Module._ts_node_named_child_count_wasm=wasmExports.ts_node_named_child_count_wasm)(t),_ts_node_child_wasm=Module._ts_node_child_wasm=(t,e)=>(_ts_node_child_wasm=Module._ts_node_child_wasm=wasmExports.ts_node_child_wasm)(t,e),_ts_node_named_child_wasm=Module._ts_node_named_child_wasm=(t,e)=>(_ts_node_named_child_wasm=Module._ts_node_named_child_wasm=wasmExports.ts_node_named_child_wasm)(t,e),_ts_node_child_by_field_id_wasm=Module._ts_node_child_by_field_id_wasm=(t,e)=>(_ts_node_child_by_field_id_wasm=Module._ts_node_child_by_field_id_wasm=wasmExports.ts_node_child_by_field_id_wasm)(t,e),_ts_node_next_sibling_wasm=Module._ts_node_next_sibling_wasm=t=>(_ts_node_next_sibling_wasm=Module._ts_node_next_sibling_wasm=wasmExports.ts_node_next_sibling_wasm)(t),_ts_node_prev_sibling_wasm=Module._ts_node_prev_sibling_wasm=t=>(_ts_node_prev_sibling_wasm=Module._ts_node_prev_sibling_wasm=wasmExports.ts_node_prev_sibling_wasm)(t),_ts_node_next_named_sibling_wasm=Module._ts_node_next_named_sibling_wasm=t=>(_ts_node_next_named_sibling_wasm=Module._ts_node_next_named_sibling_wasm=wasmExports.ts_node_next_named_sibling_wasm)(t),_ts_node_prev_named_sibling_wasm=Module._ts_node_prev_named_sibling_wasm=t=>(_ts_node_prev_named_sibling_wasm=Module._ts_node_prev_named_sibling_wasm=wasmExports.ts_node_prev_named_sibling_wasm)(t),_ts_node_descendant_count_wasm=Module._ts_node_descendant_count_wasm=t=>(_ts_node_descendant_count_wasm=Module._ts_node_descendant_count_wasm=wasmExports.ts_node_descendant_count_wasm)(t),_ts_node_parent_wasm=Module._ts_node_parent_wasm=t=>(_ts_node_parent_wasm=Module._ts_node_parent_wasm=wasmExports.ts_node_parent_wasm)(t),_ts_node_descendant_for_index_wasm=Module._ts_node_descendant_for_index_wasm=t=>(_ts_node_descendant_for_index_wasm=Module._ts_node_descendant_for_index_wasm=wasmExports.ts_node_descendant_for_index_wasm)(t),_ts_node_named_descendant_for_index_wasm=Module._ts_node_named_descendant_for_index_wasm=t=>(_ts_node_named_descendant_for_index_wasm=Module._ts_node_named_descendant_for_index_wasm=wasmExports.ts_node_named_descendant_for_index_wasm)(t),_ts_node_descendant_for_position_wasm=Module._ts_node_descendant_for_position_wasm=t=>(_ts_node_descendant_for_position_wasm=Module._ts_node_descendant_for_position_wasm=wasmExports.ts_node_descendant_for_position_wasm)(t),_ts_node_named_descendant_for_position_wasm=Module._ts_node_named_descendant_for_position_wasm=t=>(_ts_node_named_descendant_for_position_wasm=Module._ts_node_named_descendant_for_position_wasm=wasmExports.ts_node_named_descendant_for_position_wasm)(t),_ts_node_start_point_wasm=Module._ts_node_start_point_wasm=t=>(_ts_node_start_point_wasm=Module._ts_node_start_point_wasm=wasmExports.ts_node_start_point_wasm)(t),_ts_node_end_point_wasm=Module._ts_node_end_point_wasm=t=>(_ts_node_end_point_wasm=Module._ts_node_end_point_wasm=wasmExports.ts_node_end_point_wasm)(t),_ts_node_start_index_wasm=Module._ts_node_start_index_wasm=t=>(_ts_node_start_index_wasm=Module._ts_node_start_index_wasm=wasmExports.ts_node_start_index_wasm)(t),_ts_node_end_index_wasm=Module._ts_node_end_index_wasm=t=>(_ts_node_end_index_wasm=Module._ts_node_end_index_wasm=wasmExports.ts_node_end_index_wasm)(t),_ts_node_to_string_wasm=Module._ts_node_to_string_wasm=t=>(_ts_node_to_string_wasm=Module._ts_node_to_string_wasm=wasmExports.ts_node_to_string_wasm)(t),_ts_node_children_wasm=Module._ts_node_children_wasm=t=>(_ts_node_children_wasm=Module._ts_node_children_wasm=wasmExports.ts_node_children_wasm)(t),_ts_node_named_children_wasm=Module._ts_node_named_children_wasm=t=>(_ts_node_named_children_wasm=Module._ts_node_named_children_wasm=wasmExports.ts_node_named_children_wasm)(t),_ts_node_descendants_of_type_wasm=Module._ts_node_descendants_of_type_wasm=(t,e,r,n,o,s,a)=>(_ts_node_descendants_of_type_wasm=Module._ts_node_descendants_of_type_wasm=wasmExports.ts_node_descendants_of_type_wasm)(t,e,r,n,o,s,a),_ts_node_is_named_wasm=Module._ts_node_is_named_wasm=t=>(_ts_node_is_named_wasm=Module._ts_node_is_named_wasm=wasmExports.ts_node_is_named_wasm)(t),_ts_node_has_changes_wasm=Module._ts_node_has_changes_wasm=t=>(_ts_node_has_changes_wasm=Module._ts_node_has_changes_wasm=wasmExports.ts_node_has_changes_wasm)(t),_ts_node_has_error_wasm=Module._ts_node_has_error_wasm=t=>(_ts_node_has_error_wasm=Module._ts_node_has_error_wasm=wasmExports.ts_node_has_error_wasm)(t),_ts_node_is_error_wasm=Module._ts_node_is_error_wasm=t=>(_ts_node_is_error_wasm=Module._ts_node_is_error_wasm=wasmExports.ts_node_is_error_wasm)(t),_ts_node_is_missing_wasm=Module._ts_node_is_missing_wasm=t=>(_ts_node_is_missing_wasm=Module._ts_node_is_missing_wasm=wasmExports.ts_node_is_missing_wasm)(t),_ts_node_is_extra_wasm=Module._ts_node_is_extra_wasm=t=>(_ts_node_is_extra_wasm=Module._ts_node_is_extra_wasm=wasmExports.ts_node_is_extra_wasm)(t),_ts_node_parse_state_wasm=Module._ts_node_parse_state_wasm=t=>(_ts_node_parse_state_wasm=Module._ts_node_parse_state_wasm=wasmExports.ts_node_parse_state_wasm)(t),_ts_node_next_parse_state_wasm=Module._ts_node_next_parse_state_wasm=t=>(_ts_node_next_parse_state_wasm=Module._ts_node_next_parse_state_wasm=wasmExports.ts_node_next_parse_state_wasm)(t),_ts_query_matches_wasm=Module._ts_query_matches_wasm=(t,e,r,n,o,s,a,c,u,l)=>(_ts_query_matches_wasm=Module._ts_query_matches_wasm=wasmExports.ts_query_matches_wasm)(t,e,r,n,o,s,a,c,u,l),_ts_query_captures_wasm=Module._ts_query_captures_wasm=(t,e,r,n,o,s,a,c,u,l)=>(_ts_query_captures_wasm=Module._ts_query_captures_wasm=wasmExports.ts_query_captures_wasm)(t,e,r,n,o,s,a,c,u,l),_iswalpha=Module._iswalpha=t=>(_iswalpha=Module._iswalpha=wasmExports.iswalpha)(t),_iswblank=Module._iswblank=t=>(_iswblank=Module._iswblank=wasmExports.iswblank)(t),_iswdigit=Module._iswdigit=t=>(_iswdigit=Module._iswdigit=wasmExports.iswdigit)(t),_iswlower=Module._iswlower=t=>(_iswlower=Module._iswlower=wasmExports.iswlower)(t),_iswupper=Module._iswupper=t=>(_iswupper=Module._iswupper=wasmExports.iswupper)(t),_iswxdigit=Module._iswxdigit=t=>(_iswxdigit=Module._iswxdigit=wasmExports.iswxdigit)(t),_memchr=Module._memchr=(t,e,r)=>(_memchr=Module._memchr=wasmExports.memchr)(t,e,r),_strlen=Module._strlen=t=>(_strlen=Module._strlen=wasmExports.strlen)(t),_strcmp=Module._strcmp=(t,e)=>(_strcmp=Module._strcmp=wasmExports.strcmp)(t,e),_strncat=Module._strncat=(t,e,r)=>(_strncat=Module._strncat=wasmExports.strncat)(t,e,r),_strncpy=Module._strncpy=(t,e,r)=>(_strncpy=Module._strncpy=wasmExports.strncpy)(t,e,r),_towlower=Module._towlower=t=>(_towlower=Module._towlower=wasmExports.towlower)(t),_towupper=Module._towupper=t=>(_towupper=Module._towupper=wasmExports.towupper)(t),_setThrew=(t,e)=>(_setThrew=wasmExports.setThrew)(t,e),stackSave=()=>(stackSave=wasmExports.stackSave)(),stackRestore=t=>(stackRestore=wasmExports.stackRestore)(t),stackAlloc=t=>(stackAlloc=wasmExports.stackAlloc)(t),dynCall_jiji=Module.dynCall_jiji=(t,e,r,n,o)=>(dynCall_jiji=Module.dynCall_jiji=wasmExports.dynCall_jiji)(t,e,r,n,o),_orig$ts_parser_timeout_micros=Module._orig$ts_parser_timeout_micros=t=>(_orig$ts_parser_timeout_micros=Module._orig$ts_parser_timeout_micros=wasmExports.orig$ts_parser_timeout_micros)(t),_orig$ts_parser_set_timeout_micros=Module._orig$ts_parser_set_timeout_micros=(t,e)=>(_orig$ts_parser_set_timeout_micros=Module._orig$ts_parser_set_timeout_micros=wasmExports.orig$ts_parser_set_timeout_micros)(t,e),calledRun;function callMain(t=[]){var e=resolveGlobalSymbol("main").sym;if(e){t.unshift(thisProgram);var r=t.length,n=stackAlloc(4*(r+1)),o=n;t.forEach(a=>{HEAPU32[o>>2]=stringToUTF8OnStack(a),o+=4}),HEAPU32[o>>2]=0;try{var s=e(r,n);return exitJS(s,!0),s}catch(a){return handleException(a)}}}function run(t=arguments_){function e(){calledRun||(calledRun=!0,Module.calledRun=!0,ABORT||(initRuntime(),preMain(),Module.onRuntimeInitialized&&Module.onRuntimeInitialized(),shouldRunNow&&callMain(t),postRun()))}runDependencies>0||(preRun(),runDependencies>0||(Module.setStatus?(Module.setStatus("Running..."),setTimeout(function(){setTimeout(function(){Module.setStatus("")},1),e()},1)):e()))}if(Module.AsciiToString=AsciiToString,Module.stringToUTF16=stringToUTF16,dependenciesFulfilled=function t(){calledRun||run(),calledRun||(dependenciesFulfilled=t)},Module.preInit)for(typeof Module.preInit=="function"&&(Module.preInit=[Module.preInit]);Module.preInit.length>0;)Module.preInit.pop()();var shouldRunNow=!0;Module.noInitialRun&&(shouldRunNow=!1),run();let C=Module,INTERNAL={},SIZE_OF_INT=4,SIZE_OF_CURSOR=4*SIZE_OF_INT,SIZE_OF_NODE=5*SIZE_OF_INT,SIZE_OF_POINT=2*SIZE_OF_INT,SIZE_OF_RANGE=2*SIZE_OF_INT+2*SIZE_OF_POINT,ZERO_POINT={row:0,column:0},QUERY_WORD_REGEX=/[\w-.]*/g,PREDICATE_STEP_TYPE_CAPTURE=1,PREDICATE_STEP_TYPE_STRING=2,LANGUAGE_FUNCTION_REGEX=/^_?tree_sitter_\w+/,VERSION,MIN_COMPATIBLE_VERSION,TRANSFER_BUFFER,currentParseCallback,currentLogCallback;class ParserImpl{static init(){TRANSFER_BUFFER=C._ts_init(),VERSION=getValue(TRANSFER_BUFFER,"i32"),MIN_COMPATIBLE_VERSION=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32")}initialize(){C._ts_parser_new_wasm(),this[0]=getValue(TRANSFER_BUFFER,"i32"),this[1]=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32")}delete(){C._ts_parser_delete(this[0]),C._free(this[1]),this[0]=0,this[1]=0}setLanguage(e){let r;if(e){if(e.constructor!==Language)throw new Error("Argument must be a Language");{r=e[0];let n=C._ts_language_version(r);if(n<MIN_COMPATIBLE_VERSION||VERSION<n)throw new Error(`Incompatible language version ${n}. Compatibility range ${MIN_COMPATIBLE_VERSION} through ${VERSION}.`)}}else r=0,e=null;return this.language=e,C._ts_parser_set_language(this[0],r),this}getLanguage(){return this.language}parse(e,r,n){if(typeof e=="string")currentParseCallback=(u,l)=>e.slice(u);else{if(typeof e!="function")throw new Error("Argument must be a string or a function");currentParseCallback=e}this.logCallback?(currentLogCallback=this.logCallback,C._ts_parser_enable_logger_wasm(this[0],1)):(currentLogCallback=null,C._ts_parser_enable_logger_wasm(this[0],0));let o=0,s=0;if(n?.includedRanges){o=n.includedRanges.length,s=C._calloc(o,SIZE_OF_RANGE);let u=s;for(let l=0;l<o;l++)marshalRange(u,n.includedRanges[l]),u+=SIZE_OF_RANGE}let a=C._ts_parser_parse_wasm(this[0],this[1],r?r[0]:0,s,o);if(!a)throw currentParseCallback=null,currentLogCallback=null,new Error("Parsing failed");let c=new Tree(INTERNAL,a,this.language,currentParseCallback);return currentParseCallback=null,currentLogCallback=null,c}reset(){C._ts_parser_reset(this[0])}getIncludedRanges(){C._ts_parser_included_ranges_wasm(this[0]);let e=getValue(TRANSFER_BUFFER,"i32"),r=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),n=new Array(e);if(e>0){let o=r;for(let s=0;s<e;s++)n[s]=unmarshalRange(o),o+=SIZE_OF_RANGE;C._free(r)}return n}getTimeoutMicros(){return C._ts_parser_timeout_micros(this[0])}setTimeoutMicros(e){C._ts_parser_set_timeout_micros(this[0],e)}setLogger(e){if(e){if(typeof e!="function")throw new Error("Logger callback must be a function")}else e=null;return this.logCallback=e,this}getLogger(){return this.logCallback}}class Tree{constructor(e,r,n,o){assertInternal(e),this[0]=r,this.language=n,this.textCallback=o}copy(){let e=C._ts_tree_copy(this[0]);return new Tree(INTERNAL,e,this.language,this.textCallback)}delete(){C._ts_tree_delete(this[0]),this[0]=0}edit(e){marshalEdit(e),C._ts_tree_edit_wasm(this[0])}get rootNode(){return C._ts_tree_root_node_wasm(this[0]),unmarshalNode(this)}rootNodeWithOffset(e,r){let n=TRANSFER_BUFFER+SIZE_OF_NODE;return setValue(n,e,"i32"),marshalPoint(n+SIZE_OF_INT,r),C._ts_tree_root_node_with_offset_wasm(this[0]),unmarshalNode(this)}getLanguage(){return this.language}walk(){return this.rootNode.walk()}getChangedRanges(e){if(e.constructor!==Tree)throw new TypeError("Argument must be a Tree");C._ts_tree_get_changed_ranges_wasm(this[0],e[0]);let r=getValue(TRANSFER_BUFFER,"i32"),n=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),o=new Array(r);if(r>0){let s=n;for(let a=0;a<r;a++)o[a]=unmarshalRange(s),s+=SIZE_OF_RANGE;C._free(n)}return o}getIncludedRanges(){C._ts_tree_included_ranges_wasm(this[0]);let e=getValue(TRANSFER_BUFFER,"i32"),r=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),n=new Array(e);if(e>0){let o=r;for(let s=0;s<e;s++)n[s]=unmarshalRange(o),o+=SIZE_OF_RANGE;C._free(r)}return n}}class Node{constructor(e,r){assertInternal(e),this.tree=r}get typeId(){return marshalNode(this),C._ts_node_symbol_wasm(this.tree[0])}get grammarId(){return marshalNode(this),C._ts_node_grammar_symbol_wasm(this.tree[0])}get type(){return this.tree.language.types[this.typeId]||"ERROR"}get grammarType(){return this.tree.language.types[this.grammarId]||"ERROR"}get endPosition(){return marshalNode(this),C._ts_node_end_point_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get endIndex(){return marshalNode(this),C._ts_node_end_index_wasm(this.tree[0])}get text(){return getText(this.tree,this.startIndex,this.endIndex)}get parseState(){return marshalNode(this),C._ts_node_parse_state_wasm(this.tree[0])}get nextParseState(){return marshalNode(this),C._ts_node_next_parse_state_wasm(this.tree[0])}get isNamed(){return marshalNode(this),C._ts_node_is_named_wasm(this.tree[0])===1}get hasError(){return marshalNode(this),C._ts_node_has_error_wasm(this.tree[0])===1}get hasChanges(){return marshalNode(this),C._ts_node_has_changes_wasm(this.tree[0])===1}get isError(){return marshalNode(this),C._ts_node_is_error_wasm(this.tree[0])===1}get isMissing(){return marshalNode(this),C._ts_node_is_missing_wasm(this.tree[0])===1}get isExtra(){return marshalNode(this),C._ts_node_is_extra_wasm(this.tree[0])===1}equals(e){return this.id===e.id}child(e){return marshalNode(this),C._ts_node_child_wasm(this.tree[0],e),unmarshalNode(this.tree)}namedChild(e){return marshalNode(this),C._ts_node_named_child_wasm(this.tree[0],e),unmarshalNode(this.tree)}childForFieldId(e){return marshalNode(this),C._ts_node_child_by_field_id_wasm(this.tree[0],e),unmarshalNode(this.tree)}childForFieldName(e){let r=this.tree.language.fields.indexOf(e);return r!==-1?this.childForFieldId(r):null}fieldNameForChild(e){marshalNode(this);let r=C._ts_node_field_name_for_child_wasm(this.tree[0],e);return r?AsciiToString(r):null}childrenForFieldName(e){let r=this.tree.language.fields.indexOf(e);return r!==-1&&r!==0?this.childrenForFieldId(r):[]}childrenForFieldId(e){marshalNode(this),C._ts_node_children_by_field_id_wasm(this.tree[0],e);let r=getValue(TRANSFER_BUFFER,"i32"),n=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),o=new Array(r);if(r>0){let s=n;for(let a=0;a<r;a++)o[a]=unmarshalNode(this.tree,s),s+=SIZE_OF_NODE;C._free(n)}return o}firstChildForIndex(e){return marshalNode(this),setValue(TRANSFER_BUFFER+SIZE_OF_NODE,e,"i32"),C._ts_node_first_child_for_byte_wasm(this.tree[0]),unmarshalNode(this.tree)}firstNamedChildForIndex(e){return marshalNode(this),setValue(TRANSFER_BUFFER+SIZE_OF_NODE,e,"i32"),C._ts_node_first_named_child_for_byte_wasm(this.tree[0]),unmarshalNode(this.tree)}get childCount(){return marshalNode(this),C._ts_node_child_count_wasm(this.tree[0])}get namedChildCount(){return marshalNode(this),C._ts_node_named_child_count_wasm(this.tree[0])}get firstChild(){return this.child(0)}get firstNamedChild(){return this.namedChild(0)}get lastChild(){return this.child(this.childCount-1)}get lastNamedChild(){return this.namedChild(this.namedChildCount-1)}get children(){if(!this._children){marshalNode(this),C._ts_node_children_wasm(this.tree[0]);let e=getValue(TRANSFER_BUFFER,"i32"),r=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32");if(this._children=new Array(e),e>0){let n=r;for(let o=0;o<e;o++)this._children[o]=unmarshalNode(this.tree,n),n+=SIZE_OF_NODE;C._free(r)}}return this._children}get namedChildren(){if(!this._namedChildren){marshalNode(this),C._ts_node_named_children_wasm(this.tree[0]);let e=getValue(TRANSFER_BUFFER,"i32"),r=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32");if(this._namedChildren=new Array(e),e>0){let n=r;for(let o=0;o<e;o++)this._namedChildren[o]=unmarshalNode(this.tree,n),n+=SIZE_OF_NODE;C._free(r)}}return this._namedChildren}descendantsOfType(e,r,n){Array.isArray(e)||(e=[e]),r||(r=ZERO_POINT),n||(n=ZERO_POINT);let o=[],s=this.tree.language.types;for(let d=0,p=s.length;d<p;d++)e.includes(s[d])&&o.push(d);let a=C._malloc(SIZE_OF_INT*o.length);for(let d=0,p=o.length;d<p;d++)setValue(a+d*SIZE_OF_INT,o[d],"i32");marshalNode(this),C._ts_node_descendants_of_type_wasm(this.tree[0],a,o.length,r.row,r.column,n.row,n.column);let c=getValue(TRANSFER_BUFFER,"i32"),u=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),l=new Array(c);if(c>0){let d=u;for(let p=0;p<c;p++)l[p]=unmarshalNode(this.tree,d),d+=SIZE_OF_NODE}return C._free(u),C._free(a),l}get nextSibling(){return marshalNode(this),C._ts_node_next_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get previousSibling(){return marshalNode(this),C._ts_node_prev_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get nextNamedSibling(){return marshalNode(this),C._ts_node_next_named_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get previousNamedSibling(){return marshalNode(this),C._ts_node_prev_named_sibling_wasm(this.tree[0]),unmarshalNode(this.tree)}get descendantCount(){return marshalNode(this),C._ts_node_descendant_count_wasm(this.tree[0])}get parent(){return marshalNode(this),C._ts_node_parent_wasm(this.tree[0]),unmarshalNode(this.tree)}descendantForIndex(e,r=e){if(typeof e!="number"||typeof r!="number")throw new Error("Arguments must be numbers");marshalNode(this);let n=TRANSFER_BUFFER+SIZE_OF_NODE;return setValue(n,e,"i32"),setValue(n+SIZE_OF_INT,r,"i32"),C._ts_node_descendant_for_index_wasm(this.tree[0]),unmarshalNode(this.tree)}namedDescendantForIndex(e,r=e){if(typeof e!="number"||typeof r!="number")throw new Error("Arguments must be numbers");marshalNode(this);let n=TRANSFER_BUFFER+SIZE_OF_NODE;return setValue(n,e,"i32"),setValue(n+SIZE_OF_INT,r,"i32"),C._ts_node_named_descendant_for_index_wasm(this.tree[0]),unmarshalNode(this.tree)}descendantForPosition(e,r=e){if(!isPoint(e)||!isPoint(r))throw new Error("Arguments must be {row, column} objects");marshalNode(this);let n=TRANSFER_BUFFER+SIZE_OF_NODE;return marshalPoint(n,e),marshalPoint(n+SIZE_OF_POINT,r),C._ts_node_descendant_for_position_wasm(this.tree[0]),unmarshalNode(this.tree)}namedDescendantForPosition(e,r=e){if(!isPoint(e)||!isPoint(r))throw new Error("Arguments must be {row, column} objects");marshalNode(this);let n=TRANSFER_BUFFER+SIZE_OF_NODE;return marshalPoint(n,e),marshalPoint(n+SIZE_OF_POINT,r),C._ts_node_named_descendant_for_position_wasm(this.tree[0]),unmarshalNode(this.tree)}walk(){return marshalNode(this),C._ts_tree_cursor_new_wasm(this.tree[0]),new TreeCursor(INTERNAL,this.tree)}toString(){marshalNode(this);let e=C._ts_node_to_string_wasm(this.tree[0]),r=AsciiToString(e);return C._free(e),r}}class TreeCursor{constructor(e,r){assertInternal(e),this.tree=r,unmarshalTreeCursor(this)}delete(){marshalTreeCursor(this),C._ts_tree_cursor_delete_wasm(this.tree[0]),this[0]=this[1]=this[2]=0}reset(e){marshalNode(e),marshalTreeCursor(this,TRANSFER_BUFFER+SIZE_OF_NODE),C._ts_tree_cursor_reset_wasm(this.tree[0]),unmarshalTreeCursor(this)}resetTo(e){marshalTreeCursor(this,TRANSFER_BUFFER),marshalTreeCursor(e,TRANSFER_BUFFER+SIZE_OF_CURSOR),C._ts_tree_cursor_reset_to_wasm(this.tree[0],e.tree[0]),unmarshalTreeCursor(this)}get nodeType(){return this.tree.language.types[this.nodeTypeId]||"ERROR"}get nodeTypeId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_type_id_wasm(this.tree[0])}get nodeStateId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_state_id_wasm(this.tree[0])}get nodeId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_id_wasm(this.tree[0])}get nodeIsNamed(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_is_named_wasm(this.tree[0])===1}get nodeIsMissing(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_is_missing_wasm(this.tree[0])===1}get nodeText(){marshalTreeCursor(this);let e=C._ts_tree_cursor_start_index_wasm(this.tree[0]),r=C._ts_tree_cursor_end_index_wasm(this.tree[0]);return getText(this.tree,e,r)}get startPosition(){return marshalTreeCursor(this),C._ts_tree_cursor_start_position_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get endPosition(){return marshalTreeCursor(this),C._ts_tree_cursor_end_position_wasm(this.tree[0]),unmarshalPoint(TRANSFER_BUFFER)}get startIndex(){return marshalTreeCursor(this),C._ts_tree_cursor_start_index_wasm(this.tree[0])}get endIndex(){return marshalTreeCursor(this),C._ts_tree_cursor_end_index_wasm(this.tree[0])}get currentNode(){return marshalTreeCursor(this),C._ts_tree_cursor_current_node_wasm(this.tree[0]),unmarshalNode(this.tree)}get currentFieldId(){return marshalTreeCursor(this),C._ts_tree_cursor_current_field_id_wasm(this.tree[0])}get currentFieldName(){return this.tree.language.fields[this.currentFieldId]}get currentDepth(){return marshalTreeCursor(this),C._ts_tree_cursor_current_depth_wasm(this.tree[0])}get currentDescendantIndex(){return marshalTreeCursor(this),C._ts_tree_cursor_current_descendant_index_wasm(this.tree[0])}gotoFirstChild(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_first_child_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoLastChild(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_last_child_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoFirstChildForIndex(e){marshalTreeCursor(this),setValue(TRANSFER_BUFFER+SIZE_OF_CURSOR,e,"i32");let r=C._ts_tree_cursor_goto_first_child_for_index_wasm(this.tree[0]);return unmarshalTreeCursor(this),r===1}gotoFirstChildForPosition(e){marshalTreeCursor(this),marshalPoint(TRANSFER_BUFFER+SIZE_OF_CURSOR,e);let r=C._ts_tree_cursor_goto_first_child_for_position_wasm(this.tree[0]);return unmarshalTreeCursor(this),r===1}gotoNextSibling(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_next_sibling_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoPreviousSibling(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_previous_sibling_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}gotoDescendant(e){marshalTreeCursor(this),C._ts_tree_cursor_goto_descendant_wasm(this.tree[0],e),unmarshalTreeCursor(this)}gotoParent(){marshalTreeCursor(this);let e=C._ts_tree_cursor_goto_parent_wasm(this.tree[0]);return unmarshalTreeCursor(this),e===1}}class Language{constructor(e,r){assertInternal(e),this[0]=r,this.types=new Array(C._ts_language_symbol_count(this[0]));for(let n=0,o=this.types.length;n<o;n++)C._ts_language_symbol_type(this[0],n)<2&&(this.types[n]=UTF8ToString(C._ts_language_symbol_name(this[0],n)));this.fields=new Array(C._ts_language_field_count(this[0])+1);for(let n=0,o=this.fields.length;n<o;n++){let s=C._ts_language_field_name_for_id(this[0],n);this.fields[n]=s!==0?UTF8ToString(s):null}}get version(){return C._ts_language_version(this[0])}get fieldCount(){return this.fields.length-1}get stateCount(){return C._ts_language_state_count(this[0])}fieldIdForName(e){let r=this.fields.indexOf(e);return r!==-1?r:null}fieldNameForId(e){return this.fields[e]||null}idForNodeType(e,r){let n=lengthBytesUTF8(e),o=C._malloc(n+1);stringToUTF8(e,o,n+1);let s=C._ts_language_symbol_for_name(this[0],o,n,r);return C._free(o),s||null}get nodeTypeCount(){return C._ts_language_symbol_count(this[0])}nodeTypeForId(e){let r=C._ts_language_symbol_name(this[0],e);return r?UTF8ToString(r):null}nodeTypeIsNamed(e){return!!C._ts_language_type_is_named_wasm(this[0],e)}nodeTypeIsVisible(e){return!!C._ts_language_type_is_visible_wasm(this[0],e)}nextState(e,r){return C._ts_language_next_state(this[0],e,r)}lookaheadIterator(e){let r=C._ts_lookahead_iterator_new(this[0],e);return r?new LookaheadIterable(INTERNAL,r,this):null}query(e){let r=lengthBytesUTF8(e),n=C._malloc(r+1);stringToUTF8(e,n,r+1);let o=C._ts_query_new(this[0],n,r,TRANSFER_BUFFER,TRANSFER_BUFFER+SIZE_OF_INT);if(!o){let g=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),v=getValue(TRANSFER_BUFFER,"i32"),y=UTF8ToString(n,v).length,b=e.substr(y,100).split(`
`)[0],_,S=b.match(QUERY_WORD_REGEX)[0];switch(g){case 2:_=new RangeError(`Bad node name '${S}'`);break;case 3:_=new RangeError(`Bad field name '${S}'`);break;case 4:_=new RangeError(`Bad capture name @${S}`);break;case 5:_=new TypeError(`Bad pattern structure at offset ${y}: '${b}'...`),S="";break;default:_=new SyntaxError(`Bad syntax at offset ${y}: '${b}'...`),S=""}throw _.index=y,_.length=S.length,C._free(n),_}let s=C._ts_query_string_count(o),a=C._ts_query_capture_count(o),c=C._ts_query_pattern_count(o),u=new Array(a),l=new Array(s);for(let g=0;g<a;g++){let v=C._ts_query_capture_name_for_id(o,g,TRANSFER_BUFFER),y=getValue(TRANSFER_BUFFER,"i32");u[g]=UTF8ToString(v,y)}for(let g=0;g<s;g++){let v=C._ts_query_string_value_for_id(o,g,TRANSFER_BUFFER),y=getValue(TRANSFER_BUFFER,"i32");l[g]=UTF8ToString(v,y)}let d=new Array(c),p=new Array(c),f=new Array(c),m=new Array(c),h=new Array(c);for(let g=0;g<c;g++){let v=C._ts_query_predicates_for_pattern(o,g,TRANSFER_BUFFER),y=getValue(TRANSFER_BUFFER,"i32");m[g]=[],h[g]=[];let b=[],_=v;for(let S=0;S<y;S++){let I=getValue(_,"i32");_+=SIZE_OF_INT;let T=getValue(_,"i32");if(_+=SIZE_OF_INT,I===PREDICATE_STEP_TYPE_CAPTURE)b.push({type:"capture",name:u[T]});else if(I===PREDICATE_STEP_TYPE_STRING)b.push({type:"string",value:l[T]});else if(b.length>0){if(b[0].type!=="string")throw new Error("Predicates must begin with a literal value");let A=b[0].value,B,j=!0,F=!0;switch(A){case"any-not-eq?":case"not-eq?":j=!1;case"any-eq?":case"eq?":if(b.length!==3)throw new Error(`Wrong number of arguments to \`#${A}\` predicate. Expected 2, got ${b.length-1}`);if(b[1].type!=="capture")throw new Error(`First argument of \`#${A}\` predicate must be a capture. Got "${b[1].value}"`);if(F=!A.startsWith("any-"),b[2].type==="capture"){let w=b[1].name,P=b[2].name;h[g].push(q=>{let U=[],Z=[];for(let re of q)re.name===w&&U.push(re.node),re.name===P&&Z.push(re.node);let le=(re,X,Ve)=>Ve?re.text===X.text:re.text!==X.text;return F?U.every(re=>Z.some(X=>le(re,X,j))):U.some(re=>Z.some(X=>le(re,X,j)))})}else{B=b[1].name;let w=b[2].value,P=U=>U.text===w,q=U=>U.text!==w;h[g].push(U=>{let Z=[];for(let re of U)re.name===B&&Z.push(re.node);let le=j?P:q;return F?Z.every(le):Z.some(le)})}break;case"any-not-match?":case"not-match?":j=!1;case"any-match?":case"match?":if(b.length!==3)throw new Error(`Wrong number of arguments to \`#${A}\` predicate. Expected 2, got ${b.length-1}.`);if(b[1].type!=="capture")throw new Error(`First argument of \`#${A}\` predicate must be a capture. Got "${b[1].value}".`);if(b[2].type!=="string")throw new Error(`Second argument of \`#${A}\` predicate must be a string. Got @${b[2].value}.`);B=b[1].name;let ne=new RegExp(b[2].value);F=!A.startsWith("any-"),h[g].push(w=>{let P=[];for(let U of w)U.name===B&&P.push(U.node.text);let q=(U,Z)=>Z?ne.test(U):!ne.test(U);return P.length===0?!j:F?P.every(U=>q(U,j)):P.some(U=>q(U,j))});break;case"set!":if(b.length<2||b.length>3)throw new Error(`Wrong number of arguments to \`#set!\` predicate. Expected 1 or 2. Got ${b.length-1}.`);if(b.some(w=>w.type!=="string"))throw new Error('Arguments to `#set!` predicate must be a strings.".');d[g]||(d[g]={}),d[g][b[1].value]=b[2]?b[2].value:null;break;case"is?":case"is-not?":if(b.length<2||b.length>3)throw new Error(`Wrong number of arguments to \`#${A}\` predicate. Expected 1 or 2. Got ${b.length-1}.`);if(b.some(w=>w.type!=="string"))throw new Error(`Arguments to \`#${A}\` predicate must be a strings.".`);let Y=A==="is?"?p:f;Y[g]||(Y[g]={}),Y[g][b[1].value]=b[2]?b[2].value:null;break;case"not-any-of?":j=!1;case"any-of?":if(b.length<2)throw new Error(`Wrong number of arguments to \`#${A}\` predicate. Expected at least 1. Got ${b.length-1}.`);if(b[1].type!=="capture")throw new Error(`First argument of \`#${A}\` predicate must be a capture. Got "${b[1].value}".`);for(let w=2;w<b.length;w++)if(b[w].type!=="string")throw new Error(`Arguments to \`#${A}\` predicate must be a strings.".`);B=b[1].name;let N=b.slice(2).map(w=>w.value);h[g].push(w=>{let P=[];for(let q of w)q.name===B&&P.push(q.node.text);return P.length===0?!j:P.every(q=>N.includes(q))===j});break;default:m[g].push({operator:A,operands:b.slice(1)})}b.length=0}}Object.freeze(d[g]),Object.freeze(p[g]),Object.freeze(f[g])}return C._free(n),new Query(INTERNAL,o,u,h,m,Object.freeze(d),Object.freeze(p),Object.freeze(f))}static load(e){let r;if(e instanceof Uint8Array)r=Promise.resolve(e);else{let n=e;if(typeof process<"u"&&process.versions&&process.versions.node){let o=require("fs");r=Promise.resolve(o.readFileSync(n))}else r=fetch(n).then(o=>o.arrayBuffer().then(s=>{if(o.ok)return new Uint8Array(s);{let a=new TextDecoder("utf-8").decode(s);throw new Error(`Language.load failed with status ${o.status}.

${a}`)}}))}return r.then(n=>loadWebAssemblyModule(n,{loadAsync:!0})).then(n=>{let o=Object.keys(n),s=o.find(c=>LANGUAGE_FUNCTION_REGEX.test(c)&&!c.includes("external_scanner_"));s||console.log(`Couldn't find language function in WASM file. Symbols:
${JSON.stringify(o,null,2)}`);let a=n[s]();return new Language(INTERNAL,a)})}}class LookaheadIterable{constructor(e,r,n){assertInternal(e),this[0]=r,this.language=n}get currentTypeId(){return C._ts_lookahead_iterator_current_symbol(this[0])}get currentType(){return this.language.types[this.currentTypeId]||"ERROR"}delete(){C._ts_lookahead_iterator_delete(this[0]),this[0]=0}resetState(e){return C._ts_lookahead_iterator_reset_state(this[0],e)}reset(e,r){return!!C._ts_lookahead_iterator_reset(this[0],e[0],r)&&(this.language=e,!0)}[Symbol.iterator](){let e=this;return{next:()=>C._ts_lookahead_iterator_next(e[0])?{done:!1,value:e.currentType}:{done:!0,value:""}}}}class Query{constructor(e,r,n,o,s,a,c,u){assertInternal(e),this[0]=r,this.captureNames=n,this.textPredicates=o,this.predicates=s,this.setProperties=a,this.assertedProperties=c,this.refutedProperties=u,this.exceededMatchLimit=!1}delete(){C._ts_query_delete(this[0]),this[0]=0}matches(e,{startPosition:r=ZERO_POINT,endPosition:n=ZERO_POINT,startIndex:o=0,endIndex:s=0,matchLimit:a=4294967295,maxStartDepth:c=4294967295}={}){if(typeof a!="number")throw new Error("Arguments must be numbers");marshalNode(e),C._ts_query_matches_wasm(this[0],e.tree[0],r.row,r.column,n.row,n.column,o,s,a,c);let u=getValue(TRANSFER_BUFFER,"i32"),l=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),d=getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32"),p=new Array(u);this.exceededMatchLimit=!!d;let f=0,m=l;for(let h=0;h<u;h++){let g=getValue(m,"i32");m+=SIZE_OF_INT;let v=getValue(m,"i32");m+=SIZE_OF_INT;let y=new Array(v);if(m=unmarshalCaptures(this,e.tree,m,y),this.textPredicates[g].every(b=>b(y))){p[f]={pattern:g,captures:y};let b=this.setProperties[g];b&&(p[f].setProperties=b);let _=this.assertedProperties[g];_&&(p[f].assertedProperties=_);let S=this.refutedProperties[g];S&&(p[f].refutedProperties=S),f++}}return p.length=f,C._free(l),p}captures(e,{startPosition:r=ZERO_POINT,endPosition:n=ZERO_POINT,startIndex:o=0,endIndex:s=0,matchLimit:a=4294967295,maxStartDepth:c=4294967295}={}){if(typeof a!="number")throw new Error("Arguments must be numbers");marshalNode(e),C._ts_query_captures_wasm(this[0],e.tree[0],r.row,r.column,n.row,n.column,o,s,a,c);let u=getValue(TRANSFER_BUFFER,"i32"),l=getValue(TRANSFER_BUFFER+SIZE_OF_INT,"i32"),d=getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32"),p=[];this.exceededMatchLimit=!!d;let f=[],m=l;for(let h=0;h<u;h++){let g=getValue(m,"i32");m+=SIZE_OF_INT;let v=getValue(m,"i32");m+=SIZE_OF_INT;let y=getValue(m,"i32");if(m+=SIZE_OF_INT,f.length=v,m=unmarshalCaptures(this,e.tree,m,f),this.textPredicates[g].every(b=>b(f))){let b=f[y],_=this.setProperties[g];_&&(b.setProperties=_);let S=this.assertedProperties[g];S&&(b.assertedProperties=S);let I=this.refutedProperties[g];I&&(b.refutedProperties=I),p.push(b)}}return C._free(l),p}predicatesForPattern(e){return this.predicates[e]}disableCapture(e){let r=lengthBytesUTF8(e),n=C._malloc(r+1);stringToUTF8(e,n,r+1),C._ts_query_disable_capture(this[0],n,r),C._free(n)}didExceedMatchLimit(){return this.exceededMatchLimit}}function getText(t,e,r){let n=r-e,o=t.textCallback(e,null,r);for(e+=o.length;e<r;){let s=t.textCallback(e,null,r);if(!(s&&s.length>0))break;e+=s.length,o+=s}return e>r&&(o=o.slice(0,n)),o}function unmarshalCaptures(t,e,r,n){for(let o=0,s=n.length;o<s;o++){let a=getValue(r,"i32"),c=unmarshalNode(e,r+=SIZE_OF_INT);r+=SIZE_OF_NODE,n[o]={name:t.captureNames[a],node:c}}return r}function assertInternal(t){if(t!==INTERNAL)throw new Error("Illegal constructor")}function isPoint(t){return t&&typeof t.row=="number"&&typeof t.column=="number"}function marshalNode(t){let e=TRANSFER_BUFFER;setValue(e,t.id,"i32"),e+=SIZE_OF_INT,setValue(e,t.startIndex,"i32"),e+=SIZE_OF_INT,setValue(e,t.startPosition.row,"i32"),e+=SIZE_OF_INT,setValue(e,t.startPosition.column,"i32"),e+=SIZE_OF_INT,setValue(e,t[0],"i32")}function unmarshalNode(t,e=TRANSFER_BUFFER){let r=getValue(e,"i32");if(r===0)return null;let n=getValue(e+=SIZE_OF_INT,"i32"),o=getValue(e+=SIZE_OF_INT,"i32"),s=getValue(e+=SIZE_OF_INT,"i32"),a=getValue(e+=SIZE_OF_INT,"i32"),c=new Node(INTERNAL,t);return c.id=r,c.startIndex=n,c.startPosition={row:o,column:s},c[0]=a,c}function marshalTreeCursor(t,e=TRANSFER_BUFFER){setValue(e+0*SIZE_OF_INT,t[0],"i32"),setValue(e+1*SIZE_OF_INT,t[1],"i32"),setValue(e+2*SIZE_OF_INT,t[2],"i32"),setValue(e+3*SIZE_OF_INT,t[3],"i32")}function unmarshalTreeCursor(t){t[0]=getValue(TRANSFER_BUFFER+0*SIZE_OF_INT,"i32"),t[1]=getValue(TRANSFER_BUFFER+1*SIZE_OF_INT,"i32"),t[2]=getValue(TRANSFER_BUFFER+2*SIZE_OF_INT,"i32"),t[3]=getValue(TRANSFER_BUFFER+3*SIZE_OF_INT,"i32")}function marshalPoint(t,e){setValue(t,e.row,"i32"),setValue(t+SIZE_OF_INT,e.column,"i32")}function unmarshalPoint(t){return{row:getValue(t,"i32")>>>0,column:getValue(t+SIZE_OF_INT,"i32")>>>0}}function marshalRange(t,e){marshalPoint(t,e.startPosition),marshalPoint(t+=SIZE_OF_POINT,e.endPosition),setValue(t+=SIZE_OF_POINT,e.startIndex,"i32"),setValue(t+=SIZE_OF_INT,e.endIndex,"i32"),t+=SIZE_OF_INT}function unmarshalRange(t){let e={};return e.startPosition=unmarshalPoint(t),t+=SIZE_OF_POINT,e.endPosition=unmarshalPoint(t),t+=SIZE_OF_POINT,e.startIndex=getValue(t,"i32")>>>0,t+=SIZE_OF_INT,e.endIndex=getValue(t,"i32")>>>0,e}function marshalEdit(t){let e=TRANSFER_BUFFER;marshalPoint(e,t.startPosition),e+=SIZE_OF_POINT,marshalPoint(e,t.oldEndPosition),e+=SIZE_OF_POINT,marshalPoint(e,t.newEndPosition),e+=SIZE_OF_POINT,setValue(e,t.startIndex,"i32"),e+=SIZE_OF_INT,setValue(e,t.oldEndIndex,"i32"),e+=SIZE_OF_INT,setValue(e,t.newEndIndex,"i32"),e+=SIZE_OF_INT}for(let t of Object.getOwnPropertyNames(ParserImpl.prototype))Object.defineProperty(Parser.prototype,t,{value:ParserImpl.prototype[t],enumerable:!1,writable:!1});Parser.Language=Language,Module.onRuntimeInitialized=()=>{ParserImpl.init(),resolveInitPromise()}}))}}return Parser}();typeof exports=="object"&&(module.exports=TreeSitter)});var qz=M(gr=>{"use strict";var Uz=gr&&gr.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},Bz=gr&&gr.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(gr,"__esModule",{value:!0});gr.getShallowFileSize=gr.getShallowDirectorySizeSync=gr.getShallowDirectorySize=gr.confirmDirExists=gr.unlinkAsync=gr.readdirAsync=gr.readFileAsync=gr.writeFileAsync=gr.appendFileAsync=gr.accessAsync=gr.mkdirAsync=gr.lstatAsync=gr.statAsync=void 0;var kl=require("fs"),zme=require("path"),Uf=require("util");gr.statAsync=Uf.promisify(kl.stat);gr.lstatAsync=Uf.promisify(kl.lstat);gr.mkdirAsync=Uf.promisify(kl.mkdir);gr.accessAsync=Uf.promisify(kl.access);gr.appendFileAsync=Uf.promisify(kl.appendFile);gr.writeFileAsync=Uf.promisify(kl.writeFile);gr.readFileAsync=Uf.promisify(kl.readFile);gr.readdirAsync=Uf.promisify(kl.readdir);gr.unlinkAsync=Uf.promisify(kl.unlink);var jje=function(t){return Uz(void 0,void 0,void 0,function(){var e,r,n;return Bz(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,7]),[4,gr.lstatAsync(t)];case 1:if(e=o.sent(),!e.isDirectory())throw new Error("Path existed but was not a directory");return[3,7];case 2:if(r=o.sent(),!(r&&r.code==="ENOENT"))return[3,6];o.label=3;case 3:return o.trys.push([3,5,,6]),[4,gr.mkdirAsync(t)];case 4:return o.sent(),[3,6];case 5:if(n=o.sent(),n&&n.code!=="EEXIST")throw n;return[3,6];case 6:return[3,7];case 7:return[2]}})})};gr.confirmDirExists=jje;var Vje=function(t){return Uz(void 0,void 0,void 0,function(){var e,r,n,o,s,a;return Bz(this,function(c){switch(c.label){case 0:return[4,gr.readdirAsync(t)];case 1:e=c.sent(),r=0,n=0,o=e,c.label=2;case 2:return n<o.length?(s=o[n],[4,gr.statAsync(zme.join(t,s))]):[3,5];case 3:a=c.sent(),a.isFile()&&(r+=a.size),c.label=4;case 4:return n++,[3,2];case 5:return[2,r]}})})};gr.getShallowDirectorySize=Vje;var Gje=function(t){for(var e=kl.readdirSync(t),r=0,n=0;n<e.length;n++)r+=kl.statSync(zme.join(t,e[n])).size;return r};gr.getShallowDirectorySizeSync=Gje;var zje=function(t){return Uz(void 0,void 0,void 0,function(){var e;return Bz(this,function(r){switch(r.label){case 0:return[4,gr.statAsync(t)];case 1:return e=r.sent(),e.isFile()?[2,e.size]:[2]}})})};gr.getShallowFileSize=zje});var Kme=M((Dy,Wme)=>{"use strict";var Hz=Dy&&Dy.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},jz=Dy&&Dy.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},$me=Dy&&Dy.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),o=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,o++)n[o]=s[a];return n},$je=require("fs"),Wje=require("os"),Ay=require("path"),Gd=qz(),Kje=function(){function t(){var e=this;this.TAG="Logger",this._cleanupTimeOut=60*30*1e3,this._tempDir="",this._logFileName="",this._fileFullPath="",this._backUpNameFormat="",this._logToFile=!1,this._logToConsole=!0;var r=process.env.APPLICATIONINSIGHTS_LOG_DESTINATION;r=="file+console"&&(this._logToFile=!0),r=="file"&&(this._logToFile=!0,this._logToConsole=!1),this.maxSizeBytes=5e4,this.maxHistory=1,this._logFileName="applicationinsights.log";var n=process.env.APPLICATIONINSIGHTS_LOGDIR;n?Ay.isAbsolute(n)?this._tempDir=n:this._tempDir=Ay.join(process.cwd(),n):this._tempDir=Ay.join(Wje.tmpdir(),"appInsights-node"),this._fileFullPath=Ay.join(this._tempDir,this._logFileName),this._backUpNameFormat="."+this._logFileName,this._logToFile&&(t._fileCleanupTimer||(t._fileCleanupTimer=setInterval(function(){e._fileCleanupTask()},this._cleanupTimeOut),t._fileCleanupTimer.unref()))}return t.prototype.info=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=e?$me([e],r):r;this._logToFile&&this._storeToDisk(o),this._logToConsole&&console.info.apply(console,o)},t.prototype.warning=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var o=e?$me([e],r):r;this._logToFile&&this._storeToDisk(o),this._logToConsole&&console.warn.apply(console,o)},t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype._storeToDisk=function(e){return Hz(this,void 0,void 0,function(){var r,n,o,s,a,c;return jz(this,function(u){switch(u.label){case 0:r=e+`\r
`,u.label=1;case 1:return u.trys.push([1,3,,4]),[4,Gd.confirmDirExists(this._tempDir)];case 2:return u.sent(),[3,4];case 3:return n=u.sent(),console.log(this.TAG,"Failed to create directory for log file: "+(n&&n.message)),[2];case 4:return u.trys.push([4,6,,11]),[4,Gd.accessAsync(this._fileFullPath,$je.constants.F_OK)];case 5:return u.sent(),[3,11];case 6:o=u.sent(),u.label=7;case 7:return u.trys.push([7,9,,10]),[4,Gd.appendFileAsync(this._fileFullPath,r)];case 8:return u.sent(),[2];case 9:return s=u.sent(),console.log(this.TAG,"Failed to put log into file: "+(o&&o.message)),[2];case 10:return[3,11];case 11:return u.trys.push([11,17,,18]),[4,Gd.getShallowFileSize(this._fileFullPath)];case 12:return a=u.sent(),a>this.maxSizeBytes?[4,this._createBackupFile(r)]:[3,14];case 13:return u.sent(),[3,16];case 14:return[4,Gd.appendFileAsync(this._fileFullPath,r)];case 15:u.sent(),u.label=16;case 16:return[3,18];case 17:return c=u.sent(),console.log(this.TAG,"Failed to create backup file: "+(c&&c.message)),[3,18];case 18:return[2]}})})},t.prototype._createBackupFile=function(e){return Hz(this,void 0,void 0,function(){var r,n,o;return jz(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,4,5]),[4,Gd.readFileAsync(this._fileFullPath)];case 1:return r=s.sent(),n=Ay.join(this._tempDir,new Date().getTime()+"."+this._logFileName),[4,Gd.writeFileAsync(n,r)];case 2:return s.sent(),[3,5];case 3:return o=s.sent(),console.log("Failed to generate backup log file",o),[3,5];case 4:return Gd.writeFileAsync(this._fileFullPath,e),[7];case 5:return[2]}})})},t.prototype._fileCleanupTask=function(){return Hz(this,void 0,void 0,function(){var e,r,n,o,s,a=this;return jz(this,function(c){switch(c.label){case 0:return c.trys.push([0,6,,7]),[4,Gd.readdirAsync(this._tempDir)];case 1:e=c.sent(),e=e.filter(function(u){return Ay.basename(u).indexOf(a._backUpNameFormat)>-1}),e.sort(function(u,l){var d=new Date(parseInt(u.split(a._backUpNameFormat)[0])),p=new Date(parseInt(l.split(a._backUpNameFormat)[0]));if(d<p)return-1;if(d>=p)return 1}),r=e.length,n=0,c.label=2;case 2:return n<r-this.maxHistory?(o=Ay.join(this._tempDir,e[n]),[4,Gd.unlinkAsync(o)]):[3,5];case 3:c.sent(),c.label=4;case 4:return n++,[3,2];case 5:return[3,7];case 6:return s=c.sent(),console.log(this.TAG,"Failed to cleanup log files: "+(s&&s.message)),[3,7];case 7:return[2]}})})},t._fileCleanupTimer=null,t}();Wme.exports=Kje});var Hn=M((Ilr,Qme)=>{"use strict";var Yme=Kme(),Yje="APPLICATION_INSIGHTS_ENABLE_DEBUG_LOGS",Qje="APPLICATION_INSIGHTS_DISABLE_WARNING_LOGS",Xje=function(){function t(){}return t.info=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.enableDebug&&Yme.getInstance().info(this.TAG+e,r)},t.warn=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this.disableWarnings||Yme.getInstance().warning(this.TAG+e,r)},t.enableDebug=!!process.env[Yje],t.disableWarnings=!!process.env[Qje],t.TAG="ApplicationInsights:",t}();Qme.exports=Xje});var d5=M(l5=>{"use strict";Object.defineProperty(l5,"__esModule",{value:!0});l5.JsonConfig=void 0;var Jje=require("fs"),u5=require("path"),Vz=Hn(),Zje="APPLICATIONINSIGHTS_CONFIGURATION_FILE",eVe="APPLICATIONINSIGHTS_CONNECTION_STRING",Xme="APPSETTING_",Jme="APPINSIGHTS_INSTRUMENTATIONKEY",Zme="APPINSIGHTS_INSTRUMENTATION_KEY",tVe="APPLICATION_INSIGHTS_DISABLE_EXTENDED_METRIC",rVe="APPLICATION_INSIGHTS_DISABLE_ALL_EXTENDED_METRICS",nVe="http_proxy",iVe="https_proxy",oVe="APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL",sVe="APPLICATION_INSIGHTS_NO_STATSBEAT",aVe="APPLICATION_INSIGHTS_NO_HTTP_AGENT_KEEP_ALIVE",cVe="APPLICATION_INSIGHTS_NO_PATCH_MODULES",uVe="APPLICATIONINSIGHTS_WEB_INSTRUMENTATION_ENABLED",lVe="APPLICATIONINSIGHTS_WEB_INSTRUMENTATION_CONNECTION_STRING",dVe="APPLICATIONINSIGHTS_WEB_INSTRUMENTATION_SOURCE",pVe="APPLICATIONINSIGHTS_WEB_SNIPPET_ENABLED",fVe="APPLICATIONINSIGHTS_WEB_SNIPPET_CONNECTION_STRING",mVe=function(){function t(){this.connectionString=process.env[eVe],this.instrumentationKey=process.env[Jme]||process.env[Xme+Jme]||process.env[Zme]||process.env[Xme+Zme],!this.connectionString&&this.instrumentationKey&&Vz.warn("APPINSIGHTS_INSTRUMENTATIONKEY is in path of deprecation, please use APPLICATIONINSIGHTS_CONNECTION_STRING env variable to setup the SDK."),this.disableAllExtendedMetrics=!!process.env[rVe],this.extendedMetricDisablers=process.env[tVe],this.proxyHttpUrl=process.env[nVe],this.proxyHttpsUrl=process.env[iVe],this.noDiagnosticChannel=!!process.env[oVe],this.disableStatsbeat=!!process.env[sVe],this.noHttpAgentKeepAlive=!!process.env[aVe],this.noPatchModules=process.env[cVe]||"",this.enableWebInstrumentation=!!process.env[uVe]||!!process.env[pVe],this.webInstrumentationSrc=process.env[dVe]||"",this.webInstrumentationConnectionString=process.env[lVe]||process.env[fVe]||"",this.enableAutoWebSnippetInjection=this.enableWebInstrumentation,this.webSnippetConnectionString=this.webInstrumentationConnectionString,this._loadJsonFile()}return t.getInstance=function(){return t._instance||(t._instance=new t),t._instance},t.prototype._loadJsonFile=function(){var e="",r="{}";if(r)e=r;else{var n="applicationinsights.json",o=u5.join(__dirname,"../../"),s=u5.join(o,n),a=process.env[Zje];a&&(u5.isAbsolute(a)?s=a:s=u5.join(o,a));try{e=Jje.readFileSync(s,"utf8")}catch(u){Vz.warn("Failed to read JSON config file: ",u)}}try{var c=JSON.parse(e);c.disableStatsbeat!=null&&(this.disableStatsbeat=c.disableStatsbeat),c.disableAllExtendedMetrics!=null&&(this.disableAllExtendedMetrics=c.disableStatsbeat),c.noDiagnosticChannel!=null&&(this.noDiagnosticChannel=c.noDiagnosticChannel),c.noHttpAgentKeepAlive!=null&&(this.noHttpAgentKeepAlive=c.noHttpAgentKeepAlive),c.connectionString!=null&&(this.connectionString=c.connectionString),c.extendedMetricDisablers!=null&&(this.extendedMetricDisablers=c.extendedMetricDisablers),c.noDiagnosticChannel!=null&&(this.noDiagnosticChannel=c.noDiagnosticChannel),c.proxyHttpUrl!=null&&(this.proxyHttpUrl=c.proxyHttpUrl),c.proxyHttpsUrl!=null&&(this.proxyHttpsUrl=c.proxyHttpsUrl),c.proxyHttpsUrl!=null&&(this.proxyHttpsUrl=c.proxyHttpsUrl),c.noPatchModules!=null&&(this.noPatchModules=c.noPatchModules),c.enableAutoWebSnippetInjection!=null&&(this.enableWebInstrumentation=c.enableAutoWebSnippetInjection,this.enableAutoWebSnippetInjection=this.enableWebInstrumentation),c.enableWebInstrumentation!=null&&(this.enableWebInstrumentation=c.enableWebInstrumentation,this.enableAutoWebSnippetInjection=this.enableWebInstrumentation),c.webSnippetConnectionString!=null&&(this.webInstrumentationConnectionString=c.webSnippetConnectionString,this.webSnippetConnectionString=this.webInstrumentationConnectionString),c.webInstrumentationConnectionString!=null&&(this.webInstrumentationConnectionString=c.webInstrumentationConnectionString,this.webSnippetConnectionString=this.webInstrumentationConnectionString),c.webInstrumentationConfig!=null&&(this.webInstrumentationConfig=c.webInstrumentationConfig),c.webInstrumentationSrc!=null&&(this.webInstrumentationSrc=c.webInstrumentationSrc),c.enableLoggerErrorToTrace!=null&&(this.enableLoggerErrorToTrace=c.enableLoggerErrorToTrace),this.endpointUrl=c.endpointUrl,this.maxBatchSize=c.maxBatchSize,this.maxBatchIntervalMs=c.maxBatchIntervalMs,this.disableAppInsights=c.disableAppInsights,this.samplingPercentage=c.samplingPercentage,this.correlationIdRetryIntervalMs=c.correlationIdRetryIntervalMs,this.correlationHeaderExcludedDomains=c.correlationHeaderExcludedDomains,this.ignoreLegacyHeaders=c.ignoreLegacyHeaders,this.distributedTracingMode=c.distributedTracingMode,this.enableAutoCollectExternalLoggers=c.enableAutoCollectExternalLoggers,this.enableAutoCollectConsole=c.enableAutoCollectConsole,this.enableLoggerErrorToTrace=c.enableLoggerErrorToTrace,this.enableAutoCollectExceptions=c.enableAutoCollectExceptions,this.enableAutoCollectPerformance=c.enableAutoCollectPerformance,this.enableAutoCollectExtendedMetrics=c.enableAutoCollectExtendedMetrics,this.enableAutoCollectPreAggregatedMetrics=c.enableAutoCollectPreAggregatedMetrics,this.enableAutoCollectHeartbeat=c.enableAutoCollectHeartbeat,this.enableAutoCollectRequests=c.enableAutoCollectRequests,this.enableAutoCollectDependencies=c.enableAutoCollectDependencies,this.enableAutoDependencyCorrelation=c.enableAutoDependencyCorrelation,this.enableAutoCollectIncomingRequestAzureFunctions=c.enableAutoCollectIncomingRequestAzureFunctions,this.enableUseAsyncHooks=c.enableUseAsyncHooks,this.enableUseDiskRetryCaching=c.enableUseDiskRetryCaching,this.enableResendInterval=c.enableResendInterval,this.enableMaxBytesOnDisk=c.enableMaxBytesOnDisk,this.enableInternalDebugLogging=c.enableInternalDebugLogging,this.enableInternalWarningLogging=c.enableInternalWarningLogging,this.enableSendLiveMetrics=c.enableSendLiveMetrics,this.quickPulseHost=c.quickPulseHost}catch(u){Vz.warn("Invalid JSON config file: ",u)}},t}();l5.JsonConfig=mVe});var Ck=M((Elr,ehe)=>{var hVe="2.0.0",gVe=Number.MAX_SAFE_INTEGER||9007199254740991,vVe=16,yVe=250,bVe=["major","premajor","minor","preminor","patch","prepatch","prerelease"];ehe.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:vVe,MAX_SAFE_BUILD_LENGTH:yVe,MAX_SAFE_INTEGER:gVe,RELEASE_TYPES:bVe,SEMVER_SPEC_VERSION:hVe,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var Ek=M((Tlr,the)=>{var _Ve=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};the.exports=_Ve});var EI=M((Bf,rhe)=>{var{MAX_SAFE_COMPONENT_LENGTH:Gz,MAX_SAFE_BUILD_LENGTH:xVe,MAX_LENGTH:SVe}=Ck(),IVe=Ek();Bf=rhe.exports={};var CVe=Bf.re=[],EVe=Bf.safeRe=[],it=Bf.src=[],ot=Bf.t={},TVe=0,zz="[a-zA-Z0-9-]",wVe=[["\\s",1],["\\d",SVe],[zz,xVe]],RVe=t=>{for(let[e,r]of wVe)t=t.split(`${e}*`).join(`${e}{0,${r}}`).split(`${e}+`).join(`${e}{1,${r}}`);return t},Kt=(t,e,r)=>{let n=RVe(e),o=TVe++;IVe(t,o,e),ot[t]=o,it[o]=e,CVe[o]=new RegExp(e,r?"g":void 0),EVe[o]=new RegExp(n,r?"g":void 0)};Kt("NUMERICIDENTIFIER","0|[1-9]\\d*");Kt("NUMERICIDENTIFIERLOOSE","\\d+");Kt("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${zz}*`);Kt("MAINVERSION",`(${it[ot.NUMERICIDENTIFIER]})\\.(${it[ot.NUMERICIDENTIFIER]})\\.(${it[ot.NUMERICIDENTIFIER]})`);Kt("MAINVERSIONLOOSE",`(${it[ot.NUMERICIDENTIFIERLOOSE]})\\.(${it[ot.NUMERICIDENTIFIERLOOSE]})\\.(${it[ot.NUMERICIDENTIFIERLOOSE]})`);Kt("PRERELEASEIDENTIFIER",`(?:${it[ot.NUMERICIDENTIFIER]}|${it[ot.NONNUMERICIDENTIFIER]})`);Kt("PRERELEASEIDENTIFIERLOOSE",`(?:${it[ot.NUMERICIDENTIFIERLOOSE]}|${it[ot.NONNUMERICIDENTIFIER]})`);Kt("PRERELEASE",`(?:-(${it[ot.PRERELEASEIDENTIFIER]}(?:\\.${it[ot.PRERELEASEIDENTIFIER]})*))`);Kt("PRERELEASELOOSE",`(?:-?(${it[ot.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${it[ot.PRERELEASEIDENTIFIERLOOSE]})*))`);Kt("BUILDIDENTIFIER",`${zz}+`);Kt("BUILD",`(?:\\+(${it[ot.BUILDIDENTIFIER]}(?:\\.${it[ot.BUILDIDENTIFIER]})*))`);Kt("FULLPLAIN",`v?${it[ot.MAINVERSION]}${it[ot.PRERELEASE]}?${it[ot.BUILD]}?`);Kt("FULL",`^${it[ot.FULLPLAIN]}$`);Kt("LOOSEPLAIN",`[v=\\s]*${it[ot.MAINVERSIONLOOSE]}${it[ot.PRERELEASELOOSE]}?${it[ot.BUILD]}?`);Kt("LOOSE",`^${it[ot.LOOSEPLAIN]}$`);Kt("GTLT","((?:<|>)?=?)");Kt("XRANGEIDENTIFIERLOOSE",`${it[ot.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);Kt("XRANGEIDENTIFIER",`${it[ot.NUMERICIDENTIFIER]}|x|X|\\*`);Kt("XRANGEPLAIN",`[v=\\s]*(${it[ot.XRANGEIDENTIFIER]})(?:\\.(${it[ot.XRANGEIDENTIFIER]})(?:\\.(${it[ot.XRANGEIDENTIFIER]})(?:${it[ot.PRERELEASE]})?${it[ot.BUILD]}?)?)?`);Kt("XRANGEPLAINLOOSE",`[v=\\s]*(${it[ot.XRANGEIDENTIFIERLOOSE]})(?:\\.(${it[ot.XRANGEIDENTIFIERLOOSE]})(?:\\.(${it[ot.XRANGEIDENTIFIERLOOSE]})(?:${it[ot.PRERELEASELOOSE]})?${it[ot.BUILD]}?)?)?`);Kt("XRANGE",`^${it[ot.GTLT]}\\s*${it[ot.XRANGEPLAIN]}$`);Kt("XRANGELOOSE",`^${it[ot.GTLT]}\\s*${it[ot.XRANGEPLAINLOOSE]}$`);Kt("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Gz}})(?:\\.(\\d{1,${Gz}}))?(?:\\.(\\d{1,${Gz}}))?`);Kt("COERCE",`${it[ot.COERCEPLAIN]}(?:$|[^\\d])`);Kt("COERCEFULL",it[ot.COERCEPLAIN]+`(?:${it[ot.PRERELEASE]})?(?:${it[ot.BUILD]})?(?:$|[^\\d])`);Kt("COERCERTL",it[ot.COERCE],!0);Kt("COERCERTLFULL",it[ot.COERCEFULL],!0);Kt("LONETILDE","(?:~>?)");Kt("TILDETRIM",`(\\s*)${it[ot.LONETILDE]}\\s+`,!0);Bf.tildeTrimReplace="$1~";Kt("TILDE",`^${it[ot.LONETILDE]}${it[ot.XRANGEPLAIN]}$`);Kt("TILDELOOSE",`^${it[ot.LONETILDE]}${it[ot.XRANGEPLAINLOOSE]}$`);Kt("LONECARET","(?:\\^)");Kt("CARETTRIM",`(\\s*)${it[ot.LONECARET]}\\s+`,!0);Bf.caretTrimReplace="$1^";Kt("CARET",`^${it[ot.LONECARET]}${it[ot.XRANGEPLAIN]}$`);Kt("CARETLOOSE",`^${it[ot.LONECARET]}${it[ot.XRANGEPLAINLOOSE]}$`);Kt("COMPARATORLOOSE",`^${it[ot.GTLT]}\\s*(${it[ot.LOOSEPLAIN]})$|^$`);Kt("COMPARATOR",`^${it[ot.GTLT]}\\s*(${it[ot.FULLPLAIN]})$|^$`);Kt("COMPARATORTRIM",`(\\s*)${it[ot.GTLT]}\\s*(${it[ot.LOOSEPLAIN]}|${it[ot.XRANGEPLAIN]})`,!0);Bf.comparatorTrimReplace="$1$2$3";Kt("HYPHENRANGE",`^\\s*(${it[ot.XRANGEPLAIN]})\\s+-\\s+(${it[ot.XRANGEPLAIN]})\\s*$`);Kt("HYPHENRANGELOOSE",`^\\s*(${it[ot.XRANGEPLAINLOOSE]})\\s+-\\s+(${it[ot.XRANGEPLAINLOOSE]})\\s*$`);Kt("STAR","(<|>)?=?\\s*\\*");Kt("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");Kt("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var p5=M((wlr,nhe)=>{var kVe=Object.freeze({loose:!0}),PVe=Object.freeze({}),AVe=t=>t?typeof t!="object"?kVe:t:PVe;nhe.exports=AVe});var $z=M((Rlr,she)=>{var ihe=/^[0-9]+$/,ohe=(t,e)=>{let r=ihe.test(t),n=ihe.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1},DVe=(t,e)=>ohe(e,t);she.exports={compareIdentifiers:ohe,rcompareIdentifiers:DVe}});var Ps=M((klr,lhe)=>{var f5=Ek(),{MAX_LENGTH:ahe,MAX_SAFE_INTEGER:m5}=Ck(),{safeRe:che,t:uhe}=EI(),NVe=p5(),{compareIdentifiers:TI}=$z(),Wz=class t{constructor(e,r){if(r=NVe(r),e instanceof t){if(e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>ahe)throw new TypeError(`version is longer than ${ahe} characters`);f5("SemVer",e,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;let n=e.trim().match(r.loose?che[uhe.LOOSE]:che[uhe.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>m5||this.major<0)throw new TypeError("Invalid major version");if(this.minor>m5||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>m5||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(o=>{if(/^[0-9]+$/.test(o)){let s=+o;if(s>=0&&s<m5)return s}return o}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(f5("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if(typeof e=="string"&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof t||(e=new t(e,this.options)),TI(this.major,e.major)||TI(this.minor,e.minor)||TI(this.patch,e.patch)}comparePre(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let r=0;do{let n=this.prerelease[r],o=e.prerelease[r];if(f5("prerelease compare",r,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return TI(n,o)}while(++r)}compareBuild(e){e instanceof t||(e=new t(e,this.options));let r=0;do{let n=this.build[r],o=e.build[r];if(f5("build compare",r,n,o),n===void 0&&o===void 0)return 0;if(o===void 0)return 1;if(n===void 0)return-1;if(n===o)continue;return TI(n,o)}while(++r)}inc(e,r,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,n),this.inc("pre",r,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,n),this.inc("pre",r,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let o=Number(n)?1:0;if(!r&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[o];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(r===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(o)}}if(r){let s=[r,o];n===!1&&(s=[r]),TI(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};lhe.exports=Wz});var Ny=M((Plr,phe)=>{var dhe=Ps(),LVe=(t,e,r=!1)=>{if(t instanceof dhe)return t;try{return new dhe(t,e)}catch(n){if(!r)return null;throw n}};phe.exports=LVe});var mhe=M((Alr,fhe)=>{var OVe=Ny(),MVe=(t,e)=>{let r=OVe(t,e);return r?r.version:null};fhe.exports=MVe});var ghe=M((Dlr,hhe)=>{var FVe=Ny(),UVe=(t,e)=>{let r=FVe(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null};hhe.exports=UVe});var bhe=M((Nlr,yhe)=>{var vhe=Ps(),BVe=(t,e,r,n,o)=>{typeof r=="string"&&(o=n,n=r,r=void 0);try{return new vhe(t instanceof vhe?t.version:t,r).inc(e,n,o).version}catch{return null}};yhe.exports=BVe});var She=M((Llr,xhe)=>{var _he=Ny(),qVe=(t,e)=>{let r=_he(t,null,!0),n=_he(e,null,!0),o=r.compare(n);if(o===0)return null;let s=o>0,a=s?r:n,c=s?n:r,u=!!a.prerelease.length;if(!!c.prerelease.length&&!u)return!c.patch&&!c.minor?"major":a.patch?"patch":a.minor?"minor":"major";let d=u?"pre":"";return r.major!==n.major?d+"major":r.minor!==n.minor?d+"minor":r.patch!==n.patch?d+"patch":"prerelease"};xhe.exports=qVe});var Che=M((Olr,Ihe)=>{var HVe=Ps(),jVe=(t,e)=>new HVe(t,e).major;Ihe.exports=jVe});var The=M((Mlr,Ehe)=>{var VVe=Ps(),GVe=(t,e)=>new VVe(t,e).minor;Ehe.exports=GVe});var Rhe=M((Flr,whe)=>{var zVe=Ps(),$Ve=(t,e)=>new zVe(t,e).patch;whe.exports=$Ve});var Phe=M((Ulr,khe)=>{var WVe=Ny(),KVe=(t,e)=>{let r=WVe(t,e);return r&&r.prerelease.length?r.prerelease:null};khe.exports=KVe});var Eu=M((Blr,Dhe)=>{var Ahe=Ps(),YVe=(t,e,r)=>new Ahe(t,r).compare(new Ahe(e,r));Dhe.exports=YVe});var Lhe=M((qlr,Nhe)=>{var QVe=Eu(),XVe=(t,e,r)=>QVe(e,t,r);Nhe.exports=XVe});var Mhe=M((Hlr,Ohe)=>{var JVe=Eu(),ZVe=(t,e)=>JVe(t,e,!0);Ohe.exports=ZVe});var h5=M((jlr,Uhe)=>{var Fhe=Ps(),eGe=(t,e,r)=>{let n=new Fhe(t,r),o=new Fhe(e,r);return n.compare(o)||n.compareBuild(o)};Uhe.exports=eGe});var qhe=M((Vlr,Bhe)=>{var tGe=h5(),rGe=(t,e)=>t.sort((r,n)=>tGe(r,n,e));Bhe.exports=rGe});var jhe=M((Glr,Hhe)=>{var nGe=h5(),iGe=(t,e)=>t.sort((r,n)=>nGe(n,r,e));Hhe.exports=iGe});var Tk=M((zlr,Vhe)=>{var oGe=Eu(),sGe=(t,e,r)=>oGe(t,e,r)>0;Vhe.exports=sGe});var g5=M(($lr,Ghe)=>{var aGe=Eu(),cGe=(t,e,r)=>aGe(t,e,r)<0;Ghe.exports=cGe});var Kz=M((Wlr,zhe)=>{var uGe=Eu(),lGe=(t,e,r)=>uGe(t,e,r)===0;zhe.exports=lGe});var Yz=M((Klr,$he)=>{var dGe=Eu(),pGe=(t,e,r)=>dGe(t,e,r)!==0;$he.exports=pGe});var v5=M((Ylr,Whe)=>{var fGe=Eu(),mGe=(t,e,r)=>fGe(t,e,r)>=0;Whe.exports=mGe});var y5=M((Qlr,Khe)=>{var hGe=Eu(),gGe=(t,e,r)=>hGe(t,e,r)<=0;Khe.exports=gGe});var Qz=M((Xlr,Yhe)=>{var vGe=Kz(),yGe=Yz(),bGe=Tk(),_Ge=v5(),xGe=g5(),SGe=y5(),IGe=(t,e,r,n)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return vGe(t,r,n);case"!=":return yGe(t,r,n);case">":return bGe(t,r,n);case">=":return _Ge(t,r,n);case"<":return xGe(t,r,n);case"<=":return SGe(t,r,n);default:throw new TypeError(`Invalid operator: ${e}`)}};Yhe.exports=IGe});var Xhe=M((Jlr,Qhe)=>{var CGe=Ps(),EGe=Ny(),{safeRe:b5,t:_5}=EI(),TGe=(t,e)=>{if(t instanceof CGe)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let r=null;if(!e.rtl)r=t.match(e.includePrerelease?b5[_5.COERCEFULL]:b5[_5.COERCE]);else{let u=e.includePrerelease?b5[_5.COERCERTLFULL]:b5[_5.COERCERTL],l;for(;(l=u.exec(t))&&(!r||r.index+r[0].length!==t.length);)(!r||l.index+l[0].length!==r.index+r[0].length)&&(r=l),u.lastIndex=l.index+l[1].length+l[2].length;u.lastIndex=-1}if(r===null)return null;let n=r[2],o=r[3]||"0",s=r[4]||"0",a=e.includePrerelease&&r[5]?`-${r[5]}`:"",c=e.includePrerelease&&r[6]?`+${r[6]}`:"";return EGe(`${n}.${o}.${s}${a}${c}`,e)};Qhe.exports=TGe});var Zhe=M((Zlr,Jhe)=>{var Xz=class{constructor(){this.max=1e3,this.map=new Map}get(e){let r=this.map.get(e);if(r!==void 0)return this.map.delete(e),this.map.set(e,r),r}delete(e){return this.map.delete(e)}set(e,r){if(!this.delete(e)&&r!==void 0){if(this.map.size>=this.max){let o=this.map.keys().next().value;this.delete(o)}this.map.set(e,r)}return this}};Jhe.exports=Xz});var Tu=M((edr,nge)=>{var Jz=class t{constructor(e,r){if(r=RGe(r),e instanceof t)return e.loose===!!r.loose&&e.includePrerelease===!!r.includePrerelease?e:new t(e.raw,r);if(e instanceof Zz)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(o=>!tge(o[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let o of this.set)if(o.length===1&&OGe(o[0])){this.set=[o];break}}}this.format()}format(){return this.range=this.set.map(e=>e.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&NGe)|(this.options.loose&&LGe))+":"+e,o=ege.get(n);if(o)return o;let s=this.options.loose,a=s?Ma[aa.HYPHENRANGELOOSE]:Ma[aa.HYPHENRANGE];e=e.replace(a,zGe(this.options.includePrerelease)),jn("hyphen replace",e),e=e.replace(Ma[aa.COMPARATORTRIM],PGe),jn("comparator trim",e),e=e.replace(Ma[aa.TILDETRIM],AGe),jn("tilde trim",e),e=e.replace(Ma[aa.CARETTRIM],DGe),jn("caret trim",e);let c=e.split(" ").map(p=>MGe(p,this.options)).join(" ").split(/\s+/).map(p=>GGe(p,this.options));s&&(c=c.filter(p=>(jn("loose invalid filter",p,this.options),!!p.match(Ma[aa.COMPARATORLOOSE])))),jn("range list",c);let u=new Map,l=c.map(p=>new Zz(p,this.options));for(let p of l){if(tge(p))return[p];u.set(p.value,p)}u.size>1&&u.has("")&&u.delete("");let d=[...u.values()];return ege.set(n,d),d}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Range is required");return this.set.some(n=>rge(n,r)&&e.set.some(o=>rge(o,r)&&n.every(s=>o.every(a=>s.intersects(a,r)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new kGe(e,this.options)}catch{return!1}for(let r=0;r<this.set.length;r++)if($Ge(this.set[r],e,this.options))return!0;return!1}};nge.exports=Jz;var wGe=Zhe(),ege=new wGe,RGe=p5(),Zz=wk(),jn=Ek(),kGe=Ps(),{safeRe:Ma,t:aa,comparatorTrimReplace:PGe,tildeTrimReplace:AGe,caretTrimReplace:DGe}=EI(),{FLAG_INCLUDE_PRERELEASE:NGe,FLAG_LOOSE:LGe}=Ck(),tge=t=>t.value==="<0.0.0-0",OGe=t=>t.value==="",rge=(t,e)=>{let r=!0,n=t.slice(),o=n.pop();for(;r&&n.length;)r=n.every(s=>o.intersects(s,e)),o=n.pop();return r},MGe=(t,e)=>(jn("comp",t,e),t=BGe(t,e),jn("caret",t),t=FGe(t,e),jn("tildes",t),t=HGe(t,e),jn("xrange",t),t=VGe(t,e),jn("stars",t),t),ca=t=>!t||t.toLowerCase()==="x"||t==="*",FGe=(t,e)=>t.trim().split(/\s+/).map(r=>UGe(r,e)).join(" "),UGe=(t,e)=>{let r=e.loose?Ma[aa.TILDELOOSE]:Ma[aa.TILDE];return t.replace(r,(n,o,s,a,c)=>{jn("tilde",t,n,o,s,a,c);let u;return ca(o)?u="":ca(s)?u=`>=${o}.0.0 <${+o+1}.0.0-0`:ca(a)?u=`>=${o}.${s}.0 <${o}.${+s+1}.0-0`:c?(jn("replaceTilde pr",c),u=`>=${o}.${s}.${a}-${c} <${o}.${+s+1}.0-0`):u=`>=${o}.${s}.${a} <${o}.${+s+1}.0-0`,jn("tilde return",u),u})},BGe=(t,e)=>t.trim().split(/\s+/).map(r=>qGe(r,e)).join(" "),qGe=(t,e)=>{jn("caret",t,e);let r=e.loose?Ma[aa.CARETLOOSE]:Ma[aa.CARET],n=e.includePrerelease?"-0":"";return t.replace(r,(o,s,a,c,u)=>{jn("caret",t,o,s,a,c,u);let l;return ca(s)?l="":ca(a)?l=`>=${s}.0.0${n} <${+s+1}.0.0-0`:ca(c)?s==="0"?l=`>=${s}.${a}.0${n} <${s}.${+a+1}.0-0`:l=`>=${s}.${a}.0${n} <${+s+1}.0.0-0`:u?(jn("replaceCaret pr",u),s==="0"?a==="0"?l=`>=${s}.${a}.${c}-${u} <${s}.${a}.${+c+1}-0`:l=`>=${s}.${a}.${c}-${u} <${s}.${+a+1}.0-0`:l=`>=${s}.${a}.${c}-${u} <${+s+1}.0.0-0`):(jn("no pr"),s==="0"?a==="0"?l=`>=${s}.${a}.${c}${n} <${s}.${a}.${+c+1}-0`:l=`>=${s}.${a}.${c}${n} <${s}.${+a+1}.0-0`:l=`>=${s}.${a}.${c} <${+s+1}.0.0-0`),jn("caret return",l),l})},HGe=(t,e)=>(jn("replaceXRanges",t,e),t.split(/\s+/).map(r=>jGe(r,e)).join(" ")),jGe=(t,e)=>{t=t.trim();let r=e.loose?Ma[aa.XRANGELOOSE]:Ma[aa.XRANGE];return t.replace(r,(n,o,s,a,c,u)=>{jn("xRange",t,n,o,s,a,c,u);let l=ca(s),d=l||ca(a),p=d||ca(c),f=p;return o==="="&&f&&(o=""),u=e.includePrerelease?"-0":"",l?o===">"||o==="<"?n="<0.0.0-0":n="*":o&&f?(d&&(a=0),c=0,o===">"?(o=">=",d?(s=+s+1,a=0,c=0):(a=+a+1,c=0)):o==="<="&&(o="<",d?s=+s+1:a=+a+1),o==="<"&&(u="-0"),n=`${o+s}.${a}.${c}${u}`):d?n=`>=${s}.0.0${u} <${+s+1}.0.0-0`:p&&(n=`>=${s}.${a}.0${u} <${s}.${+a+1}.0-0`),jn("xRange return",n),n})},VGe=(t,e)=>(jn("replaceStars",t,e),t.trim().replace(Ma[aa.STAR],"")),GGe=(t,e)=>(jn("replaceGTE0",t,e),t.trim().replace(Ma[e.includePrerelease?aa.GTE0PRE:aa.GTE0],"")),zGe=t=>(e,r,n,o,s,a,c,u,l,d,p,f)=>(ca(n)?r="":ca(o)?r=`>=${n}.0.0${t?"-0":""}`:ca(s)?r=`>=${n}.${o}.0${t?"-0":""}`:a?r=`>=${r}`:r=`>=${r}${t?"-0":""}`,ca(l)?u="":ca(d)?u=`<${+l+1}.0.0-0`:ca(p)?u=`<${l}.${+d+1}.0-0`:f?u=`<=${l}.${d}.${p}-${f}`:t?u=`<${l}.${d}.${+p+1}-0`:u=`<=${u}`,`${r} ${u}`.trim()),$Ge=(t,e,r)=>{for(let n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(let n=0;n<t.length;n++)if(jn(t[n].semver),t[n].semver!==Zz.ANY&&t[n].semver.prerelease.length>0){let o=t[n].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}});var wk=M((tdr,uge)=>{var Rk=Symbol("SemVer ANY"),r$=class t{static get ANY(){return Rk}constructor(e,r){if(r=ige(r),e instanceof t){if(e.loose===!!r.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),t$("comparator",e,r),this.options=r,this.loose=!!r.loose,this.parse(e),this.semver===Rk?this.value="":this.value=this.operator+this.semver.version,t$("comp",this)}parse(e){let r=this.options.loose?oge[sge.COMPARATORLOOSE]:oge[sge.COMPARATOR],n=e.match(r);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new age(n[2],this.options.loose):this.semver=Rk}toString(){return this.value}test(e){if(t$("Comparator.test",e,this.options.loose),this.semver===Rk||e===Rk)return!0;if(typeof e=="string")try{e=new age(e,this.options)}catch{return!1}return e$(e,this.operator,this.semver,this.options)}intersects(e,r){if(!(e instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new cge(e.value,r).test(this.value):e.operator===""?e.value===""?!0:new cge(this.value,r).test(e.semver):(r=ige(r),r.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!r.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||e$(this.semver,"<",e.semver,r)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||e$(this.semver,">",e.semver,r)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};uge.exports=r$;var ige=p5(),{safeRe:oge,t:sge}=EI(),e$=Qz(),t$=Ek(),age=Ps(),cge=Tu()});var kk=M((rdr,lge)=>{var WGe=Tu(),KGe=(t,e,r)=>{try{e=new WGe(e,r)}catch{return!1}return e.test(t)};lge.exports=KGe});var pge=M((ndr,dge)=>{var YGe=Tu(),QGe=(t,e)=>new YGe(t,e).set.map(r=>r.map(n=>n.value).join(" ").trim().split(" "));dge.exports=QGe});var mge=M((idr,fge)=>{var XGe=Ps(),JGe=Tu(),ZGe=(t,e,r)=>{let n=null,o=null,s=null;try{s=new JGe(e,r)}catch{return null}return t.forEach(a=>{s.test(a)&&(!n||o.compare(a)===-1)&&(n=a,o=new XGe(n,r))}),n};fge.exports=ZGe});var gge=M((odr,hge)=>{var eze=Ps(),tze=Tu(),rze=(t,e,r)=>{let n=null,o=null,s=null;try{s=new tze(e,r)}catch{return null}return t.forEach(a=>{s.test(a)&&(!n||o.compare(a)===1)&&(n=a,o=new eze(n,r))}),n};hge.exports=rze});var bge=M((sdr,yge)=>{var n$=Ps(),nze=Tu(),vge=Tk(),ize=(t,e)=>{t=new nze(t,e);let r=new n$("0.0.0");if(t.test(r)||(r=new n$("0.0.0-0"),t.test(r)))return r;r=null;for(let n=0;n<t.set.length;++n){let o=t.set[n],s=null;o.forEach(a=>{let c=new n$(a.semver.version);switch(a.operator){case">":c.prerelease.length===0?c.patch++:c.prerelease.push(0),c.raw=c.format();case"":case">=":(!s||vge(c,s))&&(s=c);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),s&&(!r||vge(r,s))&&(r=s)}return r&&t.test(r)?r:null};yge.exports=ize});var xge=M((adr,_ge)=>{var oze=Tu(),sze=(t,e)=>{try{return new oze(t,e).range||"*"}catch{return null}};_ge.exports=sze});var x5=M((cdr,Ege)=>{var aze=Ps(),Cge=wk(),{ANY:cze}=Cge,uze=Tu(),lze=kk(),Sge=Tk(),Ige=g5(),dze=y5(),pze=v5(),fze=(t,e,r,n)=>{t=new aze(t,n),e=new uze(e,n);let o,s,a,c,u;switch(r){case">":o=Sge,s=dze,a=Ige,c=">",u=">=";break;case"<":o=Ige,s=pze,a=Sge,c="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(lze(t,e,n))return!1;for(let l=0;l<e.set.length;++l){let d=e.set[l],p=null,f=null;if(d.forEach(m=>{m.semver===cze&&(m=new Cge(">=0.0.0")),p=p||m,f=f||m,o(m.semver,p.semver,n)?p=m:a(m.semver,f.semver,n)&&(f=m)}),p.operator===c||p.operator===u||(!f.operator||f.operator===c)&&s(t,f.semver))return!1;if(f.operator===u&&a(t,f.semver))return!1}return!0};Ege.exports=fze});var wge=M((udr,Tge)=>{var mze=x5(),hze=(t,e,r)=>mze(t,e,">",r);Tge.exports=hze});var kge=M((ldr,Rge)=>{var gze=x5(),vze=(t,e,r)=>gze(t,e,"<",r);Rge.exports=vze});var Dge=M((ddr,Age)=>{var Pge=Tu(),yze=(t,e,r)=>(t=new Pge(t,r),e=new Pge(e,r),t.intersects(e,r));Age.exports=yze});var Lge=M((pdr,Nge)=>{var bze=kk(),_ze=Eu();Nge.exports=(t,e,r)=>{let n=[],o=null,s=null,a=t.sort((d,p)=>_ze(d,p,r));for(let d of a)bze(d,e,r)?(s=d,o||(o=d)):(s&&n.push([o,s]),s=null,o=null);o&&n.push([o,null]);let c=[];for(let[d,p]of n)d===p?c.push(d):!p&&d===a[0]?c.push("*"):p?d===a[0]?c.push(`<=${p}`):c.push(`${d} - ${p}`):c.push(`>=${d}`);let u=c.join(" || "),l=typeof e.raw=="string"?e.raw:String(e);return u.length<l.length?u:e}});var qge=M((fdr,Bge)=>{var Oge=Tu(),o$=wk(),{ANY:i$}=o$,Pk=kk(),s$=Eu(),xze=(t,e,r={})=>{if(t===e)return!0;t=new Oge(t,r),e=new Oge(e,r);let n=!1;e:for(let o of t.set){for(let s of e.set){let a=Ize(o,s,r);if(n=n||a!==null,a)continue e}if(n)return!1}return!0},Sze=[new o$(">=0.0.0-0")],Mge=[new o$(">=0.0.0")],Ize=(t,e,r)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===i$){if(e.length===1&&e[0].semver===i$)return!0;r.includePrerelease?t=Sze:t=Mge}if(e.length===1&&e[0].semver===i$){if(r.includePrerelease)return!0;e=Mge}let n=new Set,o,s;for(let m of t)m.operator===">"||m.operator===">="?o=Fge(o,m,r):m.operator==="<"||m.operator==="<="?s=Uge(s,m,r):n.add(m.semver);if(n.size>1)return null;let a;if(o&&s){if(a=s$(o.semver,s.semver,r),a>0)return null;if(a===0&&(o.operator!==">="||s.operator!=="<="))return null}for(let m of n){if(o&&!Pk(m,String(o),r)||s&&!Pk(m,String(s),r))return null;for(let h of e)if(!Pk(m,String(h),r))return!1;return!0}let c,u,l,d,p=s&&!r.includePrerelease&&s.semver.prerelease.length?s.semver:!1,f=o&&!r.includePrerelease&&o.semver.prerelease.length?o.semver:!1;p&&p.prerelease.length===1&&s.operator==="<"&&p.prerelease[0]===0&&(p=!1);for(let m of e){if(d=d||m.operator===">"||m.operator===">=",l=l||m.operator==="<"||m.operator==="<=",o){if(f&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===f.major&&m.semver.minor===f.minor&&m.semver.patch===f.patch&&(f=!1),m.operator===">"||m.operator===">="){if(c=Fge(o,m,r),c===m&&c!==o)return!1}else if(o.operator===">="&&!Pk(o.semver,String(m),r))return!1}if(s){if(p&&m.semver.prerelease&&m.semver.prerelease.length&&m.semver.major===p.major&&m.semver.minor===p.minor&&m.semver.patch===p.patch&&(p=!1),m.operator==="<"||m.operator==="<="){if(u=Uge(s,m,r),u===m&&u!==s)return!1}else if(s.operator==="<="&&!Pk(s.semver,String(m),r))return!1}if(!m.operator&&(s||o)&&a!==0)return!1}return!(o&&l&&!s&&a!==0||s&&d&&!o&&a!==0||f||p)},Fge=(t,e,r)=>{if(!t)return e;let n=s$(t.semver,e.semver,r);return n>0?t:n<0||e.operator===">"&&t.operator===">="?e:t},Uge=(t,e,r)=>{if(!t)return e;let n=s$(t.semver,e.semver,r);return n<0?t:n>0||e.operator==="<"&&t.operator==="<="?e:t};Bge.exports=xze});var Gge=M((mdr,Vge)=>{var a$=EI(),Hge=Ck(),Cze=Ps(),jge=$z(),Eze=Ny(),Tze=mhe(),wze=ghe(),Rze=bhe(),kze=She(),Pze=Che(),Aze=The(),Dze=Rhe(),Nze=Phe(),Lze=Eu(),Oze=Lhe(),Mze=Mhe(),Fze=h5(),Uze=qhe(),Bze=jhe(),qze=Tk(),Hze=g5(),jze=Kz(),Vze=Yz(),Gze=v5(),zze=y5(),$ze=Qz(),Wze=Xhe(),Kze=wk(),Yze=Tu(),Qze=kk(),Xze=pge(),Jze=mge(),Zze=gge(),e$e=bge(),t$e=xge(),r$e=x5(),n$e=wge(),i$e=kge(),o$e=Dge(),s$e=Lge(),a$e=qge();Vge.exports={parse:Eze,valid:Tze,clean:wze,inc:Rze,diff:kze,major:Pze,minor:Aze,patch:Dze,prerelease:Nze,compare:Lze,rcompare:Oze,compareLoose:Mze,compareBuild:Fze,sort:Uze,rsort:Bze,gt:qze,lt:Hze,eq:jze,neq:Vze,gte:Gze,lte:zze,cmp:$ze,coerce:Wze,Comparator:Kze,Range:Yze,satisfies:Qze,toComparators:Xze,maxSatisfying:Jze,minSatisfying:Zze,minVersion:e$e,validRange:t$e,outside:r$e,gtr:n$e,ltr:i$e,intersects:o$e,simplifyRange:s$e,subset:a$e,SemVer:Cze,re:a$.re,src:a$.src,tokens:a$.t,SEMVER_SPEC_VERSION:Hge.SEMVER_SPEC_VERSION,RELEASE_TYPES:Hge.RELEASE_TYPES,compareIdentifiers:jge.compareIdentifiers,rcompareIdentifiers:jge.rcompareIdentifiers}});var c$=M(S5=>{"use strict";Object.defineProperty(S5,"__esModule",{value:!0});S5.makePatchingRequire=void 0;var c$e=require("path"),u$e=Gge(),zge=xi(),Wge=require("module"),l$e=Object.keys(process.binding("natives")),$ge=Wge.prototype.require;function d$e(t){var e={};return function(n){var o=$ge.apply(this,arguments);if(t[n]){var s=Wge._resolveFilename(n,this);if(e.hasOwnProperty(s))return e[s];var a=void 0;if(l$e.indexOf(n)<0)try{a=$ge.call(this,c$e.join(n,"package.json")).version}catch{return o}else a=process.version.substring(1);var c=a.indexOf("-");c>=0&&(a=a.substring(0,c));for(var u=o,l=0,d=t[n];l<d.length;l++){var p=d[l];if(u$e.satisfies(a,p.versionSpecifier)&&(u=p.patch(u,s),zge.channel)){var f=p.publisherName||n;zge.channel.addPatchedModule(f,a)}}return e[s]=u}return o}}S5.makePatchingRequire=d$e});var Kge=M((gdr,p$e)=>{p$e.exports={name:"diagnostic-channel",version:"1.1.1",main:"./dist/src/channel.js",types:"./dist/src/channel.d.ts",scripts:{build:"tsc",lint:"eslint ./ --fix",clean:"rimraf ./dist",test:"mocha ./dist/tests/**/*.js",debug:"mocha --inspect-brk ./dist/tests/**/*.js"},homepage:"https://github.com/Microsoft/node-diagnostic-channel",bugs:{url:"https://github.com/Microsoft/node-diagnostic-channel/issues"},repository:{type:"git",url:"https://github.com/Microsoft/node-diagnostic-channel.git"},description:"Provides a context-saving pub/sub channel to connect diagnostic event publishers and subscribers",dependencies:{semver:"^7.5.3"},devDependencies:{"@types/mocha":"^2.2.40","@types/node":"~8.0.0",mocha:"^3.2.0",rimraf:"^2.6.1",sinon:"1.17.6",typescript:"4.1.2"},files:["dist/src/**/*.d.ts","dist/src/**/*.js","LICENSE","README.md","package.json"],license:"MIT"}});var xi=M(wu=>{"use strict";Object.defineProperty(wu,"__esModule",{value:!0});wu.channel=wu.ContextPreservingEventEmitter=wu.trueFilter=wu.makePatchingRequire=void 0;var f$e=c$(),m$e=c$();Object.defineProperty(wu,"makePatchingRequire",{enumerable:!0,get:function(){return m$e.makePatchingRequire}});var h$e=function(t){return!0};wu.trueFilter=h$e;var Qge=function(){function t(){this.version=Kge().version,this.subscribers={},this.contextPreservationFunction=function(e){return e},this.knownPatches={},this.modulesPatched=[],this.currentlyPublishing=!1}return t.prototype.shouldPublish=function(e){var r=this.subscribers[e];return r?r.some(function(n){var o=n.filter;return!o||o(!1)}):!1},t.prototype.publish=function(e,r){if(!this.currentlyPublishing){var n=this.subscribers[e];if(n){var o={timestamp:Date.now(),data:r};this.currentlyPublishing=!0,n.forEach(function(s){var a=s.listener,c=s.filter;try{c&&c(!0)&&a(o)}catch{}}),this.currentlyPublishing=!1}}},t.prototype.subscribe=function(e,r,n,o){n===void 0&&(n=wu.trueFilter),this.subscribers[e]||(this.subscribers[e]=[]),this.subscribers[e].push({listener:r,filter:n,patchCallback:o});var s=this.checkIfModuleIsAlreadyPatched(e);s&&o&&o(s.name,s.version)},t.prototype.unsubscribe=function(e,r,n){n===void 0&&(n=wu.trueFilter);var o=this.subscribers[e];if(o){for(var s=0;s<o.length;++s)if(o[s].listener===r&&o[s].filter===n)return o.splice(s,1),!0}return!1},t.prototype.reset=function(){var e=this;this.subscribers={},this.contextPreservationFunction=function(r){return r},Object.getOwnPropertyNames(this.knownPatches).forEach(function(r){return delete e.knownPatches[r]})},t.prototype.bindToContext=function(e){return this.contextPreservationFunction(e)},t.prototype.addContextPreservation=function(e){var r=this.contextPreservationFunction;this.contextPreservationFunction=function(n){return e(r(n))}},t.prototype.registerMonkeyPatch=function(e,r){this.knownPatches[e]||(this.knownPatches[e]=[]),this.knownPatches[e].push(r)},t.prototype.getPatchesObject=function(){return this.knownPatches},t.prototype.addPatchedModule=function(e,r){for(var n=0,o=this.modulesPatched;n<o.length;n++){var s=o[n];if(s.name===e)return}this.modulesPatched.push({name:e,version:r});var a=this.subscribers[e];a&&a.forEach(function(c){c.patchCallback&&c.patchCallback(e,r)})},t.prototype.checkIfModuleIsAlreadyPatched=function(e){for(var r=0,n=this.modulesPatched;r<n.length;r++){var o=n[r];if(o.name===e)return o}return null},t}();wu.ContextPreservingEventEmitter=Qge;global.diagnosticsSource||(global.diagnosticsSource=new Qge,Yge=require("module"),Yge.prototype.require=f$e.makePatchingRequire(global.diagnosticsSource.getPatchesObject()));var Yge;wu.channel=global.diagnosticsSource});var Xge,Jge=R(()=>{Xge=typeof globalThis=="object"?globalThis:global});var Zge=R(()=>{Jge()});var eve=R(()=>{Zge()});var qf,u$=R(()=>{qf="1.6.0"});function g$e(t){var e=new Set([t]),r=new Set,n=t.match(tve);if(!n)return function(){return!1};var o={major:+n[1],minor:+n[2],patch:+n[3],prerelease:n[4]};if(o.prerelease!=null)return function(u){return u===t};function s(c){return r.add(c),!1}function a(c){return e.add(c),!0}return function(u){if(e.has(u))return!0;if(r.has(u))return!1;var l=u.match(tve);if(!l)return s(u);var d={major:+l[1],minor:+l[2],patch:+l[3],prerelease:l[4]};return d.prerelease!=null||o.major!==d.major?s(u):o.major===0?o.minor===d.minor&&o.patch<=d.patch?a(u):s(u):o.minor<=d.minor?a(u):s(u)}}var tve,rve,nve=R(()=>{u$();tve=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;rve=g$e(qf)});function zd(t,e,r,n){var o;n===void 0&&(n=!1);var s=Dk[Ak]=(o=Dk[Ak])!==null&&o!==void 0?o:{version:qf};if(!n&&s[t]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+t);return r.error(a.stack||a.message),!1}if(s.version!==qf){var a=new Error("@opentelemetry/api: Registration of version v"+s.version+" for "+t+" does not match previously registered API v"+qf);return r.error(a.stack||a.message),!1}return s[t]=e,r.debug("@opentelemetry/api: Registered a global for "+t+" v"+qf+"."),!0}function Rc(t){var e,r,n=(e=Dk[Ak])===null||e===void 0?void 0:e.version;if(!(!n||!rve(n)))return(r=Dk[Ak])===null||r===void 0?void 0:r[t]}function $d(t,e){e.debug("@opentelemetry/api: Unregistering a global for "+t+" v"+qf+".");var r=Dk[Ak];r&&delete r[t]}var v$e,Ak,Dk,Ly=R(()=>{eve();u$();nve();v$e=qf.split(".")[0],Ak=Symbol.for("opentelemetry.js.api."+v$e),Dk=Xge});function Nk(t,e,r){var n=Rc("diag");if(n)return r.unshift(e),n[t].apply(n,b$e([],y$e(r),!1))}var y$e,b$e,ive,ove=R(()=>{Ly();y$e=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},b$e=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},ive=function(){function t(e){this._namespace=e.namespace||"DiagComponentLogger"}return t.prototype.debug=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return Nk("debug",this._namespace,e)},t.prototype.error=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return Nk("error",this._namespace,e)},t.prototype.info=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return Nk("info",this._namespace,e)},t.prototype.warn=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return Nk("warn",this._namespace,e)},t.prototype.verbose=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return Nk("verbose",this._namespace,e)},t}()});var Tn,I5=R(()=>{(function(t){t[t.NONE=0]="NONE",t[t.ERROR=30]="ERROR",t[t.WARN=50]="WARN",t[t.INFO=60]="INFO",t[t.DEBUG=70]="DEBUG",t[t.VERBOSE=80]="VERBOSE",t[t.ALL=9999]="ALL"})(Tn||(Tn={}))});function sve(t,e){t<Tn.NONE?t=Tn.NONE:t>Tn.ALL&&(t=Tn.ALL),e=e||{};function r(n,o){var s=e[n];return typeof s=="function"&&t>=o?s.bind(e):function(){}}return{error:r("error",Tn.ERROR),warn:r("warn",Tn.WARN),info:r("info",Tn.INFO),debug:r("debug",Tn.DEBUG),verbose:r("verbose",Tn.VERBOSE)}}var ave=R(()=>{I5()});var _$e,x$e,S$e,As,Oy=R(()=>{ove();ave();I5();Ly();_$e=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},x$e=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},S$e="diag",As=function(){function t(){function e(o){return function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var c=Rc("diag");if(c)return c[o].apply(c,x$e([],_$e(s),!1))}}var r=this,n=function(o,s){var a,c,u;if(s===void 0&&(s={logLevel:Tn.INFO}),o===r){var l=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return r.error((a=l.stack)!==null&&a!==void 0?a:l.message),!1}typeof s=="number"&&(s={logLevel:s});var d=Rc("diag"),p=sve((c=s.logLevel)!==null&&c!==void 0?c:Tn.INFO,o);if(d&&!s.suppressOverrideMessage){var f=(u=new Error().stack)!==null&&u!==void 0?u:"<failed to generate stacktrace>";d.warn("Current logger will be overwritten from "+f),p.warn("Current logger will overwrite one already registered from "+f)}return zd("diag",p,r,!0)};r.setLogger=n,r.disable=function(){$d(S$e,r)},r.createComponentLogger=function(o){return new ive(o)},r.verbose=e("verbose"),r.debug=e("debug"),r.info=e("info"),r.warn=e("warn"),r.error=e("error")}return t.instance=function(){return this._instance||(this._instance=new t),this._instance},t}()});var I$e,C$e,cve,uve=R(()=>{I$e=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},C$e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},cve=function(){function t(e){this._entries=e?new Map(e):new Map}return t.prototype.getEntry=function(e){var r=this._entries.get(e);if(r)return Object.assign({},r)},t.prototype.getAllEntries=function(){return Array.from(this._entries.entries()).map(function(e){var r=I$e(e,2),n=r[0],o=r[1];return[n,o]})},t.prototype.setEntry=function(e,r){var n=new t(this._entries);return n._entries.set(e,r),n},t.prototype.removeEntry=function(e){var r=new t(this._entries);return r._entries.delete(e),r},t.prototype.removeEntries=function(){for(var e,r,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var s=new t(this._entries);try{for(var a=C$e(n),c=a.next();!c.done;c=a.next()){var u=c.value;s._entries.delete(u)}}catch(l){e={error:l}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}return s},t.prototype.clear=function(){return new t},t}()});var lve,dve=R(()=>{lve=Symbol("BaggageEntryMetadata")});function pve(t){return t===void 0&&(t={}),new cve(new Map(Object.entries(t)))}function C5(t){return typeof t!="string"&&(E$e.error("Cannot create baggage metadata from unknown type: "+typeof t),t=""),{__TYPE__:lve,toString:function(){return t}}}var E$e,l$=R(()=>{Oy();uve();dve();E$e=As.instance()});function Wd(t){return Symbol.for(t)}var T$e,E5,Lk=R(()=>{T$e=function(){function t(e){var r=this;r._currentContext=e?new Map(e):new Map,r.getValue=function(n){return r._currentContext.get(n)},r.setValue=function(n,o){var s=new t(r._currentContext);return s._currentContext.set(n,o),s},r.deleteValue=function(n){var o=new t(r._currentContext);return o._currentContext.delete(n),o}}return t}(),E5=new T$e});var d$,fve,mve=R(()=>{d$=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}],fve=function(){function t(){function e(n){return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];if(console){var a=console[n];if(typeof a!="function"&&(a=console.log),typeof a=="function")return a.apply(console,o)}}}for(var r=0;r<d$.length;r++)this[d$[r].n]=e(d$[r].c)}return t}()});function hve(){return m$}var wI,w$e,p$,R$e,k$e,P$e,f$,A$e,D$e,N$e,m$,L$e,O$e,M$e,F$e,U$e,B$e,h$=R(()=>{wI=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),w$e=function(){function t(){}return t.prototype.createHistogram=function(e,r){return O$e},t.prototype.createCounter=function(e,r){return L$e},t.prototype.createUpDownCounter=function(e,r){return M$e},t.prototype.createObservableGauge=function(e,r){return U$e},t.prototype.createObservableCounter=function(e,r){return F$e},t.prototype.createObservableUpDownCounter=function(e,r){return B$e},t.prototype.addBatchObservableCallback=function(e,r){},t.prototype.removeBatchObservableCallback=function(e){},t}(),p$=function(){function t(){}return t}(),R$e=function(t){wI(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.add=function(r,n){},e}(p$),k$e=function(t){wI(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.add=function(r,n){},e}(p$),P$e=function(t){wI(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.record=function(r,n){},e}(p$),f$=function(){function t(){}return t.prototype.addCallback=function(e){},t.prototype.removeCallback=function(e){},t}(),A$e=function(t){wI(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(f$),D$e=function(t){wI(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(f$),N$e=function(t){wI(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e}(f$),m$=new w$e,L$e=new R$e,O$e=new P$e,M$e=new k$e,F$e=new A$e,U$e=new D$e,B$e=new N$e});var T5,gve=R(()=>{(function(t){t[t.INT=0]="INT",t[t.DOUBLE=1]="DOUBLE"})(T5||(T5={}))});var w5,R5,g$=R(()=>{w5={get:function(t,e){if(t!=null)return t[e]},keys:function(t){return t==null?[]:Object.keys(t)}},R5={set:function(t,e,r){t!=null&&(t[e]=r)}}});var q$e,H$e,vve,yve=R(()=>{Lk();q$e=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},H$e=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},vve=function(){function t(){}return t.prototype.active=function(){return E5},t.prototype.with=function(e,r,n){for(var o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return r.call.apply(r,H$e([n],q$e(o),!1))},t.prototype.bind=function(e,r){return r},t.prototype.enable=function(){return this},t.prototype.disable=function(){return this},t}()});var j$e,V$e,v$,G$e,Ag,Ok=R(()=>{yve();Ly();Oy();j$e=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},V$e=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},v$="context",G$e=new vve,Ag=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalContextManager=function(e){return zd(v$,e,As.instance())},t.prototype.active=function(){return this._getContextManager().active()},t.prototype.with=function(e,r,n){for(var o,s=[],a=3;a<arguments.length;a++)s[a-3]=arguments[a];return(o=this._getContextManager()).with.apply(o,V$e([e,r,n],j$e(s),!1))},t.prototype.bind=function(e,r){return this._getContextManager().bind(e,r)},t.prototype._getContextManager=function(){return Rc(v$)||G$e},t.prototype.disable=function(){this._getContextManager().disable(),$d(v$,As.instance())},t}()});var Ui,y$=R(()=>{(function(t){t[t.NONE=0]="NONE",t[t.SAMPLED=1]="SAMPLED"})(Ui||(Ui={}))});var Mk,Fk,RI,k5=R(()=>{y$();Mk="0000000000000000",Fk="00000000000000000000000000000000",RI={traceId:Fk,spanId:Mk,traceFlags:Ui.NONE}});var Dg,P5=R(()=>{k5();Dg=function(){function t(e){e===void 0&&(e=RI),this._spanContext=e}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(e,r){return this},t.prototype.setAttributes=function(e){return this},t.prototype.addEvent=function(e,r){return this},t.prototype.setStatus=function(e){return this},t.prototype.updateName=function(e){return this},t.prototype.end=function(e){},t.prototype.isRecording=function(){return!1},t.prototype.recordException=function(e,r){},t}()});function A5(t){return t.getValue(b$)||void 0}function bve(){return A5(Ag.getInstance().active())}function Uk(t,e){return t.setValue(b$,e)}function _ve(t){return t.deleteValue(b$)}function xve(t,e){return Uk(t,new Dg(e))}function D5(t){var e;return(e=A5(t))===null||e===void 0?void 0:e.spanContext()}var b$,_$=R(()=>{Lk();P5();Ok();b$=Wd("OpenTelemetry Context Key SPAN")});function My(t){return z$e.test(t)&&t!==Fk}function x$(t){return $$e.test(t)&&t!==Mk}function Ru(t){return My(t.traceId)&&x$(t.spanId)}function Sve(t){return new Dg(t)}var z$e,$$e,N5=R(()=>{k5();P5();z$e=/^([0-9a-f]{32})$/i,$$e=/^[0-9a-f]{16}$/i});function W$e(t){return typeof t=="object"&&typeof t.spanId=="string"&&typeof t.traceId=="string"&&typeof t.traceFlags=="number"}var S$,L5,I$=R(()=>{Ok();_$();P5();N5();S$=Ag.getInstance(),L5=function(){function t(){}return t.prototype.startSpan=function(e,r,n){n===void 0&&(n=S$.active());var o=!!r?.root;if(o)return new Dg;var s=n&&D5(n);return W$e(s)&&Ru(s)?new Dg(s):new Dg},t.prototype.startActiveSpan=function(e,r,n,o){var s,a,c;if(!(arguments.length<2)){arguments.length===2?c=r:arguments.length===3?(s=r,c=n):(s=r,a=n,c=o);var u=a??S$.active(),l=this.startSpan(e,s,u),d=Uk(u,l);return S$.with(d,c,void 0,l)}},t}()});var K$e,O5,C$=R(()=>{I$();K$e=new L5,O5=function(){function t(e,r,n,o){this._provider=e,this.name=r,this.version=n,this.options=o}return t.prototype.startSpan=function(e,r,n){return this._getTracer().startSpan(e,r,n)},t.prototype.startActiveSpan=function(e,r,n,o){var s=this._getTracer();return Reflect.apply(s.startActiveSpan,s,arguments)},t.prototype._getTracer=function(){if(this._delegate)return this._delegate;var e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):K$e},t}()});var Ive,Cve=R(()=>{I$();Ive=function(){function t(){}return t.prototype.getTracer=function(e,r,n){return new L5},t}()});var Y$e,Bk,E$=R(()=>{C$();Cve();Y$e=new Ive,Bk=function(){function t(){}return t.prototype.getTracer=function(e,r,n){var o;return(o=this.getDelegateTracer(e,r,n))!==null&&o!==void 0?o:new O5(this,e,r,n)},t.prototype.getDelegate=function(){var e;return(e=this._delegate)!==null&&e!==void 0?e:Y$e},t.prototype.setDelegate=function(e){this._delegate=e},t.prototype.getDelegateTracer=function(e,r,n){var o;return(o=this._delegate)===null||o===void 0?void 0:o.getTracer(e,r,n)},t}()});var Fa,Eve=R(()=>{(function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(Fa||(Fa={}))});var kI,Tve=R(()=>{(function(t){t[t.INTERNAL=0]="INTERNAL",t[t.SERVER=1]="SERVER",t[t.CLIENT=2]="CLIENT",t[t.PRODUCER=3]="PRODUCER",t[t.CONSUMER=4]="CONSUMER"})(kI||(kI={}))});var PI,wve=R(()=>{(function(t){t[t.UNSET=0]="UNSET",t[t.OK=1]="OK",t[t.ERROR=2]="ERROR"})(PI||(PI={}))});function Rve(t){return J$e.test(t)}function kve(t){return Z$e.test(t)&&!eWe.test(t)}var T$,Q$e,X$e,J$e,Z$e,eWe,Pve=R(()=>{T$="[_0-9a-z-*/]",Q$e="[a-z]"+T$+"{0,255}",X$e="[a-z0-9]"+T$+"{0,240}@[a-z]"+T$+"{0,13}",J$e=new RegExp("^(?:"+Q$e+"|"+X$e+")$"),Z$e=/^[ -~]{0,255}[!-~]$/,eWe=/,|=/});var Ave,tWe,Dve,Nve,Lve,Ove=R(()=>{Pve();Ave=32,tWe=512,Dve=",",Nve="=",Lve=function(){function t(e){this._internalState=new Map,e&&this._parse(e)}return t.prototype.set=function(e,r){var n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,r),n},t.prototype.unset=function(e){var r=this._clone();return r._internalState.delete(e),r},t.prototype.get=function(e){return this._internalState.get(e)},t.prototype.serialize=function(){var e=this;return this._keys().reduce(function(r,n){return r.push(n+Nve+e.get(n)),r},[]).join(Dve)},t.prototype._parse=function(e){e.length>tWe||(this._internalState=e.split(Dve).reverse().reduce(function(r,n){var o=n.trim(),s=o.indexOf(Nve);if(s!==-1){var a=o.slice(0,s),c=o.slice(s+1,n.length);Rve(a)&&kve(c)&&r.set(a,c)}return r},new Map),this._internalState.size>Ave&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,Ave))))},t.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},t.prototype._clone=function(){var e=new t;return e._internalState=new Map(this._internalState),e},t}()});function Mve(t){return new Lve(t)}var Fve=R(()=>{Ove()});var ua,Uve=R(()=>{Ok();ua=Ag.getInstance()});var ht,Bve=R(()=>{Oy();ht=As.instance()});var rWe,qve,Hve=R(()=>{h$();rWe=function(){function t(){}return t.prototype.getMeter=function(e,r,n){return m$},t}(),qve=new rWe});var w$,jve,Vve=R(()=>{Hve();Ly();Oy();w$="metrics",jve=function(){function t(){}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalMeterProvider=function(e){return zd(w$,e,As.instance())},t.prototype.getMeterProvider=function(){return Rc(w$)||qve},t.prototype.getMeter=function(e,r,n){return this.getMeterProvider().getMeter(e,r,n)},t.prototype.disable=function(){$d(w$,As.instance())},t}()});var R$,Gve=R(()=>{Vve();R$=jve.getInstance()});var zve,$ve=R(()=>{zve=function(){function t(){}return t.prototype.inject=function(e,r){},t.prototype.extract=function(e,r){return e},t.prototype.fields=function(){return[]},t}()});function P$(t){return t.getValue(k$)||void 0}function Wve(){return P$(Ag.getInstance().active())}function Kve(t,e){return t.setValue(k$,e)}function Yve(t){return t.deleteValue(k$)}var k$,Qve=R(()=>{Ok();Lk();k$=Wd("OpenTelemetry Baggage Key")});var A$,nWe,Xve,Jve=R(()=>{Ly();$ve();g$();Qve();l$();Oy();A$="propagation",nWe=new zve,Xve=function(){function t(){this.createBaggage=pve,this.getBaggage=P$,this.getActiveBaggage=Wve,this.setBaggage=Kve,this.deleteBaggage=Yve}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalPropagator=function(e){return zd(A$,e,As.instance())},t.prototype.inject=function(e,r,n){return n===void 0&&(n=R5),this._getGlobalPropagator().inject(e,r,n)},t.prototype.extract=function(e,r,n){return n===void 0&&(n=w5),this._getGlobalPropagator().extract(e,r,n)},t.prototype.fields=function(){return this._getGlobalPropagator().fields()},t.prototype.disable=function(){$d(A$,As.instance())},t.prototype._getGlobalPropagator=function(){return Rc(A$)||nWe},t}()});var Hf,Zve=R(()=>{Jve();Hf=Xve.getInstance()});var D$,e0e,t0e=R(()=>{Ly();E$();N5();_$();Oy();D$="trace",e0e=function(){function t(){this._proxyTracerProvider=new Bk,this.wrapSpanContext=Sve,this.isSpanContextValid=Ru,this.deleteSpan=_ve,this.getSpan=A5,this.getActiveSpan=bve,this.getSpanContext=D5,this.setSpan=Uk,this.setSpanContext=xve}return t.getInstance=function(){return this._instance||(this._instance=new t),this._instance},t.prototype.setGlobalTracerProvider=function(e){var r=zd(D$,this._proxyTracerProvider,As.instance());return r&&this._proxyTracerProvider.setDelegate(e),r},t.prototype.getTracerProvider=function(){return Rc(D$)||this._proxyTracerProvider},t.prototype.getTracer=function(e,r){return this.getTracerProvider().getTracer(e,r)},t.prototype.disable=function(){$d(D$,As.instance()),this._proxyTracerProvider=new Bk},t}()});var So,r0e=R(()=>{t0e();So=e0e.getInstance()});var AI={};mn(AI,{DiagConsoleLogger:()=>fve,DiagLogLevel:()=>Tn,INVALID_SPANID:()=>Mk,INVALID_SPAN_CONTEXT:()=>RI,INVALID_TRACEID:()=>Fk,ProxyTracer:()=>O5,ProxyTracerProvider:()=>Bk,ROOT_CONTEXT:()=>E5,SamplingDecision:()=>Fa,SpanKind:()=>kI,SpanStatusCode:()=>PI,TraceFlags:()=>Ui,ValueType:()=>T5,baggageEntryMetadataFromString:()=>C5,context:()=>ua,createContextKey:()=>Wd,createNoopMeter:()=>hve,createTraceState:()=>Mve,default:()=>iWe,defaultTextMapGetter:()=>w5,defaultTextMapSetter:()=>R5,diag:()=>ht,isSpanContextValid:()=>Ru,isValidSpanId:()=>x$,isValidTraceId:()=>My,metrics:()=>R$,propagation:()=>Hf,trace:()=>So});var iWe,xr=R(()=>{l$();Lk();mve();I5();h$();gve();g$();C$();E$();Eve();Tve();wve();y$();Fve();N5();k5();Uve();Bve();Gve();Zve();r0e();iWe={context:ua,diag:ht,metrics:R$,propagation:Hf,trace:So}});function qk(t){return t.setValue(N$,!0)}function oWe(t){return t.deleteValue(N$)}function Fy(t){return t.getValue(N$)===!0}var N$,Hk=R(()=>{xr();N$=Wd("OpenTelemetry SDK Context Key SUPPRESS_TRACING")});var n0e,M5,DI,F5,i0e,o0e,s0e,L$=R(()=>{n0e="=",M5=";",DI=",",F5="baggage",i0e=180,o0e=4096,s0e=8192});var F$={};mn(F$,{getKeyPairs:()=>M$,parseKeyPairsIntoRecord:()=>aWe,parsePairKeyValue:()=>U5,serializeKeyPairs:()=>O$});function O$(t){return t.reduce(function(e,r){var n=""+e+(e!==""?DI:"")+r;return n.length>s0e?e:n},"")}function M$(t){return t.getAllEntries().map(function(e){var r=sWe(e,2),n=r[0],o=r[1],s=encodeURIComponent(n)+"="+encodeURIComponent(o.value);return o.metadata!==void 0&&(s+=M5+o.metadata.toString()),s})}function U5(t){var e=t.split(M5);if(!(e.length<=0)){var r=e.shift();if(r){var n=r.indexOf(n0e);if(!(n<=0)){var o=decodeURIComponent(r.substring(0,n).trim()),s=decodeURIComponent(r.substring(n+1).trim()),a;return e.length>0&&(a=C5(e.join(M5))),{key:o,value:s,metadata:a}}}}}function aWe(t){return typeof t!="string"||t.length===0?{}:t.split(DI).map(function(e){return U5(e)}).filter(function(e){return e!==void 0&&e.value.length>0}).reduce(function(e,r){return e[r.key]=r.value,e},{})}var sWe,U$=R(()=>{xr();L$();sWe=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}});var B$,a0e=R(()=>{xr();Hk();L$();U$();B$=function(){function t(){}return t.prototype.inject=function(e,r,n){var o=Hf.getBaggage(e);if(!(!o||Fy(e))){var s=M$(o).filter(function(c){return c.length<=o0e}).slice(0,i0e),a=O$(s);a.length>0&&n.set(r,F5,a)}},t.prototype.extract=function(e,r,n){var o=n.get(r,F5),s=Array.isArray(o)?o.join(DI):o;if(!s)return e;var a={};if(s.length===0)return e;var c=s.split(DI);return c.forEach(function(u){var l=U5(u);if(l){var d={value:l.value};l.metadata&&(d.metadata=l.metadata),a[l.key]=d}}),Object.entries(a).length===0?e:Hf.setBaggage(e,Hf.createBaggage(a))},t.prototype.fields=function(){return[F5]},t}()});var cWe,c0e=R(()=>{cWe=function(){function t(e,r){this._monotonicClock=r,this._epochMillis=e.now(),this._performanceMillis=r.now()}return t.prototype.now=function(){var e=this._monotonicClock.now()-this._performanceMillis;return this._epochMillis+e},t}()});function Uy(t){var e,r,n={};if(typeof t!="object"||t==null)return n;try{for(var o=u0e(Object.entries(t)),s=o.next();!s.done;s=o.next()){var a=uWe(s.value,2),c=a[0],u=a[1];if(!l0e(c)){ht.warn("Invalid attribute key: "+c);continue}if(!B5(u)){ht.warn("Invalid attribute value set for key: "+c);continue}Array.isArray(u)?n[c]=u.slice():n[c]=u}}catch(l){e={error:l}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return n}function l0e(t){return typeof t=="string"&&t.length>0}function B5(t){return t==null?!0:Array.isArray(t)?lWe(t):d0e(t)}function lWe(t){var e,r,n;try{for(var o=u0e(t),s=o.next();!s.done;s=o.next()){var a=s.value;if(a!=null){if(!n){if(d0e(a)){n=typeof a;continue}return!1}if(typeof a!==n)return!1}}}catch(c){e={error:c}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return!0}function d0e(t){switch(typeof t){case"number":case"boolean":case"string":return!0}return!1}var u0e,uWe,p0e=R(()=>{xr();u0e=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},uWe=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}});function q$(){return function(t){ht.error(dWe(t))}}function dWe(t){return typeof t=="string"?t:JSON.stringify(pWe(t))}function pWe(t){for(var e={},r=t;r!==null;)Object.getOwnPropertyNames(r).forEach(function(n){if(!e[n]){var o=r[n];o&&(e[n]=String(o))}}),r=Object.getPrototypeOf(r);return e}var H$=R(()=>{xr()});function fWe(t){f0e=t}function Ua(t){try{f0e(t)}catch{}}var f0e,j$=R(()=>{H$();f0e=q$()});var kc,V$=R(()=>{(function(t){t.AlwaysOff="always_off",t.AlwaysOn="always_on",t.ParentBasedAlwaysOff="parentbased_always_off",t.ParentBasedAlwaysOn="parentbased_always_on",t.ParentBasedTraceIdRatio="parentbased_traceidratio",t.TraceIdRatio="traceidratio"})(kc||(kc={}))});var m0e,h0e=R(()=>{m0e=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof global=="object"?global:{}});function gWe(t){return hWe.indexOf(t)>-1}function yWe(t){return vWe.indexOf(t)>-1}function _We(t){return bWe.indexOf(t)>-1}function xWe(t,e,r){if(!(typeof r[t]>"u")){var n=String(r[t]);e[t]=n.toLowerCase()==="true"}}function SWe(t,e,r,n,o){if(n===void 0&&(n=-1/0),o===void 0&&(o=1/0),typeof r[t]<"u"){var s=Number(r[t]);isNaN(s)||(s<n?e[t]=n:s>o?e[t]=o:e[t]=s)}}function IWe(t,e,r,n){n===void 0&&(n=mWe);var o=r[t];typeof o=="string"&&(e[t]=o.split(n).map(function(s){return s.trim()}))}function EWe(t,e,r){var n=r[t];if(typeof n=="string"){var o=CWe[n.toUpperCase()];o!=null&&(e[t]=o)}}function jk(t){var e={};for(var r in q5){var n=r;switch(n){case"OTEL_LOG_LEVEL":EWe(n,e,t);break;default:if(gWe(n))xWe(n,e,t);else if(yWe(n))SWe(n,e,t);else if(_We(n))IWe(n,e,t);else{var o=t[n];typeof o<"u"&&o!==null&&(e[n]=String(o))}}}return e}function G$(){return typeof process<"u"&&process&&process.env?jk(process.env):jk(m0e)}var mWe,hWe,vWe,bWe,NI,LI,g0e,v0e,q5,CWe,z$=R(()=>{xr();V$();h0e();mWe=",",hWe=["OTEL_SDK_DISABLED"];vWe=["OTEL_BSP_EXPORT_TIMEOUT","OTEL_BSP_MAX_EXPORT_BATCH_SIZE","OTEL_BSP_MAX_QUEUE_SIZE","OTEL_BSP_SCHEDULE_DELAY","OTEL_BLRP_EXPORT_TIMEOUT","OTEL_BLRP_MAX_EXPORT_BATCH_SIZE","OTEL_BLRP_MAX_QUEUE_SIZE","OTEL_BLRP_SCHEDULE_DELAY","OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT","OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT","OTEL_SPAN_EVENT_COUNT_LIMIT","OTEL_SPAN_LINK_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT","OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT","OTEL_EXPORTER_OTLP_TIMEOUT","OTEL_EXPORTER_OTLP_TRACES_TIMEOUT","OTEL_EXPORTER_OTLP_METRICS_TIMEOUT","OTEL_EXPORTER_OTLP_LOGS_TIMEOUT","OTEL_EXPORTER_JAEGER_AGENT_PORT"];bWe=["OTEL_NO_PATCH_MODULES","OTEL_PROPAGATORS"];NI=1/0,LI=128,g0e=128,v0e=128,q5={OTEL_SDK_DISABLED:!1,CONTAINER_NAME:"",ECS_CONTAINER_METADATA_URI_V4:"",ECS_CONTAINER_METADATA_URI:"",HOSTNAME:"",KUBERNETES_SERVICE_HOST:"",NAMESPACE:"",OTEL_BSP_EXPORT_TIMEOUT:3e4,OTEL_BSP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BSP_MAX_QUEUE_SIZE:2048,OTEL_BSP_SCHEDULE_DELAY:5e3,OTEL_BLRP_EXPORT_TIMEOUT:3e4,OTEL_BLRP_MAX_EXPORT_BATCH_SIZE:512,OTEL_BLRP_MAX_QUEUE_SIZE:2048,OTEL_BLRP_SCHEDULE_DELAY:5e3,OTEL_EXPORTER_JAEGER_AGENT_HOST:"",OTEL_EXPORTER_JAEGER_AGENT_PORT:6832,OTEL_EXPORTER_JAEGER_ENDPOINT:"",OTEL_EXPORTER_JAEGER_PASSWORD:"",OTEL_EXPORTER_JAEGER_USER:"",OTEL_EXPORTER_OTLP_ENDPOINT:"",OTEL_EXPORTER_OTLP_TRACES_ENDPOINT:"",OTEL_EXPORTER_OTLP_METRICS_ENDPOINT:"",OTEL_EXPORTER_OTLP_LOGS_ENDPOINT:"",OTEL_EXPORTER_OTLP_HEADERS:"",OTEL_EXPORTER_OTLP_TRACES_HEADERS:"",OTEL_EXPORTER_OTLP_METRICS_HEADERS:"",OTEL_EXPORTER_OTLP_LOGS_HEADERS:"",OTEL_EXPORTER_OTLP_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_TRACES_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_METRICS_TIMEOUT:1e4,OTEL_EXPORTER_OTLP_LOGS_TIMEOUT:1e4,OTEL_EXPORTER_ZIPKIN_ENDPOINT:"http://localhost:9411/api/v2/spans",OTEL_LOG_LEVEL:Tn.INFO,OTEL_NO_PATCH_MODULES:[],OTEL_PROPAGATORS:["tracecontext","baggage"],OTEL_RESOURCE_ATTRIBUTES:"",OTEL_SERVICE_NAME:"",OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT:NI,OTEL_ATTRIBUTE_COUNT_LIMIT:LI,OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT:NI,OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT:LI,OTEL_LOGRECORD_ATTRIBUTE_VALUE_LENGTH_LIMIT:NI,OTEL_LOGRECORD_ATTRIBUTE_COUNT_LIMIT:LI,OTEL_SPAN_EVENT_COUNT_LIMIT:128,OTEL_SPAN_LINK_COUNT_LIMIT:128,OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:g0e,OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:v0e,OTEL_TRACES_EXPORTER:"",OTEL_TRACES_SAMPLER:kc.ParentBasedAlwaysOn,OTEL_TRACES_SAMPLER_ARG:"",OTEL_LOGS_EXPORTER:"",OTEL_EXPORTER_OTLP_INSECURE:"",OTEL_EXPORTER_OTLP_TRACES_INSECURE:"",OTEL_EXPORTER_OTLP_METRICS_INSECURE:"",OTEL_EXPORTER_OTLP_LOGS_INSECURE:"",OTEL_EXPORTER_OTLP_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CERTIFICATE:"",OTEL_EXPORTER_OTLP_COMPRESSION:"",OTEL_EXPORTER_OTLP_TRACES_COMPRESSION:"",OTEL_EXPORTER_OTLP_METRICS_COMPRESSION:"",OTEL_EXPORTER_OTLP_LOGS_COMPRESSION:"",OTEL_EXPORTER_OTLP_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_KEY:"",OTEL_EXPORTER_OTLP_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_TRACES_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_METRICS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_LOGS_CLIENT_CERTIFICATE:"",OTEL_EXPORTER_OTLP_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_TRACES_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_LOGS_PROTOCOL:"http/protobuf",OTEL_EXPORTER_OTLP_METRICS_TEMPORALITY_PREFERENCE:"cumulative"};CWe={ALL:Tn.ALL,VERBOSE:Tn.VERBOSE,DEBUG:Tn.DEBUG,INFO:Tn.INFO,WARN:Tn.WARN,ERROR:Tn.ERROR,NONE:Tn.NONE}});function Io(){var t=jk(process.env);return Object.assign({HOSTNAME:y0e.hostname()},q5,t)}var y0e,b0e=R(()=>{y0e=z(require("os"));z$()});var TWe,_0e=R(()=>{TWe=typeof globalThis=="object"?globalThis:global});function x0e(t){return t>=48&&t<=57?t-48:t>=97&&t<=102?t-87:t-55}function kWe(t){var e;t.length===16?e=wWe:t.length===32?e=RWe:e=Buffer.alloc(t.length/2);for(var r=0,n=0;n<t.length;n+=2){var o=x0e(t.charCodeAt(n)),s=x0e(t.charCodeAt(n+1));e.writeUInt8(o<<4|s,r++)}return e.toString("base64")}var wWe,RWe,S0e=R(()=>{wWe=Buffer.alloc(8),RWe=Buffer.alloc(16)});function I0e(t){return function(){for(var r=0;r<t/4;r++)H5.writeUInt32BE(Math.random()*Math.pow(2,32)>>>0,r*4);for(var r=0;r<t&&!(H5[r]>0);r++)r===t-1&&(H5[t-1]=1);return H5.toString("hex",0,t)}}var PWe,C0e,AWe,H5,E0e=R(()=>{PWe=8,C0e=16,AWe=function(){function t(){this.generateTraceId=I0e(C0e),this.generateSpanId=I0e(PWe)}return t}(),H5=Buffer.allocUnsafe(C0e)});var T0e,jf,w0e=R(()=>{T0e=require("perf_hooks"),jf=T0e.performance});var $$,j5=R(()=>{$$="1.17.0"});var Vf,DWe,NWe,LWe,OWe,MWe,FWe,UWe,BWe,qWe,HWe,jWe,VWe,GWe,R0e=R(()=>{Vf={AWS_LAMBDA_INVOKED_ARN:"aws.lambda.invoked_arn",DB_SYSTEM:"db.system",DB_CONNECTION_STRING:"db.connection_string",DB_USER:"db.user",DB_JDBC_DRIVER_CLASSNAME:"db.jdbc.driver_classname",DB_NAME:"db.name",DB_STATEMENT:"db.statement",DB_OPERATION:"db.operation",DB_MSSQL_INSTANCE_NAME:"db.mssql.instance_name",DB_CASSANDRA_KEYSPACE:"db.cassandra.keyspace",DB_CASSANDRA_PAGE_SIZE:"db.cassandra.page_size",DB_CASSANDRA_CONSISTENCY_LEVEL:"db.cassandra.consistency_level",DB_CASSANDRA_TABLE:"db.cassandra.table",DB_CASSANDRA_IDEMPOTENCE:"db.cassandra.idempotence",DB_CASSANDRA_SPECULATIVE_EXECUTION_COUNT:"db.cassandra.speculative_execution_count",DB_CASSANDRA_COORDINATOR_ID:"db.cassandra.coordinator.id",DB_CASSANDRA_COORDINATOR_DC:"db.cassandra.coordinator.dc",DB_HBASE_NAMESPACE:"db.hbase.namespace",DB_REDIS_DATABASE_INDEX:"db.redis.database_index",DB_MONGODB_COLLECTION:"db.mongodb.collection",DB_SQL_TABLE:"db.sql.table",EXCEPTION_TYPE:"exception.type",EXCEPTION_MESSAGE:"exception.message",EXCEPTION_STACKTRACE:"exception.stacktrace",EXCEPTION_ESCAPED:"exception.escaped",FAAS_TRIGGER:"faas.trigger",FAAS_EXECUTION:"faas.execution",FAAS_DOCUMENT_COLLECTION:"faas.document.collection",FAAS_DOCUMENT_OPERATION:"faas.document.operation",FAAS_DOCUMENT_TIME:"faas.document.time",FAAS_DOCUMENT_NAME:"faas.document.name",FAAS_TIME:"faas.time",FAAS_CRON:"faas.cron",FAAS_COLDSTART:"faas.coldstart",FAAS_INVOKED_NAME:"faas.invoked_name",FAAS_INVOKED_PROVIDER:"faas.invoked_provider",FAAS_INVOKED_REGION:"faas.invoked_region",NET_TRANSPORT:"net.transport",NET_PEER_IP:"net.peer.ip",NET_PEER_PORT:"net.peer.port",NET_PEER_NAME:"net.peer.name",NET_HOST_IP:"net.host.ip",NET_HOST_PORT:"net.host.port",NET_HOST_NAME:"net.host.name",NET_HOST_CONNECTION_TYPE:"net.host.connection.type",NET_HOST_CONNECTION_SUBTYPE:"net.host.connection.subtype",NET_HOST_CARRIER_NAME:"net.host.carrier.name",NET_HOST_CARRIER_MCC:"net.host.carrier.mcc",NET_HOST_CARRIER_MNC:"net.host.carrier.mnc",NET_HOST_CARRIER_ICC:"net.host.carrier.icc",PEER_SERVICE:"peer.service",ENDUSER_ID:"enduser.id",ENDUSER_ROLE:"enduser.role",ENDUSER_SCOPE:"enduser.scope",THREAD_ID:"thread.id",THREAD_NAME:"thread.name",CODE_FUNCTION:"code.function",CODE_NAMESPACE:"code.namespace",CODE_FILEPATH:"code.filepath",CODE_LINENO:"code.lineno",HTTP_METHOD:"http.method",HTTP_URL:"http.url",HTTP_TARGET:"http.target",HTTP_HOST:"http.host",HTTP_SCHEME:"http.scheme",HTTP_STATUS_CODE:"http.status_code",HTTP_FLAVOR:"http.flavor",HTTP_USER_AGENT:"http.user_agent",HTTP_REQUEST_CONTENT_LENGTH:"http.request_content_length",HTTP_REQUEST_CONTENT_LENGTH_UNCOMPRESSED:"http.request_content_length_uncompressed",HTTP_RESPONSE_CONTENT_LENGTH:"http.response_content_length",HTTP_RESPONSE_CONTENT_LENGTH_UNCOMPRESSED:"http.response_content_length_uncompressed",HTTP_SERVER_NAME:"http.server_name",HTTP_ROUTE:"http.route",HTTP_CLIENT_IP:"http.client_ip",AWS_DYNAMODB_TABLE_NAMES:"aws.dynamodb.table_names",AWS_DYNAMODB_CONSUMED_CAPACITY:"aws.dynamodb.consumed_capacity",AWS_DYNAMODB_ITEM_COLLECTION_METRICS:"aws.dynamodb.item_collection_metrics",AWS_DYNAMODB_PROVISIONED_READ_CAPACITY:"aws.dynamodb.provisioned_read_capacity",AWS_DYNAMODB_PROVISIONED_WRITE_CAPACITY:"aws.dynamodb.provisioned_write_capacity",AWS_DYNAMODB_CONSISTENT_READ:"aws.dynamodb.consistent_read",AWS_DYNAMODB_PROJECTION:"aws.dynamodb.projection",AWS_DYNAMODB_LIMIT:"aws.dynamodb.limit",AWS_DYNAMODB_ATTRIBUTES_TO_GET:"aws.dynamodb.attributes_to_get",AWS_DYNAMODB_INDEX_NAME:"aws.dynamodb.index_name",AWS_DYNAMODB_SELECT:"aws.dynamodb.select",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEXES:"aws.dynamodb.global_secondary_indexes",AWS_DYNAMODB_LOCAL_SECONDARY_INDEXES:"aws.dynamodb.local_secondary_indexes",AWS_DYNAMODB_EXCLUSIVE_START_TABLE:"aws.dynamodb.exclusive_start_table",AWS_DYNAMODB_TABLE_COUNT:"aws.dynamodb.table_count",AWS_DYNAMODB_SCAN_FORWARD:"aws.dynamodb.scan_forward",AWS_DYNAMODB_SEGMENT:"aws.dynamodb.segment",AWS_DYNAMODB_TOTAL_SEGMENTS:"aws.dynamodb.total_segments",AWS_DYNAMODB_COUNT:"aws.dynamodb.count",AWS_DYNAMODB_SCANNED_COUNT:"aws.dynamodb.scanned_count",AWS_DYNAMODB_ATTRIBUTE_DEFINITIONS:"aws.dynamodb.attribute_definitions",AWS_DYNAMODB_GLOBAL_SECONDARY_INDEX_UPDATES:"aws.dynamodb.global_secondary_index_updates",MESSAGING_SYSTEM:"messaging.system",MESSAGING_DESTINATION:"messaging.destination",MESSAGING_DESTINATION_KIND:"messaging.destination_kind",MESSAGING_TEMP_DESTINATION:"messaging.temp_destination",MESSAGING_PROTOCOL:"messaging.protocol",MESSAGING_PROTOCOL_VERSION:"messaging.protocol_version",MESSAGING_URL:"messaging.url",MESSAGING_MESSAGE_ID:"messaging.message_id",MESSAGING_CONVERSATION_ID:"messaging.conversation_id",MESSAGING_MESSAGE_PAYLOAD_SIZE_BYTES:"messaging.message_payload_size_bytes",MESSAGING_MESSAGE_PAYLOAD_COMPRESSED_SIZE_BYTES:"messaging.message_payload_compressed_size_bytes",MESSAGING_OPERATION:"messaging.operation",MESSAGING_CONSUMER_ID:"messaging.consumer_id",MESSAGING_RABBITMQ_ROUTING_KEY:"messaging.rabbitmq.routing_key",MESSAGING_KAFKA_MESSAGE_KEY:"messaging.kafka.message_key",MESSAGING_KAFKA_CONSUMER_GROUP:"messaging.kafka.consumer_group",MESSAGING_KAFKA_CLIENT_ID:"messaging.kafka.client_id",MESSAGING_KAFKA_PARTITION:"messaging.kafka.partition",MESSAGING_KAFKA_TOMBSTONE:"messaging.kafka.tombstone",RPC_SYSTEM:"rpc.system",RPC_SERVICE:"rpc.service",RPC_METHOD:"rpc.method",RPC_GRPC_STATUS_CODE:"rpc.grpc.status_code",RPC_JSONRPC_VERSION:"rpc.jsonrpc.version",RPC_JSONRPC_REQUEST_ID:"rpc.jsonrpc.request_id",RPC_JSONRPC_ERROR_CODE:"rpc.jsonrpc.error_code",RPC_JSONRPC_ERROR_MESSAGE:"rpc.jsonrpc.error_message",MESSAGE_TYPE:"message.type",MESSAGE_ID:"message.id",MESSAGE_COMPRESSED_SIZE:"message.compressed_size",MESSAGE_UNCOMPRESSED_SIZE:"message.uncompressed_size"},DWe={OTHER_SQL:"other_sql",MSSQL:"mssql",MYSQL:"mysql",ORACLE:"oracle",DB2:"db2",POSTGRESQL:"postgresql",REDSHIFT:"redshift",HIVE:"hive",CLOUDSCAPE:"cloudscape",HSQLDB:"hsqldb",PROGRESS:"progress",MAXDB:"maxdb",HANADB:"hanadb",INGRES:"ingres",FIRSTSQL:"firstsql",EDB:"edb",CACHE:"cache",ADABAS:"adabas",FIREBIRD:"firebird",DERBY:"derby",FILEMAKER:"filemaker",INFORMIX:"informix",INSTANTDB:"instantdb",INTERBASE:"interbase",MARIADB:"mariadb",NETEZZA:"netezza",PERVASIVE:"pervasive",POINTBASE:"pointbase",SQLITE:"sqlite",SYBASE:"sybase",TERADATA:"teradata",VERTICA:"vertica",H2:"h2",COLDFUSION:"coldfusion",CASSANDRA:"cassandra",HBASE:"hbase",MONGODB:"mongodb",REDIS:"redis",COUCHBASE:"couchbase",COUCHDB:"couchdb",COSMOSDB:"cosmosdb",DYNAMODB:"dynamodb",NEO4J:"neo4j",GEODE:"geode",ELASTICSEARCH:"elasticsearch",MEMCACHED:"memcached",COCKROACHDB:"cockroachdb"},NWe={ALL:"all",EACH_QUORUM:"each_quorum",QUORUM:"quorum",LOCAL_QUORUM:"local_quorum",ONE:"one",TWO:"two",THREE:"three",LOCAL_ONE:"local_one",ANY:"any",SERIAL:"serial",LOCAL_SERIAL:"local_serial"},LWe={DATASOURCE:"datasource",HTTP:"http",PUBSUB:"pubsub",TIMER:"timer",OTHER:"other"},OWe={INSERT:"insert",EDIT:"edit",DELETE:"delete"},MWe={ALIBABA_CLOUD:"alibaba_cloud",AWS:"aws",AZURE:"azure",GCP:"gcp"},FWe={IP_TCP:"ip_tcp",IP_UDP:"ip_udp",IP:"ip",UNIX:"unix",PIPE:"pipe",INPROC:"inproc",OTHER:"other"},UWe={WIFI:"wifi",WIRED:"wired",CELL:"cell",UNAVAILABLE:"unavailable",UNKNOWN:"unknown"},BWe={GPRS:"gprs",EDGE:"edge",UMTS:"umts",CDMA:"cdma",EVDO_0:"evdo_0",EVDO_A:"evdo_a",CDMA2000_1XRTT:"cdma2000_1xrtt",HSDPA:"hsdpa",HSUPA:"hsupa",HSPA:"hspa",IDEN:"iden",EVDO_B:"evdo_b",LTE:"lte",EHRPD:"ehrpd",HSPAP:"hspap",GSM:"gsm",TD_SCDMA:"td_scdma",IWLAN:"iwlan",NR:"nr",NRNSA:"nrnsa",LTE_CA:"lte_ca"},qWe={HTTP_1_0:"1.0",HTTP_1_1:"1.1",HTTP_2_0:"2.0",SPDY:"SPDY",QUIC:"QUIC"},HWe={QUEUE:"queue",TOPIC:"topic"},jWe={RECEIVE:"receive",PROCESS:"process"},VWe={OK:0,CANCELLED:1,UNKNOWN:2,INVALID_ARGUMENT:3,DEADLINE_EXCEEDED:4,NOT_FOUND:5,ALREADY_EXISTS:6,PERMISSION_DENIED:7,RESOURCE_EXHAUSTED:8,FAILED_PRECONDITION:9,ABORTED:10,OUT_OF_RANGE:11,UNIMPLEMENTED:12,INTERNAL:13,UNAVAILABLE:14,DATA_LOSS:15,UNAUTHENTICATED:16},GWe={SENT:"SENT",RECEIVED:"RECEIVED"}});var k0e=R(()=>{R0e()});var ur,zWe,$We,WWe,KWe,YWe,W$,P0e=R(()=>{ur={CLOUD_PROVIDER:"cloud.provider",CLOUD_ACCOUNT_ID:"cloud.account.id",CLOUD_REGION:"cloud.region",CLOUD_AVAILABILITY_ZONE:"cloud.availability_zone",CLOUD_PLATFORM:"cloud.platform",AWS_ECS_CONTAINER_ARN:"aws.ecs.container.arn",AWS_ECS_CLUSTER_ARN:"aws.ecs.cluster.arn",AWS_ECS_LAUNCHTYPE:"aws.ecs.launchtype",AWS_ECS_TASK_ARN:"aws.ecs.task.arn",AWS_ECS_TASK_FAMILY:"aws.ecs.task.family",AWS_ECS_TASK_REVISION:"aws.ecs.task.revision",AWS_EKS_CLUSTER_ARN:"aws.eks.cluster.arn",AWS_LOG_GROUP_NAMES:"aws.log.group.names",AWS_LOG_GROUP_ARNS:"aws.log.group.arns",AWS_LOG_STREAM_NAMES:"aws.log.stream.names",AWS_LOG_STREAM_ARNS:"aws.log.stream.arns",CONTAINER_NAME:"container.name",CONTAINER_ID:"container.id",CONTAINER_RUNTIME:"container.runtime",CONTAINER_IMAGE_NAME:"container.image.name",CONTAINER_IMAGE_TAG:"container.image.tag",DEPLOYMENT_ENVIRONMENT:"deployment.environment",DEVICE_ID:"device.id",DEVICE_MODEL_IDENTIFIER:"device.model.identifier",DEVICE_MODEL_NAME:"device.model.name",FAAS_NAME:"faas.name",FAAS_ID:"faas.id",FAAS_VERSION:"faas.version",FAAS_INSTANCE:"faas.instance",FAAS_MAX_MEMORY:"faas.max_memory",HOST_ID:"host.id",HOST_NAME:"host.name",HOST_TYPE:"host.type",HOST_ARCH:"host.arch",HOST_IMAGE_NAME:"host.image.name",HOST_IMAGE_ID:"host.image.id",HOST_IMAGE_VERSION:"host.image.version",K8S_CLUSTER_NAME:"k8s.cluster.name",K8S_NODE_NAME:"k8s.node.name",K8S_NODE_UID:"k8s.node.uid",K8S_NAMESPACE_NAME:"k8s.namespace.name",K8S_POD_UID:"k8s.pod.uid",K8S_POD_NAME:"k8s.pod.name",K8S_CONTAINER_NAME:"k8s.container.name",K8S_REPLICASET_UID:"k8s.replicaset.uid",K8S_REPLICASET_NAME:"k8s.replicaset.name",K8S_DEPLOYMENT_UID:"k8s.deployment.uid",K8S_DEPLOYMENT_NAME:"k8s.deployment.name",K8S_STATEFULSET_UID:"k8s.statefulset.uid",K8S_STATEFULSET_NAME:"k8s.statefulset.name",K8S_DAEMONSET_UID:"k8s.daemonset.uid",K8S_DAEMONSET_NAME:"k8s.daemonset.name",K8S_JOB_UID:"k8s.job.uid",K8S_JOB_NAME:"k8s.job.name",K8S_CRONJOB_UID:"k8s.cronjob.uid",K8S_CRONJOB_NAME:"k8s.cronjob.name",OS_TYPE:"os.type",OS_DESCRIPTION:"os.description",OS_NAME:"os.name",OS_VERSION:"os.version",PROCESS_PID:"process.pid",PROCESS_EXECUTABLE_NAME:"process.executable.name",PROCESS_EXECUTABLE_PATH:"process.executable.path",PROCESS_COMMAND:"process.command",PROCESS_COMMAND_LINE:"process.command_line",PROCESS_COMMAND_ARGS:"process.command_args",PROCESS_OWNER:"process.owner",PROCESS_RUNTIME_NAME:"process.runtime.name",PROCESS_RUNTIME_VERSION:"process.runtime.version",PROCESS_RUNTIME_DESCRIPTION:"process.runtime.description",SERVICE_NAME:"service.name",SERVICE_NAMESPACE:"service.namespace",SERVICE_INSTANCE_ID:"service.instance.id",SERVICE_VERSION:"service.version",TELEMETRY_SDK_NAME:"telemetry.sdk.name",TELEMETRY_SDK_LANGUAGE:"telemetry.sdk.language",TELEMETRY_SDK_VERSION:"telemetry.sdk.version",TELEMETRY_AUTO_VERSION:"telemetry.auto.version",WEBENGINE_NAME:"webengine.name",WEBENGINE_VERSION:"webengine.version",WEBENGINE_DESCRIPTION:"webengine.description"},zWe={ALIBABA_CLOUD:"alibaba_cloud",AWS:"aws",AZURE:"azure",GCP:"gcp"},$We={ALIBABA_CLOUD_ECS:"alibaba_cloud_ecs",ALIBABA_CLOUD_FC:"alibaba_cloud_fc",AWS_EC2:"aws_ec2",AWS_ECS:"aws_ecs",AWS_EKS:"aws_eks",AWS_LAMBDA:"aws_lambda",AWS_ELASTIC_BEANSTALK:"aws_elastic_beanstalk",AZURE_VM:"azure_vm",AZURE_CONTAINER_INSTANCES:"azure_container_instances",AZURE_AKS:"azure_aks",AZURE_FUNCTIONS:"azure_functions",AZURE_APP_SERVICE:"azure_app_service",GCP_COMPUTE_ENGINE:"gcp_compute_engine",GCP_CLOUD_RUN:"gcp_cloud_run",GCP_KUBERNETES_ENGINE:"gcp_kubernetes_engine",GCP_CLOUD_FUNCTIONS:"gcp_cloud_functions",GCP_APP_ENGINE:"gcp_app_engine"},WWe={EC2:"ec2",FARGATE:"fargate"},KWe={AMD64:"amd64",ARM32:"arm32",ARM64:"arm64",IA64:"ia64",PPC32:"ppc32",PPC64:"ppc64",X86:"x86"},YWe={WINDOWS:"windows",LINUX:"linux",DARWIN:"darwin",FREEBSD:"freebsd",NETBSD:"netbsd",OPENBSD:"openbsd",DRAGONFLYBSD:"dragonflybsd",HPUX:"hpux",AIX:"aix",SOLARIS:"solaris",Z_OS:"z_os"},W$={CPP:"cpp",DOTNET:"dotnet",ERLANG:"erlang",GO:"go",JAVA:"java",NODEJS:"nodejs",PHP:"php",PYTHON:"python",RUBY:"ruby",WEBJS:"webjs"}});var A0e=R(()=>{P0e()});var K$={};mn(K$,{AwsEcsLaunchtypeValues:()=>WWe,CloudPlatformValues:()=>$We,CloudProviderValues:()=>zWe,DbCassandraConsistencyLevelValues:()=>NWe,DbSystemValues:()=>DWe,FaasDocumentOperationValues:()=>OWe,FaasInvokedProviderValues:()=>MWe,FaasTriggerValues:()=>LWe,HostArchValues:()=>KWe,HttpFlavorValues:()=>qWe,MessageTypeValues:()=>GWe,MessagingDestinationKindValues:()=>HWe,MessagingOperationValues:()=>jWe,NetHostConnectionSubtypeValues:()=>BWe,NetHostConnectionTypeValues:()=>UWe,NetTransportValues:()=>FWe,OsTypeValues:()=>YWe,RpcGrpcStatusCodeValues:()=>VWe,SemanticAttributes:()=>Vf,SemanticResourceAttributes:()=>ur,TelemetrySdkLanguageValues:()=>W$});var Pl=R(()=>{k0e();A0e()});var OI,Vk,D0e=R(()=>{j5();Pl();Vk=(OI={},OI[ur.TELEMETRY_SDK_NAME]="opentelemetry",OI[ur.PROCESS_RUNTIME_NAME]="node",OI[ur.TELEMETRY_SDK_LANGUAGE]=W$.NODEJS,OI[ur.TELEMETRY_SDK_VERSION]=$$,OI)});function Y$(t){t.unref()}var N0e=R(()=>{});var L0e=R(()=>{b0e();_0e();S0e();E0e();w0e();D0e();N0e()});var Q$=R(()=>{L0e()});function Kd(t){var e=t/1e3,r=Math.trunc(e),n=Math.round(t%1e3*XWe);return[r,n]}function Gk(){var t=jf.timeOrigin;if(typeof t!="number"){var e=jf;t=e.timing&&e.timing.fetchStart}return t}function G5(t){var e=Kd(Gk()),r=Kd(typeof t=="number"?t:jf.now());return W5(e,r)}function JWe(t){if(zk(t))return t;if(typeof t=="number")return t<Gk()?G5(t):Kd(t);if(t instanceof Date)return Kd(t.getTime());throw TypeError("Invalid input type")}function X$(t,e){var r=e[0]-t[0],n=e[1]-t[1];return n<0&&(r-=1,n+=V5),[r,n]}function ZWe(t){var e=O0e,r=""+"0".repeat(e)+t[1]+"Z",n=r.substr(r.length-e-1),o=new Date(t[0]*1e3).toISOString();return o.replace("000Z",n)}function eKe(t){return t[0]*V5+t[1]}function tKe(t){return t[0]*1e3+t[1]/1e6}function z5(t){return t[0]*1e6+t[1]/1e3}function zk(t){return Array.isArray(t)&&t.length===2&&typeof t[0]=="number"&&typeof t[1]=="number"}function $5(t){return zk(t)||typeof t=="number"||t instanceof Date}function W5(t,e){var r=[t[0]+e[0],t[1]+e[1]];return r[1]>=V5&&(r[1]-=V5,r[0]+=1),r}var O0e,QWe,XWe,V5,M0e=R(()=>{Q$();O0e=9,QWe=6,XWe=Math.pow(10,QWe),V5=Math.pow(10,O0e)});var F0e=R(()=>{});var ku,U0e=R(()=>{(function(t){t[t.SUCCESS=0]="SUCCESS",t[t.FAILED=1]="FAILED"})(ku||(ku={}))});var rKe,J$,B0e=R(()=>{xr();rKe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},J$=function(){function t(e){e===void 0&&(e={});var r;this._propagators=(r=e.propagators)!==null&&r!==void 0?r:[],this._fields=Array.from(new Set(this._propagators.map(function(n){return typeof n.fields=="function"?n.fields():[]}).reduce(function(n,o){return n.concat(o)},[])))}return t.prototype.inject=function(e,r,n){var o,s;try{for(var a=rKe(this._propagators),c=a.next();!c.done;c=a.next()){var u=c.value;try{u.inject(e,r,n)}catch(l){ht.warn("Failed to inject with "+u.constructor.name+". Err: "+l.message)}}}catch(l){o={error:l}}finally{try{c&&!c.done&&(s=a.return)&&s.call(a)}finally{if(o)throw o.error}}},t.prototype.extract=function(e,r,n){return this._propagators.reduce(function(o,s){try{return s.extract(o,r,n)}catch(a){ht.warn("Failed to inject with "+s.constructor.name+". Err: "+a.message)}return o},e)},t.prototype.fields=function(){return this._fields.slice()},t}()});function q0e(t){return oKe.test(t)}function H0e(t){return sKe.test(t)&&!aKe.test(t)}var Z$,nKe,iKe,oKe,sKe,aKe,j0e=R(()=>{Z$="[_0-9a-z-*/]",nKe="[a-z]"+Z$+"{0,255}",iKe="[a-z0-9]"+Z$+"{0,240}@[a-z]"+Z$+"{0,13}",oKe=new RegExp("^(?:"+nKe+"|"+iKe+")$"),sKe=/^[ -~]{0,255}[!-~]$/,aKe=/,|=/});var V0e,cKe,G0e,z0e,eW,tW=R(()=>{j0e();V0e=32,cKe=512,G0e=",",z0e="=",eW=function(){function t(e){this._internalState=new Map,e&&this._parse(e)}return t.prototype.set=function(e,r){var n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,r),n},t.prototype.unset=function(e){var r=this._clone();return r._internalState.delete(e),r},t.prototype.get=function(e){return this._internalState.get(e)},t.prototype.serialize=function(){var e=this;return this._keys().reduce(function(r,n){return r.push(n+z0e+e.get(n)),r},[]).join(G0e)},t.prototype._parse=function(e){e.length>cKe||(this._internalState=e.split(G0e).reverse().reduce(function(r,n){var o=n.trim(),s=o.indexOf(z0e);if(s!==-1){var a=o.slice(0,s),c=o.slice(s+1,n.length);q0e(a)&&H0e(c)&&r.set(a,c)}return r},new Map),this._internalState.size>V0e&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,V0e))))},t.prototype._keys=function(){return Array.from(this._internalState.keys()).reverse()},t.prototype._clone=function(){var e=new t;return e._internalState=new Map(this._internalState),e},t}()});function $0e(t){var e=mKe.exec(t);return!e||e[1]==="00"&&e[5]?null:{traceId:e[2],spanId:e[3],traceFlags:parseInt(e[4],16)}}var K5,Y5,uKe,lKe,dKe,pKe,fKe,mKe,rW,W0e=R(()=>{xr();Hk();tW();K5="traceparent",Y5="tracestate",uKe="00",lKe="(?!ff)[\\da-f]{2}",dKe="(?![0]{32})[\\da-f]{32}",pKe="(?![0]{16})[\\da-f]{16}",fKe="[\\da-f]{2}",mKe=new RegExp("^\\s?("+lKe+")-("+dKe+")-("+pKe+")-("+fKe+")(-.*)?\\s?$");rW=function(){function t(){}return t.prototype.inject=function(e,r,n){var o=So.getSpanContext(e);if(!(!o||Fy(e)||!Ru(o))){var s=uKe+"-"+o.traceId+"-"+o.spanId+"-0"+Number(o.traceFlags||Ui.NONE).toString(16);n.set(r,K5,s),o.traceState&&n.set(r,Y5,o.traceState.serialize())}},t.prototype.extract=function(e,r,n){var o=n.get(r,K5);if(!o)return e;var s=Array.isArray(o)?o[0]:o;if(typeof s!="string")return e;var a=$0e(s);if(!a)return e;a.isRemote=!0;var c=n.get(r,Y5);if(c){var u=Array.isArray(c)?c.join(","):c;a.traceState=new eW(typeof u=="string"?u:void 0)}return So.setSpanContext(e,a)},t.prototype.fields=function(){return[K5,Y5]},t}()});var K0e=R(()=>{});function hKe(t,e){return t.setValue(iW,e)}function gKe(t){return t.deleteValue(iW)}function vKe(t){return t.getValue(iW)}var iW,nW,Y0e=R(()=>{xr();iW=Wd("OpenTelemetry SDK Context Key RPC_METADATA");(function(t){t.HTTP="http"})(nW||(nW={}))});var Q5,oW=R(()=>{xr();Q5=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:Fa.NOT_RECORD}},t.prototype.toString=function(){return"AlwaysOffSampler"},t}()});var $k,sW=R(()=>{xr();$k=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:Fa.RECORD_AND_SAMPLED}},t.prototype.toString=function(){return"AlwaysOnSampler"},t}()});var yKe,Q0e=R(()=>{xr();j$();oW();sW();yKe=function(){function t(e){var r,n,o,s;this._root=e.root,this._root||(Ua(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new $k),this._remoteParentSampled=(r=e.remoteParentSampled)!==null&&r!==void 0?r:new $k,this._remoteParentNotSampled=(n=e.remoteParentNotSampled)!==null&&n!==void 0?n:new Q5,this._localParentSampled=(o=e.localParentSampled)!==null&&o!==void 0?o:new $k,this._localParentNotSampled=(s=e.localParentNotSampled)!==null&&s!==void 0?s:new Q5}return t.prototype.shouldSample=function(e,r,n,o,s,a){var c=So.getSpanContext(e);return!c||!Ru(c)?this._root.shouldSample(e,r,n,o,s,a):c.isRemote?c.traceFlags&Ui.SAMPLED?this._remoteParentSampled.shouldSample(e,r,n,o,s,a):this._remoteParentNotSampled.shouldSample(e,r,n,o,s,a):c.traceFlags&Ui.SAMPLED?this._localParentSampled.shouldSample(e,r,n,o,s,a):this._localParentNotSampled.shouldSample(e,r,n,o,s,a)},t.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},t}()});var bKe,X0e=R(()=>{xr();bKe=function(){function t(e){e===void 0&&(e=0),this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(this._ratio*4294967295)}return t.prototype.shouldSample=function(e,r){return{decision:My(r)&&this._accumulate(r)<this._upperBound?Fa.RECORD_AND_SAMPLED:Fa.NOT_RECORD}},t.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},t.prototype._normalize=function(e){return typeof e!="number"||isNaN(e)?0:e>=1?1:e<=0?0:e},t.prototype._accumulate=function(e){for(var r=0,n=0;n<e.length/8;n++){var o=n*8,s=parseInt(e.slice(o,o+8),16);r=(r^s)>>>0}return r},t}()});function TKe(t,e){return function(r){return t(e(r))}}function aW(t){if(!wKe(t)||RKe(t)!==_Ke)return!1;var e=EKe(t);if(e===null)return!0;var r=eye.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&J0e.call(r)===CKe}function wKe(t){return t!=null&&typeof t=="object"}function RKe(t){return t==null?t===void 0?SKe:xKe:By&&By in Object(t)?kKe(t):PKe(t)}function kKe(t){var e=eye.call(t,By),r=t[By],n=!1;try{t[By]=void 0,n=!0}catch{}var o=tye.call(t);return n&&(e?t[By]=r:delete t[By]),o}function PKe(t){return tye.call(t)}var _Ke,xKe,SKe,IKe,J0e,CKe,EKe,Z0e,eye,By,tye,rye=R(()=>{_Ke="[object Object]",xKe="[object Null]",SKe="[object Undefined]",IKe=Function.prototype,J0e=IKe.toString,CKe=J0e.call(Object),EKe=TKe(Object.getPrototypeOf,Object),Z0e=Object.prototype,eye=Z0e.hasOwnProperty,By=Symbol?Symbol.toStringTag:void 0,tye=Z0e.toString});function uW(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=t.shift(),n=new WeakMap;t.length>0;)r=iye(r,t.shift(),0,n);return r}function cW(t){return J5(t)?t.slice():t}function iye(t,e,r,n){r===void 0&&(r=0);var o;if(!(r>AKe)){if(r++,X5(t)||X5(e)||oye(e))o=cW(e);else if(J5(t)){if(o=t.slice(),J5(e))for(var s=0,a=e.length;s<a;s++)o.push(cW(e[s]));else if(Wk(e))for(var c=Object.keys(e),s=0,a=c.length;s<a;s++){var u=c[s];o[u]=cW(e[u])}}else if(Wk(t))if(Wk(e)){if(!DKe(t,e))return e;o=Object.assign({},t);for(var c=Object.keys(e),s=0,a=c.length;s<a;s++){var u=c[s],l=e[u];if(X5(l))typeof l>"u"?delete o[u]:o[u]=l;else{var d=o[u],p=l;if(nye(t,u,n)||nye(e,u,n))delete o[u];else{if(Wk(d)&&Wk(p)){var f=n.get(d)||[],m=n.get(p)||[];f.push({obj:t,key:u}),m.push({obj:e,key:u}),n.set(d,f),n.set(p,m)}o[u]=iye(o[u],l,r,n)}}}}else o=e;return o}}function nye(t,e,r){for(var n=r.get(t[e])||[],o=0,s=n.length;o<s;o++){var a=n[o];if(a.key===e&&a.obj===t)return!0}return!1}function J5(t){return Array.isArray(t)}function oye(t){return typeof t=="function"}function Wk(t){return!X5(t)&&!J5(t)&&!oye(t)&&typeof t=="object"}function X5(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t>"u"||t instanceof Date||t instanceof RegExp||t===null}function DKe(t,e){return!(!aW(t)||!aW(e))}var AKe,sye=R(()=>{rye();AKe=20});function LKe(t,e){var r,n=new Promise(function(s,a){r=setTimeout(function(){a(new aye("Operation timed out."))},e)});return Promise.race([t,n]).then(function(o){return clearTimeout(r),o},function(o){throw clearTimeout(r),o})}var NKe,aye,cye=R(()=>{NKe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),aye=function(t){NKe(e,t);function e(r){var n=t.call(this,r)||this;return Object.setPrototypeOf(n,e.prototype),n}return e}(Error)});function uye(t,e){return typeof e=="string"?t===e:!!t.match(e)}function MKe(t,e){var r,n;if(!e)return!1;try{for(var o=OKe(e),s=o.next();!s.done;s=o.next()){var a=s.value;if(uye(t,a))return!0}}catch(c){r={error:c}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return!1}var OKe,lye=R(()=>{OKe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}});function FKe(t){return typeof t=="function"&&typeof t.__original=="function"&&typeof t.__unwrap=="function"&&t.__wrapped===!0}var dye=R(()=>{});var pye,fye=R(()=>{pye=function(){function t(){var e=this;this._promise=new Promise(function(r,n){e._resolve=r,e._reject=n})}return Object.defineProperty(t.prototype,"promise",{get:function(){return this._promise},enumerable:!1,configurable:!0}),t.prototype.resolve=function(e){this._resolve(e)},t.prototype.reject=function(e){this._reject(e)},t}()});var UKe,BKe,Kk,mye=R(()=>{fye();UKe=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},BKe=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},Kk=function(){function t(e,r){this._callback=e,this._that=r,this._isCalled=!1,this._deferred=new pye}return Object.defineProperty(t.prototype,"isCalled",{get:function(){return this._isCalled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"promise",{get:function(){return this._deferred.promise},enumerable:!1,configurable:!0}),t.prototype.call=function(){for(var e,r=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(!this._isCalled){this._isCalled=!0;try{Promise.resolve((e=this._callback).call.apply(e,BKe([this._that],UKe(n),!1))).then(function(s){return r._deferred.resolve(s)},function(s){return r._deferred.reject(s)})}catch(s){this._deferred.reject(s)}}return this._deferred.promise},t}()});function hye(t,e){return new Promise(function(r){ua.with(qk(ua.active()),function(){t.export(e,function(n){r(n)})})})}var gye=R(()=>{xr();Hk()});var vye={};mn(vye,{AlwaysOffSampler:()=>Q5,AlwaysOnSampler:()=>$k,AnchoredClock:()=>cWe,BindOnceFuture:()=>Kk,CompositePropagator:()=>J$,DEFAULT_ATTRIBUTE_COUNT_LIMIT:()=>LI,DEFAULT_ATTRIBUTE_VALUE_LENGTH_LIMIT:()=>NI,DEFAULT_ENVIRONMENT:()=>q5,DEFAULT_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT:()=>g0e,DEFAULT_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT:()=>v0e,ExportResultCode:()=>ku,ParentBasedSampler:()=>yKe,RPCType:()=>nW,RandomIdGenerator:()=>AWe,SDK_INFO:()=>Vk,TRACE_PARENT_HEADER:()=>K5,TRACE_STATE_HEADER:()=>Y5,TimeoutError:()=>aye,TraceIdRatioBasedSampler:()=>bKe,TraceState:()=>eW,TracesSamplerValues:()=>kc,VERSION:()=>$$,W3CBaggagePropagator:()=>B$,W3CTraceContextPropagator:()=>rW,_globalThis:()=>TWe,addHrTimes:()=>W5,baggageUtils:()=>F$,callWithTimeout:()=>LKe,deleteRPCMetadata:()=>gKe,getEnv:()=>Io,getEnvWithoutDefaults:()=>G$,getRPCMetadata:()=>vKe,getTimeOrigin:()=>Gk,globalErrorHandler:()=>Ua,hexToBase64:()=>kWe,hrTime:()=>G5,hrTimeDuration:()=>X$,hrTimeToMicroseconds:()=>z5,hrTimeToMilliseconds:()=>tKe,hrTimeToNanoseconds:()=>eKe,hrTimeToTimeStamp:()=>ZWe,internal:()=>lW,isAttributeKey:()=>l0e,isAttributeValue:()=>B5,isTimeInput:()=>$5,isTimeInputHrTime:()=>zk,isTracingSuppressed:()=>Fy,isUrlIgnored:()=>MKe,isWrapped:()=>FKe,loggingErrorHandler:()=>q$,merge:()=>uW,millisToHrTime:()=>Kd,otperformance:()=>jf,parseEnvironment:()=>jk,parseTraceParent:()=>$0e,sanitizeAttributes:()=>Uy,setGlobalErrorHandler:()=>fWe,setRPCMetadata:()=>hKe,suppressTracing:()=>qk,timeInputToHrTime:()=>JWe,unrefTimer:()=>Y$,unsuppressTracing:()=>oWe,urlMatches:()=>uye});var lW,la=R(()=>{a0e();c0e();p0e();j$();H$();M0e();F0e();U0e();j5();U$();Q$();B0e();W0e();K0e();Y0e();oW();sW();Q0e();X0e();Hk();tW();z$();sye();V$();cye();lye();dye();mye();j5();gye();lW={_export:hye}});var yye,bye=R(()=>{yye="exception"});var qKe,HKe,dW,pW=R(()=>{xr();la();Pl();bye();qKe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},HKe=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},dW=function(){function t(e,r,n,o,s,a,c,u,l){c===void 0&&(c=[]),this.attributes={},this.links=[],this.events=[],this._droppedAttributesCount=0,this._droppedEventsCount=0,this._droppedLinksCount=0,this.status={code:PI.UNSET},this.endTime=[0,0],this._ended=!1,this._duration=[-1,-1],this.name=n,this._spanContext=o,this.parentSpanId=a,this.kind=s,this.links=c;var d=Date.now();this._performanceStartTime=jf.now(),this._performanceOffset=d-(this._performanceStartTime+Gk()),this._startTimeProvided=u!=null,this.startTime=this._getTime(u??d),this.resource=e.resource,this.instrumentationLibrary=e.instrumentationLibrary,this._spanLimits=e.getSpanLimits(),this._spanProcessor=e.getActiveSpanProcessor(),this._spanProcessor.onStart(this,r),this._attributeValueLengthLimit=this._spanLimits.attributeValueLengthLimit||0}return t.prototype.spanContext=function(){return this._spanContext},t.prototype.setAttribute=function(e,r){return r==null||this._isSpanEnded()?this:e.length===0?(ht.warn("Invalid attribute key: "+e),this):B5(r)?Object.keys(this.attributes).length>=this._spanLimits.attributeCountLimit&&!Object.prototype.hasOwnProperty.call(this.attributes,e)?(this._droppedAttributesCount++,this):(this.attributes[e]=this._truncateToSize(r),this):(ht.warn("Invalid attribute value set for key: "+e),this)},t.prototype.setAttributes=function(e){var r,n;try{for(var o=qKe(Object.entries(e)),s=o.next();!s.done;s=o.next()){var a=HKe(s.value,2),c=a[0],u=a[1];this.setAttribute(c,u)}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return this},t.prototype.addEvent=function(e,r,n){if(this._isSpanEnded())return this;if(this._spanLimits.eventCountLimit===0)return ht.warn("No events allowed."),this._droppedEventsCount++,this;this.events.length>=this._spanLimits.eventCountLimit&&(ht.warn("Dropping extra events."),this.events.shift(),this._droppedEventsCount++),$5(r)&&($5(n)||(n=r),r=void 0);var o=Uy(r);return this.events.push({name:e,attributes:o,time:this._getTime(n),droppedAttributesCount:0}),this},t.prototype.setStatus=function(e){return this._isSpanEnded()?this:(this.status=e,this)},t.prototype.updateName=function(e){return this._isSpanEnded()?this:(this.name=e,this)},t.prototype.end=function(e){if(this._isSpanEnded()){ht.error(this.name+" "+this._spanContext.traceId+"-"+this._spanContext.spanId+" - You can only call end() on a span once.");return}this._ended=!0,this.endTime=this._getTime(e),this._duration=X$(this.startTime,this.endTime),this._duration[0]<0&&(ht.warn("Inconsistent start and end time, startTime > endTime. Setting span duration to 0ms.",this.startTime,this.endTime),this.endTime=this.startTime.slice(),this._duration=[0,0]),this._spanProcessor.onEnd(this)},t.prototype._getTime=function(e){if(typeof e=="number"&&e<jf.now())return G5(e+this._performanceOffset);if(typeof e=="number")return Kd(e);if(e instanceof Date)return Kd(e.getTime());if(zk(e))return e;if(this._startTimeProvided)return Kd(Date.now());var r=jf.now()-this._performanceStartTime;return W5(this.startTime,Kd(r))},t.prototype.isRecording=function(){return this._ended===!1},t.prototype.recordException=function(e,r){var n={};typeof e=="string"?n[Vf.EXCEPTION_MESSAGE]=e:e&&(e.code?n[Vf.EXCEPTION_TYPE]=e.code.toString():e.name&&(n[Vf.EXCEPTION_TYPE]=e.name),e.message&&(n[Vf.EXCEPTION_MESSAGE]=e.message),e.stack&&(n[Vf.EXCEPTION_STACKTRACE]=e.stack)),n[Vf.EXCEPTION_TYPE]||n[Vf.EXCEPTION_MESSAGE]?this.addEvent(yye,n,r):ht.warn("Failed to record an exception "+e)},Object.defineProperty(t.prototype,"duration",{get:function(){return this._duration},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ended",{get:function(){return this._ended},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"droppedAttributesCount",{get:function(){return this._droppedAttributesCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"droppedEventsCount",{get:function(){return this._droppedEventsCount},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"droppedLinksCount",{get:function(){return this._droppedLinksCount},enumerable:!1,configurable:!0}),t.prototype._isSpanEnded=function(){return this._ended&&ht.warn("Can not execute the operation on ended Span {traceId: "+this._spanContext.traceId+", spanId: "+this._spanContext.spanId+"}"),this._ended},t.prototype._truncateToLimitUtil=function(e,r){return e.length<=r?e:e.substr(0,r)},t.prototype._truncateToSize=function(e){var r=this,n=this._attributeValueLengthLimit;return n<=0?(ht.warn("Attribute value limit must be positive, got "+n),e):typeof e=="string"?this._truncateToLimitUtil(e,n):Array.isArray(e)?e.map(function(o){return typeof o=="string"?r._truncateToLimitUtil(o,n):o}):e},t}()});var Yd,Yk=R(()=>{(function(t){t[t.NOT_RECORD=0]="NOT_RECORD",t[t.RECORD=1]="RECORD",t[t.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"})(Yd||(Yd={}))});var qy,Z5=R(()=>{Yk();qy=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:Yd.NOT_RECORD}},t.prototype.toString=function(){return"AlwaysOffSampler"},t}()});var Gf,e6=R(()=>{Yk();Gf=function(){function t(){}return t.prototype.shouldSample=function(){return{decision:Yd.RECORD_AND_SAMPLED}},t.prototype.toString=function(){return"AlwaysOnSampler"},t}()});var Qk,fW=R(()=>{xr();la();Z5();e6();Qk=function(){function t(e){var r,n,o,s;this._root=e.root,this._root||(Ua(new Error("ParentBasedSampler must have a root sampler configured")),this._root=new Gf),this._remoteParentSampled=(r=e.remoteParentSampled)!==null&&r!==void 0?r:new Gf,this._remoteParentNotSampled=(n=e.remoteParentNotSampled)!==null&&n!==void 0?n:new qy,this._localParentSampled=(o=e.localParentSampled)!==null&&o!==void 0?o:new Gf,this._localParentNotSampled=(s=e.localParentNotSampled)!==null&&s!==void 0?s:new qy}return t.prototype.shouldSample=function(e,r,n,o,s,a){var c=So.getSpanContext(e);return!c||!Ru(c)?this._root.shouldSample(e,r,n,o,s,a):c.isRemote?c.traceFlags&Ui.SAMPLED?this._remoteParentSampled.shouldSample(e,r,n,o,s,a):this._remoteParentNotSampled.shouldSample(e,r,n,o,s,a):c.traceFlags&Ui.SAMPLED?this._localParentSampled.shouldSample(e,r,n,o,s,a):this._localParentNotSampled.shouldSample(e,r,n,o,s,a)},t.prototype.toString=function(){return"ParentBased{root="+this._root.toString()+", remoteParentSampled="+this._remoteParentSampled.toString()+", remoteParentNotSampled="+this._remoteParentNotSampled.toString()+", localParentSampled="+this._localParentSampled.toString()+", localParentNotSampled="+this._localParentNotSampled.toString()+"}"},t}()});var t6,mW=R(()=>{xr();Yk();t6=function(){function t(e){e===void 0&&(e=0),this._ratio=e,this._ratio=this._normalize(e),this._upperBound=Math.floor(this._ratio*4294967295)}return t.prototype.shouldSample=function(e,r){return{decision:My(r)&&this._accumulate(r)<this._upperBound?Yd.RECORD_AND_SAMPLED:Yd.NOT_RECORD}},t.prototype.toString=function(){return"TraceIdRatioBased{"+this._ratio+"}"},t.prototype._normalize=function(e){return typeof e!="number"||isNaN(e)?0:e>=1?1:e<=0?0:e},t.prototype._accumulate=function(e){for(var r=0,n=0;n<e.length/8;n++){var o=n*8,s=parseInt(e.slice(o,o+8),16);r=(r^s)>>>0}return r},t}()});function r6(){return{sampler:hW(jKe),forceFlushTimeoutMillis:3e4,generalLimits:{attributeValueLengthLimit:Io().OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:Io().OTEL_ATTRIBUTE_COUNT_LIMIT},spanLimits:{attributeValueLengthLimit:Io().OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT,attributeCountLimit:Io().OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT,linkCountLimit:Io().OTEL_SPAN_LINK_COUNT_LIMIT,eventCountLimit:Io().OTEL_SPAN_EVENT_COUNT_LIMIT,attributePerEventCountLimit:Io().OTEL_SPAN_ATTRIBUTE_PER_EVENT_COUNT_LIMIT,attributePerLinkCountLimit:Io().OTEL_SPAN_ATTRIBUTE_PER_LINK_COUNT_LIMIT}}}function hW(t){switch(t===void 0&&(t=Io()),t.OTEL_TRACES_SAMPLER){case kc.AlwaysOn:return new Gf;case kc.AlwaysOff:return new qy;case kc.ParentBasedAlwaysOn:return new Qk({root:new Gf});case kc.ParentBasedAlwaysOff:return new Qk({root:new qy});case kc.TraceIdRatio:return new t6(_ye(t));case kc.ParentBasedTraceIdRatio:return new Qk({root:new t6(_ye(t))});default:return ht.error('OTEL_TRACES_SAMPLER value "'+t.OTEL_TRACES_SAMPLER+" invalid, defaulting to "+VKe+'".'),new Gf}}function _ye(t){if(t.OTEL_TRACES_SAMPLER_ARG===void 0||t.OTEL_TRACES_SAMPLER_ARG==="")return ht.error("OTEL_TRACES_SAMPLER_ARG is blank, defaulting to "+MI+"."),MI;var e=Number(t.OTEL_TRACES_SAMPLER_ARG);return isNaN(e)?(ht.error("OTEL_TRACES_SAMPLER_ARG="+t.OTEL_TRACES_SAMPLER_ARG+" was given, but it is invalid, defaulting to "+MI+"."),MI):e<0||e>1?(ht.error("OTEL_TRACES_SAMPLER_ARG="+t.OTEL_TRACES_SAMPLER_ARG+" was given, but it is out of range ([0..1]), defaulting to "+MI+"."),MI):e}var jKe,VKe,MI,gW=R(()=>{xr();la();Z5();e6();fW();mW();jKe=Io(),VKe=kc.AlwaysOn,MI=1});function xye(t){var e={sampler:hW()},r=r6(),n=Object.assign({},r,e,t);return n.generalLimits=Object.assign({},r.generalLimits,t.generalLimits||{}),n.spanLimits=Object.assign({},r.spanLimits,t.spanLimits||{}),n}function Sye(t){var e,r,n,o,s,a,c,u,l,d,p,f,m=Object.assign({},t.spanLimits),h=G$();return m.attributeCountLimit=(a=(s=(o=(r=(e=t.spanLimits)===null||e===void 0?void 0:e.attributeCountLimit)!==null&&r!==void 0?r:(n=t.generalLimits)===null||n===void 0?void 0:n.attributeCountLimit)!==null&&o!==void 0?o:h.OTEL_SPAN_ATTRIBUTE_COUNT_LIMIT)!==null&&s!==void 0?s:h.OTEL_ATTRIBUTE_COUNT_LIMIT)!==null&&a!==void 0?a:LI,m.attributeValueLengthLimit=(f=(p=(d=(u=(c=t.spanLimits)===null||c===void 0?void 0:c.attributeValueLengthLimit)!==null&&u!==void 0?u:(l=t.generalLimits)===null||l===void 0?void 0:l.attributeValueLengthLimit)!==null&&d!==void 0?d:h.OTEL_SPAN_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&p!==void 0?p:h.OTEL_ATTRIBUTE_VALUE_LENGTH_LIMIT)!==null&&f!==void 0?f:NI,Object.assign({},t,{spanLimits:m})}var vW=R(()=>{gW();la()});var Iye,Cye=R(()=>{xr();la();Iye=function(){function t(e,r){this._exporter=e,this._finishedSpans=[],this._droppedSpansCount=0;var n=Io();this._maxExportBatchSize=typeof r?.maxExportBatchSize=="number"?r.maxExportBatchSize:n.OTEL_BSP_MAX_EXPORT_BATCH_SIZE,this._maxQueueSize=typeof r?.maxQueueSize=="number"?r.maxQueueSize:n.OTEL_BSP_MAX_QUEUE_SIZE,this._scheduledDelayMillis=typeof r?.scheduledDelayMillis=="number"?r.scheduledDelayMillis:n.OTEL_BSP_SCHEDULE_DELAY,this._exportTimeoutMillis=typeof r?.exportTimeoutMillis=="number"?r.exportTimeoutMillis:n.OTEL_BSP_EXPORT_TIMEOUT,this._shutdownOnce=new Kk(this._shutdown,this),this._maxExportBatchSize>this._maxQueueSize&&(ht.warn("BatchSpanProcessor: maxExportBatchSize must be smaller or equal to maxQueueSize, setting maxExportBatchSize to match maxQueueSize"),this._maxExportBatchSize=this._maxQueueSize)}return t.prototype.forceFlush=function(){return this._shutdownOnce.isCalled?this._shutdownOnce.promise:this._flushAll()},t.prototype.onStart=function(e,r){},t.prototype.onEnd=function(e){this._shutdownOnce.isCalled||e.spanContext().traceFlags&Ui.SAMPLED&&this._addToBuffer(e)},t.prototype.shutdown=function(){return this._shutdownOnce.call()},t.prototype._shutdown=function(){var e=this;return Promise.resolve().then(function(){return e.onShutdown()}).then(function(){return e._flushAll()}).then(function(){return e._exporter.shutdown()})},t.prototype._addToBuffer=function(e){if(this._finishedSpans.length>=this._maxQueueSize){this._droppedSpansCount===0&&ht.debug("maxQueueSize reached, dropping spans"),this._droppedSpansCount++;return}this._droppedSpansCount>0&&(ht.warn("Dropped "+this._droppedSpansCount+" spans because maxQueueSize reached"),this._droppedSpansCount=0),this._finishedSpans.push(e),this._maybeStartTimer()},t.prototype._flushAll=function(){var e=this;return new Promise(function(r,n){for(var o=[],s=Math.ceil(e._finishedSpans.length/e._maxExportBatchSize),a=0,c=s;a<c;a++)o.push(e._flushOneBatch());Promise.all(o).then(function(){r()}).catch(n)})},t.prototype._flushOneBatch=function(){var e=this;return this._clearTimer(),this._finishedSpans.length===0?Promise.resolve():new Promise(function(r,n){var o=setTimeout(function(){n(new Error("Timeout"))},e._exportTimeoutMillis);ua.with(qk(ua.active()),function(){var s=e._finishedSpans.splice(0,e._maxExportBatchSize),a=function(){return e._exporter.export(s,function(u){var l;clearTimeout(o),u.code===ku.SUCCESS?r():n((l=u.error)!==null&&l!==void 0?l:new Error("BatchSpanProcessor: span export failed"))})},c=s.map(function(u){return u.resource}).filter(function(u){return u.asyncAttributesPending});c.length===0?a():Promise.all(c.map(function(u){var l;return(l=u.waitForAsyncAttributes)===null||l===void 0?void 0:l.call(u)})).then(a,function(u){Ua(u),n(u)})})})},t.prototype._maybeStartTimer=function(){var e=this;this._timer===void 0&&(this._timer=setTimeout(function(){e._flushOneBatch().then(function(){e._finishedSpans.length>0&&(e._clearTimer(),e._maybeStartTimer())}).catch(function(r){Ua(r)})},this._scheduledDelayMillis),Y$(this._timer))},t.prototype._clearTimer=function(){this._timer!==void 0&&(clearTimeout(this._timer),this._timer=void 0)},t}()});var GKe,yW,Eye=R(()=>{Cye();GKe=function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),yW=function(t){GKe(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.onShutdown=function(){},e}(Iye)});function Tye(t){return function(){for(var r=0;r<t/4;r++)n6.writeUInt32BE(Math.random()*Math.pow(2,32)>>>0,r*4);for(var r=0;r<t&&!(n6[r]>0);r++)r===t-1&&(n6[t-1]=1);return n6.toString("hex",0,t)}}var zKe,wye,bW,n6,Rye=R(()=>{zKe=8,wye=16,bW=function(){function t(){this.generateTraceId=Tye(wye),this.generateSpanId=Tye(zKe)}return t}(),n6=Buffer.allocUnsafe(wye)});var kye=R(()=>{Eye();Rye()});var i6=R(()=>{kye()});var _W,Pye=R(()=>{xr();la();pW();vW();i6();_W=function(){function t(e,r,n){this._tracerProvider=n;var o=xye(r);this._sampler=o.sampler,this._generalLimits=o.generalLimits,this._spanLimits=o.spanLimits,this._idGenerator=r.idGenerator||new bW,this.resource=n.resource,this.instrumentationLibrary=e}return t.prototype.startSpan=function(e,r,n){var o,s,a;r===void 0&&(r={}),n===void 0&&(n=ua.active()),r.root&&(n=So.deleteSpan(n));var c=So.getSpan(n);if(Fy(n)){ht.debug("Instrumentation suppressed, returning Noop Span");var u=So.wrapSpanContext(RI);return u}var l=c?.spanContext(),d=this._idGenerator.generateSpanId(),p,f,m;!l||!So.isSpanContextValid(l)?p=this._idGenerator.generateTraceId():(p=l.traceId,f=l.traceState,m=l.spanId);var h=(o=r.kind)!==null&&o!==void 0?o:kI.INTERNAL,g=((s=r.links)!==null&&s!==void 0?s:[]).map(function(T){return{context:T.context,attributes:Uy(T.attributes)}}),v=Uy(r.attributes),y=this._sampler.shouldSample(n,p,e,h,v,g);f=(a=y.traceState)!==null&&a!==void 0?a:f;var b=y.decision===Fa.RECORD_AND_SAMPLED?Ui.SAMPLED:Ui.NONE,_={traceId:p,spanId:d,traceFlags:b,traceState:f};if(y.decision===Fa.NOT_RECORD){ht.debug("Recording is off, propagating context in a non-recording span");var u=So.wrapSpanContext(_);return u}var S=new dW(this,n,e,_,h,m,g,r.startTime),I=Uy(Object.assign(v,y.attributes));return S.setAttributes(I),S},t.prototype.startActiveSpan=function(e,r,n,o){var s,a,c;if(!(arguments.length<2)){arguments.length===2?c=r:arguments.length===3?(s=r,c=n):(s=r,a=n,c=o);var u=a??ua.active(),l=this.startSpan(e,s,u),d=So.setSpan(u,l);return ua.with(d,c,void 0,l)}},t.prototype.getGeneralLimits=function(){return this._generalLimits},t.prototype.getSpanLimits=function(){return this._spanLimits},t.prototype.getActiveSpanProcessor=function(){return this._tracerProvider.getActiveSpanProcessor()},t}()});function Aye(){return"unknown_service:"+process.argv0}var Dye=R(()=>{});var Nye,Lye,xW=R(()=>{Nye=function(t){switch(t){case"arm":return"arm32";case"ppc":return"ppc32";case"x64":return"amd64";default:return t}},Lye=function(t){switch(t){case"sunos":return"solaris";case"win32":return"windows";default:return t}}});var Oye,Mye,FI,o6=R(()=>{Oye=z(require("child_process")),Mye=z(require("util")),FI=Mye.promisify(Oye.exec)});var Fye={};mn(Fye,{getMachineId:()=>KKe});function KKe(){return $Ke(this,void 0,void 0,function(){var t,e,r,n;return WKe(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,FI('ioreg -rd1 -c "IOPlatformExpertDevice"')];case 1:return t=o.sent(),e=t.stdout.split(`
`).find(function(s){return s.includes("IOPlatformUUID")}),e?(r=e.split('" = "'),r.length===2?[2,r[1].slice(0,-1)]:[3,3]):[2,""];case 2:return n=o.sent(),ht.debug("error reading machine id: "+n),[3,3];case 3:return[2,""]}})})}var $Ke,WKe,Uye=R(()=>{o6();xr();$Ke=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},WKe=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}});var qye={};mn(qye,{getMachineId:()=>JKe});function JKe(){return YKe(this,void 0,void 0,function(){var t,e,r,n,o,s,a,c,u;return QKe(this,function(l){switch(l.label){case 0:t=["/etc/machine-id","/var/lib/dbus/machine-id"],l.label=1;case 1:l.trys.push([1,8,9,10]),e=XKe(t),r=e.next(),l.label=2;case 2:if(r.done)return[3,7];n=r.value,l.label=3;case 3:return l.trys.push([3,5,,6]),[4,Bye.promises.readFile(n,{encoding:"utf8"})];case 4:return o=l.sent(),[2,o.trim()];case 5:return s=l.sent(),ht.debug("error reading machine id: "+s),[3,6];case 6:return r=e.next(),[3,2];case 7:return[3,10];case 8:return a=l.sent(),c={error:a},[3,10];case 9:try{r&&!r.done&&(u=e.return)&&u.call(e)}finally{if(c)throw c.error}return[7];case 10:return[2,""]}})})}var Bye,YKe,QKe,XKe,Hye=R(()=>{Bye=require("fs");xr();YKe=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},QKe=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},XKe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}});var Vye={};mn(Vye,{getMachineId:()=>tYe});function tYe(){return ZKe(this,void 0,void 0,function(){var e,t,e,r;return eYe(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,jye.promises.readFile("/etc/hostid",{encoding:"utf8"})];case 1:return e=n.sent(),[2,e.trim()];case 2:return t=n.sent(),ht.debug("error reading machine id: "+t),[3,3];case 3:return n.trys.push([3,5,,6]),[4,FI("kenv -q smbios.system.uuid")];case 4:return e=n.sent(),[2,e.stdout.trim()];case 5:return r=n.sent(),ht.debug("error reading machine id: "+r),[3,6];case 6:return[2,""]}})})}var jye,ZKe,eYe,Gye=R(()=>{jye=require("fs");o6();xr();ZKe=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},eYe=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}});var zye={};mn(zye,{getMachineId:()=>iYe});function iYe(){return rYe(this,void 0,void 0,function(){var t,e,r,n,o;return nYe(this,function(s){switch(s.label){case 0:t="QUERY HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Cryptography /v MachineGuid",e="%windir%\\System32\\REG.exe",s6.arch==="ia32"&&"PROCESSOR_ARCHITEW6432"in s6.env&&(e="%windir%\\sysnative\\cmd.exe /c "+e),s.label=1;case 1:return s.trys.push([1,3,,4]),[4,FI(e+" "+t)];case 2:return r=s.sent(),n=r.stdout.split("REG_SZ"),n.length===2?[2,n[1].trim()]:[3,4];case 3:return o=s.sent(),ht.debug("error reading machine id: "+o),[3,4];case 4:return[2,""]}})})}var s6,rYe,nYe,$ye=R(()=>{s6=z(require("process"));o6();xr();rYe=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},nYe=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}});var Wye={};mn(Wye,{getMachineId:()=>aYe});function aYe(){return oYe(this,void 0,void 0,function(){return sYe(this,function(t){return ht.debug("could not read machine-id: unsupported platform"),[2,""]})})}var oYe,sYe,Kye=R(()=>{xr();oYe=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},sYe=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}});var Yye,Hy,Qye=R(()=>{Yye=z(require("process"));switch(Yye.platform){case"darwin":Hy=(Uye(),$i(Fye)).getMachineId;break;case"linux":Hy=(Hye(),$i(qye)).getMachineId;break;case"freebsd":Hy=(Gye(),$i(Vye)).getMachineId;break;case"win32":Hy=($ye(),$i(zye)).getMachineId;break;default:Hy=(Kye(),$i(Wye)).getMachineId}});var a6,cYe,Xye,SW=R(()=>{Pl();UI();a6=require("os");xW();Qye();cYe=function(){function t(){}return t.prototype.detect=function(e){var r,n=(r={},r[ur.HOST_NAME]=(0,a6.hostname)(),r[ur.HOST_ARCH]=Nye((0,a6.arch)()),r);return new da(n,this._getAsyncAttributes())},t.prototype._getAsyncAttributes=function(){return Hy().then(function(e){var r={};return e&&(r[ur.HOST_ID]=e),r})},t}(),Xye=new cYe});var uYe,evr,Jye=R(()=>{SW();uYe=function(){function t(){}return t.prototype.detect=function(e){return Promise.resolve(Xye.detect(e))},t}(),evr=new uYe});var c6,lYe,Zye,IW=R(()=>{Pl();UI();c6=require("os");xW();lYe=function(){function t(){}return t.prototype.detect=function(e){var r,n=(r={},r[ur.OS_TYPE]=Lye((0,c6.platform)()),r[ur.OS_VERSION]=(0,c6.release)(),r);return new da(n)},t}(),Zye=new lYe});var dYe,avr,ebe=R(()=>{IW();dYe=function(){function t(){}return t.prototype.detect=function(e){return Promise.resolve(Zye.detect(e))},t}(),avr=new dYe});var nbe,tbe,rbe,pYe,ibe,CW=R(()=>{xr();Pl();UI();nbe=z(require("os")),tbe=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},rbe=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},pYe=function(){function t(){}return t.prototype.detect=function(e){var r,n=(r={},r[ur.PROCESS_PID]=process.pid,r[ur.PROCESS_EXECUTABLE_NAME]=process.title,r[ur.PROCESS_EXECUTABLE_PATH]=process.execPath,r[ur.PROCESS_COMMAND_ARGS]=rbe(rbe([process.argv[0]],tbe(process.execArgv),!1),tbe(process.argv.slice(1)),!1),r[ur.PROCESS_RUNTIME_VERSION]=process.versions.node,r[ur.PROCESS_RUNTIME_NAME]="nodejs",r[ur.PROCESS_RUNTIME_DESCRIPTION]="Node.js",r);process.argv.length>1&&(n[ur.PROCESS_COMMAND]=process.argv[1]);try{var o=nbe.userInfo();n[ur.PROCESS_OWNER]=o.username}catch(s){ht.debug("error obtaining process owner: "+s)}return new da(n)},t}(),ibe=new pYe});var fYe,mvr,obe=R(()=>{CW();fYe=function(){function t(){}return t.prototype.detect=function(e){return Promise.resolve(ibe.detect(e))},t}(),mvr=new fYe});var sbe=R(()=>{Dye();Jye();ebe();SW();IW();obe();CW()});var EW=R(()=>{sbe()});var Ng,mYe,hYe,gYe,da,UI=R(()=>{xr();Pl();la();EW();Ng=function(){return Ng=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Ng.apply(this,arguments)},mYe=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},hYe=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},gYe=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},da=function(){function t(e,r){var n=this,o;this._attributes=e,this.asyncAttributesPending=r!=null,this._syncAttributes=(o=this._attributes)!==null&&o!==void 0?o:{},this._asyncAttributesPromise=r?.then(function(s){return n._attributes=Object.assign({},n._attributes,s),n.asyncAttributesPending=!1,s},function(s){return ht.debug("a resource's async attributes promise rejected: %s",s),n.asyncAttributesPending=!1,{}})}return t.empty=function(){return t.EMPTY},t.default=function(){var e;return new t((e={},e[ur.SERVICE_NAME]=Aye(),e[ur.TELEMETRY_SDK_LANGUAGE]=Vk[ur.TELEMETRY_SDK_LANGUAGE],e[ur.TELEMETRY_SDK_NAME]=Vk[ur.TELEMETRY_SDK_NAME],e[ur.TELEMETRY_SDK_VERSION]=Vk[ur.TELEMETRY_SDK_VERSION],e))},Object.defineProperty(t.prototype,"attributes",{get:function(){var e;return this.asyncAttributesPending&&ht.error("Accessing resource attributes before async attributes settled"),(e=this._attributes)!==null&&e!==void 0?e:{}},enumerable:!1,configurable:!0}),t.prototype.waitForAsyncAttributes=function(){return mYe(this,void 0,void 0,function(){return hYe(this,function(e){switch(e.label){case 0:return this.asyncAttributesPending?[4,this._asyncAttributesPromise]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.merge=function(e){var r=this,n;if(!e)return this;var o=Ng(Ng({},this._syncAttributes),(n=e._syncAttributes)!==null&&n!==void 0?n:e.attributes);if(!this._asyncAttributesPromise&&!e._asyncAttributesPromise)return new t(o);var s=Promise.all([this._asyncAttributesPromise,e._asyncAttributesPromise]).then(function(a){var c,u=gYe(a,2),l=u[0],d=u[1];return Ng(Ng(Ng(Ng({},r._syncAttributes),l),(c=e._syncAttributes)!==null&&c!==void 0?c:e.attributes),d)});return new t(o,s)},t.EMPTY=new t({}),t}()});var abe=R(()=>{});var cbe=R(()=>{});var ube=R(()=>{});var vYe,Dvr,lbe=R(()=>{u6();vYe=function(){function t(){}return t.prototype.detect=function(e){return Promise.resolve(dbe.detect(e))},t}(),Dvr=new vYe});var yYe,bYe,_Ye,pbe,TW=R(()=>{xr();la();Pl();UI();yYe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},bYe=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},_Ye=function(){function t(){this._MAX_LENGTH=255,this._COMMA_SEPARATOR=",",this._LABEL_KEY_VALUE_SPLITTER="=",this._ERROR_MESSAGE_INVALID_CHARS="should be a ASCII string with a length greater than 0 and not exceed "+this._MAX_LENGTH+" characters.",this._ERROR_MESSAGE_INVALID_VALUE="should be a ASCII string with a length not exceed "+this._MAX_LENGTH+" characters."}return t.prototype.detect=function(e){var r={},n=Io(),o=n.OTEL_RESOURCE_ATTRIBUTES,s=n.OTEL_SERVICE_NAME;if(o)try{var a=this._parseResourceAttributes(o);Object.assign(r,a)}catch(c){ht.debug("EnvDetector failed: "+c.message)}return s&&(r[ur.SERVICE_NAME]=s),new da(r)},t.prototype._parseResourceAttributes=function(e){var r,n;if(!e)return{};var o={},s=e.split(this._COMMA_SEPARATOR,-1);try{for(var a=yYe(s),c=a.next();!c.done;c=a.next()){var u=c.value,l=u.split(this._LABEL_KEY_VALUE_SPLITTER,-1);if(l.length===2){var d=bYe(l,2),p=d[0],f=d[1];if(p=p.trim(),f=f.trim().split(/^"|"$/).join(""),!this._isValidAndNotEmpty(p))throw new Error("Attribute key "+this._ERROR_MESSAGE_INVALID_CHARS);if(!this._isValid(f))throw new Error("Attribute value "+this._ERROR_MESSAGE_INVALID_VALUE);o[p]=decodeURIComponent(f)}}}catch(m){r={error:m}}finally{try{c&&!c.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return o},t.prototype._isValid=function(e){return e.length<=this._MAX_LENGTH&&this._isBaggageOctetString(e)},t.prototype._isBaggageOctetString=function(e){for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);if(n<33||n===44||n===59||n===92||n>126)return!1}return!0},t.prototype._isValidAndNotEmpty=function(e){return e.length>0&&this._isValid(e)},t}(),pbe=new _Ye});var xYe,qvr,fbe=R(()=>{TW();xYe=function(){function t(){}return t.prototype.detect=function(e){return Promise.resolve(pbe.detect(e))},t}(),qvr=new xYe});var wW,SYe,dbe,mbe=R(()=>{Pl();u6();xr();wW=function(){return wW=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},wW.apply(this,arguments)},SYe=function(){function t(){}return t.prototype.detect=function(e){var r,n=typeof navigator<"u";if(!n)return da.empty();var o=(r={},r[ur.PROCESS_RUNTIME_NAME]="browser",r[ur.PROCESS_RUNTIME_DESCRIPTION]="Web Browser",r[ur.PROCESS_RUNTIME_VERSION]=navigator.userAgent,r);return this._getResourceAttributes(o,e)},t.prototype._getResourceAttributes=function(e,r){return e[ur.PROCESS_RUNTIME_VERSION]===""?(ht.debug("BrowserDetector failed: Unable to find required browser resources. "),da.empty()):new da(wW({},e))},t}(),dbe=new SYe});var hbe=R(()=>{lbe();fbe();mbe();TW()});var gbe=R(()=>{});var u6=R(()=>{UI();abe();EW();cbe();ube();hbe();gbe()});var l6,vbe,ybe=R(()=>{la();l6=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},vbe=function(){function t(e){this._spanProcessors=e}return t.prototype.forceFlush=function(){var e,r,n=[];try{for(var o=l6(this._spanProcessors),s=o.next();!s.done;s=o.next()){var a=s.value;n.push(a.forceFlush())}}catch(c){e={error:c}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return new Promise(function(c){Promise.all(n).then(function(){c()}).catch(function(u){Ua(u||new Error("MultiSpanProcessor: forceFlush failed")),c()})})},t.prototype.onStart=function(e,r){var n,o;try{for(var s=l6(this._spanProcessors),a=s.next();!a.done;a=s.next()){var c=a.value;c.onStart(e,r)}}catch(u){n={error:u}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}},t.prototype.onEnd=function(e){var r,n;try{for(var o=l6(this._spanProcessors),s=o.next();!s.done;s=o.next()){var a=s.value;a.onEnd(e)}}catch(c){r={error:c}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}},t.prototype.shutdown=function(){var e,r,n=[];try{for(var o=l6(this._spanProcessors),s=o.next();!s.done;s=o.next()){var a=s.value;n.push(a.shutdown())}}catch(c){e={error:c}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(e)throw e.error}}return new Promise(function(c,u){Promise.all(n).then(function(){c()},u)})},t}()});var RW,kW=R(()=>{RW=function(){function t(){}return t.prototype.onStart=function(e,r){},t.prototype.onEnd=function(e){},t.prototype.shutdown=function(){return Promise.resolve()},t.prototype.forceFlush=function(){return Promise.resolve()},t}()});var Lg,IYe,bbe=R(()=>{xr();la();u6();PW();gW();ybe();kW();i6();vW();(function(t){t[t.resolved=0]="resolved",t[t.timeout=1]="timeout",t[t.error=2]="error",t[t.unresolved=3]="unresolved"})(Lg||(Lg={}));IYe=function(){function t(e){e===void 0&&(e={});var r;this._registeredSpanProcessors=[],this._tracers=new Map;var n=uW({},r6(),Sye(e));this.resource=(r=n.resource)!==null&&r!==void 0?r:da.empty(),this.resource=da.default().merge(this.resource),this._config=Object.assign({},n,{resource:this.resource});var o=this._buildExporterFromEnv();if(o!==void 0){var s=new yW(o);this.activeSpanProcessor=s}else this.activeSpanProcessor=new RW}return t.prototype.getTracer=function(e,r,n){var o=e+"@"+(r||"")+":"+(n?.schemaUrl||"");return this._tracers.has(o)||this._tracers.set(o,new _W({name:e,version:r,schemaUrl:n?.schemaUrl},this._config,this)),this._tracers.get(o)},t.prototype.addSpanProcessor=function(e){this._registeredSpanProcessors.length===0&&this.activeSpanProcessor.shutdown().catch(function(r){return ht.error("Error while trying to shutdown current span processor",r)}),this._registeredSpanProcessors.push(e),this.activeSpanProcessor=new vbe(this._registeredSpanProcessors)},t.prototype.getActiveSpanProcessor=function(){return this.activeSpanProcessor},t.prototype.register=function(e){e===void 0&&(e={}),So.setGlobalTracerProvider(this),e.propagator===void 0&&(e.propagator=this._buildPropagatorFromEnv()),e.contextManager&&ua.setGlobalContextManager(e.contextManager),e.propagator&&Hf.setGlobalPropagator(e.propagator)},t.prototype.forceFlush=function(){var e=this._config.forceFlushTimeoutMillis,r=this._registeredSpanProcessors.map(function(n){return new Promise(function(o){var s,a=setTimeout(function(){o(new Error("Span processor did not completed within timeout period of "+e+" ms")),s=Lg.timeout},e);n.forceFlush().then(function(){clearTimeout(a),s!==Lg.timeout&&(s=Lg.resolved,o(s))}).catch(function(c){clearTimeout(a),s=Lg.error,o(c)})})});return new Promise(function(n,o){Promise.all(r).then(function(s){var a=s.filter(function(c){return c!==Lg.resolved});a.length>0?o(a):n()}).catch(function(s){return o([s])})})},t.prototype.shutdown=function(){return this.activeSpanProcessor.shutdown()},t.prototype._getPropagator=function(e){var r;return(r=this.constructor._registeredPropagators.get(e))===null||r===void 0?void 0:r()},t.prototype._getSpanExporter=function(e){var r;return(r=this.constructor._registeredExporters.get(e))===null||r===void 0?void 0:r()},t.prototype._buildPropagatorFromEnv=function(){var e=this,r=Array.from(new Set(Io().OTEL_PROPAGATORS)),n=r.map(function(s){var a=e._getPropagator(s);return a||ht.warn('Propagator "'+s+'" requested through environment variable is unavailable.'),a}),o=n.reduce(function(s,a){return a&&s.push(a),s},[]);if(o.length!==0)return r.length===1?o[0]:new J$({propagators:o})},t.prototype._buildExporterFromEnv=function(){var e=Io().OTEL_TRACES_EXPORTER;if(!(e==="none"||e==="")){var r=this._getSpanExporter(e);return r||ht.error('Exporter "'+e+'" requested through environment variable is unavailable.'),r}},t._registeredPropagators=new Map([["tracecontext",function(){return new rW}],["baggage",function(){return new B$}]]),t._registeredExporters=new Map,t}()});var CYe,EYe,_be=R(()=>{la();CYe=function(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},EYe=function(){function t(){}return t.prototype.export=function(e,r){return this._sendSpans(e,r)},t.prototype.shutdown=function(){return this._sendSpans([]),this.forceFlush()},t.prototype.forceFlush=function(){return Promise.resolve()},t.prototype._exportInfo=function(e){var r;return{traceId:e.spanContext().traceId,parentId:e.parentSpanId,traceState:(r=e.spanContext().traceState)===null||r===void 0?void 0:r.serialize(),name:e.name,id:e.spanContext().spanId,kind:e.kind,timestamp:z5(e.startTime),duration:z5(e.duration),attributes:e.attributes,status:e.status,events:e.events,links:e.links}},t.prototype._sendSpans=function(e,r){var n,o;try{for(var s=CYe(e),a=s.next();!a.done;a=s.next()){var c=a.value;console.dir(this._exportInfo(c),{depth:3})}}catch(u){n={error:u}}finally{try{a&&!a.done&&(o=s.return)&&o.call(s)}finally{if(n)throw n.error}}if(r)return r({code:ku.SUCCESS})},t}()});var TYe,wYe,RYe,xbe=R(()=>{la();TYe=function(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var n=r.call(t),o,s=[],a;try{for(;(e===void 0||e-- >0)&&!(o=n.next()).done;)s.push(o.value)}catch(c){a={error:c}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s},wYe=function(t,e,r){if(r||arguments.length===2)for(var n=0,o=e.length,s;n<o;n++)(s||!(n in e))&&(s||(s=Array.prototype.slice.call(e,0,n)),s[n]=e[n]);return t.concat(s||Array.prototype.slice.call(e))},RYe=function(){function t(){this._finishedSpans=[],this._stopped=!1}return t.prototype.export=function(e,r){var n;if(this._stopped)return r({code:ku.FAILED,error:new Error("Exporter has been stopped")});(n=this._finishedSpans).push.apply(n,wYe([],TYe(e),!1)),setTimeout(function(){return r({code:ku.SUCCESS})},0)},t.prototype.shutdown=function(){return this._stopped=!0,this._finishedSpans=[],this.forceFlush()},t.prototype.forceFlush=function(){return Promise.resolve()},t.prototype.reset=function(){this._finishedSpans=[]},t.prototype.getFinishedSpans=function(){return this._finishedSpans},t}()});var Sbe=R(()=>{});var kYe,PYe,AYe,Ibe=R(()=>{xr();la();kYe=function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},PYe=function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},AYe=function(){function t(e){this._exporter=e,this._shutdownOnce=new Kk(this._shutdown,this),this._unresolvedExports=new Set}return t.prototype.forceFlush=function(){return kYe(this,void 0,void 0,function(){return PYe(this,function(e){switch(e.label){case 0:return[4,Promise.all(Array.from(this._unresolvedExports))];case 1:return e.sent(),this._exporter.forceFlush?[4,this._exporter.forceFlush()]:[3,3];case 2:e.sent(),e.label=3;case 3:return[2]}})})},t.prototype.onStart=function(e,r){},t.prototype.onEnd=function(e){var r=this,n,o;if(!this._shutdownOnce.isCalled&&e.spanContext().traceFlags&Ui.SAMPLED){var s=function(){return lW._export(r._exporter,[e]).then(function(c){var u;c.code!==ku.SUCCESS&&Ua((u=c.error)!==null&&u!==void 0?u:new Error("SimpleSpanProcessor: span export failed (status "+c+")"))}).catch(function(c){Ua(c)})};if(e.resource.asyncAttributesPending){var a=(o=(n=e.resource).waitForAsyncAttributes)===null||o===void 0?void 0:o.call(n).then(function(){return a!=null&&r._unresolvedExports.delete(a),s()},function(c){return Ua(c)});a!=null&&this._unresolvedExports.add(a)}else s()}},t.prototype.shutdown=function(){return this._shutdownOnce.call()},t.prototype._shutdown=function(){return this._exporter.shutdown()},t}()});var Cbe=R(()=>{});var Ebe=R(()=>{});var Tbe=R(()=>{});var wbe=R(()=>{});var Rbe=R(()=>{});var kbe={};mn(kbe,{AlwaysOffSampler:()=>qy,AlwaysOnSampler:()=>Gf,BasicTracerProvider:()=>IYe,BatchSpanProcessor:()=>yW,ConsoleSpanExporter:()=>EYe,ForceFlushState:()=>Lg,InMemorySpanExporter:()=>RYe,NoopSpanProcessor:()=>RW,ParentBasedSampler:()=>Qk,RandomIdGenerator:()=>bW,SamplingDecision:()=>Yd,SimpleSpanProcessor:()=>AYe,Span:()=>dW,TraceIdRatioBasedSampler:()=>t6,Tracer:()=>_W});var PW=R(()=>{Pye();bbe();i6();_be();xbe();Sbe();Ibe();Cbe();kW();Z5();e6();fW();mW();Yk();pW();Ebe();Tbe();wbe();Rbe()});var Abe=M(Pu=>{"use strict";Object.defineProperty(Pu,"__esModule",{value:!0});Pu.enable=Pu.azureCoreTracing=Pu.AzureMonitorSymbol=void 0;var AW=xi();Pu.AzureMonitorSymbol="Azure_Monitor_Tracer";var DW="azure-coretracing",Pbe=!1,DYe=function(t){if(Pbe)return t;try{var e=(PW(),$i(kbe)),r=(xr(),$i(AI)),n=new e.BasicTracerProvider,o=n.getTracer("applicationinsights tracer");if(t.setTracer){var s=t.setTracer;t.setTracer=function(l){var d=l.startSpan;l.startSpan=function(p,f,m){var h=d.call(this,p,f,m),g=h.end;return h.end=function(){var v=g.apply(this,arguments);return AW.channel.publish(DW,h),v},h},l[Pu.AzureMonitorSymbol]=!0,s.call(this,l)},r.trace.getSpan(r.context.active()),t.setTracer(o)}else{var a=r.trace.setGlobalTracerProvider;r.trace.setGlobalTracerProvider=function(l){var d=l.getTracer;return l.getTracer=function(p,f){var m=d.call(this,p,f);if(!m[Pu.AzureMonitorSymbol]){var h=m.startSpan;m.startSpan=function(g,v,y){var b=h.call(this,g,v,y),_=b.end;return b.end=function(){var S=_.apply(this,arguments);return AW.channel.publish(DW,b),S},b},m[Pu.AzureMonitorSymbol]=!0}return m},a.call(this,l)},n.register(),r.trace.getSpan(r.context.active());var c=require("@opentelemetry/instrumentation"),u=require("@azure/opentelemetry-instrumentation-azure-sdk");c.registerInstrumentations({instrumentations:[u.createAzureSdkInstrumentation()]})}Pbe=!0}catch{}return t};Pu.azureCoreTracing={versionSpecifier:">= 1.0.0 < 2.0.0",patch:DYe,publisherName:DW};function NYe(){AW.channel.registerMonkeyPatch("@azure/core-tracing",Pu.azureCoreTracing)}Pu.enable=NYe});var Nbe=M(jy=>{"use strict";Object.defineProperty(jy,"__esModule",{value:!0});jy.enable=jy.bunyan=void 0;var Dbe=xi(),LYe=function(t){var e=t.prototype._emit;return t.prototype._emit=function(r,n){var o=e.apply(this,arguments);if(!n){var s=o;s||(s=e.call(this,r,!0)),Dbe.channel.publish("bunyan",{level:r.level,result:s})}return o},t};jy.bunyan={versionSpecifier:">= 1.0.0 < 2.0.0",patch:LYe};function OYe(){Dbe.channel.registerMonkeyPatch("bunyan",jy.bunyan)}jy.enable=OYe});var Obe=M(Vy=>{"use strict";Object.defineProperty(Vy,"__esModule",{value:!0});Vy.enable=Vy.console=void 0;var NW=xi(),Lbe=require("stream"),MYe=function(t){var e=new Lbe.Writable,r=new Lbe.Writable;e.write=function(l){if(!l)return!0;var d=l.toString();return NW.channel.publish("console",{message:d}),!0},r.write=function(l){if(!l)return!0;var d=l.toString();return NW.channel.publish("console",{message:d,stderr:!0}),!0};for(var n=new t.Console(e,r),o=["log","info","warn","error","dir","time","timeEnd","trace","assert"],s=function(l){var d=t[l];d&&(t[l]=function(){if(n[l])try{n[l].apply(n,arguments)}catch{}return d.apply(t,arguments)})},a=0,c=o;a<c.length;a++){var u=c[a];s(u)}return t};Vy.console={versionSpecifier:">= 4.0.0",patch:MYe};function FYe(){NW.channel.registerMonkeyPatch("console",Vy.console),require("console")}Vy.enable=FYe});var Mbe=M(Gy=>{"use strict";Object.defineProperty(Gy,"__esModule",{value:!0});Gy.enable=Gy.mongoCore=void 0;var LW=xi(),UYe=function(t){var e=t.Server.prototype.connect;return t.Server.prototype.connect=function(){var n=e.apply(this,arguments),o=this.s.pool.write;this.s.pool.write=function(){var c=typeof arguments[1]=="function"?1:2;return typeof arguments[c]=="function"&&(arguments[c]=LW.channel.bindToContext(arguments[c])),o.apply(this,arguments)};var s=this.s.pool.logout;return this.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=LW.channel.bindToContext(arguments[1])),s.apply(this,arguments)},n},t};Gy.mongoCore={versionSpecifier:">= 2.0.0 < 4.0.0",patch:UYe};function BYe(){LW.channel.registerMonkeyPatch("mongodb-core",Gy.mongoCore)}Gy.enable=BYe});var Fbe=M(pa=>{"use strict";var BI=pa&&pa.__assign||function(){return BI=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},BI.apply(this,arguments)};Object.defineProperty(pa,"__esModule",{value:!0});pa.enable=pa.mongo330=pa.mongo3=pa.mongo2=void 0;var Ds=xi(),qYe=function(t){var e=t.instrument({operationIdGenerator:{next:function(){return Ds.channel.bindToContext(function(n){return n()})}}}),r={};return e.on("started",function(n){r[n.requestId]||(r[n.requestId]=BI(BI({},n),{time:new Date}))}),e.on("succeeded",function(n){var o=r[n.requestId];o&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return Ds.channel.publish("mongodb",{startedData:o,event:n,succeeded:!0})}):Ds.channel.publish("mongodb",{startedData:o,event:n,succeeded:!0})}),e.on("failed",function(n){var o=r[n.requestId];o&&delete r[n.requestId],typeof n.operationId=="function"?n.operationId(function(){return Ds.channel.publish("mongodb",{startedData:o,event:n,succeeded:!1})}):Ds.channel.publish("mongodb",{startedData:o,event:n,succeeded:!1})}),t},HYe=function(t){var e=t.instrument(),r={},n={};return e.on("started",function(o){r[o.requestId]||(n[o.requestId]=Ds.channel.bindToContext(function(s){return s()}),r[o.requestId]=BI(BI({},o),{time:new Date}))}),e.on("succeeded",function(o){var s=r[o.requestId];s&&delete r[o.requestId],typeof o=="object"&&typeof n[o.requestId]=="function"&&(n[o.requestId](function(){return Ds.channel.publish("mongodb",{startedData:s,event:o,succeeded:!0})}),delete n[o.requestId])}),e.on("failed",function(o){var s=r[o.requestId];s&&delete r[o.requestId],typeof o=="object"&&typeof n[o.requestId]=="function"&&(n[o.requestId](function(){return Ds.channel.publish("mongodb",{startedData:s,event:o,succeeded:!1})}),delete n[o.requestId])}),t},jYe=function(t){var e=t.Server.prototype.connect;return t.Server.prototype.connect=function(){var n=e.apply(this,arguments),o=this.s.coreTopology.s.pool.write;this.s.coreTopology.s.pool.write=function(){var c=typeof arguments[1]=="function"?1:2;return typeof arguments[c]=="function"&&(arguments[c]=Ds.channel.bindToContext(arguments[c])),o.apply(this,arguments)};var s=this.s.coreTopology.s.pool.logout;return this.s.coreTopology.s.pool.logout=function(){return typeof arguments[1]=="function"&&(arguments[1]=Ds.channel.bindToContext(arguments[1])),s.apply(this,arguments)},n},t},VYe=function(t){jYe(t);var e=t.instrument(),r={},n={};return e.on("started",function(o){r[o.requestId]||(n[o.requestId]=Ds.channel.bindToContext(function(s){return s()}),r[o.requestId]=o)}),e.on("succeeded",function(o){var s=r[o.requestId];s&&delete r[o.requestId],typeof o=="object"&&typeof n[o.requestId]=="function"&&(n[o.requestId](function(){return Ds.channel.publish("mongodb",{startedData:s,event:o,succeeded:!0})}),delete n[o.requestId])}),e.on("failed",function(o){var s=r[o.requestId];s&&delete r[o.requestId],typeof o=="object"&&typeof n[o.requestId]=="function"&&(n[o.requestId](function(){return Ds.channel.publish("mongodb",{startedData:s,event:o,succeeded:!1})}),delete n[o.requestId])}),t};pa.mongo2={versionSpecifier:">= 2.0.0 <= 3.0.5",patch:qYe};pa.mongo3={versionSpecifier:"> 3.0.5 < 3.3.0",patch:HYe};pa.mongo330={versionSpecifier:">= 3.3.0 < 4.0.0",patch:VYe};function GYe(){Ds.channel.registerMonkeyPatch("mongodb",pa.mongo2),Ds.channel.registerMonkeyPatch("mongodb",pa.mongo3),Ds.channel.registerMonkeyPatch("mongodb",pa.mongo330)}pa.enable=GYe});var Bbe=M(zy=>{"use strict";Object.defineProperty(zy,"__esModule",{value:!0});zy.enable=zy.mysql=void 0;var d6=xi(),Ube=require("path"),zYe=function(t,e){var r=function(u,l){return function(d,p){var f=u[d];f&&(u[d]=function(){for(var h=arguments.length-1,g=arguments.length-1;g>=0;--g)if(typeof arguments[g]=="function"){h=g;break}else if(typeof arguments[g]<"u")break;var v=arguments[h],y={result:null,startTime:null,startDate:null};typeof v=="function"&&(p?(y.startTime=process.hrtime(),y.startDate=new Date,arguments[h]=d6.channel.bindToContext(p(y,v))):arguments[h]=d6.channel.bindToContext(v));var b=f.apply(this,arguments);return y.result=b,b})}},n=function(u,l){return r(u.prototype,l+".prototype")},o=["connect","changeUser","ping","statistics","end"],s=require(Ube.dirname(e)+"/lib/Connection");o.forEach(function(u){return n(s,"Connection")(u)}),r(s,"Connection")("createQuery",function(u,l){return function(d){var p=process.hrtime(u.startTime),f=p[0]*1e3+p[1]/1e6|0;d6.channel.publish("mysql",{query:u.result,callbackArgs:arguments,err:d,duration:f,time:u.startDate}),l.apply(this,arguments)}});var a=["_enqueueCallback"],c=require(Ube.dirname(e)+"/lib/Pool");return a.forEach(function(u){return n(c,"Pool")(u)}),t};zy.mysql={versionSpecifier:">= 2.0.0 < 3.0.0",patch:zYe};function $Ye(){d6.channel.registerMonkeyPatch("mysql",zy.mysql)}zy.enable=$Ye});var Hbe=M($y=>{"use strict";Object.defineProperty($y,"__esModule",{value:!0});$y.enable=$y.postgresPool1=void 0;var qbe=xi();function WYe(t){var e=t.prototype.connect;return t.prototype.connect=function(n){return n&&(arguments[0]=qbe.channel.bindToContext(n)),e.apply(this,arguments)},t}$y.postgresPool1={versionSpecifier:">= 1.0.0 < 3.0.0",patch:WYe};function KYe(){qbe.channel.registerMonkeyPatch("pg-pool",$y.postgresPool1)}$y.enable=KYe});var Vbe=M(Qd=>{"use strict";Object.defineProperty(Qd,"__esModule",{value:!0});Qd.enable=Qd.postgres=Qd.postgres6=void 0;var qI=xi(),jbe=require("events"),OW="postgres";function YYe(t,e){var r=t.Client.prototype.query,n="__diagnosticOriginalFunc";return t.Client.prototype.query=function(s,a,c){var u={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},l=process.hrtime(),d;function p(f){f&&f[n]&&(f=f[n]);var m=qI.channel.bindToContext(function(h,g){var v=process.hrtime(l);if(u.result=g&&{rowCount:g.rowCount,command:g.command},u.error=h,u.duration=Math.ceil(v[0]*1e3+v[1]/1e6),qI.channel.publish(OW,u),h){if(f)return f.apply(this,arguments);d&&d instanceof jbe.EventEmitter&&d.emit("error",h)}else f&&f.apply(this,arguments)});try{return Object.defineProperty(m,n,{value:f}),m}catch{return f}}try{typeof s=="string"?a instanceof Array?(u.query.preparable={text:s,args:a},c=p(c)):(u.query.text=s,c?c=p(c):a=p(a)):(typeof s.name=="string"?u.query.plan=s.name:s.values instanceof Array?u.query.preparable={text:s.text,args:s.values}:u.query.text=s.text,c?c=p(c):a?a=p(a):s.callback=p(s.callback))}catch{return r.apply(this,arguments)}return arguments[0]=s,arguments[1]=a,arguments[2]=c,arguments.length=arguments.length>3?arguments.length:3,d=r.apply(this,arguments),d},t}function QYe(t,e){var r=t.Client.prototype.query,n="__diagnosticOriginalFunc";return t.Client.prototype.query=function(s,a,c){var u=this,l,d,p=!!c,f={query:{},database:{host:this.connectionParameters.host,port:this.connectionParameters.port},result:null,error:null,duration:0,time:new Date},m,h=process.hrtime();function g(b){b&&b[n]&&(b=b[n]);var _=qI.channel.bindToContext(function(S,I){var T=process.hrtime(h);if(f.result=I&&{rowCount:I.rowCount,command:I.command},f.error=S,f.duration=Math.ceil(T[0]*1e3+T[1]/1e6),qI.channel.publish(OW,f),S){if(b)return b.apply(this,arguments);m&&m instanceof jbe.EventEmitter&&m.emit("error",S)}else b&&b.apply(this,arguments)});try{return Object.defineProperty(_,n,{value:b}),_}catch{return b}}try{typeof s=="string"?a instanceof Array?(f.query.preparable={text:s,args:a},p=typeof c=="function",c=p?g(c):c):(f.query.text=s,c?(p=typeof c=="function",c=p?g(c):c):(p=typeof a=="function",a=p?g(a):a)):(typeof s.name=="string"?f.query.plan=s.name:s.values instanceof Array?f.query.preparable={text:s.text,args:s.values}:s.cursor?f.query.text=(l=s.cursor)===null||l===void 0?void 0:l.text:f.query.text=s.text,c?(p=typeof c=="function",c=g(c)):a?(p=typeof a=="function",a=p?g(a):a):(p=typeof s.callback=="function",s.callback=p?g(s.callback):s.callback))}catch{return r.apply(this,arguments)}arguments[0]=s,arguments[1]=a,arguments[2]=c,arguments.length=arguments.length>3?arguments.length:3;try{m=r.apply(this,arguments)}catch(b){throw g()(b,void 0),b}if(!p){if(m instanceof Promise)return m.then(function(b){return g()(void 0,b),new u._Promise(function(_,S){_(b)})}).catch(function(b){return g()(b,void 0),new u._Promise(function(_,S){S(b)})});var v=m.text?m.text:"";if(m.cursor&&(v=(d=m.cursor)===null||d===void 0?void 0:d.text),v){var y={command:v,rowCount:0};g()(void 0,y)}}return m},t}Qd.postgres6={versionSpecifier:"6.*",patch:YYe};Qd.postgres={versionSpecifier:">=7.* <=8.*",patch:QYe,publisherName:OW};function XYe(){qI.channel.registerMonkeyPatch("pg",Qd.postgres6),qI.channel.registerMonkeyPatch("pg",Qd.postgres)}Qd.enable=XYe});var Gbe=M(Wy=>{"use strict";Object.defineProperty(Wy,"__esModule",{value:!0});Wy.enable=Wy.redis=void 0;var MW=xi(),JYe=function(t){var e=t.RedisClient.prototype.internal_send_command;return t.RedisClient.prototype.internal_send_command=function(r){if(r){var n=r.callback;if(!n||!n.pubsubBound){var o=this.address,s=process.hrtime(),a=new Date;r.callback=MW.channel.bindToContext(function(c,u){var l=process.hrtime(s),d=l[0]*1e3+l[1]/1e6|0;MW.channel.publish("redis",{duration:d,address:o,commandObj:r,err:c,result:u,time:a}),typeof n=="function"&&n.apply(this,arguments)}),r.callback.pubsubBound=!0}}return e.call(this,r)},t};Wy.redis={versionSpecifier:">= 2.0.0 < 4.0.0",patch:JYe};function ZYe(){MW.channel.registerMonkeyPatch("redis",Wy.redis)}Wy.enable=ZYe});var zbe=M(zf=>{"use strict";var p6=zf&&zf.__assign||function(){return p6=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},p6.apply(this,arguments)};Object.defineProperty(zf,"__esModule",{value:!0});zf.enable=zf.tedious=void 0;var FW=xi(),eQe=function(t){var e=t.Connection.prototype.makeRequest;return t.Connection.prototype.makeRequest=function(){function n(s){var a=process.hrtime(),c={query:{},database:{host:null,port:null},result:null,error:null,duration:0};return FW.channel.bindToContext(function(u,l,d){var p=process.hrtime(a);c=p6(p6({},c),{database:{host:this.connection.config.server,port:this.connection.config.options.port},result:!u&&{rowCount:l,rows:d},query:{text:this.parametersByName.statement.value},error:u,duration:Math.ceil(p[0]*1e3+p[1]/1e6)}),FW.channel.publish("tedious",c),s.call(this,u,l,d)})}var o=arguments[0];arguments[0].callback=n(o.callback),e.apply(this,arguments)},t};zf.tedious={versionSpecifier:">= 6.0.0 < 9.0.0",patch:eQe};function tQe(){FW.channel.registerMonkeyPatch("tedious",zf.tedious)}zf.enable=tQe});var $be=M(Ba=>{"use strict";var rQe=Ba&&Ba.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),nQe=Ba&&Ba.__rest||function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r};Object.defineProperty(Ba,"__esModule",{value:!0});Ba.enable=Ba.winston2=Ba.winston3=void 0;var f6=xi(),iQe=function(t){var e=t.Logger.prototype.log,r,n=function(o,s,a){var c;return r===t.config.npm.levels?c="npm":r===t.config.syslog.levels?c="syslog":c="unknown",f6.channel.publish("winston",{level:o,message:s,meta:a,levelKind:c}),s};return t.Logger.prototype.log=function(){return r=this.levels,!this.filters||this.filters.length===0?this.filters=[n]:this.filters[this.filters.length-1]!==n&&(this.filters=this.filters.filter(function(s){return s!==n}),this.filters.push(n)),e.apply(this,arguments)},t},oQe=function(t){var e=function(a,c){var u;return a.config.npm.levels[c]!=null?u="npm":a.config.syslog.levels[c]!=null?u="syslog":u="unknown",u},r=function(a){rQe(c,a);function c(u,l){var d=a.call(this,l)||this;return d.winston=u,d}return c.prototype.log=function(u,l){var d=u.message,p=u.level,f=u.meta,m=nQe(u,["message","level","meta"]);p=typeof Symbol.for=="function"?u[Symbol.for("level")]:p,d=u instanceof Error?u:d;var h=e(this.winston,p);f=f||{};for(var g in m)m.hasOwnProperty(g)&&(f[g]=m[g]);f6.channel.publish("winston",{message:d,level:p,levelKind:h,meta:f}),l()},c}(t.Transport);function n(){var a=t.config.npm.levels;arguments&&arguments[0]&&arguments[0].levels&&(a=arguments[0].levels);var c;for(var u in a)a.hasOwnProperty(u)&&(c=c===void 0||a[u]>a[c]?u:c);this.add(new r(t,{level:c}))}var o=t.createLogger;t.createLogger=function(){var c=t.config.npm.levels;arguments&&arguments[0]&&arguments[0].levels&&(c=arguments[0].levels);var u;for(var l in c)c.hasOwnProperty(l)&&(u=u===void 0||c[l]>c[u]?l:u);var d=o.apply(this,arguments);d.add(new r(t,{level:u}));var p=d.configure;return d.configure=function(){p.apply(this,arguments),n.apply(this,arguments)},d};var s=t.configure;return t.configure=function(){s.apply(this,arguments),n.apply(this,arguments)},t.add(new r(t)),t};Ba.winston3={versionSpecifier:"3.x",patch:oQe};Ba.winston2={versionSpecifier:"2.x",patch:iQe};function sQe(){f6.channel.registerMonkeyPatch("winston",Ba.winston2),f6.channel.registerMonkeyPatch("winston",Ba.winston3)}Ba.enable=sQe});var i_e=M(wn=>{"use strict";Object.defineProperty(wn,"__esModule",{value:!0});wn.enable=wn.tedious=wn.pgPool=wn.pg=wn.winston=wn.redis=wn.mysql=wn.mongodb=wn.mongodbCore=wn.console=wn.bunyan=wn.azuresdk=void 0;var Wbe=Abe();wn.azuresdk=Wbe;var Kbe=Nbe();wn.bunyan=Kbe;var Ybe=Obe();wn.console=Ybe;var Qbe=Mbe();wn.mongodbCore=Qbe;var Xbe=Fbe();wn.mongodb=Xbe;var Jbe=Bbe();wn.mysql=Jbe;var Zbe=Hbe();wn.pgPool=Zbe;var e_e=Vbe();wn.pg=e_e;var t_e=Gbe();wn.redis=t_e;var r_e=zbe();wn.tedious=r_e;var n_e=$be();wn.winston=n_e;function aQe(){Kbe.enable(),Ybe.enable(),Qbe.enable(),Xbe.enable(),Jbe.enable(),e_e.enable(),Zbe.enable(),t_e.enable(),n_e.enable(),Wbe.enable(),r_e.enable()}wn.enable=aQe});var g6=M(Og=>{"use strict";Object.defineProperty(Og,"__esModule",{value:!0});Og.registerContextPreservation=Og.IsInitialized=void 0;var UW=Hn(),s_e=d5();Og.IsInitialized=!s_e.JsonConfig.getInstance().noDiagnosticChannel;var BW="DiagnosticChannel";if(Og.IsInitialized){Al=i_e(),o_e=s_e.JsonConfig.getInstance().noPatchModules,m6=o_e.split(","),qW={bunyan:Al.bunyan,console:Al.console,mongodb:Al.mongodb,mongodbCore:Al.mongodbCore,mysql:Al.mysql,redis:Al.redis,pg:Al.pg,pgPool:Al.pgPool,winston:Al.winston,azuresdk:Al.azuresdk};for(h6 in qW)m6.indexOf(h6)===-1&&(qW[h6].enable(),UW.info(BW,"Subscribed to "+h6+" events"));m6.length>0&&UW.info(BW,"Some modules will not be patched",m6)}else UW.info(BW,"Not subscribing to dependency autocollection because APPLICATION_INSIGHTS_NO_DIAGNOSTIC_CHANNEL was set");var Al,o_e,m6,qW,h6;function cQe(t){if(Og.IsInitialized){var e=xi();e.channel.addContextPreservation(t)}}Og.registerContextPreservation=cQe});var HI=M((iyr,a_e)=>{"use strict";a_e.exports={requestContextHeader:"request-context",requestContextSourceKey:"appId",requestContextTargetKey:"appId",requestIdHeader:"request-id",parentIdHeader:"x-ms-request-id",rootIdHeader:"x-ms-request-root-id",correlationContextHeader:"correlation-context",traceparentHeader:"traceparent",traceStateHeader:"tracestate"}});var us=M((VW,c_e)=>{"use strict";var Fg=VW&&VW.__assign||function(){return Fg=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Fg.apply(this,arguments)},uQe=require("http"),HW=require("https"),jW=require("url"),Mg=require("constants"),Ky=Hn(),jI=HI(),lQe=d5(),dQe=function(){function t(){t._addCloseHandler()}return t.getCookie=function(e,r){var n="";if(e&&e.length&&typeof r=="string")for(var o=e+"=",s=r.split(";"),a=0;a<s.length;a++){var r=s[a];if(r=t.trim(r),r&&r.indexOf(o)===0){n=r.substring(o.length,s[a].length);break}}return n},t.trim=function(e){return typeof e=="string"?e.replace(/^\s+|\s+$/g,""):""},t.int32ArrayToBase64=function(e){var r=function(c,u){return String.fromCharCode(c>>u&255)},n=function(c){return r(c,24)+r(c,16)+r(c,8)+r(c,0)},o=e.map(n).join(""),s=Buffer.from?Buffer.from(o,"binary"):new Buffer(o,"binary"),a=s.toString("base64");return a.substr(0,a.indexOf("="))},t.random32=function(){return 4294967296*Math.random()|0},t.randomu32=function(){return t.random32()+2147483648},t.w3cTraceId=function(){for(var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],r="",n,o=0;o<4;o++)n=t.random32(),r+=e[n&15]+e[n>>4&15]+e[n>>8&15]+e[n>>12&15]+e[n>>16&15]+e[n>>20&15]+e[n>>24&15]+e[n>>28&15];var s=e[8+Math.random()*4|0];return r.substr(0,8)+r.substr(9,4)+"4"+r.substr(13,3)+s+r.substr(16,3)+r.substr(19,12)},t.w3cSpanId=function(){return t.w3cTraceId().substring(16)},t.isValidW3CId=function(e){return e.length===32&&e!=="00000000000000000000000000000000"},t.isArray=function(e){return Object.prototype.toString.call(e)==="[object Array]"},t.isError=function(e){return Object.prototype.toString.call(e)==="[object Error]"},t.isPrimitive=function(e){var r=typeof e;return r==="string"||r==="number"||r==="boolean"},t.isDate=function(e){return Object.prototype.toString.call(e)==="[object Date]"},t.msToTimeSpan=function(e){(isNaN(e)||e<0)&&(e=0);var r=(e/1e3%60).toFixed(7).replace(/0{0,4}$/,""),n=""+Math.floor(e/(1e3*60))%60,o=""+Math.floor(e/(1e3*60*60))%24,s=Math.floor(e/(1e3*60*60*24));r=r.indexOf(".")<2?"0"+r:r,n=n.length<2?"0"+n:n,o=o.length<2?"0"+o:o;var a=s>0?s+".":"";return a+o+":"+n+":"+r},t.extractError=function(e){var r=e;return{message:e.message,code:r.code||r.id||""}},t.extractObject=function(e){return e instanceof Error?t.extractError(e):typeof e.toJSON=="function"?e.toJSON():e},t.validateStringMap=function(e){if(typeof e!="object"){Ky.info("Invalid properties dropped from payload");return}var r={};for(var n in e){var o="",s=e[n],a=typeof s;if(t.isPrimitive(s))o=s.toString();else if(s===null||a==="undefined")o="";else if(a==="function"){Ky.info("key: "+n+" was function; will not serialize");continue}else{var c=t.isArray(s)?s:t.extractObject(s);try{t.isPrimitive(c)?o=c:o=JSON.stringify(c)}catch(u){o=s.constructor.name.toString()+" (Error: "+u.message+")",Ky.info("key: "+n+", could not be serialized")}}r[n]=o.substring(0,t.MAX_PROPERTY_LENGTH)}return r},t.canIncludeCorrelationHeader=function(e,r){var n=e&&e.config&&e.config.correlationHeaderExcludedDomains;if(!n||n.length==0||!r)return!0;for(var o=0;o<n.length;o++){var s=new RegExp(n[o].replace(/\./g,".").replace(/\*/g,".*"));try{if(s.test(new jW.URL(r).hostname))return!1}catch{}}return!0},t.getCorrelationContextTarget=function(e,r){var n=e.headers&&e.headers[jI.requestContextHeader];if(n)for(var o=n.split(","),s=0;s<o.length;++s){var a=o[s].split("=");if(a.length==2&&a[0]==r)return a[1]}},t.makeRequest=function(e,r,n,o,s,a){s===void 0&&(s=!0),a===void 0&&(a=!0),r&&r.indexOf("//")===0&&(r="https:"+r);var c=new jW.URL(r),u=Fg(Fg({},n),{host:c.hostname,port:c.port,path:c.pathname}),l=void 0;if(s&&(c.protocol==="https:"&&(l=e.proxyHttpsUrl||void 0),c.protocol==="http:"&&(l=e.proxyHttpUrl||void 0),l)){l.indexOf("//")===0&&(l="http:"+l);try{var d=new jW.URL(l);d.protocol==="https:"?(Ky.info("Proxies that use HTTPS are not supported"),l=void 0):u=Fg(Fg({},u),{host:d.hostname,port:d.port||"80",path:r,headers:Fg(Fg({},u.headers),{Host:c.hostname})})}catch{Ky.warn("Wrong proxy URL provided")}}var p=c.protocol==="https:"&&!l;return a&&(p&&e.httpsAgent!==void 0?u.agent=e.httpsAgent:!p&&e.httpAgent!==void 0?u.agent=e.httpAgent:p&&(u.agent=t._useKeepAlive?t.keepAliveAgent:t.tlsRestrictedAgent)),p?HW.request(u,o):uQe.request(u,o)},t.safeIncludeCorrelationHeader=function(e,r,n){var o;if(typeof n=="string")o=n;else if(n instanceof Array)o=n.join(",");else if(n&&typeof n.toString=="function")try{o=n.toString()}catch(s){Ky.warn("Outgoing request-context header could not be read. Correlation of requests may be lost.",s,n)}o?t.addCorrelationIdHeaderFromString(e,r,o):r.setHeader(jI.requestContextHeader,jI.requestContextSourceKey+"="+e.config.correlationId)},t.dumpObj=function(e){if(e)try{var r=Object.prototype.toString.call(e),n="";return r==="[object Error]"?n="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":n=this.stringify(e),r+n}catch{return e.toString()}},t.stringify=function(e){try{return JSON.stringify(e)}catch(r){Ky.warn("Failed to serialize payload",r,e)}},t.addCorrelationIdHeaderFromString=function(e,r,n){var o=n.split(","),s=jI.requestContextSourceKey+"=",a=o.some(function(c){return c.substring(0,s.length)===s});a||r.setHeader(jI.requestContextHeader,n+","+jI.requestContextSourceKey+"="+e.config.correlationId)},t._addCloseHandler=function(){t._listenerAttached||(process.on("exit",function(){t.isNodeExit=!0,t._useKeepAlive=!1}),t._listenerAttached=!0)},t._useKeepAlive=!lQe.JsonConfig.getInstance().noHttpAgentKeepAlive,t._listenerAttached=!1,t.MAX_PROPERTY_LENGTH=8192,t.keepAliveAgent=new HW.Agent({keepAlive:!0,maxSockets:25,secureOptions:Mg.SSL_OP_NO_SSLv2|Mg.SSL_OP_NO_SSLv3|Mg.SSL_OP_NO_TLSv1|Mg.SSL_OP_NO_TLSv1_1}),t.tlsRestrictedAgent=new HW.Agent({secureOptions:Mg.SSL_OP_NO_SSLv2|Mg.SSL_OP_NO_SSLv3|Mg.SSL_OP_NO_TLSv1|Mg.SSL_OP_NO_TLSv1_1}),t.isNodeExit=!1,t}();c_e.exports=dQe});var Yy=M((oyr,u_e)=>{"use strict";var GW=us(),pQe=function(){function t(){}return t.queryCorrelationId=function(e,r){},t.cancelCorrelationIdQuery=function(e,r){},t.generateRequestId=function(e){if(e){e=e[0]=="|"?e:"|"+e,e[e.length-1]!=="."&&(e+=".");var r=(t.currentRootId++).toString(16);return t.appendSuffix(e,r,"_")}else return t.generateRootId()},t.getRootId=function(e){var r=e.indexOf(".");r<0&&(r=e.length);var n=e[0]==="|"?1:0;return e.substring(n,r)},t.generateRootId=function(){return"|"+GW.w3cTraceId()+"."},t.appendSuffix=function(e,r,n){if(e.length+r.length<t.requestIdMaxLength)return e+r+n;var o=t.requestIdMaxLength-9;if(e.length>o)for(;o>1;--o){var s=e[o-1];if(s==="."||s==="_")break}if(o<=1)return t.generateRootId();for(r=GW.randomu32().toString(16);r.length<8;)r="0"+r;return e.substring(0,o)+r+"#"},t.correlationIdPrefix="cid-v1:",t.w3cEnabled=!0,t.HTTP_TIMEOUT=2500,t.requestIdMaxLength=1024,t.currentRootId=GW.randomu32(),t}();u_e.exports=pQe});var v6=M((syr,l_e)=>{"use strict";var ls=us(),fQe=Yy(),mQe=function(){function t(e,r){if(this.traceFlag=t.DEFAULT_TRACE_FLAG,this.version=t.DEFAULT_VERSION,e&&typeof e=="string")if(e.split(",").length>1)this.traceId=ls.w3cTraceId(),this.spanId=ls.w3cTraceId().substr(0,16);else{var n=e.trim().split("-"),o=n.length;o>=4?(this.version=n[0],this.traceId=n[1],this.spanId=n[2],this.traceFlag=n[3]):(this.traceId=ls.w3cTraceId(),this.spanId=ls.w3cTraceId().substr(0,16)),this.version.match(/^[0-9a-f]{2}$/g)||(this.version=t.DEFAULT_VERSION,this.traceId=ls.w3cTraceId()),this.version==="00"&&o!==4&&(this.traceId=ls.w3cTraceId(),this.spanId=ls.w3cTraceId().substr(0,16)),this.version==="ff"&&(this.version=t.DEFAULT_VERSION,this.traceId=ls.w3cTraceId(),this.spanId=ls.w3cTraceId().substr(0,16)),this.version.match(/^0[0-9a-f]$/g)||(this.version=t.DEFAULT_VERSION),this.traceFlag.match(/^[0-9a-f]{2}$/g)||(this.traceFlag=t.DEFAULT_TRACE_FLAG,this.traceId=ls.w3cTraceId()),t.isValidTraceId(this.traceId)||(this.traceId=ls.w3cTraceId()),t.isValidSpanId(this.spanId)||(this.spanId=ls.w3cTraceId().substr(0,16),this.traceId=ls.w3cTraceId()),this.parentId=this.getBackCompatRequestId()}else if(r){this.parentId=r.slice();var s=fQe.getRootId(r);t.isValidTraceId(s)||(this.legacyRootId=s,s=ls.w3cTraceId()),r.indexOf("|")!==-1&&(r=r.substring(1+r.substring(0,r.length-1).lastIndexOf("."),r.length-1)),this.traceId=s,this.spanId=r}else this.traceId=ls.w3cTraceId(),this.spanId=ls.w3cTraceId().substr(0,16)}return t.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&e!=="00000000000000000000000000000000"},t.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&e!=="0000000000000000"},t.formatOpenTelemetryTraceFlags=function(e){var r="0"+e.toString(16);return r.substring(r.length-2)},t.prototype.getBackCompatRequestId=function(){return"|"+this.traceId+"."+this.spanId+"."},t.prototype.toString=function(){return this.version+"-"+this.traceId+"-"+this.spanId+"-"+this.traceFlag},t.prototype.updateSpanId=function(){this.spanId=ls.w3cTraceId().substr(0,16)},t.DEFAULT_TRACE_FLAG="01",t.DEFAULT_VERSION="00",t}();l_e.exports=mQe});var zW=M((ayr,d_e)=>{"use strict";var hQe=function(){function t(e){this.fieldmap=[],e&&(this.fieldmap=this.parseHeader(e))}return t.prototype.toString=function(){var e=this.fieldmap;return!e||e.length==0?null:e.join(", ")},t.validateKeyChars=function(e){var r=e.split("@");if(r.length==2){var n=r[0].trim(),o=r[1].trim(),s=!!n.match(/^[\ ]?[a-z0-9\*\-\_/]{1,241}$/),a=!!o.match(/^[\ ]?[a-z0-9\*\-\_/]{1,14}$/);return s&&a}else if(r.length==1)return!!e.match(/^[\ ]?[a-z0-9\*\-\_/]{1,256}$/);return!1},t.prototype.parseHeader=function(e){var r=[],n={},o=e.split(",");if(o.length>32)return null;for(var s=0,a=o;s<a.length;s++){var c=a[s],u=c.trim();if(u.length!==0){var l=u.split("=");if(l.length!==2||!t.validateKeyChars(l[0])||n[l[0]])return null;n[l[0]]=!0,r.push(u)}}return r},t.strict=!0,t}();d_e.exports=hQe});var $f=M((cyr,p_e)=>{"use strict";var gQe=function(){function t(){}return t}();p_e.exports=gQe});var m_e=M(($W,f_e)=>{"use strict";var vQe=$W&&$W.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),yQe=$f(),bQe=function(t){vQe(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return e}(yQe);f_e.exports=bQe});var WW=M((uyr,h_e)=>{"use strict";var _Qe=function(){function t(){}return t}();h_e.exports=_Qe});var v_e=M((lyr,g_e)=>{"use strict";var xQe=function(){function t(){this.applicationVersion="ai.application.ver",this.deviceId="ai.device.id",this.deviceLocale="ai.device.locale",this.deviceModel="ai.device.model",this.deviceOEMName="ai.device.oemName",this.deviceOSVersion="ai.device.osVersion",this.deviceType="ai.device.type",this.locationIp="ai.location.ip",this.operationId="ai.operation.id",this.operationName="ai.operation.name",this.operationParentId="ai.operation.parentId",this.operationSyntheticSource="ai.operation.syntheticSource",this.operationCorrelationVector="ai.operation.correlationVector",this.sessionId="ai.session.id",this.sessionIsFirst="ai.session.isFirst",this.userAccountId="ai.user.accountId",this.userId="ai.user.id",this.userAuthUserId="ai.user.authUserId",this.cloudRole="ai.cloud.role",this.cloudRoleInstance="ai.cloud.roleInstance",this.internalSdkVersion="ai.internal.sdkVersion",this.internalAgentVersion="ai.internal.agentVersion",this.internalNodeName="ai.internal.nodeName"}return t}();g_e.exports=xQe});var b_e=M((KW,y_e)=>{"use strict";var SQe=KW&&KW.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),IQe=WW(),CQe=function(t){SQe(e,t);function e(){return t.call(this)||this}return e}(IQe);y_e.exports=CQe});var QW=M((dyr,__e)=>{"use strict";var YW;(function(t){t[t.Measurement=0]="Measurement",t[t.Aggregation=1]="Aggregation"})(YW||(YW={}));__e.exports=YW});var S_e=M((pyr,x_e)=>{"use strict";var EQe=QW(),TQe=function(){function t(){this.kind=EQe.Measurement}return t}();x_e.exports=TQe});var C_e=M((fyr,I_e)=>{"use strict";var wQe=function(){function t(){this.ver=1,this.sampleRate=100,this.tags={}}return t}();I_e.exports=wQe});var JW=M((XW,E_e)=>{"use strict";var RQe=XW&&XW.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),kQe=$f(),PQe=function(t){RQe(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return e}(kQe);E_e.exports=PQe});var w_e=M((ZW,T_e)=>{"use strict";var AQe=ZW&&ZW.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),DQe=$f(),NQe=function(t){AQe(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.exceptions=[],r.properties={},r.measurements={},r}return e}(DQe);T_e.exports=NQe});var k_e=M((myr,R_e)=>{"use strict";var LQe=function(){function t(){this.hasFullStack=!0,this.parsedStack=[]}return t}();R_e.exports=LQe});var A_e=M((eK,P_e)=>{"use strict";var OQe=eK&&eK.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),MQe=$f(),FQe=function(t){OQe(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r}return e}(MQe);P_e.exports=FQe});var N_e=M((tK,D_e)=>{"use strict";var UQe=tK&&tK.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),BQe=$f(),qQe=function(t){UQe(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.metrics=[],r.properties={},r}return e}(BQe);D_e.exports=qQe});var O_e=M((rK,L_e)=>{"use strict";var HQe=rK&&rK.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),jQe=JW(),VQe=function(t){HQe(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return e}(jQe);L_e.exports=VQe});var F_e=M((nK,M_e)=>{"use strict";var GQe=nK&&nK.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),zQe=$f(),$Qe=function(t){GQe(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.success=!0,r.properties={},r.measurements={},r}return e}(zQe);M_e.exports=$Qe});var B_e=M((iK,U_e)=>{"use strict";var WQe=iK&&iK.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),KQe=$f(),YQe=function(t){WQe(e,t);function e(){var r=t.call(this)||this;return r.ver=2,r.properties={},r.measurements={},r}return e}(KQe);U_e.exports=YQe});var H_e=M((hyr,q_e)=>{"use strict";var oK;(function(t){t[t.Verbose=0]="Verbose",t[t.Information=1]="Information",t[t.Warning=2]="Warning",t[t.Error=3]="Error",t[t.Critical=4]="Critical"})(oK||(oK={}));q_e.exports=oK});var V_e=M((gyr,j_e)=>{"use strict";var QQe=function(){function t(){}return t}();j_e.exports=QQe});var sK=M(ro=>{"use strict";Object.defineProperty(ro,"__esModule",{value:!0});ro.AvailabilityData=m_e();ro.Base=WW();ro.ContextTagKeys=v_e();ro.Data=b_e();ro.DataPoint=S_e();ro.DataPointType=QW();ro.Domain=$f();ro.Envelope=C_e();ro.EventData=JW();ro.ExceptionData=w_e();ro.ExceptionDetails=k_e();ro.MessageData=A_e();ro.MetricData=N_e();ro.PageViewData=O_e();ro.RemoteDependencyData=F_e();ro.RequestData=B_e();ro.SeverityLevel=H_e();ro.StackFrame=V_e()});var G_e=M(VI=>{"use strict";Object.defineProperty(VI,"__esModule",{value:!0});VI.domainSupportsProperties=VI.RemoteDependencyDataConstants=void 0;var Qy=sK(),XQe=function(){function t(){}return t.TYPE_HTTP="Http",t.TYPE_AI="Http (tracked component)",t}();VI.RemoteDependencyDataConstants=XQe;function JQe(t){return"properties"in t||t instanceof Qy.EventData||t instanceof Qy.ExceptionData||t instanceof Qy.MessageData||t instanceof Qy.MetricData||t instanceof Qy.PageViewData||t instanceof Qy.RemoteDependencyData||t instanceof Qy.RequestData}VI.domainSupportsProperties=JQe});var $_e=M(z_e=>{"use strict";Object.defineProperty(z_e,"__esModule",{value:!0})});var K_e=M(W_e=>{"use strict";Object.defineProperty(W_e,"__esModule",{value:!0})});var Q_e=M(Y_e=>{"use strict";Object.defineProperty(Y_e,"__esModule",{value:!0})});var J_e=M(X_e=>{"use strict";Object.defineProperty(X_e,"__esModule",{value:!0})});var exe=M(Z_e=>{"use strict";Object.defineProperty(Z_e,"__esModule",{value:!0})});var rxe=M(txe=>{"use strict";Object.defineProperty(txe,"__esModule",{value:!0})});var ixe=M(nxe=>{"use strict";Object.defineProperty(nxe,"__esModule",{value:!0})});var sxe=M(oxe=>{"use strict";Object.defineProperty(oxe,"__esModule",{value:!0})});var cxe=M(axe=>{"use strict";Object.defineProperty(axe,"__esModule",{value:!0})});var lxe=M(uxe=>{"use strict";Object.defineProperty(uxe,"__esModule",{value:!0})});var pxe=M(dxe=>{"use strict";Object.defineProperty(dxe,"__esModule",{value:!0})});var mxe=M(fxe=>{"use strict";Object.defineProperty(fxe,"__esModule",{value:!0})});var hxe=M(Dl=>{"use strict";Object.defineProperty(Dl,"__esModule",{value:!0});Dl.TelemetryType=Dl.TelemetryTypeString=Dl.baseTypeToTelemetryType=Dl.telemetryTypeToBaseType=void 0;function ZQe(t){switch(t){case ds.Event:return"EventData";case ds.Exception:return"ExceptionData";case ds.Trace:return"MessageData";case ds.Metric:return"MetricData";case ds.Request:return"RequestData";case ds.Dependency:return"RemoteDependencyData";case ds.Availability:return"AvailabilityData";case ds.PageView:return"PageViewData"}}Dl.telemetryTypeToBaseType=ZQe;function eXe(t){switch(t){case"EventData":return ds.Event;case"ExceptionData":return ds.Exception;case"MessageData":return ds.Trace;case"MetricData":return ds.Metric;case"RequestData":return ds.Request;case"RemoteDependencyData":return ds.Dependency;case"AvailabilityData":return ds.Availability;case"PageViewData":return ds.PageView}}Dl.baseTypeToTelemetryType=eXe;Dl.TelemetryTypeString={Event:"EventData",Exception:"ExceptionData",Trace:"MessageData",Metric:"MetricData",Request:"RequestData",Dependency:"RemoteDependencyData",Availability:"AvailabilityData",PageView:"PageViewData"};var ds;(function(t){t[t.Event=0]="Event",t[t.Exception=1]="Exception",t[t.Trace=2]="Trace",t[t.Metric=3]="Metric",t[t.Request=4]="Request",t[t.Dependency=5]="Dependency",t[t.Availability=6]="Availability",t[t.PageView=7]="PageView"})(ds=Dl.TelemetryType||(Dl.TelemetryType={}))});var gxe=M(Co=>{"use strict";var tXe=Co&&Co.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Pc=Co&&Co.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&tXe(e,t,r)};Object.defineProperty(Co,"__esModule",{value:!0});Pc($_e(),Co);Pc(K_e(),Co);Pc(Q_e(),Co);Pc(J_e(),Co);Pc(exe(),Co);Pc(rxe(),Co);Pc(ixe(),Co);Pc(sxe(),Co);Pc(cxe(),Co);Pc(lxe(),Co);Pc(pxe(),Co);Pc(mxe(),Co);Pc(hxe(),Co)});var yxe=M(vxe=>{"use strict";Object.defineProperty(vxe,"__esModule",{value:!0})});var _xe=M(bxe=>{"use strict";Object.defineProperty(bxe,"__esModule",{value:!0})});var Sxe=M(xxe=>{"use strict";Object.defineProperty(xxe,"__esModule",{value:!0})});var Cxe=M(Ixe=>{"use strict";Object.defineProperty(Ixe,"__esModule",{value:!0})});var Txe=M(Exe=>{"use strict";Object.defineProperty(Exe,"__esModule",{value:!0})});var Rxe=M(wxe=>{"use strict";Object.defineProperty(wxe,"__esModule",{value:!0})});var Pxe=M(kxe=>{"use strict";Object.defineProperty(kxe,"__esModule",{value:!0})});var Dxe=M(Axe=>{"use strict";Object.defineProperty(Axe,"__esModule",{value:!0})});var Nxe=M(qa=>{"use strict";var rXe=qa&&qa.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Ug=qa&&qa.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&rXe(e,t,r)};Object.defineProperty(qa,"__esModule",{value:!0});Ug(yxe(),qa);Ug(_xe(),qa);Ug(Sxe(),qa);Ug(Cxe(),qa);Ug(Txe(),qa);Ug(Rxe(),qa);Ug(Pxe(),qa);Ug(Dxe(),qa)});var Ns=M(Xd=>{"use strict";var nXe=Xd&&Xd.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),y6=Xd&&Xd.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&nXe(e,t,r)};Object.defineProperty(Xd,"__esModule",{value:!0});y6(G_e(),Xd);y6(sK(),Xd);y6(gxe(),Xd);y6(Nxe(),Xd)});var aK=M((Vyr,Lxe)=>{"use strict";var iXe=function(){function t(){}return t.prototype.getUrl=function(){return this.url},t.prototype.RequestParser=function(){this.startTime=+new Date},t.prototype._setStatus=function(e,r){var n=+new Date;this.duration=n-this.startTime,this.statusCode=e;var o=this.properties||{};if(r){if(typeof r=="string")o.error=r;else if(r instanceof Error)o.error=r.message;else if(typeof r=="object")for(var s in r)o[s]=r[s]&&r[s].toString&&r[s].toString()}this.properties=o},t.prototype._isSuccess=function(){return 0<this.statusCode&&this.statusCode<400},t}();Lxe.exports=iXe});var ri=M(Ue=>{"use strict";var Nl;Object.defineProperty(Ue,"__esModule",{value:!0});Ue.WEB_INSTRUMENTATION_DEPRECATED_SOURCE=Ue.WEB_INSTRUMENTATION_DEFAULT_SOURCE=Ue.TIME_SINCE_ENQUEUED=Ue.ENQUEUED_TIME=Ue.MessageBusDestination=Ue.MicrosoftEventHub=Ue.AzNamespace=Ue.HttpRequestCookieNames=Ue.StatsbeatNetworkCategory=Ue.StatsbeatFeatureType=Ue.StatsbeatInstrumentation=Ue.StatsbeatFeature=Ue.StatsbeatCounter=Ue.StatsbeatAttach=Ue.StatsbeatResourceProvider=Ue.StatsbeatTelemetryName=Ue.HeartBeatMetricName=Ue.DependencyTypeName=Ue.TelemetryTypeStringToQuickPulseDocumentType=Ue.TelemetryTypeStringToQuickPulseType=Ue.QuickPulseType=Ue.QuickPulseDocumentType=Ue.PerformanceToQuickPulseCounter=Ue.MetricId=Ue.PerformanceCounter=Ue.QuickPulseCounter=Ue.DEFAULT_LIVEMETRICS_HOST=Ue.DEFAULT_LIVEMETRICS_ENDPOINT=Ue.DEFAULT_BREEZE_ENDPOINT=Ue.APPLICATION_INSIGHTS_SDK_VERSION=void 0;Ue.APPLICATION_INSIGHTS_SDK_VERSION="2.9.1";Ue.DEFAULT_BREEZE_ENDPOINT="https://dc.services.visualstudio.com";Ue.DEFAULT_LIVEMETRICS_ENDPOINT="https://rt.services.visualstudio.com";Ue.DEFAULT_LIVEMETRICS_HOST="rt.services.visualstudio.com";var Ls;(function(t){t.COMMITTED_BYTES="\\Memory\\Committed Bytes",t.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",t.REQUEST_RATE="\\ApplicationInsights\\Requests/Sec",t.REQUEST_FAILURE_RATE="\\ApplicationInsights\\Requests Failed/Sec",t.REQUEST_DURATION="\\ApplicationInsights\\Request Duration",t.DEPENDENCY_RATE="\\ApplicationInsights\\Dependency Calls/Sec",t.DEPENDENCY_FAILURE_RATE="\\ApplicationInsights\\Dependency Calls Failed/Sec",t.DEPENDENCY_DURATION="\\ApplicationInsights\\Dependency Call Duration",t.EXCEPTION_RATE="\\ApplicationInsights\\Exceptions/Sec"})(Ls=Ue.QuickPulseCounter||(Ue.QuickPulseCounter={}));var b6;(function(t){t.PRIVATE_BYTES="\\Process(??APP_WIN32_PROC??)\\Private Bytes",t.AVAILABLE_BYTES="\\Memory\\Available Bytes",t.PROCESSOR_TIME="\\Processor(_Total)\\% Processor Time",t.PROCESS_TIME="\\Process(??APP_WIN32_PROC??)\\% Processor Time",t.REQUEST_RATE="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Requests/Sec",t.REQUEST_DURATION="\\ASP.NET Applications(??APP_W3SVC_PROC??)\\Request Execution Time"})(b6=Ue.PerformanceCounter||(Ue.PerformanceCounter={}));var oXe;(function(t){t.REQUESTS_DURATION="requests/duration",t.DEPENDENCIES_DURATION="dependencies/duration",t.EXCEPTIONS_COUNT="exceptions/count",t.TRACES_COUNT="traces/count"})(oXe=Ue.MetricId||(Ue.MetricId={}));Ue.PerformanceToQuickPulseCounter=(Nl={},Nl[b6.PROCESSOR_TIME]=Ls.PROCESSOR_TIME,Nl[b6.REQUEST_RATE]=Ls.REQUEST_RATE,Nl[b6.REQUEST_DURATION]=Ls.REQUEST_DURATION,Nl[Ls.COMMITTED_BYTES]=Ls.COMMITTED_BYTES,Nl[Ls.REQUEST_FAILURE_RATE]=Ls.REQUEST_FAILURE_RATE,Nl[Ls.DEPENDENCY_RATE]=Ls.DEPENDENCY_RATE,Nl[Ls.DEPENDENCY_FAILURE_RATE]=Ls.DEPENDENCY_FAILURE_RATE,Nl[Ls.DEPENDENCY_DURATION]=Ls.DEPENDENCY_DURATION,Nl[Ls.EXCEPTION_RATE]=Ls.EXCEPTION_RATE,Nl);Ue.QuickPulseDocumentType={Event:"Event",Exception:"Exception",Trace:"Trace",Metric:"Metric",Request:"Request",Dependency:"RemoteDependency",Availability:"Availability",PageView:"PageView"};Ue.QuickPulseType={Event:"EventTelemetryDocument",Exception:"ExceptionTelemetryDocument",Trace:"TraceTelemetryDocument",Metric:"MetricTelemetryDocument",Request:"RequestTelemetryDocument",Dependency:"DependencyTelemetryDocument",Availability:"AvailabilityTelemetryDocument",PageView:"PageViewTelemetryDocument"};Ue.TelemetryTypeStringToQuickPulseType={EventData:Ue.QuickPulseType.Event,ExceptionData:Ue.QuickPulseType.Exception,MessageData:Ue.QuickPulseType.Trace,MetricData:Ue.QuickPulseType.Metric,RequestData:Ue.QuickPulseType.Request,RemoteDependencyData:Ue.QuickPulseType.Dependency,AvailabilityData:Ue.QuickPulseType.Availability,PageViewData:Ue.QuickPulseType.PageView};Ue.TelemetryTypeStringToQuickPulseDocumentType={EventData:Ue.QuickPulseDocumentType.Event,ExceptionData:Ue.QuickPulseDocumentType.Exception,MessageData:Ue.QuickPulseDocumentType.Trace,MetricData:Ue.QuickPulseDocumentType.Metric,RequestData:Ue.QuickPulseDocumentType.Request,RemoteDependencyData:Ue.QuickPulseDocumentType.Dependency,AvailabilityData:Ue.QuickPulseDocumentType.Availability,PageViewData:Ue.QuickPulseDocumentType.PageView};Ue.DependencyTypeName={Grpc:"GRPC",Http:"HTTP",InProc:"InProc",Sql:"SQL",QueueMessage:"Queue Message"};Ue.HeartBeatMetricName="HeartbeatState";Ue.StatsbeatTelemetryName="Statsbeat";Ue.StatsbeatResourceProvider={appsvc:"appsvc",aks:"aks",functions:"functions",vm:"vm",unknown:"unknown"};Ue.StatsbeatAttach={codeless:"codeless",sdk:"sdk"};Ue.StatsbeatCounter={REQUEST_SUCCESS:"Request Success Count",REQUEST_FAILURE:"Request Failure Count",REQUEST_DURATION:"Request Duration",RETRY_COUNT:"Retry Count",THROTTLE_COUNT:"Throttle Count",EXCEPTION_COUNT:"Exception Count",ATTACH:"Attach",FEATURE:"Feature"};var sXe;(function(t){t[t.NONE=0]="NONE",t[t.DISK_RETRY=1]="DISK_RETRY",t[t.AAD_HANDLING=2]="AAD_HANDLING",t[t.WEB_SNIPPET=4]="WEB_SNIPPET"})(sXe=Ue.StatsbeatFeature||(Ue.StatsbeatFeature={}));var aXe;(function(t){t[t.NONE=0]="NONE",t[t.AZURE_CORE_TRACING=1]="AZURE_CORE_TRACING",t[t.MONGODB=2]="MONGODB",t[t.MYSQL=4]="MYSQL",t[t.REDIS=8]="REDIS",t[t.POSTGRES=16]="POSTGRES",t[t.BUNYAN=32]="BUNYAN",t[t.WINSTON=64]="WINSTON",t[t.CONSOLE=128]="CONSOLE"})(aXe=Ue.StatsbeatInstrumentation||(Ue.StatsbeatInstrumentation={}));var cXe;(function(t){t[t.Feature=0]="Feature",t[t.Instrumentation=1]="Instrumentation"})(cXe=Ue.StatsbeatFeatureType||(Ue.StatsbeatFeatureType={}));var uXe;(function(t){t[t.Breeze=0]="Breeze",t[t.Quickpulse=1]="Quickpulse"})(uXe=Ue.StatsbeatNetworkCategory||(Ue.StatsbeatNetworkCategory={}));var lXe;(function(t){t.SESSION="ai_session",t.USER="ai_user",t.AUTH_USER="ai_authUser"})(lXe=Ue.HttpRequestCookieNames||(Ue.HttpRequestCookieNames={}));Ue.AzNamespace="az.namespace";Ue.MicrosoftEventHub="Microsoft.EventHub";Ue.MessageBusDestination="message_bus.destination";Ue.ENQUEUED_TIME="enqueuedTime";Ue.TIME_SINCE_ENQUEUED="timeSinceEnqueued";Ue.WEB_INSTRUMENTATION_DEFAULT_SOURCE="https://js.monitor.azure.com/scripts/b/ai";Ue.WEB_INSTRUMENTATION_DEPRECATED_SOURCE="https://az416426.vo.msecnd.net/scripts/b/ai"});var dK=M((lK,Oxe)=>{"use strict";var dXe=lK&&lK.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),_6=require("url"),pXe=Ns(),cK=us(),Ac=HI(),fXe=aK(),Bg=Yy(),mXe=zW(),uK=v6(),hXe=Hn(),x6=ri(),gXe=function(t){dXe(e,t);function e(r,n){var o=t.call(this)||this;return r&&(o.method=r.method,o.url=o._getAbsoluteUrl(r),o.startTime=+new Date,o.socketRemoteAddress=r.socket&&r.socket.remoteAddress,o.parseHeaders(r,n),r.connection&&(o.connectionRemoteAddress=r.connection.remoteAddress,o.legacySocketRemoteAddress=r.connection.socket&&r.connection.socket.remoteAddress)),o}return e.prototype.onError=function(r,n){this._setStatus(void 0,r),n&&(this.duration=n)},e.prototype.onResponse=function(r,n){this._setStatus(r.statusCode,void 0),n&&(this.duration=n)},e.prototype.getRequestTelemetry=function(r){var n=this.method;try{n+=" "+new _6.URL(this.url).pathname}catch{}var o={id:this.requestId,name:n,url:this.url,source:this.sourceCorrelationId,duration:this.duration,resultCode:this.statusCode?this.statusCode.toString():null,success:this._isSuccess(),properties:this.properties};if(r&&r.time?o.time=r.time:this.startTime&&(o.time=new Date(this.startTime)),r){for(var s in r)o[s]||(o[s]=r[s]);if(r.properties)for(var s in r.properties)o.properties[s]=r.properties[s]}return o},e.prototype.getRequestTags=function(r){var n={};for(var o in r)n[o]=r[o];return n[e.keys.locationIp]=r[e.keys.locationIp]||this._getIp(),n[e.keys.sessionId]=r[e.keys.sessionId]||this._getId(x6.HttpRequestCookieNames.SESSION),n[e.keys.userId]=r[e.keys.userId]||this._getId(x6.HttpRequestCookieNames.USER),n[e.keys.userAuthUserId]=r[e.keys.userAuthUserId]||this._getId(x6.HttpRequestCookieNames.AUTH_USER),n[e.keys.operationName]=this.getOperationName(r),n[e.keys.operationParentId]=this.getOperationParentId(r),n[e.keys.operationId]=this.getOperationId(r),n},e.prototype.getOperationId=function(r){return r[e.keys.operationId]||this.operationId},e.prototype.getOperationParentId=function(r){return r[e.keys.operationParentId]||this.parentId||this.getOperationId(r)},e.prototype.getOperationName=function(r){if(r[e.keys.operationName])return r[e.keys.operationName];var n="";try{n=new _6.URL(this.url).pathname}catch{}var o=this.method;return n&&(o+=" "+n),o},e.prototype.getRequestId=function(){return this.requestId},e.prototype.getCorrelationContextHeader=function(){return this.correlationContextHeader},e.prototype.getTraceparent=function(){return this.traceparent},e.prototype.getTracestate=function(){return this.tracestate},e.prototype.getLegacyRootId=function(){return this.legacyRootId},e.prototype._getAbsoluteUrl=function(r){if(!r.headers)return r.url;var n=r.connection?r.connection.encrypted:null,o=n||r.headers["x-forwarded-proto"]=="https"?"https":"http",s=o+"://"+r.headers.host+"/",a="",c="";try{var u=new _6.URL(r.url,s);a=u.pathname,c=u.search}catch{}var l=_6.format({protocol:o,host:r.headers.host,pathname:a,search:c});return l},e.prototype._getIp=function(){var r=/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/,n=function(s){var a=r.exec(s);if(a)return a[0]},o=n(this.rawHeaders["x-forwarded-for"])||n(this.rawHeaders["x-client-ip"])||n(this.rawHeaders["x-real-ip"])||n(this.connectionRemoteAddress)||n(this.socketRemoteAddress)||n(this.legacySocketRemoteAddress);return!o&&this.connectionRemoteAddress&&this.connectionRemoteAddress.substr&&this.connectionRemoteAddress.substr(0,2)==="::"&&(o="127.0.0.1"),o},e.prototype._getId=function(r){var n=this.rawHeaders&&this.rawHeaders.cookie&&typeof this.rawHeaders.cookie=="string"&&this.rawHeaders.cookie||"";if(r===x6.HttpRequestCookieNames.AUTH_USER)try{n=decodeURI(n)}catch(s){n="",hXe.warn("Could not decode the auth cookie with error: ",cK.dumpObj(s))}var o=e.parseId(cK.getCookie(r,n));return o},e.prototype.setBackCompatFromThisTraceContext=function(){this.operationId=this.traceparent.traceId,this.traceparent.legacyRootId&&(this.legacyRootId=this.traceparent.legacyRootId),this.parentId=this.traceparent.parentId,this.traceparent.updateSpanId(),this.requestId=this.traceparent.getBackCompatRequestId()},e.prototype.parseHeaders=function(r,n){if(this.rawHeaders=r.headers||r.rawHeaders,this.userAgent=r.headers&&r.headers["user-agent"],this.sourceCorrelationId=cK.getCorrelationContextTarget(r,Ac.requestContextSourceKey),r.headers){var o=r.headers[Ac.traceStateHeader]?r.headers[Ac.traceStateHeader].toString():null,s=r.headers[Ac.traceparentHeader]?r.headers[Ac.traceparentHeader].toString():null,a=r.headers[Ac.requestIdHeader]?r.headers[Ac.requestIdHeader].toString():null,c=r.headers[Ac.parentIdHeader]?r.headers[Ac.parentIdHeader].toString():null,u=r.headers[Ac.rootIdHeader]?r.headers[Ac.rootIdHeader].toString():null;this.correlationContextHeader=r.headers[Ac.correlationContextHeader]?r.headers[Ac.correlationContextHeader].toString():null,Bg.w3cEnabled&&(s||o)?(this.traceparent=new uK(s?s.toString():null),this.tracestate=s&&o&&new mXe(o?o.toString():null),this.setBackCompatFromThisTraceContext()):a?Bg.w3cEnabled?(this.traceparent=new uK(null,a),this.setBackCompatFromThisTraceContext()):(this.parentId=a,this.requestId=Bg.generateRequestId(this.parentId),this.operationId=Bg.getRootId(this.requestId)):Bg.w3cEnabled?(this.traceparent=new uK,this.traceparent.parentId=c,this.traceparent.legacyRootId=u||c,this.setBackCompatFromThisTraceContext()):(this.parentId=c,this.requestId=Bg.generateRequestId(u||this.parentId),this.correlationContextHeader=null,this.operationId=Bg.getRootId(this.requestId)),n&&(this.requestId=n,this.operationId=Bg.getRootId(this.requestId))}},e.parseId=function(r){var n=r.split("|");return n.length>0?n[0]:""},e.keys=new pXe.ContextTagKeys,e}(fXe);Oxe.exports=gXe});var Jxe=M((qt,Xxe)=>{qt=Xxe.exports=Er;var ln;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?ln=function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("SEMVER"),console.log.apply(console,t)}:ln=function(){};qt.SEMVER_SPEC_VERSION="2.0.0";var Xk=256,S6=Number.MAX_SAFE_INTEGER||9007199254740991,pK=16,vXe=Xk-6,Jk=qt.re=[],Rn=qt.safeRe=[],we=qt.src=[],Sr=0,vK="[a-zA-Z0-9-]",fK=[["\\s",1],["\\d",Xk],[vK,vXe]];function R6(t){for(var e=0;e<fK.length;e++){var r=fK[e][0],n=fK[e][1];t=t.split(r+"*").join(r+"{0,"+n+"}").split(r+"+").join(r+"{1,"+n+"}")}return t}var GI=Sr++;we[GI]="0|[1-9]\\d*";var zI=Sr++;we[zI]="\\d+";var yK=Sr++;we[yK]="\\d*[a-zA-Z-]"+vK+"*";var Fxe=Sr++;we[Fxe]="("+we[GI]+")\\.("+we[GI]+")\\.("+we[GI]+")";var Uxe=Sr++;we[Uxe]="("+we[zI]+")\\.("+we[zI]+")\\.("+we[zI]+")";var mK=Sr++;we[mK]="(?:"+we[GI]+"|"+we[yK]+")";var hK=Sr++;we[hK]="(?:"+we[zI]+"|"+we[yK]+")";var bK=Sr++;we[bK]="(?:-("+we[mK]+"(?:\\."+we[mK]+")*))";var _K=Sr++;we[_K]="(?:-?("+we[hK]+"(?:\\."+we[hK]+")*))";var gK=Sr++;we[gK]=vK+"+";var e2=Sr++;we[e2]="(?:\\+("+we[gK]+"(?:\\."+we[gK]+")*))";var xK=Sr++,Bxe="v?"+we[Fxe]+we[bK]+"?"+we[e2]+"?";we[xK]="^"+Bxe+"$";var SK="[v=\\s]*"+we[Uxe]+we[_K]+"?"+we[e2]+"?",IK=Sr++;we[IK]="^"+SK+"$";var QI=Sr++;we[QI]="((?:<|>)?=?)";var I6=Sr++;we[I6]=we[zI]+"|x|X|\\*";var C6=Sr++;we[C6]=we[GI]+"|x|X|\\*";var Xy=Sr++;we[Xy]="[v=\\s]*("+we[C6]+")(?:\\.("+we[C6]+")(?:\\.("+we[C6]+")(?:"+we[bK]+")?"+we[e2]+"?)?)?";var WI=Sr++;we[WI]="[v=\\s]*("+we[I6]+")(?:\\.("+we[I6]+")(?:\\.("+we[I6]+")(?:"+we[_K]+")?"+we[e2]+"?)?)?";var qxe=Sr++;we[qxe]="^"+we[QI]+"\\s*"+we[Xy]+"$";var Hxe=Sr++;we[Hxe]="^"+we[QI]+"\\s*"+we[WI]+"$";var jxe=Sr++;we[jxe]="(?:^|[^\\d])(\\d{1,"+pK+"})(?:\\.(\\d{1,"+pK+"}))?(?:\\.(\\d{1,"+pK+"}))?(?:$|[^\\d])";var k6=Sr++;we[k6]="(?:~>?)";var KI=Sr++;we[KI]="(\\s*)"+we[k6]+"\\s+";Jk[KI]=new RegExp(we[KI],"g");Rn[KI]=new RegExp(R6(we[KI]),"g");var yXe="$1~",Vxe=Sr++;we[Vxe]="^"+we[k6]+we[Xy]+"$";var Gxe=Sr++;we[Gxe]="^"+we[k6]+we[WI]+"$";var P6=Sr++;we[P6]="(?:\\^)";var YI=Sr++;we[YI]="(\\s*)"+we[P6]+"\\s+";Jk[YI]=new RegExp(we[YI],"g");Rn[YI]=new RegExp(R6(we[YI]),"g");var bXe="$1^",zxe=Sr++;we[zxe]="^"+we[P6]+we[Xy]+"$";var $xe=Sr++;we[$xe]="^"+we[P6]+we[WI]+"$";var CK=Sr++;we[CK]="^"+we[QI]+"\\s*("+SK+")$|^$";var EK=Sr++;we[EK]="^"+we[QI]+"\\s*("+Bxe+")$|^$";var Jy=Sr++;we[Jy]="(\\s*)"+we[QI]+"\\s*("+SK+"|"+we[Xy]+")";Jk[Jy]=new RegExp(we[Jy],"g");Rn[Jy]=new RegExp(R6(we[Jy]),"g");var _Xe="$1$2$3",Wxe=Sr++;we[Wxe]="^\\s*("+we[Xy]+")\\s+-\\s+("+we[Xy]+")\\s*$";var Kxe=Sr++;we[Kxe]="^\\s*("+we[WI]+")\\s+-\\s+("+we[WI]+")\\s*$";var Yxe=Sr++;we[Yxe]="(<|>)?=?\\s*\\*";for(Jd=0;Jd<Sr;Jd++)ln(Jd,we[Jd]),Jk[Jd]||(Jk[Jd]=new RegExp(we[Jd]),Rn[Jd]=new RegExp(R6(we[Jd])));var Jd;qt.parse=Zy;function Zy(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof Er)return t;if(typeof t!="string"||t.length>Xk)return null;var r=e.loose?Rn[IK]:Rn[xK];if(!r.test(t))return null;try{return new Er(t,e)}catch{return null}}qt.valid=xXe;function xXe(t,e){var r=Zy(t,e);return r?r.version:null}qt.clean=SXe;function SXe(t,e){var r=Zy(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null}qt.SemVer=Er;function Er(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof Er){if(t.loose===e.loose)return t;t=t.version}else if(typeof t!="string")throw new TypeError("Invalid Version: "+t);if(t.length>Xk)throw new TypeError("version is longer than "+Xk+" characters");if(!(this instanceof Er))return new Er(t,e);ln("SemVer",t,e),this.options=e,this.loose=!!e.loose;var r=t.trim().match(e.loose?Rn[IK]:Rn[xK]);if(!r)throw new TypeError("Invalid Version: "+t);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>S6||this.major<0)throw new TypeError("Invalid major version");if(this.minor>S6||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>S6||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var o=+n;if(o>=0&&o<S6)return o}return n}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}Er.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};Er.prototype.toString=function(){return this.version};Er.prototype.compare=function(t){return ln("SemVer.compare",this.version,this.options,t),t instanceof Er||(t=new Er(t,this.options)),this.compareMain(t)||this.comparePre(t)};Er.prototype.compareMain=function(t){return t instanceof Er||(t=new Er(t,this.options)),$I(this.major,t.major)||$I(this.minor,t.minor)||$I(this.patch,t.patch)};Er.prototype.comparePre=function(t){if(t instanceof Er||(t=new Er(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var e=0;do{var r=this.prerelease[e],n=t.prerelease[e];if(ln("prerelease compare",e,r,n),r===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(r===n)continue;return $I(r,n)}while(++e)};Er.prototype.inc=function(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+t)}return this.format(),this.raw=this.version,this};qt.inc=IXe;function IXe(t,e,r,n){typeof r=="string"&&(n=r,r=void 0);try{return new Er(t,r).inc(e,n).version}catch{return null}}qt.diff=CXe;function CXe(t,e){if(TK(t,e))return null;var r=Zy(t),n=Zy(e),o="";if(r.prerelease.length||n.prerelease.length){o="pre";var s="prerelease"}for(var a in r)if((a==="major"||a==="minor"||a==="patch")&&r[a]!==n[a])return o+a;return s}qt.compareIdentifiers=$I;var Mxe=/^[0-9]+$/;function $I(t,e){var r=Mxe.test(t),n=Mxe.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1}qt.rcompareIdentifiers=EXe;function EXe(t,e){return $I(e,t)}qt.major=TXe;function TXe(t,e){return new Er(t,e).major}qt.minor=wXe;function wXe(t,e){return new Er(t,e).minor}qt.patch=RXe;function RXe(t,e){return new Er(t,e).patch}qt.compare=Wf;function Wf(t,e,r){return new Er(t,r).compare(new Er(e,r))}qt.compareLoose=kXe;function kXe(t,e){return Wf(t,e,!0)}qt.rcompare=PXe;function PXe(t,e,r){return Wf(e,t,r)}qt.sort=AXe;function AXe(t,e){return t.sort(function(r,n){return qt.compare(r,n,e)})}qt.rsort=DXe;function DXe(t,e){return t.sort(function(r,n){return qt.rcompare(r,n,e)})}qt.gt=Zk;function Zk(t,e,r){return Wf(t,e,r)>0}qt.lt=E6;function E6(t,e,r){return Wf(t,e,r)<0}qt.eq=TK;function TK(t,e,r){return Wf(t,e,r)===0}qt.neq=Qxe;function Qxe(t,e,r){return Wf(t,e,r)!==0}qt.gte=wK;function wK(t,e,r){return Wf(t,e,r)>=0}qt.lte=RK;function RK(t,e,r){return Wf(t,e,r)<=0}qt.cmp=T6;function T6(t,e,r,n){switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return TK(t,r,n);case"!=":return Qxe(t,r,n);case">":return Zk(t,r,n);case">=":return wK(t,r,n);case"<":return E6(t,r,n);case"<=":return RK(t,r,n);default:throw new TypeError("Invalid operator: "+e)}}qt.Comparator=Au;function Au(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof Au){if(t.loose===!!e.loose)return t;t=t.value}if(!(this instanceof Au))return new Au(t,e);t=t.trim().split(/\s+/).join(" "),ln("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.semver===t2?this.value="":this.value=this.operator+this.semver.version,ln("comp",this)}var t2={};Au.prototype.parse=function(t){var e=this.options.loose?Rn[CK]:Rn[EK],r=t.match(e);if(!r)throw new TypeError("Invalid comparator: "+t);this.operator=r[1],this.operator==="="&&(this.operator=""),r[2]?this.semver=new Er(r[2],this.options.loose):this.semver=t2};Au.prototype.toString=function(){return this.value};Au.prototype.test=function(t){return ln("Comparator.test",t,this.options.loose),this.semver===t2?!0:(typeof t=="string"&&(t=new Er(t,this.options)),T6(t,this.operator,this.semver,this.options))};Au.prototype.intersects=function(t,e){if(!(t instanceof Au))throw new TypeError("a Comparator is required");(!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1});var r;if(this.operator==="")return r=new ni(t.value,e),w6(this.value,r,e);if(t.operator==="")return r=new ni(this.value,e),w6(t.semver,r,e);var n=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),o=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),s=this.semver.version===t.semver.version,a=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),c=T6(this.semver,"<",t.semver,e)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),u=T6(this.semver,">",t.semver,e)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return n||o||s&&a||c||u};qt.Range=ni;function ni(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof ni)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new ni(t.raw,e);if(t instanceof Au)return new ni(t.value,e);if(!(this instanceof ni))return new ni(t,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(r){return this.parseRange(r.trim())},this).filter(function(r){return r.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}ni.prototype.format=function(){return this.range=this.set.map(function(t){return t.join(" ").trim()}).join("||").trim(),this.range};ni.prototype.toString=function(){return this.range};ni.prototype.parseRange=function(t){var e=this.options.loose,r=e?Rn[Kxe]:Rn[Wxe];t=t.replace(r,jXe),ln("hyphen replace",t),t=t.replace(Rn[Jy],_Xe),ln("comparator trim",t,Rn[Jy]),t=t.replace(Rn[KI],yXe),t=t.replace(Rn[YI],bXe);var n=e?Rn[CK]:Rn[EK],o=t.split(" ").map(function(s){return LXe(s,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(o=o.filter(function(s){return!!s.match(n)})),o=o.map(function(s){return new Au(s,this.options)},this),o};ni.prototype.intersects=function(t,e){if(!(t instanceof ni))throw new TypeError("a Range is required");return this.set.some(function(r){return r.every(function(n){return t.set.some(function(o){return o.every(function(s){return n.intersects(s,e)})})})})};qt.toComparators=NXe;function NXe(t,e){return new ni(t,e).set.map(function(r){return r.map(function(n){return n.value}).join(" ").trim().split(" ")})}function LXe(t,e){return ln("comp",t,e),t=FXe(t,e),ln("caret",t),t=OXe(t,e),ln("tildes",t),t=BXe(t,e),ln("xrange",t),t=HXe(t,e),ln("stars",t),t}function fa(t){return!t||t.toLowerCase()==="x"||t==="*"}function OXe(t,e){return t.trim().split(/\s+/).map(function(r){return MXe(r,e)}).join(" ")}function MXe(t,e){var r=e.loose?Rn[Gxe]:Rn[Vxe];return t.replace(r,function(n,o,s,a,c){ln("tilde",t,n,o,s,a,c);var u;return fa(o)?u="":fa(s)?u=">="+o+".0.0 <"+(+o+1)+".0.0":fa(a)?u=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0":c?(ln("replaceTilde pr",c),u=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+(+s+1)+".0"):u=">="+o+"."+s+"."+a+" <"+o+"."+(+s+1)+".0",ln("tilde return",u),u})}function FXe(t,e){return t.trim().split(/\s+/).map(function(r){return UXe(r,e)}).join(" ")}function UXe(t,e){ln("caret",t,e);var r=e.loose?Rn[$xe]:Rn[zxe];return t.replace(r,function(n,o,s,a,c){ln("caret",t,n,o,s,a,c);var u;return fa(o)?u="":fa(s)?u=">="+o+".0.0 <"+(+o+1)+".0.0":fa(a)?o==="0"?u=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0":u=">="+o+"."+s+".0 <"+(+o+1)+".0.0":c?(ln("replaceCaret pr",c),o==="0"?s==="0"?u=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+s+"."+(+a+1):u=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+(+s+1)+".0":u=">="+o+"."+s+"."+a+"-"+c+" <"+(+o+1)+".0.0"):(ln("no pr"),o==="0"?s==="0"?u=">="+o+"."+s+"."+a+" <"+o+"."+s+"."+(+a+1):u=">="+o+"."+s+"."+a+" <"+o+"."+(+s+1)+".0":u=">="+o+"."+s+"."+a+" <"+(+o+1)+".0.0"),ln("caret return",u),u})}function BXe(t,e){return ln("replaceXRanges",t,e),t.split(/\s+/).map(function(r){return qXe(r,e)}).join(" ")}function qXe(t,e){t=t.trim();var r=e.loose?Rn[Hxe]:Rn[qxe];return t.replace(r,function(n,o,s,a,c,u){ln("xRange",t,n,o,s,a,c,u);var l=fa(s),d=l||fa(a),p=d||fa(c),f=p;return o==="="&&f&&(o=""),l?o===">"||o==="<"?n="<0.0.0":n="*":o&&f?(d&&(a=0),c=0,o===">"?(o=">=",d?(s=+s+1,a=0,c=0):(a=+a+1,c=0)):o==="<="&&(o="<",d?s=+s+1:a=+a+1),n=o+s+"."+a+"."+c):d?n=">="+s+".0.0 <"+(+s+1)+".0.0":p&&(n=">="+s+"."+a+".0 <"+s+"."+(+a+1)+".0"),ln("xRange return",n),n})}function HXe(t,e){return ln("replaceStars",t,e),t.trim().replace(Rn[Yxe],"")}function jXe(t,e,r,n,o,s,a,c,u,l,d,p,f){return fa(r)?e="":fa(n)?e=">="+r+".0.0":fa(o)?e=">="+r+"."+n+".0":e=">="+e,fa(u)?c="":fa(l)?c="<"+(+u+1)+".0.0":fa(d)?c="<"+u+"."+(+l+1)+".0":p?c="<="+u+"."+l+"."+d+"-"+p:c="<="+c,(e+" "+c).trim()}ni.prototype.test=function(t){if(!t)return!1;typeof t=="string"&&(t=new Er(t,this.options));for(var e=0;e<this.set.length;e++)if(VXe(this.set[e],t,this.options))return!0;return!1};function VXe(t,e,r){for(var n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(n=0;n<t.length;n++)if(ln(t[n].semver),t[n].semver!==t2&&t[n].semver.prerelease.length>0){var o=t[n].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}qt.satisfies=w6;function w6(t,e,r){try{e=new ni(e,r)}catch{return!1}return e.test(t)}qt.maxSatisfying=GXe;function GXe(t,e,r){var n=null,o=null;try{var s=new ni(e,r)}catch{return null}return t.forEach(function(a){s.test(a)&&(!n||o.compare(a)===-1)&&(n=a,o=new Er(n,r))}),n}qt.minSatisfying=zXe;function zXe(t,e,r){var n=null,o=null;try{var s=new ni(e,r)}catch{return null}return t.forEach(function(a){s.test(a)&&(!n||o.compare(a)===1)&&(n=a,o=new Er(n,r))}),n}qt.minVersion=$Xe;function $Xe(t,e){t=new ni(t,e);var r=new Er("0.0.0");if(t.test(r)||(r=new Er("0.0.0-0"),t.test(r)))return r;r=null;for(var n=0;n<t.set.length;++n){var o=t.set[n];o.forEach(function(s){var a=new Er(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!r||Zk(r,a))&&(r=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+s.operator)}})}return r&&t.test(r)?r:null}qt.validRange=WXe;function WXe(t,e){try{return new ni(t,e).range||"*"}catch{return null}}qt.ltr=KXe;function KXe(t,e,r){return kK(t,e,"<",r)}qt.gtr=YXe;function YXe(t,e,r){return kK(t,e,">",r)}qt.outside=kK;function kK(t,e,r,n){t=new Er(t,n),e=new ni(e,n);var o,s,a,c,u;switch(r){case">":o=Zk,s=RK,a=E6,c=">",u=">=";break;case"<":o=E6,s=wK,a=Zk,c="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(w6(t,e,n))return!1;for(var l=0;l<e.set.length;++l){var d=e.set[l],p=null,f=null;if(d.forEach(function(m){m.semver===t2&&(m=new Au(">=0.0.0")),p=p||m,f=f||m,o(m.semver,p.semver,n)?p=m:a(m.semver,f.semver,n)&&(f=m)}),p.operator===c||p.operator===u||(!f.operator||f.operator===c)&&s(t,f.semver))return!1;if(f.operator===u&&a(t,f.semver))return!1}return!0}qt.prerelease=QXe;function QXe(t,e){var r=Zy(t,e);return r&&r.prerelease.length?r.prerelease:null}qt.intersects=XXe;function XXe(t,e,r){return t=new ni(t,r),e=new ni(e,r),t.intersects(e)}qt.coerce=JXe;function JXe(t){if(t instanceof Er)return t;if(typeof t!="string")return null;var e=t.match(Rn[jxe]);return e==null?null:Zy(e[1]+"."+(e[2]||"0")+"."+(e[3]||"0"))}});var A6=M((zyr,t1e)=>{"use strict";function PK(t){return typeof t=="function"}var ma=console.error.bind(console);function r2(t,e,r){var n=!!t[e]&&t.propertyIsEnumerable(e);Object.defineProperty(t,e,{configurable:!0,enumerable:n,writable:!0,value:r})}function n2(t){t&&t.logger&&(PK(t.logger)?ma=t.logger:ma("new logger isn't a function, not replacing"))}function Zxe(t,e,r){if(!t||!t[e]){ma("no original function "+e+" to wrap");return}if(!r){ma("no wrapper function"),ma(new Error().stack);return}if(!PK(t[e])||!PK(r)){ma("original object and wrapper must be functions");return}var n=t[e],o=r(n,e);return r2(o,"__original",n),r2(o,"__unwrap",function(){t[e]===o&&r2(t,e,n)}),r2(o,"__wrapped",!0),r2(t,e,o),o}function ZXe(t,e,r){if(t)Array.isArray(t)||(t=[t]);else{ma("must provide one or more modules to patch"),ma(new Error().stack);return}if(!(e&&Array.isArray(e))){ma("must provide one or more functions to wrap on modules");return}t.forEach(function(n){e.forEach(function(o){Zxe(n,o,r)})})}function e1e(t,e){if(!t||!t[e]){ma("no function to unwrap."),ma(new Error().stack);return}if(!t[e].__unwrap)ma("no original to unwrap to -- has "+e+" already been unwrapped?");else return t[e].__unwrap()}function eJe(t,e){if(t)Array.isArray(t)||(t=[t]);else{ma("must provide one or more modules to patch"),ma(new Error().stack);return}if(!(e&&Array.isArray(e))){ma("must provide one or more functions to unwrap on modules");return}t.forEach(function(r){e.forEach(function(n){e1e(r,n)})})}n2.wrap=Zxe;n2.massWrap=ZXe;n2.unwrap=e1e;n2.massUnwrap=eJe;t1e.exports=n2});var L6=M(($yr,o1e)=>{"use strict";var n1e=A6(),XI=n1e.wrap,D6=n1e.unwrap,Kf="wrap@before";function N6(t,e,r){var n=!!t[e]&&t.propertyIsEnumerable(e);Object.defineProperty(t,e,{configurable:!0,enumerable:n,writable:!0,value:r})}function tJe(t,e){for(var r=e.length,n=0;n<r;n++){var o=e[n],s=t[Kf];if(typeof s=="function")s(o);else if(Array.isArray(s))for(var a=s.length,c=0;c<a;c++)s[c](o)}}function i1e(t,e){var r;return r=t._events&&t._events[e],Array.isArray(r)||(r?r=[r]:r=[]),r}function rJe(t,e,r){var n=i1e(t,e),o=n.filter(function(s){return r.indexOf(s)===-1});o.length>0&&tJe(t,o)}function r1e(t,e){if(t){var r=t;if(typeof t=="function")r=e(t);else if(Array.isArray(t)){r=[];for(var n=0;n<t.length;n++)r[n]=e(t[n])}return r}}o1e.exports=function(e,r,n){if(!e||!e.on||!e.addListener||!e.removeListener||!e.emit)throw new Error("can only wrap real EEs");if(!r)throw new Error("must have function to run on listener addition");if(!n)throw new Error("must have function to wrap listeners when emitting");function o(a){return function(u,l){var d=i1e(this,u).slice();try{var p=a.call(this,u,l);return rJe(this,u,d),p}finally{this.on.__wrapped||XI(this,"on",o),this.addListener.__wrapped||XI(this,"addListener",o)}}}function s(a){return function(u){if(!this._events||!this._events[u])return a.apply(this,arguments);var l=this._events[u];function d(p){return function(){this._events[u]=l;try{return p.apply(this,arguments)}finally{l=this._events[u],this._events[u]=r1e(l,n)}}}XI(this,"removeListener",d);try{return this._events[u]=r1e(l,n),a.apply(this,arguments)}finally{D6(this,"removeListener"),this._events[u]=l}}}e[Kf]?typeof e[Kf]=="function"?N6(e,Kf,[e[Kf],r]):Array.isArray(e[Kf])&&e[Kf].push(r):N6(e,Kf,r),e.__wrapped||(XI(e,"addListener",o),XI(e,"on",o),XI(e,"emit",s),N6(e,"__unwrap",function(){D6(e,"addListener"),D6(e,"on"),D6(e,"emit"),delete e[Kf],delete e.__wrapped}),N6(e,"__wrapped",!0))}});var u1e=M((Wyr,c1e)=>{"use strict";var Zr=require("util"),Yf=require("assert"),nJe=L6(),Vn=require("async_hooks"),i2="cls@contexts",o2="error@context",ii=process.env.DEBUG_CLS_HOOKED,Jr=-1;c1e.exports={getNamespace:s1e,createNamespace:iJe,destroyNamespace:a1e,reset:oJe,ERROR_SYMBOL:o2};function Du(t){this.name=t,this.active=null,this._set=[],this.id=null,this._contexts=new Map,this._indent=0}Du.prototype.set=function(e,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");if(this.active[e]=r,ii){let n=" ".repeat(this._indent<0?0:this._indent);Yn(n+"CONTEXT-SET KEY:"+e+"="+r+" in ns:"+this.name+" currentUid:"+Jr+" active:"+Zr.inspect(this.active,{showHidden:!0,depth:2,colors:!0}))}return r};Du.prototype.get=function(e){if(!this.active){if(ii){let r=Vn.currentId(),n=Vn.triggerAsyncId(),o=" ".repeat(this._indent<0?0:this._indent);Yn(`${o}CONTEXT-GETTING KEY NO ACTIVE NS: (${this.name}) ${e}=undefined currentUid:${Jr} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length}`)}return}if(ii){let r=Vn.executionAsyncId(),n=Vn.triggerAsyncId(),o=" ".repeat(this._indent<0?0:this._indent);Yn(o+"CONTEXT-GETTING KEY:"+e+"="+this.active[e]+" ("+this.name+") currentUid:"+Jr+" active:"+Zr.inspect(this.active,{showHidden:!0,depth:2,colors:!0})),Yn(`${o}CONTEXT-GETTING KEY: (${this.name}) ${e}=${this.active[e]} currentUid:${Jr} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} active:${Zr.inspect(this.active)}`)}return this.active[e]};Du.prototype.createContext=function(){let e=Object.create(this.active?this.active:Object.prototype);if(e._ns_name=this.name,e.id=Jr,ii){let r=Vn.executionAsyncId(),n=Vn.triggerAsyncId(),o=" ".repeat(this._indent<0?0:this._indent);Yn(`${o}CONTEXT-CREATED Context: (${this.name}) currentUid:${Jr} asyncHooksCurrentId:${r} triggerId:${n} len:${this._set.length} context:${Zr.inspect(e,{showHidden:!0,depth:2,colors:!0})}`)}return e};Du.prototype.run=function(e){let r=this.createContext();this.enter(r);try{if(ii){let n=Vn.triggerAsyncId(),o=Vn.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);Yn(`${s}CONTEXT-RUN BEGIN: (${this.name}) currentUid:${Jr} triggerId:${n} asyncHooksCurrentId:${o} len:${this._set.length} context:${Zr.inspect(r)}`)}return e(r),r}catch(n){throw n&&(n[o2]=r),n}finally{if(ii){let n=Vn.triggerAsyncId(),o=Vn.executionAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);Yn(`${s}CONTEXT-RUN END: (${this.name}) currentUid:${Jr} triggerId:${n} asyncHooksCurrentId:${o} len:${this._set.length} ${Zr.inspect(r)}`)}this.exit(r)}};Du.prototype.runAndReturn=function(e){let r;return this.run(function(n){r=e(n)}),r};Du.prototype.runPromise=function(e){let r=this.createContext();this.enter(r);let n=e(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return ii&&Yn("CONTEXT-runPromise BEFORE: ("+this.name+") currentUid:"+Jr+" len:"+this._set.length+" "+Zr.inspect(r)),n.then(o=>(ii&&Yn("CONTEXT-runPromise AFTER then: ("+this.name+") currentUid:"+Jr+" len:"+this._set.length+" "+Zr.inspect(r)),this.exit(r),o)).catch(o=>{throw o[o2]=r,ii&&Yn("CONTEXT-runPromise AFTER catch: ("+this.name+") currentUid:"+Jr+" len:"+this._set.length+" "+Zr.inspect(r)),this.exit(r),o})};Du.prototype.bind=function(e,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return e.apply(this,arguments)}catch(s){throw s&&(s[o2]=r),s}finally{n.exit(r)}}};Du.prototype.enter=function(e){if(Yf.ok(e,"context must be provided for entering"),ii){let r=Vn.executionAsyncId(),n=Vn.triggerAsyncId(),o=" ".repeat(this._indent<0?0:this._indent);Yn(`${o}CONTEXT-ENTER: (${this.name}) currentUid:${Jr} triggerId:${n} asyncHooksCurrentId:${r} len:${this._set.length} ${Zr.inspect(e)}`)}this._set.push(this.active),this.active=e};Du.prototype.exit=function(e){if(Yf.ok(e,"context must be provided for exiting"),ii){let n=Vn.executionAsyncId(),o=Vn.triggerAsyncId(),s=" ".repeat(this._indent<0?0:this._indent);Yn(`${s}CONTEXT-EXIT: (${this.name}) currentUid:${Jr} triggerId:${o} asyncHooksCurrentId:${n} len:${this._set.length} ${Zr.inspect(e)}`)}if(this.active===e){Yf.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(e);r<0?(ii&&Yn("??ERROR?? context exiting but not entered - ignoring: "+Zr.inspect(e)),Yf.ok(r>=0,`context not currently entered; can't exit. 
`+Zr.inspect(this)+`
`+Zr.inspect(e))):(Yf.ok(r,"can't remove top context"),this._set.splice(r,1))};Du.prototype.bindEmitter=function(e){Yf.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function o(a){a&&(a[i2]||(a[i2]=Object.create(null)),a[i2][n]={namespace:r,context:r.active})}function s(a){if(!(a&&a[i2]))return a;let c=a,u=a[i2];return Object.keys(u).forEach(function(l){let d=u[l];c=d.namespace.bind(c,d.context)}),c}nJe(e,o,s)};Du.prototype.fromException=function(e){return e[o2]};function s1e(t){return process.namespaces[t]}function iJe(t){Yf.ok(t,"namespace must be given a name."),ii&&Yn(`NS-CREATING NAMESPACE (${t})`);let e=new Du(t);return e.id=Jr,Vn.createHook({init(n,o,s,a){if(Jr=Vn.executionAsyncId(),e.active){if(e._contexts.set(n,e.active),ii){let c=" ".repeat(e._indent<0?0:e._indent);Yn(`${c}INIT [${o}] (${t}) asyncId:${n} currentUid:${Jr} triggerId:${s} active:${Zr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}else if(Jr===0){let c=Vn.triggerAsyncId(),u=e._contexts.get(c);if(u){if(e._contexts.set(n,u),ii){let l=" ".repeat(e._indent<0?0:e._indent);Yn(`${l}INIT USING CONTEXT FROM TRIGGERID [${o}] (${t}) asyncId:${n} currentUid:${Jr} triggerId:${c} active:${Zr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}else if(ii){let l=" ".repeat(e._indent<0?0:e._indent);Yn(`${l}INIT MISSING CONTEXT [${o}] (${t}) asyncId:${n} currentUid:${Jr} triggerId:${c} active:${Zr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}}if(ii&&o==="PROMISE"){Yn(Zr.inspect(a,{showHidden:!0}));let c=a.parentId,u=" ".repeat(e._indent<0?0:e._indent);Yn(`${u}INIT RESOURCE-PROMISE [${o}] (${t}) parentId:${c} asyncId:${n} currentUid:${Jr} triggerId:${s} active:${Zr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} resource:${a}`)}},before(n){Jr=Vn.executionAsyncId();let o;if(o=e._contexts.get(n)||e._contexts.get(Jr),o){if(ii){let s=Vn.triggerAsyncId(),a=" ".repeat(e._indent<0?0:e._indent);Yn(`${a}BEFORE (${t}) asyncId:${n} currentUid:${Jr} triggerId:${s} active:${Zr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${Zr.inspect(o)}`),e._indent+=2}e.enter(o)}else if(ii){let s=Vn.triggerAsyncId(),a=" ".repeat(e._indent<0?0:e._indent);Yn(`${a}BEFORE MISSING CONTEXT (${t}) asyncId:${n} currentUid:${Jr} triggerId:${s} active:${Zr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} namespace._contexts:${Zr.inspect(e._contexts,{showHidden:!0,depth:2,colors:!0})}`),e._indent+=2}},after(n){Jr=Vn.executionAsyncId();let o;if(o=e._contexts.get(n)||e._contexts.get(Jr),o){if(ii){let s=Vn.triggerAsyncId();e._indent-=2;let a=" ".repeat(e._indent<0?0:e._indent);Yn(`${a}AFTER (${t}) asyncId:${n} currentUid:${Jr} triggerId:${s} active:${Zr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${Zr.inspect(o)}`)}e.exit(o)}else if(ii){let s=Vn.triggerAsyncId();e._indent-=2;let a=" ".repeat(e._indent<0?0:e._indent);Yn(`${a}AFTER MISSING CONTEXT (${t}) asyncId:${n} currentUid:${Jr} triggerId:${s} active:${Zr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${Zr.inspect(o)}`)}},destroy(n){if(Jr=Vn.executionAsyncId(),ii){let o=Vn.triggerAsyncId(),s=" ".repeat(e._indent<0?0:e._indent);Yn(`${s}DESTROY (${t}) currentUid:${Jr} asyncId:${n} triggerId:${o} active:${Zr.inspect(e.active,{showHidden:!0,depth:2,colors:!0})} context:${Zr.inspect(e._contexts.get(Jr))}`)}e._contexts.delete(n)}}).enable(),process.namespaces[t]=e,e}function a1e(t){let e=s1e(t);Yf.ok(e,`can't delete nonexistent namespace! "`+t+'"'),Yf.ok(e.id,"don't assign to process.namespaces directly! "+Zr.inspect(e)),process.namespaces[t]=null}function oJe(){process.namespaces&&Object.keys(process.namespaces).forEach(function(t){a1e(t)}),process.namespaces=Object.create(null)}process.namespaces={};function Yn(...t){ii&&process._rawDebug(`${Zr.format(...t)}`)}});var d1e=M((Kyr,l1e)=>{"use strict";function sJe(){}l1e.exports=function(){let e=this._hooks,r=this._state,n=process.nextTick;process.nextTick=function(){if(!r.enabled)return n.apply(process,arguments);let o=new Array(arguments.length);for(let u=0;u<arguments.length;u++)o[u]=arguments[u];let s=o[0];if(typeof s!="function")throw new TypeError("callback is not a function");let a=new sJe,c=--r.counter;return e.init.call(a,c,0,null,null),o[0]=function(){e.pre.call(a,c);let u=!0;try{s.apply(this,arguments),u=!1}finally{u&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){e.post.call(a,c,!0),e.destroy.call(null,c)})}e.post.call(a,c,!1),e.destroy.call(null,c)},n.apply(process,o)}}});var f1e=M((Yyr,p1e)=>{"use strict";function aJe(){}p1e.exports=function(){let e=this._hooks,r=this._state,n=global.Promise,o=n.prototype.then;n.prototype.then=u;function s(l,d,p,f){return typeof l!="function"?f?a(p):c(p):function(){e.pre.call(d,p);try{return l.apply(this,arguments)}finally{e.post.call(d,p,!1),e.destroy.call(null,p)}}}function a(l){return function(p){return e.destroy.call(null,l),p}}function c(l){return function(p){throw e.destroy.call(null,l),p}}function u(l,d){if(!r.enabled)return o.call(this,l,d);let p=new aJe,f=--r.counter;return e.init.call(p,f,0,null,null),o.call(this,s(l,p,f,!0),s(d,p,f,!1))}}});var h1e=M((Qyr,m1e)=>{"use strict";var Dc=require("timers");function cJe(){}function uJe(){}function lJe(){}var dJe=new Map,pJe=new Map,fJe=new Map,AK=null,DK=!1;m1e.exports=function(){NK(this._hooks,this._state,"setTimeout","clearTimeout",cJe,dJe,!0),NK(this._hooks,this._state,"setInterval","clearInterval",uJe,pJe,!1),NK(this._hooks,this._state,"setImmediate","clearImmediate",lJe,fJe,!0),global.setTimeout=Dc.setTimeout,global.setInterval=Dc.setInterval,global.setImmediate=Dc.setImmediate,global.clearTimeout=Dc.clearTimeout,global.clearInterval=Dc.clearInterval,global.clearImmediate=Dc.clearImmediate};function NK(t,e,r,n,o,s,a){let c=Dc[r],u=Dc[n];Dc[r]=function(){if(!e.enabled)return c.apply(Dc,arguments);let l=new Array(arguments.length);for(let h=0;h<arguments.length;h++)l[h]=arguments[h];let d=l[0];if(typeof d!="function")throw new TypeError('"callback" argument must be a function');let p=new o,f=--e.counter,m;return t.init.call(p,f,0,null,null),l[0]=function(){AK=m,t.pre.call(p,f);let h=!0;try{d.apply(this,arguments),h=!1}finally{h&&process.listenerCount("uncaughtException")>0&&process.once("uncaughtException",function(){t.post.call(p,f,!0),s.delete(m),t.destroy.call(null,f)})}t.post.call(p,f,!1),AK=null,(a||DK)&&(DK=!1,s.delete(m),t.destroy.call(null,f))},m=c.apply(Dc,l),s.set(m,f),m},Dc[n]=function(l){if(AK===l&&l!==null)DK=!0;else if(s.has(l)){let d=s.get(l);s.delete(l),t.destroy.call(null,d)}u.apply(Dc,arguments)}}});var y1e=M((Xyr,v1e)=>{"use strict";var a2=process.binding("async_wrap"),mJe=a2.Providers.TIMERWRAP,g1e={nextTick:d1e(),promise:f1e(),timers:h1e()},s2=new Set;function hJe(){this.enabled=!1,this.counter=0}function LK(){let t=this.initFns=[],e=this.preFns=[],r=this.postFns=[],n=this.destroyFns=[];this.init=function(o,s,a,c){if(s===mJe){s2.add(o);return}for(let u of t)u(o,this,s,a,c)},this.pre=function(o){if(!s2.has(o))for(let s of e)s(o,this)},this.post=function(o,s){if(!s2.has(o))for(let a of r)a(o,this,s)},this.destroy=function(o){if(s2.has(o)){s2.delete(o);return}for(let s of n)s(o)}}LK.prototype.add=function(t){t.init&&this.initFns.push(t.init),t.pre&&this.preFns.push(t.pre),t.post&&this.postFns.push(t.post),t.destroy&&this.destroyFns.push(t.destroy)};function O6(t,e){let r=t.indexOf(e);r!==-1&&t.splice(r,1)}LK.prototype.remove=function(t){t.init&&O6(this.initFns,t.init),t.pre&&O6(this.preFns,t.pre),t.post&&O6(this.postFns,t.post),t.destroy&&O6(this.destroyFns,t.destroy)};function c2(){this._state=new hJe,this._hooks=new LK,this.version=require("./package.json").version,this.providers=a2.Providers;for(let t of Object.keys(g1e))g1e[t].call(this);process.env.hasOwnProperty("NODE_ASYNC_HOOK_WARNING")&&console.warn("warning: you are using async-hook-jl which is unstable."),a2.setupHooks({init:this._hooks.init,pre:this._hooks.pre,post:this._hooks.post,destroy:this._hooks.destroy})}v1e.exports=c2;c2.prototype.addHooks=function(t){this._hooks.add(t)};c2.prototype.removeHooks=function(t){this._hooks.remove(t)};c2.prototype.enable=function(){this._state.enabled=!0,a2.enable()};c2.prototype.disable=function(){this._state.enabled=!1,a2.disable()}});var _1e=M((Jyr,b1e)=>{function gJe(t){try{return Error.prototype.toString.call(t)}catch(e){try{return"<error: "+e+">"}catch{return"<error>"}}}b1e.exports=function(e,r){var n=[];n.push(gJe(e));for(var o=0;o<r.length;o++){var s=r[o],a;try{a=s.toString()}catch(c){try{a="<error: "+c+">"}catch{a="<error>"}}n.push("    at "+a)}return n.join(`
`)}});var C1e=M((Zyr,I1e)=>{var M6=_1e();function S1e(){this.extend=new u2,this.filter=new u2,this.format=new l2,this.version=require("./package.json").version}var MK=!1;S1e.prototype.callSite=function t(e){e||(e={}),MK=!0;var r={};Error.captureStackTrace(r,t);var n=r.stack;return MK=!1,n=n.slice(e.slice||0),e.extend&&(n=this.extend._modify(r,n)),e.filter&&(n=this.filter._modify(r,n)),n};var qg=new S1e;function u2(){this._modifiers=[]}u2.prototype._modify=function(t,e){for(var r=0,n=this._modifiers.length;r<n;r++)e=this._modifiers[r](t,e);return e};u2.prototype.attach=function(t){this._modifiers.push(t)};u2.prototype.deattach=function(t){var e=this._modifiers.indexOf(t);return e===-1?!1:(this._modifiers.splice(e,1),!0)};function l2(){this._formater=M6,this._previous=void 0}l2.prototype.replace=function(t){t?this._formater=t:this.restore()};l2.prototype.restore=function(){this._formater=M6,this._previous=void 0};l2.prototype._backup=function(){this._previous=this._formater};l2.prototype._roolback=function(){this._previous===M6?this.replace(void 0):this.replace(this._previous),this._previous=void 0};Error.prepareStackTrace&&qg.format.replace(Error.prepareStackTrace);var OK=!1;function x1e(t,e){if(MK)return e;if(OK)return M6(t,e);var r=e.concat();r=qg.extend._modify(t,r),r=qg.filter._modify(t,r),r=r.slice(0,Error.stackTraceLimit),Object.isExtensible(t)&&Object.getOwnPropertyDescriptor(t,"callSite")===void 0&&(t.callSite={original:e,mutated:r}),OK=!0;var n=qg.format._formater(t,r);return OK=!1,n}Object.defineProperty(Error,"prepareStackTrace",{get:function(){return x1e},set:function(t){t===x1e?qg.format._roolback():(qg.format._backup(),qg.format.replace(t))}});function vJe(){return this.stack,this.callSite}Object.defineProperty(Error.prototype,"callSite",{get:vJe,set:function(t){Object.defineProperty(this,"callSite",{value:t,writable:!0,configurable:!0})},configurable:!0});I1e.exports=qg});var UK=M((ebr,FK)=>{if(global._stackChain)if(global._stackChain.version===require("./package.json").version)FK.exports=global._stackChain;else throw new Error("Conflicting version of stack-chain found");else FK.exports=global._stackChain=C1e()});var E1e=M((tbr,BK)=>{"use strict";var yJe=y1e();if(global._asyncHook)if(global._asyncHook.version===require("./package.json").version)BK.exports=global._asyncHook;else throw new Error("Conflicting version of async-hook-jl found");else UK().filter.attach(function(e,r){return r.filter(function(n){let o=n.getFileName();return!(o&&o.slice(0,__dirname.length)===__dirname)})}),BK.exports=global._asyncHook=new yJe});var A1e=M((rbr,P1e)=>{"use strict";var qi=require("util"),Qf=require("assert"),bJe=L6(),JI=E1e(),d2="cls@contexts",p2="error@context",w1e=[];for(let t in JI.providers)w1e[JI.providers[t]]=t;var Si=process.env.DEBUG_CLS_HOOKED,no=-1;P1e.exports={getNamespace:R1e,createNamespace:_Je,destroyNamespace:k1e,reset:xJe,ERROR_SYMBOL:p2};function Nu(t){this.name=t,this.active=null,this._set=[],this.id=null,this._contexts=new Map}Nu.prototype.set=function(e,r){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return Si&&Bi("    SETTING KEY:"+e+"="+r+" in ns:"+this.name+" uid:"+no+" active:"+qi.inspect(this.active,!0)),this.active[e]=r,r};Nu.prototype.get=function(e){if(!this.active){Si&&Bi("    GETTING KEY:"+e+"=undefined "+this.name+" uid:"+no+" active:"+qi.inspect(this.active,!0));return}return Si&&Bi("    GETTING KEY:"+e+"="+this.active[e]+" "+this.name+" uid:"+no+" active:"+qi.inspect(this.active,!0)),this.active[e]};Nu.prototype.createContext=function(){Si&&Bi("   CREATING Context: "+this.name+" uid:"+no+" len:"+this._set.length+"  active:"+qi.inspect(this.active,!0,2,!0));let e=Object.create(this.active?this.active:Object.prototype);return e._ns_name=this.name,e.id=no,Si&&Bi("   CREATED Context: "+this.name+" uid:"+no+" len:"+this._set.length+"  context:"+qi.inspect(e,!0,2,!0)),e};Nu.prototype.run=function(e){let r=this.createContext();this.enter(r);try{return Si&&Bi(" BEFORE RUN: "+this.name+" uid:"+no+" len:"+this._set.length+" "+qi.inspect(r)),e(r),r}catch(n){throw n&&(n[p2]=r),n}finally{Si&&Bi(" AFTER RUN: "+this.name+" uid:"+no+" len:"+this._set.length+" "+qi.inspect(r)),this.exit(r)}};Nu.prototype.runAndReturn=function(e){var r;return this.run(function(n){r=e(n)}),r};Nu.prototype.runPromise=function(e){let r=this.createContext();this.enter(r);let n=e(r);if(!n||!n.then||!n.catch)throw new Error("fn must return a promise.");return Si&&Bi(" BEFORE runPromise: "+this.name+" uid:"+no+" len:"+this._set.length+" "+qi.inspect(r)),n.then(o=>(Si&&Bi(" AFTER runPromise: "+this.name+" uid:"+no+" len:"+this._set.length+" "+qi.inspect(r)),this.exit(r),o)).catch(o=>{throw o[p2]=r,Si&&Bi(" AFTER runPromise: "+this.name+" uid:"+no+" len:"+this._set.length+" "+qi.inspect(r)),this.exit(r),o})};Nu.prototype.bind=function(e,r){r||(this.active?r=this.active:r=this.createContext());let n=this;return function(){n.enter(r);try{return e.apply(this,arguments)}catch(s){throw s&&(s[p2]=r),s}finally{n.exit(r)}}};Nu.prototype.enter=function(e){Qf.ok(e,"context must be provided for entering"),Si&&Bi("  ENTER "+this.name+" uid:"+no+" len:"+this._set.length+" context: "+qi.inspect(e)),this._set.push(this.active),this.active=e};Nu.prototype.exit=function(e){if(Qf.ok(e,"context must be provided for exiting"),Si&&Bi("  EXIT "+this.name+" uid:"+no+" len:"+this._set.length+" context: "+qi.inspect(e)),this.active===e){Qf.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}let r=this._set.lastIndexOf(e);r<0?(Si&&Bi("??ERROR?? context exiting but not entered - ignoring: "+qi.inspect(e)),Qf.ok(r>=0,`context not currently entered; can't exit. 
`+qi.inspect(this)+`
`+qi.inspect(e))):(Qf.ok(r,"can't remove top context"),this._set.splice(r,1))};Nu.prototype.bindEmitter=function(e){Qf.ok(e.on&&e.addListener&&e.emit,"can only bind real EEs");let r=this,n="context@"+this.name;function o(a){a&&(a[d2]||(a[d2]=Object.create(null)),a[d2][n]={namespace:r,context:r.active})}function s(a){if(!(a&&a[d2]))return a;let c=a,u=a[d2];return Object.keys(u).forEach(function(l){let d=u[l];c=d.namespace.bind(c,d.context)}),c}bJe(e,o,s)};Nu.prototype.fromException=function(e){return e[p2]};function R1e(t){return process.namespaces[t]}function _Je(t){Qf.ok(t,"namespace must be given a name."),Si&&Bi("CREATING NAMESPACE "+t);let e=new Nu(t);return e.id=no,JI.addHooks({init(r,n,o,s,a){no=r,s?(e._contexts.set(r,e._contexts.get(s)),Si&&Bi("PARENTID: "+t+" uid:"+r+" parent:"+s+" provider:"+o)):e._contexts.set(no,e.active),Si&&Bi("INIT "+t+" uid:"+r+" parent:"+s+" provider:"+w1e[o]+" active:"+qi.inspect(e.active,!0))},pre(r,n){no=r;let o=e._contexts.get(r);o?(Si&&Bi(" PRE "+t+" uid:"+r+" handle:"+F6(n)+" context:"+qi.inspect(o)),e.enter(o)):Si&&Bi(" PRE MISSING CONTEXT "+t+" uid:"+r+" handle:"+F6(n))},post(r,n){no=r;let o=e._contexts.get(r);o?(Si&&Bi(" POST "+t+" uid:"+r+" handle:"+F6(n)+" context:"+qi.inspect(o)),e.exit(o)):Si&&Bi(" POST MISSING CONTEXT "+t+" uid:"+r+" handle:"+F6(n))},destroy(r){no=r,Si&&Bi("DESTROY "+t+" uid:"+r+" context:"+qi.inspect(e._contexts.get(no))+" active:"+qi.inspect(e.active,!0)),e._contexts.delete(r)}}),process.namespaces[t]=e,e}function k1e(t){let e=R1e(t);Qf.ok(e,`can't delete nonexistent namespace! "`+t+'"'),Qf.ok(e.id,"don't assign to process.namespaces directly! "+qi.inspect(e)),process.namespaces[t]=null}function xJe(){process.namespaces&&Object.keys(process.namespaces).forEach(function(t){k1e(t)}),process.namespaces=Object.create(null)}process.namespaces={};JI._state&&!JI._state.enabled&&JI.enable();function Bi(t){process.env.DEBUG&&process._rawDebug(t)}function F6(t){if(!t)return t;if(typeof t=="function")return t.name?t.name:(t.toString().trim().match(/^function\s*([^\s(]+)/)||[])[1];if(t.constructor&&t.constructor.name)return t.constructor.name}if(Si){qK=UK();for(T1e in qK.filter._modifiers)qK.filter.deattach(T1e)}var qK,T1e});var D1e=M((nbr,HK)=>{"use strict";var SJe=Jxe();process&&SJe.gte(process.versions.node,"8.0.0")?HK.exports=u1e():HK.exports=A1e()});var Y1e=M((Ht,K1e)=>{Ht=K1e.exports=Tr;var dn;typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?dn=function(){var t=Array.prototype.slice.call(arguments,0);t.unshift("SEMVER"),console.log.apply(console,t)}:dn=function(){};Ht.SEMVER_SPEC_VERSION="2.0.0";var f2=256,U6=Number.MAX_SAFE_INTEGER||9007199254740991,jK=16,IJe=f2-6,m2=Ht.re=[],kn=Ht.safeRe=[],Re=Ht.src=[],Ir=0,WK="[a-zA-Z0-9-]",VK=[["\\s",1],["\\d",f2],[WK,IJe]];function G6(t){for(var e=0;e<VK.length;e++){var r=VK[e][0],n=VK[e][1];t=t.split(r+"*").join(r+"{0,"+n+"}").split(r+"+").join(r+"{1,"+n+"}")}return t}var ZI=Ir++;Re[ZI]="0|[1-9]\\d*";var eC=Ir++;Re[eC]="\\d+";var KK=Ir++;Re[KK]="\\d*[a-zA-Z-]"+WK+"*";var L1e=Ir++;Re[L1e]="("+Re[ZI]+")\\.("+Re[ZI]+")\\.("+Re[ZI]+")";var O1e=Ir++;Re[O1e]="("+Re[eC]+")\\.("+Re[eC]+")\\.("+Re[eC]+")";var GK=Ir++;Re[GK]="(?:"+Re[ZI]+"|"+Re[KK]+")";var zK=Ir++;Re[zK]="(?:"+Re[eC]+"|"+Re[KK]+")";var YK=Ir++;Re[YK]="(?:-("+Re[GK]+"(?:\\."+Re[GK]+")*))";var QK=Ir++;Re[QK]="(?:-?("+Re[zK]+"(?:\\."+Re[zK]+")*))";var $K=Ir++;Re[$K]=WK+"+";var g2=Ir++;Re[g2]="(?:\\+("+Re[$K]+"(?:\\."+Re[$K]+")*))";var XK=Ir++,M1e="v?"+Re[L1e]+Re[YK]+"?"+Re[g2]+"?";Re[XK]="^"+M1e+"$";var JK="[v=\\s]*"+Re[O1e]+Re[QK]+"?"+Re[g2]+"?",ZK=Ir++;Re[ZK]="^"+JK+"$";var oC=Ir++;Re[oC]="((?:<|>)?=?)";var B6=Ir++;Re[B6]=Re[eC]+"|x|X|\\*";var q6=Ir++;Re[q6]=Re[ZI]+"|x|X|\\*";var eb=Ir++;Re[eb]="[v=\\s]*("+Re[q6]+")(?:\\.("+Re[q6]+")(?:\\.("+Re[q6]+")(?:"+Re[YK]+")?"+Re[g2]+"?)?)?";var rC=Ir++;Re[rC]="[v=\\s]*("+Re[B6]+")(?:\\.("+Re[B6]+")(?:\\.("+Re[B6]+")(?:"+Re[QK]+")?"+Re[g2]+"?)?)?";var F1e=Ir++;Re[F1e]="^"+Re[oC]+"\\s*"+Re[eb]+"$";var U1e=Ir++;Re[U1e]="^"+Re[oC]+"\\s*"+Re[rC]+"$";var B1e=Ir++;Re[B1e]="(?:^|[^\\d])(\\d{1,"+jK+"})(?:\\.(\\d{1,"+jK+"}))?(?:\\.(\\d{1,"+jK+"}))?(?:$|[^\\d])";var z6=Ir++;Re[z6]="(?:~>?)";var nC=Ir++;Re[nC]="(\\s*)"+Re[z6]+"\\s+";m2[nC]=new RegExp(Re[nC],"g");kn[nC]=new RegExp(G6(Re[nC]),"g");var CJe="$1~",q1e=Ir++;Re[q1e]="^"+Re[z6]+Re[eb]+"$";var H1e=Ir++;Re[H1e]="^"+Re[z6]+Re[rC]+"$";var $6=Ir++;Re[$6]="(?:\\^)";var iC=Ir++;Re[iC]="(\\s*)"+Re[$6]+"\\s+";m2[iC]=new RegExp(Re[iC],"g");kn[iC]=new RegExp(G6(Re[iC]),"g");var EJe="$1^",j1e=Ir++;Re[j1e]="^"+Re[$6]+Re[eb]+"$";var V1e=Ir++;Re[V1e]="^"+Re[$6]+Re[rC]+"$";var eY=Ir++;Re[eY]="^"+Re[oC]+"\\s*("+JK+")$|^$";var tY=Ir++;Re[tY]="^"+Re[oC]+"\\s*("+M1e+")$|^$";var tb=Ir++;Re[tb]="(\\s*)"+Re[oC]+"\\s*("+JK+"|"+Re[eb]+")";m2[tb]=new RegExp(Re[tb],"g");kn[tb]=new RegExp(G6(Re[tb]),"g");var TJe="$1$2$3",G1e=Ir++;Re[G1e]="^\\s*("+Re[eb]+")\\s+-\\s+("+Re[eb]+")\\s*$";var z1e=Ir++;Re[z1e]="^\\s*("+Re[rC]+")\\s+-\\s+("+Re[rC]+")\\s*$";var $1e=Ir++;Re[$1e]="(<|>)?=?\\s*\\*";for(Zd=0;Zd<Ir;Zd++)dn(Zd,Re[Zd]),m2[Zd]||(m2[Zd]=new RegExp(Re[Zd]),kn[Zd]=new RegExp(G6(Re[Zd])));var Zd;Ht.parse=rb;function rb(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof Tr)return t;if(typeof t!="string"||t.length>f2)return null;var r=e.loose?kn[ZK]:kn[XK];if(!r.test(t))return null;try{return new Tr(t,e)}catch{return null}}Ht.valid=wJe;function wJe(t,e){var r=rb(t,e);return r?r.version:null}Ht.clean=RJe;function RJe(t,e){var r=rb(t.trim().replace(/^[=v]+/,""),e);return r?r.version:null}Ht.SemVer=Tr;function Tr(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof Tr){if(t.loose===e.loose)return t;t=t.version}else if(typeof t!="string")throw new TypeError("Invalid Version: "+t);if(t.length>f2)throw new TypeError("version is longer than "+f2+" characters");if(!(this instanceof Tr))return new Tr(t,e);dn("SemVer",t,e),this.options=e,this.loose=!!e.loose;var r=t.trim().match(e.loose?kn[ZK]:kn[XK]);if(!r)throw new TypeError("Invalid Version: "+t);if(this.raw=t,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>U6||this.major<0)throw new TypeError("Invalid major version");if(this.minor>U6||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>U6||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(function(n){if(/^[0-9]+$/.test(n)){var o=+n;if(o>=0&&o<U6)return o}return n}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}Tr.prototype.format=function(){return this.version=this.major+"."+this.minor+"."+this.patch,this.prerelease.length&&(this.version+="-"+this.prerelease.join(".")),this.version};Tr.prototype.toString=function(){return this.version};Tr.prototype.compare=function(t){return dn("SemVer.compare",this.version,this.options,t),t instanceof Tr||(t=new Tr(t,this.options)),this.compareMain(t)||this.comparePre(t)};Tr.prototype.compareMain=function(t){return t instanceof Tr||(t=new Tr(t,this.options)),tC(this.major,t.major)||tC(this.minor,t.minor)||tC(this.patch,t.patch)};Tr.prototype.comparePre=function(t){if(t instanceof Tr||(t=new Tr(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;var e=0;do{var r=this.prerelease[e],n=t.prerelease[e];if(dn("prerelease compare",e,r,n),r===void 0&&n===void 0)return 0;if(n===void 0)return 1;if(r===void 0)return-1;if(r===n)continue;return tC(r,n)}while(++e)};Tr.prototype.inc=function(t,e){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e),this.inc("pre",e);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",e),this.inc("pre",e);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":if(this.prerelease.length===0)this.prerelease=[0];else{for(var r=this.prerelease.length;--r>=0;)typeof this.prerelease[r]=="number"&&(this.prerelease[r]++,r=-2);r===-1&&this.prerelease.push(0)}e&&(this.prerelease[0]===e?isNaN(this.prerelease[1])&&(this.prerelease=[e,0]):this.prerelease=[e,0]);break;default:throw new Error("invalid increment argument: "+t)}return this.format(),this.raw=this.version,this};Ht.inc=kJe;function kJe(t,e,r,n){typeof r=="string"&&(n=r,r=void 0);try{return new Tr(t,r).inc(e,n).version}catch{return null}}Ht.diff=PJe;function PJe(t,e){if(rY(t,e))return null;var r=rb(t),n=rb(e),o="";if(r.prerelease.length||n.prerelease.length){o="pre";var s="prerelease"}for(var a in r)if((a==="major"||a==="minor"||a==="patch")&&r[a]!==n[a])return o+a;return s}Ht.compareIdentifiers=tC;var N1e=/^[0-9]+$/;function tC(t,e){var r=N1e.test(t),n=N1e.test(e);return r&&n&&(t=+t,e=+e),t===e?0:r&&!n?-1:n&&!r?1:t<e?-1:1}Ht.rcompareIdentifiers=AJe;function AJe(t,e){return tC(e,t)}Ht.major=DJe;function DJe(t,e){return new Tr(t,e).major}Ht.minor=NJe;function NJe(t,e){return new Tr(t,e).minor}Ht.patch=LJe;function LJe(t,e){return new Tr(t,e).patch}Ht.compare=Xf;function Xf(t,e,r){return new Tr(t,r).compare(new Tr(e,r))}Ht.compareLoose=OJe;function OJe(t,e){return Xf(t,e,!0)}Ht.rcompare=MJe;function MJe(t,e,r){return Xf(e,t,r)}Ht.sort=FJe;function FJe(t,e){return t.sort(function(r,n){return Ht.compare(r,n,e)})}Ht.rsort=UJe;function UJe(t,e){return t.sort(function(r,n){return Ht.rcompare(r,n,e)})}Ht.gt=h2;function h2(t,e,r){return Xf(t,e,r)>0}Ht.lt=H6;function H6(t,e,r){return Xf(t,e,r)<0}Ht.eq=rY;function rY(t,e,r){return Xf(t,e,r)===0}Ht.neq=W1e;function W1e(t,e,r){return Xf(t,e,r)!==0}Ht.gte=nY;function nY(t,e,r){return Xf(t,e,r)>=0}Ht.lte=iY;function iY(t,e,r){return Xf(t,e,r)<=0}Ht.cmp=j6;function j6(t,e,r,n){switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t===r;case"!==":return typeof t=="object"&&(t=t.version),typeof r=="object"&&(r=r.version),t!==r;case"":case"=":case"==":return rY(t,r,n);case"!=":return W1e(t,r,n);case">":return h2(t,r,n);case">=":return nY(t,r,n);case"<":return H6(t,r,n);case"<=":return iY(t,r,n);default:throw new TypeError("Invalid operator: "+e)}}Ht.Comparator=Lu;function Lu(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof Lu){if(t.loose===!!e.loose)return t;t=t.value}if(!(this instanceof Lu))return new Lu(t,e);t=t.trim().split(/\s+/).join(" "),dn("comparator",t,e),this.options=e,this.loose=!!e.loose,this.parse(t),this.semver===v2?this.value="":this.value=this.operator+this.semver.version,dn("comp",this)}var v2={};Lu.prototype.parse=function(t){var e=this.options.loose?kn[eY]:kn[tY],r=t.match(e);if(!r)throw new TypeError("Invalid comparator: "+t);this.operator=r[1],this.operator==="="&&(this.operator=""),r[2]?this.semver=new Tr(r[2],this.options.loose):this.semver=v2};Lu.prototype.toString=function(){return this.value};Lu.prototype.test=function(t){return dn("Comparator.test",t,this.options.loose),this.semver===v2?!0:(typeof t=="string"&&(t=new Tr(t,this.options)),j6(t,this.operator,this.semver,this.options))};Lu.prototype.intersects=function(t,e){if(!(t instanceof Lu))throw new TypeError("a Comparator is required");(!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1});var r;if(this.operator==="")return r=new oi(t.value,e),V6(this.value,r,e);if(t.operator==="")return r=new oi(this.value,e),V6(t.semver,r,e);var n=(this.operator===">="||this.operator===">")&&(t.operator===">="||t.operator===">"),o=(this.operator==="<="||this.operator==="<")&&(t.operator==="<="||t.operator==="<"),s=this.semver.version===t.semver.version,a=(this.operator===">="||this.operator==="<=")&&(t.operator===">="||t.operator==="<="),c=j6(this.semver,"<",t.semver,e)&&(this.operator===">="||this.operator===">")&&(t.operator==="<="||t.operator==="<"),u=j6(this.semver,">",t.semver,e)&&(this.operator==="<="||this.operator==="<")&&(t.operator===">="||t.operator===">");return n||o||s&&a||c||u};Ht.Range=oi;function oi(t,e){if((!e||typeof e!="object")&&(e={loose:!!e,includePrerelease:!1}),t instanceof oi)return t.loose===!!e.loose&&t.includePrerelease===!!e.includePrerelease?t:new oi(t.raw,e);if(t instanceof Lu)return new oi(t.value,e);if(!(this instanceof oi))return new oi(t,e);if(this.options=e,this.loose=!!e.loose,this.includePrerelease=!!e.includePrerelease,this.raw=t.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(function(r){return this.parseRange(r.trim())},this).filter(function(r){return r.length}),!this.set.length)throw new TypeError("Invalid SemVer Range: "+this.raw);this.format()}oi.prototype.format=function(){return this.range=this.set.map(function(t){return t.join(" ").trim()}).join("||").trim(),this.range};oi.prototype.toString=function(){return this.range};oi.prototype.parseRange=function(t){var e=this.options.loose,r=e?kn[z1e]:kn[G1e];t=t.replace(r,KJe),dn("hyphen replace",t),t=t.replace(kn[tb],TJe),dn("comparator trim",t,kn[tb]),t=t.replace(kn[nC],CJe),t=t.replace(kn[iC],EJe);var n=e?kn[eY]:kn[tY],o=t.split(" ").map(function(s){return qJe(s,this.options)},this).join(" ").split(/\s+/);return this.options.loose&&(o=o.filter(function(s){return!!s.match(n)})),o=o.map(function(s){return new Lu(s,this.options)},this),o};oi.prototype.intersects=function(t,e){if(!(t instanceof oi))throw new TypeError("a Range is required");return this.set.some(function(r){return r.every(function(n){return t.set.some(function(o){return o.every(function(s){return n.intersects(s,e)})})})})};Ht.toComparators=BJe;function BJe(t,e){return new oi(t,e).set.map(function(r){return r.map(function(n){return n.value}).join(" ").trim().split(" ")})}function qJe(t,e){return dn("comp",t,e),t=VJe(t,e),dn("caret",t),t=HJe(t,e),dn("tildes",t),t=zJe(t,e),dn("xrange",t),t=WJe(t,e),dn("stars",t),t}function ha(t){return!t||t.toLowerCase()==="x"||t==="*"}function HJe(t,e){return t.trim().split(/\s+/).map(function(r){return jJe(r,e)}).join(" ")}function jJe(t,e){var r=e.loose?kn[H1e]:kn[q1e];return t.replace(r,function(n,o,s,a,c){dn("tilde",t,n,o,s,a,c);var u;return ha(o)?u="":ha(s)?u=">="+o+".0.0 <"+(+o+1)+".0.0":ha(a)?u=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0":c?(dn("replaceTilde pr",c),u=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+(+s+1)+".0"):u=">="+o+"."+s+"."+a+" <"+o+"."+(+s+1)+".0",dn("tilde return",u),u})}function VJe(t,e){return t.trim().split(/\s+/).map(function(r){return GJe(r,e)}).join(" ")}function GJe(t,e){dn("caret",t,e);var r=e.loose?kn[V1e]:kn[j1e];return t.replace(r,function(n,o,s,a,c){dn("caret",t,n,o,s,a,c);var u;return ha(o)?u="":ha(s)?u=">="+o+".0.0 <"+(+o+1)+".0.0":ha(a)?o==="0"?u=">="+o+"."+s+".0 <"+o+"."+(+s+1)+".0":u=">="+o+"."+s+".0 <"+(+o+1)+".0.0":c?(dn("replaceCaret pr",c),o==="0"?s==="0"?u=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+s+"."+(+a+1):u=">="+o+"."+s+"."+a+"-"+c+" <"+o+"."+(+s+1)+".0":u=">="+o+"."+s+"."+a+"-"+c+" <"+(+o+1)+".0.0"):(dn("no pr"),o==="0"?s==="0"?u=">="+o+"."+s+"."+a+" <"+o+"."+s+"."+(+a+1):u=">="+o+"."+s+"."+a+" <"+o+"."+(+s+1)+".0":u=">="+o+"."+s+"."+a+" <"+(+o+1)+".0.0"),dn("caret return",u),u})}function zJe(t,e){return dn("replaceXRanges",t,e),t.split(/\s+/).map(function(r){return $Je(r,e)}).join(" ")}function $Je(t,e){t=t.trim();var r=e.loose?kn[U1e]:kn[F1e];return t.replace(r,function(n,o,s,a,c,u){dn("xRange",t,n,o,s,a,c,u);var l=ha(s),d=l||ha(a),p=d||ha(c),f=p;return o==="="&&f&&(o=""),l?o===">"||o==="<"?n="<0.0.0":n="*":o&&f?(d&&(a=0),c=0,o===">"?(o=">=",d?(s=+s+1,a=0,c=0):(a=+a+1,c=0)):o==="<="&&(o="<",d?s=+s+1:a=+a+1),n=o+s+"."+a+"."+c):d?n=">="+s+".0.0 <"+(+s+1)+".0.0":p&&(n=">="+s+"."+a+".0 <"+s+"."+(+a+1)+".0"),dn("xRange return",n),n})}function WJe(t,e){return dn("replaceStars",t,e),t.trim().replace(kn[$1e],"")}function KJe(t,e,r,n,o,s,a,c,u,l,d,p,f){return ha(r)?e="":ha(n)?e=">="+r+".0.0":ha(o)?e=">="+r+"."+n+".0":e=">="+e,ha(u)?c="":ha(l)?c="<"+(+u+1)+".0.0":ha(d)?c="<"+u+"."+(+l+1)+".0":p?c="<="+u+"."+l+"."+d+"-"+p:c="<="+c,(e+" "+c).trim()}oi.prototype.test=function(t){if(!t)return!1;typeof t=="string"&&(t=new Tr(t,this.options));for(var e=0;e<this.set.length;e++)if(YJe(this.set[e],t,this.options))return!0;return!1};function YJe(t,e,r){for(var n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!r.includePrerelease){for(n=0;n<t.length;n++)if(dn(t[n].semver),t[n].semver!==v2&&t[n].semver.prerelease.length>0){var o=t[n].semver;if(o.major===e.major&&o.minor===e.minor&&o.patch===e.patch)return!0}return!1}return!0}Ht.satisfies=V6;function V6(t,e,r){try{e=new oi(e,r)}catch{return!1}return e.test(t)}Ht.maxSatisfying=QJe;function QJe(t,e,r){var n=null,o=null;try{var s=new oi(e,r)}catch{return null}return t.forEach(function(a){s.test(a)&&(!n||o.compare(a)===-1)&&(n=a,o=new Tr(n,r))}),n}Ht.minSatisfying=XJe;function XJe(t,e,r){var n=null,o=null;try{var s=new oi(e,r)}catch{return null}return t.forEach(function(a){s.test(a)&&(!n||o.compare(a)===1)&&(n=a,o=new Tr(n,r))}),n}Ht.minVersion=JJe;function JJe(t,e){t=new oi(t,e);var r=new Tr("0.0.0");if(t.test(r)||(r=new Tr("0.0.0-0"),t.test(r)))return r;r=null;for(var n=0;n<t.set.length;++n){var o=t.set[n];o.forEach(function(s){var a=new Tr(s.semver.version);switch(s.operator){case">":a.prerelease.length===0?a.patch++:a.prerelease.push(0),a.raw=a.format();case"":case">=":(!r||h2(r,a))&&(r=a);break;case"<":case"<=":break;default:throw new Error("Unexpected operation: "+s.operator)}})}return r&&t.test(r)?r:null}Ht.validRange=ZJe;function ZJe(t,e){try{return new oi(t,e).range||"*"}catch{return null}}Ht.ltr=eZe;function eZe(t,e,r){return oY(t,e,"<",r)}Ht.gtr=tZe;function tZe(t,e,r){return oY(t,e,">",r)}Ht.outside=oY;function oY(t,e,r,n){t=new Tr(t,n),e=new oi(e,n);var o,s,a,c,u;switch(r){case">":o=h2,s=iY,a=H6,c=">",u=">=";break;case"<":o=H6,s=nY,a=h2,c="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(V6(t,e,n))return!1;for(var l=0;l<e.set.length;++l){var d=e.set[l],p=null,f=null;if(d.forEach(function(m){m.semver===v2&&(m=new Lu(">=0.0.0")),p=p||m,f=f||m,o(m.semver,p.semver,n)?p=m:a(m.semver,f.semver,n)&&(f=m)}),p.operator===c||p.operator===u||(!f.operator||f.operator===c)&&s(t,f.semver))return!1;if(f.operator===u&&a(t,f.semver))return!1}return!0}Ht.prerelease=rZe;function rZe(t,e){var r=rb(t,e);return r&&r.prerelease.length?r.prerelease:null}Ht.intersects=nZe;function nZe(t,e,r){return t=new oi(t,r),e=new oi(e,r),t.intersects(e)}Ht.coerce=iZe;function iZe(t){if(t instanceof Tr)return t;if(typeof t!="string")return null;var e=t.match(kn[B1e]);return e==null?null:rb(e[1]+"."+(e[2]||"0")+"."+(e[3]||"0"))}});var J1e=M((ibr,X1e)=>{var oZe=A6().wrap,aY=1,cY=2,uY=4,K6=8,_n=[],sZe=0,Os=!1,Hg=[],sC,lY;function dY(t,e){var r=t.length,n=e.length,o=[];if(r===0&&n===0)return o;for(var s=0;s<r;s++)o[s]=t[s];if(n===0)return o;for(var a=0;a<n;a++){var c=!0;for(s=0;s<r;s++)if(t[s].uid===e[a].uid){c=!1;break}c&&o.push(e[a])}return o}process._fatalException?(W6=!1,sC=function(e){var r=_n.length;if(W6||r===0)return!1;var n=!1;W6=!0;for(var o=0;o<r;++o){var s=_n[o];if(s.flags&K6){var a=aC&&aC[s.uid];n=s.error(a,e)||n}}return W6=!1,Hg.length>0&&(_n=Hg.pop()),aC=void 0,n&&!Os},lY=function(e,r,n){var o=[];Os=!0;for(var s=0;s<n;++s){var a=r[s];if(o[a.uid]=a.data,!!(a.flags&aY)){var c=a.create(a.data);c!==void 0&&(o[a.uid]=c)}}return Os=!1,function(){aC=o,Hg.push(_n),_n=dY(r,_n),Os=!0;for(var u=0;u<n;++u)(r[u].flags&cY)>0&&r[u].before(this,o[r[u].uid]);Os=!1;var l=e.apply(this,arguments);for(Os=!0,u=0;u<n;++u)(r[u].flags&uY)>0&&r[u].after(this,o[r[u].uid]);return Os=!1,_n=Hg.pop(),aC=void 0,l}},oZe(process,"_fatalException",function(t){return function(r){return sC(r)||t(r)}})):(sY=!1,sC=function(e){if(sY)throw e;for(var r=!1,n=_n.length,o=0;o<n;++o){var s=_n[o];s.flags&K6&&(r=s.error(null,e)||r)}if(!r&&Os)throw e},lY=function(e,r,n){var o=[];Os=!0;for(var s=0;s<n;++s){var a=r[s];if(o[a.uid]=a.data,!!(a.flags&aY)){var c=a.create(a.data);c!==void 0&&(o[a.uid]=c)}}return Os=!1,function(){var u=!1,l=!1;Hg.push(_n),_n=dY(r,_n),Os=!0;for(var d=0;d<n;++d)(r[d].flags&cY)>0&&r[d].before(this,o[r[d].uid]);Os=!1;var p;try{p=e.apply(this,arguments)}catch(f){u=!0;for(var d=0;d<n;++d)if(_n[d].flags&K6)try{l=_n[d].error(o[r[d].uid],f)||l}catch(h){throw sY=!0,h}if(!l)throw process.removeListener("uncaughtException",sC),process._originalNextTick(function(){process.addListener("uncaughtException",sC)}),f}finally{if(!u||l){for(Os=!0,d=0;d<n;++d)(r[d].flags&uY)>0&&r[d].after(this,o[r[d].uid]);Os=!1}_n=Hg.pop()}return p}},process.addListener("uncaughtException",sC));var W6,aC,sY;function aZe(t,e,r){Os=!0;for(var n=0;n<r;++n){var o=e[n];o.create&&o.create(o.data)}return Os=!1,function(){Hg.push(_n),_n=dY(e,_n);var s=t.apply(this,arguments);return _n=Hg.pop(),s}}function cZe(t){var e=_n.length;if(e===0)return t;for(var r=_n.slice(),n=0;n<e;++n)if(r[n].flags>0)return lY(t,r,e);return aZe(t,r,e)}function ep(t,e){typeof t.create=="function"&&(this.create=t.create,this.flags|=aY),typeof t.before=="function"&&(this.before=t.before,this.flags|=cY),typeof t.after=="function"&&(this.after=t.after,this.flags|=uY),typeof t.error=="function"&&(this.error=t.error,this.flags|=K6),this.uid=++sZe,this.data=e===void 0?null:e}ep.prototype.create=void 0;ep.prototype.before=void 0;ep.prototype.after=void 0;ep.prototype.error=void 0;ep.prototype.data=void 0;ep.prototype.uid=0;ep.prototype.flags=0;function Q1e(t,e){if(typeof t!="object"||!t)throw new TypeError("callbacks argument must be an object");return t instanceof ep?t:new ep(t,e)}function uZe(t,e){var r;t instanceof ep?r=t:r=Q1e(t,e);for(var n=!1,o=0;o<_n.length;o++)if(r===_n[o]){n=!0;break}return n||_n.push(r),r}function lZe(t){for(var e=0;e<_n.length;e++)if(t===_n[e]){_n.splice(e,1);break}}process.createAsyncListener=Q1e;process.addAsyncListener=uZe;process.removeAsyncListener=lZe;X1e.exports=cZe});var eSe=M((sbr,Z1e)=>{"use strict";Z1e.exports=(t,e)=>class extends t{constructor(n){var o,s;super(c);var a=this;try{n.apply(o,s)}catch(u){s[1](u)}return a;function c(u,l){o=this,s=[d,p];function d(f){return e(a,!1),u(f)}function p(f){return e(a,!1),l(f)}}}}});var aSe=M(()=>{"use strict";if(process.addAsyncListener)throw new Error("Don't require polyfill unless needed");var iSe=A6(),Q6=Y1e(),Ha=iSe.wrap,jg=iSe.massWrap,si=J1e(),dZe=require("util"),pZe=Q6.gte(process.version,"6.0.0"),mY=Q6.gte(process.version,"7.0.0"),fZe=Q6.gte(process.version,"8.0.0"),mZe=Q6.gte(process.version,"11.0.0"),tp=require("net");mY&&!tp._normalizeArgs?tp._normalizeArgs=function(t){if(t.length===0)return[{},null];var e=t[0],r={};typeof e=="object"&&e!==null?r=e:bZe(e)?r.path=e:(r.port=e,t.length>1&&typeof t[1]=="string"&&(r.host=t[1]));var n=t[t.length-1];return typeof n!="function"?[r,null]:[r,n]}:!mY&&!tp._normalizeConnectArgs&&(tp._normalizeConnectArgs=function(t){var e={};function r(o){return(o=Number(o))>=0?o:!1}typeof t[0]=="object"&&t[0]!==null?e=t[0]:typeof t[0]=="string"&&r(t[0])===!1?e.path=t[0]:(e.port=t[0],typeof t[1]=="string"&&(e.host=t[1]));var n=t[t.length-1];return typeof n=="function"?[e,n]:[e]});"_setUpListenHandle"in tp.Server.prototype?Ha(tp.Server.prototype,"_setUpListenHandle",tSe):Ha(tp.Server.prototype,"_listen2",tSe);function tSe(t){return function(){this.on("connection",function(e){e._handle&&(e._handle.onread=si(e._handle.onread))});try{return t.apply(this,arguments)}finally{this._handle&&this._handle.onconnection&&(this._handle.onconnection=si(this._handle.onconnection))}}}function oSe(t){if(t&&t._handle){var e=t._handle;e._originalOnread||(e._originalOnread=e.onread),e.onread=si(e._originalOnread)}}Ha(tp.Socket.prototype,"connect",function(t){return function(){var e;fZe&&Array.isArray(arguments[0])&&Object.getOwnPropertySymbols(arguments[0]).length>0?e=arguments[0]:e=mY?tp._normalizeArgs(arguments):tp._normalizeConnectArgs(arguments),e[1]&&(e[1]=si(e[1]));var r=t.apply(this,e);return oSe(this),r}});var hZe=require("http");Ha(hZe.Agent.prototype,"addRequest",function(t){return function(e){var r=e.onSocket;return e.onSocket=si(function(n){return oSe(n),r.apply(this,arguments)}),t.apply(this,arguments)}});var pY=require("child_process");function rSe(t){Array.isArray(t.stdio)&&t.stdio.forEach(function(e){e&&e._handle&&(e._handle.onread=si(e._handle.onread),Ha(e._handle,"close",X6))}),t._handle&&(t._handle.onexit=si(t._handle.onexit))}pY.ChildProcess?Ha(pY.ChildProcess.prototype,"spawn",function(t){return function(){var e=t.apply(this,arguments);return rSe(this),e}}):jg(pY,["execFile","fork","spawn"],function(t){return function(){var e=t.apply(this,arguments);return rSe(e),e}});process._fatalException||(process._originalNextTick=process.nextTick);var vY=[];process._nextDomainTick&&vY.push("_nextDomainTick");process._tickDomainCallback&&vY.push("_tickDomainCallback");jg(process,vY,rp);Ha(process,"nextTick",X6);var yY=["setTimeout","setInterval"];global.setImmediate&&yY.push("setImmediate");var sSe=require("timers"),gZe=global.setTimeout===sSe.setTimeout;jg(sSe,yY,X6);gZe&&jg(global,yY,X6);var hY=require("dns");jg(hY,["lookup","resolve","resolve4","resolve6","resolveCname","resolveMx","resolveNs","resolveTxt","resolveSrv","reverse"],rp);hY.resolveNaptr&&Ha(hY,"resolveNaptr",rp);var ib=require("fs");jg(ib,["watch","rename","truncate","chown","fchown","chmod","fchmod","stat","lstat","fstat","link","symlink","readlink","realpath","unlink","rmdir","mkdir","readdir","close","open","utimes","futimes","fsync","write","read","readFile","writeFile","appendFile","watchFile","unwatchFile","exists"],rp);ib.lchown&&Ha(ib,"lchown",rp);ib.lchmod&&Ha(ib,"lchmod",rp);ib.ftruncate&&Ha(ib,"ftruncate",rp);var y2;try{y2=require("zlib")}catch{}y2&&y2.Deflate&&y2.Deflate.prototype&&(nb=Object.getPrototypeOf(y2.Deflate.prototype),nb._transform?Ha(nb,"_transform",rp):nb.write&&nb.flush&&nb.end&&jg(nb,["write","flush","end"],rp));var nb,gY;try{gY=require("crypto")}catch{}gY&&(fY=["pbkdf2","randomBytes"],mZe||fY.push("pseudoRandomBytes"),jg(gY,fY,rp));var fY,Y6=!!global.Promise&&Promise.toString()==="function Promise() { [native code] }"&&Promise.toString.toString()==="function toString() { [native code] }";Y6&&(nSe=process.addAsyncListener({create:function(){Y6=!1}}),global.Promise.resolve(!0).then(function(){Y6=!1}),process.removeAsyncListener(nSe));var nSe;Y6&&vZe();function vZe(){var t=global.Promise;function e(a){if(!(this instanceof e))return t(a);if(typeof a!="function")return new t(a);var c,u,l=new t(d);l.__proto__=e.prototype;try{a.apply(c,u)}catch(p){u[1](p)}return l;function d(p,f){c=this,u=[m,h];function m(g){return n(l,!1),p(g)}function h(g){return n(l,!1),f(g)}}}if(dZe.inherits(e,t),Ha(t.prototype,"then",s),t.prototype.chain&&Ha(t.prototype,"chain",s),pZe)global.Promise=eSe()(t,n);else{var r=["all","race","reject","resolve","accept","defer"];r.forEach(function(a){typeof t[a]=="function"&&(e[a]=t[a])}),global.Promise=e}function n(a,c){(!a.__asl_wrapper||c)&&(a.__asl_wrapper=si(o))}function o(a,c,u,l){var d;try{return d=c.call(a,u),{returnVal:d,error:!1}}catch(p){return{errorVal:p,error:!0}}finally{d instanceof t?l.__asl_wrapper=function(){var f=d.__asl_wrapper||o;return f.apply(this,arguments)}:n(l,!0)}}function s(a){return function(){var u=this,l=a.apply(u,Array.prototype.map.call(arguments,d));return l.__asl_wrapper=function(f,m,h,g){return u.__asl_wrapper?(u.__asl_wrapper(f,function(){},null,l),l.__asl_wrapper(f,m,h,g)):o(f,m,h,g)},l;function d(p){return typeof p!="function"?p:si(function(f){var m=(u.__asl_wrapper||o)(this,p,f,l);if(m.error)throw m.errorVal;return m.returnVal})}}}}function rp(t){var e=function(){var r,n=arguments.length-1;if(typeof arguments[n]=="function"){r=Array(arguments.length);for(var o=0;o<arguments.length-1;o++)r[o]=arguments[o];r[n]=si(arguments[n])}return t.apply(this,r||arguments)};switch(t.length){case 1:return function(r){return arguments.length!==1?e.apply(this,arguments):(typeof r=="function"&&(r=si(r)),t.call(this,r))};case 2:return function(r,n){return arguments.length!==2?e.apply(this,arguments):(typeof n=="function"&&(n=si(n)),t.call(this,r,n))};case 3:return function(r,n,o){return arguments.length!==3?e.apply(this,arguments):(typeof o=="function"&&(o=si(o)),t.call(this,r,n,o))};case 4:return function(r,n,o,s){return arguments.length!==4?e.apply(this,arguments):(typeof s=="function"&&(s=si(s)),t.call(this,r,n,o,s))};case 5:return function(r,n,o,s,a){return arguments.length!==5?e.apply(this,arguments):(typeof a=="function"&&(a=si(a)),t.call(this,r,n,o,s,a))};case 6:return function(r,n,o,s,a,c){return arguments.length!==6?e.apply(this,arguments):(typeof c=="function"&&(c=si(c)),t.call(this,r,n,o,s,a,c))};default:return e}}function X6(t){var e=function(){var r;if(typeof arguments[0]=="function"){r=Array(arguments.length),r[0]=si(arguments[0]);for(var n=1;n<arguments.length;n++)r[n]=arguments[n]}return t.apply(this,r||arguments)};switch(t.length){case 1:return function(r){return arguments.length!==1?e.apply(this,arguments):(typeof r=="function"&&(r=si(r)),t.call(this,r))};case 2:return function(r,n){return arguments.length!==2?e.apply(this,arguments):(typeof r=="function"&&(r=si(r)),t.call(this,r,n))};case 3:return function(r,n,o){return arguments.length!==3?e.apply(this,arguments):(typeof r=="function"&&(r=si(r)),t.call(this,r,n,o))};case 4:return function(r,n,o,s){return arguments.length!==4?e.apply(this,arguments):(typeof r=="function"&&(r=si(r)),t.call(this,r,n,o,s))};case 5:return function(r,n,o,s,a){return arguments.length!==5?e.apply(this,arguments):(typeof r=="function"&&(r=si(r)),t.call(this,r,n,o,s,a))};case 6:return function(r,n,o,s,a,c){return arguments.length!==6?e.apply(this,arguments):(typeof r=="function"&&(r=si(r)),t.call(this,r,n,o,s,a,c))};default:return e}}function yZe(t){return(t=Number(t))>=0?t:!1}function bZe(t){return typeof t=="string"&&yZe(t)===!1}});var pSe=M((ubr,dSe)=>{"use strict";var Jf=require("assert"),_Ze=L6(),b2="cls@contexts",bY="error@context";process.addAsyncListener||aSe();function Ll(t){this.name=t,this.active=null,this._set=[],this.id=null}Ll.prototype.set=function(t,e){if(!this.active)throw new Error("No context available. ns.run() or ns.bind() must be called first.");return this.active[t]=e,e};Ll.prototype.get=function(t){if(this.active)return this.active[t]};Ll.prototype.createContext=function(){return Object.create(this.active)};Ll.prototype.run=function(t){var e=this.createContext();this.enter(e);try{return t(e),e}catch(r){throw r&&(r[bY]=e),r}finally{this.exit(e)}};Ll.prototype.runAndReturn=function(t){var e;return this.run(function(r){e=t(r)}),e};Ll.prototype.bind=function(t,e){e||(this.active?e=this.active:e=this.createContext());var r=this;return function(){r.enter(e);try{return t.apply(this,arguments)}catch(n){throw n&&(n[bY]=e),n}finally{r.exit(e)}}};Ll.prototype.enter=function(t){Jf.ok(t,"context must be provided for entering"),this._set.push(this.active),this.active=t};Ll.prototype.exit=function(t){if(Jf.ok(t,"context must be provided for exiting"),this.active===t){Jf.ok(this._set.length,"can't remove top context"),this.active=this._set.pop();return}var e=this._set.lastIndexOf(t);Jf.ok(e>=0,"context not currently entered; can't exit"),Jf.ok(e,"can't remove top context"),this._set.splice(e,1)};Ll.prototype.bindEmitter=function(t){Jf.ok(t.on&&t.addListener&&t.emit,"can only bind real EEs");var e=this,r="context@"+this.name;function n(s){s&&(s[b2]||(s[b2]=Object.create(null)),s[b2][r]={namespace:e,context:e.active})}function o(s){if(!(s&&s[b2]))return s;var a=s,c=s[b2];return Object.keys(c).forEach(function(u){var l=c[u];a=l.namespace.bind(a,l.context)}),a}_Ze(t,n,o)};Ll.prototype.fromException=function(t){return t[bY]};function cSe(t){return process.namespaces[t]}function xZe(t){Jf.ok(t,"namespace must be given a name!");var e=new Ll(t);return e.id=process.addAsyncListener({create:function(){return e.active},before:function(r,n){n&&e.enter(n)},after:function(r,n){n&&e.exit(n)},error:function(r){r&&e.exit(r)}}),process.namespaces[t]=e,e}function uSe(t){var e=cSe(t);Jf.ok(e,"can't delete nonexistent namespace!"),Jf.ok(e.id,"don't assign to process.namespaces directly!"),process.removeAsyncListener(e.id),process.namespaces[t]=null}function lSe(){process.namespaces&&Object.keys(process.namespaces).forEach(function(t){uSe(t)}),process.namespaces=Object.create(null)}process.namespaces||lSe();dSe.exports={getNamespace:cSe,createNamespace:xZe,destroyNamespace:uSe,reset:lSe}});var Vg=M(Z6=>{"use strict";Object.defineProperty(Z6,"__esModule",{value:!0});Z6.CorrelationContextManager=void 0;var cC=Hn(),SZe=g6(),ob=v6(),_Y=zW(),fSe=dK(),J6=us(),IZe=function(){function t(){}return t.getCurrentContext=function(){if(!t.enabled)return null;var e=t.session.get(t.CONTEXT_NAME);return e===void 0?null:e},t.generateContextObject=function(e,r,n,o,s,a){return r=r||e,this.enabled?{operation:{name:n,id:e,parentId:r,traceparent:s,tracestate:a},customProperties:new CZe(o)}:null},t.spanToContextObject=function(e,r,n){var o=new ob;return o.traceId=e.traceId,o.spanId=e.spanId,o.traceFlag=ob.formatOpenTelemetryTraceFlags(e.traceFlags)||ob.DEFAULT_TRACE_FLAG,o.parentId=r,t.generateContextObject(o.traceId,o.parentId,n,null,o)},t.runWithContext=function(e,r){var n;if(t.enabled)try{return t.session.bind(r,(n={},n[t.CONTEXT_NAME]=e,n))()}catch(o){cC.warn("Error binding to session context",J6.dumpObj(o))}return r()},t.wrapEmitter=function(e){if(t.enabled)try{t.session.bindEmitter(e)}catch(r){cC.warn("Error binding to session context",J6.dumpObj(r))}},t.wrapCallback=function(e,r){var n;if(t.enabled)try{return t.session.bind(e,r?(n={},n[t.CONTEXT_NAME]=r,n):void 0)}catch(o){cC.warn("Error binding to session context",J6.dumpObj(o))}return e},t.enable=function(e){if(!this.enabled){if(!this.isNodeVersionCompatible()){this.enabled=!1;return}t.hasEverEnabled||(this.forceClsHooked=e,this.hasEverEnabled=!0,typeof this.cls>"u"&&(t.forceClsHooked===!0||t.forceClsHooked===void 0&&t.shouldUseClsHooked()?this.cls=D1e():this.cls=pSe()),t.session=this.cls.createNamespace("AI-CLS-Session"),SZe.registerContextPreservation(function(r){try{return t.session.bind(r)}catch(n){cC.warn("Error binding to session context",J6.dumpObj(n))}})),this.enabled=!0}},t.startOperation=function(e,r){var n=e&&e.traceContext||null,o=e&&e.spanContext?e:null,s=e&&e.traceId?e:null,a=e&&e.headers;if(o)return this.spanToContextObject(o.spanContext(),o.parentSpanId,o.name);if(s)return this.spanToContextObject(s,"|"+s.traceId+"."+s.spanId+".",typeof r=="string"?r:"");var c=typeof r=="string"?r:"";if(n){var u=null,l=null;if(c=n.attributes.OperationName||c,r){var d=r;d.headers&&(d.headers.traceparent?u=new ob(d.headers.traceparent):d.headers["request-id"]&&(u=new ob(null,d.headers["request-id"])),d.headers.tracestate&&(l=new _Y(d.headers.tracestate)))}u||(u=new ob(n.traceParent||n.traceparent)),l||(l=new _Y(n.traceState||n.tracestate));var p=void 0;if(typeof r=="object"){var f=new fSe(r);p=f.getCorrelationContextHeader(),c=f.getOperationName({})}var m=t.generateContextObject(u.traceId,u.parentId,c,p,u,l);return m}if(a){var u=new ob(a.traceparent?a.traceparent.toString():null),l=new _Y(a.tracestate?a.tracestate.toString():null),f=new fSe(e),m=t.generateContextObject(u.traceId,u.parentId,f.getOperationName({}),f.getCorrelationContextHeader(),u,l);return m}return cC.warn("startOperation was called with invalid arguments",arguments),null},t.disable=function(){this.enabled=!1},t.reset=function(){t.hasEverEnabled&&(t.session=null,t.session=this.cls.createNamespace("AI-CLS-Session"))},t.isNodeVersionCompatible=function(){var e=process.versions.node.split(".");return parseInt(e[0])>3||parseInt(e[0])>2&&parseInt(e[1])>2},t.shouldUseClsHooked=function(){var e=process.versions.node.split(".");return parseInt(e[0])>8||parseInt(e[0])>=8&&parseInt(e[1])>=2},t.canUseClsHooked=function(){var e=process.versions.node.split("."),r=parseInt(e[0])>8||parseInt(e[0])>=8&&parseInt(e[1])>=0,n=parseInt(e[0])<8||parseInt(e[0])<=8&&parseInt(e[1])<2,o=parseInt(e[0])>4||parseInt(e[0])>=4&&parseInt(e[1])>=7;return!(r&&n)&&o},t.enabled=!1,t.hasEverEnabled=!1,t.forceClsHooked=void 0,t.CONTEXT_NAME="ApplicationInsights-Context",t}();Z6.CorrelationContextManager=IZe;var CZe=function(){function t(e){this.props=[],this.addHeaderData(e)}return t.prototype.addHeaderData=function(e){var r=e?e.split(", "):[];this.props=r.map(function(n){var o=n.split("=");return{key:o[0],value:o[1]}}).concat(this.props)},t.prototype.serializeToHeader=function(){return this.props.map(function(e){return e.key+"="+e.value}).join(", ")},t.prototype.getProperty=function(e){for(var r=0;r<this.props.length;++r){var n=this.props[r];if(n.key===e)return n.value}},t.prototype.setProperty=function(e,r){if(t.bannedCharacters.test(e)||t.bannedCharacters.test(r)){cC.warn("Correlation context property keys and values must not contain ',' or '='. setProperty was called with key: "+e+" and value: "+r);return}for(var n=0;n<this.props.length;++n){var o=this.props[n];if(o.key===e){o.value=r;return}}this.props.push({key:e,value:r})},t.bannedCharacters=/[,=]/,t}()});var mSe=M(uC=>{"use strict";Object.defineProperty(uC,"__esModule",{value:!0});uC.dispose=uC.enable=void 0;var e8=Ns(),EZe=ri(),t8=xi(),Gg=[],xY=function(t){var e=t.data.message;Gg.forEach(function(r){e instanceof Error&&!r.config.enableLoggerErrorToTrace?r.trackException({exception:e}):e instanceof Error?r.trackTrace({message:e.toString(),severity:t.data.stderr?e8.SeverityLevel.Error:e8.SeverityLevel.Information}):(e.lastIndexOf(`
`)==e.length-1&&(e=e.substring(0,e.length-1)),r.trackTrace({message:e,severity:t.data.stderr?e8.SeverityLevel.Warning:e8.SeverityLevel.Information}))})};function TZe(t,e){if(t){var r=Gg.find(function(n){return n==e});if(r)return;Gg.length===0&&t8.channel.subscribe("console",xY,t8.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(EZe.StatsbeatInstrumentation.CONSOLE)}),Gg.push(e)}else Gg=Gg.filter(function(n){return n!=e}),Gg.length===0&&t8.channel.unsubscribe("console",xY)}uC.enable=TZe;function wZe(){t8.channel.unsubscribe("console",xY),Gg=[]}uC.dispose=wZe});var hSe=M(dC=>{"use strict";Object.defineProperty(dC,"__esModule",{value:!0});dC.dispose=dC.enable=void 0;var lC=Ns(),RZe=ri(),r8=xi(),zg=[],kZe={10:lC.SeverityLevel.Verbose,20:lC.SeverityLevel.Verbose,30:lC.SeverityLevel.Information,40:lC.SeverityLevel.Warning,50:lC.SeverityLevel.Error,60:lC.SeverityLevel.Critical},SY=function(t){var e=t.data.result,r=kZe[t.data.level];zg.forEach(function(n){try{var o=JSON.parse(e);if(o.err){var s=new Error(o.err.message);if(s.name=o.err.name,s.stack=o.err.stack,n.config.enableLoggerErrorToTrace){n.trackTrace({message:e,severity:r});return}n.trackException({exception:s});return}}catch{}n.trackTrace({message:e,severity:r})})};function PZe(t,e){if(t){var r=zg.find(function(n){return n==e});if(r)return;zg.length===0&&r8.channel.subscribe("bunyan",SY,r8.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(RZe.StatsbeatInstrumentation.BUNYAN)}),zg.push(e)}else zg=zg.filter(function(n){return n!=e}),zg.length===0&&r8.channel.unsubscribe("bunyan",SY)}dC.enable=PZe;function AZe(){r8.channel.unsubscribe("bunyan",SY),zg=[]}dC.dispose=AZe});var gSe=M(pC=>{"use strict";Object.defineProperty(pC,"__esModule",{value:!0});pC.dispose=pC.enable=void 0;var DZe=ri(),ps=Ns(),n8=xi(),$g=[],NZe={syslog:function(t){var e={emerg:ps.SeverityLevel.Critical,alert:ps.SeverityLevel.Critical,crit:ps.SeverityLevel.Critical,error:ps.SeverityLevel.Error,warning:ps.SeverityLevel.Warning,notice:ps.SeverityLevel.Information,info:ps.SeverityLevel.Information,debug:ps.SeverityLevel.Verbose};return e[t]===void 0?ps.SeverityLevel.Information:e[t]},npm:function(t){var e={error:ps.SeverityLevel.Error,warn:ps.SeverityLevel.Warning,info:ps.SeverityLevel.Information,verbose:ps.SeverityLevel.Verbose,debug:ps.SeverityLevel.Verbose,silly:ps.SeverityLevel.Verbose};return e[t]===void 0?ps.SeverityLevel.Information:e[t]},unknown:function(t){return ps.SeverityLevel.Information}},IY=function(t){var e=t.data.message,r=NZe[t.data.levelKind](t.data.level);$g.forEach(function(n){e instanceof Error&&!n.config.enableLoggerErrorToTrace?n.trackException({exception:e,properties:t.data.meta}):e instanceof Error?n.trackTrace({message:e.toString(),severity:r,properties:t.data.meta}):n.trackTrace({message:e,severity:r,properties:t.data.meta})})};function LZe(t,e){if(t){var r=$g.find(function(n){return n==e});if(r)return;$g.length===0&&n8.channel.subscribe("winston",IY,n8.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(DZe.StatsbeatInstrumentation.WINSTON)}),$g.push(e)}else $g=$g.filter(function(n){return n!=e}),$g.length===0&&n8.channel.unsubscribe("winston",IY)}pC.enable=LZe;function OZe(){n8.channel.unsubscribe("winston",IY),$g=[]}pC.dispose=OZe});var ySe=M((mbr,vSe)=>{"use strict";var MZe=g6(),FZe=function(){function t(e){if(t.INSTANCE)throw new Error("Console logging adapter tracking should be configured from the applicationInsights object");this._client=e,t.INSTANCE=this}return t.prototype.enable=function(e,r){MZe.IsInitialized&&(mSe().enable(e&&r,this._client),hSe().enable(e,this._client),gSe().enable(e,this._client))},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1,!1)},t._methodNames=["debug","info","log","warn","error"],t}();vSe.exports=FZe});var _Se=M((hbr,bSe)=>{"use strict";var UZe=function(){function t(e){if(t.INSTANCE)throw new Error("Exception tracking should be configured from the applicationInsights object");t.INSTANCE=this,this._client=e;var r=process.versions.node.split(".");t._canUseUncaughtExceptionMonitor=parseInt(r[0])>13||parseInt(r[0])===13&&parseInt(r[1])>=7}return t.prototype.isInitialized=function(){return this._isInitialized},t.prototype.enable=function(e){var r=this;if(e){if(this._isInitialized=!0,!this._exceptionListenerHandle){var n=function(o,s,a){a===void 0&&(a=new Error(t._FALLBACK_ERROR_MESSAGE));var c={exception:a};c.contextObjects={},c.contextObjects.Error=a,r._client.trackException(c),r._client.flush({isAppCrashing:!0}),o&&s&&process.listeners(s).length===1&&(console.error(a),process.exit(1))};t._canUseUncaughtExceptionMonitor?(this._exceptionListenerHandle=n.bind(this,!1,void 0),process.on(t.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle)):(this._exceptionListenerHandle=n.bind(this,!0,t.UNCAUGHT_EXCEPTION_HANDLER_NAME),this._rejectionListenerHandle=n.bind(this,!1,void 0),process.on(t.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.on(t.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle))}}else this._exceptionListenerHandle&&(t._canUseUncaughtExceptionMonitor?process.removeListener(t.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME,this._exceptionListenerHandle):(process.removeListener(t.UNCAUGHT_EXCEPTION_HANDLER_NAME,this._exceptionListenerHandle),process.removeListener(t.UNHANDLED_REJECTION_HANDLER_NAME,this._rejectionListenerHandle)),this._exceptionListenerHandle=void 0,this._rejectionListenerHandle=void 0,delete this._exceptionListenerHandle,delete this._rejectionListenerHandle)},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t.INSTANCE=null,t.UNCAUGHT_EXCEPTION_MONITOR_HANDLER_NAME="uncaughtExceptionMonitor",t.UNCAUGHT_EXCEPTION_HANDLER_NAME="uncaughtException",t.UNHANDLED_REJECTION_HANDLER_NAME="unhandledRejection",t._RETHROW_EXIT_MESSAGE="Application Insights Rethrow Exception Handler",t._FALLBACK_ERROR_MESSAGE="A promise was rejected without providing an error. Application Insights generated this error stack for you.",t._canUseUncaughtExceptionMonitor=!1,t}();bSe.exports=UZe});var o8=M((gbr,xSe)=>{"use strict";var i8=require("os"),Ou=ri(),BZe=function(){function t(e,r,n){r===void 0&&(r=6e4),n===void 0&&(n=!1),this._lastIntervalRequestExecutionTime=0,this._lastIntervalDependencyExecutionTime=0,t.INSTANCE||(t.INSTANCE=this),this._lastRequests={totalRequestCount:0,totalFailedRequestCount:0,time:0},this._lastDependencies={totalDependencyCount:0,totalFailedDependencyCount:0,time:0},this._lastExceptions={totalExceptionCount:0,time:0},this._isInitialized=!1,this._client=e,this._collectionInterval=r,this._enableLiveMetricsCounters=n}return t.prototype.enable=function(e,r){var n=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),e?this._handle||(this._lastCpus=i8.cpus(),this._lastRequests={totalRequestCount:t._totalRequestCount,totalFailedRequestCount:t._totalFailedRequestCount,time:+new Date},this._lastDependencies={totalDependencyCount:t._totalDependencyCount,totalFailedDependencyCount:t._totalFailedDependencyCount,time:+new Date},this._lastExceptions={totalExceptionCount:t._totalExceptionCount,time:+new Date},typeof process.cpuUsage=="function"&&(this._lastAppCpuUsage=process.cpuUsage()),this._lastHrtime=process.hrtime(),this._collectionInterval=r||this._collectionInterval,this._handle=setInterval(function(){return n.trackPerformance()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},t.countRequest=function(e,r){var n;if(t.isEnabled()){if(typeof e=="string")n=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")n=e;else return;t._intervalRequestExecutionTime+=n,r===!1&&t._totalFailedRequestCount++,t._totalRequestCount++}},t.countException=function(){t._totalExceptionCount++},t.countDependency=function(e,r){var n;if(t.isEnabled()){if(typeof e=="string")n=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")n=e;else return;t._intervalDependencyExecutionTime+=n,r===!1&&t._totalFailedDependencyCount++,t._totalDependencyCount++}},t.prototype.isInitialized=function(){return this._isInitialized},t.isEnabled=function(){return t.INSTANCE&&t.INSTANCE._isEnabled},t.prototype.trackPerformance=function(){this._trackCpu(),this._trackMemory(),this._trackNetwork(),this._trackDependencyRate(),this._trackExceptionRate()},t.prototype._trackCpu=function(){var e=i8.cpus();if(e&&e.length&&this._lastCpus&&e.length===this._lastCpus.length){for(var r=0,n=0,o=0,s=0,a=0,c=0;e&&c<e.length;c++){var u=e[c],l=this._lastCpus[c],d="% cpu("+c+") ",p=u.model,f=u.speed,m=u.times,h=l.times,g=m.user-h.user||0;r+=g;var v=m.sys-h.sys||0;n+=v;var y=m.nice-h.nice||0;o+=y;var b=m.idle-h.idle||0;s+=b;var _=m.irq-h.irq||0;a+=_}var S=void 0;if(typeof process.cpuUsage=="function"){var I=process.cpuUsage(),T=process.hrtime(),A=I.user-this._lastAppCpuUsage.user+(I.system-this._lastAppCpuUsage.system)||0;if(typeof this._lastHrtime<"u"&&this._lastHrtime.length===2){var B=(T[0]-this._lastHrtime[0])*1e6+(T[1]-this._lastHrtime[1])/1e3||0;S=100*A/(B*e.length)}this._lastAppCpuUsage=I,this._lastHrtime=T}var j=r+n+o+s+a||1;this._client.trackMetric({name:Ou.PerformanceCounter.PROCESSOR_TIME,value:(j-s)/j*100}),this._client.trackMetric({name:Ou.PerformanceCounter.PROCESS_TIME,value:S||r/j*100})}this._lastCpus=e},t.prototype._trackMemory=function(){var e=i8.freemem(),r=process.memoryUsage().rss,n=i8.totalmem()-e;this._client.trackMetric({name:Ou.PerformanceCounter.PRIVATE_BYTES,value:r}),this._client.trackMetric({name:Ou.PerformanceCounter.AVAILABLE_BYTES,value:e}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:Ou.QuickPulseCounter.COMMITTED_BYTES,value:n})},t.prototype._trackNetwork=function(){var e=this._lastRequests,r={totalRequestCount:t._totalRequestCount,totalFailedRequestCount:t._totalFailedRequestCount,time:+new Date},n=r.totalRequestCount-e.totalRequestCount||0,o=r.totalFailedRequestCount-e.totalFailedRequestCount||0,s=r.time-e.time,a=s/1e3,c=(t._intervalRequestExecutionTime-this._lastIntervalRequestExecutionTime)/n||0;if(this._lastIntervalRequestExecutionTime=t._intervalRequestExecutionTime,s>0){var u=n/a,l=o/a;this._client.trackMetric({name:Ou.PerformanceCounter.REQUEST_RATE,value:u}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:Ou.PerformanceCounter.REQUEST_DURATION,value:c}),this._enableLiveMetricsCounters&&this._client.trackMetric({name:Ou.QuickPulseCounter.REQUEST_FAILURE_RATE,value:l})}this._lastRequests=r},t.prototype._trackDependencyRate=function(){if(this._enableLiveMetricsCounters){var e=this._lastDependencies,r={totalDependencyCount:t._totalDependencyCount,totalFailedDependencyCount:t._totalFailedDependencyCount,time:+new Date},n=r.totalDependencyCount-e.totalDependencyCount||0,o=r.totalFailedDependencyCount-e.totalFailedDependencyCount||0,s=r.time-e.time,a=s/1e3,c=(t._intervalDependencyExecutionTime-this._lastIntervalDependencyExecutionTime)/n||0;if(this._lastIntervalDependencyExecutionTime=t._intervalDependencyExecutionTime,s>0){var u=n/a,l=o/a;this._client.trackMetric({name:Ou.QuickPulseCounter.DEPENDENCY_RATE,value:u}),this._client.trackMetric({name:Ou.QuickPulseCounter.DEPENDENCY_FAILURE_RATE,value:l}),(!this._enableLiveMetricsCounters||n>0)&&this._client.trackMetric({name:Ou.QuickPulseCounter.DEPENDENCY_DURATION,value:c})}this._lastDependencies=r}},t.prototype._trackExceptionRate=function(){if(this._enableLiveMetricsCounters){var e=this._lastExceptions,r={totalExceptionCount:t._totalExceptionCount,time:+new Date},n=r.totalExceptionCount-e.totalExceptionCount||0,o=r.time-e.time,s=o/1e3;if(o>0){var a=n/s;this._client.trackMetric({name:Ou.QuickPulseCounter.EXCEPTION_RATE,value:a})}this._lastExceptions=r}},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t._totalRequestCount=0,t._totalFailedRequestCount=0,t._totalDependencyCount=0,t._totalFailedDependencyCount=0,t._totalExceptionCount=0,t._intervalDependencyExecutionTime=0,t._intervalRequestExecutionTime=0,t}();xSe.exports=BZe});var SSe=M(s8=>{"use strict";Object.defineProperty(s8,"__esModule",{value:!0});s8.AggregatedMetricCounter=void 0;var qZe=function(){function t(e){this.dimensions=e,this.totalCount=0,this.lastTotalCount=0,this.intervalExecutionTime=0,this.lastTime=+new Date,this.lastIntervalExecutionTime=0}return t}();s8.AggregatedMetricCounter=qZe});var ISe=M(a8=>{"use strict";Object.defineProperty(a8,"__esModule",{value:!0});a8.PreaggregatedMetricPropertyNames=void 0;a8.PreaggregatedMetricPropertyNames={cloudRoleInstance:"cloud/roleInstance",cloudRoleName:"cloud/roleName",operationSynthetic:"operation/synthetic",requestSuccess:"Request.Success",requestResultCode:"request/resultCode",dependencyType:"Dependency.Type",dependencyTarget:"dependency/target",dependencySuccess:"Dependency.Success",dependencyResultCode:"dependency/resultCode",traceSeverityLevel:"trace/severityLevel"}});var EY=M((CY,CSe)=>{"use strict";var u8=CY&&CY.__assign||function(){return u8=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},u8.apply(this,arguments)},c8=ri(),HZe=SSe(),jZe=ISe(),VZe=function(){function t(e,r){r===void 0&&(r=6e4),t.INSTANCE||(t.INSTANCE=this),this._isInitialized=!1,t._dependencyCountersCollection=[],t._requestCountersCollection=[],t._exceptionCountersCollection=[],t._traceCountersCollection=[],this._client=e,this._collectionInterval=r}return t.prototype.enable=function(e,r){var n=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),e?this._handle||(this._collectionInterval=r||this._collectionInterval,this._handle=setInterval(function(){return n.trackPreAggregatedMetrics()},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=void 0)},t.countException=function(e){if(t.isEnabled()){var r=t._getAggregatedCounter(e,this._exceptionCountersCollection);r.totalCount++}},t.countTrace=function(e){if(t.isEnabled()){var r=t._getAggregatedCounter(e,this._traceCountersCollection);r.totalCount++}},t.countRequest=function(e,r){if(t.isEnabled()){var n,o=t._getAggregatedCounter(r,this._requestCountersCollection);if(typeof e=="string")n=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")n=e;else return;o.intervalExecutionTime+=n,o.totalCount++}},t.countDependency=function(e,r){if(t.isEnabled()){var n=t._getAggregatedCounter(r,this._dependencyCountersCollection),o;if(typeof e=="string")o=+new Date("1970-01-01T"+e+"Z");else if(typeof e=="number")o=e;else return;n.intervalExecutionTime+=o,n.totalCount++}},t.prototype.isInitialized=function(){return this._isInitialized},t.isEnabled=function(){return t.INSTANCE&&t.INSTANCE._isEnabled},t.prototype.trackPreAggregatedMetrics=function(){this._trackRequestMetrics(),this._trackDependencyMetrics(),this._trackExceptionMetrics(),this._trackTraceMetrics()},t._getAggregatedCounter=function(e,r){for(var n=!1,o=0;o<r.length;o++){if(e===r[o].dimensions)return r[o];if(Object.keys(e).length===Object.keys(r[o].dimensions).length){for(var s in e)if(e[s]!=r[o].dimensions[s]){n=!0;break}if(!n)return r[o];n=!1}}var a=new HZe.AggregatedMetricCounter(e);return r.push(a),a},t.prototype._trackRequestMetrics=function(){for(var e=0;e<t._requestCountersCollection.length;e++){var r=t._requestCountersCollection[e];r.time=+new Date;var n=r.totalCount-r.lastTotalCount||0,o=r.time-r.lastTime,s=(r.intervalExecutionTime-r.lastIntervalExecutionTime)/n||0;r.lastIntervalExecutionTime=r.intervalExecutionTime,o>0&&n>0&&this._trackPreAggregatedMetric({name:"Server response time",dimensions:r.dimensions,value:s,count:n,aggregationInterval:o,metricType:c8.MetricId.REQUESTS_DURATION}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},t.prototype._trackDependencyMetrics=function(){for(var e=0;e<t._dependencyCountersCollection.length;e++){var r=t._dependencyCountersCollection[e];r.time=+new Date;var n=r.totalCount-r.lastTotalCount||0,o=r.time-r.lastTime,s=(r.intervalExecutionTime-r.lastIntervalExecutionTime)/n||0;r.lastIntervalExecutionTime=r.intervalExecutionTime,o>0&&n>0&&this._trackPreAggregatedMetric({name:"Dependency duration",dimensions:r.dimensions,value:s,count:n,aggregationInterval:o,metricType:c8.MetricId.DEPENDENCIES_DURATION}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},t.prototype._trackExceptionMetrics=function(){for(var e=0;e<t._exceptionCountersCollection.length;e++){var r=t._exceptionCountersCollection[e];r.time=+new Date;var n=r.totalCount-r.lastTotalCount||0,o=r.time-r.lastTime;o>0&&n>0&&this._trackPreAggregatedMetric({name:"Exceptions",dimensions:r.dimensions,value:n,count:n,aggregationInterval:o,metricType:c8.MetricId.EXCEPTIONS_COUNT}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},t.prototype._trackTraceMetrics=function(){for(var e=0;e<t._traceCountersCollection.length;e++){var r=t._traceCountersCollection[e];r.time=+new Date;var n=r.totalCount-r.lastTotalCount||0,o=r.time-r.lastTime;o>0&&n>0&&this._trackPreAggregatedMetric({name:"Traces",dimensions:r.dimensions,value:n,count:n,aggregationInterval:o,metricType:c8.MetricId.TRACES_COUNT}),r.lastTotalCount=r.totalCount,r.lastTime=r.time}},t.prototype._trackPreAggregatedMetric=function(e){var r={};for(var n in e.dimensions)r[jZe.PreaggregatedMetricPropertyNames[n]]=e.dimensions[n];r=u8(u8({},r),{"_MS.MetricId":e.metricType,"_MS.AggregationIntervalMs":String(e.aggregationInterval),"_MS.IsAutocollected":"True"});var o={name:e.name,value:e.value,count:e.count,properties:r,kind:"Aggregation"};this._client.trackMetric(o)},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t}();CSe.exports=VZe});var fC=M((bbr,ESe)=>{"use strict";var Zf=require("os"),GZe=require("fs"),zZe=require("path"),$Ze=Ns(),WZe=ri(),KZe=Hn(),YZe=function(){function t(e){this.keys=new $Ze.ContextTagKeys,this.tags={},this._loadApplicationContext(e),this._loadDeviceContext(),this._loadInternalContext()}return t.prototype._loadApplicationContext=function(e){try{if(e=e||zZe.resolve(__dirname,"../../../../package.json"),!t.appVersion[e]){t.appVersion[e]="unknown";var r=JSON.parse(GZe.readFileSync(e,"utf8"));r&&typeof r.version=="string"&&(t.appVersion[e]=r.version)}this.tags[this.keys.applicationVersion]=t.appVersion[e]}catch(n){KZe.info("Failed to read app version: ",n)}},t.prototype._loadDeviceContext=function(){var e=Zf&&Zf.hostname(),r=t.DefaultRoleName;process.env.WEBSITE_SITE_NAME&&(r=process.env.WEBSITE_SITE_NAME),process.env.WEBSITE_INSTANCE_ID&&(e=process.env.WEBSITE_INSTANCE_ID),this.tags[this.keys.deviceId]="",this.tags[this.keys.cloudRoleInstance]=e,this.tags[this.keys.deviceOSVersion]=Zf&&Zf.type()+" "+Zf.release(),this.tags[this.keys.cloudRole]=r,this.tags["ai.device.osArchitecture"]=Zf&&Zf.arch(),this.tags["ai.device.osPlatform"]=Zf&&Zf.platform()},t.prototype._loadInternalContext=function(){t.sdkVersion=WZe.APPLICATION_INSIGHTS_SDK_VERSION,this.tags[this.keys.internalSdkVersion]="node:"+t.sdkVersion},t.DefaultRoleName="Web",t.appVersion={},t.sdkVersion=null,t}();ESe.exports=YZe});var RSe=M((_br,wSe)=>{"use strict";var QZe=require("crypto"),TSe=require("os"),XZe=ri(),JZe=fC(),ZZe=function(){function t(e){this._collectionInterval=9e5,t.INSTANCE||(t.INSTANCE=this),this._isInitialized=!1,this._client=e}return t.prototype.enable=function(e){var r=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),e?this._handle||(this._handle=setInterval(function(){return r.trackHeartBeat(r._client.config,function(){})},this._collectionInterval),this._handle.unref()):this._handle&&(clearInterval(this._handle),this._handle=null)},t.prototype.isInitialized=function(){return this._isInitialized},t.isEnabled=function(){return t.INSTANCE&&t.INSTANCE._isEnabled},t.prototype.trackHeartBeat=function(e,r){var n={},o=JZe.sdkVersion;n.sdkVersion=o,n.osType=TSe.type(),n.osVersion=TSe.release(),this._uniqueProcessId||(this._uniqueProcessId=QZe.randomBytes(16).toString("hex")),n.processSessionId=this._uniqueProcessId,process.env.WEBSITE_SITE_NAME&&(n.appSrv_SiteName=process.env.WEBSITE_SITE_NAME),process.env.WEBSITE_HOME_STAMPNAME&&(n.appSrv_wsStamp=process.env.WEBSITE_HOME_STAMPNAME),process.env.WEBSITE_HOSTNAME&&(n.appSrv_wsHost=process.env.WEBSITE_HOSTNAME),process.env.WEBSITE_OWNER_NAME&&(n.appSrv_wsOwner=process.env.WEBSITE_OWNER_NAME),process.env.WEBSITE_RESOURCE_GROUP&&(n.appSrv_ResourceGroup=process.env.WEBSITE_RESOURCE_GROUP),process.env.WEBSITE_SLOT_NAME&&(n.appSrv_SlotName=process.env.WEBSITE_SLOT_NAME),this._client.trackMetric({name:XZe.HeartBeatMetricName,value:0,properties:n}),r()},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t}();wSe.exports=ZZe});var kSe=M(jt=>{"use strict";Object.defineProperty(jt,"__esModule",{value:!0});jt.isContentTypeHeaderHtml=jt.insertSnippetByIndex=jt.getContentEncodingFromHeaders=jt.isSupportedContentEncoding=jt.findBufferEncodingType=jt.isBufferType=jt.getBrotliDecompressSync=jt.getBrotliDecompressAsync=jt.getBrotliCompressSync=jt.getBrotliCompressAsync=jt.inflateAsync=jt.deflateAsync=jt.gunzipAsync=jt.gzipAsync=jt.isBrotliSupperted=jt.bufferEncodingTypes=jt.contentEncodingMethod=void 0;var d8=require("zlib"),mC=require("util"),l8;(function(t){t.GZIP="gzip",t.DEFLATE="deflate",t.BR="br"})(l8=jt.contentEncodingMethod||(jt.contentEncodingMethod={}));jt.bufferEncodingTypes=["utf8","utf16le","latin1","base64","hex","ascii","binary","ucs2"];var eet=function(){var t=process.versions.node.split(".")[0];return parseInt(t)>=10};jt.isBrotliSupperted=eet;jt.gzipAsync=mC.promisify(d8.gzip);jt.gunzipAsync=mC.promisify(d8.gunzip);jt.deflateAsync=mC.promisify(d8.deflate);jt.inflateAsync=mC.promisify(d8.inflate);var tet=function(t){var e=jt.isBrotliSupperted();return e&&typeof t.brotliCompress=="function"?mC.promisify(t.brotliCompress):null};jt.getBrotliCompressAsync=tet;var ret=function(t){var e=jt.isBrotliSupperted();return e&&typeof t.brotliCompressSync=="function"?t.brotliCompressSync:null};jt.getBrotliCompressSync=ret;var net=function(t){var e=jt.isBrotliSupperted();return e&&typeof t.brotliDecompress=="function"?mC.promisify(t.brotliDecompress):null};jt.getBrotliDecompressAsync=net;var iet=function(t){var e=jt.isBrotliSupperted();return e&&typeof t.brotliDecompressSync=="function"?t.brotliDecompressSync:null};jt.getBrotliDecompressSync=iet;var oet=function(t,e){var r=e||"utf8",n=!1;if(Buffer.isEncoding(r)){var o=Buffer.from(t.toString(r),r);n=o.toJSON().data.toString()===t.toJSON().data.toString()}return n};jt.isBufferType=oet;var set=function(t){var e=null;for(var r in jt.bufferEncodingTypes){var n=jt.bufferEncodingTypes[r];if(Buffer.isEncoding(n)&&jt.isBufferType(t,n)){e=n;break}}return e};jt.findBufferEncodingType=set;var aet=function(t){var e=null;switch(t){case"gzip":e=l8.GZIP;break;case"br":e=l8.BR;break;case"deflate":e=l8.DEFLATE;break;default:}return e};jt.isSupportedContentEncoding=aet;var cet=function(t){var e=[],r=t.getHeader("Content-Encoding");if(!r)return null;if(typeof r=="string"){var n=jt.isSupportedContentEncoding(r);n&&e.push(n)}return e};jt.getContentEncodingFromHeaders=cet;var uet=function(t,e,r){if(t<0)return null;var n=null,o=e.substring(0,t),s=e.substring(t);return n=o+'<script type="text/javascript">'+r+"</script>"+s,n};jt.insertSnippetByIndex=uet;var det=function(t){var e=!1,r=t.getHeader("Content-Type");return r&&(typeof r=="string"?e=r.indexOf("html")>=0:e=r.toString().indexOf("html")>=0),e};jt.isContentTypeHeaderHtml=det});var PSe=M($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.getResourceProvider=$o.getOsPrefix=$o.isFunctionApp=$o.isWebApp=$o.isLinux=$o.isWindows=void 0;var pet=function(){return process.platform==="win32"};$o.isWindows=pet;var fet=function(){return process.platform==="linux"};$o.isLinux=fet;var met=function(){return!!process.env.WEBSITE_SITE_NAME};$o.isWebApp=met;var het=function(){return!!process.env.FUNCTIONS_WORKER_RUNTIME};$o.isFunctionApp=het;var get=function(){return $o.isWindows()?"w":$o.isLinux()?"l":"u"};$o.getOsPrefix=get;var vet=function(){return $o.isWebApp()?"a":$o.isFunctionApp()?"f":"u"};$o.getResourceProvider=vet});var TY=M((Ibr,DSe)=>{"use strict";var ASe=ri(),yet=function(){function t(){}return t.parse=function(e){if(!e)return{};var r=e.split(t._FIELDS_SEPARATOR),n=r.reduce(function(s,a){var c=a.split(t._FIELD_KEY_VALUE_SEPARATOR);if(c.length===2){var u=c[0].toLowerCase(),l=c[1];s[u]=l}return s},{});if(Object.keys(n).length>0){if(n.endpointsuffix){var o=n.location?n.location+".":"";n.ingestionendpoint=n.ingestionendpoint||"https://"+o+"dc."+n.endpointsuffix,n.liveendpoint=n.liveendpoint||"https://"+o+"live."+n.endpointsuffix}n.ingestionendpoint=n.ingestionendpoint||ASe.DEFAULT_BREEZE_ENDPOINT,n.liveendpoint=n.liveendpoint||ASe.DEFAULT_LIVEMETRICS_ENDPOINT}return n},t.isIkeyValid=function(e){if(!e||e=="")return!1;var r="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",n=new RegExp(r);return n.test(e)},t._FIELDS_SEPARATOR=";",t._FIELD_KEY_VALUE_SEPARATOR="=",t}();DSe.exports=yet});var NSe={};mn(NSe,{webSnippet:()=>bet});var bet,LSe=R(()=>{bet=`!function(T,l,y){var S=T.location,k="script",D="instrumentationKey",C="ingestionendpoint",I="disableExceptionTracking",E="ai.device.",b="toLowerCase",w="crossOrigin",N="POST",e="appInsightsSDK",t=y.name||"appInsights";(y.name||T[e])&&(T[e]=t);var n=T[t]||function(d){var g=!1,f=!1,m={initialize:!0,queue:[],sv:"5",version:2,config:d};function v(e,t){var n={},a="Browser";return n[E+"id"]=a[b](),n[E+"type"]=a,n["ai.operation.name"]=S&&S.pathname||"_unknown_",n["ai.internal.sdkVersion"]="javascript:snippet_"+(m.sv||m.version),{time:function(){var e=new Date;function t(e){var t=""+e;return 1===t.length&&(t="0"+t),t}return e.getUTCFullYear()+"-"+t(1+e.getUTCMonth())+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+((e.getUTCMilliseconds()/1e3).toFixed(3)+"").slice(2,5)+"Z"}(),iKey:e,name:"Microsoft.ApplicationInsights."+e.replace(/-/g,"")+"."+t,sampleRate:100,tags:n,data:{baseData:{ver:2}}}}var h=d.url||y.src;if(h){function a(e){var t,n,a,i,r,o,s,c,u,p,l;g=!0,m.queue=[],f||(f=!0,t=h,s=function(){var e={},t=d.connectionString;if(t)for(var n=t.split(";"),a=0;a<n.length;a++){var i=n[a].split("=");2===i.length&&(e[i[0][b]()]=i[1])}if(!e[C]){var r=e.endpointsuffix,o=r?e.location:null;e[C]="https://"+(o?o+".":"")+"dc."+(r||"services.visualstudio.com")}return e}(),c=s[D]||d[D]||"",u=s[C],p=u?u+"/v2/track":d.endpointUrl,(l=[]).push((n="SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details)",a=t,i=p,(o=(r=v(c,"Exception")).data).baseType="ExceptionData",o.baseData.exceptions=[{typeName:"SDKLoadFailed",message:n.replace(/\\./g,"-"),hasFullStack:!1,stack:n+"\\nSnippet failed to load ["+a+"] -- Telemetry is disabled\\nHelp Link: https://go.microsoft.com/fwlink/?linkid=2128109\\nHost: "+(S&&S.pathname||"_unknown_")+"\\nEndpoint: "+i,parsedStack:[]}],r)),l.push(function(e,t,n,a){var i=v(c,"Message"),r=i.data;r.baseType="MessageData";var o=r.baseData;return o.message='AI (Internal): 99 message:"'+("SDK LOAD Failure: Failed to load Application Insights SDK script (See stack for details) ("+n+")").replace(/\\"/g,"")+'"',o.properties={endpoint:a},i}(0,0,t,p)),function(e,t){if(JSON){var n=T.fetch;if(n&&!y.useXhr)n(t,{method:N,body:JSON.stringify(e),mode:"cors"});else if(XMLHttpRequest){var a=new XMLHttpRequest;a.open(N,t),a.setRequestHeader("Content-type","application/json"),a.send(JSON.stringify(e))}}}(l,p))}function i(e,t){f||setTimeout(function(){!t&&m.core||a()},500)}var e=function(){var n=l.createElement(k);n.src=h;var e=y[w];return!e&&""!==e||"undefined"==n[w]||(n[w]=e),n.onload=i,n.onerror=a,n.onreadystatechange=function(e,t){"loaded"!==n.readyState&&"complete"!==n.readyState||i(0,t)},n}();y.ld<0?l.getElementsByTagName("head")[0].appendChild(e):setTimeout(function(){l.getElementsByTagName(k)[0].parentNode.appendChild(e)},y.ld||0)}try{m.cookie=l.cookie}catch(p){}function t(e){for(;e.length;)!function(t){m[t]=function(){var e=arguments;g||m.queue.push(function(){m[t].apply(m,e)})}}(e.pop())}var n="track",r="TrackPage",o="TrackEvent";t([n+"Event",n+"PageView",n+"Exception",n+"Trace",n+"DependencyData",n+"Metric",n+"PageViewPerformance","start"+r,"stop"+r,"start"+o,"stop"+o,"addTelemetryInitializer","setAuthenticatedUserContext","clearAuthenticatedUserContext","flush"]),m.SeverityLevel={Verbose:0,Information:1,Warning:2,Error:3,Critical:4};var s=(d.extensionConfig||{}).ApplicationInsightsAnalytics||{};if(!0!==d[I]&&!0!==s[I]){var c="onerror";t(["_"+c]);var u=T[c];T[c]=function(e,t,n,a,i){var r=u&&u(e,t,n,a,i);return!0!==r&&m["_"+c]({message:e,url:t,lineNumber:n,columnNumber:a,error:i}),r},d.autoExceptionInstrumented=!0}return m}(y.cfg);function a(){y.onInit&&y.onInit(n)}(T[t]=n).queue&&0===n.queue.length?(n.queue.push(a),n.trackPageView({})):a()}(window,document,{\r
src: "https://js.monitor.azure.com/scripts/b/ai.2.min.js", // The SDK URL Source\r
// name: "appInsights", // Global SDK Instance name defaults to "appInsights" when not supplied\r
// ld: 0, // Defines the load delay (in ms) before attempting to load the sdk. -1 = block page load and add to head. (default) = 0ms load after timeout,\r
// useXhr: 1, // Use XHR instead of fetch to report failures (if available),\r
// crossOrigin: "anonymous", // When supplied this will add the provided value as the cross origin attribute on the script tag\r
// onInit: null, // Once the application insights instance has loaded and initialized this callback function will be called with 1 argument -- the sdk instance (DO NOT ADD anything to the sdk.queue -- As they won't get called)\r
cfg: { // Application Insights Configuration\r
    instrumentationKey: "INSTRUMENTATION_KEY"\r
}});`});var qSe=M((Cbr,BSe)=>{"use strict";var OSe=require("http"),MSe=require("https"),hC=require("zlib"),np=Hn(),Mu=kSe(),FSe=PSe(),_2=ri(),USe=TY(),_et=(LSe(),$i(NSe)),xet=function(){function t(e){var r;if(this._isIkeyValid=!0,t.INSTANCE)throw new Error("Web snippet injection should be configured from the applicationInsights object");t.INSTANCE=this,t._aiUrl=_2.WEB_INSTRUMENTATION_DEFAULT_SOURCE,t._aiDeprecatedUrl=_2.WEB_INSTRUMENTATION_DEPRECATED_SOURCE;var n=this._getWebSnippetIkey((r=e.config)===null||r===void 0?void 0:r.webInstrumentationConnectionString);this._webInstrumentationIkey=n||e.config.instrumentationKey,this._clientWebInstrumentationConfig=e.config.webInstrumentationConfig,this._clientWebInstrumentationSrc=e.config.webInstrumentationSrc,this._statsbeat=e.getStatsbeat()}return t.prototype.enable=function(e,r){this._isEnabled=e,this._webInstrumentationIkey=this._getWebSnippetIkey(r)||this._webInstrumentationIkey,t._snippet=this._getWebInstrumentationReplacedStr(),this._isEnabled&&!this._isInitialized&&this._isIkeyValid?(this._statsbeat&&this._statsbeat.addFeature(_2.StatsbeatFeature.WEB_SNIPPET),this._initialize()):this._isEnabled||this._statsbeat&&this._statsbeat.removeFeature(_2.StatsbeatFeature.WEB_SNIPPET)},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype._getWebSnippetIkey=function(e){var r=null;try{var n=USe.parse(e),o=n.instrumentationkey||"";USe.isIkeyValid(o)?(this._isIkeyValid=!0,r=o):(this._isIkeyValid=!1,np.info("Invalid web Instrumentation connection string, web Instrumentation is not enabled."))}catch(s){np.info("get web snippet ikey error: "+s)}return r},t.prototype._getWebInstrumentationReplacedStr=function(){var e=this._getClientWebInstrumentationConfigStr(this._clientWebInstrumentationConfig),r=FSe.getOsPrefix(),n=FSe.getResourceProvider(),o=this._webInstrumentationIkey+`",\r
`+e+` disableIkeyDeprecationMessage: true,\r
 sdkExtension: "`+n+r+"d_n_",s=_et.webSnippet.replace("INSTRUMENTATION_KEY",o);return this._clientWebInstrumentationSrc?s.replace(_2.WEB_INSTRUMENTATION_DEFAULT_SOURCE+".2.min.js",this._clientWebInstrumentationSrc):s},t.prototype._getClientWebInstrumentationConfigStr=function(e){var r="";try{e!=null&&e.length>0&&e.forEach(function(n){var o=n.name;if(o!==void 0){var s=n.value,a="";switch(typeof s){case"function":break;case"object":break;case"string":a=" "+o+': "'+s+`",\r
`,r+=a;break;default:a=" "+o+": "+s+`,\r
`,r+=a;break}}})}catch{this._isEnabled=!1,np.info("Parse client web instrumentation error. Web Instrumentation is disabled")}return r},t.prototype._initialize=function(){this._isInitialized=!0;var e=OSe.createServer,r=MSe.createServer,n=this._isEnabled;OSe.createServer=function(o){var s=o;return s&&(o=function(a,c){var u=c.write,l=a.method=="GET";c.write=function(f,m,h){try{if(n&&l){var g=Mu.getContentEncodingFromHeaders(c),v=void 0;if(typeof m=="string"&&(v=m),g==null)t.INSTANCE.ValidateInjection(c,f)&&(arguments[0]=t.INSTANCE.InjectWebSnippet(c,f,void 0,v));else if(g.length){var y=g[0];arguments[0]=t.INSTANCE.InjectWebSnippet(c,f,y)}}}catch(b){np.warn("Inject snippet error: "+b)}return u.apply(c,arguments)};var d=c.end;return c.end=function(f,m,h){if(n&&l)try{if(n&&l){var g=Mu.getContentEncodingFromHeaders(c),v=void 0;if(typeof m=="string"&&(v=m),g==null)t.INSTANCE.ValidateInjection(c,f)&&(arguments[0]=t.INSTANCE.InjectWebSnippet(c,f,void 0,v));else if(g.length){var y=g[0];arguments[0]=t.INSTANCE.InjectWebSnippet(c,f,y)}}}catch(b){np.warn("Inject snipet error: "+b)}return d.apply(c,arguments)},s(a,c)}),e(o)},MSe.createServer=function(o,s){var a=s;if(a)return s=function(c,u){var l=c.method=="GET",d=u.write,p=u.end;return u.write=function(m,h,g){try{if(n&&l){var v=Mu.getContentEncodingFromHeaders(u),y=void 0;if(typeof h=="string"&&(y=h),v==null)t.INSTANCE.ValidateInjection(u,m)&&(arguments[0]=this.InjectWebSnippet(u,m,void 0,y));else if(v.length){var b=v[0];arguments[0]=t.INSTANCE.InjectWebSnippet(u,m,b)}}}catch(_){np.warn("Inject snippet error: "+_)}return d.apply(u,arguments)},u.end=function(m,h,g){try{if(n&&l){var v=Mu.getContentEncodingFromHeaders(u),y=void 0;if(typeof h=="string"&&(y=h),v==null)t.INSTANCE.ValidateInjection(u,m)&&(arguments[0]=t.INSTANCE.InjectWebSnippet(u,m,void 0,y));else if(v.length){var b=v[0];arguments[0]=t.INSTANCE.InjectWebSnippet(u,m,b)}}}catch(_){np.warn("Inject snippet error: "+_)}return p.apply(u,arguments)},a(c,u)},r(o,s)}},t.prototype.ValidateInjection=function(e,r){try{if(!e||!r||e.statusCode!=200)return!1;var n=Mu.isContentTypeHeaderHtml(e);if(!n)return!1;var o=r.slice().toString();if(o.indexOf("<head>")>=0&&o.indexOf("</head>")>=0&&o.indexOf(t._aiUrl)<0&&o.indexOf(t._aiDeprecatedUrl)<0)return!0}catch(s){np.info("validate injections error: "+s)}return!1},t.prototype.InjectWebSnippet=function(e,r,n,o){try{var s=!!n;if(s)e.removeHeader("Content-Length"),r=this._getInjectedCompressBuffer(e,r,n),e.setHeader("Content-Length",r.length);else{var a=r.toString(),c=a.indexOf("</head>");if(c<0)return r;var u=Mu.insertSnippetByIndex(c,a,t._snippet);if(typeof r=="string")e.removeHeader("Content-Length"),r=u,e.setHeader("Content-Length",Buffer.byteLength(r));else if(Buffer.isBuffer(r)){var l=o||"utf8",d=Mu.isBufferType(r,l);if(d){e.removeHeader("Content-Length");var p=Buffer.from(u).toString(l);r=Buffer.from(p,l),e.setHeader("Content-Length",r.length)}}}}catch(f){np.warn("Failed to inject web snippet and change content-lenght headers. Exception:"+f)}return r},t.prototype._getInjectedCompressBuffer=function(e,r,n){try{switch(n){case Mu.contentEncodingMethod.GZIP:var o=hC.gunzipSync(r);if(this.ValidateInjection(e,o)){var s=this.InjectWebSnippet(e,o);r=hC.gzipSync(s)}break;case Mu.contentEncodingMethod.DEFLATE:var a=hC.inflateSync(r);if(this.ValidateInjection(e,a)){var c=this.InjectWebSnippet(e,a);r=hC.deflateSync(c)}break;case Mu.contentEncodingMethod.BR:var u=Mu.getBrotliDecompressSync(hC),l=Mu.getBrotliCompressSync(hC);if(u&&l){var d=u(r);if(this.ValidateInjection(e,d)){var p=this.InjectWebSnippet(e,d);r=l(p)}break}}}catch(f){np.info("get web injection compress buffer error: "+f)}return r},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t}();BSe.exports=xet});var jSe=M((RY,HSe)=>{"use strict";var Iet=RY&&RY.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Fu=require("url"),wY=Ns(),Cet=us(),Eet=HI(),Tet=aK(),wet=Yy(),Ret=function(t){Iet(e,t);function e(r,n){var o=t.call(this)||this;return n&&n.method&&r&&(o.method=n.method,o.url=e._getUrlFromRequestOptions(r,n),o.startTime=+new Date),o}return e.prototype.onError=function(r){this._setStatus(void 0,r)},e.prototype.onResponse=function(r){this._setStatus(r.statusCode,void 0),this.correlationId=Cet.getCorrelationContextTarget(r,Eet.requestContextTargetKey)},e.prototype.getDependencyTelemetry=function(r,n){var o=this.method.toUpperCase(),s=wY.RemoteDependencyDataConstants.TYPE_HTTP,a="";try{var c=new Fu.URL(this.url);c.search=void 0,c.hash=void 0,o+=" "+c.pathname,a=c.hostname,c.port&&(a+=":"+c.port)}catch{}this.correlationId?(s=wY.RemoteDependencyDataConstants.TYPE_AI,this.correlationId!==wet.correlationIdPrefix&&(a+=" | "+this.correlationId)):s=wY.RemoteDependencyDataConstants.TYPE_HTTP;var u={id:n,name:o,data:this.url,duration:this.duration,success:this._isSuccess(),resultCode:this.statusCode?this.statusCode.toString():null,properties:this.properties||{},dependencyTypeName:s,target:a};if(r&&r.time?u.time=r.time:this.startTime&&(u.time=new Date(this.startTime)),r){for(var l in r)u[l]||(u[l]=r[l]);if(r.properties)for(var l in r.properties)u.properties[l]=r.properties[l]}return u},e._getUrlFromRequestOptions=function(r,n){if(typeof r=="string")if(r.indexOf("http://")===0||r.indexOf("https://")===0)try{r=new Fu.URL(r)}catch{}else try{var o=new Fu.URL("http://"+r);o.port==="443"?r=new Fu.URL("https://"+r):r=new Fu.URL("http://"+r)}catch{}else{if(r&&typeof Fu.URL=="function"&&r instanceof Fu.URL)return Fu.format(r);var s=r;r={},s&&Object.keys(s).forEach(function(u){r[u]=s[u]})}if(r.path&&r.host)try{var a=new Fu.URL(r.path,"http://"+r.host+r.path);r.pathname=a.pathname,r.search=a.search}catch{}if(r.path&&r.hostname&&!r.host)try{var a=new Fu.URL(r.path,"http://"+r.hostname+r.path);r.pathname=a.pathname,r.search=a.search}catch{}if(r.host&&r.port)try{var c=new Fu.URL("http://"+r.host);!c.port&&r.port&&(r.hostname=r.host,delete r.host)}catch{}return r.protocol=r.protocol||n.agent&&n.agent.protocol||n.protocol||void 0,r.hostname=r.hostname||"localhost",Fu.format(r)},e}(Tet);HSe.exports=Ret});var VSe=M(gC=>{"use strict";var p8=gC&&gC.__assign||function(){return p8=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},p8.apply(this,arguments)};Object.defineProperty(gC,"__esModule",{value:!0});gC.parseEventHubSpan=void 0;var kY=(xr(),$i(AI)),ket=(la(),$i(vye)),Pet=(Pl(),$i(K$)),x2=ri(),Aet=function(t){var e=0,r=0,n=ket.hrTimeToMilliseconds(t.startTime);return t.links.forEach(function(o){var s=o.attributes,a=s?.[x2.ENQUEUED_TIME];a&&(e+=1,r+=n-(parseFloat(a.toString())||0))}),Math.max(r/(e||1),0)},Det=function(t,e){var r,n=t.attributes[x2.AzNamespace],o=(t.attributes[Pet.SemanticAttributes.NET_PEER_NAME]||t.attributes["peer.address"]||"unknown").replace(/\/$/g,""),s=t.attributes[x2.MessageBusDestination]||"unknown";switch(t.kind){case kY.SpanKind.CLIENT:e.dependencyTypeName=n,e.target=o+"/"+s;break;case kY.SpanKind.PRODUCER:e.dependencyTypeName=x2.DependencyTypeName.QueueMessage+" | "+n,e.target=o+"/"+s;break;case kY.SpanKind.CONSUMER:e.source=o+"/"+s,e.measurements=p8(p8({},e.measurements),(r={},r[x2.TIME_SINCE_ENQUEUED]=Aet(t),r));break;default:}};gC.parseEventHubSpan=Det});var $Se=M(f8=>{"use strict";Object.defineProperty(f8,"__esModule",{value:!0});f8.spanToTelemetryContract=void 0;var GSe=require("url"),Ol=(xr(),$i(AI)),nr=(Pl(),$i(K$)),em=ri(),Net=VSe(),Let=us();function Oet(t){for(var e={},r=0,n=Object.keys(t.attributes);r<n.length;r++){var o=n[r];o.startsWith("http.")||o.startsWith("rpc.")||o.startsWith("db.")||o.startsWith("peer.")||o.startsWith("net.")||(e[o]=t.attributes[o])}var s=t.links.map(function(a){return{operation_Id:a.context.traceId,id:a.context.spanId}});return s.length>0&&(e["_MS.links"]=Let.stringify(s)),e}function Met(t){return t===nr.DbSystemValues.DB2||t===nr.DbSystemValues.DERBY||t===nr.DbSystemValues.MARIADB||t===nr.DbSystemValues.MSSQL||t===nr.DbSystemValues.ORACLE||t===nr.DbSystemValues.SQLITE||t===nr.DbSystemValues.OTHER_SQL||t===nr.DbSystemValues.HSQLDB||t===nr.DbSystemValues.H2}function zSe(t){var e=t.attributes[nr.SemanticAttributes.HTTP_METHOD];if(e){var r=t.attributes[nr.SemanticAttributes.HTTP_URL];if(r)return String(r);var n=t.attributes[nr.SemanticAttributes.HTTP_SCHEME],o=t.attributes[nr.SemanticAttributes.HTTP_TARGET];if(n&&o){var s=t.attributes[nr.SemanticAttributes.HTTP_HOST];if(s)return n+"://"+s+o;var a=t.attributes[nr.SemanticAttributes.NET_PEER_PORT];if(a){var c=t.attributes[nr.SemanticAttributes.NET_PEER_NAME];if(c)return n+"://"+c+":"+a+o;var u=t.attributes[nr.SemanticAttributes.NET_PEER_IP];if(u)return n+"://"+u+":"+a+o}}}return""}function PY(t){var e=t.attributes[nr.SemanticAttributes.PEER_SERVICE],r=t.attributes[nr.SemanticAttributes.HTTP_HOST],n=t.attributes[nr.SemanticAttributes.HTTP_URL],o=t.attributes[nr.SemanticAttributes.NET_PEER_NAME],s=t.attributes[nr.SemanticAttributes.NET_PEER_IP];return e?String(e):r?String(r):n?String(n):o?String(o):s?String(s):""}function Fet(t){var e={name:t.name,success:t.status.code!=Ol.SpanStatusCode.ERROR,resultCode:"0",duration:0,data:"",dependencyTypeName:""};t.kind===Ol.SpanKind.PRODUCER&&(e.dependencyTypeName=em.DependencyTypeName.QueueMessage),t.kind===Ol.SpanKind.INTERNAL&&t.parentSpanId&&(e.dependencyTypeName=em.DependencyTypeName.InProc);var r=t.attributes[nr.SemanticAttributes.HTTP_METHOD],n=t.attributes[nr.SemanticAttributes.DB_SYSTEM],o=t.attributes[nr.SemanticAttributes.RPC_SYSTEM];if(r){e.dependencyTypeName=em.DependencyTypeName.Http;var s=t.attributes[nr.SemanticAttributes.HTTP_URL];if(s){var a="";try{var c=new GSe.URL(String(s));a=c.pathname}catch{}e.name=r+" "+a}e.data=zSe(t);var u=t.attributes[nr.SemanticAttributes.HTTP_STATUS_CODE];u&&(e.resultCode=String(u));var l=PY(t);if(l){try{var d=new RegExp(/(https?)(:\/\/.*)(:\d+)(\S*)/),p=d.exec(l);if(p!=null){var f=p[1],m=p[3];(f=="https"&&m==":443"||f=="http"&&m==":80")&&(l=p[1]+p[2]+p[4])}}catch{}e.target=""+l}}else if(n){String(n)===nr.DbSystemValues.MYSQL?e.dependencyTypeName="mysql":String(n)===nr.DbSystemValues.POSTGRESQL?e.dependencyTypeName="postgresql":String(n)===nr.DbSystemValues.MONGODB?e.dependencyTypeName="mongodb":String(n)===nr.DbSystemValues.REDIS?e.dependencyTypeName="redis":Met(String(n))?e.dependencyTypeName="SQL":e.dependencyTypeName=String(n);var h=t.attributes[nr.SemanticAttributes.DB_STATEMENT],g=t.attributes[nr.SemanticAttributes.DB_OPERATION];h?e.data=String(h):g&&(e.data=String(g));var l=PY(t),v=t.attributes[nr.SemanticAttributes.DB_NAME];l?e.target=v?l+"|"+v:""+l:e.target=v?""+v:""+n}else if(o){e.dependencyTypeName=em.DependencyTypeName.Grpc;var y=t.attributes[nr.SemanticAttributes.RPC_GRPC_STATUS_CODE];y&&(e.resultCode=String(y));var l=PY(t);l?e.target=""+l:o&&(e.target=String(o))}return e}function Uet(t){var e={name:t.name,success:t.status.code!=Ol.SpanStatusCode.ERROR,resultCode:"0",duration:0,url:"",source:void 0},r=t.attributes[nr.SemanticAttributes.HTTP_METHOD],n=t.attributes[nr.SemanticAttributes.RPC_GRPC_STATUS_CODE];if(r){if(t.kind==Ol.SpanKind.SERVER){var o=t.attributes[nr.SemanticAttributes.HTTP_ROUTE],s=t.attributes[nr.SemanticAttributes.HTTP_URL];if(o)e.name=r+" "+o;else if(s)try{var a=new GSe.URL(String(s));e.name=r+" "+a.pathname}catch{}}e.url=zSe(t);var c=t.attributes[nr.SemanticAttributes.HTTP_STATUS_CODE];c&&(e.resultCode=String(c))}else n&&(e.resultCode=String(n));return e}function Bet(t){var e;switch(t.kind){case Ol.SpanKind.CLIENT:case Ol.SpanKind.PRODUCER:case Ol.SpanKind.INTERNAL:e=Fet(t);break;case Ol.SpanKind.SERVER:case Ol.SpanKind.CONSUMER:e=Uet(t);break}var r=t.spanContext?t.spanContext():t.context(),n=""+r.spanId,o=Math.round(t.duration[0]*1e3+t.duration[1]/1e6);return e.id=n,e.duration=o,e.properties=Oet(t),t.attributes[em.AzNamespace]&&(t.kind===Ol.SpanKind.INTERNAL&&(e.dependencyTypeName=em.DependencyTypeName.InProc+" | "+t.attributes[em.AzNamespace]),t.attributes[em.AzNamespace]===em.MicrosoftEventHub&&Net.parseEventHubSpan(t,e)),e}f8.spanToTelemetryContract=Bet});var KSe=M(Kg=>{"use strict";var vC=Kg&&Kg.__assign||function(){return vC=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},vC.apply(this,arguments)};Object.defineProperty(Kg,"__esModule",{value:!0});Kg.AsyncScopeManager=Kg.OpenTelemetryScopeManagerWrapper=void 0;var Wg=Vg(),qet=require("events"),WSe=function(){function t(){}return t.prototype.active=function(){var e=this,r=Wg.CorrelationContextManager.getCurrentContext();return vC(vC({},r),{getValue:function(n){return e._activeSymbol?n===e._activeSymbol?r:!1:(e._activeSymbol=n,r)},setValue:function(){}})},t.prototype.with=function(e,r){var n=e.parentSpanId,o=e.name,s=t._spanToContext(e,n,o);return Wg.CorrelationContextManager.runWithContext(s,r)()},t.prototype.bind=function(e){return typeof e=="function"?Wg.CorrelationContextManager.wrapCallback(e):(e instanceof qet.EventEmitter&&Wg.CorrelationContextManager.wrapEmitter(e),e)},t.prototype.enable=function(){return Wg.CorrelationContextManager.enable(),this},t.prototype.disable=function(){return Wg.CorrelationContextManager.disable(),this},t._spanToContext=function(e,r,n){var o=e.spanContext?e.spanContext():e.context(),s=vC(vC({},e.spanContext()),{traceFlags:e.spanContext().traceFlags}),a=r?"|"+o.traceId+"."+r+".":o.traceId,c=Wg.CorrelationContextManager.getCurrentContext();c&&(s.traceId=c.operation.id,r||(a=c.operation.parentId));var u=Wg.CorrelationContextManager.spanToContextObject(s,a,n);return u},t}();Kg.OpenTelemetryScopeManagerWrapper=WSe;Kg.AsyncScopeManager=new WSe});var YSe=M(Yg=>{"use strict";Object.defineProperty(Yg,"__esModule",{value:!0});Yg.enable=Yg.subscriber=void 0;var S2=(xr(),$i(AI)),Het=ri(),AY=xi(),jet=$Se(),Vet=KSe(),sb=[],Get=function(t){try{var e=t.data,r=jet.spanToTelemetryContract(e);Vet.AsyncScopeManager.with(e,function(){sb.forEach(function(n){e.kind===S2.SpanKind.SERVER||e.kind===S2.SpanKind.CONSUMER?n.trackRequest(r):(e.kind===S2.SpanKind.CLIENT||e.kind===S2.SpanKind.INTERNAL||e.kind===S2.SpanKind.PRODUCER)&&n.trackDependency(r)})})}catch{}};Yg.subscriber=Get;function zet(t,e){if(t){var r=sb.find(function(n){return n==e});if(r)return;sb.length===0&&AY.channel.subscribe("azure-coretracing",Yg.subscriber,AY.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(Het.StatsbeatInstrumentation.AZURE_CORE_TRACING)}),sb.push(e)}else sb=sb.filter(function(n){return n!=e}),sb.length===0&&AY.channel.unsubscribe("azure-coretracing",Yg.subscriber)}Yg.enable=zet});var QSe=M(Qg=>{"use strict";Object.defineProperty(Qg,"__esModule",{value:!0});Qg.enable=Qg.subscriber=void 0;var $et=ri(),DY=xi(),ab=[],Wet=function(t){t.data.event.commandName!=="ismaster"&&ab.forEach(function(e){var r=t.data.startedData&&t.data.startedData.databaseName||"Unknown database";e.trackDependency({target:r,data:t.data.event.commandName,name:t.data.event.commandName,duration:t.data.event.duration,success:t.data.succeeded,resultCode:t.data.succeeded?"0":"1",time:t.data.startedData.time,dependencyTypeName:"mongodb"})})};Qg.subscriber=Wet;function Ket(t,e){if(t){var r=ab.find(function(n){return n==e});if(r)return;ab.length===0&&DY.channel.subscribe("mongodb",Qg.subscriber,DY.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation($et.StatsbeatInstrumentation.MONGODB)}),ab.push(e)}else ab=ab.filter(function(n){return n!=e}),ab.length===0&&DY.channel.unsubscribe("mongodb",Qg.subscriber)}Qg.enable=Ket});var XSe=M(Xg=>{"use strict";Object.defineProperty(Xg,"__esModule",{value:!0});Xg.enable=Xg.subscriber=void 0;var Yet=ri(),NY=xi(),cb=[],Qet=function(t){cb.forEach(function(e){var r=t.data.query||{},n=r.sql||"Unknown query",o=!t.data.err,s=r._connection||{},a=s.config||{},c=a.socketPath?a.socketPath:(a.host||"localhost")+":"+a.port;e.trackDependency({target:c,data:n,name:n,duration:t.data.duration,success:o,resultCode:o?"0":"1",time:t.data.time,dependencyTypeName:"mysql"})})};Xg.subscriber=Qet;function Xet(t,e){if(t){var r=cb.find(function(n){return n==e});if(r)return;cb.length===0&&NY.channel.subscribe("mysql",Xg.subscriber,NY.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(Yet.StatsbeatInstrumentation.MYSQL)}),cb.push(e)}else cb=cb.filter(function(n){return n!=e}),cb.length===0&&NY.channel.unsubscribe("mysql",Xg.subscriber)}Xg.enable=Xet});var JSe=M(Jg=>{"use strict";Object.defineProperty(Jg,"__esModule",{value:!0});Jg.enable=Jg.subscriber=void 0;var Jet=ri(),LY=xi(),ub=[],Zet=function(t){ub.forEach(function(e){t.data.commandObj.command!=="info"&&e.trackDependency({target:t.data.address,name:t.data.commandObj.command,data:t.data.commandObj.command,duration:t.data.duration,success:!t.data.err,resultCode:t.data.err?"1":"0",time:t.data.time,dependencyTypeName:"redis"})})};Jg.subscriber=Zet;function ett(t,e){if(t){var r=ub.find(function(n){return n==e});if(r)return;ub.length===0&&LY.channel.subscribe("redis",Jg.subscriber,LY.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(Jet.StatsbeatInstrumentation.REDIS)}),ub.push(e)}else ub=ub.filter(function(n){return n!=e}),ub.length===0&&LY.channel.unsubscribe("redis",Jg.subscriber)}Jg.enable=ett});var ZSe=M(Zg=>{"use strict";Object.defineProperty(Zg,"__esModule",{value:!0});Zg.enable=Zg.subscriber=void 0;var ttt=ri(),OY=xi(),lb=[],rtt=function(t){lb.forEach(function(e){var r=t.data.query,n=r.preparable&&r.preparable.text||r.plan||r.text||"unknown query",o=!t.data.error,s=t.data.database.host+":"+t.data.database.port;e.trackDependency({target:s,data:n,name:n,duration:t.data.duration,success:o,resultCode:o?"0":"1",time:t.data.time,dependencyTypeName:"postgres"})})};Zg.subscriber=rtt;function ntt(t,e){if(t){var r=lb.find(function(n){return n==e});if(r)return;lb.length===0&&OY.channel.subscribe("postgres",Zg.subscriber,OY.trueFilter,function(n,o){var s=e.getStatsbeat();s&&s.addInstrumentation(ttt.StatsbeatInstrumentation.POSTGRES)}),lb.push(e)}else lb=lb.filter(function(n){return n!=e}),lb.length===0&&OY.channel.unsubscribe("postgres",Zg.subscriber)}Zg.enable=ntt});var _C=M((FY,eIe)=>{"use strict";var m8=FY&&FY.__spreadArrays||function(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var n=Array(t),o=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,o++)n[o]=s[a];return n},yC=require("http"),bC=require("https"),h8=Hn(),MY=us(),ev=HI(),itt=jSe(),I2=Vg(),g8=v6(),ott=g6(),C2=Yy(),stt=function(){function t(e){if(t.INSTANCE)throw new Error("Client request tracking should be configured from the applicationInsights object");t.INSTANCE=this,this._client=e}return t.prototype.enable=function(e){this._isEnabled=e,this._isEnabled&&!this._isInitialized&&this._initialize(),ott.IsInitialized&&(YSe().enable(e,this._client),QSe().enable(e,this._client),XSe().enable(e,this._client),JSe().enable(e,this._client),ZSe().enable(e,this._client))},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype._initialize=function(){var e=this;this._isInitialized=!0;var r=yC.request,n=bC.request,o=function(s,a){try{var c=!a[t.disableCollectionRequestOption]&&!s[t.alreadyAutoCollectedFlag],u=null;if(a.headers&&(u=a.headers["User-Agent"]||a.headers["user-agent"],u&&u.toString().indexOf("azsdk-js")!==-1&&(c=!1)),s&&a&&c&&(I2.CorrelationContextManager.wrapEmitter(s),e._isEnabled))if(s[t.alreadyAutoCollectedFlag]=!0,I2.CorrelationContextManager.getCurrentContext())t.trackRequest(e._client,{options:a,request:s});else{var l=null;if(C2.w3cEnabled){var d=new g8;l=d.traceId}else{var p=C2.generateRequestId(null);l=C2.getRootId(p)}var f=I2.CorrelationContextManager.generateContextObject(l);I2.CorrelationContextManager.runWithContext(f,function(){t.trackRequest(e._client,{options:a,request:s})})}}catch(m){h8.warn("Failed to generate dependency telemetry.",MY.dumpObj(m))}};yC.request=function(s){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];var u=r.call.apply(r,m8([yC,s],a));return o(u,s),u},bC.request=function(s){for(var a=[],c=1;c<arguments.length;c++)a[c-1]=arguments[c];var u=n.call.apply(n,m8([bC,s],a));return o(u,s),u},yC.get=function(s){for(var a,c=[],u=1;u<arguments.length;u++)c[u-1]=arguments[u];var l=(a=yC.request).call.apply(a,m8([yC,s],c));return l.end(),l},bC.get=function(s){for(var a,c=[],u=1;u<arguments.length;u++)c[u-1]=arguments[u];var l=(a=bC.request).call.apply(a,m8([bC,s],c));return l.end(),l}},t.trackRequest=function(e,r){if(!r.options||!r.request||!e){h8.info("AutoCollectHttpDependencies.trackRequest was called with invalid parameters: ",!r.options,!r.request,!e);return}var n=new itt(r.options,r.request),o=I2.CorrelationContextManager.getCurrentContext(),s,a;if(o&&o.operation&&o.operation.traceparent&&g8.isValidTraceId(o.operation.traceparent.traceId))o.operation.traceparent.updateSpanId(),s=o.operation.traceparent.getBackCompatRequestId();else if(C2.w3cEnabled){var c=new g8;a=c.toString(),s=c.getBackCompatRequestId()}else s=o&&o.operation&&o.operation.parentId+t.requestNumber+++".";if(MY.canIncludeCorrelationHeader(e,n.getUrl())&&r.request.getHeader&&r.request.setHeader&&e.config&&e.config.correlationId){var u=r.request.getHeader(ev.requestContextHeader);try{MY.safeIncludeCorrelationHeader(e,r.request,u)}catch(p){h8.warn("Request-Context header could not be set. Correlation of requests may be lost",p)}if(o&&o.operation)try{if(r.request.setHeader(ev.requestIdHeader,s),e.config.ignoreLegacyHeaders||(r.request.setHeader(ev.parentIdHeader,o.operation.id),r.request.setHeader(ev.rootIdHeader,s)),a||o.operation.traceparent)r.request.setHeader(ev.traceparentHeader,a||o.operation.traceparent.toString());else if(C2.w3cEnabled){var c=new g8().toString();r.request.setHeader(ev.traceparentHeader,c)}if(o.operation.tracestate){var l=o.operation.tracestate.toString();l&&r.request.setHeader(ev.traceStateHeader,l)}var d=o.customProperties.serializeToHeader();d&&r.request.setHeader(ev.correlationContextHeader,d)}catch(p){h8.warn("Correlation headers could not be set. Correlation of requests may be lost.",p)}}r.request.on&&(r.request.on("response",function(p){if(!r.isProcessed){r.isProcessed=!0,n.onResponse(p);var f=n.getDependencyTelemetry(r,s);f.contextObjects=f.contextObjects||{},f.contextObjects["http.RequestOptions"]=r.options,f.contextObjects["http.ClientRequest"]=r.request,f.contextObjects["http.ClientResponse"]=p,e.trackDependency(f)}}),r.request.on("error",function(p){if(!r.isProcessed){r.isProcessed=!0,n.onError(p);var f=n.getDependencyTelemetry(r,s);f.contextObjects=f.contextObjects||{},f.contextObjects["http.RequestOptions"]=r.options,f.contextObjects["http.ClientRequest"]=r.request,f.contextObjects.Error=p,e.trackDependency(f)}}),r.request.on("abort",function(){if(!r.isProcessed){r.isProcessed=!0,n.onError(new Error("The request has been aborted and the network socket has closed."));var p=n.getDependencyTelemetry(r,s);p.contextObjects=p.contextObjects||{},p.contextObjects["http.RequestOptions"]=r.options,p.contextObjects["http.ClientRequest"]=r.request,e.trackDependency(p)}}))},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1},t.disableCollectionRequestOption="disableAppInsightsAutoCollection",t.requestNumber=1,t.alreadyAutoCollectedFlag="_appInsightsAutoCollected",t}();eIe.exports=stt});var BY=M((Nbr,oIe)=>{"use strict";var tIe=require("http"),rIe=require("https"),nIe=Hn(),iIe=us(),att=HI(),UY=dK(),tm=Vg(),ctt=o8(),utt=function(){function t(e){if(t.INSTANCE)throw new Error("Server request tracking should be configured from the applicationInsights object");t.INSTANCE=this,this._client=e}return t.prototype.enable=function(e){this._isEnabled=e,(this._isAutoCorrelating||this._isEnabled||ctt.isEnabled())&&!this._isInitialized&&(this.useAutoCorrelation(this._isAutoCorrelating),this._initialize())},t.prototype.useAutoCorrelation=function(e,r){e&&!this._isAutoCorrelating?tm.CorrelationContextManager.enable(r):!e&&this._isAutoCorrelating&&tm.CorrelationContextManager.disable(),this._isAutoCorrelating=e},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype.isAutoCorrelating=function(){return this._isAutoCorrelating},t.prototype._generateCorrelationContext=function(e){if(this._isAutoCorrelating)return tm.CorrelationContextManager.generateContextObject(e.getOperationId(this._client.context.tags),e.getRequestId(),e.getOperationName(this._client.context.tags),e.getCorrelationContextHeader(),e.getTraceparent(),e.getTracestate())},t.prototype._registerRequest=function(e,r,n){var o=this,s=new UY(e),a=this._generateCorrelationContext(s);tm.CorrelationContextManager.runWithContext(a,function(){o._isEnabled&&(e[t.alreadyAutoCollectedFlag]=!0,t.trackRequest(o._client,{request:e,response:r},s)),typeof n=="function"&&n(e,r)})},t.prototype._initialize=function(){if(this._isInitialized=!0,!t.HANDLER_READY){t.HANDLER_READY=!0;var e=function(s){if(s){if(typeof s!="function")throw new Error("onRequest handler must be a function");return function(a,c){tm.CorrelationContextManager.wrapEmitter(a),tm.CorrelationContextManager.wrapEmitter(c);var u=a&&!a[t.alreadyAutoCollectedFlag];a&&u&&t.INSTANCE?t.INSTANCE._registerRequest(a,c,s):s(a,c)}}},r=function(s){var a=s.addListener.bind(s);s.addListener=function(c,u){switch(c){case"request":case"checkContinue":return a(c,e(u));default:return a(c,u)}},s.on=s.addListener},n=tIe.createServer;tIe.createServer=function(s,a){if(a&&typeof a=="function"){var c=n(s,e(a));return r(c),c}else{var c=n(e(s));return r(c),c}};var o=rIe.createServer;rIe.createServer=function(s,a){var c=o(s,e(a));return r(c),c}}},t.trackRequestSync=function(e,r){if(!r.request||!r.response||!e){nIe.info("AutoCollectHttpRequests.trackRequestSync was called with invalid parameters: ",!r.request,!r.response,!e);return}r.isProcessed=!1,t.addResponseCorrelationIdHeader(e,r.response);var n=tm.CorrelationContextManager.getCurrentContext(),o=new UY(r.request,n&&n.operation.parentId);n&&(n.operation.id=o.getOperationId(e.context.tags)||n.operation.id,n.operation.name=o.getOperationName(e.context.tags)||n.operation.name,n.operation.parentId=o.getRequestId()||n.operation.parentId,n.customProperties.addHeaderData(o.getCorrelationContextHeader())),t.endRequest(e,o,r,r.duration,r.error)},t.trackRequest=function(e,r,n){if(!r.request||!r.response||!e){nIe.info("AutoCollectHttpRequests.trackRequest was called with invalid parameters: ",!r.request,!r.response,!e);return}r.isProcessed=!1;var o=tm.CorrelationContextManager.getCurrentContext(),s=n||new UY(r.request,o&&o.operation.parentId);iIe.canIncludeCorrelationHeader(e,s.getUrl())&&t.addResponseCorrelationIdHeader(e,r.response),o&&!n&&(o.operation.id=s.getOperationId(e.context.tags)||o.operation.id,o.operation.name=s.getOperationName(e.context.tags)||o.operation.name,o.operation.parentId=s.getOperationParentId(e.context.tags)||o.operation.parentId,o.customProperties.addHeaderData(s.getCorrelationContextHeader())),r.response.once&&r.response.once("finish",function(){t.endRequest(e,s,r,null,null)}),r.request.on&&r.request.on("error",function(a){t.endRequest(e,s,r,null,a)}),r.request.on&&r.request.on("aborted",function(){var a="The request has been aborted and the network socket has closed.";t.endRequest(e,s,r,null,a)})},t.addResponseCorrelationIdHeader=function(e,r){if(e.config&&e.config.correlationId&&r.getHeader&&r.setHeader&&!r.headersSent){var n=r.getHeader(att.requestContextHeader);iIe.safeIncludeCorrelationHeader(e,r,n)}},t.endRequest=function(e,r,n,o,s){if(!n.isProcessed){n.isProcessed=!0,s?r.onError(s,o):r.onResponse(n.response,o);var a=r.getRequestTelemetry(n);if(a.tagOverrides=r.getRequestTags(e.context.tags),n.tagOverrides)for(var c in n.tagOverrides)a.tagOverrides[c]=n.tagOverrides[c];var u=r.getLegacyRootId();u&&(a.properties.ai_legacyRootId=u),a.contextObjects=a.contextObjects||{},a.contextObjects["http.ServerRequest"]=n.request,a.contextObjects["http.ServerResponse"]=n.response,e.trackRequest(a)}},t.prototype.dispose=function(){t.INSTANCE=null,this.enable(!1),this._isInitialized=!1,tm.CorrelationContextManager.disable(),this._isAutoCorrelating=!1},t.HANDLER_READY=!1,t.alreadyAutoCollectedFlag="_appInsightsAutoCollected",t}();oIe.exports=utt});var cIe=M((HY,aIe)=>{"use strict";var Uu=HY&&HY.__assign||function(){return Uu=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Uu.apply(this,arguments)},qY=require("os"),db=Ns(),sIe=ri(),ltt=us(),dtt=Hn(),ptt=ltt.w3cTraceId(),ftt=function(){function t(){}return t.createQuickPulseEnvelope=function(e,r,n,o){var s=qY&&typeof qY.hostname=="function"&&qY.hostname()||"Unknown",a=o.tags&&o.keys&&o.keys.cloudRoleInstance&&o.tags[o.keys.cloudRoleInstance]||s,c=o.tags&&o.keys&&o.keys.cloudRole&&o.tags[o.keys.cloudRole]||null,u={Documents:r.length>0?r:null,InstrumentationKey:n.instrumentationKey||"",Metrics:e.length>0?e:null,InvariantVersion:1,Timestamp:"/Date("+Date.now()+")/",Version:o.tags[o.keys.internalSdkVersion],StreamId:ptt,MachineName:s,Instance:a,RoleName:c};return u},t.createQuickPulseMetric=function(e){var r;return r={Name:e.name,Value:e.value,Weight:e.count||1},r},t.telemetryEnvelopeToQuickPulseDocument=function(e){switch(e.data.baseType){case db.TelemetryTypeString.Event:return t.createQuickPulseEventDocument(e);case db.TelemetryTypeString.Exception:return t.createQuickPulseExceptionDocument(e);case db.TelemetryTypeString.Trace:return t.createQuickPulseTraceDocument(e);case db.TelemetryTypeString.Dependency:return t.createQuickPulseDependencyDocument(e);case db.TelemetryTypeString.Request:return t.createQuickPulseRequestDocument(e)}return null},t.createQuickPulseEventDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData.name,o=Uu(Uu({},r),{Name:n});return o},t.createQuickPulseTraceDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData.severityLevel||0,o=Uu(Uu({},r),{Message:e.data.baseData.message,SeverityLevel:db.SeverityLevel[n]});return o},t.createQuickPulseExceptionDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData.exceptions,o="",s="",a="";n&&n.length>0&&(n[0].parsedStack&&n[0].parsedStack.length>0?n[0].parsedStack.forEach(function(u){o+=u.assembly+`
`}):n[0].stack&&n[0].stack.length>0&&(o=n[0].stack),s=n[0].message,a=n[0].typeName);var c=Uu(Uu({},r),{Exception:o,ExceptionMessage:s,ExceptionType:a});return c},t.createQuickPulseRequestDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData,o=Uu(Uu({},r),{Name:n.name,Success:n.success,Duration:n.duration,ResponseCode:n.responseCode,OperationName:n.name});return o},t.createQuickPulseDependencyDocument=function(e){var r=t.createQuickPulseDocument(e),n=e.data.baseData,o=Uu(Uu({},r),{Name:n.name,Target:n.target,Success:n.success,Duration:n.duration,ResultCode:n.resultCode,CommandName:n.data,OperationName:r.OperationId,DependencyTypeName:n.type});return o},t.createQuickPulseDocument=function(e){var r,n,o,s;e.data.baseType?(n=sIe.TelemetryTypeStringToQuickPulseType[e.data.baseType],r=sIe.TelemetryTypeStringToQuickPulseDocumentType[e.data.baseType]):dtt.warn("Document type invalid; not sending live metric document",e.data.baseType),o=e.tags[t.keys.operationId],s=t.aggregateProperties(e);var a={DocumentType:r,__type:n,OperationId:o,Version:"1.0",Properties:s};return a},t.aggregateProperties=function(e){var r=[],n=e.data.baseData.measurements||{};for(var o in n)if(n.hasOwnProperty(o)){var s=n[o],a={key:o,value:s};r.push(a)}var c=e.data.baseData.properties||{};for(var o in c)if(c.hasOwnProperty(o)){var s=c[o],a={key:o,value:s};r.push(a)}return r},t.keys=new db.ContextTagKeys,t}();aIe.exports=ftt});var lIe=M((Lbr,uIe)=>{"use strict";var mtt=function(){return(Date.now()+621355968e5)*1e4};uIe.exports={getTransmissionTime:mtt}});var mIe=M((E2,fIe)=>{"use strict";var dIe=E2&&E2.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},pIe=E2&&E2.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},htt=require("https"),gtt=_C(),jY=Hn(),vtt=lIe(),VY=us(),ytt=require("url"),Bu={method:"POST",time:"x-ms-qps-transmission-time",pollingIntervalHint:"x-ms-qps-service-polling-interval-hint",endpointRedirect:"x-ms-qps-service-endpoint-redirect-v2",instanceName:"x-ms-qps-instance-name",streamId:"x-ms-qps-stream-id",machineName:"x-ms-qps-machine-name",roleName:"x-ms-qps-role-name",streamid:"x-ms-qps-stream-id",invariantVersion:"x-ms-qps-invariant-version",subscribed:"x-ms-qps-subscribed"},btt=function(){function t(e,r){this._config=e,this._consecutiveErrors=0,this._getAuthorizationHandler=r}return t.prototype.ping=function(e,r,n){var o=[{name:Bu.streamId,value:e.StreamId},{name:Bu.machineName,value:e.MachineName},{name:Bu.roleName,value:e.RoleName},{name:Bu.instanceName,value:e.Instance},{name:Bu.invariantVersion,value:e.InvariantVersion.toString()}];this._submitData(e,r,n,"ping",o)},t.prototype.post=function(e,r,n){return dIe(this,void 0,void 0,function(){return pIe(this,function(o){switch(o.label){case 0:return[4,this._submitData([e],r,n,"post")];case 1:return o.sent(),[2]}})})},t.prototype._submitData=function(e,r,n,o,s){return dIe(this,void 0,void 0,function(){var a,c,u,l,d,p,f,m,h=this;return pIe(this,function(g){switch(g.label){case 0:if(a=VY.stringify(e),c=(f={},f[gtt.disableCollectionRequestOption]=!0,f.host=r&&r.length>0?r:this._config.quickPulseHost,f.method=Bu.method,f.path="/QuickPulseService.svc/"+o+"?ikey="+this._config.instrumentationKey,f.headers=(m={Expect:"100-continue"},m[Bu.time]=vtt.getTransmissionTime(),m["Content-Type"]="application/json",m["Content-Length"]=Buffer.byteLength(a),m),f),s&&s.length>0&&s.forEach(function(v){return c.headers[v.name]=v.value}),o!=="post")return[3,4];if(u=this._getAuthorizationHandler?this._getAuthorizationHandler(this._config):null,!u)return[3,4];g.label=1;case 1:return g.trys.push([1,3,,4]),[4,u.addAuthorizationHeader(c)];case 2:return g.sent(),[3,4];case 3:return l=g.sent(),d="Failed to get AAD bearer token for the Application. Error:",jY.info(t.TAG,d,l),[2];case 4:return this._config.httpsAgent?c.agent=this._config.httpsAgent:c.agent=VY.tlsRestrictedAgent,p=htt.request(c,function(v){if(v.statusCode==200){var y=v.headers[Bu.subscribed]==="true",b=null;try{b=v.headers[Bu.endpointRedirect]?new ytt.URL(v.headers[Bu.endpointRedirect].toString()).host:null}catch(S){h._onError("Failed to parse redirect header from QuickPulse: "+VY.dumpObj(S))}var _=v.headers[Bu.pollingIntervalHint]?parseInt(v.headers[Bu.pollingIntervalHint].toString()):null;h._consecutiveErrors=0,n(y,v,b,_)}else h._onError("StatusCode:"+v.statusCode+" StatusMessage:"+v.statusMessage),n()}),p.on("error",function(v){h._onError(v),n()}),p.write(a),p.end(),[2]}})})},t.prototype._onError=function(e){this._consecutiveErrors++;var r="Transient error connecting to the Live Metrics endpoint. This packet will not appear in your Live Metrics Stream. Error:";this._consecutiveErrors%t.MAX_QPS_FAILURES_BEFORE_WARN===0?(r="Live Metrics endpoint could not be reached "+this._consecutiveErrors+" consecutive times. Most recent error:",jY.warn(t.TAG,r,e)):jY.info(t.TAG,r,e)},t.TAG="QuickPulseSender",t.MAX_QPS_FAILURES_BEFORE_WARN=25,t}();fIe.exports=btt});var bIe=M((T2,yIe)=>{"use strict";var hIe=T2&&T2.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},gIe=T2&&T2.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},vIe=Hn(),GY=cIe(),_tt=mIe(),xtt=ri(),Stt=fC(),Itt=function(){function t(e,r,n){this._isCollectingData=!1,this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0,this._metrics={},this._documents=[],this._collectors=[],this._redirectedHost=null,this._pollingIntervalHint=-1,this.config=e,this.context=r||new Stt,this._sender=new _tt(this.config,n),this._isEnabled=!1}return t.prototype.addCollector=function(e){this._collectors.push(e)},t.prototype.trackMetric=function(e){this._addMetric(e)},t.prototype.addDocument=function(e){if(this._isCollectingData){var r=GY.telemetryEnvelopeToQuickPulseDocument(e);r&&this._documents.push(r)}},t.prototype.enable=function(e){e&&!this._isEnabled?(this._isEnabled=!0,this._goQuickPulse()):!e&&this._isEnabled&&(this._isEnabled=!1,clearTimeout(this._handle),this._handle=void 0)},t.prototype.enableCollectors=function(e){this._collectors.forEach(function(r){r.enable(e)})},t.prototype._addMetric=function(e){var r=e.value,n=e.count||1,o=xtt.PerformanceToQuickPulseCounter[e.name];o&&(this._metrics[o]?(this._metrics[o].Value=(this._metrics[o].Value*this._metrics[o].Weight+r*n)/(this._metrics[o].Weight+n),this._metrics[o].Weight+=n):(this._metrics[o]=GY.createQuickPulseMetric(e),this._metrics[o].Name=o,this._metrics[o].Weight=1))},t.prototype._resetQuickPulseBuffer=function(){delete this._metrics,this._metrics={},this._documents.length=0},t.prototype._goQuickPulse=function(){return hIe(this,void 0,void 0,function(){var e,r,n,o,s=this;return gIe(this,function(a){switch(a.label){case 0:return e=Object.keys(this._metrics).map(function(c){return s._metrics[c]}),r=GY.createQuickPulseEnvelope(e,this._documents.slice(),this.config,this.context),this._resetQuickPulseBuffer(),this._isCollectingData?[4,this._post(r)]:[3,2];case 1:return a.sent(),[3,3];case 2:this._ping(r),a.label=3;case 3:return n=this._pollingIntervalHint>0?this._pollingIntervalHint:t.PING_INTERVAL,o=this._isCollectingData?t.POST_INTERVAL:n,this._isCollectingData&&Date.now()-this._lastSuccessTime>=t.MAX_POST_WAIT_TIME&&!this._lastSendSucceeded?(this._isCollectingData=!1,o=t.FALLBACK_INTERVAL):!this._isCollectingData&&Date.now()-this._lastSuccessTime>=t.MAX_PING_WAIT_TIME&&!this._lastSendSucceeded&&(o=t.FALLBACK_INTERVAL),this._lastSendSucceeded=null,this._handle=setTimeout(this._goQuickPulse.bind(this),o),this._handle.unref(),[2]}})})},t.prototype._ping=function(e){this._sender.ping(e,this._redirectedHost,this._quickPulseDone.bind(this))},t.prototype._post=function(e){return hIe(this,void 0,void 0,function(){return gIe(this,function(r){switch(r.label){case 0:return[4,this._sender.post(e,this._redirectedHost,this._quickPulseDone.bind(this))];case 1:return r.sent(),[2]}})})},t.prototype._quickPulseDone=function(e,r,n,o){e!=null?(this._isCollectingData!==e&&(vIe.info("Live Metrics sending data",e),this.enableCollectors(e)),this._isCollectingData=e,n&&n.length>0&&(this._redirectedHost=n,vIe.info("Redirecting endpoint to: ",n)),o&&o>0&&(this._pollingIntervalHint=o),r&&r.statusCode<300&&r.statusCode>=200?(this._lastSuccessTime=Date.now(),this._lastSendSucceeded=!0):this._lastSendSucceeded=!1):this._lastSendSucceeded=!1},t.MAX_POST_WAIT_TIME=2e4,t.MAX_PING_WAIT_TIME=6e4,t.FALLBACK_INTERVAL=6e4,t.PING_INTERVAL=5e3,t.POST_INTERVAL=1e3,t}();yIe.exports=Itt});var _Ie=M(xC=>{"use strict";var v8=xC&&xC.__assign||function(){return v8=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},v8.apply(this,arguments)};Object.defineProperty(xC,"__esModule",{value:!0});xC.AutoCollectNativePerformance=void 0;var w2=fC(),Ctt=Hn(),Ett=function(){function t(e){this._disabledMetrics={},t.INSTANCE&&t.INSTANCE.dispose(),t.INSTANCE=this,this._client=e}return t.prototype.enable=function(e,r,n){var o=this;if(r===void 0&&(r={}),n===void 0&&(n=6e4),t._metricsAvailable==null&&e&&!this._isInitialized)try{var s=require("applicationinsights-native-metrics");t._emitter=new s,t._metricsAvailable=!0,Ctt.info("Native metrics module successfully loaded!")}catch{t._metricsAvailable=!1;return}this._isEnabled=e,this._disabledMetrics=r,this._isEnabled&&!this._isInitialized&&(this._isInitialized=!0),this._isEnabled&&t._emitter?(t._emitter.enable(!0,n),this._handle||(this._handle=setInterval(function(){return o._trackNativeMetrics()},n),this._handle.unref())):t._emitter&&(t._emitter.enable(!1),this._handle&&(clearInterval(this._handle),this._handle=void 0))},t.prototype.dispose=function(){this.enable(!1)},t.parseEnabled=function(e,r){var n=r.disableAllExtendedMetrics,o=r.extendedMetricDisablers;if(n)return{isEnabled:!1,disabledMetrics:{}};if(o){var s=o.split(","),a={};if(s.length>0)for(var c=0,u=s;c<u.length;c++){var l=u[c];a[l]=!0}return typeof e=="object"?{isEnabled:!0,disabledMetrics:v8(v8({},e),a)}:{isEnabled:e,disabledMetrics:a}}return typeof e=="boolean"?{isEnabled:e,disabledMetrics:{}}:{isEnabled:!0,disabledMetrics:e}},t.prototype._trackNativeMetrics=function(){var e=!0;typeof this._isEnabled!="object"&&(e=this._isEnabled),e&&(this._trackGarbageCollection(),this._trackEventLoop(),this._trackHeapUsage())},t.prototype._trackGarbageCollection=function(){var e;if(!this._disabledMetrics.gc){var r=t._emitter.getGCData();for(var n in r){var o=r[n].metrics,s=n+" Garbage Collection Duration",a=Math.sqrt(o.sumSquares/o.count-Math.pow(o.total/o.count,2))||0;this._client.trackMetric({name:s,value:o.total,count:o.count,max:o.max,min:o.min,stdDev:a,tagOverrides:(e={},e[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+w2.sdkVersion,e)})}}},t.prototype._trackEventLoop=function(){var e;if(!this._disabledMetrics.loop){var r=t._emitter.getLoopData(),n=r.loopUsage;if(n.count!=0){var o="Event Loop CPU Time",s=Math.sqrt(n.sumSquares/n.count-Math.pow(n.total/n.count,2))||0;this._client.trackMetric({name:o,value:n.total,count:n.count,min:n.min,max:n.max,stdDev:s,tagOverrides:(e={},e[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+w2.sdkVersion,e)})}}},t.prototype._trackHeapUsage=function(){var e,r,n;if(!this._disabledMetrics.heap){var o=process.memoryUsage(),s=o.heapUsed,a=o.heapTotal,c=o.rss;this._client.trackMetric({name:"Memory Usage (Heap)",value:s,count:1,tagOverrides:(e={},e[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+w2.sdkVersion,e)}),this._client.trackMetric({name:"Memory Total (Heap)",value:a,count:1,tagOverrides:(r={},r[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+w2.sdkVersion,r)}),this._client.trackMetric({name:"Memory Usage (Non-Heap)",value:c-a,count:1,tagOverrides:(n={},n[this._client.context.keys.internalSdkVersion]="node-nativeperf:"+w2.sdkVersion,n)})}},t}();xC.AutoCollectNativePerformance=Ett});var IIe=M(tv=>{"use strict";var xIe=tv&&tv.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},SIe=tv&&tv.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(tv,"__esModule",{value:!0});tv.AzureFunctionsHook=void 0;var y8=Hn(),zY=Vg(),Ttt=function(){function t(e){this._client=e,this._autoGenerateIncomingRequests=!1;try{this._functionsCoreModule=require("@azure/functions-core"),this._addPreInvocationHook(),this._addPostInvocationHook()}catch{y8.info("AzureFunctionsHook failed to load, not running in Azure Functions")}}return t.prototype._getFuncModelHelper=function(){if(this._cachedModelHelper===void 0){var e=this._functionsCoreModule.getProgrammingModel();e.name==="@azure/functions"&&(e.version.startsWith("3.")?this._cachedModelHelper=new wtt:e.version.startsWith("4.")&&(this._cachedModelHelper=new Rtt)),this._cachedModelHelper||(this._cachedModelHelper=null,y8.warn('AzureFunctionsHook does not support model "'+e.name+'" version "'+e.version+'"'))}return this._cachedModelHelper},t.prototype.enable=function(e){this._autoGenerateIncomingRequests=e},t.prototype.dispose=function(){this.enable(!1),this._removeInvocationHooks(),this._functionsCoreModule=void 0},t.prototype._addPreInvocationHook=function(){var e=this;this._preInvocationHook||(this._preInvocationHook=this._functionsCoreModule.registerHook("preInvocation",function(r){return xIe(e,void 0,void 0,function(){var n,o,s,a;return SIe(this,function(c){try{n=this._getFuncModelHelper(),n&&(o=r.invocationContext,s=zY.CorrelationContextManager.startOperation(o),s&&(s.customProperties.setProperty("InvocationId",o.invocationId),a=o.traceContext,a.attributes&&(s.customProperties.setProperty("ProcessId",a.attributes.ProcessId),s.customProperties.setProperty("LogLevel",a.attributes.LogLevel),s.customProperties.setProperty("Category",a.attributes.Category),s.customProperties.setProperty("HostInstanceId",a.attributes.HostInstanceId),s.customProperties.setProperty("AzFuncLiveLogsSessionId",a.attributes["#AzFuncLiveLogsSessionId"])),r.functionCallback=zY.CorrelationContextManager.wrapCallback(r.functionCallback,s),n.isHttpTrigger(r)&&this._autoGenerateIncomingRequests&&(r.hookData.appInsightsExtractedContext=s,r.hookData.appInsightsStartTime=Date.now())))}catch(u){return y8.warn("Failed to propagate context in Azure Functions",u),[2]}return[2]})})}))},t.prototype._addPostInvocationHook=function(){var e=this;this._postInvocationHook||(this._postInvocationHook=this._functionsCoreModule.registerHook("postInvocation",function(r){return xIe(e,void 0,void 0,function(){var n,o,s,a,c=this;return SIe(this,function(u){try{n=this._getFuncModelHelper(),n&&this._autoGenerateIncomingRequests&&n.isHttpTrigger(r)&&(o=r.inputs[0],o&&(s=r.hookData.appInsightsStartTime||Date.now(),a=r.hookData.appInsightsExtractedContext,a?zY.CorrelationContextManager.runWithContext(a,function(){c._createIncomingRequestTelemetry(o,r,s,a.operation.parentId)}):this._createIncomingRequestTelemetry(o,r,s,null)))}catch(l){y8.warn("Error creating automatic incoming request in Azure Functions",l)}return[2]})})}))},t.prototype._createIncomingRequestTelemetry=function(e,r,n,o){var s=this._getFuncModelHelper().getStatusCodes(r),a=200;if(s)for(var c=0,u=s;c<u.length;c++){var l=u[c];if(typeof l=="number"&&Number.isInteger(l)){a=l;break}else if(typeof l=="string"){var d=parseInt(l);if(!isNaN(d)){a=d;break}}}else a=void 0;this._client.trackRequest({name:e.method+" "+e.url,resultCode:a,success:typeof a=="number"?0<a&&a<400:void 0,url:e.url,time:new Date(n),duration:Date.now()-n,id:o}),this._client.flush()},t.prototype._removeInvocationHooks=function(){this._preInvocationHook&&(this._preInvocationHook.dispose(),this._preInvocationHook=void 0),this._postInvocationHook&&(this._postInvocationHook.dispose(),this._postInvocationHook=void 0)},t}();tv.AzureFunctionsHook=Ttt;var wtt=function(){function t(){}return t.prototype._getInvocationContext=function(e){return e.invocationContext},t.prototype.getStatusCodes=function(e){var r=this._getInvocationContext(e),n,o=r.bindingDefinitions.find(function(s){return s.direction==="out"&&s.type.toLowerCase()==="http"});return o?.name==="$return"?n=e.result:o&&r.bindings&&r.bindings[o.name]!==void 0?n=r.bindings[o.name]:n=r.res,n?[n.statusCode,n.status]:void 0},t.prototype.isHttpTrigger=function(e){var r=this._getInvocationContext(e);return!!r.bindingDefinitions.find(function(n){var o;return((o=n.type)===null||o===void 0?void 0:o.toLowerCase())==="httptrigger"})},t}(),Rtt=function(){function t(){}return t.prototype._getInvocationContext=function(e){return e.invocationContext},t.prototype.getStatusCodes=function(e){var r=e.result;return r?[r.status]:void 0},t.prototype.isHttpTrigger=function(e){var r=this._getInvocationContext(e);return r.options.trigger.type.toLowerCase()==="httptrigger"},t}()});var $Y=M((Fbr,TIe)=>{"use strict";var ktt=Yy(),CIe=TY(),Ptt=Hn(),EIe=ri(),Att=require("url"),Dtt=d5(),Ntt=function(){function t(e){this._endpointBase=EIe.DEFAULT_BREEZE_ENDPOINT,this._mergeConfig();var r=this._connectionString,n=CIe.parse(e),o=CIe.parse(r),s=!n.instrumentationkey&&Object.keys(n).length>0?null:e,a=this._instrumentationKey;this.instrumentationKey=n.instrumentationkey||s||o.instrumentationkey||a;var c=""+(this.endpointUrl||n.ingestionendpoint||o.ingestionendpoint||this._endpointBase);c.endsWith("/")&&(c=c.slice(0,-1)),this.endpointUrl=c+"/v2.1/track",this.maxBatchSize=this.maxBatchSize||250,this.maxBatchIntervalMs=this.maxBatchIntervalMs||15e3,this.disableAppInsights=this.disableAppInsights||!1,this.samplingPercentage=this.samplingPercentage||100,this.correlationIdRetryIntervalMs=this.correlationIdRetryIntervalMs||30*1e3,this.enableWebInstrumentation=this.enableWebInstrumentation||this.enableAutoWebSnippetInjection||!1,this.webInstrumentationConfig=this.webInstrumentationConfig||null,this.enableAutoWebSnippetInjection=this.enableWebInstrumentation,this.correlationHeaderExcludedDomains=this.correlationHeaderExcludedDomains||["*.core.windows.net","*.core.chinacloudapi.cn","*.core.cloudapi.de","*.core.usgovcloudapi.net","*.core.microsoft.scloud","*.core.eaglex.ic.gov"],this.ignoreLegacyHeaders=this.ignoreLegacyHeaders||!1,this.profileQueryEndpoint=n.ingestionendpoint||o.ingestionendpoint||process.env[t.ENV_profileQueryEndpoint]||this._endpointBase,this.quickPulseHost=this.quickPulseHost||n.liveendpoint||o.liveendpoint||process.env[t.ENV_quickPulseHost]||EIe.DEFAULT_LIVEMETRICS_HOST,this.webInstrumentationConnectionString=this.webInstrumentationConnectionString||this._webInstrumentationConnectionString||"",this.webSnippetConnectionString=this.webInstrumentationConnectionString,this.quickPulseHost.match(/^https?:\/\//)&&(this.quickPulseHost=new Att.URL(this.quickPulseHost).host),this.aadAudience=n.aadaudience||o.aadaudience}return Object.defineProperty(t.prototype,"profileQueryEndpoint",{get:function(){return this._profileQueryEndpoint},set:function(e){this._profileQueryEndpoint=e,this.correlationId=ktt.correlationIdPrefix},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"instrumentationKey",{get:function(){return this._instrumentationKey},set:function(e){t._validateInstrumentationKey(e)||Ptt.warn("An invalid instrumentation key was provided. There may be resulting telemetry loss",this.instrumentationKey),this._instrumentationKey=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"webSnippetConnectionString",{get:function(){return this._webInstrumentationConnectionString},set:function(e){this._webInstrumentationConnectionString=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"webInstrumentationConnectionString",{get:function(){return this._webInstrumentationConnectionString},set:function(e){this._webInstrumentationConnectionString=e},enumerable:!1,configurable:!0}),t.prototype._mergeConfig=function(){var e=Dtt.JsonConfig.getInstance();this._connectionString=e.connectionString,this._instrumentationKey=e.instrumentationKey,this.correlationHeaderExcludedDomains=e.correlationHeaderExcludedDomains,this.correlationIdRetryIntervalMs=e.correlationIdRetryIntervalMs,this.disableAllExtendedMetrics=e.disableAllExtendedMetrics,this.disableAppInsights=e.disableAppInsights,this.disableStatsbeat=e.disableStatsbeat,this.distributedTracingMode=e.distributedTracingMode,this.enableAutoCollectConsole=e.enableAutoCollectConsole,this.enableLoggerErrorToTrace=e.enableLoggerErrorToTrace,this.enableAutoCollectDependencies=e.enableAutoCollectDependencies,this.enableAutoCollectIncomingRequestAzureFunctions=e.enableAutoCollectIncomingRequestAzureFunctions,this.enableAutoCollectExceptions=e.enableAutoCollectExceptions,this.enableAutoCollectExtendedMetrics=e.enableAutoCollectExtendedMetrics,this.enableAutoCollectExternalLoggers=e.enableAutoCollectExternalLoggers,this.enableAutoCollectHeartbeat=e.enableAutoCollectHeartbeat,this.enableAutoCollectPerformance=e.enableAutoCollectPerformance,this.enableAutoCollectPreAggregatedMetrics=e.enableAutoCollectPreAggregatedMetrics,this.enableAutoCollectRequests=e.enableAutoCollectRequests,this.enableAutoDependencyCorrelation=e.enableAutoDependencyCorrelation,this.enableInternalDebugLogging=e.enableInternalDebugLogging,this.enableInternalWarningLogging=e.enableInternalWarningLogging,this.enableResendInterval=e.enableResendInterval,this.enableMaxBytesOnDisk=e.enableMaxBytesOnDisk,this.enableSendLiveMetrics=e.enableSendLiveMetrics,this.enableUseAsyncHooks=e.enableUseAsyncHooks,this.enableUseDiskRetryCaching=e.enableUseDiskRetryCaching,this.endpointUrl=e.endpointUrl,this.extendedMetricDisablers=e.extendedMetricDisablers,this.ignoreLegacyHeaders=e.ignoreLegacyHeaders,this.maxBatchIntervalMs=e.maxBatchIntervalMs,this.maxBatchSize=e.maxBatchSize,this.proxyHttpUrl=e.proxyHttpUrl,this.proxyHttpsUrl=e.proxyHttpsUrl,this.quickPulseHost=e.quickPulseHost,this.samplingPercentage=e.samplingPercentage,this.enableWebInstrumentation=e.enableWebInstrumentation,this._webInstrumentationConnectionString=e.webInstrumentationConnectionString,this.webInstrumentationConfig=e.webInstrumentationConfig,this.webInstrumentationSrc=e.webInstrumentationSrc},t._validateInstrumentationKey=function(e){var r="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",n=new RegExp(r);return n.test(e)},t.ENV_azurePrefix="APPSETTING_",t.ENV_iKey="APPINSIGHTS_INSTRUMENTATIONKEY",t.legacy_ENV_iKey="APPINSIGHTS_INSTRUMENTATION_KEY",t.ENV_profileQueryEndpoint="APPINSIGHTS_PROFILE_QUERY_ENDPOINT",t.ENV_quickPulseHost="APPINSIGHTS_QUICKPULSE_HOST",t}();TIe.exports=Ntt});function b8(){return WY.create()}var wIe,WY,KY=R(()=>{wIe=new Set(["Deserialize","Serialize","Retry","Sign"]),WY=class t{constructor(e){var r;this._policies=[],this._policies=(r=e?.slice(0))!==null&&r!==void 0?r:[],this._orderedPolicies=void 0}addPolicy(e,r={}){if(r.phase&&r.afterPhase)throw new Error("Policies inside a phase cannot specify afterPhase.");if(r.phase&&!wIe.has(r.phase))throw new Error(`Invalid phase name: ${r.phase}`);if(r.afterPhase&&!wIe.has(r.afterPhase))throw new Error(`Invalid afterPhase name: ${r.afterPhase}`);this._policies.push({policy:e,options:r}),this._orderedPolicies=void 0}removePolicy(e){let r=[];return this._policies=this._policies.filter(n=>e.name&&n.policy.name===e.name||e.phase&&n.options.phase===e.phase?(r.push(n.policy),!1):!0),this._orderedPolicies=void 0,r}sendRequest(e,r){return this.getOrderedPolicies().reduceRight((s,a)=>c=>a.sendRequest(c,s),s=>e.sendRequest(s))(r)}getOrderedPolicies(){return this._orderedPolicies||(this._orderedPolicies=this.orderPolicies()),this._orderedPolicies}clone(){return new t(this._policies)}static create(){return new t}orderPolicies(){let e=[],r=new Map;function n(h){return{name:h,policies:new Set,hasRun:!1,hasAfterPolicies:!1}}let o=n("Serialize"),s=n("None"),a=n("Deserialize"),c=n("Retry"),u=n("Sign"),l=[o,s,a,c,u];function d(h){return h==="Retry"?c:h==="Serialize"?o:h==="Deserialize"?a:h==="Sign"?u:s}for(let h of this._policies){let g=h.policy,v=h.options,y=g.name;if(r.has(y))throw new Error("Duplicate policy names not allowed in pipeline");let b={policy:g,dependsOn:new Set,dependants:new Set};v.afterPhase&&(b.afterPhase=d(v.afterPhase),b.afterPhase.hasAfterPolicies=!0),r.set(y,b),d(v.phase).policies.add(b)}for(let h of this._policies){let{policy:g,options:v}=h,y=g.name,b=r.get(y);if(!b)throw new Error(`Missing node for policy ${y}`);if(v.afterPolicies)for(let _ of v.afterPolicies){let S=r.get(_);S&&(b.dependsOn.add(S),S.dependants.add(b))}if(v.beforePolicies)for(let _ of v.beforePolicies){let S=r.get(_);S&&(S.dependsOn.add(b),b.dependants.add(S))}}function p(h){h.hasRun=!0;for(let g of h.policies)if(!(g.afterPhase&&(!g.afterPhase.hasRun||g.afterPhase.policies.size))&&g.dependsOn.size===0){e.push(g.policy);for(let v of g.dependants)v.dependsOn.delete(g);r.delete(g.policy.name),h.policies.delete(g)}}function f(){for(let h of l){if(p(h),h.policies.size>0&&h!==s){s.hasRun||p(s);return}h.hasAfterPolicies&&p(s)}}let m=0;for(;r.size>0;){m++;let h=e.length;if(f(),e.length<=h&&m>1)throw new Error("Cannot satisfy policy dependencies due to requirements cycle.")}return e}}});function PIe(t,...e){process.stderr.write(`${kIe.default.format(t,...e)}${RIe.EOL}`)}var RIe,kIe,AIe=R(()=>{RIe=require("os"),kIe=z(require("util"))});function XY(t){NIe=t,YY=[],QY=[];let e=/\*/g,r=t.split(",").map(n=>n.trim().replace(e,".*?"));for(let n of r)n.startsWith("-")?QY.push(new RegExp(`^${n.substr(1)}$`)):YY.push(new RegExp(`^${n}$`));for(let n of _8)n.enabled=JY(n.namespace)}function JY(t){if(t.endsWith("*"))return!0;for(let e of QY)if(e.test(t))return!1;for(let e of YY)if(e.test(t))return!0;return!1}function Ltt(){let t=NIe||"";return XY(""),t}function OIe(t){let e=Object.assign(r,{enabled:JY(t),destroy:Ott,log:LIe.log,namespace:t,extend:Mtt});function r(...n){e.enabled&&(n.length>0&&(n[0]=`${t} ${n[0]}`),e.log(...n))}return _8.push(e),e}function Ott(){let t=_8.indexOf(this);return t>=0?(_8.splice(t,1),!0):!1}function Mtt(t){let e=OIe(`${this.namespace}:${t}`);return e.log=this.log,e}var DIe,NIe,YY,QY,_8,LIe,SC,MIe=R(()=>{AIe();DIe=typeof process<"u"&&process.env&&process.env.DEBUG||void 0,YY=[],QY=[],_8=[];DIe&&XY(DIe);LIe=Object.assign(t=>OIe(t),{enable:XY,enabled:JY,disable:Ltt,log:PIe});SC=LIe});function Ftt(t){if(t&&!HIe(t))throw new Error(`Unknown log level '${t}'. Acceptable values: ${tQ.join(",")}`);ZY=t;let e=[];for(let r of UIe)qIe(r)&&e.push(r.namespace);SC.enable(e.join(","))}function I8(t){let e=eQ.extend(t);return BIe(eQ,e),{error:S8(e,"error"),warning:S8(e,"warning"),info:S8(e,"info"),verbose:S8(e,"verbose")}}function BIe(t,e){e.log=(...r)=>{t.log(...r)}}function S8(t,e){let r=Object.assign(t.extend(e),{level:e});if(BIe(t,r),qIe(r)){let n=SC.disable();SC.enable(n+","+r.namespace)}return UIe.add(r),r}function qIe(t){return!!(ZY&&FIe[t.level]<=FIe[ZY])}function HIe(t){return tQ.includes(t)}var UIe,x8,ZY,eQ,tQ,FIe,rQ=R(()=>{MIe();UIe=new Set,x8=typeof process<"u"&&process.env&&process.env.AZURE_LOG_LEVEL||void 0,eQ=SC("azure");eQ.log=(...t)=>{SC.log(...t)};tQ=["verbose","info","warning","error"];x8&&(HIe(x8)?Ftt(x8):console.error(`AZURE_LOG_LEVEL set to unknown log level '${x8}'; logging is not enabled. Acceptable values: ${tQ.join(", ")}.`));FIe={verbose:400,info:300,warning:200,error:100}});var ms,IC=R(()=>{rQ();ms=I8("core-rest-pipeline")});var nQ,C8,jIe=R(()=>{C8=typeof process<"u"&&!!process.version&&!!(!((nQ=process.versions)===null||nQ===void 0)&&nQ.node)});function iQ(t){if(t.aborted)return;t.onabort&&t.onabort.call(t);let e=CC.get(t);e&&e.slice().forEach(r=>{r.call(t,{type:"abort"})}),E8.set(t,!0)}var CC,E8,R2,VIe=R(()=>{CC=new WeakMap,E8=new WeakMap,R2=class t{constructor(){this.onabort=null,CC.set(this,[]),E8.set(this,!1)}get aborted(){if(!E8.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");return E8.get(this)}static get none(){return new t}addEventListener(e,r){if(!CC.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");CC.get(this).push(r)}removeEventListener(e,r){if(!CC.has(this))throw new TypeError("Expected `this` to be an instance of AbortSignal.");let n=CC.get(this),o=n.indexOf(r);o>-1&&n.splice(o,1)}dispatchEvent(e){throw new Error("This is a stub dispatchEvent implementation that should not be used.  It only exists for type-checking purposes.")}}});var ip,k2,GIe=R(()=>{VIe();ip=class extends Error{constructor(e){super(e),this.name="AbortError"}},k2=class{constructor(e){if(this._signal=new R2,!!e){Array.isArray(e)||(e=arguments);for(let r of e)r.aborted?this.abort():r.addEventListener("abort",()=>{this.abort()})}}get signal(){return this._signal}abort(){iQ(this._signal)}static timeout(e){let r=new R2,n=setTimeout(iQ,e,r);return typeof n.unref=="function"&&n.unref(),r}}});var T8=R(()=>{GIe()});function oQ(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t+1))+t}var zIe=R(()=>{});function P2(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)&&!(t instanceof RegExp)&&!(t instanceof Date)}var sQ=R(()=>{});function EC(t){if(P2(t)){let e=typeof t.name=="string",r=typeof t.message=="string";return e&&r}return!1}function TC(t){if(EC(t))return t.message;{let e;try{typeof t=="object"&&t?e=JSON.stringify(t):e=String(t)}catch{e="[unable to stringify input]"}return`Unknown error ${e}`}}var $Ie=R(()=>{sQ()});var wC=R(()=>{jIe();zIe();sQ();$Ie()});var aQ,Utt,Btt,RC,cQ=R(()=>{wC();aQ="REDACTED",Utt=["x-ms-client-request-id","x-ms-return-client-request-id","x-ms-useragent","x-ms-correlation-request-id","x-ms-request-id","client-request-id","ms-cv","return-client-request-id","traceparent","Access-Control-Allow-Credentials","Access-Control-Allow-Headers","Access-Control-Allow-Methods","Access-Control-Allow-Origin","Access-Control-Expose-Headers","Access-Control-Max-Age","Access-Control-Request-Headers","Access-Control-Request-Method","Origin","Accept","Accept-Encoding","Cache-Control","Connection","Content-Length","Content-Type","Date","ETag","Expires","If-Match","If-Modified-Since","If-None-Match","If-Unmodified-Since","Last-Modified","Pragma","Request-Id","Retry-After","Server","Transfer-Encoding","User-Agent","WWW-Authenticate"],Btt=["api-version"],RC=class{constructor({additionalAllowedHeaderNames:e=[],additionalAllowedQueryParameters:r=[]}={}){e=Utt.concat(e),r=Btt.concat(r),this.allowedHeaderNames=new Set(e.map(n=>n.toLowerCase())),this.allowedQueryParameters=new Set(r.map(n=>n.toLowerCase()))}sanitize(e){let r=new Set;return JSON.stringify(e,(n,o)=>{if(o instanceof Error)return Object.assign(Object.assign({},o),{name:o.name,message:o.message});if(n==="headers")return this.sanitizeHeaders(o);if(n==="url")return this.sanitizeUrl(o);if(n==="query")return this.sanitizeQuery(o);if(n==="body")return;if(n==="response")return;if(n==="operationSpec")return;if(Array.isArray(o)||P2(o)){if(r.has(o))return"[Circular]";r.add(o)}return o},2)}sanitizeHeaders(e){let r={};for(let n of Object.keys(e))this.allowedHeaderNames.has(n.toLowerCase())?r[n]=e[n]:r[n]=aQ;return r}sanitizeQuery(e){if(typeof e!="object"||e===null)return e;let r={};for(let n of Object.keys(e))this.allowedQueryParameters.has(n.toLowerCase())?r[n]=e[n]:r[n]=aQ;return r}sanitizeUrl(e){if(typeof e!="string"||e===null)return e;let r=new URL(e);if(!r.search)return e;for(let[n]of r.searchParams)this.allowedQueryParameters.has(n.toLowerCase())||r.searchParams.set(n,aQ);return r.toString()}}});function w8(t={}){var e;let r=(e=t.logger)!==null&&e!==void 0?e:ms.info,n=new RC({additionalAllowedHeaderNames:t.additionalAllowedHeaderNames,additionalAllowedQueryParameters:t.additionalAllowedQueryParameters});return{name:uQ,async sendRequest(o,s){if(!r.enabled)return s(o);r(`Request: ${n.sanitize(o)}`);let a=await s(o);return r(`Response status code: ${a.status}`),r(`Headers: ${n.sanitize(a.headers)}`),a}}}var uQ,lQ=R(()=>{IC();cQ();uQ="logPolicy"});function R8(t={}){let{maxRetries:e=20}=t;return{name:dQ,async sendRequest(r,n){let o=await n(r);return KIe(n,o,e)}}}async function KIe(t,e,r,n=0){let{request:o,status:s,headers:a}=e,c=a.get("location");if(c&&(s===300||s===301&&WIe.includes(o.method)||s===302&&WIe.includes(o.method)||s===303&&o.method==="POST"||s===307)&&n<r){let u=new URL(c,o.url);o.url=u.toString(),s===303&&(o.method="GET",o.headers.delete("Content-Length"),delete o.body),o.headers.delete("Authorization");let l=await t(o);return KIe(t,l,r,n+1)}return e}var dQ,WIe,pQ=R(()=>{dQ="redirectPolicy",WIe=["GET","HEAD"]});function YIe(){return"User-Agent"}function QIe(t){t.set("Node",process.version),t.set("OS",`(${kC.arch()}-${kC.type()}-${kC.release()})`)}var kC,XIe=R(()=>{kC=z(require("os"))});var k8,fQ=R(()=>{k8="1.10.1"});function qtt(t){let e=[];for(let[r,n]of t){let o=n?`${r}/${n}`:r;e.push(o)}return e.join(" ")}function JIe(){return YIe()}function P8(t){let e=new Map;e.set("core-rest-pipeline",k8),QIe(e);let r=qtt(e);return t?`${t} ${r}`:r}var mQ=R(()=>{XIe();fQ()});function A8(t={}){let e=P8(t.userAgentPrefix);return{name:hQ,async sendRequest(r,n){return r.headers.has(ZIe)||r.headers.set(ZIe,e),n(r)}}}var ZIe,hQ,gQ=R(()=>{mQ();ZIe=JIe(),hQ="userAgentPolicy"});function D8(){return{name:vQ,async sendRequest(t,e){return t.method!=="HEAD"&&t.headers.set("Accept-Encoding","gzip,deflate"),e(t)}}}var vQ,yQ=R(()=>{vQ="decompressResponsePolicy"});function N8(t,e,r){return new Promise((n,o)=>{let s,a,c=()=>o(new ip(r?.abortErrorMsg?r?.abortErrorMsg:Htt)),u=()=>{r?.abortSignal&&a&&r.abortSignal.removeEventListener("abort",a)};if(a=()=>(s&&clearTimeout(s),u(),c()),r?.abortSignal&&r.abortSignal.aborted)return c();s=setTimeout(()=>{u(),n(e)},t),r?.abortSignal&&r.abortSignal.addEventListener("abort",a)})}function eCe(t,e){let r=t.headers.get(e);if(!r)return;let n=Number(r);if(!Number.isNaN(n))return n}var Htt,L8=R(()=>{T8();Htt="The operation was aborted."});function tCe(t){if(t&&[429,503].includes(t.status))try{for(let o of jtt){let s=eCe(t,o);if(s===0||s)return s*(o===bQ?1e3:1)}let e=t.headers.get(bQ);if(!e)return;let n=Date.parse(e)-Date.now();return Number.isFinite(n)?Math.max(0,n):void 0}catch{return}}function rCe(t){return Number.isFinite(tCe(t))}function O8(){return{name:"throttlingRetryStrategy",retry({response:t}){let e=tCe(t);return Number.isFinite(e)?{retryAfterInMs:e}:{skipStrategy:!0}}}}var bQ,jtt,M8=R(()=>{L8();bQ="Retry-After",jtt=["retry-after-ms","x-ms-retry-after-ms",bQ]});function PC(t={}){var e,r;let n=(e=t.retryDelayInMs)!==null&&e!==void 0?e:Vtt,o=(r=t.maxRetryDelayInMs)!==null&&r!==void 0?r:Gtt,s=n;return{name:"exponentialRetryStrategy",retry({retryCount:a,response:c,responseError:u}){let l=$tt(u),d=l&&t.ignoreSystemErrors,p=ztt(c),f=p&&t.ignoreHttpStatusCodes;if(c&&(rCe(c)||!p)||f||d)return{skipStrategy:!0};if(u&&!l&&!p)return{errorToThrow:u};let h=s*Math.pow(2,a),g=Math.min(o,h);return s=g/2+oQ(0,g/2),{retryAfterInMs:s}}}}function ztt(t){return!!(t&&t.status!==void 0&&(t.status>=500||t.status===408)&&t.status!==501&&t.status!==505)}function $tt(t){return t?t.code==="ETIMEDOUT"||t.code==="ESOCKETTIMEDOUT"||t.code==="ECONNREFUSED"||t.code==="ECONNRESET"||t.code==="ENOENT":!1}var Vtt,Gtt,F8=R(()=>{wC();M8();Vtt=1e3,Gtt=1e3*64});function op(t,e={maxRetries:3}){let r=e.logger||nCe;return{name:Wtt,async sendRequest(n,o){var s,a;let c,u,l=-1;e:for(;;){l+=1,c=void 0,u=void 0;try{r.info(`Retry ${l}: Attempting to send request`,n.requestId),c=await o(n),r.info(`Retry ${l}: Received a response from request`,n.requestId)}catch(d){if(r.error(`Retry ${l}: Received an error from request`,n.requestId),u=d,!d||u.name!=="RestError")throw d;c=u.response}if(!((s=n.abortSignal)===null||s===void 0)&&s.aborted)throw r.error(`Retry ${l}: Request aborted.`),new ip;if(l>=((a=e.maxRetries)!==null&&a!==void 0?a:3)){if(r.info(`Retry ${l}: Maximum retries reached. Returning the last received response, or throwing the last received error.`),u)throw u;if(c)return c;throw new Error("Maximum retries reached with no response or error to throw")}r.info(`Retry ${l}: Processing ${t.length} retry strategies.`);t:for(let d of t){let p=d.logger||nCe;p.info(`Retry ${l}: Processing retry strategy ${d.name}.`);let f=d.retry({retryCount:l,response:c,responseError:u});if(f.skipStrategy){p.info(`Retry ${l}: Skipped.`);continue t}let{errorToThrow:m,retryAfterInMs:h,redirectTo:g}=f;if(m)throw p.error(`Retry ${l}: Retry strategy ${d.name} throws error:`,m),m;if(h||h===0){p.info(`Retry ${l}: Retry strategy ${d.name} retries after ${h}`),await N8(h,void 0,{abortSignal:n.abortSignal});continue e}if(g){p.info(`Retry ${l}: Retry strategy ${d.name} redirects to ${g}`),n.url=g;continue e}}if(u)throw r.info("None of the retry strategies could work with the received error. Throwing it."),u;if(c)return r.info("None of the retry strategies could work with the received response. Returning it."),c}}}}var nCe,Wtt,AC=R(()=>{L8();rQ();T8();nCe=I8("core-rest-pipeline retryPolicy"),Wtt="retryPolicy"});function U8(t={}){var e;return{name:Ktt,sendRequest:op([O8(),PC(t)],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:3}).sendRequest}}var Ktt,_Q=R(()=>{F8();M8();AC();Ktt="defaultRetryPolicy"});var sCe=M((M_r,oCe)=>{var iCe=require("stream").Stream,Ytt=require("util");oCe.exports=Ml;function Ml(){this.source=null,this.dataSize=0,this.maxDataSize=1024*1024,this.pauseStream=!0,this._maxDataSizeExceeded=!1,this._released=!1,this._bufferedEvents=[]}Ytt.inherits(Ml,iCe);Ml.create=function(t,e){var r=new this;e=e||{};for(var n in e)r[n]=e[n];r.source=t;var o=t.emit;return t.emit=function(){return r._handleEmit(arguments),o.apply(t,arguments)},t.on("error",function(){}),r.pauseStream&&t.pause(),r};Object.defineProperty(Ml.prototype,"readable",{configurable:!0,enumerable:!0,get:function(){return this.source.readable}});Ml.prototype.setEncoding=function(){return this.source.setEncoding.apply(this.source,arguments)};Ml.prototype.resume=function(){this._released||this.release(),this.source.resume()};Ml.prototype.pause=function(){this.source.pause()};Ml.prototype.release=function(){this._released=!0,this._bufferedEvents.forEach(function(t){this.emit.apply(this,t)}.bind(this)),this._bufferedEvents=[]};Ml.prototype.pipe=function(){var t=iCe.prototype.pipe.apply(this,arguments);return this.resume(),t};Ml.prototype._handleEmit=function(t){if(this._released){this.emit.apply(this,t);return}t[0]==="data"&&(this.dataSize+=t[1].length,this._checkIfMaxDataSizeExceeded()),this._bufferedEvents.push(t)};Ml.prototype._checkIfMaxDataSizeExceeded=function(){if(!this._maxDataSizeExceeded&&!(this.dataSize<=this.maxDataSize)){this._maxDataSizeExceeded=!0;var t="DelayedStream#maxDataSize of "+this.maxDataSize+" bytes exceeded.";this.emit("error",new Error(t))}}});var lCe=M((F_r,uCe)=>{var Qtt=require("util"),cCe=require("stream").Stream,aCe=sCe();uCe.exports=Ii;function Ii(){this.writable=!1,this.readable=!0,this.dataSize=0,this.maxDataSize=2*1024*1024,this.pauseStreams=!0,this._released=!1,this._streams=[],this._currentStream=null,this._insideLoop=!1,this._pendingNext=!1}Qtt.inherits(Ii,cCe);Ii.create=function(t){var e=new this;t=t||{};for(var r in t)e[r]=t[r];return e};Ii.isStreamLike=function(t){return typeof t!="function"&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"&&!Buffer.isBuffer(t)};Ii.prototype.append=function(t){var e=Ii.isStreamLike(t);if(e){if(!(t instanceof aCe)){var r=aCe.create(t,{maxDataSize:1/0,pauseStream:this.pauseStreams});t.on("data",this._checkDataSize.bind(this)),t=r}this._handleErrors(t),this.pauseStreams&&t.pause()}return this._streams.push(t),this};Ii.prototype.pipe=function(t,e){return cCe.prototype.pipe.call(this,t,e),this.resume(),t};Ii.prototype._getNext=function(){if(this._currentStream=null,this._insideLoop){this._pendingNext=!0;return}this._insideLoop=!0;try{do this._pendingNext=!1,this._realGetNext();while(this._pendingNext)}finally{this._insideLoop=!1}};Ii.prototype._realGetNext=function(){var t=this._streams.shift();if(typeof t>"u"){this.end();return}if(typeof t!="function"){this._pipeNext(t);return}var e=t;e(function(r){var n=Ii.isStreamLike(r);n&&(r.on("data",this._checkDataSize.bind(this)),this._handleErrors(r)),this._pipeNext(r)}.bind(this))};Ii.prototype._pipeNext=function(t){this._currentStream=t;var e=Ii.isStreamLike(t);if(e){t.on("end",this._getNext.bind(this)),t.pipe(this,{end:!1});return}var r=t;this.write(r),this._getNext()};Ii.prototype._handleErrors=function(t){var e=this;t.on("error",function(r){e._emitError(r)})};Ii.prototype.write=function(t){this.emit("data",t)};Ii.prototype.pause=function(){this.pauseStreams&&(this.pauseStreams&&this._currentStream&&typeof this._currentStream.pause=="function"&&this._currentStream.pause(),this.emit("pause"))};Ii.prototype.resume=function(){this._released||(this._released=!0,this.writable=!0,this._getNext()),this.pauseStreams&&this._currentStream&&typeof this._currentStream.resume=="function"&&this._currentStream.resume(),this.emit("resume")};Ii.prototype.end=function(){this._reset(),this.emit("end")};Ii.prototype.destroy=function(){this._reset(),this.emit("close")};Ii.prototype._reset=function(){this.writable=!1,this._streams=[],this._currentStream=null};Ii.prototype._checkDataSize=function(){if(this._updateDataSize(),!(this.dataSize<=this.maxDataSize)){var t="DelayedStream#maxDataSize of "+this.maxDataSize+" bytes exceeded.";this._emitError(new Error(t))}};Ii.prototype._updateDataSize=function(){this.dataSize=0;var t=this;this._streams.forEach(function(e){e.dataSize&&(t.dataSize+=e.dataSize)}),this._currentStream&&this._currentStream.dataSize&&(this.dataSize+=this._currentStream.dataSize)};Ii.prototype._emitError=function(t){this._reset(),this.emit("error",t)}});var dCe=M((U_r,Xtt)=>{Xtt.exports={"application/1d-interleaved-parityfec":{source:"iana"},"application/3gpdash-qoe-report+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/3gpp-ims+xml":{source:"iana",compressible:!0},"application/3gpphal+json":{source:"iana",compressible:!0},"application/3gpphalforms+json":{source:"iana",compressible:!0},"application/a2l":{source:"iana"},"application/ace+cbor":{source:"iana"},"application/activemessage":{source:"iana"},"application/activity+json":{source:"iana",compressible:!0},"application/alto-costmap+json":{source:"iana",compressible:!0},"application/alto-costmapfilter+json":{source:"iana",compressible:!0},"application/alto-directory+json":{source:"iana",compressible:!0},"application/alto-endpointcost+json":{source:"iana",compressible:!0},"application/alto-endpointcostparams+json":{source:"iana",compressible:!0},"application/alto-endpointprop+json":{source:"iana",compressible:!0},"application/alto-endpointpropparams+json":{source:"iana",compressible:!0},"application/alto-error+json":{source:"iana",compressible:!0},"application/alto-networkmap+json":{source:"iana",compressible:!0},"application/alto-networkmapfilter+json":{source:"iana",compressible:!0},"application/alto-updatestreamcontrol+json":{source:"iana",compressible:!0},"application/alto-updatestreamparams+json":{source:"iana",compressible:!0},"application/aml":{source:"iana"},"application/andrew-inset":{source:"iana",extensions:["ez"]},"application/applefile":{source:"iana"},"application/applixware":{source:"apache",extensions:["aw"]},"application/at+jwt":{source:"iana"},"application/atf":{source:"iana"},"application/atfx":{source:"iana"},"application/atom+xml":{source:"iana",compressible:!0,extensions:["atom"]},"application/atomcat+xml":{source:"iana",compressible:!0,extensions:["atomcat"]},"application/atomdeleted+xml":{source:"iana",compressible:!0,extensions:["atomdeleted"]},"application/atomicmail":{source:"iana"},"application/atomsvc+xml":{source:"iana",compressible:!0,extensions:["atomsvc"]},"application/atsc-dwd+xml":{source:"iana",compressible:!0,extensions:["dwd"]},"application/atsc-dynamic-event-message":{source:"iana"},"application/atsc-held+xml":{source:"iana",compressible:!0,extensions:["held"]},"application/atsc-rdt+json":{source:"iana",compressible:!0},"application/atsc-rsat+xml":{source:"iana",compressible:!0,extensions:["rsat"]},"application/atxml":{source:"iana"},"application/auth-policy+xml":{source:"iana",compressible:!0},"application/bacnet-xdd+zip":{source:"iana",compressible:!1},"application/batch-smtp":{source:"iana"},"application/bdoc":{compressible:!1,extensions:["bdoc"]},"application/beep+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/calendar+json":{source:"iana",compressible:!0},"application/calendar+xml":{source:"iana",compressible:!0,extensions:["xcs"]},"application/call-completion":{source:"iana"},"application/cals-1840":{source:"iana"},"application/captive+json":{source:"iana",compressible:!0},"application/cbor":{source:"iana"},"application/cbor-seq":{source:"iana"},"application/cccex":{source:"iana"},"application/ccmp+xml":{source:"iana",compressible:!0},"application/ccxml+xml":{source:"iana",compressible:!0,extensions:["ccxml"]},"application/cdfx+xml":{source:"iana",compressible:!0,extensions:["cdfx"]},"application/cdmi-capability":{source:"iana",extensions:["cdmia"]},"application/cdmi-container":{source:"iana",extensions:["cdmic"]},"application/cdmi-domain":{source:"iana",extensions:["cdmid"]},"application/cdmi-object":{source:"iana",extensions:["cdmio"]},"application/cdmi-queue":{source:"iana",extensions:["cdmiq"]},"application/cdni":{source:"iana"},"application/cea":{source:"iana"},"application/cea-2018+xml":{source:"iana",compressible:!0},"application/cellml+xml":{source:"iana",compressible:!0},"application/cfw":{source:"iana"},"application/city+json":{source:"iana",compressible:!0},"application/clr":{source:"iana"},"application/clue+xml":{source:"iana",compressible:!0},"application/clue_info+xml":{source:"iana",compressible:!0},"application/cms":{source:"iana"},"application/cnrp+xml":{source:"iana",compressible:!0},"application/coap-group+json":{source:"iana",compressible:!0},"application/coap-payload":{source:"iana"},"application/commonground":{source:"iana"},"application/conference-info+xml":{source:"iana",compressible:!0},"application/cose":{source:"iana"},"application/cose-key":{source:"iana"},"application/cose-key-set":{source:"iana"},"application/cpl+xml":{source:"iana",compressible:!0,extensions:["cpl"]},"application/csrattrs":{source:"iana"},"application/csta+xml":{source:"iana",compressible:!0},"application/cstadata+xml":{source:"iana",compressible:!0},"application/csvm+json":{source:"iana",compressible:!0},"application/cu-seeme":{source:"apache",extensions:["cu"]},"application/cwt":{source:"iana"},"application/cybercash":{source:"iana"},"application/dart":{compressible:!0},"application/dash+xml":{source:"iana",compressible:!0,extensions:["mpd"]},"application/dash-patch+xml":{source:"iana",compressible:!0,extensions:["mpp"]},"application/dashdelta":{source:"iana"},"application/davmount+xml":{source:"iana",compressible:!0,extensions:["davmount"]},"application/dca-rft":{source:"iana"},"application/dcd":{source:"iana"},"application/dec-dx":{source:"iana"},"application/dialog-info+xml":{source:"iana",compressible:!0},"application/dicom":{source:"iana"},"application/dicom+json":{source:"iana",compressible:!0},"application/dicom+xml":{source:"iana",compressible:!0},"application/dii":{source:"iana"},"application/dit":{source:"iana"},"application/dns":{source:"iana"},"application/dns+json":{source:"iana",compressible:!0},"application/dns-message":{source:"iana"},"application/docbook+xml":{source:"apache",compressible:!0,extensions:["dbk"]},"application/dots+cbor":{source:"iana"},"application/dskpp+xml":{source:"iana",compressible:!0},"application/dssc+der":{source:"iana",extensions:["dssc"]},"application/dssc+xml":{source:"iana",compressible:!0,extensions:["xdssc"]},"application/dvcs":{source:"iana"},"application/ecmascript":{source:"iana",compressible:!0,extensions:["es","ecma"]},"application/edi-consent":{source:"iana"},"application/edi-x12":{source:"iana",compressible:!1},"application/edifact":{source:"iana",compressible:!1},"application/efi":{source:"iana"},"application/elm+json":{source:"iana",charset:"UTF-8",compressible:!0},"application/elm+xml":{source:"iana",compressible:!0},"application/emergencycalldata.cap+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/emergencycalldata.comment+xml":{source:"iana",compressible:!0},"application/emergencycalldata.control+xml":{source:"iana",compressible:!0},"application/emergencycalldata.deviceinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.ecall.msd":{source:"iana"},"application/emergencycalldata.providerinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.serviceinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.subscriberinfo+xml":{source:"iana",compressible:!0},"application/emergencycalldata.veds+xml":{source:"iana",compressible:!0},"application/emma+xml":{source:"iana",compressible:!0,extensions:["emma"]},"application/emotionml+xml":{source:"iana",compressible:!0,extensions:["emotionml"]},"application/encaprtp":{source:"iana"},"application/epp+xml":{source:"iana",compressible:!0},"application/epub+zip":{source:"iana",compressible:!1,extensions:["epub"]},"application/eshop":{source:"iana"},"application/exi":{source:"iana",extensions:["exi"]},"application/expect-ct-report+json":{source:"iana",compressible:!0},"application/express":{source:"iana",extensions:["exp"]},"application/fastinfoset":{source:"iana"},"application/fastsoap":{source:"iana"},"application/fdt+xml":{source:"iana",compressible:!0,extensions:["fdt"]},"application/fhir+json":{source:"iana",charset:"UTF-8",compressible:!0},"application/fhir+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/fido.trusted-apps+json":{compressible:!0},"application/fits":{source:"iana"},"application/flexfec":{source:"iana"},"application/font-sfnt":{source:"iana"},"application/font-tdpfr":{source:"iana",extensions:["pfr"]},"application/font-woff":{source:"iana",compressible:!1},"application/framework-attributes+xml":{source:"iana",compressible:!0},"application/geo+json":{source:"iana",compressible:!0,extensions:["geojson"]},"application/geo+json-seq":{source:"iana"},"application/geopackage+sqlite3":{source:"iana"},"application/geoxacml+xml":{source:"iana",compressible:!0},"application/gltf-buffer":{source:"iana"},"application/gml+xml":{source:"iana",compressible:!0,extensions:["gml"]},"application/gpx+xml":{source:"apache",compressible:!0,extensions:["gpx"]},"application/gxf":{source:"apache",extensions:["gxf"]},"application/gzip":{source:"iana",compressible:!1,extensions:["gz"]},"application/h224":{source:"iana"},"application/held+xml":{source:"iana",compressible:!0},"application/hjson":{extensions:["hjson"]},"application/http":{source:"iana"},"application/hyperstudio":{source:"iana",extensions:["stk"]},"application/ibe-key-request+xml":{source:"iana",compressible:!0},"application/ibe-pkg-reply+xml":{source:"iana",compressible:!0},"application/ibe-pp-data":{source:"iana"},"application/iges":{source:"iana"},"application/im-iscomposing+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/index":{source:"iana"},"application/index.cmd":{source:"iana"},"application/index.obj":{source:"iana"},"application/index.response":{source:"iana"},"application/index.vnd":{source:"iana"},"application/inkml+xml":{source:"iana",compressible:!0,extensions:["ink","inkml"]},"application/iotp":{source:"iana"},"application/ipfix":{source:"iana",extensions:["ipfix"]},"application/ipp":{source:"iana"},"application/isup":{source:"iana"},"application/its+xml":{source:"iana",compressible:!0,extensions:["its"]},"application/java-archive":{source:"apache",compressible:!1,extensions:["jar","war","ear"]},"application/java-serialized-object":{source:"apache",compressible:!1,extensions:["ser"]},"application/java-vm":{source:"apache",compressible:!1,extensions:["class"]},"application/javascript":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["js","mjs"]},"application/jf2feed+json":{source:"iana",compressible:!0},"application/jose":{source:"iana"},"application/jose+json":{source:"iana",compressible:!0},"application/jrd+json":{source:"iana",compressible:!0},"application/jscalendar+json":{source:"iana",compressible:!0},"application/json":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["json","map"]},"application/json-patch+json":{source:"iana",compressible:!0},"application/json-seq":{source:"iana"},"application/json5":{extensions:["json5"]},"application/jsonml+json":{source:"apache",compressible:!0,extensions:["jsonml"]},"application/jwk+json":{source:"iana",compressible:!0},"application/jwk-set+json":{source:"iana",compressible:!0},"application/jwt":{source:"iana"},"application/kpml-request+xml":{source:"iana",compressible:!0},"application/kpml-response+xml":{source:"iana",compressible:!0},"application/ld+json":{source:"iana",compressible:!0,extensions:["jsonld"]},"application/lgr+xml":{source:"iana",compressible:!0,extensions:["lgr"]},"application/link-format":{source:"iana"},"application/load-control+xml":{source:"iana",compressible:!0},"application/lost+xml":{source:"iana",compressible:!0,extensions:["lostxml"]},"application/lostsync+xml":{source:"iana",compressible:!0},"application/lpf+zip":{source:"iana",compressible:!1},"application/lxf":{source:"iana"},"application/mac-binhex40":{source:"iana",extensions:["hqx"]},"application/mac-compactpro":{source:"apache",extensions:["cpt"]},"application/macwriteii":{source:"iana"},"application/mads+xml":{source:"iana",compressible:!0,extensions:["mads"]},"application/manifest+json":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["webmanifest"]},"application/marc":{source:"iana",extensions:["mrc"]},"application/marcxml+xml":{source:"iana",compressible:!0,extensions:["mrcx"]},"application/mathematica":{source:"iana",extensions:["ma","nb","mb"]},"application/mathml+xml":{source:"iana",compressible:!0,extensions:["mathml"]},"application/mathml-content+xml":{source:"iana",compressible:!0},"application/mathml-presentation+xml":{source:"iana",compressible:!0},"application/mbms-associated-procedure-description+xml":{source:"iana",compressible:!0},"application/mbms-deregister+xml":{source:"iana",compressible:!0},"application/mbms-envelope+xml":{source:"iana",compressible:!0},"application/mbms-msk+xml":{source:"iana",compressible:!0},"application/mbms-msk-response+xml":{source:"iana",compressible:!0},"application/mbms-protection-description+xml":{source:"iana",compressible:!0},"application/mbms-reception-report+xml":{source:"iana",compressible:!0},"application/mbms-register+xml":{source:"iana",compressible:!0},"application/mbms-register-response+xml":{source:"iana",compressible:!0},"application/mbms-schedule+xml":{source:"iana",compressible:!0},"application/mbms-user-service-description+xml":{source:"iana",compressible:!0},"application/mbox":{source:"iana",extensions:["mbox"]},"application/media-policy-dataset+xml":{source:"iana",compressible:!0,extensions:["mpf"]},"application/media_control+xml":{source:"iana",compressible:!0},"application/mediaservercontrol+xml":{source:"iana",compressible:!0,extensions:["mscml"]},"application/merge-patch+json":{source:"iana",compressible:!0},"application/metalink+xml":{source:"apache",compressible:!0,extensions:["metalink"]},"application/metalink4+xml":{source:"iana",compressible:!0,extensions:["meta4"]},"application/mets+xml":{source:"iana",compressible:!0,extensions:["mets"]},"application/mf4":{source:"iana"},"application/mikey":{source:"iana"},"application/mipc":{source:"iana"},"application/missing-blocks+cbor-seq":{source:"iana"},"application/mmt-aei+xml":{source:"iana",compressible:!0,extensions:["maei"]},"application/mmt-usd+xml":{source:"iana",compressible:!0,extensions:["musd"]},"application/mods+xml":{source:"iana",compressible:!0,extensions:["mods"]},"application/moss-keys":{source:"iana"},"application/moss-signature":{source:"iana"},"application/mosskey-data":{source:"iana"},"application/mosskey-request":{source:"iana"},"application/mp21":{source:"iana",extensions:["m21","mp21"]},"application/mp4":{source:"iana",extensions:["mp4s","m4p"]},"application/mpeg4-generic":{source:"iana"},"application/mpeg4-iod":{source:"iana"},"application/mpeg4-iod-xmt":{source:"iana"},"application/mrb-consumer+xml":{source:"iana",compressible:!0},"application/mrb-publish+xml":{source:"iana",compressible:!0},"application/msc-ivr+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/msc-mixer+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/msword":{source:"iana",compressible:!1,extensions:["doc","dot"]},"application/mud+json":{source:"iana",compressible:!0},"application/multipart-core":{source:"iana"},"application/mxf":{source:"iana",extensions:["mxf"]},"application/n-quads":{source:"iana",extensions:["nq"]},"application/n-triples":{source:"iana",extensions:["nt"]},"application/nasdata":{source:"iana"},"application/news-checkgroups":{source:"iana",charset:"US-ASCII"},"application/news-groupinfo":{source:"iana",charset:"US-ASCII"},"application/news-transmission":{source:"iana"},"application/nlsml+xml":{source:"iana",compressible:!0},"application/node":{source:"iana",extensions:["cjs"]},"application/nss":{source:"iana"},"application/oauth-authz-req+jwt":{source:"iana"},"application/oblivious-dns-message":{source:"iana"},"application/ocsp-request":{source:"iana"},"application/ocsp-response":{source:"iana"},"application/octet-stream":{source:"iana",compressible:!1,extensions:["bin","dms","lrf","mar","so","dist","distz","pkg","bpk","dump","elc","deploy","exe","dll","deb","dmg","iso","img","msi","msp","msm","buffer"]},"application/oda":{source:"iana",extensions:["oda"]},"application/odm+xml":{source:"iana",compressible:!0},"application/odx":{source:"iana"},"application/oebps-package+xml":{source:"iana",compressible:!0,extensions:["opf"]},"application/ogg":{source:"iana",compressible:!1,extensions:["ogx"]},"application/omdoc+xml":{source:"apache",compressible:!0,extensions:["omdoc"]},"application/onenote":{source:"apache",extensions:["onetoc","onetoc2","onetmp","onepkg"]},"application/opc-nodeset+xml":{source:"iana",compressible:!0},"application/oscore":{source:"iana"},"application/oxps":{source:"iana",extensions:["oxps"]},"application/p21":{source:"iana"},"application/p21+zip":{source:"iana",compressible:!1},"application/p2p-overlay+xml":{source:"iana",compressible:!0,extensions:["relo"]},"application/parityfec":{source:"iana"},"application/passport":{source:"iana"},"application/patch-ops-error+xml":{source:"iana",compressible:!0,extensions:["xer"]},"application/pdf":{source:"iana",compressible:!1,extensions:["pdf"]},"application/pdx":{source:"iana"},"application/pem-certificate-chain":{source:"iana"},"application/pgp-encrypted":{source:"iana",compressible:!1,extensions:["pgp"]},"application/pgp-keys":{source:"iana",extensions:["asc"]},"application/pgp-signature":{source:"iana",extensions:["asc","sig"]},"application/pics-rules":{source:"apache",extensions:["prf"]},"application/pidf+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/pidf-diff+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/pkcs10":{source:"iana",extensions:["p10"]},"application/pkcs12":{source:"iana"},"application/pkcs7-mime":{source:"iana",extensions:["p7m","p7c"]},"application/pkcs7-signature":{source:"iana",extensions:["p7s"]},"application/pkcs8":{source:"iana",extensions:["p8"]},"application/pkcs8-encrypted":{source:"iana"},"application/pkix-attr-cert":{source:"iana",extensions:["ac"]},"application/pkix-cert":{source:"iana",extensions:["cer"]},"application/pkix-crl":{source:"iana",extensions:["crl"]},"application/pkix-pkipath":{source:"iana",extensions:["pkipath"]},"application/pkixcmp":{source:"iana",extensions:["pki"]},"application/pls+xml":{source:"iana",compressible:!0,extensions:["pls"]},"application/poc-settings+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/postscript":{source:"iana",compressible:!0,extensions:["ai","eps","ps"]},"application/ppsp-tracker+json":{source:"iana",compressible:!0},"application/problem+json":{source:"iana",compressible:!0},"application/problem+xml":{source:"iana",compressible:!0},"application/provenance+xml":{source:"iana",compressible:!0,extensions:["provx"]},"application/prs.alvestrand.titrax-sheet":{source:"iana"},"application/prs.cww":{source:"iana",extensions:["cww"]},"application/prs.cyn":{source:"iana",charset:"7-BIT"},"application/prs.hpub+zip":{source:"iana",compressible:!1},"application/prs.nprend":{source:"iana"},"application/prs.plucker":{source:"iana"},"application/prs.rdf-xml-crypt":{source:"iana"},"application/prs.xsf+xml":{source:"iana",compressible:!0},"application/pskc+xml":{source:"iana",compressible:!0,extensions:["pskcxml"]},"application/pvd+json":{source:"iana",compressible:!0},"application/qsig":{source:"iana"},"application/raml+yaml":{compressible:!0,extensions:["raml"]},"application/raptorfec":{source:"iana"},"application/rdap+json":{source:"iana",compressible:!0},"application/rdf+xml":{source:"iana",compressible:!0,extensions:["rdf","owl"]},"application/reginfo+xml":{source:"iana",compressible:!0,extensions:["rif"]},"application/relax-ng-compact-syntax":{source:"iana",extensions:["rnc"]},"application/remote-printing":{source:"iana"},"application/reputon+json":{source:"iana",compressible:!0},"application/resource-lists+xml":{source:"iana",compressible:!0,extensions:["rl"]},"application/resource-lists-diff+xml":{source:"iana",compressible:!0,extensions:["rld"]},"application/rfc+xml":{source:"iana",compressible:!0},"application/riscos":{source:"iana"},"application/rlmi+xml":{source:"iana",compressible:!0},"application/rls-services+xml":{source:"iana",compressible:!0,extensions:["rs"]},"application/route-apd+xml":{source:"iana",compressible:!0,extensions:["rapd"]},"application/route-s-tsid+xml":{source:"iana",compressible:!0,extensions:["sls"]},"application/route-usd+xml":{source:"iana",compressible:!0,extensions:["rusd"]},"application/rpki-ghostbusters":{source:"iana",extensions:["gbr"]},"application/rpki-manifest":{source:"iana",extensions:["mft"]},"application/rpki-publication":{source:"iana"},"application/rpki-roa":{source:"iana",extensions:["roa"]},"application/rpki-updown":{source:"iana"},"application/rsd+xml":{source:"apache",compressible:!0,extensions:["rsd"]},"application/rss+xml":{source:"apache",compressible:!0,extensions:["rss"]},"application/rtf":{source:"iana",compressible:!0,extensions:["rtf"]},"application/rtploopback":{source:"iana"},"application/rtx":{source:"iana"},"application/samlassertion+xml":{source:"iana",compressible:!0},"application/samlmetadata+xml":{source:"iana",compressible:!0},"application/sarif+json":{source:"iana",compressible:!0},"application/sarif-external-properties+json":{source:"iana",compressible:!0},"application/sbe":{source:"iana"},"application/sbml+xml":{source:"iana",compressible:!0,extensions:["sbml"]},"application/scaip+xml":{source:"iana",compressible:!0},"application/scim+json":{source:"iana",compressible:!0},"application/scvp-cv-request":{source:"iana",extensions:["scq"]},"application/scvp-cv-response":{source:"iana",extensions:["scs"]},"application/scvp-vp-request":{source:"iana",extensions:["spq"]},"application/scvp-vp-response":{source:"iana",extensions:["spp"]},"application/sdp":{source:"iana",extensions:["sdp"]},"application/secevent+jwt":{source:"iana"},"application/senml+cbor":{source:"iana"},"application/senml+json":{source:"iana",compressible:!0},"application/senml+xml":{source:"iana",compressible:!0,extensions:["senmlx"]},"application/senml-etch+cbor":{source:"iana"},"application/senml-etch+json":{source:"iana",compressible:!0},"application/senml-exi":{source:"iana"},"application/sensml+cbor":{source:"iana"},"application/sensml+json":{source:"iana",compressible:!0},"application/sensml+xml":{source:"iana",compressible:!0,extensions:["sensmlx"]},"application/sensml-exi":{source:"iana"},"application/sep+xml":{source:"iana",compressible:!0},"application/sep-exi":{source:"iana"},"application/session-info":{source:"iana"},"application/set-payment":{source:"iana"},"application/set-payment-initiation":{source:"iana",extensions:["setpay"]},"application/set-registration":{source:"iana"},"application/set-registration-initiation":{source:"iana",extensions:["setreg"]},"application/sgml":{source:"iana"},"application/sgml-open-catalog":{source:"iana"},"application/shf+xml":{source:"iana",compressible:!0,extensions:["shf"]},"application/sieve":{source:"iana",extensions:["siv","sieve"]},"application/simple-filter+xml":{source:"iana",compressible:!0},"application/simple-message-summary":{source:"iana"},"application/simplesymbolcontainer":{source:"iana"},"application/sipc":{source:"iana"},"application/slate":{source:"iana"},"application/smil":{source:"iana"},"application/smil+xml":{source:"iana",compressible:!0,extensions:["smi","smil"]},"application/smpte336m":{source:"iana"},"application/soap+fastinfoset":{source:"iana"},"application/soap+xml":{source:"iana",compressible:!0},"application/sparql-query":{source:"iana",extensions:["rq"]},"application/sparql-results+xml":{source:"iana",compressible:!0,extensions:["srx"]},"application/spdx+json":{source:"iana",compressible:!0},"application/spirits-event+xml":{source:"iana",compressible:!0},"application/sql":{source:"iana"},"application/srgs":{source:"iana",extensions:["gram"]},"application/srgs+xml":{source:"iana",compressible:!0,extensions:["grxml"]},"application/sru+xml":{source:"iana",compressible:!0,extensions:["sru"]},"application/ssdl+xml":{source:"apache",compressible:!0,extensions:["ssdl"]},"application/ssml+xml":{source:"iana",compressible:!0,extensions:["ssml"]},"application/stix+json":{source:"iana",compressible:!0},"application/swid+xml":{source:"iana",compressible:!0,extensions:["swidtag"]},"application/tamp-apex-update":{source:"iana"},"application/tamp-apex-update-confirm":{source:"iana"},"application/tamp-community-update":{source:"iana"},"application/tamp-community-update-confirm":{source:"iana"},"application/tamp-error":{source:"iana"},"application/tamp-sequence-adjust":{source:"iana"},"application/tamp-sequence-adjust-confirm":{source:"iana"},"application/tamp-status-query":{source:"iana"},"application/tamp-status-response":{source:"iana"},"application/tamp-update":{source:"iana"},"application/tamp-update-confirm":{source:"iana"},"application/tar":{compressible:!0},"application/taxii+json":{source:"iana",compressible:!0},"application/td+json":{source:"iana",compressible:!0},"application/tei+xml":{source:"iana",compressible:!0,extensions:["tei","teicorpus"]},"application/tetra_isi":{source:"iana"},"application/thraud+xml":{source:"iana",compressible:!0,extensions:["tfi"]},"application/timestamp-query":{source:"iana"},"application/timestamp-reply":{source:"iana"},"application/timestamped-data":{source:"iana",extensions:["tsd"]},"application/tlsrpt+gzip":{source:"iana"},"application/tlsrpt+json":{source:"iana",compressible:!0},"application/tnauthlist":{source:"iana"},"application/token-introspection+jwt":{source:"iana"},"application/toml":{compressible:!0,extensions:["toml"]},"application/trickle-ice-sdpfrag":{source:"iana"},"application/trig":{source:"iana",extensions:["trig"]},"application/ttml+xml":{source:"iana",compressible:!0,extensions:["ttml"]},"application/tve-trigger":{source:"iana"},"application/tzif":{source:"iana"},"application/tzif-leap":{source:"iana"},"application/ubjson":{compressible:!1,extensions:["ubj"]},"application/ulpfec":{source:"iana"},"application/urc-grpsheet+xml":{source:"iana",compressible:!0},"application/urc-ressheet+xml":{source:"iana",compressible:!0,extensions:["rsheet"]},"application/urc-targetdesc+xml":{source:"iana",compressible:!0,extensions:["td"]},"application/urc-uisocketdesc+xml":{source:"iana",compressible:!0},"application/vcard+json":{source:"iana",compressible:!0},"application/vcard+xml":{source:"iana",compressible:!0},"application/vemmi":{source:"iana"},"application/vividence.scriptfile":{source:"apache"},"application/vnd.1000minds.decision-model+xml":{source:"iana",compressible:!0,extensions:["1km"]},"application/vnd.3gpp-prose+xml":{source:"iana",compressible:!0},"application/vnd.3gpp-prose-pc3ch+xml":{source:"iana",compressible:!0},"application/vnd.3gpp-v2x-local-service-information":{source:"iana"},"application/vnd.3gpp.5gnas":{source:"iana"},"application/vnd.3gpp.access-transfer-events+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.bsf+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.gmop+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.gtpc":{source:"iana"},"application/vnd.3gpp.interworking-data":{source:"iana"},"application/vnd.3gpp.lpp":{source:"iana"},"application/vnd.3gpp.mc-signalling-ear":{source:"iana"},"application/vnd.3gpp.mcdata-affiliation-command+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-payload":{source:"iana"},"application/vnd.3gpp.mcdata-service-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-signalling":{source:"iana"},"application/vnd.3gpp.mcdata-ue-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcdata-user-profile+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-affiliation-command+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-floor-request+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-location-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-mbms-usage-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-service-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-signed+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-ue-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-ue-init-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcptt-user-profile+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-affiliation-command+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-affiliation-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-location-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-mbms-usage-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-service-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-transmission-request+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-ue-config+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mcvideo-user-profile+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.mid-call+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.ngap":{source:"iana"},"application/vnd.3gpp.pfcp":{source:"iana"},"application/vnd.3gpp.pic-bw-large":{source:"iana",extensions:["plb"]},"application/vnd.3gpp.pic-bw-small":{source:"iana",extensions:["psb"]},"application/vnd.3gpp.pic-bw-var":{source:"iana",extensions:["pvb"]},"application/vnd.3gpp.s1ap":{source:"iana"},"application/vnd.3gpp.sms":{source:"iana"},"application/vnd.3gpp.sms+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.srvcc-ext+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.srvcc-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.state-and-event-info+xml":{source:"iana",compressible:!0},"application/vnd.3gpp.ussd+xml":{source:"iana",compressible:!0},"application/vnd.3gpp2.bcmcsinfo+xml":{source:"iana",compressible:!0},"application/vnd.3gpp2.sms":{source:"iana"},"application/vnd.3gpp2.tcap":{source:"iana",extensions:["tcap"]},"application/vnd.3lightssoftware.imagescal":{source:"iana"},"application/vnd.3m.post-it-notes":{source:"iana",extensions:["pwn"]},"application/vnd.accpac.simply.aso":{source:"iana",extensions:["aso"]},"application/vnd.accpac.simply.imp":{source:"iana",extensions:["imp"]},"application/vnd.acucobol":{source:"iana",extensions:["acu"]},"application/vnd.acucorp":{source:"iana",extensions:["atc","acutc"]},"application/vnd.adobe.air-application-installer-package+zip":{source:"apache",compressible:!1,extensions:["air"]},"application/vnd.adobe.flash.movie":{source:"iana"},"application/vnd.adobe.formscentral.fcdt":{source:"iana",extensions:["fcdt"]},"application/vnd.adobe.fxp":{source:"iana",extensions:["fxp","fxpl"]},"application/vnd.adobe.partial-upload":{source:"iana"},"application/vnd.adobe.xdp+xml":{source:"iana",compressible:!0,extensions:["xdp"]},"application/vnd.adobe.xfdf":{source:"iana",extensions:["xfdf"]},"application/vnd.aether.imp":{source:"iana"},"application/vnd.afpc.afplinedata":{source:"iana"},"application/vnd.afpc.afplinedata-pagedef":{source:"iana"},"application/vnd.afpc.cmoca-cmresource":{source:"iana"},"application/vnd.afpc.foca-charset":{source:"iana"},"application/vnd.afpc.foca-codedfont":{source:"iana"},"application/vnd.afpc.foca-codepage":{source:"iana"},"application/vnd.afpc.modca":{source:"iana"},"application/vnd.afpc.modca-cmtable":{source:"iana"},"application/vnd.afpc.modca-formdef":{source:"iana"},"application/vnd.afpc.modca-mediummap":{source:"iana"},"application/vnd.afpc.modca-objectcontainer":{source:"iana"},"application/vnd.afpc.modca-overlay":{source:"iana"},"application/vnd.afpc.modca-pagesegment":{source:"iana"},"application/vnd.age":{source:"iana",extensions:["age"]},"application/vnd.ah-barcode":{source:"iana"},"application/vnd.ahead.space":{source:"iana",extensions:["ahead"]},"application/vnd.airzip.filesecure.azf":{source:"iana",extensions:["azf"]},"application/vnd.airzip.filesecure.azs":{source:"iana",extensions:["azs"]},"application/vnd.amadeus+json":{source:"iana",compressible:!0},"application/vnd.amazon.ebook":{source:"apache",extensions:["azw"]},"application/vnd.amazon.mobi8-ebook":{source:"iana"},"application/vnd.americandynamics.acc":{source:"iana",extensions:["acc"]},"application/vnd.amiga.ami":{source:"iana",extensions:["ami"]},"application/vnd.amundsen.maze+xml":{source:"iana",compressible:!0},"application/vnd.android.ota":{source:"iana"},"application/vnd.android.package-archive":{source:"apache",compressible:!1,extensions:["apk"]},"application/vnd.anki":{source:"iana"},"application/vnd.anser-web-certificate-issue-initiation":{source:"iana",extensions:["cii"]},"application/vnd.anser-web-funds-transfer-initiation":{source:"apache",extensions:["fti"]},"application/vnd.antix.game-component":{source:"iana",extensions:["atx"]},"application/vnd.apache.arrow.file":{source:"iana"},"application/vnd.apache.arrow.stream":{source:"iana"},"application/vnd.apache.thrift.binary":{source:"iana"},"application/vnd.apache.thrift.compact":{source:"iana"},"application/vnd.apache.thrift.json":{source:"iana"},"application/vnd.api+json":{source:"iana",compressible:!0},"application/vnd.aplextor.warrp+json":{source:"iana",compressible:!0},"application/vnd.apothekende.reservation+json":{source:"iana",compressible:!0},"application/vnd.apple.installer+xml":{source:"iana",compressible:!0,extensions:["mpkg"]},"application/vnd.apple.keynote":{source:"iana",extensions:["key"]},"application/vnd.apple.mpegurl":{source:"iana",extensions:["m3u8"]},"application/vnd.apple.numbers":{source:"iana",extensions:["numbers"]},"application/vnd.apple.pages":{source:"iana",extensions:["pages"]},"application/vnd.apple.pkpass":{compressible:!1,extensions:["pkpass"]},"application/vnd.arastra.swi":{source:"iana"},"application/vnd.aristanetworks.swi":{source:"iana",extensions:["swi"]},"application/vnd.artisan+json":{source:"iana",compressible:!0},"application/vnd.artsquare":{source:"iana"},"application/vnd.astraea-software.iota":{source:"iana",extensions:["iota"]},"application/vnd.audiograph":{source:"iana",extensions:["aep"]},"application/vnd.autopackage":{source:"iana"},"application/vnd.avalon+json":{source:"iana",compressible:!0},"application/vnd.avistar+xml":{source:"iana",compressible:!0},"application/vnd.balsamiq.bmml+xml":{source:"iana",compressible:!0,extensions:["bmml"]},"application/vnd.balsamiq.bmpr":{source:"iana"},"application/vnd.banana-accounting":{source:"iana"},"application/vnd.bbf.usp.error":{source:"iana"},"application/vnd.bbf.usp.msg":{source:"iana"},"application/vnd.bbf.usp.msg+json":{source:"iana",compressible:!0},"application/vnd.bekitzur-stech+json":{source:"iana",compressible:!0},"application/vnd.bint.med-content":{source:"iana"},"application/vnd.biopax.rdf+xml":{source:"iana",compressible:!0},"application/vnd.blink-idb-value-wrapper":{source:"iana"},"application/vnd.blueice.multipass":{source:"iana",extensions:["mpm"]},"application/vnd.bluetooth.ep.oob":{source:"iana"},"application/vnd.bluetooth.le.oob":{source:"iana"},"application/vnd.bmi":{source:"iana",extensions:["bmi"]},"application/vnd.bpf":{source:"iana"},"application/vnd.bpf3":{source:"iana"},"application/vnd.businessobjects":{source:"iana",extensions:["rep"]},"application/vnd.byu.uapi+json":{source:"iana",compressible:!0},"application/vnd.cab-jscript":{source:"iana"},"application/vnd.canon-cpdl":{source:"iana"},"application/vnd.canon-lips":{source:"iana"},"application/vnd.capasystems-pg+json":{source:"iana",compressible:!0},"application/vnd.cendio.thinlinc.clientconf":{source:"iana"},"application/vnd.century-systems.tcp_stream":{source:"iana"},"application/vnd.chemdraw+xml":{source:"iana",compressible:!0,extensions:["cdxml"]},"application/vnd.chess-pgn":{source:"iana"},"application/vnd.chipnuts.karaoke-mmd":{source:"iana",extensions:["mmd"]},"application/vnd.ciedi":{source:"iana"},"application/vnd.cinderella":{source:"iana",extensions:["cdy"]},"application/vnd.cirpack.isdn-ext":{source:"iana"},"application/vnd.citationstyles.style+xml":{source:"iana",compressible:!0,extensions:["csl"]},"application/vnd.claymore":{source:"iana",extensions:["cla"]},"application/vnd.cloanto.rp9":{source:"iana",extensions:["rp9"]},"application/vnd.clonk.c4group":{source:"iana",extensions:["c4g","c4d","c4f","c4p","c4u"]},"application/vnd.cluetrust.cartomobile-config":{source:"iana",extensions:["c11amc"]},"application/vnd.cluetrust.cartomobile-config-pkg":{source:"iana",extensions:["c11amz"]},"application/vnd.coffeescript":{source:"iana"},"application/vnd.collabio.xodocuments.document":{source:"iana"},"application/vnd.collabio.xodocuments.document-template":{source:"iana"},"application/vnd.collabio.xodocuments.presentation":{source:"iana"},"application/vnd.collabio.xodocuments.presentation-template":{source:"iana"},"application/vnd.collabio.xodocuments.spreadsheet":{source:"iana"},"application/vnd.collabio.xodocuments.spreadsheet-template":{source:"iana"},"application/vnd.collection+json":{source:"iana",compressible:!0},"application/vnd.collection.doc+json":{source:"iana",compressible:!0},"application/vnd.collection.next+json":{source:"iana",compressible:!0},"application/vnd.comicbook+zip":{source:"iana",compressible:!1},"application/vnd.comicbook-rar":{source:"iana"},"application/vnd.commerce-battelle":{source:"iana"},"application/vnd.commonspace":{source:"iana",extensions:["csp"]},"application/vnd.contact.cmsg":{source:"iana",extensions:["cdbcmsg"]},"application/vnd.coreos.ignition+json":{source:"iana",compressible:!0},"application/vnd.cosmocaller":{source:"iana",extensions:["cmc"]},"application/vnd.crick.clicker":{source:"iana",extensions:["clkx"]},"application/vnd.crick.clicker.keyboard":{source:"iana",extensions:["clkk"]},"application/vnd.crick.clicker.palette":{source:"iana",extensions:["clkp"]},"application/vnd.crick.clicker.template":{source:"iana",extensions:["clkt"]},"application/vnd.crick.clicker.wordbank":{source:"iana",extensions:["clkw"]},"application/vnd.criticaltools.wbs+xml":{source:"iana",compressible:!0,extensions:["wbs"]},"application/vnd.cryptii.pipe+json":{source:"iana",compressible:!0},"application/vnd.crypto-shade-file":{source:"iana"},"application/vnd.cryptomator.encrypted":{source:"iana"},"application/vnd.cryptomator.vault":{source:"iana"},"application/vnd.ctc-posml":{source:"iana",extensions:["pml"]},"application/vnd.ctct.ws+xml":{source:"iana",compressible:!0},"application/vnd.cups-pdf":{source:"iana"},"application/vnd.cups-postscript":{source:"iana"},"application/vnd.cups-ppd":{source:"iana",extensions:["ppd"]},"application/vnd.cups-raster":{source:"iana"},"application/vnd.cups-raw":{source:"iana"},"application/vnd.curl":{source:"iana"},"application/vnd.curl.car":{source:"apache",extensions:["car"]},"application/vnd.curl.pcurl":{source:"apache",extensions:["pcurl"]},"application/vnd.cyan.dean.root+xml":{source:"iana",compressible:!0},"application/vnd.cybank":{source:"iana"},"application/vnd.cyclonedx+json":{source:"iana",compressible:!0},"application/vnd.cyclonedx+xml":{source:"iana",compressible:!0},"application/vnd.d2l.coursepackage1p0+zip":{source:"iana",compressible:!1},"application/vnd.d3m-dataset":{source:"iana"},"application/vnd.d3m-problem":{source:"iana"},"application/vnd.dart":{source:"iana",compressible:!0,extensions:["dart"]},"application/vnd.data-vision.rdz":{source:"iana",extensions:["rdz"]},"application/vnd.datapackage+json":{source:"iana",compressible:!0},"application/vnd.dataresource+json":{source:"iana",compressible:!0},"application/vnd.dbf":{source:"iana",extensions:["dbf"]},"application/vnd.debian.binary-package":{source:"iana"},"application/vnd.dece.data":{source:"iana",extensions:["uvf","uvvf","uvd","uvvd"]},"application/vnd.dece.ttml+xml":{source:"iana",compressible:!0,extensions:["uvt","uvvt"]},"application/vnd.dece.unspecified":{source:"iana",extensions:["uvx","uvvx"]},"application/vnd.dece.zip":{source:"iana",extensions:["uvz","uvvz"]},"application/vnd.denovo.fcselayout-link":{source:"iana",extensions:["fe_launch"]},"application/vnd.desmume.movie":{source:"iana"},"application/vnd.dir-bi.plate-dl-nosuffix":{source:"iana"},"application/vnd.dm.delegation+xml":{source:"iana",compressible:!0},"application/vnd.dna":{source:"iana",extensions:["dna"]},"application/vnd.document+json":{source:"iana",compressible:!0},"application/vnd.dolby.mlp":{source:"apache",extensions:["mlp"]},"application/vnd.dolby.mobile.1":{source:"iana"},"application/vnd.dolby.mobile.2":{source:"iana"},"application/vnd.doremir.scorecloud-binary-document":{source:"iana"},"application/vnd.dpgraph":{source:"iana",extensions:["dpg"]},"application/vnd.dreamfactory":{source:"iana",extensions:["dfac"]},"application/vnd.drive+json":{source:"iana",compressible:!0},"application/vnd.ds-keypoint":{source:"apache",extensions:["kpxx"]},"application/vnd.dtg.local":{source:"iana"},"application/vnd.dtg.local.flash":{source:"iana"},"application/vnd.dtg.local.html":{source:"iana"},"application/vnd.dvb.ait":{source:"iana",extensions:["ait"]},"application/vnd.dvb.dvbisl+xml":{source:"iana",compressible:!0},"application/vnd.dvb.dvbj":{source:"iana"},"application/vnd.dvb.esgcontainer":{source:"iana"},"application/vnd.dvb.ipdcdftnotifaccess":{source:"iana"},"application/vnd.dvb.ipdcesgaccess":{source:"iana"},"application/vnd.dvb.ipdcesgaccess2":{source:"iana"},"application/vnd.dvb.ipdcesgpdd":{source:"iana"},"application/vnd.dvb.ipdcroaming":{source:"iana"},"application/vnd.dvb.iptv.alfec-base":{source:"iana"},"application/vnd.dvb.iptv.alfec-enhancement":{source:"iana"},"application/vnd.dvb.notif-aggregate-root+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-container+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-generic+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-ia-msglist+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-ia-registration-request+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-ia-registration-response+xml":{source:"iana",compressible:!0},"application/vnd.dvb.notif-init+xml":{source:"iana",compressible:!0},"application/vnd.dvb.pfr":{source:"iana"},"application/vnd.dvb.service":{source:"iana",extensions:["svc"]},"application/vnd.dxr":{source:"iana"},"application/vnd.dynageo":{source:"iana",extensions:["geo"]},"application/vnd.dzr":{source:"iana"},"application/vnd.easykaraoke.cdgdownload":{source:"iana"},"application/vnd.ecdis-update":{source:"iana"},"application/vnd.ecip.rlp":{source:"iana"},"application/vnd.eclipse.ditto+json":{source:"iana",compressible:!0},"application/vnd.ecowin.chart":{source:"iana",extensions:["mag"]},"application/vnd.ecowin.filerequest":{source:"iana"},"application/vnd.ecowin.fileupdate":{source:"iana"},"application/vnd.ecowin.series":{source:"iana"},"application/vnd.ecowin.seriesrequest":{source:"iana"},"application/vnd.ecowin.seriesupdate":{source:"iana"},"application/vnd.efi.img":{source:"iana"},"application/vnd.efi.iso":{source:"iana"},"application/vnd.emclient.accessrequest+xml":{source:"iana",compressible:!0},"application/vnd.enliven":{source:"iana",extensions:["nml"]},"application/vnd.enphase.envoy":{source:"iana"},"application/vnd.eprints.data+xml":{source:"iana",compressible:!0},"application/vnd.epson.esf":{source:"iana",extensions:["esf"]},"application/vnd.epson.msf":{source:"iana",extensions:["msf"]},"application/vnd.epson.quickanime":{source:"iana",extensions:["qam"]},"application/vnd.epson.salt":{source:"iana",extensions:["slt"]},"application/vnd.epson.ssf":{source:"iana",extensions:["ssf"]},"application/vnd.ericsson.quickcall":{source:"iana"},"application/vnd.espass-espass+zip":{source:"iana",compressible:!1},"application/vnd.eszigno3+xml":{source:"iana",compressible:!0,extensions:["es3","et3"]},"application/vnd.etsi.aoc+xml":{source:"iana",compressible:!0},"application/vnd.etsi.asic-e+zip":{source:"iana",compressible:!1},"application/vnd.etsi.asic-s+zip":{source:"iana",compressible:!1},"application/vnd.etsi.cug+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvcommand+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvdiscovery+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvprofile+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsad-bc+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsad-cod+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsad-npvr+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvservice+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvsync+xml":{source:"iana",compressible:!0},"application/vnd.etsi.iptvueprofile+xml":{source:"iana",compressible:!0},"application/vnd.etsi.mcid+xml":{source:"iana",compressible:!0},"application/vnd.etsi.mheg5":{source:"iana"},"application/vnd.etsi.overload-control-policy-dataset+xml":{source:"iana",compressible:!0},"application/vnd.etsi.pstn+xml":{source:"iana",compressible:!0},"application/vnd.etsi.sci+xml":{source:"iana",compressible:!0},"application/vnd.etsi.simservs+xml":{source:"iana",compressible:!0},"application/vnd.etsi.timestamp-token":{source:"iana"},"application/vnd.etsi.tsl+xml":{source:"iana",compressible:!0},"application/vnd.etsi.tsl.der":{source:"iana"},"application/vnd.eu.kasparian.car+json":{source:"iana",compressible:!0},"application/vnd.eudora.data":{source:"iana"},"application/vnd.evolv.ecig.profile":{source:"iana"},"application/vnd.evolv.ecig.settings":{source:"iana"},"application/vnd.evolv.ecig.theme":{source:"iana"},"application/vnd.exstream-empower+zip":{source:"iana",compressible:!1},"application/vnd.exstream-package":{source:"iana"},"application/vnd.ezpix-album":{source:"iana",extensions:["ez2"]},"application/vnd.ezpix-package":{source:"iana",extensions:["ez3"]},"application/vnd.f-secure.mobile":{source:"iana"},"application/vnd.familysearch.gedcom+zip":{source:"iana",compressible:!1},"application/vnd.fastcopy-disk-image":{source:"iana"},"application/vnd.fdf":{source:"iana",extensions:["fdf"]},"application/vnd.fdsn.mseed":{source:"iana",extensions:["mseed"]},"application/vnd.fdsn.seed":{source:"iana",extensions:["seed","dataless"]},"application/vnd.ffsns":{source:"iana"},"application/vnd.ficlab.flb+zip":{source:"iana",compressible:!1},"application/vnd.filmit.zfc":{source:"iana"},"application/vnd.fints":{source:"iana"},"application/vnd.firemonkeys.cloudcell":{source:"iana"},"application/vnd.flographit":{source:"iana",extensions:["gph"]},"application/vnd.fluxtime.clip":{source:"iana",extensions:["ftc"]},"application/vnd.font-fontforge-sfd":{source:"iana"},"application/vnd.framemaker":{source:"iana",extensions:["fm","frame","maker","book"]},"application/vnd.frogans.fnc":{source:"iana",extensions:["fnc"]},"application/vnd.frogans.ltf":{source:"iana",extensions:["ltf"]},"application/vnd.fsc.weblaunch":{source:"iana",extensions:["fsc"]},"application/vnd.fujifilm.fb.docuworks":{source:"iana"},"application/vnd.fujifilm.fb.docuworks.binder":{source:"iana"},"application/vnd.fujifilm.fb.docuworks.container":{source:"iana"},"application/vnd.fujifilm.fb.jfi+xml":{source:"iana",compressible:!0},"application/vnd.fujitsu.oasys":{source:"iana",extensions:["oas"]},"application/vnd.fujitsu.oasys2":{source:"iana",extensions:["oa2"]},"application/vnd.fujitsu.oasys3":{source:"iana",extensions:["oa3"]},"application/vnd.fujitsu.oasysgp":{source:"iana",extensions:["fg5"]},"application/vnd.fujitsu.oasysprs":{source:"iana",extensions:["bh2"]},"application/vnd.fujixerox.art-ex":{source:"iana"},"application/vnd.fujixerox.art4":{source:"iana"},"application/vnd.fujixerox.ddd":{source:"iana",extensions:["ddd"]},"application/vnd.fujixerox.docuworks":{source:"iana",extensions:["xdw"]},"application/vnd.fujixerox.docuworks.binder":{source:"iana",extensions:["xbd"]},"application/vnd.fujixerox.docuworks.container":{source:"iana"},"application/vnd.fujixerox.hbpl":{source:"iana"},"application/vnd.fut-misnet":{source:"iana"},"application/vnd.futoin+cbor":{source:"iana"},"application/vnd.futoin+json":{source:"iana",compressible:!0},"application/vnd.fuzzysheet":{source:"iana",extensions:["fzs"]},"application/vnd.genomatix.tuxedo":{source:"iana",extensions:["txd"]},"application/vnd.gentics.grd+json":{source:"iana",compressible:!0},"application/vnd.geo+json":{source:"iana",compressible:!0},"application/vnd.geocube+xml":{source:"iana",compressible:!0},"application/vnd.geogebra.file":{source:"iana",extensions:["ggb"]},"application/vnd.geogebra.slides":{source:"iana"},"application/vnd.geogebra.tool":{source:"iana",extensions:["ggt"]},"application/vnd.geometry-explorer":{source:"iana",extensions:["gex","gre"]},"application/vnd.geonext":{source:"iana",extensions:["gxt"]},"application/vnd.geoplan":{source:"iana",extensions:["g2w"]},"application/vnd.geospace":{source:"iana",extensions:["g3w"]},"application/vnd.gerber":{source:"iana"},"application/vnd.globalplatform.card-content-mgt":{source:"iana"},"application/vnd.globalplatform.card-content-mgt-response":{source:"iana"},"application/vnd.gmx":{source:"iana",extensions:["gmx"]},"application/vnd.google-apps.document":{compressible:!1,extensions:["gdoc"]},"application/vnd.google-apps.presentation":{compressible:!1,extensions:["gslides"]},"application/vnd.google-apps.spreadsheet":{compressible:!1,extensions:["gsheet"]},"application/vnd.google-earth.kml+xml":{source:"iana",compressible:!0,extensions:["kml"]},"application/vnd.google-earth.kmz":{source:"iana",compressible:!1,extensions:["kmz"]},"application/vnd.gov.sk.e-form+xml":{source:"iana",compressible:!0},"application/vnd.gov.sk.e-form+zip":{source:"iana",compressible:!1},"application/vnd.gov.sk.xmldatacontainer+xml":{source:"iana",compressible:!0},"application/vnd.grafeq":{source:"iana",extensions:["gqf","gqs"]},"application/vnd.gridmp":{source:"iana"},"application/vnd.groove-account":{source:"iana",extensions:["gac"]},"application/vnd.groove-help":{source:"iana",extensions:["ghf"]},"application/vnd.groove-identity-message":{source:"iana",extensions:["gim"]},"application/vnd.groove-injector":{source:"iana",extensions:["grv"]},"application/vnd.groove-tool-message":{source:"iana",extensions:["gtm"]},"application/vnd.groove-tool-template":{source:"iana",extensions:["tpl"]},"application/vnd.groove-vcard":{source:"iana",extensions:["vcg"]},"application/vnd.hal+json":{source:"iana",compressible:!0},"application/vnd.hal+xml":{source:"iana",compressible:!0,extensions:["hal"]},"application/vnd.handheld-entertainment+xml":{source:"iana",compressible:!0,extensions:["zmm"]},"application/vnd.hbci":{source:"iana",extensions:["hbci"]},"application/vnd.hc+json":{source:"iana",compressible:!0},"application/vnd.hcl-bireports":{source:"iana"},"application/vnd.hdt":{source:"iana"},"application/vnd.heroku+json":{source:"iana",compressible:!0},"application/vnd.hhe.lesson-player":{source:"iana",extensions:["les"]},"application/vnd.hl7cda+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.hl7v2+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.hp-hpgl":{source:"iana",extensions:["hpgl"]},"application/vnd.hp-hpid":{source:"iana",extensions:["hpid"]},"application/vnd.hp-hps":{source:"iana",extensions:["hps"]},"application/vnd.hp-jlyt":{source:"iana",extensions:["jlt"]},"application/vnd.hp-pcl":{source:"iana",extensions:["pcl"]},"application/vnd.hp-pclxl":{source:"iana",extensions:["pclxl"]},"application/vnd.httphone":{source:"iana"},"application/vnd.hydrostatix.sof-data":{source:"iana",extensions:["sfd-hdstx"]},"application/vnd.hyper+json":{source:"iana",compressible:!0},"application/vnd.hyper-item+json":{source:"iana",compressible:!0},"application/vnd.hyperdrive+json":{source:"iana",compressible:!0},"application/vnd.hzn-3d-crossword":{source:"iana"},"application/vnd.ibm.afplinedata":{source:"iana"},"application/vnd.ibm.electronic-media":{source:"iana"},"application/vnd.ibm.minipay":{source:"iana",extensions:["mpy"]},"application/vnd.ibm.modcap":{source:"iana",extensions:["afp","listafp","list3820"]},"application/vnd.ibm.rights-management":{source:"iana",extensions:["irm"]},"application/vnd.ibm.secure-container":{source:"iana",extensions:["sc"]},"application/vnd.iccprofile":{source:"iana",extensions:["icc","icm"]},"application/vnd.ieee.1905":{source:"iana"},"application/vnd.igloader":{source:"iana",extensions:["igl"]},"application/vnd.imagemeter.folder+zip":{source:"iana",compressible:!1},"application/vnd.imagemeter.image+zip":{source:"iana",compressible:!1},"application/vnd.immervision-ivp":{source:"iana",extensions:["ivp"]},"application/vnd.immervision-ivu":{source:"iana",extensions:["ivu"]},"application/vnd.ims.imsccv1p1":{source:"iana"},"application/vnd.ims.imsccv1p2":{source:"iana"},"application/vnd.ims.imsccv1p3":{source:"iana"},"application/vnd.ims.lis.v2.result+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolconsumerprofile+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolproxy+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolproxy.id+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolsettings+json":{source:"iana",compressible:!0},"application/vnd.ims.lti.v2.toolsettings.simple+json":{source:"iana",compressible:!0},"application/vnd.informedcontrol.rms+xml":{source:"iana",compressible:!0},"application/vnd.informix-visionary":{source:"iana"},"application/vnd.infotech.project":{source:"iana"},"application/vnd.infotech.project+xml":{source:"iana",compressible:!0},"application/vnd.innopath.wamp.notification":{source:"iana"},"application/vnd.insors.igm":{source:"iana",extensions:["igm"]},"application/vnd.intercon.formnet":{source:"iana",extensions:["xpw","xpx"]},"application/vnd.intergeo":{source:"iana",extensions:["i2g"]},"application/vnd.intertrust.digibox":{source:"iana"},"application/vnd.intertrust.nncp":{source:"iana"},"application/vnd.intu.qbo":{source:"iana",extensions:["qbo"]},"application/vnd.intu.qfx":{source:"iana",extensions:["qfx"]},"application/vnd.iptc.g2.catalogitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.conceptitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.knowledgeitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.newsitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.newsmessage+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.packageitem+xml":{source:"iana",compressible:!0},"application/vnd.iptc.g2.planningitem+xml":{source:"iana",compressible:!0},"application/vnd.ipunplugged.rcprofile":{source:"iana",extensions:["rcprofile"]},"application/vnd.irepository.package+xml":{source:"iana",compressible:!0,extensions:["irp"]},"application/vnd.is-xpr":{source:"iana",extensions:["xpr"]},"application/vnd.isac.fcs":{source:"iana",extensions:["fcs"]},"application/vnd.iso11783-10+zip":{source:"iana",compressible:!1},"application/vnd.jam":{source:"iana",extensions:["jam"]},"application/vnd.japannet-directory-service":{source:"iana"},"application/vnd.japannet-jpnstore-wakeup":{source:"iana"},"application/vnd.japannet-payment-wakeup":{source:"iana"},"application/vnd.japannet-registration":{source:"iana"},"application/vnd.japannet-registration-wakeup":{source:"iana"},"application/vnd.japannet-setstore-wakeup":{source:"iana"},"application/vnd.japannet-verification":{source:"iana"},"application/vnd.japannet-verification-wakeup":{source:"iana"},"application/vnd.jcp.javame.midlet-rms":{source:"iana",extensions:["rms"]},"application/vnd.jisp":{source:"iana",extensions:["jisp"]},"application/vnd.joost.joda-archive":{source:"iana",extensions:["joda"]},"application/vnd.jsk.isdn-ngn":{source:"iana"},"application/vnd.kahootz":{source:"iana",extensions:["ktz","ktr"]},"application/vnd.kde.karbon":{source:"iana",extensions:["karbon"]},"application/vnd.kde.kchart":{source:"iana",extensions:["chrt"]},"application/vnd.kde.kformula":{source:"iana",extensions:["kfo"]},"application/vnd.kde.kivio":{source:"iana",extensions:["flw"]},"application/vnd.kde.kontour":{source:"iana",extensions:["kon"]},"application/vnd.kde.kpresenter":{source:"iana",extensions:["kpr","kpt"]},"application/vnd.kde.kspread":{source:"iana",extensions:["ksp"]},"application/vnd.kde.kword":{source:"iana",extensions:["kwd","kwt"]},"application/vnd.kenameaapp":{source:"iana",extensions:["htke"]},"application/vnd.kidspiration":{source:"iana",extensions:["kia"]},"application/vnd.kinar":{source:"iana",extensions:["kne","knp"]},"application/vnd.koan":{source:"iana",extensions:["skp","skd","skt","skm"]},"application/vnd.kodak-descriptor":{source:"iana",extensions:["sse"]},"application/vnd.las":{source:"iana"},"application/vnd.las.las+json":{source:"iana",compressible:!0},"application/vnd.las.las+xml":{source:"iana",compressible:!0,extensions:["lasxml"]},"application/vnd.laszip":{source:"iana"},"application/vnd.leap+json":{source:"iana",compressible:!0},"application/vnd.liberty-request+xml":{source:"iana",compressible:!0},"application/vnd.llamagraphics.life-balance.desktop":{source:"iana",extensions:["lbd"]},"application/vnd.llamagraphics.life-balance.exchange+xml":{source:"iana",compressible:!0,extensions:["lbe"]},"application/vnd.logipipe.circuit+zip":{source:"iana",compressible:!1},"application/vnd.loom":{source:"iana"},"application/vnd.lotus-1-2-3":{source:"iana",extensions:["123"]},"application/vnd.lotus-approach":{source:"iana",extensions:["apr"]},"application/vnd.lotus-freelance":{source:"iana",extensions:["pre"]},"application/vnd.lotus-notes":{source:"iana",extensions:["nsf"]},"application/vnd.lotus-organizer":{source:"iana",extensions:["org"]},"application/vnd.lotus-screencam":{source:"iana",extensions:["scm"]},"application/vnd.lotus-wordpro":{source:"iana",extensions:["lwp"]},"application/vnd.macports.portpkg":{source:"iana",extensions:["portpkg"]},"application/vnd.mapbox-vector-tile":{source:"iana",extensions:["mvt"]},"application/vnd.marlin.drm.actiontoken+xml":{source:"iana",compressible:!0},"application/vnd.marlin.drm.conftoken+xml":{source:"iana",compressible:!0},"application/vnd.marlin.drm.license+xml":{source:"iana",compressible:!0},"application/vnd.marlin.drm.mdcf":{source:"iana"},"application/vnd.mason+json":{source:"iana",compressible:!0},"application/vnd.maxar.archive.3tz+zip":{source:"iana",compressible:!1},"application/vnd.maxmind.maxmind-db":{source:"iana"},"application/vnd.mcd":{source:"iana",extensions:["mcd"]},"application/vnd.medcalcdata":{source:"iana",extensions:["mc1"]},"application/vnd.mediastation.cdkey":{source:"iana",extensions:["cdkey"]},"application/vnd.meridian-slingshot":{source:"iana"},"application/vnd.mfer":{source:"iana",extensions:["mwf"]},"application/vnd.mfmp":{source:"iana",extensions:["mfm"]},"application/vnd.micro+json":{source:"iana",compressible:!0},"application/vnd.micrografx.flo":{source:"iana",extensions:["flo"]},"application/vnd.micrografx.igx":{source:"iana",extensions:["igx"]},"application/vnd.microsoft.portable-executable":{source:"iana"},"application/vnd.microsoft.windows.thumbnail-cache":{source:"iana"},"application/vnd.miele+json":{source:"iana",compressible:!0},"application/vnd.mif":{source:"iana",extensions:["mif"]},"application/vnd.minisoft-hp3000-save":{source:"iana"},"application/vnd.mitsubishi.misty-guard.trustweb":{source:"iana"},"application/vnd.mobius.daf":{source:"iana",extensions:["daf"]},"application/vnd.mobius.dis":{source:"iana",extensions:["dis"]},"application/vnd.mobius.mbk":{source:"iana",extensions:["mbk"]},"application/vnd.mobius.mqy":{source:"iana",extensions:["mqy"]},"application/vnd.mobius.msl":{source:"iana",extensions:["msl"]},"application/vnd.mobius.plc":{source:"iana",extensions:["plc"]},"application/vnd.mobius.txf":{source:"iana",extensions:["txf"]},"application/vnd.mophun.application":{source:"iana",extensions:["mpn"]},"application/vnd.mophun.certificate":{source:"iana",extensions:["mpc"]},"application/vnd.motorola.flexsuite":{source:"iana"},"application/vnd.motorola.flexsuite.adsi":{source:"iana"},"application/vnd.motorola.flexsuite.fis":{source:"iana"},"application/vnd.motorola.flexsuite.gotap":{source:"iana"},"application/vnd.motorola.flexsuite.kmr":{source:"iana"},"application/vnd.motorola.flexsuite.ttc":{source:"iana"},"application/vnd.motorola.flexsuite.wem":{source:"iana"},"application/vnd.motorola.iprm":{source:"iana"},"application/vnd.mozilla.xul+xml":{source:"iana",compressible:!0,extensions:["xul"]},"application/vnd.ms-3mfdocument":{source:"iana"},"application/vnd.ms-artgalry":{source:"iana",extensions:["cil"]},"application/vnd.ms-asf":{source:"iana"},"application/vnd.ms-cab-compressed":{source:"iana",extensions:["cab"]},"application/vnd.ms-color.iccprofile":{source:"apache"},"application/vnd.ms-excel":{source:"iana",compressible:!1,extensions:["xls","xlm","xla","xlc","xlt","xlw"]},"application/vnd.ms-excel.addin.macroenabled.12":{source:"iana",extensions:["xlam"]},"application/vnd.ms-excel.sheet.binary.macroenabled.12":{source:"iana",extensions:["xlsb"]},"application/vnd.ms-excel.sheet.macroenabled.12":{source:"iana",extensions:["xlsm"]},"application/vnd.ms-excel.template.macroenabled.12":{source:"iana",extensions:["xltm"]},"application/vnd.ms-fontobject":{source:"iana",compressible:!0,extensions:["eot"]},"application/vnd.ms-htmlhelp":{source:"iana",extensions:["chm"]},"application/vnd.ms-ims":{source:"iana",extensions:["ims"]},"application/vnd.ms-lrm":{source:"iana",extensions:["lrm"]},"application/vnd.ms-office.activex+xml":{source:"iana",compressible:!0},"application/vnd.ms-officetheme":{source:"iana",extensions:["thmx"]},"application/vnd.ms-opentype":{source:"apache",compressible:!0},"application/vnd.ms-outlook":{compressible:!1,extensions:["msg"]},"application/vnd.ms-package.obfuscated-opentype":{source:"apache"},"application/vnd.ms-pki.seccat":{source:"apache",extensions:["cat"]},"application/vnd.ms-pki.stl":{source:"apache",extensions:["stl"]},"application/vnd.ms-playready.initiator+xml":{source:"iana",compressible:!0},"application/vnd.ms-powerpoint":{source:"iana",compressible:!1,extensions:["ppt","pps","pot"]},"application/vnd.ms-powerpoint.addin.macroenabled.12":{source:"iana",extensions:["ppam"]},"application/vnd.ms-powerpoint.presentation.macroenabled.12":{source:"iana",extensions:["pptm"]},"application/vnd.ms-powerpoint.slide.macroenabled.12":{source:"iana",extensions:["sldm"]},"application/vnd.ms-powerpoint.slideshow.macroenabled.12":{source:"iana",extensions:["ppsm"]},"application/vnd.ms-powerpoint.template.macroenabled.12":{source:"iana",extensions:["potm"]},"application/vnd.ms-printdevicecapabilities+xml":{source:"iana",compressible:!0},"application/vnd.ms-printing.printticket+xml":{source:"apache",compressible:!0},"application/vnd.ms-printschematicket+xml":{source:"iana",compressible:!0},"application/vnd.ms-project":{source:"iana",extensions:["mpp","mpt"]},"application/vnd.ms-tnef":{source:"iana"},"application/vnd.ms-windows.devicepairing":{source:"iana"},"application/vnd.ms-windows.nwprinting.oob":{source:"iana"},"application/vnd.ms-windows.printerpairing":{source:"iana"},"application/vnd.ms-windows.wsd.oob":{source:"iana"},"application/vnd.ms-wmdrm.lic-chlg-req":{source:"iana"},"application/vnd.ms-wmdrm.lic-resp":{source:"iana"},"application/vnd.ms-wmdrm.meter-chlg-req":{source:"iana"},"application/vnd.ms-wmdrm.meter-resp":{source:"iana"},"application/vnd.ms-word.document.macroenabled.12":{source:"iana",extensions:["docm"]},"application/vnd.ms-word.template.macroenabled.12":{source:"iana",extensions:["dotm"]},"application/vnd.ms-works":{source:"iana",extensions:["wps","wks","wcm","wdb"]},"application/vnd.ms-wpl":{source:"iana",extensions:["wpl"]},"application/vnd.ms-xpsdocument":{source:"iana",compressible:!1,extensions:["xps"]},"application/vnd.msa-disk-image":{source:"iana"},"application/vnd.mseq":{source:"iana",extensions:["mseq"]},"application/vnd.msign":{source:"iana"},"application/vnd.multiad.creator":{source:"iana"},"application/vnd.multiad.creator.cif":{source:"iana"},"application/vnd.music-niff":{source:"iana"},"application/vnd.musician":{source:"iana",extensions:["mus"]},"application/vnd.muvee.style":{source:"iana",extensions:["msty"]},"application/vnd.mynfc":{source:"iana",extensions:["taglet"]},"application/vnd.nacamar.ybrid+json":{source:"iana",compressible:!0},"application/vnd.ncd.control":{source:"iana"},"application/vnd.ncd.reference":{source:"iana"},"application/vnd.nearst.inv+json":{source:"iana",compressible:!0},"application/vnd.nebumind.line":{source:"iana"},"application/vnd.nervana":{source:"iana"},"application/vnd.netfpx":{source:"iana"},"application/vnd.neurolanguage.nlu":{source:"iana",extensions:["nlu"]},"application/vnd.nimn":{source:"iana"},"application/vnd.nintendo.nitro.rom":{source:"iana"},"application/vnd.nintendo.snes.rom":{source:"iana"},"application/vnd.nitf":{source:"iana",extensions:["ntf","nitf"]},"application/vnd.noblenet-directory":{source:"iana",extensions:["nnd"]},"application/vnd.noblenet-sealer":{source:"iana",extensions:["nns"]},"application/vnd.noblenet-web":{source:"iana",extensions:["nnw"]},"application/vnd.nokia.catalogs":{source:"iana"},"application/vnd.nokia.conml+wbxml":{source:"iana"},"application/vnd.nokia.conml+xml":{source:"iana",compressible:!0},"application/vnd.nokia.iptv.config+xml":{source:"iana",compressible:!0},"application/vnd.nokia.isds-radio-presets":{source:"iana"},"application/vnd.nokia.landmark+wbxml":{source:"iana"},"application/vnd.nokia.landmark+xml":{source:"iana",compressible:!0},"application/vnd.nokia.landmarkcollection+xml":{source:"iana",compressible:!0},"application/vnd.nokia.n-gage.ac+xml":{source:"iana",compressible:!0,extensions:["ac"]},"application/vnd.nokia.n-gage.data":{source:"iana",extensions:["ngdat"]},"application/vnd.nokia.n-gage.symbian.install":{source:"iana",extensions:["n-gage"]},"application/vnd.nokia.ncd":{source:"iana"},"application/vnd.nokia.pcd+wbxml":{source:"iana"},"application/vnd.nokia.pcd+xml":{source:"iana",compressible:!0},"application/vnd.nokia.radio-preset":{source:"iana",extensions:["rpst"]},"application/vnd.nokia.radio-presets":{source:"iana",extensions:["rpss"]},"application/vnd.novadigm.edm":{source:"iana",extensions:["edm"]},"application/vnd.novadigm.edx":{source:"iana",extensions:["edx"]},"application/vnd.novadigm.ext":{source:"iana",extensions:["ext"]},"application/vnd.ntt-local.content-share":{source:"iana"},"application/vnd.ntt-local.file-transfer":{source:"iana"},"application/vnd.ntt-local.ogw_remote-access":{source:"iana"},"application/vnd.ntt-local.sip-ta_remote":{source:"iana"},"application/vnd.ntt-local.sip-ta_tcp_stream":{source:"iana"},"application/vnd.oasis.opendocument.chart":{source:"iana",extensions:["odc"]},"application/vnd.oasis.opendocument.chart-template":{source:"iana",extensions:["otc"]},"application/vnd.oasis.opendocument.database":{source:"iana",extensions:["odb"]},"application/vnd.oasis.opendocument.formula":{source:"iana",extensions:["odf"]},"application/vnd.oasis.opendocument.formula-template":{source:"iana",extensions:["odft"]},"application/vnd.oasis.opendocument.graphics":{source:"iana",compressible:!1,extensions:["odg"]},"application/vnd.oasis.opendocument.graphics-template":{source:"iana",extensions:["otg"]},"application/vnd.oasis.opendocument.image":{source:"iana",extensions:["odi"]},"application/vnd.oasis.opendocument.image-template":{source:"iana",extensions:["oti"]},"application/vnd.oasis.opendocument.presentation":{source:"iana",compressible:!1,extensions:["odp"]},"application/vnd.oasis.opendocument.presentation-template":{source:"iana",extensions:["otp"]},"application/vnd.oasis.opendocument.spreadsheet":{source:"iana",compressible:!1,extensions:["ods"]},"application/vnd.oasis.opendocument.spreadsheet-template":{source:"iana",extensions:["ots"]},"application/vnd.oasis.opendocument.text":{source:"iana",compressible:!1,extensions:["odt"]},"application/vnd.oasis.opendocument.text-master":{source:"iana",extensions:["odm"]},"application/vnd.oasis.opendocument.text-template":{source:"iana",extensions:["ott"]},"application/vnd.oasis.opendocument.text-web":{source:"iana",extensions:["oth"]},"application/vnd.obn":{source:"iana"},"application/vnd.ocf+cbor":{source:"iana"},"application/vnd.oci.image.manifest.v1+json":{source:"iana",compressible:!0},"application/vnd.oftn.l10n+json":{source:"iana",compressible:!0},"application/vnd.oipf.contentaccessdownload+xml":{source:"iana",compressible:!0},"application/vnd.oipf.contentaccessstreaming+xml":{source:"iana",compressible:!0},"application/vnd.oipf.cspg-hexbinary":{source:"iana"},"application/vnd.oipf.dae.svg+xml":{source:"iana",compressible:!0},"application/vnd.oipf.dae.xhtml+xml":{source:"iana",compressible:!0},"application/vnd.oipf.mippvcontrolmessage+xml":{source:"iana",compressible:!0},"application/vnd.oipf.pae.gem":{source:"iana"},"application/vnd.oipf.spdiscovery+xml":{source:"iana",compressible:!0},"application/vnd.oipf.spdlist+xml":{source:"iana",compressible:!0},"application/vnd.oipf.ueprofile+xml":{source:"iana",compressible:!0},"application/vnd.oipf.userprofile+xml":{source:"iana",compressible:!0},"application/vnd.olpc-sugar":{source:"iana",extensions:["xo"]},"application/vnd.oma-scws-config":{source:"iana"},"application/vnd.oma-scws-http-request":{source:"iana"},"application/vnd.oma-scws-http-response":{source:"iana"},"application/vnd.oma.bcast.associated-procedure-parameter+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.drm-trigger+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.imd+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.ltkm":{source:"iana"},"application/vnd.oma.bcast.notification+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.provisioningtrigger":{source:"iana"},"application/vnd.oma.bcast.sgboot":{source:"iana"},"application/vnd.oma.bcast.sgdd+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.sgdu":{source:"iana"},"application/vnd.oma.bcast.simple-symbol-container":{source:"iana"},"application/vnd.oma.bcast.smartcard-trigger+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.sprov+xml":{source:"iana",compressible:!0},"application/vnd.oma.bcast.stkm":{source:"iana"},"application/vnd.oma.cab-address-book+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-feature-handler+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-pcc+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-subs-invite+xml":{source:"iana",compressible:!0},"application/vnd.oma.cab-user-prefs+xml":{source:"iana",compressible:!0},"application/vnd.oma.dcd":{source:"iana"},"application/vnd.oma.dcdc":{source:"iana"},"application/vnd.oma.dd2+xml":{source:"iana",compressible:!0,extensions:["dd2"]},"application/vnd.oma.drm.risd+xml":{source:"iana",compressible:!0},"application/vnd.oma.group-usage-list+xml":{source:"iana",compressible:!0},"application/vnd.oma.lwm2m+cbor":{source:"iana"},"application/vnd.oma.lwm2m+json":{source:"iana",compressible:!0},"application/vnd.oma.lwm2m+tlv":{source:"iana"},"application/vnd.oma.pal+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.detailed-progress-report+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.final-report+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.groups+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.invocation-descriptor+xml":{source:"iana",compressible:!0},"application/vnd.oma.poc.optimized-progress-report+xml":{source:"iana",compressible:!0},"application/vnd.oma.push":{source:"iana"},"application/vnd.oma.scidm.messages+xml":{source:"iana",compressible:!0},"application/vnd.oma.xcap-directory+xml":{source:"iana",compressible:!0},"application/vnd.omads-email+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.omads-file+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.omads-folder+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.omaloc-supl-init":{source:"iana"},"application/vnd.onepager":{source:"iana"},"application/vnd.onepagertamp":{source:"iana"},"application/vnd.onepagertamx":{source:"iana"},"application/vnd.onepagertat":{source:"iana"},"application/vnd.onepagertatp":{source:"iana"},"application/vnd.onepagertatx":{source:"iana"},"application/vnd.openblox.game+xml":{source:"iana",compressible:!0,extensions:["obgx"]},"application/vnd.openblox.game-binary":{source:"iana"},"application/vnd.openeye.oeb":{source:"iana"},"application/vnd.openofficeorg.extension":{source:"apache",extensions:["oxt"]},"application/vnd.openstreetmap.data+xml":{source:"iana",compressible:!0,extensions:["osm"]},"application/vnd.opentimestamps.ots":{source:"iana"},"application/vnd.openxmlformats-officedocument.custom-properties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.customxmlproperties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawing+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.chart+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramcolors+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramdata+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramlayout+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.drawingml.diagramstyle+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.extended-properties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.commentauthors+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.comments+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.handoutmaster+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.notesmaster+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.notesslide+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.presentation":{source:"iana",compressible:!1,extensions:["pptx"]},"application/vnd.openxmlformats-officedocument.presentationml.presentation.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.presprops+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slide":{source:"iana",extensions:["sldx"]},"application/vnd.openxmlformats-officedocument.presentationml.slide+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slidelayout+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slidemaster+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slideshow":{source:"iana",extensions:["ppsx"]},"application/vnd.openxmlformats-officedocument.presentationml.slideshow.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.slideupdateinfo+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.tablestyles+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.tags+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.template":{source:"iana",extensions:["potx"]},"application/vnd.openxmlformats-officedocument.presentationml.template.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.presentationml.viewprops+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.calcchain+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.externallink+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotcachedefinition+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivotcacherecords+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.pivottable+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.querytable+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionheaders+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.revisionlog+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedstrings+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":{source:"iana",compressible:!1,extensions:["xlsx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetmetadata+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.tablesinglecells+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.template":{source:"iana",extensions:["xltx"]},"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.usernames+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.volatiledependencies+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.theme+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.themeoverride+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.vmldrawing":{source:"iana"},"application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.document":{source:"iana",compressible:!1,extensions:["docx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.document.glossary+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.endnotes+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.fonttable+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.template":{source:"iana",extensions:["dotx"]},"application/vnd.openxmlformats-officedocument.wordprocessingml.template.main+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-officedocument.wordprocessingml.websettings+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-package.core-properties+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-package.digital-signature-xmlsignature+xml":{source:"iana",compressible:!0},"application/vnd.openxmlformats-package.relationships+xml":{source:"iana",compressible:!0},"application/vnd.oracle.resource+json":{source:"iana",compressible:!0},"application/vnd.orange.indata":{source:"iana"},"application/vnd.osa.netdeploy":{source:"iana"},"application/vnd.osgeo.mapguide.package":{source:"iana",extensions:["mgp"]},"application/vnd.osgi.bundle":{source:"iana"},"application/vnd.osgi.dp":{source:"iana",extensions:["dp"]},"application/vnd.osgi.subsystem":{source:"iana",extensions:["esa"]},"application/vnd.otps.ct-kip+xml":{source:"iana",compressible:!0},"application/vnd.oxli.countgraph":{source:"iana"},"application/vnd.pagerduty+json":{source:"iana",compressible:!0},"application/vnd.palm":{source:"iana",extensions:["pdb","pqa","oprc"]},"application/vnd.panoply":{source:"iana"},"application/vnd.paos.xml":{source:"iana"},"application/vnd.patentdive":{source:"iana"},"application/vnd.patientecommsdoc":{source:"iana"},"application/vnd.pawaafile":{source:"iana",extensions:["paw"]},"application/vnd.pcos":{source:"iana"},"application/vnd.pg.format":{source:"iana",extensions:["str"]},"application/vnd.pg.osasli":{source:"iana",extensions:["ei6"]},"application/vnd.piaccess.application-licence":{source:"iana"},"application/vnd.picsel":{source:"iana",extensions:["efif"]},"application/vnd.pmi.widget":{source:"iana",extensions:["wg"]},"application/vnd.poc.group-advertisement+xml":{source:"iana",compressible:!0},"application/vnd.pocketlearn":{source:"iana",extensions:["plf"]},"application/vnd.powerbuilder6":{source:"iana",extensions:["pbd"]},"application/vnd.powerbuilder6-s":{source:"iana"},"application/vnd.powerbuilder7":{source:"iana"},"application/vnd.powerbuilder7-s":{source:"iana"},"application/vnd.powerbuilder75":{source:"iana"},"application/vnd.powerbuilder75-s":{source:"iana"},"application/vnd.preminet":{source:"iana"},"application/vnd.previewsystems.box":{source:"iana",extensions:["box"]},"application/vnd.proteus.magazine":{source:"iana",extensions:["mgz"]},"application/vnd.psfs":{source:"iana"},"application/vnd.publishare-delta-tree":{source:"iana",extensions:["qps"]},"application/vnd.pvi.ptid1":{source:"iana",extensions:["ptid"]},"application/vnd.pwg-multiplexed":{source:"iana"},"application/vnd.pwg-xhtml-print+xml":{source:"iana",compressible:!0},"application/vnd.qualcomm.brew-app-res":{source:"iana"},"application/vnd.quarantainenet":{source:"iana"},"application/vnd.quark.quarkxpress":{source:"iana",extensions:["qxd","qxt","qwd","qwt","qxl","qxb"]},"application/vnd.quobject-quoxdocument":{source:"iana"},"application/vnd.radisys.moml+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-conf+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-conn+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-dialog+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-audit-stream+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-conf+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-base+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-fax-detect+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-fax-sendrecv+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-group+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-speech+xml":{source:"iana",compressible:!0},"application/vnd.radisys.msml-dialog-transform+xml":{source:"iana",compressible:!0},"application/vnd.rainstor.data":{source:"iana"},"application/vnd.rapid":{source:"iana"},"application/vnd.rar":{source:"iana",extensions:["rar"]},"application/vnd.realvnc.bed":{source:"iana",extensions:["bed"]},"application/vnd.recordare.musicxml":{source:"iana",extensions:["mxl"]},"application/vnd.recordare.musicxml+xml":{source:"iana",compressible:!0,extensions:["musicxml"]},"application/vnd.renlearn.rlprint":{source:"iana"},"application/vnd.resilient.logic":{source:"iana"},"application/vnd.restful+json":{source:"iana",compressible:!0},"application/vnd.rig.cryptonote":{source:"iana",extensions:["cryptonote"]},"application/vnd.rim.cod":{source:"apache",extensions:["cod"]},"application/vnd.rn-realmedia":{source:"apache",extensions:["rm"]},"application/vnd.rn-realmedia-vbr":{source:"apache",extensions:["rmvb"]},"application/vnd.route66.link66+xml":{source:"iana",compressible:!0,extensions:["link66"]},"application/vnd.rs-274x":{source:"iana"},"application/vnd.ruckus.download":{source:"iana"},"application/vnd.s3sms":{source:"iana"},"application/vnd.sailingtracker.track":{source:"iana",extensions:["st"]},"application/vnd.sar":{source:"iana"},"application/vnd.sbm.cid":{source:"iana"},"application/vnd.sbm.mid2":{source:"iana"},"application/vnd.scribus":{source:"iana"},"application/vnd.sealed.3df":{source:"iana"},"application/vnd.sealed.csf":{source:"iana"},"application/vnd.sealed.doc":{source:"iana"},"application/vnd.sealed.eml":{source:"iana"},"application/vnd.sealed.mht":{source:"iana"},"application/vnd.sealed.net":{source:"iana"},"application/vnd.sealed.ppt":{source:"iana"},"application/vnd.sealed.tiff":{source:"iana"},"application/vnd.sealed.xls":{source:"iana"},"application/vnd.sealedmedia.softseal.html":{source:"iana"},"application/vnd.sealedmedia.softseal.pdf":{source:"iana"},"application/vnd.seemail":{source:"iana",extensions:["see"]},"application/vnd.seis+json":{source:"iana",compressible:!0},"application/vnd.sema":{source:"iana",extensions:["sema"]},"application/vnd.semd":{source:"iana",extensions:["semd"]},"application/vnd.semf":{source:"iana",extensions:["semf"]},"application/vnd.shade-save-file":{source:"iana"},"application/vnd.shana.informed.formdata":{source:"iana",extensions:["ifm"]},"application/vnd.shana.informed.formtemplate":{source:"iana",extensions:["itp"]},"application/vnd.shana.informed.interchange":{source:"iana",extensions:["iif"]},"application/vnd.shana.informed.package":{source:"iana",extensions:["ipk"]},"application/vnd.shootproof+json":{source:"iana",compressible:!0},"application/vnd.shopkick+json":{source:"iana",compressible:!0},"application/vnd.shp":{source:"iana"},"application/vnd.shx":{source:"iana"},"application/vnd.sigrok.session":{source:"iana"},"application/vnd.simtech-mindmapper":{source:"iana",extensions:["twd","twds"]},"application/vnd.siren+json":{source:"iana",compressible:!0},"application/vnd.smaf":{source:"iana",extensions:["mmf"]},"application/vnd.smart.notebook":{source:"iana"},"application/vnd.smart.teacher":{source:"iana",extensions:["teacher"]},"application/vnd.snesdev-page-table":{source:"iana"},"application/vnd.software602.filler.form+xml":{source:"iana",compressible:!0,extensions:["fo"]},"application/vnd.software602.filler.form-xml-zip":{source:"iana"},"application/vnd.solent.sdkm+xml":{source:"iana",compressible:!0,extensions:["sdkm","sdkd"]},"application/vnd.spotfire.dxp":{source:"iana",extensions:["dxp"]},"application/vnd.spotfire.sfs":{source:"iana",extensions:["sfs"]},"application/vnd.sqlite3":{source:"iana"},"application/vnd.sss-cod":{source:"iana"},"application/vnd.sss-dtf":{source:"iana"},"application/vnd.sss-ntf":{source:"iana"},"application/vnd.stardivision.calc":{source:"apache",extensions:["sdc"]},"application/vnd.stardivision.draw":{source:"apache",extensions:["sda"]},"application/vnd.stardivision.impress":{source:"apache",extensions:["sdd"]},"application/vnd.stardivision.math":{source:"apache",extensions:["smf"]},"application/vnd.stardivision.writer":{source:"apache",extensions:["sdw","vor"]},"application/vnd.stardivision.writer-global":{source:"apache",extensions:["sgl"]},"application/vnd.stepmania.package":{source:"iana",extensions:["smzip"]},"application/vnd.stepmania.stepchart":{source:"iana",extensions:["sm"]},"application/vnd.street-stream":{source:"iana"},"application/vnd.sun.wadl+xml":{source:"iana",compressible:!0,extensions:["wadl"]},"application/vnd.sun.xml.calc":{source:"apache",extensions:["sxc"]},"application/vnd.sun.xml.calc.template":{source:"apache",extensions:["stc"]},"application/vnd.sun.xml.draw":{source:"apache",extensions:["sxd"]},"application/vnd.sun.xml.draw.template":{source:"apache",extensions:["std"]},"application/vnd.sun.xml.impress":{source:"apache",extensions:["sxi"]},"application/vnd.sun.xml.impress.template":{source:"apache",extensions:["sti"]},"application/vnd.sun.xml.math":{source:"apache",extensions:["sxm"]},"application/vnd.sun.xml.writer":{source:"apache",extensions:["sxw"]},"application/vnd.sun.xml.writer.global":{source:"apache",extensions:["sxg"]},"application/vnd.sun.xml.writer.template":{source:"apache",extensions:["stw"]},"application/vnd.sus-calendar":{source:"iana",extensions:["sus","susp"]},"application/vnd.svd":{source:"iana",extensions:["svd"]},"application/vnd.swiftview-ics":{source:"iana"},"application/vnd.sycle+xml":{source:"iana",compressible:!0},"application/vnd.syft+json":{source:"iana",compressible:!0},"application/vnd.symbian.install":{source:"apache",extensions:["sis","sisx"]},"application/vnd.syncml+xml":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["xsm"]},"application/vnd.syncml.dm+wbxml":{source:"iana",charset:"UTF-8",extensions:["bdm"]},"application/vnd.syncml.dm+xml":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["xdm"]},"application/vnd.syncml.dm.notification":{source:"iana"},"application/vnd.syncml.dmddf+wbxml":{source:"iana"},"application/vnd.syncml.dmddf+xml":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["ddf"]},"application/vnd.syncml.dmtnds+wbxml":{source:"iana"},"application/vnd.syncml.dmtnds+xml":{source:"iana",charset:"UTF-8",compressible:!0},"application/vnd.syncml.ds.notification":{source:"iana"},"application/vnd.tableschema+json":{source:"iana",compressible:!0},"application/vnd.tao.intent-module-archive":{source:"iana",extensions:["tao"]},"application/vnd.tcpdump.pcap":{source:"iana",extensions:["pcap","cap","dmp"]},"application/vnd.think-cell.ppttc+json":{source:"iana",compressible:!0},"application/vnd.tmd.mediaflex.api+xml":{source:"iana",compressible:!0},"application/vnd.tml":{source:"iana"},"application/vnd.tmobile-livetv":{source:"iana",extensions:["tmo"]},"application/vnd.tri.onesource":{source:"iana"},"application/vnd.trid.tpt":{source:"iana",extensions:["tpt"]},"application/vnd.triscape.mxs":{source:"iana",extensions:["mxs"]},"application/vnd.trueapp":{source:"iana",extensions:["tra"]},"application/vnd.truedoc":{source:"iana"},"application/vnd.ubisoft.webplayer":{source:"iana"},"application/vnd.ufdl":{source:"iana",extensions:["ufd","ufdl"]},"application/vnd.uiq.theme":{source:"iana",extensions:["utz"]},"application/vnd.umajin":{source:"iana",extensions:["umj"]},"application/vnd.unity":{source:"iana",extensions:["unityweb"]},"application/vnd.uoml+xml":{source:"iana",compressible:!0,extensions:["uoml"]},"application/vnd.uplanet.alert":{source:"iana"},"application/vnd.uplanet.alert-wbxml":{source:"iana"},"application/vnd.uplanet.bearer-choice":{source:"iana"},"application/vnd.uplanet.bearer-choice-wbxml":{source:"iana"},"application/vnd.uplanet.cacheop":{source:"iana"},"application/vnd.uplanet.cacheop-wbxml":{source:"iana"},"application/vnd.uplanet.channel":{source:"iana"},"application/vnd.uplanet.channel-wbxml":{source:"iana"},"application/vnd.uplanet.list":{source:"iana"},"application/vnd.uplanet.list-wbxml":{source:"iana"},"application/vnd.uplanet.listcmd":{source:"iana"},"application/vnd.uplanet.listcmd-wbxml":{source:"iana"},"application/vnd.uplanet.signal":{source:"iana"},"application/vnd.uri-map":{source:"iana"},"application/vnd.valve.source.material":{source:"iana"},"application/vnd.vcx":{source:"iana",extensions:["vcx"]},"application/vnd.vd-study":{source:"iana"},"application/vnd.vectorworks":{source:"iana"},"application/vnd.vel+json":{source:"iana",compressible:!0},"application/vnd.verimatrix.vcas":{source:"iana"},"application/vnd.veritone.aion+json":{source:"iana",compressible:!0},"application/vnd.veryant.thin":{source:"iana"},"application/vnd.ves.encrypted":{source:"iana"},"application/vnd.vidsoft.vidconference":{source:"iana"},"application/vnd.visio":{source:"iana",extensions:["vsd","vst","vss","vsw"]},"application/vnd.visionary":{source:"iana",extensions:["vis"]},"application/vnd.vividence.scriptfile":{source:"iana"},"application/vnd.vsf":{source:"iana",extensions:["vsf"]},"application/vnd.wap.sic":{source:"iana"},"application/vnd.wap.slc":{source:"iana"},"application/vnd.wap.wbxml":{source:"iana",charset:"UTF-8",extensions:["wbxml"]},"application/vnd.wap.wmlc":{source:"iana",extensions:["wmlc"]},"application/vnd.wap.wmlscriptc":{source:"iana",extensions:["wmlsc"]},"application/vnd.webturbo":{source:"iana",extensions:["wtb"]},"application/vnd.wfa.dpp":{source:"iana"},"application/vnd.wfa.p2p":{source:"iana"},"application/vnd.wfa.wsc":{source:"iana"},"application/vnd.windows.devicepairing":{source:"iana"},"application/vnd.wmc":{source:"iana"},"application/vnd.wmf.bootstrap":{source:"iana"},"application/vnd.wolfram.mathematica":{source:"iana"},"application/vnd.wolfram.mathematica.package":{source:"iana"},"application/vnd.wolfram.player":{source:"iana",extensions:["nbp"]},"application/vnd.wordperfect":{source:"iana",extensions:["wpd"]},"application/vnd.wqd":{source:"iana",extensions:["wqd"]},"application/vnd.wrq-hp3000-labelled":{source:"iana"},"application/vnd.wt.stf":{source:"iana",extensions:["stf"]},"application/vnd.wv.csp+wbxml":{source:"iana"},"application/vnd.wv.csp+xml":{source:"iana",compressible:!0},"application/vnd.wv.ssp+xml":{source:"iana",compressible:!0},"application/vnd.xacml+json":{source:"iana",compressible:!0},"application/vnd.xara":{source:"iana",extensions:["xar"]},"application/vnd.xfdl":{source:"iana",extensions:["xfdl"]},"application/vnd.xfdl.webform":{source:"iana"},"application/vnd.xmi+xml":{source:"iana",compressible:!0},"application/vnd.xmpie.cpkg":{source:"iana"},"application/vnd.xmpie.dpkg":{source:"iana"},"application/vnd.xmpie.plan":{source:"iana"},"application/vnd.xmpie.ppkg":{source:"iana"},"application/vnd.xmpie.xlim":{source:"iana"},"application/vnd.yamaha.hv-dic":{source:"iana",extensions:["hvd"]},"application/vnd.yamaha.hv-script":{source:"iana",extensions:["hvs"]},"application/vnd.yamaha.hv-voice":{source:"iana",extensions:["hvp"]},"application/vnd.yamaha.openscoreformat":{source:"iana",extensions:["osf"]},"application/vnd.yamaha.openscoreformat.osfpvg+xml":{source:"iana",compressible:!0,extensions:["osfpvg"]},"application/vnd.yamaha.remote-setup":{source:"iana"},"application/vnd.yamaha.smaf-audio":{source:"iana",extensions:["saf"]},"application/vnd.yamaha.smaf-phrase":{source:"iana",extensions:["spf"]},"application/vnd.yamaha.through-ngn":{source:"iana"},"application/vnd.yamaha.tunnel-udpencap":{source:"iana"},"application/vnd.yaoweme":{source:"iana"},"application/vnd.yellowriver-custom-menu":{source:"iana",extensions:["cmp"]},"application/vnd.youtube.yt":{source:"iana"},"application/vnd.zul":{source:"iana",extensions:["zir","zirz"]},"application/vnd.zzazz.deck+xml":{source:"iana",compressible:!0,extensions:["zaz"]},"application/voicexml+xml":{source:"iana",compressible:!0,extensions:["vxml"]},"application/voucher-cms+json":{source:"iana",compressible:!0},"application/vq-rtcpxr":{source:"iana"},"application/wasm":{source:"iana",compressible:!0,extensions:["wasm"]},"application/watcherinfo+xml":{source:"iana",compressible:!0,extensions:["wif"]},"application/webpush-options+json":{source:"iana",compressible:!0},"application/whoispp-query":{source:"iana"},"application/whoispp-response":{source:"iana"},"application/widget":{source:"iana",extensions:["wgt"]},"application/winhlp":{source:"apache",extensions:["hlp"]},"application/wita":{source:"iana"},"application/wordperfect5.1":{source:"iana"},"application/wsdl+xml":{source:"iana",compressible:!0,extensions:["wsdl"]},"application/wspolicy+xml":{source:"iana",compressible:!0,extensions:["wspolicy"]},"application/x-7z-compressed":{source:"apache",compressible:!1,extensions:["7z"]},"application/x-abiword":{source:"apache",extensions:["abw"]},"application/x-ace-compressed":{source:"apache",extensions:["ace"]},"application/x-amf":{source:"apache"},"application/x-apple-diskimage":{source:"apache",extensions:["dmg"]},"application/x-arj":{compressible:!1,extensions:["arj"]},"application/x-authorware-bin":{source:"apache",extensions:["aab","x32","u32","vox"]},"application/x-authorware-map":{source:"apache",extensions:["aam"]},"application/x-authorware-seg":{source:"apache",extensions:["aas"]},"application/x-bcpio":{source:"apache",extensions:["bcpio"]},"application/x-bdoc":{compressible:!1,extensions:["bdoc"]},"application/x-bittorrent":{source:"apache",extensions:["torrent"]},"application/x-blorb":{source:"apache",extensions:["blb","blorb"]},"application/x-bzip":{source:"apache",compressible:!1,extensions:["bz"]},"application/x-bzip2":{source:"apache",compressible:!1,extensions:["bz2","boz"]},"application/x-cbr":{source:"apache",extensions:["cbr","cba","cbt","cbz","cb7"]},"application/x-cdlink":{source:"apache",extensions:["vcd"]},"application/x-cfs-compressed":{source:"apache",extensions:["cfs"]},"application/x-chat":{source:"apache",extensions:["chat"]},"application/x-chess-pgn":{source:"apache",extensions:["pgn"]},"application/x-chrome-extension":{extensions:["crx"]},"application/x-cocoa":{source:"nginx",extensions:["cco"]},"application/x-compress":{source:"apache"},"application/x-conference":{source:"apache",extensions:["nsc"]},"application/x-cpio":{source:"apache",extensions:["cpio"]},"application/x-csh":{source:"apache",extensions:["csh"]},"application/x-deb":{compressible:!1},"application/x-debian-package":{source:"apache",extensions:["deb","udeb"]},"application/x-dgc-compressed":{source:"apache",extensions:["dgc"]},"application/x-director":{source:"apache",extensions:["dir","dcr","dxr","cst","cct","cxt","w3d","fgd","swa"]},"application/x-doom":{source:"apache",extensions:["wad"]},"application/x-dtbncx+xml":{source:"apache",compressible:!0,extensions:["ncx"]},"application/x-dtbook+xml":{source:"apache",compressible:!0,extensions:["dtb"]},"application/x-dtbresource+xml":{source:"apache",compressible:!0,extensions:["res"]},"application/x-dvi":{source:"apache",compressible:!1,extensions:["dvi"]},"application/x-envoy":{source:"apache",extensions:["evy"]},"application/x-eva":{source:"apache",extensions:["eva"]},"application/x-font-bdf":{source:"apache",extensions:["bdf"]},"application/x-font-dos":{source:"apache"},"application/x-font-framemaker":{source:"apache"},"application/x-font-ghostscript":{source:"apache",extensions:["gsf"]},"application/x-font-libgrx":{source:"apache"},"application/x-font-linux-psf":{source:"apache",extensions:["psf"]},"application/x-font-pcf":{source:"apache",extensions:["pcf"]},"application/x-font-snf":{source:"apache",extensions:["snf"]},"application/x-font-speedo":{source:"apache"},"application/x-font-sunos-news":{source:"apache"},"application/x-font-type1":{source:"apache",extensions:["pfa","pfb","pfm","afm"]},"application/x-font-vfont":{source:"apache"},"application/x-freearc":{source:"apache",extensions:["arc"]},"application/x-futuresplash":{source:"apache",extensions:["spl"]},"application/x-gca-compressed":{source:"apache",extensions:["gca"]},"application/x-glulx":{source:"apache",extensions:["ulx"]},"application/x-gnumeric":{source:"apache",extensions:["gnumeric"]},"application/x-gramps-xml":{source:"apache",extensions:["gramps"]},"application/x-gtar":{source:"apache",extensions:["gtar"]},"application/x-gzip":{source:"apache"},"application/x-hdf":{source:"apache",extensions:["hdf"]},"application/x-httpd-php":{compressible:!0,extensions:["php"]},"application/x-install-instructions":{source:"apache",extensions:["install"]},"application/x-iso9660-image":{source:"apache",extensions:["iso"]},"application/x-iwork-keynote-sffkey":{extensions:["key"]},"application/x-iwork-numbers-sffnumbers":{extensions:["numbers"]},"application/x-iwork-pages-sffpages":{extensions:["pages"]},"application/x-java-archive-diff":{source:"nginx",extensions:["jardiff"]},"application/x-java-jnlp-file":{source:"apache",compressible:!1,extensions:["jnlp"]},"application/x-javascript":{compressible:!0},"application/x-keepass2":{extensions:["kdbx"]},"application/x-latex":{source:"apache",compressible:!1,extensions:["latex"]},"application/x-lua-bytecode":{extensions:["luac"]},"application/x-lzh-compressed":{source:"apache",extensions:["lzh","lha"]},"application/x-makeself":{source:"nginx",extensions:["run"]},"application/x-mie":{source:"apache",extensions:["mie"]},"application/x-mobipocket-ebook":{source:"apache",extensions:["prc","mobi"]},"application/x-mpegurl":{compressible:!1},"application/x-ms-application":{source:"apache",extensions:["application"]},"application/x-ms-shortcut":{source:"apache",extensions:["lnk"]},"application/x-ms-wmd":{source:"apache",extensions:["wmd"]},"application/x-ms-wmz":{source:"apache",extensions:["wmz"]},"application/x-ms-xbap":{source:"apache",extensions:["xbap"]},"application/x-msaccess":{source:"apache",extensions:["mdb"]},"application/x-msbinder":{source:"apache",extensions:["obd"]},"application/x-mscardfile":{source:"apache",extensions:["crd"]},"application/x-msclip":{source:"apache",extensions:["clp"]},"application/x-msdos-program":{extensions:["exe"]},"application/x-msdownload":{source:"apache",extensions:["exe","dll","com","bat","msi"]},"application/x-msmediaview":{source:"apache",extensions:["mvb","m13","m14"]},"application/x-msmetafile":{source:"apache",extensions:["wmf","wmz","emf","emz"]},"application/x-msmoney":{source:"apache",extensions:["mny"]},"application/x-mspublisher":{source:"apache",extensions:["pub"]},"application/x-msschedule":{source:"apache",extensions:["scd"]},"application/x-msterminal":{source:"apache",extensions:["trm"]},"application/x-mswrite":{source:"apache",extensions:["wri"]},"application/x-netcdf":{source:"apache",extensions:["nc","cdf"]},"application/x-ns-proxy-autoconfig":{compressible:!0,extensions:["pac"]},"application/x-nzb":{source:"apache",extensions:["nzb"]},"application/x-perl":{source:"nginx",extensions:["pl","pm"]},"application/x-pilot":{source:"nginx",extensions:["prc","pdb"]},"application/x-pkcs12":{source:"apache",compressible:!1,extensions:["p12","pfx"]},"application/x-pkcs7-certificates":{source:"apache",extensions:["p7b","spc"]},"application/x-pkcs7-certreqresp":{source:"apache",extensions:["p7r"]},"application/x-pki-message":{source:"iana"},"application/x-rar-compressed":{source:"apache",compressible:!1,extensions:["rar"]},"application/x-redhat-package-manager":{source:"nginx",extensions:["rpm"]},"application/x-research-info-systems":{source:"apache",extensions:["ris"]},"application/x-sea":{source:"nginx",extensions:["sea"]},"application/x-sh":{source:"apache",compressible:!0,extensions:["sh"]},"application/x-shar":{source:"apache",extensions:["shar"]},"application/x-shockwave-flash":{source:"apache",compressible:!1,extensions:["swf"]},"application/x-silverlight-app":{source:"apache",extensions:["xap"]},"application/x-sql":{source:"apache",extensions:["sql"]},"application/x-stuffit":{source:"apache",compressible:!1,extensions:["sit"]},"application/x-stuffitx":{source:"apache",extensions:["sitx"]},"application/x-subrip":{source:"apache",extensions:["srt"]},"application/x-sv4cpio":{source:"apache",extensions:["sv4cpio"]},"application/x-sv4crc":{source:"apache",extensions:["sv4crc"]},"application/x-t3vm-image":{source:"apache",extensions:["t3"]},"application/x-tads":{source:"apache",extensions:["gam"]},"application/x-tar":{source:"apache",compressible:!0,extensions:["tar"]},"application/x-tcl":{source:"apache",extensions:["tcl","tk"]},"application/x-tex":{source:"apache",extensions:["tex"]},"application/x-tex-tfm":{source:"apache",extensions:["tfm"]},"application/x-texinfo":{source:"apache",extensions:["texinfo","texi"]},"application/x-tgif":{source:"apache",extensions:["obj"]},"application/x-ustar":{source:"apache",extensions:["ustar"]},"application/x-virtualbox-hdd":{compressible:!0,extensions:["hdd"]},"application/x-virtualbox-ova":{compressible:!0,extensions:["ova"]},"application/x-virtualbox-ovf":{compressible:!0,extensions:["ovf"]},"application/x-virtualbox-vbox":{compressible:!0,extensions:["vbox"]},"application/x-virtualbox-vbox-extpack":{compressible:!1,extensions:["vbox-extpack"]},"application/x-virtualbox-vdi":{compressible:!0,extensions:["vdi"]},"application/x-virtualbox-vhd":{compressible:!0,extensions:["vhd"]},"application/x-virtualbox-vmdk":{compressible:!0,extensions:["vmdk"]},"application/x-wais-source":{source:"apache",extensions:["src"]},"application/x-web-app-manifest+json":{compressible:!0,extensions:["webapp"]},"application/x-www-form-urlencoded":{source:"iana",compressible:!0},"application/x-x509-ca-cert":{source:"iana",extensions:["der","crt","pem"]},"application/x-x509-ca-ra-cert":{source:"iana"},"application/x-x509-next-ca-cert":{source:"iana"},"application/x-xfig":{source:"apache",extensions:["fig"]},"application/x-xliff+xml":{source:"apache",compressible:!0,extensions:["xlf"]},"application/x-xpinstall":{source:"apache",compressible:!1,extensions:["xpi"]},"application/x-xz":{source:"apache",extensions:["xz"]},"application/x-zmachine":{source:"apache",extensions:["z1","z2","z3","z4","z5","z6","z7","z8"]},"application/x400-bp":{source:"iana"},"application/xacml+xml":{source:"iana",compressible:!0},"application/xaml+xml":{source:"apache",compressible:!0,extensions:["xaml"]},"application/xcap-att+xml":{source:"iana",compressible:!0,extensions:["xav"]},"application/xcap-caps+xml":{source:"iana",compressible:!0,extensions:["xca"]},"application/xcap-diff+xml":{source:"iana",compressible:!0,extensions:["xdf"]},"application/xcap-el+xml":{source:"iana",compressible:!0,extensions:["xel"]},"application/xcap-error+xml":{source:"iana",compressible:!0},"application/xcap-ns+xml":{source:"iana",compressible:!0,extensions:["xns"]},"application/xcon-conference-info+xml":{source:"iana",compressible:!0},"application/xcon-conference-info-diff+xml":{source:"iana",compressible:!0},"application/xenc+xml":{source:"iana",compressible:!0,extensions:["xenc"]},"application/xhtml+xml":{source:"iana",compressible:!0,extensions:["xhtml","xht"]},"application/xhtml-voice+xml":{source:"apache",compressible:!0},"application/xliff+xml":{source:"iana",compressible:!0,extensions:["xlf"]},"application/xml":{source:"iana",compressible:!0,extensions:["xml","xsl","xsd","rng"]},"application/xml-dtd":{source:"iana",compressible:!0,extensions:["dtd"]},"application/xml-external-parsed-entity":{source:"iana"},"application/xml-patch+xml":{source:"iana",compressible:!0},"application/xmpp+xml":{source:"iana",compressible:!0},"application/xop+xml":{source:"iana",compressible:!0,extensions:["xop"]},"application/xproc+xml":{source:"apache",compressible:!0,extensions:["xpl"]},"application/xslt+xml":{source:"iana",compressible:!0,extensions:["xsl","xslt"]},"application/xspf+xml":{source:"apache",compressible:!0,extensions:["xspf"]},"application/xv+xml":{source:"iana",compressible:!0,extensions:["mxml","xhvml","xvml","xvm"]},"application/yang":{source:"iana",extensions:["yang"]},"application/yang-data+json":{source:"iana",compressible:!0},"application/yang-data+xml":{source:"iana",compressible:!0},"application/yang-patch+json":{source:"iana",compressible:!0},"application/yang-patch+xml":{source:"iana",compressible:!0},"application/yin+xml":{source:"iana",compressible:!0,extensions:["yin"]},"application/zip":{source:"iana",compressible:!1,extensions:["zip"]},"application/zlib":{source:"iana"},"application/zstd":{source:"iana"},"audio/1d-interleaved-parityfec":{source:"iana"},"audio/32kadpcm":{source:"iana"},"audio/3gpp":{source:"iana",compressible:!1,extensions:["3gpp"]},"audio/3gpp2":{source:"iana"},"audio/aac":{source:"iana"},"audio/ac3":{source:"iana"},"audio/adpcm":{source:"apache",extensions:["adp"]},"audio/amr":{source:"iana",extensions:["amr"]},"audio/amr-wb":{source:"iana"},"audio/amr-wb+":{source:"iana"},"audio/aptx":{source:"iana"},"audio/asc":{source:"iana"},"audio/atrac-advanced-lossless":{source:"iana"},"audio/atrac-x":{source:"iana"},"audio/atrac3":{source:"iana"},"audio/basic":{source:"iana",compressible:!1,extensions:["au","snd"]},"audio/bv16":{source:"iana"},"audio/bv32":{source:"iana"},"audio/clearmode":{source:"iana"},"audio/cn":{source:"iana"},"audio/dat12":{source:"iana"},"audio/dls":{source:"iana"},"audio/dsr-es201108":{source:"iana"},"audio/dsr-es202050":{source:"iana"},"audio/dsr-es202211":{source:"iana"},"audio/dsr-es202212":{source:"iana"},"audio/dv":{source:"iana"},"audio/dvi4":{source:"iana"},"audio/eac3":{source:"iana"},"audio/encaprtp":{source:"iana"},"audio/evrc":{source:"iana"},"audio/evrc-qcp":{source:"iana"},"audio/evrc0":{source:"iana"},"audio/evrc1":{source:"iana"},"audio/evrcb":{source:"iana"},"audio/evrcb0":{source:"iana"},"audio/evrcb1":{source:"iana"},"audio/evrcnw":{source:"iana"},"audio/evrcnw0":{source:"iana"},"audio/evrcnw1":{source:"iana"},"audio/evrcwb":{source:"iana"},"audio/evrcwb0":{source:"iana"},"audio/evrcwb1":{source:"iana"},"audio/evs":{source:"iana"},"audio/flexfec":{source:"iana"},"audio/fwdred":{source:"iana"},"audio/g711-0":{source:"iana"},"audio/g719":{source:"iana"},"audio/g722":{source:"iana"},"audio/g7221":{source:"iana"},"audio/g723":{source:"iana"},"audio/g726-16":{source:"iana"},"audio/g726-24":{source:"iana"},"audio/g726-32":{source:"iana"},"audio/g726-40":{source:"iana"},"audio/g728":{source:"iana"},"audio/g729":{source:"iana"},"audio/g7291":{source:"iana"},"audio/g729d":{source:"iana"},"audio/g729e":{source:"iana"},"audio/gsm":{source:"iana"},"audio/gsm-efr":{source:"iana"},"audio/gsm-hr-08":{source:"iana"},"audio/ilbc":{source:"iana"},"audio/ip-mr_v2.5":{source:"iana"},"audio/isac":{source:"apache"},"audio/l16":{source:"iana"},"audio/l20":{source:"iana"},"audio/l24":{source:"iana",compressible:!1},"audio/l8":{source:"iana"},"audio/lpc":{source:"iana"},"audio/melp":{source:"iana"},"audio/melp1200":{source:"iana"},"audio/melp2400":{source:"iana"},"audio/melp600":{source:"iana"},"audio/mhas":{source:"iana"},"audio/midi":{source:"apache",extensions:["mid","midi","kar","rmi"]},"audio/mobile-xmf":{source:"iana",extensions:["mxmf"]},"audio/mp3":{compressible:!1,extensions:["mp3"]},"audio/mp4":{source:"iana",compressible:!1,extensions:["m4a","mp4a"]},"audio/mp4a-latm":{source:"iana"},"audio/mpa":{source:"iana"},"audio/mpa-robust":{source:"iana"},"audio/mpeg":{source:"iana",compressible:!1,extensions:["mpga","mp2","mp2a","mp3","m2a","m3a"]},"audio/mpeg4-generic":{source:"iana"},"audio/musepack":{source:"apache"},"audio/ogg":{source:"iana",compressible:!1,extensions:["oga","ogg","spx","opus"]},"audio/opus":{source:"iana"},"audio/parityfec":{source:"iana"},"audio/pcma":{source:"iana"},"audio/pcma-wb":{source:"iana"},"audio/pcmu":{source:"iana"},"audio/pcmu-wb":{source:"iana"},"audio/prs.sid":{source:"iana"},"audio/qcelp":{source:"iana"},"audio/raptorfec":{source:"iana"},"audio/red":{source:"iana"},"audio/rtp-enc-aescm128":{source:"iana"},"audio/rtp-midi":{source:"iana"},"audio/rtploopback":{source:"iana"},"audio/rtx":{source:"iana"},"audio/s3m":{source:"apache",extensions:["s3m"]},"audio/scip":{source:"iana"},"audio/silk":{source:"apache",extensions:["sil"]},"audio/smv":{source:"iana"},"audio/smv-qcp":{source:"iana"},"audio/smv0":{source:"iana"},"audio/sofa":{source:"iana"},"audio/sp-midi":{source:"iana"},"audio/speex":{source:"iana"},"audio/t140c":{source:"iana"},"audio/t38":{source:"iana"},"audio/telephone-event":{source:"iana"},"audio/tetra_acelp":{source:"iana"},"audio/tetra_acelp_bb":{source:"iana"},"audio/tone":{source:"iana"},"audio/tsvcis":{source:"iana"},"audio/uemclip":{source:"iana"},"audio/ulpfec":{source:"iana"},"audio/usac":{source:"iana"},"audio/vdvi":{source:"iana"},"audio/vmr-wb":{source:"iana"},"audio/vnd.3gpp.iufp":{source:"iana"},"audio/vnd.4sb":{source:"iana"},"audio/vnd.audiokoz":{source:"iana"},"audio/vnd.celp":{source:"iana"},"audio/vnd.cisco.nse":{source:"iana"},"audio/vnd.cmles.radio-events":{source:"iana"},"audio/vnd.cns.anp1":{source:"iana"},"audio/vnd.cns.inf1":{source:"iana"},"audio/vnd.dece.audio":{source:"iana",extensions:["uva","uvva"]},"audio/vnd.digital-winds":{source:"iana",extensions:["eol"]},"audio/vnd.dlna.adts":{source:"iana"},"audio/vnd.dolby.heaac.1":{source:"iana"},"audio/vnd.dolby.heaac.2":{source:"iana"},"audio/vnd.dolby.mlp":{source:"iana"},"audio/vnd.dolby.mps":{source:"iana"},"audio/vnd.dolby.pl2":{source:"iana"},"audio/vnd.dolby.pl2x":{source:"iana"},"audio/vnd.dolby.pl2z":{source:"iana"},"audio/vnd.dolby.pulse.1":{source:"iana"},"audio/vnd.dra":{source:"iana",extensions:["dra"]},"audio/vnd.dts":{source:"iana",extensions:["dts"]},"audio/vnd.dts.hd":{source:"iana",extensions:["dtshd"]},"audio/vnd.dts.uhd":{source:"iana"},"audio/vnd.dvb.file":{source:"iana"},"audio/vnd.everad.plj":{source:"iana"},"audio/vnd.hns.audio":{source:"iana"},"audio/vnd.lucent.voice":{source:"iana",extensions:["lvp"]},"audio/vnd.ms-playready.media.pya":{source:"iana",extensions:["pya"]},"audio/vnd.nokia.mobile-xmf":{source:"iana"},"audio/vnd.nortel.vbk":{source:"iana"},"audio/vnd.nuera.ecelp4800":{source:"iana",extensions:["ecelp4800"]},"audio/vnd.nuera.ecelp7470":{source:"iana",extensions:["ecelp7470"]},"audio/vnd.nuera.ecelp9600":{source:"iana",extensions:["ecelp9600"]},"audio/vnd.octel.sbc":{source:"iana"},"audio/vnd.presonus.multitrack":{source:"iana"},"audio/vnd.qcelp":{source:"iana"},"audio/vnd.rhetorex.32kadpcm":{source:"iana"},"audio/vnd.rip":{source:"iana",extensions:["rip"]},"audio/vnd.rn-realaudio":{compressible:!1},"audio/vnd.sealedmedia.softseal.mpeg":{source:"iana"},"audio/vnd.vmx.cvsd":{source:"iana"},"audio/vnd.wave":{compressible:!1},"audio/vorbis":{source:"iana",compressible:!1},"audio/vorbis-config":{source:"iana"},"audio/wav":{compressible:!1,extensions:["wav"]},"audio/wave":{compressible:!1,extensions:["wav"]},"audio/webm":{source:"apache",compressible:!1,extensions:["weba"]},"audio/x-aac":{source:"apache",compressible:!1,extensions:["aac"]},"audio/x-aiff":{source:"apache",extensions:["aif","aiff","aifc"]},"audio/x-caf":{source:"apache",compressible:!1,extensions:["caf"]},"audio/x-flac":{source:"apache",extensions:["flac"]},"audio/x-m4a":{source:"nginx",extensions:["m4a"]},"audio/x-matroska":{source:"apache",extensions:["mka"]},"audio/x-mpegurl":{source:"apache",extensions:["m3u"]},"audio/x-ms-wax":{source:"apache",extensions:["wax"]},"audio/x-ms-wma":{source:"apache",extensions:["wma"]},"audio/x-pn-realaudio":{source:"apache",extensions:["ram","ra"]},"audio/x-pn-realaudio-plugin":{source:"apache",extensions:["rmp"]},"audio/x-realaudio":{source:"nginx",extensions:["ra"]},"audio/x-tta":{source:"apache"},"audio/x-wav":{source:"apache",extensions:["wav"]},"audio/xm":{source:"apache",extensions:["xm"]},"chemical/x-cdx":{source:"apache",extensions:["cdx"]},"chemical/x-cif":{source:"apache",extensions:["cif"]},"chemical/x-cmdf":{source:"apache",extensions:["cmdf"]},"chemical/x-cml":{source:"apache",extensions:["cml"]},"chemical/x-csml":{source:"apache",extensions:["csml"]},"chemical/x-pdb":{source:"apache"},"chemical/x-xyz":{source:"apache",extensions:["xyz"]},"font/collection":{source:"iana",extensions:["ttc"]},"font/otf":{source:"iana",compressible:!0,extensions:["otf"]},"font/sfnt":{source:"iana"},"font/ttf":{source:"iana",compressible:!0,extensions:["ttf"]},"font/woff":{source:"iana",extensions:["woff"]},"font/woff2":{source:"iana",extensions:["woff2"]},"image/aces":{source:"iana",extensions:["exr"]},"image/apng":{compressible:!1,extensions:["apng"]},"image/avci":{source:"iana",extensions:["avci"]},"image/avcs":{source:"iana",extensions:["avcs"]},"image/avif":{source:"iana",compressible:!1,extensions:["avif"]},"image/bmp":{source:"iana",compressible:!0,extensions:["bmp"]},"image/cgm":{source:"iana",extensions:["cgm"]},"image/dicom-rle":{source:"iana",extensions:["drle"]},"image/emf":{source:"iana",extensions:["emf"]},"image/fits":{source:"iana",extensions:["fits"]},"image/g3fax":{source:"iana",extensions:["g3"]},"image/gif":{source:"iana",compressible:!1,extensions:["gif"]},"image/heic":{source:"iana",extensions:["heic"]},"image/heic-sequence":{source:"iana",extensions:["heics"]},"image/heif":{source:"iana",extensions:["heif"]},"image/heif-sequence":{source:"iana",extensions:["heifs"]},"image/hej2k":{source:"iana",extensions:["hej2"]},"image/hsj2":{source:"iana",extensions:["hsj2"]},"image/ief":{source:"iana",extensions:["ief"]},"image/jls":{source:"iana",extensions:["jls"]},"image/jp2":{source:"iana",compressible:!1,extensions:["jp2","jpg2"]},"image/jpeg":{source:"iana",compressible:!1,extensions:["jpeg","jpg","jpe"]},"image/jph":{source:"iana",extensions:["jph"]},"image/jphc":{source:"iana",extensions:["jhc"]},"image/jpm":{source:"iana",compressible:!1,extensions:["jpm"]},"image/jpx":{source:"iana",compressible:!1,extensions:["jpx","jpf"]},"image/jxr":{source:"iana",extensions:["jxr"]},"image/jxra":{source:"iana",extensions:["jxra"]},"image/jxrs":{source:"iana",extensions:["jxrs"]},"image/jxs":{source:"iana",extensions:["jxs"]},"image/jxsc":{source:"iana",extensions:["jxsc"]},"image/jxsi":{source:"iana",extensions:["jxsi"]},"image/jxss":{source:"iana",extensions:["jxss"]},"image/ktx":{source:"iana",extensions:["ktx"]},"image/ktx2":{source:"iana",extensions:["ktx2"]},"image/naplps":{source:"iana"},"image/pjpeg":{compressible:!1},"image/png":{source:"iana",compressible:!1,extensions:["png"]},"image/prs.btif":{source:"iana",extensions:["btif"]},"image/prs.pti":{source:"iana",extensions:["pti"]},"image/pwg-raster":{source:"iana"},"image/sgi":{source:"apache",extensions:["sgi"]},"image/svg+xml":{source:"iana",compressible:!0,extensions:["svg","svgz"]},"image/t38":{source:"iana",extensions:["t38"]},"image/tiff":{source:"iana",compressible:!1,extensions:["tif","tiff"]},"image/tiff-fx":{source:"iana",extensions:["tfx"]},"image/vnd.adobe.photoshop":{source:"iana",compressible:!0,extensions:["psd"]},"image/vnd.airzip.accelerator.azv":{source:"iana",extensions:["azv"]},"image/vnd.cns.inf2":{source:"iana"},"image/vnd.dece.graphic":{source:"iana",extensions:["uvi","uvvi","uvg","uvvg"]},"image/vnd.djvu":{source:"iana",extensions:["djvu","djv"]},"image/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"image/vnd.dwg":{source:"iana",extensions:["dwg"]},"image/vnd.dxf":{source:"iana",extensions:["dxf"]},"image/vnd.fastbidsheet":{source:"iana",extensions:["fbs"]},"image/vnd.fpx":{source:"iana",extensions:["fpx"]},"image/vnd.fst":{source:"iana",extensions:["fst"]},"image/vnd.fujixerox.edmics-mmr":{source:"iana",extensions:["mmr"]},"image/vnd.fujixerox.edmics-rlc":{source:"iana",extensions:["rlc"]},"image/vnd.globalgraphics.pgb":{source:"iana"},"image/vnd.microsoft.icon":{source:"iana",compressible:!0,extensions:["ico"]},"image/vnd.mix":{source:"iana"},"image/vnd.mozilla.apng":{source:"iana"},"image/vnd.ms-dds":{compressible:!0,extensions:["dds"]},"image/vnd.ms-modi":{source:"iana",extensions:["mdi"]},"image/vnd.ms-photo":{source:"apache",extensions:["wdp"]},"image/vnd.net-fpx":{source:"iana",extensions:["npx"]},"image/vnd.pco.b16":{source:"iana",extensions:["b16"]},"image/vnd.radiance":{source:"iana"},"image/vnd.sealed.png":{source:"iana"},"image/vnd.sealedmedia.softseal.gif":{source:"iana"},"image/vnd.sealedmedia.softseal.jpg":{source:"iana"},"image/vnd.svf":{source:"iana"},"image/vnd.tencent.tap":{source:"iana",extensions:["tap"]},"image/vnd.valve.source.texture":{source:"iana",extensions:["vtf"]},"image/vnd.wap.wbmp":{source:"iana",extensions:["wbmp"]},"image/vnd.xiff":{source:"iana",extensions:["xif"]},"image/vnd.zbrush.pcx":{source:"iana",extensions:["pcx"]},"image/webp":{source:"apache",extensions:["webp"]},"image/wmf":{source:"iana",extensions:["wmf"]},"image/x-3ds":{source:"apache",extensions:["3ds"]},"image/x-cmu-raster":{source:"apache",extensions:["ras"]},"image/x-cmx":{source:"apache",extensions:["cmx"]},"image/x-freehand":{source:"apache",extensions:["fh","fhc","fh4","fh5","fh7"]},"image/x-icon":{source:"apache",compressible:!0,extensions:["ico"]},"image/x-jng":{source:"nginx",extensions:["jng"]},"image/x-mrsid-image":{source:"apache",extensions:["sid"]},"image/x-ms-bmp":{source:"nginx",compressible:!0,extensions:["bmp"]},"image/x-pcx":{source:"apache",extensions:["pcx"]},"image/x-pict":{source:"apache",extensions:["pic","pct"]},"image/x-portable-anymap":{source:"apache",extensions:["pnm"]},"image/x-portable-bitmap":{source:"apache",extensions:["pbm"]},"image/x-portable-graymap":{source:"apache",extensions:["pgm"]},"image/x-portable-pixmap":{source:"apache",extensions:["ppm"]},"image/x-rgb":{source:"apache",extensions:["rgb"]},"image/x-tga":{source:"apache",extensions:["tga"]},"image/x-xbitmap":{source:"apache",extensions:["xbm"]},"image/x-xcf":{compressible:!1},"image/x-xpixmap":{source:"apache",extensions:["xpm"]},"image/x-xwindowdump":{source:"apache",extensions:["xwd"]},"message/cpim":{source:"iana"},"message/delivery-status":{source:"iana"},"message/disposition-notification":{source:"iana",extensions:["disposition-notification"]},"message/external-body":{source:"iana"},"message/feedback-report":{source:"iana"},"message/global":{source:"iana",extensions:["u8msg"]},"message/global-delivery-status":{source:"iana",extensions:["u8dsn"]},"message/global-disposition-notification":{source:"iana",extensions:["u8mdn"]},"message/global-headers":{source:"iana",extensions:["u8hdr"]},"message/http":{source:"iana",compressible:!1},"message/imdn+xml":{source:"iana",compressible:!0},"message/news":{source:"iana"},"message/partial":{source:"iana",compressible:!1},"message/rfc822":{source:"iana",compressible:!0,extensions:["eml","mime"]},"message/s-http":{source:"iana"},"message/sip":{source:"iana"},"message/sipfrag":{source:"iana"},"message/tracking-status":{source:"iana"},"message/vnd.si.simp":{source:"iana"},"message/vnd.wfa.wsc":{source:"iana",extensions:["wsc"]},"model/3mf":{source:"iana",extensions:["3mf"]},"model/e57":{source:"iana"},"model/gltf+json":{source:"iana",compressible:!0,extensions:["gltf"]},"model/gltf-binary":{source:"iana",compressible:!0,extensions:["glb"]},"model/iges":{source:"iana",compressible:!1,extensions:["igs","iges"]},"model/mesh":{source:"iana",compressible:!1,extensions:["msh","mesh","silo"]},"model/mtl":{source:"iana",extensions:["mtl"]},"model/obj":{source:"iana",extensions:["obj"]},"model/step":{source:"iana"},"model/step+xml":{source:"iana",compressible:!0,extensions:["stpx"]},"model/step+zip":{source:"iana",compressible:!1,extensions:["stpz"]},"model/step-xml+zip":{source:"iana",compressible:!1,extensions:["stpxz"]},"model/stl":{source:"iana",extensions:["stl"]},"model/vnd.collada+xml":{source:"iana",compressible:!0,extensions:["dae"]},"model/vnd.dwf":{source:"iana",extensions:["dwf"]},"model/vnd.flatland.3dml":{source:"iana"},"model/vnd.gdl":{source:"iana",extensions:["gdl"]},"model/vnd.gs-gdl":{source:"apache"},"model/vnd.gs.gdl":{source:"iana"},"model/vnd.gtw":{source:"iana",extensions:["gtw"]},"model/vnd.moml+xml":{source:"iana",compressible:!0},"model/vnd.mts":{source:"iana",extensions:["mts"]},"model/vnd.opengex":{source:"iana",extensions:["ogex"]},"model/vnd.parasolid.transmit.binary":{source:"iana",extensions:["x_b"]},"model/vnd.parasolid.transmit.text":{source:"iana",extensions:["x_t"]},"model/vnd.pytha.pyox":{source:"iana"},"model/vnd.rosette.annotated-data-model":{source:"iana"},"model/vnd.sap.vds":{source:"iana",extensions:["vds"]},"model/vnd.usdz+zip":{source:"iana",compressible:!1,extensions:["usdz"]},"model/vnd.valve.source.compiled-map":{source:"iana",extensions:["bsp"]},"model/vnd.vtu":{source:"iana",extensions:["vtu"]},"model/vrml":{source:"iana",compressible:!1,extensions:["wrl","vrml"]},"model/x3d+binary":{source:"apache",compressible:!1,extensions:["x3db","x3dbz"]},"model/x3d+fastinfoset":{source:"iana",extensions:["x3db"]},"model/x3d+vrml":{source:"apache",compressible:!1,extensions:["x3dv","x3dvz"]},"model/x3d+xml":{source:"iana",compressible:!0,extensions:["x3d","x3dz"]},"model/x3d-vrml":{source:"iana",extensions:["x3dv"]},"multipart/alternative":{source:"iana",compressible:!1},"multipart/appledouble":{source:"iana"},"multipart/byteranges":{source:"iana"},"multipart/digest":{source:"iana"},"multipart/encrypted":{source:"iana",compressible:!1},"multipart/form-data":{source:"iana",compressible:!1},"multipart/header-set":{source:"iana"},"multipart/mixed":{source:"iana"},"multipart/multilingual":{source:"iana"},"multipart/parallel":{source:"iana"},"multipart/related":{source:"iana",compressible:!1},"multipart/report":{source:"iana"},"multipart/signed":{source:"iana",compressible:!1},"multipart/vnd.bint.med-plus":{source:"iana"},"multipart/voice-message":{source:"iana"},"multipart/x-mixed-replace":{source:"iana"},"text/1d-interleaved-parityfec":{source:"iana"},"text/cache-manifest":{source:"iana",compressible:!0,extensions:["appcache","manifest"]},"text/calendar":{source:"iana",extensions:["ics","ifb"]},"text/calender":{compressible:!0},"text/cmd":{compressible:!0},"text/coffeescript":{extensions:["coffee","litcoffee"]},"text/cql":{source:"iana"},"text/cql-expression":{source:"iana"},"text/cql-identifier":{source:"iana"},"text/css":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["css"]},"text/csv":{source:"iana",compressible:!0,extensions:["csv"]},"text/csv-schema":{source:"iana"},"text/directory":{source:"iana"},"text/dns":{source:"iana"},"text/ecmascript":{source:"iana"},"text/encaprtp":{source:"iana"},"text/enriched":{source:"iana"},"text/fhirpath":{source:"iana"},"text/flexfec":{source:"iana"},"text/fwdred":{source:"iana"},"text/gff3":{source:"iana"},"text/grammar-ref-list":{source:"iana"},"text/html":{source:"iana",compressible:!0,extensions:["html","htm","shtml"]},"text/jade":{extensions:["jade"]},"text/javascript":{source:"iana",compressible:!0},"text/jcr-cnd":{source:"iana"},"text/jsx":{compressible:!0,extensions:["jsx"]},"text/less":{compressible:!0,extensions:["less"]},"text/markdown":{source:"iana",compressible:!0,extensions:["markdown","md"]},"text/mathml":{source:"nginx",extensions:["mml"]},"text/mdx":{compressible:!0,extensions:["mdx"]},"text/mizar":{source:"iana"},"text/n3":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["n3"]},"text/parameters":{source:"iana",charset:"UTF-8"},"text/parityfec":{source:"iana"},"text/plain":{source:"iana",compressible:!0,extensions:["txt","text","conf","def","list","log","in","ini"]},"text/provenance-notation":{source:"iana",charset:"UTF-8"},"text/prs.fallenstein.rst":{source:"iana"},"text/prs.lines.tag":{source:"iana",extensions:["dsc"]},"text/prs.prop.logic":{source:"iana"},"text/raptorfec":{source:"iana"},"text/red":{source:"iana"},"text/rfc822-headers":{source:"iana"},"text/richtext":{source:"iana",compressible:!0,extensions:["rtx"]},"text/rtf":{source:"iana",compressible:!0,extensions:["rtf"]},"text/rtp-enc-aescm128":{source:"iana"},"text/rtploopback":{source:"iana"},"text/rtx":{source:"iana"},"text/sgml":{source:"iana",extensions:["sgml","sgm"]},"text/shaclc":{source:"iana"},"text/shex":{source:"iana",extensions:["shex"]},"text/slim":{extensions:["slim","slm"]},"text/spdx":{source:"iana",extensions:["spdx"]},"text/strings":{source:"iana"},"text/stylus":{extensions:["stylus","styl"]},"text/t140":{source:"iana"},"text/tab-separated-values":{source:"iana",compressible:!0,extensions:["tsv"]},"text/troff":{source:"iana",extensions:["t","tr","roff","man","me","ms"]},"text/turtle":{source:"iana",charset:"UTF-8",extensions:["ttl"]},"text/ulpfec":{source:"iana"},"text/uri-list":{source:"iana",compressible:!0,extensions:["uri","uris","urls"]},"text/vcard":{source:"iana",compressible:!0,extensions:["vcard"]},"text/vnd.a":{source:"iana"},"text/vnd.abc":{source:"iana"},"text/vnd.ascii-art":{source:"iana"},"text/vnd.curl":{source:"iana",extensions:["curl"]},"text/vnd.curl.dcurl":{source:"apache",extensions:["dcurl"]},"text/vnd.curl.mcurl":{source:"apache",extensions:["mcurl"]},"text/vnd.curl.scurl":{source:"apache",extensions:["scurl"]},"text/vnd.debian.copyright":{source:"iana",charset:"UTF-8"},"text/vnd.dmclientscript":{source:"iana"},"text/vnd.dvb.subtitle":{source:"iana",extensions:["sub"]},"text/vnd.esmertec.theme-descriptor":{source:"iana",charset:"UTF-8"},"text/vnd.familysearch.gedcom":{source:"iana",extensions:["ged"]},"text/vnd.ficlab.flt":{source:"iana"},"text/vnd.fly":{source:"iana",extensions:["fly"]},"text/vnd.fmi.flexstor":{source:"iana",extensions:["flx"]},"text/vnd.gml":{source:"iana"},"text/vnd.graphviz":{source:"iana",extensions:["gv"]},"text/vnd.hans":{source:"iana"},"text/vnd.hgl":{source:"iana"},"text/vnd.in3d.3dml":{source:"iana",extensions:["3dml"]},"text/vnd.in3d.spot":{source:"iana",extensions:["spot"]},"text/vnd.iptc.newsml":{source:"iana"},"text/vnd.iptc.nitf":{source:"iana"},"text/vnd.latex-z":{source:"iana"},"text/vnd.motorola.reflex":{source:"iana"},"text/vnd.ms-mediapackage":{source:"iana"},"text/vnd.net2phone.commcenter.command":{source:"iana"},"text/vnd.radisys.msml-basic-layout":{source:"iana"},"text/vnd.senx.warpscript":{source:"iana"},"text/vnd.si.uricatalogue":{source:"iana"},"text/vnd.sosi":{source:"iana"},"text/vnd.sun.j2me.app-descriptor":{source:"iana",charset:"UTF-8",extensions:["jad"]},"text/vnd.trolltech.linguist":{source:"iana",charset:"UTF-8"},"text/vnd.wap.si":{source:"iana"},"text/vnd.wap.sl":{source:"iana"},"text/vnd.wap.wml":{source:"iana",extensions:["wml"]},"text/vnd.wap.wmlscript":{source:"iana",extensions:["wmls"]},"text/vtt":{source:"iana",charset:"UTF-8",compressible:!0,extensions:["vtt"]},"text/x-asm":{source:"apache",extensions:["s","asm"]},"text/x-c":{source:"apache",extensions:["c","cc","cxx","cpp","h","hh","dic"]},"text/x-component":{source:"nginx",extensions:["htc"]},"text/x-fortran":{source:"apache",extensions:["f","for","f77","f90"]},"text/x-gwt-rpc":{compressible:!0},"text/x-handlebars-template":{extensions:["hbs"]},"text/x-java-source":{source:"apache",extensions:["java"]},"text/x-jquery-tmpl":{compressible:!0},"text/x-lua":{extensions:["lua"]},"text/x-markdown":{compressible:!0,extensions:["mkd"]},"text/x-nfo":{source:"apache",extensions:["nfo"]},"text/x-opml":{source:"apache",extensions:["opml"]},"text/x-org":{compressible:!0,extensions:["org"]},"text/x-pascal":{source:"apache",extensions:["p","pas"]},"text/x-processing":{compressible:!0,extensions:["pde"]},"text/x-sass":{extensions:["sass"]},"text/x-scss":{extensions:["scss"]},"text/x-setext":{source:"apache",extensions:["etx"]},"text/x-sfv":{source:"apache",extensions:["sfv"]},"text/x-suse-ymp":{compressible:!0,extensions:["ymp"]},"text/x-uuencode":{source:"apache",extensions:["uu"]},"text/x-vcalendar":{source:"apache",extensions:["vcs"]},"text/x-vcard":{source:"apache",extensions:["vcf"]},"text/xml":{source:"iana",compressible:!0,extensions:["xml"]},"text/xml-external-parsed-entity":{source:"iana"},"text/yaml":{compressible:!0,extensions:["yaml","yml"]},"video/1d-interleaved-parityfec":{source:"iana"},"video/3gpp":{source:"iana",extensions:["3gp","3gpp"]},"video/3gpp-tt":{source:"iana"},"video/3gpp2":{source:"iana",extensions:["3g2"]},"video/av1":{source:"iana"},"video/bmpeg":{source:"iana"},"video/bt656":{source:"iana"},"video/celb":{source:"iana"},"video/dv":{source:"iana"},"video/encaprtp":{source:"iana"},"video/ffv1":{source:"iana"},"video/flexfec":{source:"iana"},"video/h261":{source:"iana",extensions:["h261"]},"video/h263":{source:"iana",extensions:["h263"]},"video/h263-1998":{source:"iana"},"video/h263-2000":{source:"iana"},"video/h264":{source:"iana",extensions:["h264"]},"video/h264-rcdo":{source:"iana"},"video/h264-svc":{source:"iana"},"video/h265":{source:"iana"},"video/iso.segment":{source:"iana",extensions:["m4s"]},"video/jpeg":{source:"iana",extensions:["jpgv"]},"video/jpeg2000":{source:"iana"},"video/jpm":{source:"apache",extensions:["jpm","jpgm"]},"video/jxsv":{source:"iana"},"video/mj2":{source:"iana",extensions:["mj2","mjp2"]},"video/mp1s":{source:"iana"},"video/mp2p":{source:"iana"},"video/mp2t":{source:"iana",extensions:["ts"]},"video/mp4":{source:"iana",compressible:!1,extensions:["mp4","mp4v","mpg4"]},"video/mp4v-es":{source:"iana"},"video/mpeg":{source:"iana",compressible:!1,extensions:["mpeg","mpg","mpe","m1v","m2v"]},"video/mpeg4-generic":{source:"iana"},"video/mpv":{source:"iana"},"video/nv":{source:"iana"},"video/ogg":{source:"iana",compressible:!1,extensions:["ogv"]},"video/parityfec":{source:"iana"},"video/pointer":{source:"iana"},"video/quicktime":{source:"iana",compressible:!1,extensions:["qt","mov"]},"video/raptorfec":{source:"iana"},"video/raw":{source:"iana"},"video/rtp-enc-aescm128":{source:"iana"},"video/rtploopback":{source:"iana"},"video/rtx":{source:"iana"},"video/scip":{source:"iana"},"video/smpte291":{source:"iana"},"video/smpte292m":{source:"iana"},"video/ulpfec":{source:"iana"},"video/vc1":{source:"iana"},"video/vc2":{source:"iana"},"video/vnd.cctv":{source:"iana"},"video/vnd.dece.hd":{source:"iana",extensions:["uvh","uvvh"]},"video/vnd.dece.mobile":{source:"iana",extensions:["uvm","uvvm"]},"video/vnd.dece.mp4":{source:"iana"},"video/vnd.dece.pd":{source:"iana",extensions:["uvp","uvvp"]},"video/vnd.dece.sd":{source:"iana",extensions:["uvs","uvvs"]},"video/vnd.dece.video":{source:"iana",extensions:["uvv","uvvv"]},"video/vnd.directv.mpeg":{source:"iana"},"video/vnd.directv.mpeg-tts":{source:"iana"},"video/vnd.dlna.mpeg-tts":{source:"iana"},"video/vnd.dvb.file":{source:"iana",extensions:["dvb"]},"video/vnd.fvt":{source:"iana",extensions:["fvt"]},"video/vnd.hns.video":{source:"iana"},"video/vnd.iptvforum.1dparityfec-1010":{source:"iana"},"video/vnd.iptvforum.1dparityfec-2005":{source:"iana"},"video/vnd.iptvforum.2dparityfec-1010":{source:"iana"},"video/vnd.iptvforum.2dparityfec-2005":{source:"iana"},"video/vnd.iptvforum.ttsavc":{source:"iana"},"video/vnd.iptvforum.ttsmpeg2":{source:"iana"},"video/vnd.motorola.video":{source:"iana"},"video/vnd.motorola.videop":{source:"iana"},"video/vnd.mpegurl":{source:"iana",extensions:["mxu","m4u"]},"video/vnd.ms-playready.media.pyv":{source:"iana",extensions:["pyv"]},"video/vnd.nokia.interleaved-multimedia":{source:"iana"},"video/vnd.nokia.mp4vr":{source:"iana"},"video/vnd.nokia.videovoip":{source:"iana"},"video/vnd.objectvideo":{source:"iana"},"video/vnd.radgamettools.bink":{source:"iana"},"video/vnd.radgamettools.smacker":{source:"iana"},"video/vnd.sealed.mpeg1":{source:"iana"},"video/vnd.sealed.mpeg4":{source:"iana"},"video/vnd.sealed.swf":{source:"iana"},"video/vnd.sealedmedia.softseal.mov":{source:"iana"},"video/vnd.uvvu.mp4":{source:"iana",extensions:["uvu","uvvu"]},"video/vnd.vivo":{source:"iana",extensions:["viv"]},"video/vnd.youtube.yt":{source:"iana"},"video/vp8":{source:"iana"},"video/vp9":{source:"iana"},"video/webm":{source:"apache",compressible:!1,extensions:["webm"]},"video/x-f4v":{source:"apache",extensions:["f4v"]},"video/x-fli":{source:"apache",extensions:["fli"]},"video/x-flv":{source:"apache",compressible:!1,extensions:["flv"]},"video/x-m4v":{source:"apache",extensions:["m4v"]},"video/x-matroska":{source:"apache",compressible:!1,extensions:["mkv","mk3d","mks"]},"video/x-mng":{source:"apache",extensions:["mng"]},"video/x-ms-asf":{source:"apache",extensions:["asf","asx"]},"video/x-ms-vob":{source:"apache",extensions:["vob"]},"video/x-ms-wm":{source:"apache",extensions:["wm"]},"video/x-ms-wmv":{source:"apache",compressible:!1,extensions:["wmv"]},"video/x-ms-wmx":{source:"apache",extensions:["wmx"]},"video/x-ms-wvx":{source:"apache",extensions:["wvx"]},"video/x-msvideo":{source:"apache",extensions:["avi"]},"video/x-sgi-movie":{source:"apache",extensions:["movie"]},"video/x-smv":{source:"apache",extensions:["smv"]},"x-conference/x-cooltalk":{source:"apache",extensions:["ice"]},"x-shader/x-fragment":{compressible:!0},"x-shader/x-vertex":{compressible:!0}}});var fCe=M((B_r,pCe)=>{pCe.exports=dCe()});var gCe=M(ja=>{"use strict";var B8=fCe(),Jtt=require("path").extname,mCe=/^\s*([^;\s]*)(?:;|\s|$)/,Ztt=/^text\//i;ja.charset=hCe;ja.charsets={lookup:hCe};ja.contentType=ert;ja.extension=trt;ja.extensions=Object.create(null);ja.lookup=rrt;ja.types=Object.create(null);nrt(ja.extensions,ja.types);function hCe(t){if(!t||typeof t!="string")return!1;var e=mCe.exec(t),r=e&&B8[e[1].toLowerCase()];return r&&r.charset?r.charset:e&&Ztt.test(e[1])?"UTF-8":!1}function ert(t){if(!t||typeof t!="string")return!1;var e=t.indexOf("/")===-1?ja.lookup(t):t;if(!e)return!1;if(e.indexOf("charset")===-1){var r=ja.charset(e);r&&(e+="; charset="+r.toLowerCase())}return e}function trt(t){if(!t||typeof t!="string")return!1;var e=mCe.exec(t),r=e&&ja.extensions[e[1].toLowerCase()];return!r||!r.length?!1:r[0]}function rrt(t){if(!t||typeof t!="string")return!1;var e=Jtt("x."+t).toLowerCase().substr(1);return e&&ja.types[e]||!1}function nrt(t,e){var r=["nginx","apache",void 0,"iana"];Object.keys(B8).forEach(function(o){var s=B8[o],a=s.extensions;if(!(!a||!a.length)){t[o]=a;for(var c=0;c<a.length;c++){var u=a[c];if(e[u]){var l=r.indexOf(B8[e[u]].source),d=r.indexOf(s.source);if(e[u]!=="application/octet-stream"&&(l>d||l===d&&e[u].substr(0,12)==="application/"))continue}e[u]=o}}})}});var yCe=M((H_r,vCe)=>{vCe.exports=irt;function irt(t){var e=typeof setImmediate=="function"?setImmediate:typeof process=="object"&&typeof process.nextTick=="function"?process.nextTick:null;e?e(t):setTimeout(t,0)}});var xQ=M((j_r,_Ce)=>{var bCe=yCe();_Ce.exports=ort;function ort(t){var e=!1;return bCe(function(){e=!0}),function(n,o){e?t(n,o):bCe(function(){t(n,o)})}}});var SQ=M((V_r,xCe)=>{xCe.exports=srt;function srt(t){Object.keys(t.jobs).forEach(art.bind(t)),t.jobs={}}function art(t){typeof this.jobs[t]=="function"&&this.jobs[t]()}});var IQ=M((G_r,ICe)=>{var SCe=xQ(),crt=SQ();ICe.exports=urt;function urt(t,e,r,n){var o=r.keyedList?r.keyedList[r.index]:r.index;r.jobs[o]=lrt(e,o,t[o],function(s,a){o in r.jobs&&(delete r.jobs[o],s?crt(r):r.results[o]=a,n(s,r.results))})}function lrt(t,e,r,n){var o;return t.length==2?o=t(r,SCe(n)):o=t(r,e,SCe(n)),o}});var CQ=M((z_r,CCe)=>{CCe.exports=drt;function drt(t,e){var r=!Array.isArray(t),n={index:0,keyedList:r||e?Object.keys(t):null,jobs:{},results:r?{}:[],size:r?Object.keys(t).length:t.length};return e&&n.keyedList.sort(r?e:function(o,s){return e(t[o],t[s])}),n}});var EQ=M(($_r,ECe)=>{var prt=SQ(),frt=xQ();ECe.exports=mrt;function mrt(t){Object.keys(this.jobs).length&&(this.index=this.size,prt(this),frt(t)(null,this.results))}});var wCe=M((W_r,TCe)=>{var hrt=IQ(),grt=CQ(),vrt=EQ();TCe.exports=yrt;function yrt(t,e,r){for(var n=grt(t);n.index<(n.keyedList||t).length;)hrt(t,e,n,function(o,s){if(o){r(o,s);return}if(Object.keys(n.jobs).length===0){r(null,n.results);return}}),n.index++;return vrt.bind(n,r)}});var TQ=M((K_r,q8)=>{var RCe=IQ(),brt=CQ(),_rt=EQ();q8.exports=xrt;q8.exports.ascending=kCe;q8.exports.descending=Srt;function xrt(t,e,r,n){var o=brt(t,r);return RCe(t,e,o,function s(a,c){if(a){n(a,c);return}if(o.index++,o.index<(o.keyedList||t).length){RCe(t,e,o,s);return}n(null,o.results)}),_rt.bind(o,n)}function kCe(t,e){return t<e?-1:t>e?1:0}function Srt(t,e){return-1*kCe(t,e)}});var ACe=M((Y_r,PCe)=>{var Irt=TQ();PCe.exports=Crt;function Crt(t,e,r){return Irt(t,e,null,r)}});var NCe=M((Q_r,DCe)=>{DCe.exports={parallel:wCe(),serial:ACe(),serialOrdered:TQ()}});var OCe=M((X_r,LCe)=>{LCe.exports=function(t,e){return Object.keys(e).forEach(function(r){t[r]=t[r]||e[r]}),t}});var UCe=M((J_r,FCe)=>{var PQ=lCe(),MCe=require("util"),wQ=require("path"),Ert=require("http"),Trt=require("https"),wrt=require("url").parse,Rrt=require("fs"),krt=require("stream").Stream,RQ=gCe(),Prt=NCe(),kQ=OCe();FCe.exports=Mr;MCe.inherits(Mr,PQ);function Mr(t){if(!(this instanceof Mr))return new Mr(t);this._overheadLength=0,this._valueLength=0,this._valuesToMeasure=[],PQ.call(this),t=t||{};for(var e in t)this[e]=t[e]}Mr.LINE_BREAK=`\r
`;Mr.DEFAULT_CONTENT_TYPE="application/octet-stream";Mr.prototype.append=function(t,e,r){r=r||{},typeof r=="string"&&(r={filename:r});var n=PQ.prototype.append.bind(this);if(typeof e=="number"&&(e=""+e),MCe.isArray(e)){this._error(new Error("Arrays are not supported."));return}var o=this._multiPartHeader(t,e,r),s=this._multiPartFooter();n(o),n(e),n(s),this._trackLength(o,e,r)};Mr.prototype._trackLength=function(t,e,r){var n=0;r.knownLength!=null?n+=+r.knownLength:Buffer.isBuffer(e)?n=e.length:typeof e=="string"&&(n=Buffer.byteLength(e)),this._valueLength+=n,this._overheadLength+=Buffer.byteLength(t)+Mr.LINE_BREAK.length,!(!e||!e.path&&!(e.readable&&e.hasOwnProperty("httpVersion"))&&!(e instanceof krt))&&(r.knownLength||this._valuesToMeasure.push(e))};Mr.prototype._lengthRetriever=function(t,e){t.hasOwnProperty("fd")?t.end!=null&&t.end!=1/0&&t.start!=null?e(null,t.end+1-(t.start?t.start:0)):Rrt.stat(t.path,function(r,n){var o;if(r){e(r);return}o=n.size-(t.start?t.start:0),e(null,o)}):t.hasOwnProperty("httpVersion")?e(null,+t.headers["content-length"]):t.hasOwnProperty("httpModule")?(t.on("response",function(r){t.pause(),e(null,+r.headers["content-length"])}),t.resume()):e("Unknown stream")};Mr.prototype._multiPartHeader=function(t,e,r){if(typeof r.header=="string")return r.header;var n=this._getContentDisposition(e,r),o=this._getContentType(e,r),s="",a={"Content-Disposition":["form-data",'name="'+t+'"'].concat(n||[]),"Content-Type":[].concat(o||[])};typeof r.header=="object"&&kQ(a,r.header);var c;for(var u in a)a.hasOwnProperty(u)&&(c=a[u],c!=null&&(Array.isArray(c)||(c=[c]),c.length&&(s+=u+": "+c.join("; ")+Mr.LINE_BREAK)));return"--"+this.getBoundary()+Mr.LINE_BREAK+s+Mr.LINE_BREAK};Mr.prototype._getContentDisposition=function(t,e){var r,n;return typeof e.filepath=="string"?r=wQ.normalize(e.filepath).replace(/\\/g,"/"):e.filename||t.name||t.path?r=wQ.basename(e.filename||t.name||t.path):t.readable&&t.hasOwnProperty("httpVersion")&&(r=wQ.basename(t.client._httpMessage.path||"")),r&&(n='filename="'+r+'"'),n};Mr.prototype._getContentType=function(t,e){var r=e.contentType;return!r&&t.name&&(r=RQ.lookup(t.name)),!r&&t.path&&(r=RQ.lookup(t.path)),!r&&t.readable&&t.hasOwnProperty("httpVersion")&&(r=t.headers["content-type"]),!r&&(e.filepath||e.filename)&&(r=RQ.lookup(e.filepath||e.filename)),!r&&typeof t=="object"&&(r=Mr.DEFAULT_CONTENT_TYPE),r};Mr.prototype._multiPartFooter=function(){return function(t){var e=Mr.LINE_BREAK,r=this._streams.length===0;r&&(e+=this._lastBoundary()),t(e)}.bind(this)};Mr.prototype._lastBoundary=function(){return"--"+this.getBoundary()+"--"+Mr.LINE_BREAK};Mr.prototype.getHeaders=function(t){var e,r={"content-type":"multipart/form-data; boundary="+this.getBoundary()};for(e in t)t.hasOwnProperty(e)&&(r[e.toLowerCase()]=t[e]);return r};Mr.prototype.setBoundary=function(t){this._boundary=t};Mr.prototype.getBoundary=function(){return this._boundary||this._generateBoundary(),this._boundary};Mr.prototype.getBuffer=function(){for(var t=new Buffer.alloc(0),e=this.getBoundary(),r=0,n=this._streams.length;r<n;r++)typeof this._streams[r]!="function"&&(Buffer.isBuffer(this._streams[r])?t=Buffer.concat([t,this._streams[r]]):t=Buffer.concat([t,Buffer.from(this._streams[r])]),(typeof this._streams[r]!="string"||this._streams[r].substring(2,e.length+2)!==e)&&(t=Buffer.concat([t,Buffer.from(Mr.LINE_BREAK)])));return Buffer.concat([t,Buffer.from(this._lastBoundary())])};Mr.prototype._generateBoundary=function(){for(var t="--------------------------",e=0;e<24;e++)t+=Math.floor(Math.random()*10).toString(16);this._boundary=t};Mr.prototype.getLengthSync=function(){var t=this._overheadLength+this._valueLength;return this._streams.length&&(t+=this._lastBoundary().length),this.hasKnownLength()||this._error(new Error("Cannot calculate proper length in synchronous way.")),t};Mr.prototype.hasKnownLength=function(){var t=!0;return this._valuesToMeasure.length&&(t=!1),t};Mr.prototype.getLength=function(t){var e=this._overheadLength+this._valueLength;if(this._streams.length&&(e+=this._lastBoundary().length),!this._valuesToMeasure.length){process.nextTick(t.bind(this,null,e));return}Prt.parallel(this._valuesToMeasure,this._lengthRetriever,function(r,n){if(r){t(r);return}n.forEach(function(o){e+=o}),t(null,e)})};Mr.prototype.submit=function(t,e){var r,n,o={method:"post"};return typeof t=="string"?(t=wrt(t),n=kQ({port:t.port,path:t.pathname,host:t.hostname,protocol:t.protocol},o)):(n=kQ(t,o),n.port||(n.port=n.protocol=="https:"?443:80)),n.headers=this.getHeaders(t.headers),n.protocol=="https:"?r=Trt.request(n):r=Ert.request(n),this.getLength(function(s,a){if(s&&s!=="Unknown stream"){this._error(s);return}if(a&&r.setHeader("Content-Length",a),this.pipe(r),e){var c,u=function(l,d){return r.removeListener("error",u),r.removeListener("response",c),e.call(this,l,d)};c=u.bind(this,null),r.on("error",u),r.on("response",c)}}.bind(this)),r};Mr.prototype._error=function(t){this.error||(this.error=t,this.pause(),this.emit("error",t))};Mr.prototype.toString=function(){return"[object FormData]"}});function H8(){return{name:AQ,async sendRequest(t,e){if(t.formData){let r=t.headers.get("Content-Type");r&&r.indexOf("application/x-www-form-urlencoded")!==-1?(t.body=Art(t.formData),t.formData=void 0):await Drt(t.formData,t)}return e(t)}}}function Art(t){let e=new URLSearchParams;for(let[r,n]of Object.entries(t))if(Array.isArray(n))for(let o of n)e.append(r,o.toString());else e.append(r,n.toString());return e.toString()}async function Drt(t,e){let r=new BCe.default;for(let o of Object.keys(t)){let s=t[o];if(Array.isArray(s))for(let a of s)r.append(o,a);else r.append(o,s)}e.body=r,e.formData=void 0;let n=e.headers.get("Content-Type");n&&n.indexOf("multipart/form-data")!==-1&&e.headers.set("Content-Type",`multipart/form-data; boundary=${r.getBoundary()}`);try{let o=await new Promise((s,a)=>{r.getLength((c,u)=>{c?a(c):s(u)})});e.headers.set("Content-Length",o)}catch{}}var BCe,AQ,DQ=R(()=>{BCe=z(UCe()),AQ="formDataPolicy"});var qCe=M(NQ=>{"use strict";Object.defineProperty(NQ,"__esModule",{value:!0});function Nrt(t){return function(e,r){return new Promise((n,o)=>{t.call(this,e,r,(s,a)=>{s?o(s):n(a)})})}}NQ.default=Nrt});var MQ=M((OQ,jCe)=>{"use strict";var HCe=OQ&&OQ.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},Lrt=require("events"),Ort=HCe(Sl()),Mrt=HCe(qCe()),D2=Ort.default("agent-base");function Frt(t){return!!t&&typeof t.addRequest=="function"}function LQ(){let{stack:t}=new Error;return typeof t!="string"?!1:t.split(`
`).some(e=>e.indexOf("(https.js:")!==-1||e.indexOf("node:https:")!==-1)}function j8(t,e){return new j8.Agent(t,e)}(function(t){class e extends Lrt.EventEmitter{constructor(n,o){super();let s=o;typeof n=="function"?this.callback=n:n&&(s=n),this.timeout=null,s&&typeof s.timeout=="number"&&(this.timeout=s.timeout),this.maxFreeSockets=1,this.maxSockets=1,this.maxTotalSockets=1/0,this.sockets={},this.freeSockets={},this.requests={},this.options={}}get defaultPort(){return typeof this.explicitDefaultPort=="number"?this.explicitDefaultPort:LQ()?443:80}set defaultPort(n){this.explicitDefaultPort=n}get protocol(){return typeof this.explicitProtocol=="string"?this.explicitProtocol:LQ()?"https:":"http:"}set protocol(n){this.explicitProtocol=n}callback(n,o,s){throw new Error('"agent-base" has no default implementation, you must subclass and override `callback()`')}addRequest(n,o){let s=Object.assign({},o);typeof s.secureEndpoint!="boolean"&&(s.secureEndpoint=LQ()),s.host==null&&(s.host="localhost"),s.port==null&&(s.port=s.secureEndpoint?443:80),s.protocol==null&&(s.protocol=s.secureEndpoint?"https:":"http:"),s.host&&s.path&&delete s.path,delete s.agent,delete s.hostname,delete s._defaultAgent,delete s.defaultPort,delete s.createConnection,n._last=!0,n.shouldKeepAlive=!1;let a=!1,c=null,u=s.timeout||this.timeout,l=m=>{n._hadError||(n.emit("error",m),n._hadError=!0)},d=()=>{c=null,a=!0;let m=new Error(`A "socket" was not created for HTTP request before ${u}ms`);m.code="ETIMEOUT",l(m)},p=m=>{a||(c!==null&&(clearTimeout(c),c=null),l(m))},f=m=>{if(a)return;if(c!=null&&(clearTimeout(c),c=null),Frt(m)){D2("Callback returned another Agent instance %o",m.constructor.name),m.addRequest(n,s);return}if(m){m.once("free",()=>{this.freeSocket(m,s)}),n.onSocket(m);return}let h=new Error(`no Duplex stream was returned to agent-base for \`${n.method} ${n.path}\``);l(h)};if(typeof this.callback!="function"){l(new Error("`callback` is not defined"));return}this.promisifiedCallback||(this.callback.length>=3?(D2("Converting legacy callback function to promise"),this.promisifiedCallback=Mrt.default(this.callback)):this.promisifiedCallback=this.callback),typeof u=="number"&&u>0&&(c=setTimeout(d,u)),"port"in s&&typeof s.port!="number"&&(s.port=Number(s.port));try{D2("Resolving socket for %o request: %o",s.protocol,`${n.method} ${n.path}`),Promise.resolve(this.promisifiedCallback(n,s)).then(f,p)}catch(m){Promise.reject(m).catch(p)}}freeSocket(n,o){D2("Freeing socket %o %o",n.constructor.name,o),n.destroy()}destroy(){D2("Destroying agent %o",this.constructor.name)}}t.Agent=e,t.prototype=t.Agent.prototype})(j8||(j8={}));jCe.exports=j8});var VCe=M(L2=>{"use strict";var Urt=L2&&L2.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(L2,"__esModule",{value:!0});var Brt=Urt(Sl()),N2=Brt.default("https-proxy-agent:parse-proxy-response");function qrt(t){return new Promise((e,r)=>{let n=0,o=[];function s(){let p=t.read();p?d(p):t.once("readable",s)}function a(){t.removeListener("end",u),t.removeListener("error",l),t.removeListener("close",c),t.removeListener("readable",s)}function c(p){N2("onclose had error %o",p)}function u(){N2("onend")}function l(p){a(),N2("onerror %o",p),r(p)}function d(p){o.push(p),n+=p.length;let f=Buffer.concat(o,n);if(f.indexOf(`\r
\r
`)===-1){N2("have not received end of HTTP headers yet..."),s();return}let h=f.toString("ascii",0,f.indexOf(`\r
`)),g=+h.split(" ")[1];N2("got proxy server response: %o",h),e({statusCode:g,buffered:f})}t.on("error",l),t.on("close",c),t.on("end",u),s()})}L2.default=qrt});var $Ce=M(pb=>{"use strict";var Hrt=pb&&pb.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},DC=pb&&pb.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(pb,"__esModule",{value:!0});var GCe=DC(require("net")),zCe=DC(require("tls")),jrt=DC(require("url")),Vrt=DC(require("assert")),Grt=DC(Sl()),zrt=MQ(),$rt=DC(VCe()),O2=Grt.default("https-proxy-agent:agent"),FQ=class extends zrt.Agent{constructor(e){let r;if(typeof e=="string"?r=jrt.default.parse(e):r=e,!r)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");O2("creating new HttpsProxyAgent instance: %o",r),super(r);let n=Object.assign({},r);this.secureProxy=r.secureProxy||Yrt(n.protocol),n.host=n.hostname||n.host,typeof n.port=="string"&&(n.port=parseInt(n.port,10)),!n.port&&n.host&&(n.port=this.secureProxy?443:80),this.secureProxy&&!("ALPNProtocols"in n)&&(n.ALPNProtocols=["http 1.1"]),n.host&&n.path&&(delete n.path,delete n.pathname),this.proxy=n}callback(e,r){return Hrt(this,void 0,void 0,function*(){let{proxy:n,secureProxy:o}=this,s;o?(O2("Creating `tls.Socket`: %o",n),s=zCe.default.connect(n)):(O2("Creating `net.Socket`: %o",n),s=GCe.default.connect(n));let a=Object.assign({},n.headers),u=`CONNECT ${`${r.host}:${r.port}`} HTTP/1.1\r
`;n.auth&&(a["Proxy-Authorization"]=`Basic ${Buffer.from(n.auth).toString("base64")}`);let{host:l,port:d,secureEndpoint:p}=r;Krt(d,p)||(l+=`:${d}`),a.Host=l,a.Connection="close";for(let v of Object.keys(a))u+=`${v}: ${a[v]}\r
`;let f=$rt.default(s);s.write(`${u}\r
`);let{statusCode:m,buffered:h}=yield f;if(m===200){if(e.once("socket",Wrt),r.secureEndpoint){O2("Upgrading socket connection to TLS");let v=r.servername||r.host;return zCe.default.connect(Object.assign(Object.assign({},Qrt(r,"host","hostname","path","port")),{socket:s,servername:v}))}return s}s.destroy();let g=new GCe.default.Socket({writable:!1});return g.readable=!0,e.once("socket",v=>{O2("replaying proxy buffer for failed request"),Vrt.default(v.listenerCount("data")>0),v.push(h),v.push(null)}),g})}};pb.default=FQ;function Wrt(t){t.resume()}function Krt(t,e){return!!(!e&&t===80||e&&t===443)}function Yrt(t){return typeof t=="string"?/^https:?$/i.test(t):!1}function Qrt(t,...e){let r={},n;for(n in t)e.includes(n)||(r[n]=t[n]);return r}});var KCe=M((qQ,WCe)=>{"use strict";var Xrt=qQ&&qQ.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},UQ=Xrt($Ce());function BQ(t){return new UQ.default(t)}(function(t){t.HttpsProxyAgent=UQ.default,t.prototype=UQ.default.prototype})(BQ||(BQ={}));WCe.exports=BQ});var YCe=M(HQ=>{"use strict";Object.defineProperty(HQ,"__esModule",{value:!0});function Jrt(t,e,{signal:r}={}){return new Promise((n,o)=>{function s(){r?.removeEventListener("abort",s),t.removeListener(e,a),t.removeListener("error",c)}function a(...u){s(),n(u)}function c(u){s(),o(u)}r?.addEventListener("abort",s),t.on(e,a),t.on("error",c)})}HQ.default=Jrt});var QCe=M(fb=>{"use strict";var Zrt=fb&&fb.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},M2=fb&&fb.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(fb,"__esModule",{value:!0});var ent=M2(require("net")),tnt=M2(require("tls")),jQ=M2(require("url")),rnt=M2(Sl()),nnt=M2(YCe()),int=MQ(),rv=(0,rnt.default)("http-proxy-agent");function ont(t){return typeof t=="string"?/^https:?$/i.test(t):!1}var VQ=class extends int.Agent{constructor(e){let r;if(typeof e=="string"?r=jQ.default.parse(e):r=e,!r)throw new Error("an HTTP(S) proxy server `host` and `port` must be specified!");rv("Creating new HttpProxyAgent instance: %o",r),super(r);let n=Object.assign({},r);this.secureProxy=r.secureProxy||ont(n.protocol),n.host=n.hostname||n.host,typeof n.port=="string"&&(n.port=parseInt(n.port,10)),!n.port&&n.host&&(n.port=this.secureProxy?443:80),n.host&&n.path&&(delete n.path,delete n.pathname),this.proxy=n}callback(e,r){return Zrt(this,void 0,void 0,function*(){let{proxy:n,secureProxy:o}=this,s=jQ.default.parse(e.path);s.protocol||(s.protocol="http:"),s.hostname||(s.hostname=r.hostname||r.host||null),s.port==null&&typeof r.port&&(s.port=String(r.port)),s.port==="80"&&(s.port=""),e.path=jQ.default.format(s),n.auth&&e.setHeader("Proxy-Authorization",`Basic ${Buffer.from(n.auth).toString("base64")}`);let a;if(o?(rv("Creating `tls.Socket`: %o",n),a=tnt.default.connect(n)):(rv("Creating `net.Socket`: %o",n),a=ent.default.connect(n)),e._header){let c,u;rv("Regenerating stored HTTP header string for request"),e._header=null,e._implicitHeader(),e.output&&e.output.length>0?(rv("Patching connection write() output buffer with updated header"),c=e.output[0],u=c.indexOf(`\r
\r
`)+4,e.output[0]=e._header+c.substring(u),rv("Output buffer: %o",e.output)):e.outputData&&e.outputData.length>0&&(rv("Patching connection write() output buffer with updated header"),c=e.outputData[0].data,u=c.indexOf(`\r
\r
`)+4,e.outputData[0].data=e._header+c.substring(u),rv("Output buffer: %o",e.outputData[0].data))}return yield(0,nnt.default)(a,"connect"),a})}};fb.default=VQ});var JCe=M(($Q,XCe)=>{"use strict";var snt=$Q&&$Q.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},GQ=snt(QCe());function zQ(t){return new GQ.default(t)}(function(t){t.HttpProxyAgent=GQ.default,t.prototype=GQ.default.prototype})(zQ||(zQ={}));XCe.exports=zQ});function V8(t){if(process.env[t])return process.env[t];if(process.env[t.toLowerCase()])return process.env[t.toLowerCase()]}function pnt(){if(!process)return;let t=V8(ant),e=V8(unt),r=V8(cnt);return t||e||r}function fnt(t,e,r){if(e.length===0)return!1;let n=new URL(t).hostname;if(r?.has(n))return r.get(n);let o=!1;for(let s of e)s[0]==="."?(n.endsWith(s)||n.length===s.length-1&&n===s.slice(1))&&(o=!0):n===s&&(o=!0);return r?.set(n,o),o}function mnt(){let t=V8(lnt);return nEe=!0,t?t.split(",").map(e=>e.trim()).filter(e=>e.length):[]}function KQ(t){if(!t&&(t=pnt(),!t))return;let e=new URL(t);return{host:(e.protocol?e.protocol+"//":"")+e.hostname,port:Number.parseInt(e.port||"80"),username:e.username,password:e.password}}function eEe(t,{headers:e,tlsSettings:r}){let n;try{n=new URL(t.host)}catch{throw new Error(`Expecting a valid host string in proxy settings, but found "${t.host}".`)}r&&ms.warning("TLS settings are not supported in combination with custom Proxy, certificates provided to the client will be ignored.");let o={hostname:n.hostname,port:t.port,protocol:n.protocol,headers:e.toJSON()};return t.username&&t.password?o.auth=`${t.username}:${t.password}`:t.username&&(o.auth=`${t.username}`),o}function hnt(t,e){if(t.agent)return;let n=new URL(t.url).protocol!=="https:",o=t.proxySettings;if(o)if(n){if(!e.httpProxyAgent){let s=eEe(o,t);e.httpProxyAgent=new rEe.HttpProxyAgent(s)}t.agent=e.httpProxyAgent}else{if(!e.httpsProxyAgent){let s=eEe(o,t);e.httpsProxyAgent=new tEe.HttpsProxyAgent(s)}t.agent=e.httpsProxyAgent}}function G8(t=KQ(),e){nEe||ZCe.push(...mnt());let r={};return{name:WQ,async sendRequest(n,o){var s;return!n.proxySettings&&!fnt(n.url,(s=e?.customNoProxyList)!==null&&s!==void 0?s:ZCe,e?.customNoProxyList?void 0:dnt)&&(n.proxySettings=t),n.proxySettings&&hnt(n,r),o(n)}}}var tEe,rEe,ant,cnt,unt,lnt,WQ,ZCe,nEe,dnt,YQ=R(()=>{tEe=z(KCe()),rEe=z(JCe());IC();ant="HTTPS_PROXY",cnt="HTTP_PROXY",unt="ALL_PROXY",lnt="NO_PROXY",WQ="proxyPolicy",ZCe=[],nEe=!1,dnt=new Map});function z8(t="x-ms-client-request-id"){return{name:QQ,async sendRequest(e,r){return e.headers.has(t)||e.headers.set(t,e.requestId),r(e)}}}var QQ,XQ=R(()=>{QQ="setClientRequestIdPolicy"});function $8(t){return{name:JQ,sendRequest:async(e,r)=>(e.tlsSettings||(e.tlsSettings=t),r(e))}}var JQ,ZQ=R(()=>{JQ="tlsPolicy"});function iEe(t={}){let e=new eX(t.parentContext);return t.span&&(e=e.setValue(NC.span,t.span)),t.namespace&&(e=e.setValue(NC.namespace,t.namespace)),e}var NC,eX,tX=R(()=>{NC={span:Symbol.for("@azure/core-tracing span"),namespace:Symbol.for("@azure/core-tracing namespace")};eX=class t{constructor(e){this._contextMap=e instanceof t?new Map(e._contextMap):new Map}setValue(e,r){let n=new t(this);return n._contextMap.set(e,r),n}getValue(e){return this._contextMap.get(e)}deleteValue(e){let r=new t(this);return r._contextMap.delete(e),r}}});function gnt(){return{end:()=>{},isRecording:()=>!1,recordException:()=>{},setAttribute:()=>{},setStatus:()=>{}}}function vnt(){return{createRequestHeaders:()=>({}),parseTraceparentHeader:()=>{},startSpan:(t,e)=>({span:gnt(),tracingContext:iEe({parentContext:e.tracingContext})}),withContext(t,e,...r){return e(...r)}}}function F2(){return rX||(rX=vnt()),rX}var rX,oEe=R(()=>{tX()});function nX(t){let{namespace:e,packageName:r,packageVersion:n}=t;function o(l,d,p){var f;let m=F2().startSpan(l,Object.assign(Object.assign({},p),{packageName:r,packageVersion:n,tracingContext:(f=d?.tracingOptions)===null||f===void 0?void 0:f.tracingContext})),h=m.tracingContext,g=m.span;h.getValue(NC.namespace)||(h=h.setValue(NC.namespace,e)),g.setAttribute("az.namespace",h.getValue(NC.namespace));let v=Object.assign({},d,{tracingOptions:Object.assign(Object.assign({},d?.tracingOptions),{tracingContext:h})});return{span:g,updatedOptions:v}}async function s(l,d,p,f){let{span:m,updatedOptions:h}=o(l,d,f);try{let g=await a(h.tracingOptions.tracingContext,()=>Promise.resolve(p(h,m)));return m.setStatus({status:"success"}),g}catch(g){throw m.setStatus({status:"error",error:g}),g}finally{m.end()}}function a(l,d,...p){return F2().withContext(l,d,...p)}function c(l){return F2().parseTraceparentHeader(l)}function u(l){return F2().createRequestHeaders(l)}return{startSpan:o,withSpan:s,withContext:a,parseTraceparentHeader:c,createRequestHeaders:u}}var sEe=R(()=>{oEe();tX()});var aEe=R(()=>{sEe()});var cEe,uEe,lEe=R(()=>{cEe=require("util"),uEe=cEe.inspect.custom});function W8(t){return t instanceof Nc?!0:EC(t)&&t.name==="RestError"}var ynt,Nc,K8=R(()=>{wC();lEe();cQ();ynt=new RC,Nc=class t extends Error{constructor(e,r={}){super(e),this.name="RestError",this.code=r.code,this.statusCode=r.statusCode,this.request=r.request,this.response=r.response,Object.setPrototypeOf(this,t.prototype)}[uEe](){return`RestError: ${this.message} 
 ${ynt.sanitize(this)}`}};Nc.REQUEST_SEND_ERROR="REQUEST_SEND_ERROR";Nc.PARSE_ERROR="PARSE_ERROR"});function Y8(t={}){let e=P8(t.userAgentPrefix),r=bnt();return{name:iX,async sendRequest(n,o){var s,a;if(!r||!(!((s=n.tracingOptions)===null||s===void 0)&&s.tracingContext))return o(n);let{span:c,tracingContext:u}=(a=_nt(r,n,e))!==null&&a!==void 0?a:{};if(!c||!u)return o(n);try{let l=await r.withContext(u,o,n);return Snt(c,l),l}catch(l){throw xnt(c,l),l}}}}function bnt(){try{return nX({namespace:"",packageName:"@azure/core-rest-pipeline",packageVersion:k8})}catch(t){ms.warning(`Error when creating the TracingClient: ${TC(t)}`);return}}function _nt(t,e,r){try{let{span:n,updatedOptions:o}=t.startSpan(`HTTP ${e.method}`,{tracingOptions:e.tracingOptions},{spanKind:"client",spanAttributes:{"http.method":e.method,"http.url":e.url,requestId:e.requestId}});if(!n.isRecording()){n.end();return}r&&n.setAttribute("http.user_agent",r);let s=t.createRequestHeaders(o.tracingOptions.tracingContext);for(let[a,c]of Object.entries(s))e.headers.set(a,c);return{span:n,tracingContext:o.tracingOptions.tracingContext}}catch(n){ms.warning(`Skipping creating a tracing span due to an error: ${TC(n)}`);return}}function xnt(t,e){try{t.setStatus({status:"error",error:EC(e)?e:void 0}),W8(e)&&e.statusCode&&t.setAttribute("http.status_code",e.statusCode),t.end()}catch(r){ms.warning(`Skipping tracing span processing due to an error: ${TC(r)}`)}}function Snt(t,e){try{t.setAttribute("http.status_code",e.status);let r=e.headers.get("x-ms-request-id");r&&t.setAttribute("serviceRequestId",r),t.setStatus({status:"success"}),t.end()}catch(r){ms.warning(`Skipping tracing span processing due to an error: ${TC(r)}`)}}var iX,oX=R(()=>{aEe();fQ();mQ();IC();wC();K8();iX="tracingPolicy"});function dEe(t){let e=b8();return C8&&(t.tlsOptions&&e.addPolicy($8(t.tlsOptions)),e.addPolicy(G8(t.proxyOptions)),e.addPolicy(D8())),e.addPolicy(H8()),e.addPolicy(A8(t.userAgentOptions)),e.addPolicy(z8()),e.addPolicy(U8(t.retryOptions),{phase:"Retry"}),e.addPolicy(Y8(t.userAgentOptions),{afterPhase:"Retry"}),C8&&e.addPolicy(R8(t.redirectOptions),{afterPhase:"Retry"}),e.addPolicy(w8(t.loggingOptions),{afterPhase:"Sign"}),e}var pEe=R(()=>{lQ();KY();pQ();gQ();yQ();_Q();DQ();wC();YQ();XQ();ZQ();oX()});function Q8(t){return t.toLowerCase()}function*Int(t){for(let e of t.values())yield[e.name,e.value]}function LC(t){return new sX(t)}var sX,X8=R(()=>{sX=class{constructor(e){if(this._headersMap=new Map,e)for(let r of Object.keys(e))this.set(r,e[r])}set(e,r){this._headersMap.set(Q8(e),{name:e,value:String(r)})}get(e){var r;return(r=this._headersMap.get(Q8(e)))===null||r===void 0?void 0:r.value}has(e){return this._headersMap.has(Q8(e))}delete(e){this._headersMap.delete(Q8(e))}toJSON(e={}){let r={};if(e.preserveCase)for(let n of this._headersMap.values())r[n.name]=n.value;else for(let[n,o]of this._headersMap)r[n]=o.value;return r}toString(){return JSON.stringify(this.toJSON({preserveCase:!0}))}[Symbol.iterator](){return Int(this._headersMap)}}});function U2(t){return t&&typeof t.pipe=="function"}function fEe(t){return new Promise(e=>{t.on("close",e),t.on("end",e),t.on("error",e)})}function hEe(t){return t&&typeof t.byteLength=="number"}function Ent(t){let e=LC();for(let r of Object.keys(t.headers)){let n=t.headers[r];Array.isArray(n)?n.length>0&&e.set(r,n[0]):n&&e.set(r,n)}return e}function Tnt(t,e){let r=e.get("Content-Encoding");if(r==="gzip"){let n=Z8.createGunzip();return t.pipe(n),n}else if(r==="deflate"){let n=Z8.createInflate();return t.pipe(n),n}return t}function wnt(t){return new Promise((e,r)=>{let n=[];t.on("data",o=>{Buffer.isBuffer(o)?n.push(o):n.push(Buffer.from(o))}),t.on("end",()=>{e(Buffer.concat(n).toString("utf8"))}),t.on("error",o=>{o&&o?.name==="AbortError"?r(o):r(new Nc(`Error reading response as text: ${o.message}`,{code:Nc.PARSE_ERROR}))})})}function Rnt(t){return t?Buffer.isBuffer(t)?t.length:U2(t)?null:hEe(t)?t.byteLength:typeof t=="string"?Buffer.from(t).length:null:0}function gEe(){return new aX}var OC,MC,Z8,mEe,Cnt,J8,aX,vEe=R(()=>{OC=z(require("http")),MC=z(require("https")),Z8=z(require("zlib")),mEe=require("stream");T8();X8();K8();IC();Cnt={};J8=class extends mEe.Transform{constructor(e){super(),this.loadedBytes=0,this.progressCallback=e}_transform(e,r,n){this.push(e),this.loadedBytes+=e.length;try{this.progressCallback({loadedBytes:this.loadedBytes}),n()}catch(o){n(o)}}},aX=class{constructor(){this.cachedHttpsAgents=new WeakMap}async sendRequest(e){var r,n,o;let s=new k2,a;if(e.abortSignal){if(e.abortSignal.aborted)throw new ip("The operation was aborted.");a=p=>{p.type==="abort"&&s.abort()},e.abortSignal.addEventListener("abort",a)}e.timeout>0&&setTimeout(()=>{s.abort()},e.timeout);let c=e.headers.get("Accept-Encoding"),u=c?.includes("gzip")||c?.includes("deflate"),l=typeof e.body=="function"?e.body():e.body;if(l&&!e.headers.has("Content-Length")){let p=Rnt(l);p!==null&&e.headers.set("Content-Length",p)}let d;try{if(l&&e.onUploadProgress){let v=e.onUploadProgress,y=new J8(v);y.on("error",b=>{ms.error("Error in upload progress",b)}),U2(l)?l.pipe(y):y.end(l),l=y}let p=await this.makeRequest(e,s,l),f=Ent(p),h={status:(r=p.statusCode)!==null&&r!==void 0?r:0,headers:f,request:e};if(e.method==="HEAD")return p.resume(),h;d=u?Tnt(p,f):p;let g=e.onDownloadProgress;if(g){let v=new J8(g);v.on("error",y=>{ms.error("Error in download progress",y)}),d.pipe(v),d=v}return!((n=e.streamResponseStatusCodes)===null||n===void 0)&&n.has(Number.POSITIVE_INFINITY)||!((o=e.streamResponseStatusCodes)===null||o===void 0)&&o.has(h.status)?h.readableStreamBody=d:h.bodyAsText=await wnt(d),h}finally{if(e.abortSignal&&a){let p=Promise.resolve();U2(l)&&(p=fEe(l));let f=Promise.resolve();U2(d)&&(f=fEe(d)),Promise.all([p,f]).then(()=>{var m;a&&((m=e.abortSignal)===null||m===void 0||m.removeEventListener("abort",a))}).catch(m=>{ms.warning("Error when cleaning up abortListener on httpRequest",m)})}}}makeRequest(e,r,n){var o;let s=new URL(e.url),a=s.protocol!=="https:";if(a&&!e.allowInsecureConnection)throw new Error(`Cannot connect to ${e.url} while allowInsecureConnection is false.`);let u={agent:(o=e.agent)!==null&&o!==void 0?o:this.getOrCreateAgent(e,a),hostname:s.hostname,path:`${s.pathname}${s.search}`,port:s.port,method:e.method,headers:e.headers.toJSON({preserveCase:!0})};return new Promise((l,d)=>{let p=a?OC.request(u,l):MC.request(u,l);p.once("error",f=>{var m;d(new Nc(f.message,{code:(m=f.code)!==null&&m!==void 0?m:Nc.REQUEST_SEND_ERROR,request:e}))}),r.signal.addEventListener("abort",()=>{let f=new ip("The operation was aborted.");p.destroy(f),d(f)}),n&&U2(n)?n.pipe(p):n?typeof n=="string"||Buffer.isBuffer(n)?p.end(n):hEe(n)?p.end(ArrayBuffer.isView(n)?Buffer.from(n.buffer):Buffer.from(n)):(ms.error("Unrecognized body type",n),d(new Nc("Unrecognized body type"))):p.end()})}getOrCreateAgent(e,r){var n;let o=e.disableKeepAlive;if(r)return o?OC.globalAgent:(this.cachedHttpAgent||(this.cachedHttpAgent=new OC.Agent({keepAlive:!0})),this.cachedHttpAgent);{if(o&&!e.tlsSettings)return MC.globalAgent;let s=(n=e.tlsSettings)!==null&&n!==void 0?n:Cnt,a=this.cachedHttpsAgents.get(s);return a&&a.options.keepAlive===!o||(ms.info("No cached TLS Agent exist, creating a new Agent"),a=new MC.Agent(Object.assign({keepAlive:!o},s)),this.cachedHttpsAgents.set(s,a)),a}}}});function yEe(){return gEe()}var bEe=R(()=>{vEe()});function cX(){return eM>tM.length-16&&(_Ee.default.randomFillSync(tM),eM=0),tM.slice(eM,eM+=16)}var _Ee,tM,eM,xEe=R(()=>{_Ee=z(require("crypto")),tM=new Uint8Array(256),eM=tM.length});var SEe,IEe=R(()=>{SEe=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i});function knt(t){return typeof t=="string"&&SEe.test(t)}var CEe,EEe=R(()=>{IEe();CEe=knt});function Pnt(t,e=0){let r=(hs[t[e+0]]+hs[t[e+1]]+hs[t[e+2]]+hs[t[e+3]]+"-"+hs[t[e+4]]+hs[t[e+5]]+"-"+hs[t[e+6]]+hs[t[e+7]]+"-"+hs[t[e+8]]+hs[t[e+9]]+"-"+hs[t[e+10]]+hs[t[e+11]]+hs[t[e+12]]+hs[t[e+13]]+hs[t[e+14]]+hs[t[e+15]]).toLowerCase();if(!CEe(r))throw TypeError("Stringified UUID is invalid");return r}var hs,TEe,wEe=R(()=>{EEe();hs=[];for(let t=0;t<256;++t)hs.push((t+256).toString(16).substr(1));TEe=Pnt});function Ant(t,e,r){t=t||{};let n=t.random||(t.rng||cX)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){r=r||0;for(let o=0;o<16;++o)e[r+o]=n[o];return e}return TEe(n)}var uX,REe=R(()=>{xEe();wEe();uX=Ant});var kEe=R(()=>{REe()});function PEe(){return uX()}var AEe=R(()=>{kEe()});function DEe(t){return new lX(t)}var lX,NEe=R(()=>{X8();AEe();lX=class{constructor(e){var r,n,o,s,a,c,u;this.url=e.url,this.body=e.body,this.headers=(r=e.headers)!==null&&r!==void 0?r:LC(),this.method=(n=e.method)!==null&&n!==void 0?n:"GET",this.timeout=(o=e.timeout)!==null&&o!==void 0?o:0,this.formData=e.formData,this.disableKeepAlive=(s=e.disableKeepAlive)!==null&&s!==void 0?s:!1,this.proxySettings=e.proxySettings,this.streamResponseStatusCodes=e.streamResponseStatusCodes,this.withCredentials=(a=e.withCredentials)!==null&&a!==void 0?a:!1,this.abortSignal=e.abortSignal,this.tracingOptions=e.tracingOptions,this.onUploadProgress=e.onUploadProgress,this.onDownloadProgress=e.onDownloadProgress,this.requestId=e.requestId||PEe(),this.allowInsecureConnection=(c=e.allowInsecureConnection)!==null&&c!==void 0?c:!1,this.enableBrowserStreams=(u=e.enableBrowserStreams)!==null&&u!==void 0?u:!1}}});function OEe(t={}){var e;return op([PC(Object.assign(Object.assign({},t),{ignoreSystemErrors:!0}))],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:3})}var LEe,MEe=R(()=>{F8();AC();LEe="exponentialRetryPolicy"});function FEe(t={}){var e;return{name:dX,sendRequest:op([PC(Object.assign(Object.assign({},t),{ignoreHttpStatusCodes:!0}))],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:3}).sendRequest}}var dX,UEe=R(()=>{F8();AC();dX="systemErrorRetryPolicy"});function BEe(t={}){var e;return{name:pX,sendRequest:op([O8()],{maxRetries:(e=t.maxRetries)!==null&&e!==void 0?e:3}).sendRequest}}var pX,qEe=R(()=>{M8();AC();pX="throttlingRetryPolicy"});async function Nnt(t,e,r){async function n(){if(Date.now()<r)try{return await t()}catch{return null}else{let s=await t();if(s===null)throw new Error("Failed to refresh access token.");return s}}let o=await n();for(;o===null;)await N8(e),o=await n();return o}function HEe(t,e){let r=null,n=null,o,s=Object.assign(Object.assign({},Dnt),e),a={get isRefreshing(){return r!==null},get shouldRefresh(){var u;return!a.isRefreshing&&((u=n?.expiresOnTimestamp)!==null&&u!==void 0?u:0)-s.refreshWindowInMs<Date.now()},get mustRefresh(){return n===null||n.expiresOnTimestamp-s.forcedRefreshWindowInMs<Date.now()}};function c(u,l){var d;return a.isRefreshing||(r=Nnt(()=>t.getToken(u,l),s.retryIntervalInMs,(d=n?.expiresOnTimestamp)!==null&&d!==void 0?d:Date.now()).then(f=>(r=null,n=f,o=l.tenantId,n)).catch(f=>{throw r=null,n=null,o=void 0,f})),r}return async(u,l)=>o!==l.tenantId||!!l.claims||a.mustRefresh?c(u,l):(a.shouldRefresh&&c(u,l),n)}var Dnt,jEe=R(()=>{L8();Dnt={forcedRefreshWindowInMs:1e3,retryIntervalInMs:3e3,refreshWindowInMs:1e3*60*2}});async function Lnt(t){let{scopes:e,getAccessToken:r,request:n}=t,o={abortSignal:n.abortSignal,tracingOptions:n.tracingOptions},s=await r(e,o);s&&t.request.headers.set("Authorization",`Bearer ${s.token}`)}function Ont(t){let e=t.headers.get("WWW-Authenticate");if(t.status===401&&e)return e}function VEe(t){var e;let{credential:r,scopes:n,challengeCallbacks:o}=t,s=t.logger||ms,a=Object.assign({authorizeRequest:(e=o?.authorizeRequest)!==null&&e!==void 0?e:Lnt,authorizeRequestOnChallenge:o?.authorizeRequestOnChallenge},o),c=r?HEe(r):()=>Promise.resolve(null);return{name:fX,async sendRequest(u,l){if(!u.url.toLowerCase().startsWith("https://"))throw new Error("Bearer token authentication is not permitted for non-TLS protected (non-https) URLs.");await a.authorizeRequest({scopes:Array.isArray(n)?n:[n],request:u,getAccessToken:c,logger:s});let d,p;try{d=await l(u)}catch(f){p=f,d=f.response}if(a.authorizeRequestOnChallenge&&d?.status===401&&Ont(d)&&await a.authorizeRequestOnChallenge({scopes:Array.isArray(n)?n:[n],request:u,response:d,getAccessToken:c,logger:s}))return l(u);if(p)throw p;return d}}}var fX,GEe=R(()=>{jEe();IC();fX="bearerTokenAuthenticationPolicy"});function zEe(){return{name:mX,async sendRequest(t,e){if(typeof t.body=="string"&&t.body.startsWith("[")){let r=JSON.parse(t.body);Array.isArray(r)&&(t.body=r.map(n=>JSON.stringify(n)+`
`).join(""))}return e(t)}}}var mX,$Ee=R(()=>{mX="ndJsonPolicy"});var WEe={};mn(WEe,{RestError:()=>Nc,bearerTokenAuthenticationPolicy:()=>VEe,bearerTokenAuthenticationPolicyName:()=>fX,createDefaultHttpClient:()=>yEe,createEmptyPipeline:()=>b8,createHttpHeaders:()=>LC,createPipelineFromOptions:()=>dEe,createPipelineRequest:()=>DEe,decompressResponsePolicy:()=>D8,decompressResponsePolicyName:()=>vQ,defaultRetryPolicy:()=>U8,exponentialRetryPolicy:()=>OEe,exponentialRetryPolicyName:()=>LEe,formDataPolicy:()=>H8,formDataPolicyName:()=>AQ,getDefaultProxySettings:()=>KQ,isRestError:()=>W8,logPolicy:()=>w8,logPolicyName:()=>uQ,ndJsonPolicy:()=>zEe,ndJsonPolicyName:()=>mX,proxyPolicy:()=>G8,proxyPolicyName:()=>WQ,redirectPolicy:()=>R8,redirectPolicyName:()=>dQ,retryPolicy:()=>op,setClientRequestIdPolicy:()=>z8,setClientRequestIdPolicyName:()=>QQ,systemErrorRetryPolicy:()=>FEe,systemErrorRetryPolicyName:()=>dX,throttlingRetryPolicy:()=>BEe,throttlingRetryPolicyName:()=>pX,tlsPolicy:()=>$8,tlsPolicyName:()=>JQ,tracingPolicy:()=>Y8,tracingPolicyName:()=>iX,userAgentPolicy:()=>A8,userAgentPolicyName:()=>hQ});var KEe=R(()=>{KY();pEe();bEe();X8();NEe();K8();yQ();MEe();XQ();lQ();YQ();pQ();UEe();qEe();AC();oX();_Q();gQ();ZQ();DQ();GEe();$Ee()});var XEe=M((B2,QEe)=>{"use strict";var Mnt=B2&&B2.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},Fnt=B2&&B2.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},YEe=(KEe(),$i(WEe)),Unt="https://monitor.azure.com//.default";function Bnt(t){return null}var qnt=function(){function t(e,r){var n=r?[r]:[Unt];this._azureTokenPolicy=YEe.bearerTokenAuthenticationPolicy({credential:e,scopes:n})}return t.prototype.addAuthorizationHeader=function(e){return Mnt(this,void 0,void 0,function(){var r,n;return Fnt(this,function(o){switch(o.label){case 0:return r="authorization",n=YEe.createPipelineRequest({url:"https://"}),[4,this._azureTokenPolicy.sendRequest(n,Bnt)];case 1:return o.sent(),e.headers[r]=n.headers.get(r),[2]}})})},t}();QEe.exports=qnt});var ZEe=M((Y1r,JEe)=>{"use strict";var Hnt=Hn(),jnt=us(),Vnt=function(){function t(e,r,n,o){this._buffer=[],this._lastSend=0,this._isDisabled=e,this._getBatchSize=r,this._getBatchIntervalMs=n,this._sender=o}return t.prototype.setUseDiskRetryCaching=function(e,r,n){this._sender.setDiskRetryMode(e,r,n)},t.prototype.send=function(e){var r=this;if(!this._isDisabled()){if(!e){Hnt.warn("Cannot send null/undefined telemetry");return}if(this._buffer.push(e),this._buffer.length>=this._getBatchSize()){this.triggerSend(!1);return}!this._timeoutHandle&&this._buffer.length>0&&(this._timeoutHandle=setTimeout(function(){r._timeoutHandle=null,r.triggerSend(!1)},this._getBatchIntervalMs()))}},t.prototype.triggerSend=function(e,r){var n=this._buffer.length<1;n||(e||jnt.isNodeExit?(this._sender.saveOnCrash(this._buffer),typeof r=="function"&&r("data saved on crash")):this._sender.send(this._buffer,r)),this._lastSend=+new Date,this._buffer=[],clearTimeout(this._timeoutHandle),this._timeoutHandle=null,n&&typeof r=="function"&&r("no data to send")},t}();JEe.exports=Vnt});var eTe=M(rM=>{"use strict";Object.defineProperty(rM,"__esModule",{value:!0});rM.azureRoleEnvironmentTelemetryProcessor=void 0;function Gnt(t,e){}rM.azureRoleEnvironmentTelemetryProcessor=Gnt});var nTe=M(FC=>{"use strict";Object.defineProperty(FC,"__esModule",{value:!0});FC.getSamplingHashCode=FC.samplingTelemetryProcessor=void 0;var tTe=Ns();function znt(t,e){var r=t.sampleRate,n=!1;return r==null||r>=100||t.data&&tTe.TelemetryType.Metric===tTe.baseTypeToTelemetryType(t.data.baseType)?!0:(e.correlationContext&&e.correlationContext.operation?n=rTe(e.correlationContext.operation.id)<r:n=Math.random()*100<r,n)}FC.samplingTelemetryProcessor=znt;function rTe(t){var e=-2147483648,r=2147483647,n=5381;if(!t)return 0;for(;t.length<8;)t=t+t;for(var o=0;o<t.length;o++)n=((n<<5)+n|0)+t.charCodeAt(o)|0;return n=n<=e?r:Math.abs(n),n/r*100}FC.getSamplingHashCode=rTe});var iTe=M(nM=>{"use strict";Object.defineProperty(nM,"__esModule",{value:!0});nM.performanceMetricsTelemetryProcessor=void 0;var hX=o8(),gX=Ns();function $nt(t,e){switch(e&&e.addDocument(t),t.data.baseType){case gX.TelemetryTypeString.Exception:hX.countException();break;case gX.TelemetryTypeString.Request:var r=t.data.baseData;hX.countRequest(r.duration,r.success);break;case gX.TelemetryTypeString.Dependency:var n=t.data.baseData;hX.countDependency(n.duration,n.success);break}return!0}nM.performanceMetricsTelemetryProcessor=$nt});var oTe=M(UC=>{"use strict";var sp=UC&&UC.__assign||function(){return sp=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},sp.apply(this,arguments)};Object.defineProperty(UC,"__esModule",{value:!0});UC.preAggregatedMetricsTelemetryProcessor=void 0;var Wnt=Ns(),q2=EY(),iM=Ns();function Knt(t,e){if(q2.isEnabled())switch(t.data.baseType){case iM.TelemetryTypeString.Exception:var r=t.data.baseData;r.properties=sp(sp({},r.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Exceptions', Ver:'1.1')"});var n={cloudRoleInstance:t.tags[e.keys.cloudRoleInstance],cloudRoleName:t.tags[e.keys.cloudRole]};q2.countException(n);break;case iM.TelemetryTypeString.Trace:var o=t.data.baseData;o.properties=sp(sp({},o.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Traces', Ver:'1.1')"});var s={cloudRoleInstance:t.tags[e.keys.cloudRoleInstance],cloudRoleName:t.tags[e.keys.cloudRole],traceSeverityLevel:Wnt.SeverityLevel[o.severity]};q2.countTrace(s);break;case iM.TelemetryTypeString.Request:var a=t.data.baseData;a.properties=sp(sp({},a.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Requests', Ver:'1.1')"});var c={cloudRoleInstance:t.tags[e.keys.cloudRoleInstance],cloudRoleName:t.tags[e.keys.cloudRole],operationSynthetic:t.tags[e.keys.operationSyntheticSource],requestSuccess:a.success,requestResultCode:a.responseCode};q2.countRequest(a.duration,c);break;case iM.TelemetryTypeString.Dependency:var u=t.data.baseData;u.properties=sp(sp({},u.properties),{"_MS.ProcessedByMetricExtractors":"(Name:'Dependencies', Ver:'1.1')"});var l={cloudRoleInstance:t.tags[e.keys.cloudRoleInstance],cloudRoleName:t.tags[e.keys.cloudRole],operationSynthetic:t.tags[e.keys.operationSyntheticSource],dependencySuccess:u.success,dependencyType:u.type,dependencyTarget:u.target,dependencyResultCode:u.resultCode};q2.countDependency(u.duration,l);break}return!0}UC.preAggregatedMetricsTelemetryProcessor=Knt});var sTe=M(ap=>{"use strict";var Ynt=ap&&ap.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),oM=ap&&ap.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&Ynt(e,t,r)};Object.defineProperty(ap,"__esModule",{value:!0});oM(eTe(),ap);oM(nTe(),ap);oM(iTe(),ap);oM(oTe(),ap)});var vX=M((tSr,uTe)=>{"use strict";var Ot=Ns(),Va=us(),aTe=Vg(),Qnt=Hn(),Xnt=function(){function t(){}return t.createEnvelope=function(e,r,n,o,s){var a=null;switch(r){case Ot.TelemetryType.Trace:a=t.createTraceData(e);break;case Ot.TelemetryType.Dependency:a=t.createDependencyData(e);break;case Ot.TelemetryType.Event:a=t.createEventData(e);break;case Ot.TelemetryType.Exception:a=t.createExceptionData(e);break;case Ot.TelemetryType.Request:a=t.createRequestData(e);break;case Ot.TelemetryType.Metric:a=t.createMetricData(e);break;case Ot.TelemetryType.Availability:a=t.createAvailabilityData(e);break;case Ot.TelemetryType.PageView:a=t.createPageViewData(e);break}if(a&&a.baseData&&Ot.domainSupportsProperties(a.baseData)){if(n)if(!a.baseData.properties)a.baseData.properties=n;else for(var c in n)a.baseData.properties[c]||(a.baseData.properties[c]=n[c]);t.addAzureFunctionsCorrelationProperties(a.baseData.properties),a.baseData.properties&&(a.baseData.properties=Va.validateStringMap(a.baseData.properties))}var u=s&&s.instrumentationKey||"",l=new Ot.Envelope;return l.data=a,l.iKey=u,l.name="Microsoft.ApplicationInsights."+u.replace(/-/g,"")+"."+a.baseType.substr(0,a.baseType.length-4),l.tags=this.getTags(o,e.tagOverrides),l.time=new Date().toISOString(),l.ver=1,l.sampleRate=s?s.samplingPercentage:100,r===Ot.TelemetryType.Metric&&(l.sampleRate=100),l},t.addAzureFunctionsCorrelationProperties=function(e){var r=aTe.CorrelationContextManager.getCurrentContext();if(r&&r.customProperties&&r.customProperties.getProperty instanceof Function){e=e||{};var n=r.customProperties.getProperty("InvocationId");n&&(e.InvocationId=n),n=r.customProperties.getProperty("ProcessId"),n&&(e.ProcessId=n),n=r.customProperties.getProperty("LogLevel"),n&&(e.LogLevel=n),n=r.customProperties.getProperty("Category"),n&&(e.Category=n),n=r.customProperties.getProperty("HostInstanceId"),n&&(e.HostInstanceId=n),n=r.customProperties.getProperty("AzFuncLiveLogsSessionId"),n&&(e.AzFuncLiveLogsSessionId=n)}},t.truncateProperties=function(e){if(e.properties)try{for(var r={},n=Object.keys(e.properties),o=Object.values(e.properties),s=0;s<n.length;s++)n[s].length<=150&&(Va.isDate(o[s])||(o[s]==null&&(o[s]=""),typeof o[s]=="object"&&(o[s]=Va.stringify(o[s])),r[n[s]]=String(o[s]).substring(0,8192)),r[n[s]]=o[s]);return r}catch(a){Qnt.warn("Failed to properly truncate telemetry properties: ",a)}},t.createTraceData=function(e){var r,n=new Ot.MessageData;n.message=(r=e.message)===null||r===void 0?void 0:r.substring(0,32768),n.properties=this.truncateProperties(e),isNaN(e.severity)?n.severityLevel=Ot.SeverityLevel.Information:n.severityLevel=e.severity;var o=new Ot.Data;return o.baseType=Ot.telemetryTypeToBaseType(Ot.TelemetryType.Trace),o.baseData=n,o},t.createDependencyData=function(e){var r,n,o,s=new Ot.RemoteDependencyData;s.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,1024),s.data=(n=e.data)===null||n===void 0?void 0:n.substring(0,8192),s.target=(o=e.target)===null||o===void 0?void 0:o.substring(0,1024),s.duration=Va.msToTimeSpan(e.duration),s.success=e.success,s.type=e.dependencyTypeName,s.properties=this.truncateProperties(e),s.resultCode=e.resultCode?e.resultCode.toString():"0",e.id?s.id=e.id:s.id=Va.w3cTraceId();var a=new Ot.Data;return a.baseType=Ot.telemetryTypeToBaseType(Ot.TelemetryType.Dependency),a.baseData=s,a},t.createEventData=function(e){var r,n=new Ot.EventData;n.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,512),n.properties=this.truncateProperties(e),n.measurements=e.measurements;var o=new Ot.Data;return o.baseType=Ot.telemetryTypeToBaseType(Ot.TelemetryType.Event),o.baseData=n,o},t.createExceptionData=function(e){var r,n,o=new Ot.ExceptionData;o.properties=this.truncateProperties(e),isNaN(e.severity)?o.severityLevel=Ot.SeverityLevel.Error:o.severityLevel=e.severity,o.measurements=e.measurements,o.exceptions=[];var s=e.exception.stack,a=new Ot.ExceptionDetails;a.message=(r=e.exception.message)===null||r===void 0?void 0:r.substring(0,32768),a.typeName=(n=e.exception.name)===null||n===void 0?void 0:n.substring(0,1024),a.parsedStack=this.parseStack(s),a.hasFullStack=Va.isArray(a.parsedStack)&&a.parsedStack.length>0,o.exceptions.push(a);var c=new Ot.Data;return c.baseType=Ot.telemetryTypeToBaseType(Ot.TelemetryType.Exception),c.baseData=o,c},t.createRequestData=function(e){var r,n,o,s,a=new Ot.RequestData;e.id?a.id=e.id:a.id=Va.w3cTraceId(),a.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,1024),a.url=(n=e.url)===null||n===void 0?void 0:n.substring(0,2048),a.source=(o=e.source)===null||o===void 0?void 0:o.substring(0,1024),a.duration=Va.msToTimeSpan(e.duration),a.responseCode=(s=e.resultCode?e.resultCode.toString():"0")===null||s===void 0?void 0:s.substring(0,1024),a.success=e.success,a.properties=this.truncateProperties(e),a.measurements=e.measurements;var c=new Ot.Data;return c.baseType=Ot.telemetryTypeToBaseType(Ot.TelemetryType.Request),c.baseData=a,c},t.createMetricData=function(e){var r,n=new Ot.MetricData;n.metrics=[];var o=new Ot.DataPoint;o.count=isNaN(e.count)?1:e.count,o.kind=Ot.DataPointType.Aggregation,o.max=isNaN(e.max)?e.value:e.max,o.min=isNaN(e.min)?e.value:e.min,o.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,1024),o.stdDev=isNaN(e.stdDev)?0:e.stdDev,o.value=e.value,o.ns=e.namespace,n.metrics.push(o),n.properties=this.truncateProperties(e);var s=new Ot.Data;return s.baseType=Ot.telemetryTypeToBaseType(Ot.TelemetryType.Metric),s.baseData=n,s},t.createAvailabilityData=function(e){var r,n,o=new Ot.AvailabilityData;e.id?o.id=e.id:o.id=Va.w3cTraceId(),o.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,1024),o.duration=Va.msToTimeSpan(e.duration),o.success=e.success,o.runLocation=e.runLocation,o.message=(n=e.message)===null||n===void 0?void 0:n.substring(0,8192),o.measurements=e.measurements,o.properties=this.truncateProperties(e);var s=new Ot.Data;return s.baseType=Ot.telemetryTypeToBaseType(Ot.TelemetryType.Availability),s.baseData=o,s},t.createPageViewData=function(e){var r,n,o=new Ot.PageViewData;o.name=(r=e.name)===null||r===void 0?void 0:r.substring(0,1024),o.duration=Va.msToTimeSpan(e.duration),o.url=(n=e.url)===null||n===void 0?void 0:n.substring(0,2048),o.measurements=e.measurements,o.properties=this.truncateProperties(e);var s=new Ot.Data;return s.baseType=Ot.telemetryTypeToBaseType(Ot.TelemetryType.PageView),s.baseData=o,s},t.getTags=function(e,r){var n=aTe.CorrelationContextManager.getCurrentContext(),o={};if(e&&e.tags)for(var s in e.tags)o[s]=e.tags[s];if(r)for(var s in r)o[s]=r[s];return n&&(o[e.keys.operationId]=o[e.keys.operationId]||n.operation.id,o[e.keys.operationName]=o[e.keys.operationName]||n.operation.name,o[e.keys.operationParentId]=o[e.keys.operationParentId]||n.operation.parentId),o},t.parseStack=function(e){var r=void 0;if(typeof e=="string"){var n=e.split(`
`);r=[];for(var o=0,s=0,a=0;a<=n.length;a++){var c=n[a];if(cTe.regex.test(c)){var u=new cTe(n[a],o++);s+=u.sizeInBytes,r.push(u)}}var l=32*1024;if(s>l)for(var d=0,p=r.length-1,f=0,m=d,h=p;d<p;){var g=r[d].sizeInBytes,v=r[p].sizeInBytes;if(f+=g+v,f>l){var y=h-m+1;r.splice(m,y);break}m=d,h=p,d++,p--}}return r},t}(),cTe=function(){function t(e,r){this.sizeInBytes=0,this.level=r,this.method="<no_method>",this.assembly=Va.trim(e);var n=e.match(t.regex);n&&n.length>=5&&(this.method=Va.trim(n[2])||this.method,this.fileName=Va.trim(n[4])||"<no_filename>",this.line=parseInt(n[5])||0),this.sizeInBytes+=this.method.length,this.sizeInBytes+=this.fileName.length,this.sizeInBytes+=this.assembly.length,this.sizeInBytes+=t.baseSize,this.sizeInBytes+=this.level.toString().length,this.sizeInBytes+=this.line.toString().length}return t.regex=/^(\s+at)?(.*?)(\@|\s\(|\s)([^\(\n]+):(\d+):(\d+)(\)?)$/,t.baseSize=58,t}();uTe.exports=Xnt});var lTe=M(nv=>{"use strict";var Jnt=nv&&nv.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},Znt=nv&&nv.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(nv,"__esModule",{value:!0});nv.FileAccessControl=void 0;var eit=require("fs"),tit=require("os"),BC=require("child_process"),rit=Hn(),nit=function(){function t(){}return t.checkFileProtection=function(){if(!t.OS_PROVIDES_FILE_PROTECTION&&!t.OS_FILE_PROTECTION_CHECKED)if(t.OS_FILE_PROTECTION_CHECKED=!0,t.USE_ICACLS){try{t.OS_PROVIDES_FILE_PROTECTION=eit.existsSync(t.ICACLS_PATH)}catch{}t.OS_PROVIDES_FILE_PROTECTION||rit.warn(t.TAG,"Could not find ICACLS in expected location! This is necessary to use disk retry mode on Windows.")}else t.OS_PROVIDES_FILE_PROTECTION=!0},t.applyACLRules=function(e){return Jnt(this,void 0,void 0,function(){var r,n;return Znt(this,function(o){switch(o.label){case 0:if(!t.USE_ICACLS)return[3,7];if(t.ACLED_DIRECTORIES[e]!==void 0)return[3,6];t.ACLED_DIRECTORIES[e]=!1,o.label=1;case 1:return o.trys.push([1,4,,5]),[4,this._getACLIdentity()];case 2:return r=o.sent(),[4,this._runICACLS(this._getACLArguments(e,r))];case 3:return o.sent(),t.ACLED_DIRECTORIES[e]=!0,[3,5];case 4:throw n=o.sent(),t.ACLED_DIRECTORIES[e]=!1,n;case 5:return[3,7];case 6:if(!t.ACLED_DIRECTORIES[e])throw new Error("Setting ACL restrictions did not succeed (cached result)");o.label=7;case 7:return[2]}})})},t.applyACLRulesSync=function(e){if(t.USE_ICACLS){if(t.ACLED_DIRECTORIES[e]===void 0){this._runICACLSSync(this._getACLArguments(e,this._getACLIdentitySync())),t.ACLED_DIRECTORIES[e]=!0;return}else if(!t.ACLED_DIRECTORIES[e])throw new Error("Setting ACL restrictions did not succeed (cached result)")}},t._runICACLS=function(e){return new Promise(function(r,n){var o=BC.spawn(t.ICACLS_PATH,e,{windowsHide:!0});o.on("error",function(s){return n(s)}),o.on("close",function(s,a){s===0?r():n(new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+s+")"))})})},t._runICACLSSync=function(e){if(BC.spawnSync){var r=BC.spawnSync(t.ICACLS_PATH,e,{windowsHide:!0});if(r.error)throw r.error;if(r.status!==0)throw new Error("Setting ACL restrictions did not succeed (ICACLS returned code "+r.status+")")}else throw new Error("Could not synchronously call ICACLS under current version of Node.js")},t._getACLIdentity=function(){return new Promise(function(e,r){t.ACL_IDENTITY&&e(t.ACL_IDENTITY);var n=BC.spawn(t.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]}),o="";n.stdout.on("data",function(s){return o+=s}),n.on("error",function(s){return r(s)}),n.on("close",function(s,a){t.ACL_IDENTITY=o&&o.trim(),s===0?e(t.ACL_IDENTITY):r(new Error("Getting ACL identity did not succeed (PS returned code "+s+")"))})})},t._getACLIdentitySync=function(){if(t.ACL_IDENTITY)return t.ACL_IDENTITY;if(BC.spawnSync){var e=BC.spawnSync(t.POWERSHELL_PATH,["-Command","[System.Security.Principal.WindowsIdentity]::GetCurrent().Name"],{windowsHide:!0,stdio:["ignore","pipe","pipe"]});if(e.error)throw e.error;if(e.status!==0)throw new Error("Getting ACL identity did not succeed (PS returned code "+e.status+")");return t.ACL_IDENTITY=e.stdout&&e.stdout.toString().trim(),t.ACL_IDENTITY}else throw new Error("Could not synchronously get ACL identity under current version of Node.js")},t._getACLArguments=function(e,r){return[e,"/grant","*S-1-5-32-544:(OI)(CI)F","/grant",r+":(OI)(CI)F","/inheritance:r"]},t.TAG="FileAccessControl",t.ICACLS_PATH=process.env.systemdrive+"/windows/system32/icacls.exe",t.POWERSHELL_PATH=process.env.systemdrive+"/windows/system32/windowspowershell/v1.0/powershell.exe",t.ACLED_DIRECTORIES={},t.ACL_IDENTITY=null,t.OS_FILE_PROTECTION_CHECKED=!1,t.OS_PROVIDES_FILE_PROTECTION=!1,t.USE_ICACLS=tit.type()==="Windows_NT",t}();nv.FileAccessControl=nit});var bX=M((j2,pTe)=>{"use strict";var sM=j2&&j2.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},aM=j2&&j2.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},yX=require("fs"),iit=require("os"),mb=require("path"),oit=require("zlib"),iv=ri(),sit=_C(),rm=qz(),Ga=us(),ait=require("url"),dTe=Hn(),H2=lTe(),cit=439,uit=402,lit=[200,206,402,408,429,439,500],dit=function(){function t(e,r,n,o,s,a,c){this._redirectedHost=null,this._config=e,this._onSuccess=n,this._onError=o,this._statsbeat=s,this._enableDiskRetryMode=!1,this._resendInterval=t.WAIT_BETWEEN_RESEND,this._maxBytesOnDisk=t.MAX_BYTES_ON_DISK,this._numConsecutiveFailures=0,this._numConsecutiveRedirects=0,this._resendTimer=null,this._getAuthorizationHandler=r,this._fileCleanupTimer=null,this._tempDir=mb.join(iit.tmpdir(),t.TEMPDIR_PREFIX+this._config.instrumentationKey),this._isStatsbeatSender=a||!1,this._shutdownStatsbeat=c,this._failedToIngestCounter=0,this._statsbeatHasReachedIngestionAtLeastOnce=!1}return t.prototype.setDiskRetryMode=function(e,r,n){var o=this;e&&H2.FileAccessControl.checkFileProtection(),this._enableDiskRetryMode=H2.FileAccessControl.OS_PROVIDES_FILE_PROTECTION&&e,typeof r=="number"&&r>=0&&(this._resendInterval=Math.floor(r)),typeof n=="number"&&n>=0&&(this._maxBytesOnDisk=Math.floor(n)),e&&!H2.FileAccessControl.OS_PROVIDES_FILE_PROTECTION&&(this._enableDiskRetryMode=!1,this._logWarn("Ignoring request to enable disk retry mode. Sufficient file protection capabilities were not detected.")),this._enableDiskRetryMode?(this._statsbeat&&this._statsbeat.addFeature(iv.StatsbeatFeature.DISK_RETRY),this._fileCleanupTimer||(this._fileCleanupTimer=setTimeout(function(){o._fileCleanupTask()},t.CLEANUP_TIMEOUT),this._fileCleanupTimer.unref())):(this._statsbeat&&this._statsbeat.removeFeature(iv.StatsbeatFeature.DISK_RETRY),this._fileCleanupTimer&&clearTimeout(this._fileCleanupTimer))},t.prototype.send=function(e,r){return sM(this,void 0,void 0,function(){var n,o,s,a,c,u,l,d,p=this;return aM(this,function(f){switch(f.label){case 0:if(!e)return[3,5];if(n=this._redirectedHost||this._config.endpointUrl,o=new ait.URL(n).hostname,s={method:"POST",withCredentials:!1,headers:{"Content-Type":"application/x-json-stream"}},a=this._getAuthorizationHandler?this._getAuthorizationHandler(this._config):null,!a)return[3,4];this._statsbeat&&this._statsbeat.addFeature(iv.StatsbeatFeature.AAD_HANDLING),f.label=1;case 1:return f.trys.push([1,3,,4]),[4,a.addAuthorizationHeader(s)];case 2:return f.sent(),[3,4];case 3:return c=f.sent(),u="Failed to get AAD bearer token for the Application.",this._enableDiskRetryMode&&(u+="This batch of telemetry items will be retried. ",this._storeToDisk(e)),u+="Error:"+c.toString(),this._logWarn(u),typeof r=="function"&&r(u),[2];case 4:l="",e.forEach(function(m){var h=Ga.stringify(m);typeof h=="string"&&(l+=h+`
`)}),l.length>0&&(l=l.substring(0,l.length-1)),d=Buffer.from?Buffer.from(l):new Buffer(l),oit.gzip(d,function(m,h){var g=h;m?(p._logWarn(Ga.dumpObj(m)),g=d,s.headers["Content-Length"]=d.length.toString()):(s.headers["Content-Encoding"]="gzip",s.headers["Content-Length"]=h.length.toString()),p._logInfo(Ga.dumpObj(s)),s[sit.disableCollectionRequestOption]=!0;var v=+new Date,y=function(_){_.setEncoding("utf-8");var S="";_.on("data",function(I){S+=I}),_.on("end",function(){var I=+new Date,T=I-v;if(p._numConsecutiveFailures=0,p._isStatsbeatSender&&!p._statsbeatHasReachedIngestionAtLeastOnce&&(lit.includes(_.statusCode)?p._statsbeatHasReachedIngestionAtLeastOnce=!0:p._statsbeatFailedToIngest()),p._statsbeat&&(_.statusCode==uit||_.statusCode==cit?p._statsbeat.countThrottle(iv.StatsbeatNetworkCategory.Breeze,o,_.statusCode):p._statsbeat.countRequest(iv.StatsbeatNetworkCategory.Breeze,o,T,_.statusCode===200,_.statusCode)),p._enableDiskRetryMode){if(_.statusCode===200)p._resendTimer||(p._resendTimer=setTimeout(function(){p._resendTimer=null,p._sendFirstFileOnDisk()},p._resendInterval),p._resendTimer.unref());else if(p._isRetriable(_.statusCode))try{p._statsbeat&&p._statsbeat.countRetry(iv.StatsbeatNetworkCategory.Breeze,o,_.statusCode);var A=JSON.parse(S),B=[];A.errors&&(A.errors.forEach(function(ne){(ne.statusCode==429||ne.statusCode==500||ne.statusCode==503)&&B.push(e[ne.index])}),B.length>0&&p._storeToDisk(B))}catch{p._storeToDisk(e)}}if(_.statusCode===307||_.statusCode===308)if(p._numConsecutiveRedirects++,p._numConsecutiveRedirects<10){var j=_.headers.location?_.headers.location.toString():null;j&&(p._redirectedHost=j,p.send(e,r))}else{var F={name:"Circular Redirect",message:"Error sending telemetry because of circular redirects."};p._statsbeat&&p._statsbeat.countException(iv.StatsbeatNetworkCategory.Breeze,o,F),typeof r=="function"&&r("Error sending telemetry because of circular redirects.")}else p._numConsecutiveRedirects=0,typeof r=="function"&&r(S),p._logInfo(S),typeof p._onSuccess=="function"&&p._onSuccess(S)})},b=Ga.makeRequest(p._config,n,s,y);b.setTimeout(t.HTTP_TIMEOUT,function(){p._requestTimedOut=!0,b.abort()}),b.on("error",function(_){if(p._isStatsbeatSender&&!p._statsbeatHasReachedIngestionAtLeastOnce&&p._statsbeatFailedToIngest(),p._numConsecutiveFailures++,p._statsbeat&&p._statsbeat.countException(iv.StatsbeatNetworkCategory.Breeze,o,_),!p._enableDiskRetryMode||p._numConsecutiveFailures>0&&p._numConsecutiveFailures%t.MAX_CONNECTION_FAILURES_BEFORE_WARN===0){var S="Ingestion endpoint could not be reached. This batch of telemetry items has been lost. Use Disk Retry Caching to enable resending of failed telemetry. Error:";p._enableDiskRetryMode&&(S="Ingestion endpoint could not be reached "+p._numConsecutiveFailures+" consecutive times. There may be resulting telemetry loss. Most recent error:"),p._logWarn(S,Ga.dumpObj(_))}else{var S="Transient failure to reach ingestion endpoint. This batch of telemetry items will be retried. Error:";p._logInfo(S,Ga.dumpObj(_))}p._onErrorHelper(_),typeof r=="function"&&(_?(p._requestTimedOut&&(_.name="telemetry timeout",_.message="telemetry request timed out"),r(Ga.dumpObj(_))):r("Error sending telemetry")),p._enableDiskRetryMode&&p._storeToDisk(e)}),b.write(g),b.end()}),f.label=5;case 5:return[2]}})})},t.prototype.saveOnCrash=function(e){this._enableDiskRetryMode&&this._storeToDiskSync(Ga.stringify(e))},t.prototype._isRetriable=function(e){return e===206||e===401||e===403||e===408||e===429||e===500||e===502||e===503||e===504},t.prototype._logInfo=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this._isStatsbeatSender||dTe.info(t.TAG,e,r)},t.prototype._logWarn=function(e){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];this._isStatsbeatSender||dTe.warn(t.TAG,e,r)},t.prototype._statsbeatFailedToIngest=function(){this._shutdownStatsbeat&&(this._failedToIngestCounter++,this._failedToIngestCounter>=3&&this._shutdownStatsbeat())},t.prototype._storeToDisk=function(e){return sM(this,void 0,void 0,function(){var r,n,o,s,a,c,u;return aM(this,function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),this._logInfo("Checking existence of data storage directory: "+this._tempDir),[4,rm.confirmDirExists(this._tempDir)];case 1:return l.sent(),[3,3];case 2:return r=l.sent(),this._logWarn("Failed to create folder to put telemetry: "+Ga.dumpObj(r)),this._onErrorHelper(r),[2];case 3:return l.trys.push([3,5,,6]),[4,H2.FileAccessControl.applyACLRules(this._tempDir)];case 4:return l.sent(),[3,6];case 5:return n=l.sent(),this._logWarn("Failed to apply file access control to folder: "+Ga.dumpObj(n)),this._onErrorHelper(n),[2];case 6:return l.trys.push([6,8,,9]),[4,rm.getShallowDirectorySize(this._tempDir)];case 7:return o=l.sent(),o>this._maxBytesOnDisk?(this._logWarn("Not saving data due to max size limit being met. Directory size in bytes is: "+o),[2]):[3,9];case 8:return s=l.sent(),this._logWarn("Failed to read directory for retriable telemetry: "+Ga.dumpObj(s)),this._onErrorHelper(s),[2];case 9:return l.trys.push([9,11,,12]),a=new Date().getTime()+".ai.json",c=mb.join(this._tempDir,a),this._logInfo("saving data to disk at: "+c),[4,rm.writeFileAsync(c,Ga.stringify(e),{mode:384})];case 10:return l.sent(),[3,12];case 11:return u=l.sent(),this._logWarn("Failed to persist telemetry to disk: "+Ga.dumpObj(u)),this._onErrorHelper(u),[2];case 12:return[2]}})})},t.prototype._storeToDiskSync=function(e){try{this._logInfo("Checking existence of data storage directory: "+this._tempDir),yX.existsSync(this._tempDir)||yX.mkdirSync(this._tempDir),H2.FileAccessControl.applyACLRulesSync(this._tempDir);var r=rm.getShallowDirectorySizeSync(this._tempDir);if(r>this._maxBytesOnDisk){this._logInfo("Not saving data due to max size limit being met. Directory size in bytes is: "+r);return}var n=new Date().getTime()+".ai.json",o=mb.join(this._tempDir,n);this._logInfo("saving data before crash to disk at: "+o),yX.writeFileSync(o,e,{mode:384})}catch(s){this._logWarn("Error while saving data to disk: "+Ga.dumpObj(s)),this._onErrorHelper(s)}},t.prototype._sendFirstFileOnDisk=function(){return sM(this,void 0,void 0,function(){var e,r,n,o,s,a;return aM(this,function(c){switch(c.label){case 0:return c.trys.push([0,6,,7]),[4,rm.readdirAsync(this._tempDir)];case 1:return e=c.sent(),e=e.filter(function(u){return mb.basename(u).indexOf(".ai.json")>-1}),e.length>0?(r=e[0],n=mb.join(this._tempDir,r),[4,rm.readFileAsync(n)]):[3,5];case 2:return o=c.sent(),[4,rm.unlinkAsync(n)];case 3:return c.sent(),s=JSON.parse(o.toString()),[4,this.send(s)];case 4:c.sent(),c.label=5;case 5:return[3,7];case 6:return a=c.sent(),this._onErrorHelper(a),[3,7];case 7:return[2]}})})},t.prototype._onErrorHelper=function(e){typeof this._onError=="function"&&this._onError(e)},t.prototype._fileCleanupTask=function(){return sM(this,void 0,void 0,function(){var e,r,n,o,s,a,c=this;return aM(this,function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),[4,rm.readdirAsync(this._tempDir)];case 1:if(e=u.sent(),e=e.filter(function(l){return mb.basename(l).indexOf(".ai.json")>-1}),!(e.length>0))return[3,5];r=0,u.label=2;case 2:return r<e.length?(n=new Date(parseInt(e[r].split(".ai.json")[0])),o=new Date(+new Date-t.FILE_RETEMPTION_PERIOD)>n,o?(s=mb.join(this._tempDir,e[r]),[4,rm.unlinkAsync(s).catch(function(l){c._onErrorHelper(l)})]):[3,4]):[3,5];case 3:u.sent(),u.label=4;case 4:return r++,[3,2];case 5:return[3,7];case 6:return a=u.sent(),a.code!="ENOENT"&&this._onErrorHelper(a),[3,7];case 7:return[2]}})})},t.TAG="Sender",t.WAIT_BETWEEN_RESEND=60*1e3,t.MAX_BYTES_ON_DISK=50*1024*1024,t.MAX_CONNECTION_FAILURES_BEFORE_WARN=5,t.CLEANUP_TIMEOUT=60*60*1e3,t.FILE_RETEMPTION_PERIOD=7*24*60*60*1e3,t.TEMPDIR_PREFIX="appInsights-node",t.HTTP_TIMEOUT=2e4,t}();pTe.exports=dit});var mTe=M(cM=>{"use strict";Object.defineProperty(cM,"__esModule",{value:!0});cM.AzureVirtualMachine=void 0;var fTe=Hn(),pit=us(),fit=_C(),mit="http://169.254.169.254/metadata/instance/compute",hit="api-version=2017-12-01",git="format=json",vit="UNREACH",yit=function(){function t(){}return t.getAzureComputeMetadata=function(e,r){var n,o=this,s={},a=mit+"?"+hit+"&"+git,c=(n={method:"GET"},n[fit.disableCollectionRequestOption]=!0,n.headers={Metadata:"True"},n),u=pit.makeRequest(e,a,c,function(l){if(l.statusCode===200){s.isVM=!0;var d="";l.on("data",function(p){d+=p}),l.on("end",function(){try{var p=JSON.parse(d);s.id=p.vmId||"",s.subscriptionId=p.subscriptionId||"",s.osType=p.osType||""}catch(f){fTe.info(t.TAG,f)}r(s)})}else r(s)},!1,!1);u&&(setTimeout(function(){o._requestTimedOut=!0,u.abort()},t.HTTP_TIMEOUT),u.on("error",function(l){o._requestTimedOut&&l&&(l.name="telemetry timeout",l.message="telemetry request timed out"),l&&l.message&&l.message.indexOf(vit)>-1?s.isVM=!1:fTe.info(t.TAG,l),r(s)}),u.end())},t.HTTP_TIMEOUT=2500,t.TAG="AzureVirtualMachine",t}();cM.AzureVirtualMachine=yit});var hTe=M(uM=>{"use strict";Object.defineProperty(uM,"__esModule",{value:!0});uM.NetworkStatsbeat=void 0;var bit=function(){function t(e,r){this.endpoint=e,this.host=r,this.totalRequestCount=0,this.totalSuccesfulRequestCount=0,this.totalFailedRequestCount=[],this.retryCount=[],this.exceptionCount=[],this.throttleCount=[],this.intervalRequestExecutionTime=0,this.lastIntervalRequestExecutionTime=0,this.lastTime=+new Date,this.lastRequestCount=0}return t}();uM.NetworkStatsbeat=bit});var _Te=M((hb,bTe)=>{"use strict";var cp=hb&&hb.__assign||function(){return cp=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},cp.apply(this,arguments)},_X=hb&&hb.__awaiter||function(t,e,r,n){function o(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(d){try{l(n.next(d))}catch(p){a(p)}}function u(d){try{l(n.throw(d))}catch(p){a(p)}}function l(d){d.done?s(d.value):o(d.value).then(c,u)}l((n=n.apply(t,e||[])).next())})},xX=hb&&hb.__generator||function(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,o,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(l){return function(d){return u([l,d])}}function u(l){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(s=l[0]&2?o.return:l[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,l[1])).done)return s;switch(o=0,s&&(l=[l[0]&2,s.value]),l[0]){case 0:case 1:s=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,o=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(l[0]===6||l[0]===2)){r=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){r.label=l[1];break}if(l[0]===6&&r.label<s[1]){r.label=s[1],s=l;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(l);break}s[2]&&r.ops.pop(),r.trys.pop();continue}l=e.call(t,r)}catch(d){l=[6,d],o=0}finally{n=s=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}},_it=require("os"),xit=vX(),gTe=Hn(),Sit=bX(),Gn=ri(),Iit=Ns(),Cit=mTe(),Eit=$Y(),vTe=fC(),Tit=hTe(),yTe=us(),wit="node",Rit=function(){function t(e,r){this._attach=Gn.StatsbeatAttach.sdk,this._feature=Gn.StatsbeatFeature.NONE,this._instrumentation=Gn.StatsbeatInstrumentation.NONE,this._isInitialized=!1,this._statbeatMetrics=[],this._networkStatsbeatCollection=[],this._config=e,this._context=r||new vTe;var n=this._getConnectionString(e);this._statsbeatConfig=new Eit(n),this._statsbeatConfig.samplingPercentage=100,this._sender=new Sit(this._statsbeatConfig,null,null,null,null,!0,this._shutdownStatsbeat.bind(this))}return t.prototype.enable=function(e){var r=this;this._isEnabled=e,this._isEnabled&&!this._isInitialized&&(this._getCustomProperties(),this._isInitialized=!0),e?(this._handle||(this._handle=setInterval(function(){r.trackShortIntervalStatsbeats()},t.STATS_COLLECTION_SHORT_INTERVAL),this._handle.unref()),this._longHandle||(this.trackLongIntervalStatsbeats(),this._longHandle=setInterval(function(){r.trackLongIntervalStatsbeats()},t.STATS_COLLECTION_LONG_INTERVAL),this._longHandle.unref())):(this._handle&&(clearInterval(this._handle),this._handle=null),this._longHandle&&(clearInterval(this._longHandle),this._longHandle=null))},t.prototype.isInitialized=function(){return this._isInitialized},t.prototype.isEnabled=function(){return this._isEnabled},t.prototype.setCodelessAttach=function(){this._attach=Gn.StatsbeatAttach.codeless},t.prototype.addFeature=function(e){this._feature|=e},t.prototype.removeFeature=function(e){this._feature&=~e},t.prototype.addInstrumentation=function(e){this._instrumentation|=e},t.prototype.removeInstrumentation=function(e){this._instrumentation&=~e},t.prototype.countRequest=function(e,r,n,o,s){if(this.isEnabled()){var a=this._getNetworkStatsbeatCounter(e,r);if(a.totalRequestCount++,a.intervalRequestExecutionTime+=n,o===!1){if(!s)return;var c=a.totalFailedRequestCount.find(function(u){return s===u.statusCode});c?c.count++:a.totalFailedRequestCount.push({statusCode:s,count:1})}else a.totalSuccesfulRequestCount++}},t.prototype.countException=function(e,r,n){if(this.isEnabled()){var o=this._getNetworkStatsbeatCounter(e,r),s=o.exceptionCount.find(function(a){return n.name===a.exceptionType});s?s.count++:o.exceptionCount.push({exceptionType:n.name,count:1})}},t.prototype.countThrottle=function(e,r,n){if(this.isEnabled()){var o=this._getNetworkStatsbeatCounter(e,r),s=o.throttleCount.find(function(a){return n===a.statusCode});s?s.count++:o.throttleCount.push({statusCode:n,count:1})}},t.prototype.countRetry=function(e,r,n){if(this.isEnabled()){var o=this._getNetworkStatsbeatCounter(e,r),s=o.retryCount.find(function(a){return n===a.statusCode});s?s.count++:o.retryCount.push({statusCode:n,count:1})}},t.prototype.trackShortIntervalStatsbeats=function(){return _X(this,void 0,void 0,function(){var e,r;return xX(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this._getResourceProvider()];case 1:return n.sent(),e={os:this._os,rp:this._resourceProvider,cikey:this._cikey,runtimeVersion:this._runtimeVersion,language:this._language,version:this._sdkVersion,attach:this._attach},this._trackRequestDuration(e),this._trackRequestsCount(e),[4,this._sendStatsbeats()];case 2:return n.sent(),[3,4];case 3:return r=n.sent(),gTe.info(t.TAG,"Failed to send Statsbeat metrics: "+yTe.dumpObj(r)),[3,4];case 4:return[2]}})})},t.prototype.trackLongIntervalStatsbeats=function(){return _X(this,void 0,void 0,function(){var e,r,n,o,s;return xX(this,function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),[4,this._getResourceProvider()];case 1:return a.sent(),e={os:this._os,rp:this._resourceProvider,cikey:this._cikey,runtimeVersion:this._runtimeVersion,language:this._language,version:this._sdkVersion,attach:this._attach},r=Object.assign({rpId:this._resourceIdentifier},e),this._statbeatMetrics.push({name:Gn.StatsbeatCounter.ATTACH,value:1,properties:r}),this._instrumentation!=Gn.StatsbeatInstrumentation.NONE&&(n=Object.assign({feature:this._instrumentation,type:Gn.StatsbeatFeatureType.Instrumentation},e),this._statbeatMetrics.push({name:Gn.StatsbeatCounter.FEATURE,value:1,properties:n})),this._feature!=Gn.StatsbeatFeature.NONE&&(o=Object.assign({feature:this._feature,type:Gn.StatsbeatFeatureType.Feature},e),this._statbeatMetrics.push({name:Gn.StatsbeatCounter.FEATURE,value:1,properties:o})),[4,this._sendStatsbeats()];case 2:return a.sent(),[3,4];case 3:return s=a.sent(),gTe.info(t.TAG,"Failed to send Statsbeat metrics: "+yTe.dumpObj(s)),[3,4];case 4:return[2]}})})},t.prototype._getNetworkStatsbeatCounter=function(e,r){for(var n=this._getShortHost(r),o=0;o<this._networkStatsbeatCollection.length;o++)if(e===this._networkStatsbeatCollection[o].endpoint&&n===this._networkStatsbeatCollection[o].host)return this._networkStatsbeatCollection[o];var s=new Tit.NetworkStatsbeat(e,n);return this._networkStatsbeatCollection.push(s),s},t.prototype._trackRequestDuration=function(e){for(var r=0;r<this._networkStatsbeatCollection.length;r++){var n=this._networkStatsbeatCollection[r];n.time=+new Date;var o=n.totalRequestCount-n.lastRequestCount||0,s=n.intervalRequestExecutionTime-n.lastIntervalRequestExecutionTime,a=s>0&&s/o||0;if(n.lastIntervalRequestExecutionTime=n.intervalRequestExecutionTime,o>0){var c=Object.assign({endpoint:this._networkStatsbeatCollection[r].endpoint,host:this._networkStatsbeatCollection[r].host},e);this._statbeatMetrics.push({name:Gn.StatsbeatCounter.REQUEST_DURATION,value:a,properties:c})}n.lastRequestCount=n.totalRequestCount,n.lastTime=n.time}},t.prototype._getShortHost=function(e){var r=e;try{var n=new RegExp(/^https?:\/\/(?:www\.)?([^\/.-]+)/),o=n.exec(e);o!=null&&o.length>1&&(r=o[1]),r=r.replace(".in.applicationinsights.azure.com","")}catch{}return r},t.prototype._trackRequestsCount=function(e){for(var r=this,n=function(c){s=o._networkStatsbeatCollection[c];var u=Object.assign({endpoint:s.endpoint,host:s.host},e);s.totalSuccesfulRequestCount>0&&(o._statbeatMetrics.push({name:Gn.StatsbeatCounter.REQUEST_SUCCESS,value:s.totalSuccesfulRequestCount,properties:u}),s.totalSuccesfulRequestCount=0),s.totalFailedRequestCount.length>0&&(s.totalFailedRequestCount.forEach(function(l){u=Object.assign(cp(cp({},u),{statusCode:l.statusCode})),r._statbeatMetrics.push({name:Gn.StatsbeatCounter.REQUEST_FAILURE,value:l.count,properties:u})}),s.totalFailedRequestCount=[]),s.retryCount.length>0&&(s.retryCount.forEach(function(l){u=Object.assign(cp(cp({},u),{statusCode:l.statusCode})),r._statbeatMetrics.push({name:Gn.StatsbeatCounter.RETRY_COUNT,value:l.count,properties:u})}),s.retryCount=[]),s.throttleCount.length>0&&(s.throttleCount.forEach(function(l){u=Object.assign(cp(cp({},u),{statusCode:l.statusCode})),r._statbeatMetrics.push({name:Gn.StatsbeatCounter.THROTTLE_COUNT,value:l.count,properties:u})}),s.throttleCount=[]),s.exceptionCount.length>0&&(s.exceptionCount.forEach(function(l){u=Object.assign(cp(cp({},u),{exceptionType:l.exceptionType})),r._statbeatMetrics.push({name:Gn.StatsbeatCounter.EXCEPTION_COUNT,value:l.count,properties:u})}),s.exceptionCount=[])},o=this,s,a=0;a<this._networkStatsbeatCollection.length;a++)n(a)},t.prototype._sendStatsbeats=function(){return _X(this,void 0,void 0,function(){var e,r,n,o;return xX(this,function(s){switch(s.label){case 0:for(e=[],r=0;r<this._statbeatMetrics.length;r++)n={name:this._statbeatMetrics[r].name,value:this._statbeatMetrics[r].value,properties:this._statbeatMetrics[r].properties},o=xit.createEnvelope(n,Iit.TelemetryType.Metric,null,this._context,this._statsbeatConfig),o.name=Gn.StatsbeatTelemetryName,e.push(o);return this._statbeatMetrics=[],[4,this._sender.send(e)];case 1:return s.sent(),[2]}})})},t.prototype._getCustomProperties=function(){this._language=wit,this._cikey=this._config.instrumentationKey,this._sdkVersion=vTe.sdkVersion,this._os=_it.type(),this._runtimeVersion=process.version},t.prototype._getResourceProvider=function(){var e=this;return new Promise(function(r,n){var o=!1;e._resourceProvider=Gn.StatsbeatResourceProvider.unknown,e._resourceIdentifier=Gn.StatsbeatResourceProvider.unknown,process.env.AKS_ARM_NAMESPACE_ID?(e._resourceProvider=Gn.StatsbeatResourceProvider.aks,e._resourceIdentifier=process.env.AKS_ARM_NAMESPACE_ID):process.env.WEBSITE_SITE_NAME?(e._resourceProvider=Gn.StatsbeatResourceProvider.appsvc,e._resourceIdentifier=process.env.WEBSITE_SITE_NAME,process.env.WEBSITE_HOME_STAMPNAME&&(e._resourceIdentifier+="/"+process.env.WEBSITE_HOME_STAMPNAME)):process.env.FUNCTIONS_WORKER_RUNTIME?(e._resourceProvider=Gn.StatsbeatResourceProvider.functions,process.env.WEBSITE_HOSTNAME&&(e._resourceIdentifier=process.env.WEBSITE_HOSTNAME)):e._config&&(e._isVM===void 0||e._isVM==!0?(o=!0,Cit.AzureVirtualMachine.getAzureComputeMetadata(e._config,function(s){e._isVM=s.isVM,e._isVM&&(e._resourceProvider=Gn.StatsbeatResourceProvider.vm,e._resourceIdentifier=s.id+"/"+s.subscriptionId,s.osType&&(e._os=s.osType)),r()})):e._resourceProvider=Gn.StatsbeatResourceProvider.unknown),o||r()})},t.prototype._shutdownStatsbeat=function(){this.enable(!1)},t.prototype._getConnectionString=function(e){for(var r=e.endpointUrl,n=["westeurope","northeurope","francecentral","francesouth","germanywestcentral","norwayeast","norwaywest","swedencentral","switzerlandnorth","switzerlandwest","uksouth","ukwest"],o=0;o<n.length;o++)if(r.indexOf(n[o])>-1)return t.EU_CONNECTION_STRING;return t.NON_EU_CONNECTION_STRING},t.NON_EU_CONNECTION_STRING="InstrumentationKey=c4a29126-a7cb-47e5-b348-11414998b11e;IngestionEndpoint=https://westus-0.in.applicationinsights.azure.com",t.EU_CONNECTION_STRING="InstrumentationKey=7dc56bab-3c0c-4e9f-9ebb-d1acadee8d0f;IngestionEndpoint=https://westeurope-5.in.applicationinsights.azure.com",t.STATS_COLLECTION_SHORT_INTERVAL=9e5,t.STATS_COLLECTION_LONG_INTERVAL=864e5,t.TAG="Statsbeat",t}();bTe.exports=Rit});var ITe=M((oSr,STe)=>{"use strict";var kit=require("url"),Pit=$Y(),Ait=XEe(),Dit=fC(),nm=Ns(),Nit=ZEe(),SX=sTe(),xTe=Vg(),Lit=_Te(),Oit=bX(),IX=us(),lM=Hn(),Mit=vX(),Fit=function(){function t(e){this._telemetryProcessors=[];var r=new Pit(e);if(this.config=r,!this.config.instrumentationKey||this.config.instrumentationKey=="")throw new Error("Instrumentation key not found, please provide a connection string before starting Application Insights SDK.");this.context=new Dit,this.commonProperties={},this.authorizationHandler=null,this.config.disableStatsbeat||(this._statsbeat=new Lit(this.config,this.context),this._statsbeat.enable(!0));var n=new Oit(this.config,this.getAuthorizationHandler,null,null,this._statsbeat);this.channel=new Nit(function(){return r.disableAppInsights},function(){return r.maxBatchSize},function(){return r.maxBatchIntervalMs},n)}return t.prototype.trackAvailability=function(e){this.track(e,nm.TelemetryType.Availability)},t.prototype.trackPageView=function(e){this.track(e,nm.TelemetryType.PageView)},t.prototype.trackTrace=function(e){this.track(e,nm.TelemetryType.Trace)},t.prototype.trackMetric=function(e){this.track(e,nm.TelemetryType.Metric)},t.prototype.trackException=function(e){e&&e.exception&&!IX.isError(e.exception)&&(e.exception=new Error(e.exception.toString())),this.track(e,nm.TelemetryType.Exception)},t.prototype.trackEvent=function(e){this.track(e,nm.TelemetryType.Event)},t.prototype.trackRequest=function(e){this.track(e,nm.TelemetryType.Request)},t.prototype.trackDependency=function(e){if(e&&!e.target&&e.data)try{e.target=new kit.URL(e.data).host}catch(r){e.target=null,lM.warn(t.TAG,"The URL object is failed to create.",r)}this.track(e,nm.TelemetryType.Dependency)},t.prototype.flush=function(e){this.channel.triggerSend(e?!!e.isAppCrashing:!1,e?e.callback:void 0)},t.prototype.track=function(e,r){if(e&&nm.telemetryTypeToBaseType(r)){var n=Mit.createEnvelope(e,r,this.commonProperties,this.context,this.config);e.time&&(n.time=e.time.toISOString());var o=this.runTelemetryProcessors(n,e.contextObjects);o=o&&SX.samplingTelemetryProcessor(n,{correlationContext:xTe.CorrelationContextManager.getCurrentContext()}),SX.preAggregatedMetricsTelemetryProcessor(n,this.context),o&&(SX.performanceMetricsTelemetryProcessor(n,this.quickPulseClient),this.channel.send(n))}else lM.warn(t.TAG,"track() requires telemetry object and telemetryType to be specified.")},t.prototype.setAutoPopulateAzureProperties=function(e){},t.prototype.getAuthorizationHandler=function(e){return e&&e.aadTokenCredential?(this.authorizationHandler||(lM.info(t.TAG,"Adding authorization handler"),this.authorizationHandler=new Ait(e.aadTokenCredential,e.aadAudience)),this.authorizationHandler):null},t.prototype.addTelemetryProcessor=function(e){this._telemetryProcessors.push(e)},t.prototype.clearTelemetryProcessors=function(){this._telemetryProcessors=[]},t.prototype.runTelemetryProcessors=function(e,r){var n=!0,o=this._telemetryProcessors.length;if(o===0)return n;r=r||{},r.correlationContext=xTe.CorrelationContextManager.getCurrentContext();for(var s=0;s<o;++s)try{var a=this._telemetryProcessors[s];if(a&&a.apply(null,[e,r])===!1){n=!1;break}}catch(c){n=!0,lM.warn(t.TAG,"One of telemetry processors failed, telemetry item will be sent.",c,e)}return n&&(e&&e.tags&&(e.tags=IX.validateStringMap(e.tags)),e&&e.data&&e.data.baseData&&e.data.baseData.properties&&(e.data.baseData.properties=IX.validateStringMap(e.data.baseData.properties))),n},t.prototype.getStatsbeat=function(){return this._statsbeat},t.TAG="TelemetryClient",t}();STe.exports=Fit});var TTe=M((CX,ETe)=>{"use strict";var Uit=CX&&CX.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,o){n.__proto__=o}||function(n,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(n[s]=o[s])},t(e,r)};return function(e,r){t(e,r);function n(){this.constructor=e}e.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}(),Bit=ITe(),CTe=BY(),qit=_C(),dM=Hn(),Hit=function(t){Uit(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.trackNodeHttpRequestSync=function(r){r&&r.request&&r.response&&r.duration?CTe.trackRequestSync(this,r):dM.warn("trackNodeHttpRequestSync requires NodeHttpRequestTelemetry object with request, response and duration specified.")},e.prototype.trackNodeHttpRequest=function(r){(r.duration||r.error)&&dM.warn("trackNodeHttpRequest will ignore supplied duration and error parameters. These values are collected from the request and response objects."),r&&r.request&&r.response?CTe.trackRequest(this,r):dM.warn("trackNodeHttpRequest requires NodeHttpRequestTelemetry object with request and response specified.")},e.prototype.trackNodeHttpDependency=function(r){r&&r.request?qit.trackRequest(this,r):dM.warn("trackNodeHttpDependency requires NodeHttpDependencyTelemetry object with request specified.")},e}(Bit);ETe.exports=Hit});var RTe=M(wTe=>{"use strict";Object.defineProperty(wTe,"__esModule",{value:!0})});var NTe=M(se=>{"use strict";Object.defineProperty(se,"__esModule",{value:!0});se.dispose=se.Configuration=se.wrapWithCorrelationContext=se.startOperation=se.getCorrelationContext=se.start=se.setup=se.liveMetricsClient=se.defaultClient=se.DistributedTracingModes=void 0;var EX=Vg(),jit=ySe(),Vit=_Se(),TX=o8(),Git=EY(),zit=RSe(),$it=qSe(),Wit=_C(),Kit=BY(),kTe=Yy(),V2=Hn(),PTe=bIe(),wX=_Ie(),Yit=IIe();se.TelemetryClient=TTe();se.Contracts=Ns();se.azureFunctionsTypes=RTe();var ATe;(function(t){t[t.AI=0]="AI",t[t.AI_AND_W3C=1]="AI_AND_W3C"})(ATe=se.DistributedTracingModes||(se.DistributedTracingModes={}));var G2,z2,$2,W2,K2,qC,HC,gb,Y2,Q2,Lc=!1,pM;function Qit(t){return se.defaultClient?V2.info("The default client is already setup"):(se.defaultClient=new se.TelemetryClient(t),G2=new jit(se.defaultClient),z2=new Vit(se.defaultClient),$2=new TX(se.defaultClient),W2=new Git(se.defaultClient),K2=new zit(se.defaultClient),qC=new $it(se.defaultClient),gb=new Kit(se.defaultClient),Y2=new Wit(se.defaultClient),HC||(HC=new wX.AutoCollectNativePerformance(se.defaultClient)),Q2=new Yit.AzureFunctionsHook(se.defaultClient)),RX}se.setup=Qit;function Xit(){se.defaultClient&&(se.defaultClient.config.enableAutoCollectExternalLoggers==null&&(se.defaultClient.config.enableAutoCollectExternalLoggers=!0),se.defaultClient.config.enableAutoCollectConsole==null&&(se.defaultClient.config.enableAutoCollectConsole=!1),se.defaultClient.config.enableAutoCollectExceptions==null&&(se.defaultClient.config.enableAutoCollectExceptions=!0),se.defaultClient.config.enableAutoCollectPerformance==null&&(se.defaultClient.config.enableAutoCollectPerformance=!0),se.defaultClient.config.enableAutoCollectPreAggregatedMetrics==null&&(se.defaultClient.config.enableAutoCollectPreAggregatedMetrics=!0),se.defaultClient.config.enableAutoCollectHeartbeat==null&&(se.defaultClient.config.enableAutoCollectHeartbeat=!0),se.defaultClient.config.enableAutoCollectRequests==null&&(se.defaultClient.config.enableAutoCollectRequests=!0),se.defaultClient.config.enableAutoCollectDependencies==null&&(se.defaultClient.config.enableAutoCollectDependencies=!0),se.defaultClient.config.enableUseDiskRetryCaching==null&&(se.defaultClient.config.enableUseDiskRetryCaching=!0),se.defaultClient.config.enableAutoDependencyCorrelation==null&&(se.defaultClient.config.enableAutoDependencyCorrelation=!0),se.defaultClient.config.enableSendLiveMetrics==null&&(se.defaultClient.config.enableSendLiveMetrics=!1),se.defaultClient.config.enableAutoCollectExtendedMetrics==null&&(se.defaultClient.config.enableAutoCollectExtendedMetrics=!0),se.defaultClient.config.enableWebInstrumentation==null&&(se.defaultClient.config.enableWebInstrumentation=!1),se.defaultClient.config.enableAutoCollectIncomingRequestAzureFunctions==null&&(se.defaultClient.config.enableAutoCollectIncomingRequestAzureFunctions=!1))}function DTe(){if(se.defaultClient){Lc=!0,Xit(),G2.enable(se.defaultClient.config.enableAutoCollectExternalLoggers,se.defaultClient.config.enableAutoCollectConsole),z2.enable(se.defaultClient.config.enableAutoCollectExceptions),$2.enable(se.defaultClient.config.enableAutoCollectPerformance),W2.enable(se.defaultClient.config.enableAutoCollectPreAggregatedMetrics),K2.enable(se.defaultClient.config.enableAutoCollectHeartbeat),gb.useAutoCorrelation(se.defaultClient.config.enableAutoDependencyCorrelation,se.defaultClient.config.enableUseAsyncHooks),gb.enable(se.defaultClient.config.enableAutoCollectRequests),Y2.enable(se.defaultClient.config.enableAutoCollectDependencies),qC.enable(se.defaultClient.config.enableWebInstrumentation,se.defaultClient.config.webInstrumentationConnectionString),se.defaultClient.config.enableSendLiveMetrics&&(se.liveMetricsClient||(se.liveMetricsClient=new PTe(se.defaultClient.config,se.defaultClient.context,se.defaultClient.getAuthorizationHandler),pM=new TX(se.liveMetricsClient,1e3,!0),se.liveMetricsClient.addCollector(pM),se.defaultClient.quickPulseClient=se.liveMetricsClient),se.liveMetricsClient.enable(se.defaultClient.config.enableSendLiveMetrics)),Q2.enable(se.defaultClient.config.enableAutoCollectIncomingRequestAzureFunctions);var t=wX.AutoCollectNativePerformance.parseEnabled(se.defaultClient.config.enableAutoCollectExtendedMetrics,se.defaultClient.config);HC.enable(se.defaultClient.config.enableAutoCollectExtendedMetrics,t.disabledMetrics),se.defaultClient&&se.defaultClient.channel&&se.defaultClient.channel.setUseDiskRetryCaching(se.defaultClient.config.enableUseDiskRetryCaching,se.defaultClient.config.enableResendInterval,se.defaultClient.config.enableMaxBytesOnDisk)}else V2.warn("Start cannot be called before setup");return RX}se.start=DTe;function Jit(){return EX.CorrelationContextManager.getCurrentContext()}se.getCorrelationContext=Jit;function Zit(t,e){return EX.CorrelationContextManager.startOperation(t,e)}se.startOperation=Zit;function eot(t,e){return EX.CorrelationContextManager.wrapCallback(t,e)}se.wrapWithCorrelationContext=eot;var RX=function(){function t(){}return t.setDistributedTracingMode=function(e){return kTe.w3cEnabled=e===ATe.AI_AND_W3C,t},t.setAutoCollectConsole=function(e,r){return r===void 0&&(r=!1),se.defaultClient&&(se.defaultClient.config.enableAutoCollectExternalLoggers=e,se.defaultClient.config.enableAutoCollectConsole=r,Lc&&G2.enable(e,r)),t},t.setAutoCollectExceptions=function(e){return se.defaultClient&&(se.defaultClient.config.enableAutoCollectExceptions=e,Lc&&z2.enable(e)),t},t.setAutoCollectPerformance=function(e,r){if(r===void 0&&(r=!0),se.defaultClient){se.defaultClient.config.enableAutoCollectPerformance=e;var n=wX.AutoCollectNativePerformance.parseEnabled(r,se.defaultClient.config);se.defaultClient.config.enableAutoCollectExtendedMetrics=n.isEnabled,Lc&&($2.enable(e),HC.enable(se.defaultClient.config.enableAutoCollectExtendedMetrics,n.disabledMetrics))}return t},t.setAutoCollectPreAggregatedMetrics=function(e){return se.defaultClient&&(se.defaultClient.config.enableAutoCollectPreAggregatedMetrics=e,Lc&&W2.enable(e)),t},t.setAutoCollectHeartbeat=function(e){return se.defaultClient&&(se.defaultClient.config.enableAutoCollectHeartbeat=e,Lc&&K2.enable(e)),t},t.enableAutoWebSnippetInjection=function(e,r){return se.defaultClient&&(se.defaultClient.config.enableWebInstrumentation=e,se.defaultClient.config.webInstrumentationConnectionString=r,Lc&&qC.enable(se.defaultClient.config.enableAutoWebSnippetInjection,se.defaultClient.config.webSnippetConnectionString)),t},t.enableWebInstrumentation=function(e,r){return se.defaultClient&&(se.defaultClient.config.enableWebInstrumentation=e,se.defaultClient.config.webInstrumentationConnectionString=r,Lc&&qC.enable(se.defaultClient.config.enableWebInstrumentation,se.defaultClient.config.webInstrumentationConnectionString)),t},t.setAutoCollectRequests=function(e){return se.defaultClient&&(se.defaultClient.config.enableAutoCollectRequests=e,Lc&&gb.enable(e)),t},t.setAutoCollectDependencies=function(e){return se.defaultClient&&(se.defaultClient.config.enableAutoCollectDependencies=e,Lc&&Y2.enable(e)),t},t.setAutoDependencyCorrelation=function(e,r){return se.defaultClient&&(se.defaultClient.config.enableAutoDependencyCorrelation=e,se.defaultClient.config.enableUseAsyncHooks=r,Lc&&gb.useAutoCorrelation(e,r)),t},t.setUseDiskRetryCaching=function(e,r,n){return se.defaultClient&&(se.defaultClient.config.enableUseDiskRetryCaching=e,se.defaultClient.config.enableResendInterval=r,se.defaultClient.config.enableMaxBytesOnDisk=n,se.defaultClient.channel&&se.defaultClient.channel.setUseDiskRetryCaching(se.defaultClient.config.enableUseDiskRetryCaching,se.defaultClient.config.enableResendInterval,se.defaultClient.config.enableMaxBytesOnDisk)),t},t.setInternalLogging=function(e,r){return e===void 0&&(e=!1),r===void 0&&(r=!0),V2.enableDebug=e,V2.disableWarnings=!r,t},t.setAutoCollectIncomingRequestAzureFunctions=function(e){return se.defaultClient&&(se.defaultClient.config.enableAutoCollectIncomingRequestAzureFunctions=e,Lc&&Q2.enable(e)),t},t.setSendLiveMetrics=function(e){return e===void 0&&(e=!1),se.defaultClient?(!se.liveMetricsClient&&e?(se.liveMetricsClient=new PTe(se.defaultClient.config,se.defaultClient.context,se.defaultClient.getAuthorizationHandler),pM=new TX(se.liveMetricsClient,1e3,!0),se.liveMetricsClient.addCollector(pM),se.defaultClient.quickPulseClient=se.liveMetricsClient):se.liveMetricsClient&&se.liveMetricsClient.enable(e),se.defaultClient.config.enableSendLiveMetrics=e,t):(V2.warn("Live metrics client cannot be setup without the default client"),t)},t.start=DTe,t}();se.Configuration=RX;function tot(){kTe.w3cEnabled=!0,se.defaultClient=null,Lc=!1,G2&&G2.dispose(),z2&&z2.dispose(),$2&&$2.dispose(),W2&&W2.dispose(),K2&&K2.dispose(),qC&&qC.dispose(),HC&&HC.dispose(),gb&&gb.dispose(),Y2&&Y2.dispose(),se.liveMetricsClient&&(se.liveMetricsClient.enable(!1),se.liveMetricsClient=void 0),Q2&&Q2.dispose()}se.dispose=tot});var PX=M(sv=>{"use strict";Object.defineProperty(sv,"__esModule",{value:!0});sv.TargetPopulation=sv.Filters=sv.VSCodeFilterProvider=void 0;var mM=require("vscode"),kX=class t{constructor(e,r,n){this.extensionName=e,this.extensionVersion=r,this.targetPopulation=n}static trimVersionSuffix(e){let r=/\-[a-zA-Z0-9]+$/;return e.split(r)[0]}getFilterValue(e){switch(e){case up.ApplicationVersion:return t.trimVersionSuffix(mM.version);case up.Build:return mM.env.appName;case up.ClientId:return mM.env.machineId;case up.ExtensionName:return this.extensionName;case up.ExtensionVersion:return t.trimVersionSuffix(this.extensionVersion);case up.Language:return mM.env.language;case up.TargetPopulation:return this.targetPopulation;default:return""}}getFilters(){let e=new Map,r=Object.values(up);for(let n of r)e.set(n,this.getFilterValue(n));return e}};sv.VSCodeFilterProvider=kX;var up;(function(t){t.Market="X-MSEdge-Market",t.CorpNet="X-FD-Corpnet",t.ApplicationVersion="X-VSCode-AppVersion",t.Build="X-VSCode-Build",t.ClientId="X-MSEdge-ClientId",t.ExtensionName="X-VSCode-ExtensionName",t.ExtensionVersion="X-VSCode-ExtensionVersion",t.Language="X-VSCode-Language",t.TargetPopulation="X-VSCode-TargetPopulation"})(up||(sv.Filters=up={}));var UTe;(function(t){t.Team="team",t.Internal="internal",t.Insiders="insider",t.Public="public"})(UTe||(sv.TargetPopulation=UTe={}))});var BTe=M(hM=>{"use strict";Object.defineProperty(hM,"__esModule",{value:!0});hM.BaseFeatureProvider=void 0;var AX=class{constructor(e){this.telemetry=e,this.isFetching=!1}async getFeatures(){if(this.isFetching&&this.fetchPromise)return this.fetchPromise;this.fetchPromise=this.fetch();let e=await this.fetchPromise;return this.isFetching=!1,this.fetchPromise=void 0,e}};hM.BaseFeatureProvider=AX});var qTe=M(gM=>{"use strict";Object.defineProperty(gM,"__esModule",{value:!0});gM.FilteredFeatureProvider=void 0;var iot=BTe(),DX=class extends iot.BaseFeatureProvider{constructor(e,r){super(e),this.telemetry=e,this.filterProviders=r,this.cachedTelemetryEvents=[]}getFilters(){let e=new Map;for(let r of this.filterProviders){let n=r.getFilters();for(let o of n.keys()){let s=n.get(o);e.set(o,s)}}return e}PostEventToTelemetry(e){if(this.cachedTelemetryEvents.includes(e))return;let r=JSON.stringify(e);this.telemetry.postEvent("report-headers",new Map([["ABExp.headers",r]])),this.cachedTelemetryEvents.push(e)}};gM.FilteredFeatureProvider=DX});var HTe=M(av=>{"use strict";Object.defineProperty(av,"__esModule",{value:!0});av.TasApiFeatureProvider=av.TASAPI_FETCHERROR_EVENTNAME=void 0;var oot=qTe();av.TASAPI_FETCHERROR_EVENTNAME="call-tas-error";var NX="ErrorType",LX=class extends oot.FilteredFeatureProvider{constructor(e,r,n){super(r,n),this.httpClient=e,this.telemetry=r,this.filterProviders=n}async fetch(){let e=this.getFilters(),r={};for(let c of e.keys()){let u=e.get(c);r[c]=u}let n;try{n=await this.httpClient.get({headers:r})}catch(c){let u=c,l=new Map;u.responseReceived&&!u.responseOk?l.set(NX,"ServerError"):u.responseReceived===!1?l.set(NX,"NoResponse"):l.set(NX,"GenericError"),this.telemetry.postEvent(av.TASAPI_FETCHERROR_EVENTNAME,l)}if(!n)throw Error(av.TASAPI_FETCHERROR_EVENTNAME);e.keys.length>0&&this.PostEventToTelemetry(r);let o=n.data,s=o.Configs,a=[];for(let c of s)if(c.Parameters)for(let u of Object.keys(c.Parameters)){let l=u+(c.Parameters[u]?"":"cf");a.includes(l)||a.push(l)}return{features:a,assignmentContext:o.AssignmentContext,configs:s}}};av.TasApiFeatureProvider=LX});var jTe=M(VC=>{"use strict";Object.defineProperty(VC,"__esModule",{value:!0});VC.HttpClient=VC.FetchError=void 0;var jC=class extends Error{constructor(e,r,n){super(e),this.responseReceived=r,this.responseOk=n}};VC.FetchError=jC;var OX=class{constructor(e){this.endpoint=e}async get(e){let r=await fetch(this.endpoint,{method:"GET",headers:e?.headers});if(!r)throw new jC("No response received",!1);if(!r.ok)throw new jC("Response not ok",!0,!1);let n=await r.json();if(!n)throw new jC("No data received",!1);return{data:n}}};VC.HttpClient=OX});var VTe=M(vM=>{"use strict";Object.defineProperty(vM,"__esModule",{value:!0});vM.MemoryKeyValueStorage=void 0;var MX=class{constructor(){this.storage=new Map}async getValue(e,r){return this.storage.has(e)?await Promise.resolve(this.storage.get(e)):await Promise.resolve(r||void 0)}setValue(e,r){this.storage.set(e,r)}};vM.MemoryKeyValueStorage=MX});var GTe=M(yM=>{"use strict";Object.defineProperty(yM,"__esModule",{value:!0});yM.ExperimentationServiceBase=void 0;var sot=VTe(),FX=class{get features(){return this._features}set features(e){this._features=e,this.telemetry&&this.telemetry.setSharedProperty(this.assignmentContextTelemetryPropertyName,this.features.assignmentContext)}constructor(e,r,n,o,s){this.telemetry=e,this.assignmentContextTelemetryPropertyName=r,this.telemetryEventName=n,this.storageKey=o,this.storage=s,this.featuresConsumed=!1,this.cachedTelemetryEvents=[],this._features={features:[],assignmentContext:"",configs:[]},this.storageKey||(this.storageKey="ABExp.Features"),this.storage||(s=new sot.MemoryKeyValueStorage),this.loadCachePromise=this.loadCachedFeatureData(),this.initializePromise=this.loadCachePromise,this.initialFetch=new Promise((a,c)=>{this.resolveInitialFetchPromise=a})}async getFeaturesAsync(e=!1){if(this.fetchPromise!=null){try{await this.fetchPromise}catch{}return this.features}if(!this.featureProviders||this.featureProviders.length===0)return Promise.resolve({features:[],assignmentContext:"",configs:[]});try{this.fetchPromise=Promise.all(this.featureProviders.map(async n=>await n.getFeatures()));let r=await this.fetchPromise;this.updateFeatures(r,e)}catch{}return this.fetchPromise=void 0,this.resolveInitialFetchPromise&&(this.resolveInitialFetchPromise(),this.resolveInitialFetchPromise=void 0),this.features}updateFeatures(e,r=!1){let n={features:[],assignmentContext:"",configs:[]};for(let o of e){for(let s of o.features)n.features.includes(s)||n.features.push(s);for(let s of o.configs){let a=n.configs.find(c=>c.Id===s.Id);a?a.Parameters=Object.assign(Object.assign({},a.Parameters),s.Parameters):n.configs.push(s)}n.assignmentContext+=o.assignmentContext}(r||!this.featuresConsumed)&&(this.features=n),this.storage&&this.storage.setValue(this.storageKey,n)}async loadCachedFeatureData(){let e;this.storage&&(e=await this.storage.getValue(this.storageKey),e!==void 0&&e.configs===void 0&&(e.configs=[])),this.features.features.length===0&&(this.features=e||{features:[],assignmentContext:"",configs:[]})}isFlightEnabled(e){return this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isCachedFlightEnabled(e){return await this.loadCachePromise,this.featuresConsumed=!0,this.PostEventToTelemetry(e),this.features.features.includes(e)}async isFlightEnabledAsync(e){let r=await this.getFeaturesAsync(!0);return this.featuresConsumed=!0,this.PostEventToTelemetry(e),r.features.includes(e)}getTreatmentVariable(e,r){this.featuresConsumed=!0,this.PostEventToTelemetry(`${e}.${r}`);let n=this.features.configs.find(o=>o.Id===e);return n?.Parameters[r]}async getTreatmentVariableAsync(e,r,n){if(n){let o=this.featuresConsumed,s=this.getTreatmentVariable(e,r);if(s===void 0)this.featuresConsumed=o;else return s}return await this.getFeaturesAsync(!0),this.getTreatmentVariable(e,r)}PostEventToTelemetry(e){this.cachedTelemetryEvents.includes(e)||(this.telemetry.postEvent(this.telemetryEventName,new Map([["ABExp.queriedFeature",e]])),this.cachedTelemetryEvents.push(e))}invokeInit(){this.init()}addFeatureProvider(...e){if(!(e==null||this.featureProviders==null))for(let r of e)this.featureProviders.push(r)}};yM.ExperimentationServiceBase=FX});var zTe=M(bM=>{"use strict";Object.defineProperty(bM,"__esModule",{value:!0});bM.PollingService=void 0;var UX=class{constructor(e){this.fetchInterval=e}StopPolling(){clearInterval(this.intervalHandle),this.intervalHandle=void 0}OnPollTick(e){this.onTick=e}StartPolling(e=!1){this.intervalHandle&&this.StopPolling(),this.onTick!=null&&(e&&this.onTick().then(()=>{}).catch(()=>{}),this.intervalHandle=setInterval(async()=>{await this.onTick()},this.fetchInterval),this.intervalHandle.unref&&this.intervalHandle.unref())}};bM.PollingService=UX});var $Te=M(_M=>{"use strict";Object.defineProperty(_M,"__esModule",{value:!0});_M.ExperimentationServiceAutoPolling=void 0;var aot=GTe(),cot=zTe(),BX=class extends aot.ExperimentationServiceBase{constructor(e,r,n,o,s,a,c){if(super(e,o,s,a,c),this.telemetry=e,this.filterProviders=r,this.refreshRateMs=n,this.assignmentContextTelemetryPropertyName=o,this.telemetryEventName=s,this.storageKey=a,this.storage=c,n<1e3&&n!==0)throw new Error("The minimum refresh rate for polling is 1000 ms (1 second). If you wish to deactivate this auto-polling use value of 0.");n>0&&(this.pollingService=new cot.PollingService(n),this.pollingService.OnPollTick(async()=>{await super.getFeaturesAsync()}))}init(){this.pollingService?this.pollingService.StartPolling(!0):super.getFeaturesAsync()}async getFeaturesAsync(e=!1){if(this.pollingService){this.pollingService.StopPolling();let r=await super.getFeaturesAsync(e);return this.pollingService.StartPolling(),r}else return await super.getFeaturesAsync(e)}};_M.ExperimentationServiceAutoPolling=BX});var WTe=M(SM=>{"use strict";Object.defineProperty(SM,"__esModule",{value:!0});SM.ExperimentationService=void 0;var uot=HTe(),lot=jTe(),dot=$Te(),xM=class extends dot.ExperimentationServiceAutoPolling{constructor(e){super(e.telemetry,e.filterProviders||[],e.refetchInterval!=null?e.refetchInterval:0,e.assignmentContextTelemetryPropertyName,e.telemetryEventName,e.storageKey,e.keyValueStorage),this.options=e,this.invokeInit()}init(){this.featureProviders=[],this.addFeatureProvider(new uot.TasApiFeatureProvider(new lot.HttpClient(this.options.endpoint),this.telemetry,this.filterProviders)),super.init()}};SM.ExperimentationService=xM;xM.REFRESH_RATE_IN_MINUTES=30});var KTe=M(IM=>{"use strict";Object.defineProperty(IM,"__esModule",{value:!0});IM.ExperimentationService=void 0;var pot=WTe();Object.defineProperty(IM,"ExperimentationService",{enumerable:!0,get:function(){return pot.ExperimentationService}})});var YTe=M(CM=>{"use strict";Object.defineProperty(CM,"__esModule",{value:!0});CM.MementoKeyValueStorage=void 0;var qX=class{constructor(e){this.mementoGlobalStorage=e}async getValue(e,r){return await this.mementoGlobalStorage.get(e)||r}setValue(e,r){this.mementoGlobalStorage.update(e,r)}};CM.MementoKeyValueStorage=qX});var QTe=M(jX=>{"use strict";Object.defineProperty(jX,"__esModule",{value:!0});var HX=class{constructor(){this.initializePromise=Promise.resolve(),this.initialFetch=Promise.resolve()}isFlightEnabled(e){return!1}isCachedFlightEnabled(e){return Promise.resolve(!1)}isFlightEnabledAsync(e){return Promise.resolve(!1)}getTreatmentVariable(e,r){}getTreatmentVariableAsync(e,r){return Promise.resolve(void 0)}};jX.default=HX});var JTe=M(GC=>{"use strict";Object.defineProperty(GC,"__esModule",{value:!0});GC.getExperimentationServiceAsync=GC.getExperimentationService=void 0;var fot=PX(),mot=KTe(),VX=require("vscode"),hot=YTe(),got=QTe(),vot="https://default.exp-tas.com/vscode/ab",yot="query-expfeature",bot="abexp.assignmentcontext",_ot="VSCode.ABExp.FeatureData",xot=1e3*60*30;function XTe(t,e,r,n,o,...s){if(!o)throw new Error("Memento storage was not provided.");let a=VX.workspace.getConfiguration("telemetry");if(!(VX.env.isTelemetryEnabled===void 0?a.get("enableTelemetry",!0):VX.env.isTelemetryEnabled))return new got.default;let l=[new fot.VSCodeFilterProvider(t,e,r),...s],d=new hot.MementoKeyValueStorage(o);return new mot.ExperimentationService({filterProviders:l,telemetry:n,storageKey:_ot,keyValueStorage:d,featuresTelemetryPropertyName:"",assignmentContextTelemetryPropertyName:bot,telemetryEventName:yot,endpoint:vot,refetchInterval:xot})}GC.getExperimentationService=XTe;async function Sot(t,e,r,n,o,...s){let a=XTe(t,e,r,n,o,...s);return await a.initializePromise,a}GC.getExperimentationServiceAsync=Sot});var ewe=M(cv=>{"use strict";Object.defineProperty(cv,"__esModule",{value:!0});cv.TargetPopulation=cv.getExperimentationServiceAsync=cv.getExperimentationService=void 0;var ZTe=JTe();Object.defineProperty(cv,"getExperimentationService",{enumerable:!0,get:function(){return ZTe.getExperimentationService}});Object.defineProperty(cv,"getExperimentationServiceAsync",{enumerable:!0,get:function(){return ZTe.getExperimentationServiceAsync}});var Iot=PX();Object.defineProperty(cv,"TargetPopulation",{enumerable:!0,get:function(){return Iot.TargetPopulation}})});var nwe=M(TM=>{"use strict";Object.defineProperty(TM,"__esModule",{value:!0});TM.BaseTelemetryReporter=void 0;var GX=class{constructor(e,r,n){this.telemetrySender=e,this.vscodeAPI=r,this.userOptIn=!1,this.errorOptIn=!1,this.disposables=[],this._onDidChangeTelemetryLevel=new this.vscodeAPI.EventEmitter,this.onDidChangeTelemetryLevel=this._onDidChangeTelemetryLevel.event,this.telemetryLogger=this.vscodeAPI.env.createTelemetryLogger(this.telemetrySender,n),this.updateUserOptIn(),this.telemetryLogger.onDidChangeEnableStates(()=>{this.updateUserOptIn()})}updateUserOptIn(){this.errorOptIn=this.telemetryLogger.isErrorsEnabled,this.userOptIn=this.telemetryLogger.isUsageEnabled,(this.telemetryLogger.isErrorsEnabled||this.telemetryLogger.isUsageEnabled)&&this.telemetrySender.instantiateSender(),this._onDidChangeTelemetryLevel.fire(this.telemetryLevel)}get telemetryLevel(){return this.errorOptIn&&this.userOptIn?"all":this.errorOptIn?"error":"off"}internalSendTelemetryEvent(e,r,n,o){o?this.telemetrySender.sendEventData(e,{properties:r,measurements:n}):this.telemetryLogger.logUsage(e,{properties:r,measurements:n})}sendTelemetryEvent(e,r,n){this.internalSendTelemetryEvent(e,r,n,!1)}sendRawTelemetryEvent(e,r,n){let o={...r};for(let s of Object.keys(o??{})){let a=o[s];typeof s=="string"&&a!==void 0&&(o[s]=new this.vscodeAPI.TelemetryTrustedValue(typeof a=="string"?a:a.value))}this.sendTelemetryEvent(e,o,n)}sendDangerousTelemetryEvent(e,r,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryEvent(e,r,n,!0)}internalSendTelemetryErrorEvent(e,r,n,o){o?this.telemetrySender.sendEventData(e,{properties:r,measurements:n}):this.telemetryLogger.logError(e,{properties:r,measurements:n})}sendTelemetryErrorEvent(e,r,n){this.internalSendTelemetryErrorEvent(e,r,n,!1)}sendDangerousTelemetryErrorEvent(e,r,n){this.telemetrySender.instantiateSender(),this.internalSendTelemetryErrorEvent(e,r,n,!0)}async dispose(){return await this.telemetrySender.dispose(),this.telemetryLogger.dispose(),Promise.all(this.disposables.map(e=>e.dispose()))}};TM.BaseTelemetryReporter=GX});var iwe=M(wM=>{"use strict";Object.defineProperty(wM,"__esModule",{value:!0});wM.BaseTelemetrySender=void 0;var im;(function(t){t[t.NOT_INSTANTIATED=0]="NOT_INSTANTIATED",t[t.INSTANTIATING=1]="INSTANTIATING",t[t.INSTANTIATED=2]="INSTANTIATED"})(im||(im={}));var zX=class{constructor(e,r){this._instantiationStatus=im.NOT_INSTANTIATED,this._eventQueue=[],this._exceptionQueue=[],this._clientFactory=r,this._key=e}sendEventData(e,r){if(!this._telemetryClient){this._instantiationStatus!==im.INSTANTIATED&&this._eventQueue.push({eventName:e,data:r});return}this._telemetryClient.logEvent(e,r)}sendErrorData(e,r){if(!this._telemetryClient){this._instantiationStatus!==im.INSTANTIATED&&this._exceptionQueue.push({exception:e,data:r});return}let n={stack:e.stack,message:e.message,name:e.name};if(r){let o=r.properties||r;r.properties={...o,...n}}else r={properties:n};this._telemetryClient.logEvent("unhandlederror",r)}async flush(){return this._telemetryClient?.flush()}async dispose(){this._telemetryClient&&(await this._telemetryClient.dispose(),this._telemetryClient=void 0)}_flushQueues(){this._eventQueue.forEach(({eventName:e,data:r})=>this.sendEventData(e,r)),this._eventQueue=[],this._exceptionQueue.forEach(({exception:e,data:r})=>this.sendErrorData(e,r)),this._exceptionQueue=[]}instantiateSender(){this._instantiationStatus===im.NOT_INSTANTIATED&&(this._instantiationStatus=im.INSTANTIATING,this._clientFactory(this._key).then(e=>{this._telemetryClient=e,this._instantiationStatus=im.INSTANTIATED,this._flushQueues()}).catch(e=>{console.error(e),this._instantiationStatus=im.INSTANTIATED}))}};wM.BaseTelemetrySender=zX});var WX=M(RM=>{"use strict";Object.defineProperty(RM,"__esModule",{value:!0});RM.TelemetryUtil=void 0;var $X=class t{static applyReplacements(e,r){for(let n of Object.keys(e))for(let o of r)o.lookup.test(n)&&(o.replacementString!==void 0?e[n]=o.replacementString:delete e[n])}static shouldUseOneDataSystemSDK(e){return e.length===74&&e[32]==="-"&&e[41]==="-"&&e[46]==="-"&&e[51]==="-"&&e[56]==="-"&&e[69]==="-"}static getAdditionalCommonProperties(e){return{"common.os":e.platform,"common.nodeArch":e.architecture,"common.platformversion":(e.release||"").replace(/^(\d+)(\.\d+)?(\.\d+)?(.*)/,"$1$2$3"),"common.telemetryclientversion":"0.9.4"}}static getInstance(){return t._instance||(t._instance=new t),t._instance}};RM.TelemetryUtil=$X});var zC,om,lp,Fl,$C,J2,KX=R(()=>{zC="function",om="object",lp="undefined",Fl="prototype",$C=Object,J2=$C[Fl]});var Hi,Ci,WC,uv,sm,qu,Z2,am,eP,tP,owe,Hu,rP,pn,KC,Ei,YC,YX,Oc,QX,XX,cm,za,or=R(()=>{Hi=void 0,Ci=null,WC="",uv="function",sm="object",qu="prototype",Z2="__proto__",am="undefined",eP="constructor",tP="Symbol",owe="_polyfill",Hu="length",rP="name",pn="call",KC="toString",Ei=Object,YC=Ei[qu],YX=String,Oc=YX[qu],QX=Math,XX=Array,cm=XX[qu],za=cm.slice});function Ms(t,e){try{return{v:t.apply(this,e)}}catch(r){return{e:r}}}var QC=R(()=>{});function swe(t,e){var r=Ms(t);return r.e?e:r.v}var awe=R(()=>{QC()});function kM(t){return function(e){return typeof e===t}}function cwe(t){var e="[object "+t+"]";return function(r){return!!(r&&nP(r)===e)}}function nP(t){return YC.toString.call(t)}function PM(t,e){return typeof t===e}function Pt(t){return typeof t===am||t===am}function Ee(t){return t===Ci||Pt(t)}function ZX(t){return t===Ci||!AM(t)}function AM(t){return!!t||t!==Hi}function eJ(t){return!JX&&(JX=["string","number","boolean",am,"symbol","bigint"]),t!==sm&&JX.indexOf(t)!==-1}function Pn(t){return!t&&Ee(t)?!1:!!t&&typeof t===sm}function dv(t){return!!(t&&t.then&&vt(t.then))}function DM(t){return!t||!ju(t)}function ju(t){return!(!t||swe(function(){return!(t&&0+t)},!t))}var JX,Ft,vt,st,XC,Fs,Ul,lv,Mc=R(()=>{or();awe();Ft=kM("string"),vt=kM(uv);st=XX.isArray,XC=cwe("Date"),Fs=kM("number"),Ul=kM("boolean"),lv=cwe("Error")});var yb,NM=R(()=>{or();yb=Ei.getOwnPropertyDescriptor});function ji(t,e){return!!t&&YC.hasOwnProperty[pn](t,e)}var LM=R(()=>{or()});function uwe(t,e){return ji(t,e)||!!yb(t,e)}var $a,OM=R(()=>{or();NM();LM();$a=Ei.hasOwn||uwe});function Ze(t,e,r){if(t&&Pn(t)){for(var n in t)if($a(t,n)&&e[pn](r||t,n,t[n])===-1)break}}var pv=R(()=>{Mc();or();OM()});function tJ(t,e,r,n){var o={};return Ze(t,function(s,a){o[s]=e?a:s,o[a]=r?a:s}),n(o)}var lwe=R(()=>{pv()});function ai(t){throw new Error(t)}function Qn(t){throw new TypeError(t)}var fv=R(()=>{});function dwe(t){var e=[];return Ze(t,function(r,n){e.push([r,n])}),e}function pwe(t){var e=[];return Ze(t,function(r,n){e.push(n)}),e}var fwe=R(()=>{pv()});function mwe(t){return t}function Eot(t){return t[Z2]||Ci}function ga(t){return rJ&&Ze(t,function(e,r){(st(r)||Pn(r))&&rJ(r)}),dp(t)}var rJ,bb,Eo,dp,MM,JC,Tot,pIr,ZC=R(()=>{or();Mc();pv();fwe();rJ=Ei.freeze;bb=Ei.assign,Eo=Ei.keys;dp=rJ||mwe,MM=Ei.seal||mwe,JC=Ei.getPrototypeOf||Eot,Tot=Ei.entries||dwe,pIr=Ei.values||pwe});function nJ(t){return tJ(t,1,0,ga)}function iJ(t){return tJ(t,0,0,ga)}function hwe(t){var e={};return Ze(t,function(r,n){e[r]=n[1],e[n[0]]=n[1]}),ga(e)}function oJ(t){return hwe(t)}var sJ=R(()=>{lwe();pv();ZC()});var FM,aJ=R(()=>{sJ();FM=iJ({asyncIterator:0,hasInstance:1,isConcatSpreadable:2,iterator:3,match:4,matchAll:5,replace:6,search:7,species:8,split:9,toPrimitive:10,toStringTag:11,unscopables:12})});var zn,_b=R(()=>{or();zn=YX});function uJ(){var t;return typeof globalThis!==am&&(t=globalThis),!t&&typeof self!==am&&(t=self),!t&&typeof window!==am&&(t=window),!t&&typeof global!==am&&(t=global),t}function UM(){if(!cJ){var t=Ms(uJ).v||{};cJ=t[gwe]=t[gwe]||{}}return cJ}var gwe,cJ,BM=R(()=>{QC();or();gwe="__tsUtils$gblCfg"});function We(t,e){var r=WC,n=YC[KC][pn](t);n===wot&&(t={stack:zn(t.stack),message:zn(t.message),name:zn(t.name)});try{r=JSON.stringify(t,Ci,e?typeof e=="number"?e:4:Hi),r=r&&r.replace(/"(\w+)"\s*:\s{0,1}/g,"$1: ")||zn(t)}catch(o){r=" - "+We(o,e)}return n+": "+r}var wot,mv=R(()=>{or();_b();wot="[object Error]"});function Bl(t,e,r){var n=e&&e[t];return function(o){var s=o&&o[t]||n;if(s||r){var a=arguments;return(s||r).apply(o,s?za[pn](a,1):a)}Qn('"'+zn(t)+'" not defined for '+We(o))}}function vwe(t){return function(e){return e[t]}}var Vu,Gu=R(()=>{mv();fv();_b();or();Vu=Bl});var LIr,ywe,bwe=R(()=>{or();LIr=QX.min,ywe=QX.max});var lJ,_we=R(()=>{or();Gu();lJ=Vu("slice",Oc)});function xwe(t,e,r){return Ee(t)&&Qn("'polyStrSubstr called with invalid "+We(t)),r<0?WC:(e=e||0,e<0&&(e=ywe(e+t[Hu],0)),Pt(r)?lJ(t,e):lJ(t,e,e+r))}function hv(t,e){return Ti(t,0,e)}var Ti,ql,qM=R(()=>{Mc();mv();fv();or();Gu();bwe();_we();Ti=Vu("substring",Oc),ql=Bl("substr",Oc,xwe)});function Rot(){if(!dJ){var t=UM();dJ=t.gblSym=t.gblSym||{k:{},s:{}}}return dJ}function jM(t){var e={description:zn(t),toString:function(){return tP+"("+t+")"}};return e[owe]=!0,e}function Iwe(t){var e=Rot();if(!$a(e.k,t)){var r=jM(t),n=Eo(e.s).length;r[Swe]=function(){return n+"_"+r[KC]()},e.k[t]=r,e.s[r[Swe]()]=zn(t)}return e.k[t]}function Cwe(t){!HM&&(HM={});var e,r=FM[t];return r&&(e=HM[r]=HM[r]||jM(tP+"."+r)),e}var Swe,dJ,HM,Ewe=R(()=>{aJ();or();OM();_b();BM();ZC();Swe="_urid"});function Twe(t){var e={};if(e[VM.c]=!0,e[VM.e]=!0,t.l){e.get=function(){return t.l.v};var r=yb(t.l,"v");r&&r.set&&(e.set=function(n){t.l.v=n})}return Ze(t,function(n,o){e[VM[n]]=Pt(o)?e[VM[n]]:o}),e}function GM(t,e,r,n,o,s){var a={e:s,c:o};return r&&(a.g=r),n&&(a.s=n),wi(t,e,Twe(a))}function Vr(t,e,r){return wi(t,e,Twe(r))}var VM,wi,kot,xb=R(()=>{or();Mc();pv();NM();VM={e:"enumerable",c:"configurable",v:"value",w:"writable",g:"get",s:"set"};wi=Ei.defineProperty,kot=Ei.defineProperties});function Hl(){Ri=UM()}function jl(t){var e={};return!Ri&&Hl(),e.b=Ri.lzy,wi(e,"v",{configurable:!0,get:function(){var r=t();return Ri.lzy||wi(e,"v",{value:r}),e.b=Ri.lzy,r}}),e}var Ri,Sb=R(()=>{BM();xb()});function eE(t,e){return jl(function(){var r=Ms(t);return r.e?e:r.v})}var pJ=R(()=>{Sb();QC()});function iP(t){return wi({toJSON:function(){return t}},"v",{value:t})}var fJ=R(()=>{xb()});function sP(t,e){var r;return function(){return!Ri&&Hl(),(!r||Ri.lzy)&&(r=iP(Ms(t,e).v)),r.v}}function um(t){return jl(function(){return Ms(nn,[t]).v||Hi})}function Us(t){return!Ri&&Hl(),(!oP||t===!1||Ri.lzy)&&(oP=iP(Ms(uJ).v||Ci)),oP.v}function nn(t,e){var r=!oP||e===!1?Us(e):oP.v;return r&&r[t]?r[t]:t===wwe?ui():Ci}function gv(){return!!ci()}function vv(){return!!ui()}function tE(){return!!io()}function zM(){return!!aP()}var wwe,oP,ci,ui,io,aP,mJ,cP=R(()=>{or();BM();Sb();fJ();QC();wwe="window";ci=sP(nn,["document"]);ui=sP(nn,[wwe]);io=sP(nn,["navigator"]);aP=sP(nn,["history"]),mJ=sP(function(){return!!Ms(function(){return process&&(process.versions||{}).node}).v})});function $M(){(!Bs||!Bs.b)&&(Bs=um(tP),hJ=eE(function(){return Bs.v?Bs.v.for:Hi},Hi),Pot=eE(function(){return Bs.v?Bs.v.keyFor:Hi},Hi))}function gJ(){return!!Rwe()}function Rwe(){return!Ri&&Hl(),(!Bs||Ri.lzy)&&$M(),Bs.v}function Ib(t,e){var r=FM[t];return!Ri&&Hl(),(!Bs||Ri.lzy)&&$M(),Bs.v?Bs.v[r||t]:e?Hi:Cwe(t)}function Cb(t,e){return!Ri&&Hl(),(!Bs||Ri.lzy)&&$M(),Bs.v?Bs.v(t):e?Ci:jM(t)}function uP(t){return!Ri&&Hl(),(!hJ||!Bs||Ri.lzy)&&$M(),(hJ.v||Iwe)(t)}var Bs,hJ,Pot,WM=R(()=>{or();Ewe();aJ();Sb();pJ();cP()});function lP(t){return!!t&&vt(t.next)}function kwe(t){return!ZX(t)&&vt(t[Ib(3)])}var vJ=R(()=>{WM();Mc()});function Pwe(t,e,r){if(t&&(lP(t)||(!KM&&(KM=iP(Ib(3))),t=t[KM.v]?t[KM.v]():null),lP(t))){var n=void 0,o=void 0;try{for(var s=0;!(o=t.next()).done&&e[pn](r||t,o.value,s,t)!==-1;)s++}catch(a){n={e:a},t.throw&&(o=null,t.throw(n))}finally{try{o&&!o.done&&t.return&&t.return(o)}finally{if(n)throw n.e}}}}var KM,Awe=R(()=>{fJ();or();WM();vJ()});function lm(t,e,r){return t.apply(e,r)}var YM=R(()=>{});function zu(t,e){return!Pt(e)&&t&&(st(e)?lm(t.push,t,e):lP(e)||kwe(e)?Pwe(e,function(r){t.push(r)}):t.push(e)),t}var Dwe=R(()=>{Mc();vJ();Awe();YM()});function _e(t,e,r){if(t)for(var n=t[Hu]>>>0,o=0;o<n&&!(o in t&&e[pn](r||t,t[o],o,t)===-1);o++);}var QM=R(()=>{or()});var Pr,yJ=R(()=>{or();Gu();Pr=Vu("indexOf",cm)});var pp,Nwe=R(()=>{or();Gu();pp=Vu("map",cm)});function yv(t,e,r){return(t&&t.slice||za).apply(t,za[pn](arguments,1))}var Lwe=R(()=>{or()});function Owe(t,e,r){return Pr(t,e,r)!==-1}var Mwe=R(()=>{yJ()});var XM,Fwe=R(()=>{or();Gu();Mwe();XM=Bl("includes",cm,Owe)});var rE,Uwe=R(()=>{or();Gu();rE=Vu("reduce",cm)});function Aot(t){if(!t)return{};var e=typeof t;e!==sm&&e!==uv&&Qn("Prototype must be an Object or function: "+We(t));function r(){}return r[qu]=t,new r}var $u,bJ=R(()=>{or();mv();fv();$u=Ei.create||Aot});function xJ(t,e){var r=Ei.setPrototypeOf||function(n,o){!_J&&(_J=jl(function(){var s;return s={},s[Z2]=[],s instanceof Array})),_J.v?n[Z2]=o:Ze(o,function(s,a){return n[s]=a})};return r(t,e)}var _J,Bwe=R(()=>{Sb();or();pv()});function Dot(t,e,r){Ms(Vr,[e,rP,{v:t,c:!0,e:!1}]),e=xJ(e,r);function n(){this.constructor=e,Ms(Vr,[this,rP,{v:t,c:!0,e:!1}])}return e[qu]=r===Ci?$u(r):(n[qu]=r[qu],new n),e}function qwe(t,e){e&&(t[rP]=e)}function SJ(t,e,r){var n=r||Error,o=n[qu][rP],s=Error.captureStackTrace;return Dot(t,function(){var a=this,c=arguments;try{Ms(qwe,[n,t]);var u=lm(n,a,za[pn](c))||a;if(u!==a){var l=JC(a);l!==JC(u)&&xJ(u,l)}return s&&s(u,a[eP]),e&&e(u,c),u}finally{Ms(qwe,[n,o])}},n)}var Hwe=R(()=>{YM();or();bJ();xb();ZC();Bwe();QC()});function li(){return(Date.now||jwe)()}function jwe(){return new Date().getTime()}var IJ=R(()=>{});function Not(t){return function(r){return Ee(r)&&Qn("strTrim called ["+We(r)+"]"),r&&r.replace&&(r=r.replace(t,WC)),r}}var Vwe,Gwe=R(()=>{Mc();mv();fv();or();Vwe=Not(/^\s+|(?=\s)\s+$/g)});var Fr,zwe=R(()=>{or();Gu();Gwe();Fr=Bl("trim",Oc,Vwe)});function To(t){if(!t||typeof t!==sm)return!1;TJ||(TJ=vv()?ui():!0);var e=!1;if(t!==TJ){EJ||(CJ=Function[qu][KC],EJ=CJ[pn](Ei));try{var r=JC(t);e=!r,e||(ji(r,eP)&&(r=r[eP]),e=r&&typeof r===uv&&CJ[pn](r)===EJ)}catch{}}return e}var CJ,EJ,TJ,wJ=R(()=>{cP();or();LM();ZC()});function Lot(t){return t.value&&Qwe(t),!0}function Oot(t,e,r,n){var o;return _e(t,function(s){if(s.k===e)return o=s,-1}),o||(o={k:e,v:e},t.push(o),n(o)),o.v}function RJ(t,e,r,n){var o=r.handler,s=r.path?n?r.path.concat(n):r.path:[],a={handler:r.handler,src:r.src,path:s},c=typeof e,u=!1,l=!1;e&&c===sm?u=To(e):l=e===Ci||eJ(c);var d={type:c,isPrim:l,isPlain:u,value:e,result:e,path:s,origin:r.src,copy:function(p,f){return RJ(t,p,f?a:r,f)},copyTo:function(p,f){return Wwe(t,p,f,a)}};return d.isPrim?o&&o[pn](r,d)?d.result:e:Oot(t,e,s,function(p){Vr(d,"result",{g:function(){return p.v},s:function(h){p.v=h}});for(var f=0,m=o;!(m||(f<$we.length?$we[f++]:Lot))[pn](r,d);)m=Ci})}function Wwe(t,e,r,n){if(!Ee(r))for(var o in r)e[o]=RJ(t,r[o],n,o);return e}function Kwe(t,e,r){var n={handler:r,src:e,path:[]};return Wwe([],t,e,n)}function Ywe(t,e){var r={handler:e,src:t};return RJ([],t,r)}function Mot(t){var e=t.value;if(st(e)){var r=t.result=[];return r.length=e.length,t.copyTo(r,e),!0}return!1}function Fot(t){var e=t.value;return XC(e)?(t.result=new Date(e.getTime()),!0):!1}function Uot(t){return t.type===uv}function Qwe(t){var e=t.value;if(e&&t.isPlain){var r=t.result={};return t.copyTo(r,e),!0}return!1}var $we,Xwe=R(()=>{QM();Mc();or();xb();wJ();$we=[Mot,Qwe,Uot,Fot]});function Bot(t,e){return _e(e,function(r){Kwe(t,r)}),t}function JM(t,e,r,n,o,s,a){return Bot(Ywe(t)||{},za[pn](arguments))}var Jwe=R(()=>{QM();or();Xwe()});var nE,Zwe=R(()=>{or();Gu();nE=vwe(Hu)});function dm(){return!Ri&&Hl(),(!ZM||!ZM.b&&Ri.lzy)&&(ZM=um("performance")),ZM.v}function iE(){var t=dm();return t&&t.now?t.now():li()}var ZM,eRe=R(()=>{IJ();cP();Sb()});function qot(t,e,r){Ft(t)||Qn("'"+We(t)+"' is not a string");var n=Ft(e)?e:zn(e),o=!Pt(r)&&r<t[Hu]?r:t[Hu];return Ti(t,o-n[Hu],o)===n}var bv,tRe=R(()=>{Mc();mv();fv();or();Gu();_b();qM();bv=Bl("endsWith",Oc,qot)});var va,rRe=R(()=>{or();Gu();va=Vu("indexOf",Oc)});function Hot(t,e,r){Ft(t)||Qn("'"+We(t)+"' is not a string");var n=Ft(e)?e:zn(e),o=r>0?r:0;return Ti(t,o,o+n[Hu])===n}var Eb,nRe=R(()=>{Mc();mv();fv();or();Gu();_b();qM();Eb=Bl("startsWith",Oc,Hot)});function iRe(t,e,r){var n=!0,o=t?e(Ci):Ci,s;function a(){return n=!1,o&&o[PJ]&&o[PJ](),s}function c(){o&&r(o),o=Ci}function u(){return o=e(o),n||a(),s}function l(d){!d&&o&&c(),d&&!o&&u()}return s={cancel:c,refresh:u},s[AJ]=function(){return o&&o[AJ]?o[AJ]():n},s[kJ]=function(){return n=!0,o&&o[kJ]&&o[kJ](),s},s[PJ]=a,s=wi(s,jot,{get:function(){return!!o},set:l}),{h:s,dn:function(){o=Ci}}}var kJ,PJ,AJ,jot,oRe=R(()=>{or();xb();kJ="ref",PJ="unref",AJ="hasRef",jot="enabled"});function DJ(t,e,r){var n=st(e),o=n?e.length:0,s=(o>0?e[0]:n?Hi:e)||setTimeout,a=(o>1?e[1]:Hi)||clearTimeout,c=r[0];r[0]=function(){u.dn(),lm(c,Hi,za[pn](arguments))};var u=iRe(t,function(l){if(l){if(l.refresh)return l.refresh(),l;lm(a,Hi,[l])}return lm(s,Hi,r)},function(l){lm(a,Hi,[l])});return u.h}function Wa(t,e){return DJ(!0,Hi,za[pn](arguments))}function NJ(t,e,r){return DJ(!0,t,za[pn](arguments,1))}function LJ(t,e){return DJ(!1,Hi,za[pn](arguments))}var sRe=R(()=>{YM();Mc();or();oRe()});var St=R(()=>{Dwe();QM();Fwe();yJ();Nwe();Uwe();Lwe();Mc();Hwe();IJ();mv();sJ();cP();Jwe();Sb();Zwe();eRe();pJ();fv();bJ();xb();pv();NM();OM();LM();wJ();ZC();tRe();rRe();nRe();qM();_b();zwe();WM();sRe()});function Ka(t,e){typeof e!==zC&&e!==null&&Qn("Class extends value "+String(e)+" is not a constructor or null"),OJ(t,e);function r(){this.constructor=t}t[Fl]=e===null?$u(e):(r[Fl]=e[Fl],new r)}function eF(t,e){for(var r=0,n=e.length,o=t.length;r<n;r++,o++)t[o]=e[r];return t}var jwr,Vwr,aRe,zot,Wu,OJ,cRe=R(()=>{St();KX();jwr=(Us()||{}).Symbol,Vwr=(Us()||{}).Reflect,aRe="hasOwnProperty",zot=function(t){for(var e,r=1,n=arguments.length;r<n;r++){e=arguments[r];for(var o in e)J2[aRe].call(e,o)&&(t[o]=e[o])}return t},Wu=bb||zot,OJ=function(t,e){return OJ=$C.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n[aRe](o)&&(r[o]=n[o])},OJ(t,e)}});var uRe=R(()=>{});var Ya=R(()=>{KX();cRe();uRe();St()});function iF(t){return t&&(t===VJ[pm]||t===Array[pm])}function GJ(t){return iF(t)||t===Function[pm]}function Tb(t){var e;if(t){if(pP)return pP(t);var r=t[jJ]||t[pm]||(t[oF]?t[oF][pm]:null);e=t[rF]||r,ji(t,rF)||(delete t[MJ],e=t[rF]=t[MJ]||t[rF],t[MJ]=r)}return e}function cF(t,e){var r=[];if(pRe)r=pRe(t);else for(var n in t)typeof n=="string"&&ji(t,n)&&r.push(n);if(r&&r.length>0)for(var o=0;o<r.length;o++)e(r[o])}function zJ(t,e,r){return e!==oF&&typeof t[e]===sF&&(r||ji(t,e))&&e!==jJ&&e!==pm}function uF(t){Qn("DynamicProto: "+t)}function Wot(t){var e=$u(null);return cF(t,function(r){!e[r]&&zJ(t,r,!1)&&(e[r]=t[r])}),e}function $J(t,e){for(var r=t.length-1;r>=0;r--)if(t[r]===e)return!0;return!1}function Kot(t,e,r,n){function o(u,l,d){var p=l[d];if(p[UJ]&&n){var f=u[aF]||{};f[dP]!==!1&&(p=(f[l[oE]]||{})[d]||p)}return function(){return p.apply(u,arguments)}}var s=$u(null);cF(r,function(u){s[u]=o(e,r,u)});for(var a=Tb(t),c=[];a&&!GJ(a)&&!$J(c,a);)cF(a,function(u){!s[u]&&zJ(a,u,!pP)&&(s[u]=o(e,a,u))}),c.push(a),a=Tb(a);return s}function Yot(t,e,r,n){var o=null;if(t&&ji(r,oE)){var s=t[aF]||$u(null);if(o=(s[r[oE]]||$u(null))[e],o||uF("Missing ["+e+"] "+sF),!o[BJ]&&s[dP]!==!1){for(var a=!ji(t,e),c=Tb(t),u=[];a&&c&&!GJ(c)&&!$J(u,c);){var l=c[e];if(l){a=l===n;break}u.push(c),c=Tb(c)}try{a&&(t[e]=o),o[BJ]=1}catch{s[dP]=!1}}}return o}function Qot(t,e,r){var n=e[t];return n===r&&(n=Tb(e)[t]),typeof n!==sF&&uF("["+t+"] is not a "+sF),n}function Xot(t,e,r,n,o){function s(u,l){var d=function(){var p=Yot(this,l,u,d)||Qot(l,u,d);return p.apply(this,arguments)};return d[UJ]=1,d}if(!iF(t)){var a=r[aF]=r[aF]||$u(null);if(!iF(a)){var c=a[e]=a[e]||$u(null);a[dP]!==!1&&(a[dP]=!!o),iF(c)||cF(r,function(u){zJ(r,u,!1)&&r[u]!==n[u]&&(c[u]=r[u],delete r[u],(!ji(t,u)||t[u]&&!t[u][UJ])&&(t[u]=s(t,u)))})}}}function Jot(t,e){if(pP){for(var r=[],n=Tb(e);n&&!GJ(n)&&!$J(r,n);){if(n===t)return!0;r.push(n),n=Tb(n)}return!1}return!0}function FJ(t,e){return ji(t,pm)?t.name||e||lRe:((t||{})[oF]||{}).name||e||lRe}function sr(t,e,r,n){ji(t,pm)||uF("theClass is an invalid class definition.");var o=t[pm];Jot(o,e)||uF("["+FJ(t)+"] not in hierarchy of ["+FJ(e)+"]");var s=null;ji(o,oE)?s=o[oE]:(s=$ot+FJ(t,"_")+"$"+HJ.n,HJ.n++,o[oE]=s);var a=sr[mRe],c=!!a[nF];c&&n&&n[nF]!==void 0&&(c=!!n[nF]);var u=Wot(e),l=Kot(o,e,u,c);r(e,l);var d=!!pP&&!!a[qJ];d&&n&&(d=!!n[qJ]),Xot(o,s,e,u,d!==!1)}var tF,oF,pm,sF,aF,UJ,oE,$ot,BJ,dP,mRe,lRe,jJ,rF,dRe,MJ,nF,qJ,VJ,pP,pRe,fRe,HJ,Wo=R(()=>{St();oF="constructor",pm="prototype",sF="function",aF="_dynInstFuncs",UJ="_isDynProxy",oE="_dynClass",$ot="_dynCls$",BJ="_dynInstChk",dP=BJ,mRe="_dfOpts",lRe="_unknown_",jJ="__proto__",rF="_dyn"+jJ,dRe="__dynProto$Gbl",MJ="_dynInstProto",nF="useBaseInst",qJ="setInstFuncs",VJ=Object,pP=VJ.getPrototypeOf,pRe=VJ.getOwnPropertyNames,fRe=Us(),HJ=fRe[dRe]||(fRe[dRe]={o:(tF={},tF[qJ]=!0,tF[nF]=!0,tF),n:1e3});sr[mRe]=HJ.o});var WJ,hRe=R(()=>{"use strict";WJ=100});var oo,KJ,lF=R(()=>{St();oo=nJ,KJ=oJ});var Vl,Zot,gRe=R(()=>{lF();Vl=oo({Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5}),Zot=oo({Unknown:0,NonRetryableStatus:1,CleanStorage:2,MaxInStorageTimeExceeded:3})});var Qa,_v,lt,wb,Rb,sE,fm,Gl,Ku,gn,xv,lr,fp,dF,kb,mm,mp,Xa,Sv,YJ,qs,Iv,wo,pF,aE,cE,uE,Cv,QJ,Ja,fP,Pb,fF,hp,Fc,lE,gp,zl,Za,Ev,Ab,Uc,Tv,mF,mP,Yu,hF,$l,XJ,ec,hP,Db,JJ,ZJ,eZ,gP,wv,Nb,Wl,gF,dE,tZ,vF,Lb,rZ,pE,fE,Rv,xn=R(()=>{Qa="toLowerCase",_v="blkVal",lt="length",wb="rdOnly",Rb="notify",sE="warnToConsole",fm="throwInternal",Gl="setDf",Ku="watch",gn="logger",xv="apply",lr="push",fp="splice",dF="hdlr",kb="cancel",mm="initialize",mp="identifier",Xa="isInitialized",Sv="getPlugin",YJ="pollInternalLogs",qs="name",Iv="time",wo="processNext",pF="getProcessTelContext",aE="getNotifyMgr",cE="addNotificationListener",uE="removeNotificationListener",Cv="enabled",QJ="stopPollingInternalLogs",Ja="unload",fP="onComplete",Pb="version",fF="loggingLevelConsole",hp="createNew",Fc="teardown",lE="messageId",gp="message",zl="isAsync",Za="diagLog",Ev="_doTeardown",Ab="update",Uc="getNext",Tv="setNextPlugin",mF="protocol",mP="userAgent",Yu="split",hF="nodeType",$l="replace",XJ="logInternalMessage",ec="type",hP="handler",Db="status",JJ="itemsReceived",ZJ="getResponseHeader",eZ="getAllResponseHeaders",gP="isChildEvt",wv="data",Nb="getCtx",Wl="setCtx",gF="complete",dE="urlString",tZ="sendPOST",vF="headers",Lb="timeout",rZ="setRequestHeader",pE="traceId",fE="spanId",Rv="traceFlags"});function vRe(t,e){nZ||(nZ=SJ("AggregationError",function(n,o){o[lt]>1&&(n.errors=o[1])}));var r=t||"One or more errors occurred.";throw _e(e,function(n,o){r+=`
`.concat(o," > ").concat(We(n))}),new nZ(r,e||[])}var nZ,yRe=R(()=>{St();xn()});function kv(t,e){return yF(t,function(r){return e?e({value:r,rejected:!1}):r},function(r){return e?e({rejected:!0,reason:r}):r})}function yF(t,e,r,n){var o=t;return dv(t)?(e||r)&&(o=t.then(e,r)):e&&(o=e(t)),n&&bRe(o,n),o}function bRe(t,e){var r=t;return e&&(dv(t)?t.finally?r=t.finally(e):r=t.then(function(n){return e(),n},function(n){throw e(),n}):e()),r}var iZ=R(()=>{St()});function _Re(t,e,r,n){oZ=oZ||{toString:function(){return"[[PromiseState]]"}},sZ=sZ||{toString:function(){return"[[PromiseResult]]"}},aZ=aZ||{toString:function(){return"[[PromiseIsHandled]]"}},wi(t,oZ,{get:e}),wi(t,sZ,{get:r}),wi(t,aZ,{get:n})}var oZ,sZ,aZ,cZ,xRe=R(()=>{St();cZ=!1});var bF,uZ=R(()=>{bF=["pending","resolving","resolved","rejected"]});function IRe(t,e,r,n){var o=ci();!_F&&(_F=eE(function(){var u;return o&&o.createEvent&&(u=o.createEvent("Event")),!!u&&u.initEvent},null));var s=_F.v?o.createEvent("Event"):n?new Event(e):{};if(r&&r(s),_F.v&&s.initEvent(e,!1,!0),s&&t[SRe])t[SRe](s);else{var a=t["on"+e];if(a)a(s);else{var c=nn("console");c&&(c.error||c.log)(e,We(s))}}}var SRe,_F,CRe=R(()=>{St();SRe="dispatchEvent"});var mE,lZ=R(()=>{mE="Promise"});function ERe(t){return vt(t)?t.toString():We(t)}function wRe(t,e,r){var n=yv(arguments,3),o=0,s=!1,a,c=[],u=tst++,l=vP.length>0?vP[vP.length-1]:void 0,d=!1,p=null,f;!dZ&&(dZ=um(mE+"RejectionEvent"));var m=function(I,T){try{vP.push(u),d=!0,p&&p.cancel(),p=null;var A=t(function(B,j){c.push(function(){try{var F=o===2?I:T,ne=Pt(F)?a:vt(F)?F(a):F;dv(ne)?ne.then(B,j):F?B(ne):o===3?j(ne):B(ne)}catch(Y){j(Y)}}),s&&y()},n);return A}finally{vP.pop()}},h=function(I){return m(void 0,I)},g=function(I){var T=I,A=I;return vt(I)&&(T=function(B){return I&&I(),B},A=function(B){throw I&&I(),B}),m(T,A)},v=function(){return bF[o]},y=function(){if(c.length>0){var I=c.slice();c=[],d=!0,e(I),p&&p.cancel(),p=null}},b=function(I,T){return function(A){if(o===T){if(I===2&&dv(A)){o=1,A.then(b(2,1),b(3,1));return}o=I,s=!0,a=A,y(),!d&&I===3&&!p&&(p=Wa(_,rst))}}},_=function(){if(!d)if(mJ())process.emit(TRe,a,f);else{var I=ui()||Us();IRe(I,est,function(T){return Vr(T,"promise",{g:function(){return f}}),T.reason=a,T},!!dZ.v)}};f={then:m,catch:h,finally:g},wi(f,"state",{get:v}),cZ&&_Re(f,v,function(){return nP(a)},function(){return d}),gJ()&&(f[Ib(11)]="IPromise");var S=function(){return"IPromise"+(cZ?"["+u+(Pt(l)?"":":"+l)+"]":"")+" "+v()+(s?" - "+ERe(a):"")};return f.toString=S,function(){vt(r)||Qn(mE+": executor is not a function - "+ERe(r));var T=b(3,0);try{r.call(f,b(2,0),T)}catch(A){T(A)}}(),f}function hE(t){return function(e){var r=yv(arguments,1);return t(function(n,o){try{var s=[],a=1;_e(e,function(c,u){c&&(a++,yF(c,function(l){s[u]=l,--a===0&&n(s)},o))}),a--,a===0&&n(s)}catch(c){o(c)}},r)}}function gE(t){return function(e){var r=yv(arguments,1);return dv(e)?e:t(function(n){n(e)},r)}}function vE(t){return function(e){var r=yv(arguments,1);return t(function(n,o){o(e)},r)}}var TRe,est,vP,tst,rst,dZ,xF=R(()=>{St();iZ();xRe();uZ();CRe();lZ();TRe="unhandledRejection",est=TRe.toLowerCase(),vP=[],tst=0,rst=10});function RRe(t){var e=Fs(t)?t:0;return function(r){Wa(function(){nst(r)},e)}}var nst,kRe=R(()=>{St();nst=function(t){_e(t,function(e){try{e()}catch{}})}});function yE(t,e){return wRe(yE,RRe(e),t,e)}var HRr,jRr,VRr,PRe=R(()=>{xF();kRe();HRr=hE(yE),jRr=gE(yE),VRr=vE(yE)});function yP(t,e){!pZ&&(pZ=um(mE));var r=pZ.v;if(!r)return yE(t);vt(t)||Qn(mE+": executor is not a function - "+We(t));var n=0;function o(){return bF[n]}var s=new r(function(a,c){function u(d){n=2,a(d)}function l(d){n=3,c(d)}t(u,l)});return wi(s,"state",{get:o}),s}var pZ,QRr,XRr,JRr,ARe=R(()=>{PRe();xF();uZ();St();lZ();QRr=hE(yP),XRr=gE(yP),JRr=vE(yP)});function ya(t,e){return!fZ&&(fZ=jl(function(){return yP})),fZ.v.call(this,t,e)}var fZ,mZ,ist,ost,DRe=R(()=>{St();xF();ARe();mZ=hE(ya),ist=gE(ya),ost=vE(ya)});var bE=R(()=>{iZ();DRe()});var Bc,At,Pv,di,SF,bP,hm,Ob,tc,Mb,_E,Av,xE,vp,IF,CF,EF,SE,TF,wF,NRe,so=R(()=>{Bc=void 0,At="",Pv="channels",di="core",SF="createPerfMgr",bP="disabled",hm="extensionConfig",Ob="extensions",tc="processTelemetry",Mb="priority",_E="eventsSent",Av="eventsDiscarded",xE="eventsSendRequest",vp="perfEvent",IF="offlineEventsStored",CF="offlineBatchSent",EF="offlineBatchDrop",SE="getPerfMgr",TF="domain",wF="path",NRe="Not dynamic - "});function sst(t,e){return function(){var r=arguments,n=gZ(e);if(n){var o=n.listener;o&&o[t]&&o[t][xv](o,r)}}}function ast(){var t=nn("Microsoft");return t&&(kF=t.ApplicationInsights),kF}function gZ(t){var e=kF;return!e&&t.disableDbgExt!==!0&&(e=kF||ast()),e?e.ChromeDbgExt:null}function LRe(t){if(!RF){RF={};for(var e=0;e<hZ[lt];e++)RF[hZ[e]]=sst(hZ[e],t)}return RF}var hZ,kF,RF,vZ=R(()=>{St();xn();so();hZ=[_E,Av,xE,vp],kF=null});function URe(t,e){var r=!1;if(t){try{if(r=e in t,!r){var n=t[Fl];n&&(r=e in n)}}catch{}if(!r)try{var o=new t;r=!Pt(o[e])}catch{}}return r}function IZ(t){FRe=t}function Fb(t){if(t&&FRe){var e=nn("__mockLocation");if(e)return e}return typeof location===om&&location?location:nn(ust)}function _P(){return typeof console!==lp?console:nn(lst)}function yp(){return!!(typeof JSON===om&&JSON||nn(ORe)!==null)}function gs(){return yp()?JSON||nn(ORe):null}function xP(){return nn(dst)}function SP(){return nn(pst)}function Dv(){var t=io();return t&&t.product?t.product===fst:!1}function Nv(){var t=io();if(t&&(t[mP]!==bZ||yZ===null)){bZ=t[mP];var e=(bZ||At)[Qa]();yZ=Vi(e,xZ)||Vi(e,SZ)}return yZ}function IP(t){if(t===void 0&&(t=null),!t){var e=io()||{};t=e?(e.userAgent||At)[Qa]():At}var r=(t||At)[Qa]();if(Vi(r,xZ)){var n=ci()||{};return Math.max(parseInt(r[Yu](xZ)[1]),n[cst]||0)}else if(Vi(r,SZ)){var o=parseInt(r[Yu](SZ)[1]);if(o)return o+4}return null}function rc(t){return(_Z===null||t===!1)&&(_Z=tE()&&!!io().sendBeacon),_Z}function gm(t){var e=!1;try{e=!!nn("fetch");var r=nn("Request");e&&t&&r&&(e=URe(r,"keepalive"))}catch{}return e}function CP(){return IE===null&&(IE=typeof XDomainRequest!==lp,IE&&CE()&&(IE=IE&&!URe(nn(MRe),"withCredentials"))),IE}function CE(){var t=!1;try{var e=nn(MRe);t=!!e}catch{}return t}function BRe(t,e){if(t)for(var r=0;r<t[lt];r++){var n=t[r];if(n[qs]&&n[qs]===e)return n}return{}}function CZ(t){var e=ci();return e&&t?BRe(e.querySelectorAll("meta"),t).content:null}function EZ(t){var e,r=dm();if(r){var n=r.getEntriesByType("navigation")||[];e=BRe((n[lt]>0?n[0]:{}).serverTiming,t).description}return e}var cst,ust,lst,ORe,dst,pst,fst,xZ,SZ,MRe,yZ,bZ,FRe,IE,_Z,Lv=R(()=>{"use strict";Ya();St();xn();bp();so();cst="documentMode",ust="location",lst="console",ORe="JSON",dst="crypto",pst="msCrypto",fst="ReactNative",xZ="msie",SZ="trident/",MRe="XMLHttpRequest",yZ=null,bZ=null,FRe=!1,IE=null,_Z=null});function qRe(t){return t?'"'+t[$l](/\"/g,At)+'"':At}function TZ(t,e){var r=_P();if(r){var n="log";r[t]&&(n=t),vt(r[n])&&r[n](e)}}function Kl(t,e){return(t||{})[gn]||new Ov(e)}function wZ(t){return t||new Ov}function Me(t,e,r,n,o,s){s===void 0&&(s=!1),wZ(t)[fm](e,r,n,o,s)}function ba(t,e){wZ(t)[sE](e)}function RZ(t,e,r){wZ(t)[XJ](e,r)}var EE,HRe,mst,hst,gst,vst,yst,Ub,Ov,Yl=R(()=>{"use strict";Wo();St();Mv();xn();vZ();Lv();so();HRe="warnToConsole",mst="AI (Internal): ",hst="AI: ",gst="AITR_",vst={loggingLevelConsole:0,loggingLevelTelemetry:1,maxMessageLimit:25,enableDebug:!1},yst=(EE={},EE[0]=null,EE[1]="errorToConsole",EE[2]=HRe,EE[3]="debugToConsole",EE);Ub=function(){function t(e,r,n,o){n===void 0&&(n=!1);var s=this;s[lE]=e,s[gp]=(n?hst:mst)+e;var a=At;yp()&&(a=gs().stringify(o));var c=(r?" message:"+qRe(r):At)+(o?" props:"+qRe(a):At);s[gp]+=c}return t.dataType="MessageData",t}();Ov=function(){function t(e){this.identifier="DiagnosticLogger",this.queue=[];var r=0,n={},o,s,a,c,u;sr(t,this,function(l){u=p(e||{}),l.consoleLoggingLevel=function(){return o},l[fm]=function(h,g,v,y,b){b===void 0&&(b=!1);var _=new Ub(g,v,b,y);if(c)throw We(_);var S=yst[h]||HRe;if(Pt(_[gp]))m("throw"+(h===1?"Critical":"Warning"),_);else{if(b){var I=+_[lE];!n[I]&&o>=h&&(l[S](_[gp]),n[I]=!0)}else o>=h&&l[S](_[gp]);d(h,_)}},l.debugToConsole=function(h){TZ("debug",h),m("warning",h)},l[sE]=function(h){TZ("warn",h),m("warning",h)},l.errorToConsole=function(h){TZ("error",h),m("error",h)},l.resetInternalMessageCount=function(){r=0,n={}},l[XJ]=d,l[Ja]=function(h){u&&u.rm(),u=null};function d(h,g){if(!f()){var v=!0,y=gst+g[lE];if(n[y]?v=!1:n[y]=!0,v&&(h<=s&&(l.queue[lr](g),r++,m(h===1?"error":"warn",g)),r===a)){var b="Internal events throttle limit per PageView reached for this app.",_=new Ub(23,b,!1);l.queue[lr](_),h===1?l.errorToConsole(b):l[sE](b)}}}function p(h){return ao(Xn(h,vst,l).cfg,function(g){var v=g.cfg;o=v[fF],s=v.loggingLevelTelemetry,a=v.maxMessageLimit,c=v.enableDebug})}function f(){return r>=a}function m(h,g){var v=gZ(e||{});v&&v[Za]&&v[Za](h,g)}})}return t.__ieDyn=1,t}()});function _p(t){return!Ee(t)}function Bb(t){var e=t;return e&&Ft(e)&&(e=e[$l](_st,function(r,n){return n.toUpperCase()}),e=e[$l](xst,"_"),e=e[$l](Sst,function(r,n){return"_"+n})),e}function Vi(t,e){return t&&e?va(t,e)!==-1:!1}function qc(t){return t&&t.toISOString()||""}function An(t){return lv(t)?t[qs]:At}function Qu(t,e,r,n,o){var s=r;return t&&(s=t[e],s!==r&&(!o||o(s))&&(!n||n(r))&&(s=r,t[e]=s)),s}function EP(t,e,r){var n;return t?(n=t[e],!n&&Ee(n)&&(n=Pt(r)?{}:r,t[e]=n)):n=Pt(r)?{}:r,n}function VRe(t,e){var r=null,n=null;return vt(t)?r=t:n=t,function(){var o=arguments;if(r&&(n=r()),n)return n[e][xv](n,o)}}function kZ(t,e,r){if(t&&e&&Pn(t)&&Pn(e)){var n=function(s){if(Ft(s)){var a=e[s];vt(a)?(!r||r(s,!0,e,t))&&(t[s]=VRe(e,s)):(!r||r(s,!1,e,t))&&($a(t,s)&&delete t[s],Vr(t,s,{g:function(){return e[s]},s:function(c){e[s]=c}}))}};for(var o in e)n(o)}return t}function vm(t,e,r,n,o){t&&e&&r&&(o!==!1||Pt(t[e]))&&(t[e]=VRe(r,n))}function Hc(t,e,r,n){return t&&e&&Pn(t)&&st(r)&&_e(r,function(o){Ft(o)&&vm(t,o,e,o,n)}),t}function PZ(t){return function(){function e(){var r=this;t&&Ze(t,function(n,o){r[n]=o})}return e}()}function Xu(t){return t&&bb&&(t=$C(bb({},t))),t}function PF(t,e,r,n,o,s){var a=arguments,c=a[0]||{},u=a[lt],l=!1,d=1;for(u>0&&Ul(c)&&(l=c,c=a[d]||{},d++),Pn(c)||(c={});d<u;d++){var p=a[d],f=st(p),m=Pn(p);for(var h in p){var g=f&&h in p||m&&$a(p,h);if(g){var v=p[h],y=void 0;if(l&&v&&((y=st(v))||To(v))){var b=c[h];y?st(b)||(b=[]):To(b)||(b={}),v=PF(l,b,v)}v!==void 0&&(c[h]=v)}}}return c}function Ql(t){try{return t.responseText}catch{}return null}function qb(t,e){return t?"XDomainRequest,Response:"+Ql(t)||"":e}function ym(t,e){return t?"XMLHttpRequest,Status:"+t[Db]+",Response:"+Ql(t)||t.response||"":e}function bm(t,e){return e&&(Fs(e)?t=[e].concat(t):st(e)&&(t=e.concat(t))),t}function Hb(t,e){try{if(t&&t!==""){var r=gs().parse(t);if(r&&r[JJ]&&r[JJ]>=r.itemsAccepted&&r.itemsReceived-r.itemsAccepted===r.errors[lt])return r}}catch(n){Me(e,1,43,"Cannot parse the response. "+An(n),{response:t})}return null}function AZ(t,e,r,n,o,s){n===void 0&&(n=!1),o===void 0&&(o=!1);function a(u,l,d){try{u[l]=d}catch{}}var c=new XMLHttpRequest;return n&&a(c,Ist,n),r&&a(c,jRe,r),c.open(t,e,!o),r&&a(c,jRe,r),!o&&s&&a(c,Cst,s),c}function AF(t){var e={};if(Ft(t)){var r=Fr(t)[Yu](/[\r\n]+/);_e(r,function(n){if(n){var o=n.indexOf(": ");if(o!==-1){var s=Fr(n.substring(0,o))[Qa](),a=Fr(n.substring(o+1));e[s]=a}else e[Fr(n)]=1}})}return e}function TE(t,e,r){if(!t[r]&&e&&e[ZJ]){var n=e[ZJ](r);n&&(t[r]=Fr(n))}return t}function _m(t,e){var r={};return t[eZ]?r=AF(t[eZ]()):e&&(r=TE(r,t,wst),r=TE(r,t,Est),r=TE(r,t,Tst)),r}var bst,_st,xst,Sst,Nkr,Ist,jRe,Cst,Est,Tst,wst,bp=R(()=>{Ya();St();xn();Yl();Lv();so();bst="getPrototypeOf",_st=/-([a-z])/g,xst=/([^\w\d_$])/g,Sst=/^(\d+[\w\d_$])/,Nkr=Object[bst];Ist="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",jRe="withCredentials",Cst="timeout";Est="kill-duration",Tst="kill-duration-seconds",wst="time-delta-millis"});function Rst(t){t<0&&(t>>>=0),TP=zRe+t&Fv,wP=$Re-t&Fv,WRe=!0}function kst(){try{var t=li()&2147483647;Rst((Math.random()*GRe^t)+t)}catch{}}function RP(t){return t>0?Math.floor(xm()/Fv*(t+1))>>>0:0}function xm(t){var e=0,r=xP()||SP();return r&&r.getRandomValues&&(e=r.getRandomValues(new Uint32Array(1))[0]&Fv),e===0&&Nv()&&(WRe||kst(),e=KRe()&Fv),e===0&&(e=Math.floor(GRe*Math.random()|0)),t||(e>>>=0),e}function KRe(t){wP=36969*(wP&65535)+(wP>>16)&Fv,TP=18e3*(TP&65535)+(TP>>16)&Fv;var e=(wP<<16)+(TP&65535)>>>0&Fv|0;return t||(e>>>=0),e}function kP(t){t===void 0&&(t=22);for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=xm()>>>0,n=0,o=At;o[lt]<t;)n++,o+=e.charAt(r&63),r>>>=6,n===5&&(r=(xm()<<2&4294967295|r&3)>>>0,n=0);return o}var GRe,Fv,zRe,$Re,WRe,TP,wP,DF=R(()=>{St();xn();Lv();so();GRe=4294967296,Fv=4294967295,zRe=123456789,$Re=987654321,WRe=!1,TP=zRe,wP=$Re});function QRe(t){return t[hF]===1||t[hF]===9||!+t[hF]}function Dst(t,e){var r=e[t.id];if(!r){r={};try{QRe(e)&&Vr(e,t.id,{e:!1,v:r})}catch{}}return r}function vs(t,e){return e===void 0&&(e=!1),Bb(t+Ast+++(e?"."+YRe:At)+Pst)}function NF(t){var e={id:vs("_aiData-"+(t||At)+"."+YRe),accept:function(r){return QRe(r)},get:function(r,n,o,s){var a=r[e.id];return a?a[Bb(n)]:(s&&(a=Dst(e,r),a[Bb(n)]=o),o)},kill:function(r,n){if(r&&r[n])try{delete r[n]}catch{}}};return e}var YRe,Pst,Ast,wE=R(()=>{St();xn();bp();so();DF();YRe="3.0.5",Pst="."+kP(6),Ast=0});function LF(t){return t&&Pn(t)&&(t.isVal||t.fb||$a(t,"v")||$a(t,"mrg")||$a(t,"ref")||t.set)}function XRe(t,e,r){var n,o=r.dfVal||AM;if(e&&r.fb){var s=r.fb;st(s)||(s=[s]);for(var a=0;a<s[lt];a++){var c=s[a],u=e[c];if(o(u)?n=u:t&&(u=t.cfg[c],o(u)&&(n=u),t.set(t.cfg,zn(c),u)),o(n))break}}return!o(n)&&o(r.v)&&(n=r.v),n}function DZ(t,e,r){var n=r;if(r&&LF(r)&&(n=XRe(t,e,r)),n){LF(n)&&(n=DZ(t,e,n));var o;st(n)?(o=[],o[lt]=n[lt]):To(n)&&(o={}),o&&(Ze(n,function(s,a){a&&LF(a)&&(a=DZ(t,e,a)),o[s]=a}),n=o)}return n}function PP(t,e,r,n){var o,s,a,c=n,u,l,d,p;LF(c)?(o=c.isVal,s=c.set,d=c[wb],p=c[_v],u=c.mrg,l=c.ref,!l&&Pt(l)&&(l=!!u),a=XRe(t,e,c)):a=n,p&&t[_v](e,r);var f,m=!0,h=e[r];(h||!Ee(h))&&(f=h,m=!1,o&&f!==a&&!o(f)&&(f=a,m=!0),s&&(f=s(f,a,e),m=f===a)),m?a?f=DZ(t,e,a):f=a:(To(f)||st(a))&&u&&a&&(To(a)||st(a))&&Ze(a,function(g,v){PP(t,f,g,v)}),t.set(e,r,f),l&&t.ref(e,r),d&&t[wb](e,r)}var NZ=R(()=>{St();xn()});function LZ(t){if(t){var e;if(st(t)?(e=[],e[lt]=t[lt]):To(t)&&(e={}),e)return Ze(t,function(r,n){e[r]=LZ(n)}),e}return t}function AP(t){if(t){var e=t[xp]||t;if(e.cfg&&(e.cfg===t||e.cfg[xp]===e))return e}return null}function DP(t){if(t&&(To(t)||st(t)))try{t[JRe]=!0}catch{}return t}function OZ(t){if(t)try{t[ZRe]=!0}catch{}return t}function OF(t,e,r){var n=!1;return r&&!t[e.blkVal]&&(n=r[ZRe],!n&&!r[JRe]&&(n=To(r)||st(r))),n}function MF(t){Qn("InvalidAccess:"+t)}var xp,JRe,ZRe,FF=R(()=>{St();xn();xp=uP("[[ai_dynCfg_1]]"),JRe=uP("[[ai_blkDynCfg_1]]"),ZRe=uP("[[ai_frcDynCfg_1]]")});function Lst(t,e,r){st(e)&&_e(Nst,function(n){var o=e[n];e[n]=function(){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];var c=o[xv](this,s);return NP(t,e,r,"Patching"),c}})}function UF(t,e){var r=yb(t,e);return r&&r.get}function Ost(t,e,r,n){var o={n:r,h:[],trk:function(l){l&&l.fn&&(Pr(o.h,l)===-1&&o.h[lr](l),t.trk(l,o))},clr:function(l){var d=Pr(o.h,l);d!==-1&&o.h[fp](d,1)}},s=!0,a=!1;function c(){s&&(a=a||OF(c,t,n),n&&!n[xp]&&a&&(n=NP(t,n,r,"Converting")),s=!1);var l=t.act;return l&&o.trk(l),n}c[t.prop]={chng:function(){t.add(o)}};function u(l){if(n!==l){c[t.ro]&&!t.upd&&MF("["+r+"] is read-only:"+We(e)),s&&(a=a||OF(c,t,n),s=!1);var d=a&&c[t.rf];if(a)if(d){Ze(n,function(f){n[f]=l?l[f]:Bc});try{Ze(l,function(f,m){LP(t,n,f,m)}),l=n}catch(f){RE((t.hdlr||{})[gn],r,"Assigning",f),a=!1}}else n&&n[xp]&&Ze(n,function(f){var m=UF(n,f);if(m){var h=m[t.prop];h&&h.chng()}});if(l!==n){var p=l&&OF(c,t,l);!d&&p&&(l=NP(t,l,r,"Converting")),n=l,a=p}t.add(o)}}Vr(e,o.n,{g:c,s:u})}function LP(t,e,r,n){if(e){var o=UF(e,r),s=o&&!!o[t.prop];s?e[r]=n:Ost(t,e,r,n)}return e}function BF(t,e,r,n){if(e){var o=UF(e,r),s=o&&!!o[t.prop],a=n&&n[0],c=n&&n[1],u=n&&n[2];if(!s){if(u)try{DP(e)}catch(l){RE((t.hdlr||{})[gn],r,"Blocking",l)}try{LP(t,e,r,e[r]),o=UF(e,r)}catch(l){RE((t.hdlr||{})[gn],r,"State",l)}}a&&(o[t.rf]=a),c&&(o[t.ro]=c),u&&(o[t.blkVal]=!0)}return e}function NP(t,e,r,n){try{Ze(e,function(o,s){LP(t,e,o,s)}),e[xp]||(wi(e,xp,{get:function(){return t[dF]}}),Lst(t,e,r))}catch(o){RE((t.hdlr||{})[gn],r,n,o)}return e}var Nst,RE,eke=R(()=>{St();so();xn();FF();Nst=["push","pop","shift","unshift","splice"],RE=function(t,e,r,n){t&&t[fm](3,108,"".concat(r," [").concat(e,"] failed - ")+We(n))}});function tke(t){var e,r=Cb(OP+"get"+t.uid+MP),n=Cb(OP+"ro"+t.uid+MP),o=Cb(OP+"rf"+t.uid+MP),s=Cb(OP+"blkVal"+t.uid+MP),a=Cb(OP+"dtl"+t.uid+MP),c=null,u=null,l;function d(h,g){var v=l.act;try{l.act=h,h&&h[a]&&(_e(h[a],function(b){b.clr(h)}),h[a]=[]),g({cfg:t.cfg,set:t.set.bind(t),setDf:t[Gl].bind(t),ref:t.ref.bind(t),rdOnly:t[wb].bind(t)})}catch(b){var y=t[gn];throw y&&y[fm](1,107,We(b)),b}finally{l.act=v||null}}function p(){if(c){var h=c;c=null,u&&u[kb](),u=null;var g=[];if(_e(h,function(v){if(v&&(v[a]&&(_e(v[a],function(y){y.clr(v)}),v[a]=null),v.fn))try{d(v,v.fn)}catch(y){g[lr](y)}}),c)try{p()}catch(v){g[lr](v)}g[lt]>0&&vRe("Watcher error(s): ",g)}}function f(h){if(h&&h.h[lt]>0){c||(c=[]),u||(u=Wa(function(){u=null,p()},0));for(var g=0;g<h.h[lt];g++){var v=h.h[g];v&&Pr(c,v)===-1&&c[lr](v)}}}function m(h,g){if(h){var v=h[a]=h[a]||[];Pr(v,g)===-1&&v[lr](g)}}return l=(e={prop:r,ro:n,rf:o},e[_v]=s,e[dF]=t,e.add=f,e[Rb]=p,e.use=d,e.trk=m,e),l}var OP,MP,rke=R(()=>{St();yRe();xn();OP="[[ai_",MP="]]"});function Mst(t,e){var r={fn:e,rm:function(){r.fn=null,t=null,e=null}};return t.use(r,e),r}function Fst(t,e,r){var n,o=AP(e);if(o)return o;var s=vs("dyncfg",!0),a=e&&r!==!1?e:LZ(e),c;function u(){c[Rb]()}function l(y,b,_){try{y=LP(c,y,b,_)}catch(S){RE(t,b,"Setting value",S)}return y[b]}function d(y){return Mst(c,y)}function p(y,b){c.use(null,function(_){var S=c.upd;try{Pt(b)||(c.upd=b),y(_)}finally{c.upd=S}})}function f(y,b){var _;return BF(c,y,b,(_={},_[0]=!0,_))[b]}function m(y,b){var _;return BF(c,y,b,(_={},_[1]=!0,_))[b]}function h(y,b){var _;return BF(c,y,b,(_={},_[2]=!0,_))[b]}function g(y,b){return b&&Ze(b,function(_,S){PP(v,y,_,S)}),y}var v=(n={uid:null,cfg:a},n[gn]=t,n[Rb]=u,n.set=l,n[Gl]=g,n[Ku]=d,n.ref=f,n[wb]=m,n[_v]=h,n._block=p,n);return Vr(v,"uid",{c:!1,e:!1,w:!1,v:s}),c=tke(v),NP(c,a,"config","Creating"),v}function Ust(t,e){t?(t[sE](e),t[fm](2,108,e)):MF(e)}function Xn(t,e,r,n){var o=Fst(r,t||{},n);return e&&o[Gl](o.cfg,e),o}function ao(t,e,r){var n=t[xp]||t;return n.cfg&&(n.cfg===t||n.cfg[xp]===n)?n[Ku](e):(Ust(r,NRe+We(t)),Xn(t,null,r)[Ku](e))}var Mv=R(()=>{St();wE();so();xn();NZ();eke();rke();FF()});function Sm(t,e){if(t&&t[Ja])return t[Ja](e)}function qF(t,e,r){var n;return r||(n=ya(function(o){r=o})),t&&nE(t)>0?kv(Sm(t[0],e),function(){qF(yv(t,1),e,r)}):r(),n}var MZ=R(()=>{bE();St();xn()});var nke,FZ,UZ=R(()=>{nke=500,FZ="Microsoft_ApplicationInsights_BypassAjaxInstrumentation"});function Bst(t,e,r){return!t&&Ee(t)?e:Ul(t)?t:zn(t)[Qa]()==="true"}function BZ(t){return{mrg:!0,v:t}}function kE(t,e,r){return{fb:r,isVal:t,v:e}}function Ju(t,e){return{fb:e,set:Bst,v:!!t}}var qZ=R(()=>{St();xn()});function $Z(){!Sp&&(Sp=jl(function(){return ci()}))}function Hst(t,e){var r=Im[Uv]||VF[Uv];return r||(r=Im[Uv]=Im(t,e),VF[Uv]=r),r}function jF(t){return t?t.isEnabled():!0}function fke(t,e){return e&&t&&st(t.ignoreCookies)?Pr(t.ignoreCookies,e)!==-1:!1}function jst(t,e){return e&&t&&st(t.blockedCookies)&&Pr(t.blockedCookies,e)!==-1?!0:fke(t,e)}function uke(t,e){var r=e[Cv];if(Ee(r)){var n=void 0;Pt(t[ske])||(n=!t[ske]),Pt(t[GZ])||(n=!t[GZ]),r=n}return r}function WZ(t,e){var r;if(t)r=t.getCookieMgr();else if(e){var n=e.cookieCfg;n&&n[Uv]?r=n[Uv]:r=Im(e)}return r||(r=Hst(e,(t||{})[gn])),r}function Im(t,e){var r,n,o,s,a,c,u,l,d;t=Xn(t||VF,null,e).cfg,a=ao(t,function(f){f[Gl](f.cfg,qst),n=f.ref(f.cfg,"cookieCfg"),o=n[wF]||"/",s=n[TF],c=uke(t,n)!==!1,u=n.getCookie||Vst,l=n.setCookie||pke,d=n.delCookie||pke},e);var p=(r={isEnabled:function(){var f=uke(t,n)!==!1&&c&&PE(e),m=VF[Uv];return f&&m&&p!==m&&(f=jF(m)),f},setEnabled:function(f){c=f!==!1,n[Cv]=f},set:function(f,m,h,g,v){var y=!1;if(jF(p)&&!jst(n,f)){var b={},_=Fr(m||At),S=va(_,";");if(S!==-1&&(_=Fr(hv(m,S)),b=mke(Ti(m,S+1))),Qu(b,TF,g||s,ju,Pt),!Ee(h)){var I=Nv();if(Pt(b[jZ])){var T=li(),A=T+h*1e3;if(A>0){var B=new Date;B.setTime(A),Qu(b,jZ,lke(B,I?ike:oke)||lke(B,I?ike:oke)||At,ju)}}I||Qu(b,"max-age",At+h,null,Pt)}var j=Fb();j&&j[mF]==="https:"&&(Qu(b,"secure",null,null,Pt),VZ===null&&(VZ=!GF((io()||{})[mP])),VZ&&Qu(b,"SameSite","None",null,Pt)),Qu(b,wF,v||o,null,Pt),l(f,dke(_,b)),y=!0}return y},get:function(f){var m=At;return jF(p)&&!fke(n,f)&&(m=u(f)),m},del:function(f,m){var h=!1;return jF(p)&&(h=p.purge(f,m)),h},purge:function(f,m){var h,g=!1;if(PE(e)){var v=(h={},h[wF]=m||"/",h[jZ]="Thu, 01 Jan 1970 00:00:01 GMT",h);Nv()||(v["max-age"]="0"),d(f,dke(At,v)),g=!0}return g}},r[Ja]=function(f){a&&a.rm(),a=null},r);return p[Uv]=p,p}function PE(t){if(HF===null){HF=!1,!Sp&&$Z();try{var e=Sp.v||{};HF=e[zZ]!==void 0}catch(r){Me(t,2,68,"Cannot access document.cookie - "+An(r),{exception:We(r)})}}return HF}function mke(t){var e={};if(t&&t[lt]){var r=Fr(t)[Yu](";");_e(r,function(n){if(n=Fr(n||At),n){var o=va(n,"=");o===-1?e[n]=null:e[Fr(hv(n,o))]=Fr(Ti(n,o+1))}})}return e}function lke(t,e){return vt(t[e])?t[e]():null}function dke(t,e){var r=t||At;return Ze(e,function(n,o){r+="; "+n+(Ee(o)?At:"="+o)}),r}function Vst(t){var e=At;if(!Sp&&$Z(),Sp.v){var r=Sp.v[zZ]||At;ake!==r&&(cke=mke(r),ake=r),e=Fr(cke[t]||At)}return e}function pke(t,e){!Sp&&$Z(),Sp.v&&(Sp.v[zZ]=t+"="+e)}function GF(t){return Ft(t)?!!(Vi(t,"CPU iPhone OS 12")||Vi(t,"iPad; CPU OS 12")||Vi(t,"Macintosh; Intel Mac OS X 10_14")&&Vi(t,"Version/")&&Vi(t,"Safari")||Vi(t,"Macintosh; Intel Mac OS X 10_14")&&bv(t,"AppleWebKit/605.1.15 (KHTML, like Gecko)")||Vi(t,"Chrome/5")||Vi(t,"Chrome/6")||Vi(t,"UnrealEngine")&&!Vi(t,"Chrome")||Vi(t,"UCBrowser/12")||Vi(t,"UCBrowser/11")):!1}var HZ,jb,ike,oke,zZ,jZ,ske,GZ,Uv,HF,VZ,ake,Sp,cke,VF,qst,KZ=R(()=>{St();qZ();Mv();xn();Yl();Lv();bp();so();ike="toGMTString",oke="toUTCString",zZ="cookie",jZ="expires",ske="isCookieUseDisabled",GZ="disableCookiesUsage",Uv="_ckMgr",HF=null,VZ=null,ake=null,cke={},VF={},qst=(HZ={cookieCfg:BZ((jb={},jb[TF]={fb:"cookieDomain",dfVal:_p},jb.path={fb:"cookiePath",dfVal:_p},jb.enabled=Bc,jb.ignoreCookies=Bc,jb.blockedCookies=Bc,jb)),cookieDomain:Bc,cookiePath:Bc},HZ[GZ]=Bc,HZ)});function Bv(t,e,r,n){_e(t,function(o){if(o&&o[e])if(r)Wa(function(){return n(o)},0);else try{n(o)}catch{}})}var Gst,FP,YZ=R(()=>{Wo();bE();St();Mv();xn();so();Gst={perfEvtsSendAll:!1};FP=function(){function t(e){this.listeners=[];var r,n,o=[],s=Xn(e,Gst);n=s[Ku](function(a){r=!!a.cfg.perfEvtsSendAll}),sr(t,this,function(a){Vr(a,"listeners",{g:function(){return o}}),a[cE]=function(c){o[lr](c)},a[uE]=function(c){for(var u=Pr(o,c);u>-1;)o[fp](u,1),u=Pr(o,c)},a[_E]=function(c){Bv(o,_E,!0,function(u){u[_E](c)})},a[Av]=function(c,u){Bv(o,Av,!0,function(l){l[Av](c,u)})},a[xE]=function(c,u){Bv(o,xE,u,function(l){l[xE](c,u)})},a[vp]=function(c){c&&(r||!c[gP]())&&Bv(o,vp,!1,function(u){c[zl]?Wa(function(){return u[vp](c)},0):u[vp](c)})},a[IF]=function(c){c&&c[lt]&&Bv(o,IF,!0,function(u){u[IF](c)})},a[CF]=function(c){c&&c[wv]&&Bv(o,CF,!0,function(u){u[CF](c)})},a[EF]=function(c,u){if(c>0){var l=u||0;Bv(o,EF,!0,function(d){d[EF](c,l)})}},a[Ja]=function(c){var u=function(){n&&n.rm(),n=null,o=[]},l;if(Bv(o,"unload",!1,function(d){var p=d[Ja](c);p&&(l||(l=[]),l[lr](p))}),l)return ya(function(d){return kv(mZ(l),function(){u(),d()})});u()}})}return t.__ieDyn=1,t}()});function ki(t,e,r,n,o){if(t){var s=t;if(s[SE]&&(s=s[SE]()),s){var a=void 0,c=s[Nb](QZ);try{if(a=s.create(e(),n,o),a){if(c&&a[Wl]&&(a[Wl](Vb[XZ],c),c[Nb]&&c[Wl])){var u=c[Nb](Vb[UP]);u||(u=[],c[Wl](Vb[UP],u)),u[lr](a)}return s[Wl](QZ,a),r(a)}}catch(l){a&&a[Wl]&&a[Wl]("exception",l)}finally{a&&s.fire(a),s[Wl](QZ,c)}}}return r()}function JZ(){return zst}var AE,XZ,UP,zst,Vb,BP,QZ,zF=R(()=>{Wo();St();xn();so();AE="ctx",XZ="ParentContextKey",UP="ChildrenContextKey",zst=null,Vb=function(){function t(e,r,n){var o=this;if(o.start=li(),o[qs]=e,o[zl]=n,o[gP]=function(){return!1},vt(r)){var s;Vr(o,"payload",{g:function(){return!s&&vt(r)&&(s=r(),r=null),s}})}o[Nb]=function(a){return a?a===t[XZ]||a===t[UP]?o[a]:(o[AE]||{})[a]:null},o[Wl]=function(a,c){if(a)if(a===t[XZ])o[a]||(o[gP]=function(){return!0}),o[a]=c;else if(a===t[UP])o[a]=c;else{var u=o[AE]=o[AE]||{};u[a]=c}},o[gF]=function(){var a=0,c=o[Nb](t[UP]);if(st(c))for(var u=0;u<c[lt];u++){var l=c[u];l&&(a+=l[Iv])}o[Iv]=li()-o.start,o.exTime=o[Iv]-a,o[gF]=function(){}}}return t.ParentContextKey="parent",t.ChildrenContextKey="childEvts",t}(),BP=function(){function t(e){this.ctx={},sr(t,this,function(r){r.create=function(n,o,s){return new Vb(n,o,s)},r.fire=function(n){n&&(n[gF](),e&&vt(e[vp])&&e[vp](n))},r[Wl]=function(n,o){if(n){var s=r[AE]=r[AE]||{};s[n]=o}},r[Nb]=function(n){return(r[AE]||{})[n]}})}return t.__ieDyn=1,t}(),QZ="CoreUtils.doPerf"});function qP(){var t=Gb();return Ti(t,0,8)+"-"+Ti(t,8,12)+"-"+Ti(t,12,16)+"-"+Ti(t,16,20)+"-"+Ti(t,20)}function Gb(){for(var t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],e=At,r,n=0;n<4;n++)r=xm(),e+=t[r&15]+t[r>>4&15]+t[r>>8&15]+t[r>>12&15]+t[r>>16&15]+t[r>>20&15]+t[r>>24&15]+t[r>>28&15];var o=t[8+(xm()&3)|0];return ql(e,0,8)+ql(e,9,4)+"4"+ql(e,13,3)+o+ql(e,16,3)+ql(e,19,12)}var ZZ=R(()=>{"use strict";St();so();DF()});function Cm(t,e,r){return t&&t[lt]===e&&t!==r?!!t.match(/^[\da-f]*$/i):!1}function gke(t,e,r){return Cm(t,e)?t:r}function vke(t){(isNaN(t)||t<0||t>255)&&(t=1);for(var e=t.toString(16);e[lt]<2;)e="0"+e;return e}function HP(t,e,r,n){var o;return o={},o[Pb]=Cm(n,2,tee)?n:eee,o[pE]=Ip(t)?t:Gb(),o[fE]=Cp(e)?e:hv(Gb(),16),o.traceFlags=r>=0&&r<=255?r:1,o}function zb(t,e){var r;if(!t||(st(t)&&(t=t[0]||""),!t||!Ft(t)||t[lt]>8192))return null;if(t.indexOf(",")!==-1){var n=t[Yu](",");t=n[e>0&&n[lt]>e?e:0]}var o=$st.exec(Fr(t));return!o||o[1]===tee||o[2]===$F||o[3]===WF?null:(r={version:(o[1]||At)[Qa](),traceId:(o[2]||At)[Qa](),spanId:(o[3]||At)[Qa]()},r[Rv]=parseInt(o[4],16),r)}function Ip(t){return Cm(t,32,$F)}function Cp(t){return Cm(t,16,WF)}function DE(t){return!(!t||!Cm(t[Pb],2,tee)||!Cm(t[pE],32,$F)||!Cm(t[fE],16,WF)||!Cm(vke(t[Rv]),2))}function jP(t){return DE(t)?(t[Rv]&hke)===hke:!1}function VP(t){if(t){var e=vke(t[Rv]);Cm(e,2)||(e="01");var r=t[Pb]||eee;return r!=="00"&&r!=="ff"&&(r=eee),"".concat(r.toLowerCase(),"-").concat(gke(t.traceId,32,$F).toLowerCase(),"-").concat(gke(t.spanId,16,WF).toLowerCase(),"-").concat(e.toLowerCase())}return""}function GP(t){var e="traceparent",r=zb(CZ(e),t);return r||(r=zb(EZ(e),t)),r}var $st,eee,tee,$F,WF,hke,ree=R(()=>{St();xn();ZZ();Lv();so();$st=/^([\da-f]{2})-([\da-f]{32})-([\da-f]{16})-([\da-f]{2})(-[^\s]{1,64})?$/i,eee="00",tee="ff",$F="00000000000000000000000000000000",WF="0000000000000000",hke=1});function Em(t){return Wst.get(t,"state",{},!0)}function nee(t,e){for(var r=[],n=null,o=t[Uc](),s;o;){var a=o[Sv]();if(a){n&&n[Tv]&&a[tc]&&n[Tv](a),s=Em(a);var c=!!s[Xa];a[Xa]&&(c=a[Xa]()),c||r[lr](a),n=a,o=o[Uc]()}}_e(r,function(u){var l=t[di]();u[mm](t.getCfg(),l,e,t[Uc]()),s=Em(u),!u[di]&&!s[di]&&(s[di]=l),s[Xa]=!0,delete s[Fc]})}function KF(t){return t.sort(function(e,r){var n=0;if(r){var o=r[tc];e[tc]?n=o?e[Mb]-r[Mb]:1:o&&(n=-1)}else n=e?1:-1;return n})}function yke(t){var e={};return{getName:function(){return e[qs]},setName:function(r){t&&t.setName(r),e[qs]=r},getTraceId:function(){return e[pE]},setTraceId:function(r){t&&t.setTraceId(r),Ip(r)&&(e[pE]=r)},getSpanId:function(){return e[fE]},setSpanId:function(r){t&&t.setSpanId(r),Cp(r)&&(e[fE]=r)},getTraceFlags:function(){return e[Rv]},setTraceFlags:function(r){t&&t.setTraceFlags(r),e[Rv]=r}}}var Wst,iee=R(()=>{"use strict";St();xn();wE();so();ree();Wst=NF("plugin")});function Yst(t,e,r){for(;t;){if(t[Sv]()===r)return t;t=t[Uc]()}return qv([r],e.config||{},e)}function oee(t,e,r,n){var o=null,s=[];e||(e=Xn({},null,r[gn])),n!==null&&(o=n?Yst(t,r,n):t);var a={_next:u,ctx:{core:function(){return r},diagLog:function(){return Kl(r,e.cfg)},getCfg:function(){return e.cfg},getExtCfg:d,getConfig:p,hasNext:function(){return!!o},getNext:function(){return o},setNext:function(m){o=m},iterate:f,onComplete:c}};function c(m,h){for(var g=[],v=2;v<arguments.length;v++)g[v-2]=arguments[v];m&&s[lr]({func:m,self:Pt(h)?a.ctx:h,args:g})}function u(){var m=o;if(o=m?m[Uc]():null,!m){var h=s;h&&h[lt]>0&&(_e(h,function(g){try{g.func.call(g.self,g.args)}catch(v){Me(r[gn],2,73,"Unexpected Exception during onComplete - "+We(v))}}),s=[])}return m}function l(m,h){var g=null,v=e.cfg;if(v&&m){var y=v[hm];!y&&h&&(y={}),v[hm]=y,y=e.ref(v,hm),y&&(g=y[m],!g&&h&&(g={}),y[m]=g,g=e.ref(y,m))}return g}function d(m,h){var g=l(m,!0);return h&&Ze(h,function(v,y){if(Ee(g[v])){var b=e.cfg[v];(b||!Ee(b))&&(g[v]=b)}PP(e,g,v,y)}),e[Gl](g,h)}function p(m,h,g){g===void 0&&(g=!1);var v,y=l(m,!1),b=e.cfg;return y&&(y[h]||!Ee(y[h]))?v=y[h]:(b[h]||!Ee(b[h]))&&(v=b[h]),v||!Ee(v)?v:g}function f(m){for(var h;h=a._next();){var g=h[Sv]();g&&m(g)}}return a}function _a(t,e,r,n){var o=Xn(e),s=oee(t,o,r,n),a=s.ctx;function c(l){var d=s._next();return d&&d[tc](l,a),!d}function u(l,d){return l===void 0&&(l=null),st(l)&&(l=qv(l,o.cfg,r,d)),_a(l||a[Uc](),o.cfg,r,d)}return a[wo]=c,a[hp]=u,a}function NE(t,e,r){var n=Xn(e.config),o=oee(t,n,e,r),s=o.ctx;function a(u){var l=o._next();return l&&l[Ja](s,u),!l}function c(u,l){return u===void 0&&(u=null),st(u)&&(u=qv(u,n.cfg,e,l)),NE(u||s[Uc](),e,l)}return s[wo]=a,s[hp]=c,s}function zP(t,e,r){var n=Xn(e.config),o=oee(t,n,e,r),s=o.ctx;function a(u){return s.iterate(function(l){vt(l[Ab])&&l[Ab](s,u)})}function c(u,l){return u===void 0&&(u=null),st(u)&&(u=qv(u,n.cfg,e,l)),zP(u||s[Uc](),e,l)}return s[wo]=a,s[hp]=c,s}function qv(t,e,r,n){var o=null,s=!n;if(st(t)&&t[lt]>0){var a=null;_e(t,function(c){if(!s&&n===c&&(s=!0),s&&c&&vt(c[tc])){var u=Qst(c,e,r);o||(o=u),a&&a._setNext(u),a=u}})}return n&&!o?qv([n],e,r):o}function Qst(t,e,r){var n=null,o=vt(t[tc]),s=vt(t[Tv]),a;t?a=t[mp]+"-"+t[Mb]+"-"+xke++:a="Unknown-0-"+xke++;var c={getPlugin:function(){return t},getNext:function(){return n},processTelemetry:d,unload:p,update:f,_id:a,_setNext:function(m){n=m}};function u(){var m;return t&&vt(t[_ke])&&(m=t[_ke]()),m||(m=_a(c,e,r)),m}function l(m,h,g,v,y){var b=!1,_=t?t[mp]:Kst,S=m[bke];return S||(S=m[bke]={}),m.setNext(n),t&&ki(m[di](),function(){return _+":"+g},function(){S[a]=!0;try{var I=n?n._id:At;I&&(S[I]=!1),b=h(m)}catch(A){var T=n?S[n._id]:!0;T&&(b=!0),(!n||!T)&&Me(m[Za](),1,73,"Plugin ["+_+"] failed during "+g+" - "+We(A)+", run flags: "+We(S))}},v,y),b}function d(m,h){h=h||u();function g(v){if(!t||!o)return!1;var y=Em(t);return y[Fc]||y[bP]?!1:(s&&t[Tv](n),t[tc](m,v),!0)}l(h,g,"processTelemetry",function(){return{item:m}},!m.sync)||h[wo](m)}function p(m,h){function g(){var v=!1;if(t){var y=Em(t),b=t[di]||y[di];t&&(!b||b===m.core())&&!y[Fc]&&(y[di]=null,y[Fc]=!0,y[Xa]=!1,t[Fc]&&t[Fc](m,h)===!0&&(v=!0))}return v}l(m,g,"unload",function(){},h[zl])||m[wo](h)}function f(m,h){function g(){var v=!1;if(t){var y=Em(t),b=t[di]||y[di];t&&(!b||b===m.core())&&!y[Fc]&&t[Ab]&&t[Ab](m,h)===!0&&(v=!0)}return v}l(m,g,"update",function(){},!1)||m[wo](h)}return dp(c)}var Kst,bke,_ke,xke,see,YF=R(()=>{"use strict";St();NZ();Mv();xn();Yl();bp();so();zF();iee();Kst="TelemetryPluginChain",bke="_hasRun",_ke="_getTelCtx",xke=0;see=function(){function t(e,r,n,o){var s=this,a=_a(e,r,n,o);Hc(s,a,Eo(a))}return t}()});function $b(){var t=[];function e(n){n&&t[lr](n)}function r(n,o){_e(t,function(s){try{s(n,o)}catch(a){Me(n[Za](),2,73,"Unexpected error calling unload handler - "+We(a))}}),t=[]}return{add:e,run:r}}var QF=R(()=>{St();xn();Yl()});function XF(){var t=[];function e(n){var o=t;t=[],_e(o,function(s){try{(s.rm||s.remove).call(s)}catch(a){Me(n,2,73,"Unloading:"+We(a))}})}function r(n){n&&zu(t,n)}return{run:e,add:r}}var aee=R(()=>{St();Yl()});var cee,Hv,Xst,Tm,uee=R(()=>{"use strict";Wo();St();Mv();xn();Yl();bp();so();YF();QF();aee();Hv="getPlugin",Xst=(cee={},cee[hm]={isVal:_p,v:{}},cee),Tm=function(){function t(){var e=this,r,n,o,s,a;l(),sr(t,e,function(d){d[mm]=function(p,f,m,h){u(p,f,h),r=!0},d[Fc]=function(p,f){var m,h=d[di];if(!h||p&&h!==p[di]())return;var g,v=!1,y=p||NE(null,h,o&&o[Hv]?o[Hv]():o),b=f||(m={reason:0},m[zl]=!1,m);function _(){v||(v=!0,s.run(y,f),a.run(y[Za]()),g===!0&&y[wo](b),l())}return!d[Ev]||d[Ev](y,b,_)!==!0?_():g=!0,g},d[Ab]=function(p,f){var m=d[di];if(!m||p&&m!==p[di]())return;var h,g=!1,v=p||zP(null,m,o&&o[Hv]?o[Hv]():o),y=f||{reason:0};function b(){g||(g=!0,u(v.getCfg(),v.core(),v[Uc]()))}return!d._doUpdate||d._doUpdate(v,y,b)!==!0?b():h=!0,h},vm(d,"_addUnloadCb",function(){return s},"add"),vm(d,"_addHook",function(){return a},"add"),Vr(d,"_unloadHooks",{g:function(){return a}})}),e[Za]=function(d){return c(d)[Za]()},e[Xa]=function(){return r},e.setInitialized=function(d){r=d},e[Tv]=function(d){o=d},e[wo]=function(d,p){p?p[wo](d):o&&vt(o[tc])&&o[tc](d,null)},e._getTelCtx=c;function c(d){d===void 0&&(d=null);var p=d;if(!p){var f=n||_a(null,{},e[di]);o&&o[Hv]?p=f[hp](null,o[Hv]):p=f[hp](null,o)}return p}function u(d,p,f){Xn(d,Xst,Kl(p)),!f&&p&&(f=p[pF]()[Uc]());var m=o;o&&o[Hv]&&(m=o[Hv]()),e[di]=p,n=_a(f,d,p,m)}function l(){r=!1,e[di]=null,n=null,o=null,a=XF(),s=$b()}}return t.__ieDyn=1,t}()});function Jst(t,e,r){var n={id:e,fn:r};zu(t,n);var o={remove:function(){_e(t,function(s,a){if(s.id===n.id)return t[fp](a,1),-1})}};return o}function Zst(t,e,r){for(var n=!1,o=t[lt],s=0;s<o;++s){var a=t[s];if(a)try{if(a.fn[xv](null,[e])===!1){n=!0;break}}catch(c){Me(r,2,64,"Telemetry initializer failed: "+An(c),{exception:We(c)},!0)}}return!n}var Ske,Ike=R(()=>{Ya();Wo();St();xn();uee();Yl();bp();so();Ske=function(t){Ka(e,t);function e(){var r=t.call(this)||this;r.identifier="TelemetryInitializerPlugin",r.priority=199;var n,o;s(),sr(e,r,function(a,c){a.addTelemetryInitializer=function(u){return Jst(o,n++,u)},a[tc]=function(u,l){Zst(o,u,l?l[Za]():a[Za]())&&a[wo](u,l)},a[Ev]=function(){s()}});function s(){n=0,o=[]}return r}return e.__ieDyn=1,e}(Tm)});function rat(t,e){return new BP(e)}function nat(t,e,r){var n,o=[],s=[],a={};return _e(r,function(c){(Ee(c)||Ee(c[mm]))&&ai(wke);var u=c[Mb],l=c[mp];c&&u&&(Ee(a[u])?a[u]=l:ba(t,"Two extensions have same priority #"+u+" - "+a[u]+", "+l)),!u||u<e?o[lr](c):s[lr](c)}),n={},n[di]=o,n[Pv]=s,n}function Eke(t,e){var r=!1;return _e(e,function(n){if(n===t)return r=!0,-1}),r}function dee(t,e,r,n){r&&Ze(r,function(o,s){n&&To(s)&&To(e[o])&&dee(t,e[o],s,n),n&&To(s)&&To(e[o])?dee(t,e[o],s,n):t.set(e,o,s)})}function Tke(t,e){var r=null,n=-1;return _e(t,function(o,s){if(o.w===e)return r=o,n=s,-1}),{i:n,l:r}}function iat(t,e){var r=Tke(t,e).l;return r||(r={w:e,rm:function(){var n=Tke(t,e);n.i!==-1&&t[fp](n.i,1)}},t[lr](r)),r}function oat(t,e,r){_e(e,function(n){var o=ao(t,n.w,r);delete n.w,n.rm=function(){o.rm()}})}var jv,wke,eat,Cke,tat,lee,wm,Rke=R(()=>{"use strict";Ya();Wo();bE();St();Mv();xn();MZ();UZ();KZ();wE();vZ();Yl();bp();so();YZ();zF();YF();iee();Ike();QF();aee();wke="Plugins must provide initialize method",eat="_notificationManager",Cke="SDK is still unloading...",tat="SDK is not initialized",lee=ga((jv={cookieCfg:{}},jv[Ob]={rdOnly:!0,ref:!0,v:[]},jv[Pv]={rdOnly:!0,ref:!0,v:[]},jv[hm]={ref:!0,v:{}},jv[SF]=Bc,jv.loggingLevelConsole=0,jv.diagnosticLogInterval=Bc,jv));wm=function(){function t(){var e,r,n,o,s,a,c,u,l,d,p,f,m,h,g,v,y,b,_,S,I,T,A,B,j,F,ne,Y;sr(t,this,function(N){q(),N._getDbgPlgTargets=function(){return[A]},N[Xa]=function(){return r},N[mm]=function(H,de,he,ke){m&&ai(Cke),N[Xa]()&&ai("Core cannot be initialized more than once"),e=Xn(H,lee,he||N[gn],!1),H=e.cfg,ct(e[Ku](function(It){I=It.cfg.instrumentationKey;var on=It.ref(It.cfg,hm);Ze(on,function(Dn){It.ref(on,Dn)}),Ee(I)&&ai("Please provide instrumentation key")})),s=ke,yt(),Ye(),N[gn]=he;var Ie=H[Ob];if(d=[],d[lr].apply(d,eF(eF([],de,!1),Ie,!1)),p=H[Pv],Z(null),(!f||f[lt]===0)&&ai("No "+Pv+" available"),p&&p[lt]>1){var ut=N[Sv]("TeeChannelController");(!ut||!ut.plugin)&&Me(n,1,28,"TeeChannel required")}oat(H,T,n),T=null,r=!0,N.releaseQueue(),N[YJ]()},N.getChannels=function(){var H=[];return f&&_e(f,function(de){H[lr](de)}),dp(H)},N.track=function(H){ki(N[SE](),function(){return"AppInsightsCore:track"},function(){H===null&&(be(H),ai("Invalid telemetry item")),!H[qs]&&Ee(H[qs])&&(be(H),ai("telemetry name required")),H.iKey=H.iKey||I,H[Iv]=H[Iv]||qc(new Date),H.ver=H.ver||"4.0",!m&&N[Xa]()?U()[wo](H):o[lr](H)},function(){return{item:H}},!H.sync)},N[pF]=U,N[aE]=function(){return s||(s=new FP(e.cfg),N[eat]=s),s},N[cE]=function(H){N[aE]()[cE](H)},N[uE]=function(H){s&&s[uE](H)},N.getCookieMgr=function(){return u||(u=Im(e.cfg,N[gn])),u},N.setCookieMgr=function(H){u!==H&&(Sm(u,!1),u=H)},N[SE]=function(){return!a&&!c&&ct(e[Ku](function(H){if(H.cfg.enablePerfMgr){var de=H.cfg[SF];vt(de)&&(c=de(N,N[aE]()))}})),a||c||JZ()},N.setPerfMgr=function(H){a=H},N.eventCnt=function(){return o[lt]},N.releaseQueue=function(){if(r&&o[lt]>0){var H=o;o=[],_e(H,function(de){U()[wo](de)})}},N[YJ]=function(H){return g=H||null,Y=!1,F&&F[kb](),w(!0)};function w(H){if((!F||!F[Cv])&&!Y){var de=H||n&&n.queue[lt]>0;de&&(ne||(ne=!0,ct(e[Ku](function(he){var ke=he.cfg.diagnosticLogInterval;(!ke||!(ke>0))&&(ke=1e4);var Ie=!1;F&&(Ie=F[Cv],F[kb]()),F=LJ(Ve,ke),F.unref(),F[Cv]=Ie}))),F[Cv]=!0)}return F}N[QJ]=function(){Y=!0,F&&F[kb](),Ve()},Hc(N,function(){return h},["addTelemetryInitializer"]),N[Ja]=function(H,de,he){var ke;H===void 0&&(H=!0),r||ai(tat),m&&ai(Cke);var Ie=(ke={reason:50},ke[zl]=H,ke.flushComplete=!1,ke),ut;H&&!de&&(ut=ya(function(Dn){de=Dn}));var It=NE(re(),N);It[fP](function(){b.run(N[gn]),qF([u,s,n],H,function(){q(),de&&de(Ie)})},N);function on(Dn){Ie.flushComplete=Dn,m=!0,y.run(It,Ie),N[QJ](),It[wo](Ie)}return Ve(),ie(H,on,6,he)||on(!1),ut},N[Sv]=le,N.addPlugin=function(H,de,he,ke){if(!H){ke&&ke(!1),Cr(wke);return}var Ie=le(H[mp]);if(Ie&&!de){ke&&ke(!1),Cr("Plugin ["+H[mp]+"] is already loaded!");return}var ut={reason:16};function It(pi){d[lr](H),ut.added=[H],Z(ut),ke&&ke(!0)}if(Ie){var on=[Ie.plugin],Dn={reason:2,isAsync:!!he};X(on,Dn,function(pi){pi?(ut.removed=on,ut.reason|=32,It(!0)):ke&&ke(!1)})}else It(!1)},N.updateCfg=function(H,de){de===void 0&&(de=!0);var he;if(N[Xa]()){he={reason:1,cfg:e.cfg,oldCfg:JM({},e.cfg),newConfig:JM({},H),merge:de},H=he.newConfig;var ke=e.cfg;H[Ob]=ke[Ob],H[Pv]=ke[Pv]}e._block(function(Ie){var ut=Ie.cfg;dee(Ie,ut,H,de),de||Ze(ut,function(It){$a(H,It)||Ie.set(ut,It,Bc)}),Ie[Gl](ut,lee)},!0),e[Rb](),he&&Et(he)},N.evtNamespace=function(){return v},N.flush=ie,N.getTraceCtx=function(H){return S||(S=yke()),S},N.setTraceCtx=function(H){S=H||null},N.addUnloadHook=ct,vm(N,"addUnloadCb",function(){return y},"add"),N.onCfgChange=function(H){var de;return r?de=ao(e.cfg,H,N[gn]):de=iat(T,H),{rm:function(){de.rm()}}},N.getWParam=function(){return gv()||e.cfg.enableWParam?0:-1};function P(){var H={};B=[];var de=function(he){he&&_e(he,function(ke){if(ke[mp]&&ke[Pb]&&!H[ke.identifier]){var Ie=ke[mp]+"="+ke[Pb];B[lr](Ie),H[ke.identifier]=ke}})};de(f),p&&_e(p,function(he){de(he)}),de(d)}function q(){r=!1,e=Xn({},lee,N[gn]),e.cfg[fF]=1,Vr(N,"config",{g:function(){return e.cfg},s:function(de){N.updateCfg(de,!1)}}),Vr(N,"pluginVersionStringArr",{g:function(){return B||P(),B}}),Vr(N,"pluginVersionString",{g:function(){return j||(B||P(),j=B.join(";")),j||At}}),Vr(N,"logger",{g:function(){return n||(n=new Ov(e.cfg),e[gn]=n),n},s:function(de){e[gn]=de,n!==de&&(Sm(n,!1),n=de)}}),N[gn]=new Ov(e.cfg),A=[];var H=N.config[Ob]||[];H.splice(0,H[lt]),zu(H,A),h=new Ske,o=[],Sm(s,!1),s=null,a=null,c=null,Sm(u,!1),u=null,l=null,d=[],p=null,f=null,m=!1,g=null,v=vs("AIBaseCore",!0),y=$b(),S=null,I=null,b=XF(),T=[],j=null,B=null,Y=!1}function U(){var H=_a(re(),e.cfg,N);return H[fP](w),H}function Z(H){var de=nat(N[gn],nke,d);l=null,j=null,B=null,f=(p||[])[0]||[],f=KF(zu(f,de[Pv]));var he=zu(KF(de[di]),f);A=dp(he);var ke=N.config[Ob]||[];ke.splice(0,ke[lt]),zu(ke,A);var Ie=U();f&&f[lt]>0&&nee(Ie[hp](f),he),nee(Ie,he),H&&Et(H)}function le(H){var de=null,he=null,ke=[];return _e(A,function(Ie){if(Ie[mp]===H&&Ie!==h)return he=Ie,-1;Ie.getChannel&&ke[lr](Ie)}),!he&&ke[lt]>0&&_e(ke,function(Ie){if(he=Ie.getChannel(H),!he)return-1}),he&&(de={plugin:he,setEnabled:function(Ie){Em(he)[bP]=!Ie},isEnabled:function(){var Ie=Em(he);return!Ie[Fc]&&!Ie[bP]},remove:function(Ie,ut){var It;Ie===void 0&&(Ie=!0);var on=[he],Dn=(It={reason:1},It[zl]=Ie,It);X(on,Dn,function(pi){pi&&Z({reason:32,removed:on}),ut&&ut(pi)})}}),de}function re(){if(!l){var H=(A||[]).slice();Pr(H,h)===-1&&H[lr](h),l=qv(KF(H),e.cfg,N)}return l}function X(H,de,he){if(H&&H[lt]>0){var ke=qv(H,e.cfg,N),Ie=NE(ke,N);Ie[fP](function(){var ut=!1,It=[];_e(d,function(Dn,pi){Eke(Dn,H)?ut=!0:It[lr](Dn)}),d=It,j=null,B=null;var on=[];p&&(_e(p,function(Dn,pi){var zs=[];_e(Dn,function(Vp){Eke(Vp,H)?ut=!0:zs[lr](Vp)}),on[lr](zs)}),p=on),he&&he(ut),w()}),Ie[wo](de)}else he(!1)}function Ve(){if(n&&n.queue){var H=n.queue.slice(0);n.queue[lt]=0,_e(H,function(de){var he,ke=(he={},he[qs]=g||"InternalMessageId: "+de[lE],he.iKey=I,he[Iv]=qc(new Date),he.baseType=Ub.dataType,he.baseData={message:de[gp]},he);N.track(ke)})}}function ie(H,de,he,ke){var Ie=1,ut=!1,It=null;ke=ke||5e3;function on(){Ie--,ut&&Ie===0&&(It&&It[kb](),It=null,de&&de(ut),de=null)}if(f&&f[lt]>0){var Dn=U()[hp](f);Dn.iterate(function(pi){if(pi.flush){Ie++;var zs=!1;pi.flush(H,function(){zs=!0,on()},he)||zs||(H&&It==null?It=Wa(function(){It=null,on()},ke):on())}})}return ut=!0,on(),!0}function yt(){!s&&N[aE](),ct(e[Ku](function(H){var de=H.cfg.disableDbgExt;de===!0&&_&&(s[uE](_),_=null),s&&!_&&de!==!0&&(_=LRe(H.cfg),s[cE](_))}))}function Ye(){ct(e[Ku](function(H){var de=H.cfg.enablePerfMgr;!de&&c&&(c=null),de&&EP(H.cfg,SF,rat)}))}function Et(H){var de=zP(re(),N);de[fP](w),(!N._updateHook||N._updateHook(de,H)!==!0)&&de[wo](H)}function Cr(H){var de=N[gn];de?(Me(de,2,73,H),w()):ai(H)}function be(H){var de=N[aE]();de&&de[Av]([H],2)}function ct(H){b.add(H)}})}return t.__ieDyn=1,t}()});var Ep,sat,kke,pee,Wb,Pke=R(()=>{Wo();bE();St();xn();UZ();Yl();Lv();bp();Ep="",sat="NoResponseBody",kke="&"+sat+"=true",pee="POST",Wb=function(){function t(){var e=0,r,n,o,s,a,c,u,l,d,p,f,m,h;sr(t,this,function(g,v){var y=!0;Y(),g[mm]=function(N,w){o=w,n&&Me(o,1,28,"Sender is already initialized"),g.SetConfig(N),n=!0},g._getDbgPlgTargets=function(){return[n,s,c,r]},g.SetConfig=function(N){try{if(a=N.senderOnCompleteCallBack||{},c=!!N.disableCredentials,s=!!N.isOneDs,r=!!N.enableSendPromise,l=!!N.disableXhr,d=!!N.disableBeacon,p=!!N.disableBeaconSync,h=N.timeWrapper,m=!!N.addNoResponse,f=!!N.disableFetchKeepAlive,u={sendPOST:j},s||(y=!1),c){var w=Fb();w&&w.protocol&&w.protocol[Qa]()==="file:"&&(y=!1)}return!0}catch{}return!1},g.getSyncFetchPayload=function(){return e},g.getSenderInst=function(N,w){return N&&N[lt]?I(N,w):null},g.getFallbackInst=function(){return u},g[Ev]=function(N,w){Y()};function b(N,w){T(w,200,{},N)}function _(N,w){Me(o,2,26,"Failed to send telemetry.",{message:N}),T(w,400,{})}function S(N){_("No endpoint url is provided for the batch",N)}function I(N,w){for(var P,q=0,U=null,Z=0;U==null&&Z<N[lt];)q=N[Z],!l&&q===1?CP()?U=ne:CE()&&(U=j):q===2&&gm(w)&&(!w||!f)?U=F:q===3&&rc()&&(w?!p:!d)&&(U=B),Z++;return U?(P={_transport:q,_isSync:w},P[tZ]=U,P):null}function T(N,w,P,q){try{N&&N(w,P,q)}catch{}}function A(N,w){var P=io(),q=N[dE];if(!q)return S(w),!0;q=N[dE]+(m?kke:Ep);var U=N[wv],Z=s?U:new Blob([U],{type:"text/plain;charset=UTF-8"}),le=P.sendBeacon(q,Z);return le}function B(N,w,P){var q=N[wv];try{if(q)if(A(N,w))b(Ep,w);else{var U=a&&a.beaconOnRetry;U&&vt(U)?U(N,w,A):(u&&u[tZ](N,w,!0),Me(o,2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}catch(Z){s&&ba(o,"Failed to send telemetry using sendBeacon API. Ex:"+We(Z)),T(w,s?0:400,{},Ep)}}function j(N,w,P){var q,U,Z,le=N[vF]||{};!P&&r&&(q=ya(function(ie,yt){U=ie,Z=yt})),s&&P&&N.disableXhrSync&&(P=!1);var re=N[dE];if(!re){S(w),U&&U(!1);return}var X=AZ(pee,re,y,!0,P,N[Lb]);X[rZ]("Content-type","application/json"),_e(Eo(le),function(ie){X[rZ](ie,le[ie])}),X.onreadystatechange=function(){s||(Ve(X),X.readyState===4&&U&&U(!0))},X.onload=function(){s&&Ve(X)};function Ve(ie){var yt=a&&a.xhrOnComplete,Ye=yt&&vt(yt);if(Ye)yt(ie,w,N);else{var Et=Ql(ie);T(w,ie[Db],_m(ie,s),Et)}}return X.onerror=function(ie){T(w,s?X[Db]:400,_m(X,s),s?Ep:ym(X)),Z&&Z(ie)},X.ontimeout=function(){T(w,s?X[Db]:500,_m(X,s),s?Ep:ym(X)),U&&U(!1)},X.send(N[wv]),q}function F(N,w,P){var q,U=N[dE],Z=N[wv],le=s?Z:new Blob([Z],{type:"application/json"}),re,X,Ve,ie=new Headers,yt=Z[lt],Ye=!1,Et=!1,Cr=N[vF]||{},be=(q={method:pee,body:le},q[FZ]=!0,q);N.headers&&Eo(N.headers)[lt]>0&&(_e(Eo(Cr),function(he){ie.append(he,Cr[he])}),be[vF]=ie),y&&s&&(be.credentials="include"),P&&(be.keepalive=!0,e+=yt,s?N._sendReason===2&&(Ye=!0,m&&(U+=kke)):Ye=!0);var ct=new Request(U,be);try{ct[FZ]=!0}catch{}if(!P&&r&&(re=ya(function(he,ke){X=he,Ve=ke})),!U){S(w),X&&X(!1);return}function H(he){T(w,s?0:400,{},s?Ep:he)}function de(he,ke,Ie){var ut=he[Db],It=a.fetchOnComplete;It&&vt(It)?It(he,w,Ie||Ep,ke):T(w,ut,{},Ie||Ep)}try{kv(fetch(s?U:ct,s?be:null),function(he){if(P&&(e-=yt,yt=0),!Et)if(Et=!0,he.rejected)H(he.reason&&he.reason[gp]),Ve&&Ve(he.reason);else{var ke=he.value;try{!s&&!ke.ok?(H(ke.statusText),X&&X(!1)):s&&!ke.body?(de(ke,null,Ep),X&&X(!0)):kv(ke.text(),function(Ie){de(ke,N,Ie.value),X&&X(!0)})}catch(Ie){H(We(Ie)),Ve&&Ve(Ie)}}})}catch(he){Et||(H(We(he)),Ve&&Ve(he))}return Ye&&!Et&&(Et=!0,T(w,200,{}),X&&X(!0)),s&&!Et&&N[Lb]>0&&h&&h.set(function(){Et||(Et=!0,T(w,500,{}),X&&X(!0))},N[Lb]),re}function ne(N,w,P){var q=ui(),U=new XDomainRequest,Z=N[wv];U.onload=function(){var ie=Ql(U),yt=a&&a.xdrOnComplete;yt&&vt(yt)?yt(U,w,N):T(w,200,{},ie)},U.onerror=function(){T(w,400,{},s?Ep:qb(U))},U.ontimeout=function(){T(w,500,{})},U.onprogress=function(){};var le=q&&q.location&&q.location[mF]||"",re=N[dE];if(!re){S(w);return}if(!s&&re.lastIndexOf(le,0)!==0){var X="Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol.";Me(o,2,40,". "+X),_(X,w);return}var Ve=s?re:re[$l](/^(https?:)/,"");U.open(pee,Ve),N[Lb]&&(U[Lb]=N[Lb]),U.send(Z),s&&P?h&&h.set(function(){U.send(Z)},0):U.send(Z)}function Y(){e=0,n=!1,r=!1,o=null,s=null,a=null,c=null,u=null,l=!1,d=!1,p=!1,f=!1,m=!1,h=null}})}return t.__ieDyn=1,t}()});function Oke(t){return t&&t[$l]?t[$l](/^[\s\.]+|(?=[\s\.])[\.\s]+$/g,At):t}function e9(t,e){var r;if(e){var n=At;st(e)?(n=At,_e(e,function(s){s=Oke(s),s&&(s[0]!=="."&&(s="."+s),n+=s)})):n=Oke(e),n&&(n[0]!=="."&&(n="."+n),t=(t||At)+n)}var o=lat.exec(t||At)||[];return r={},r[ec]=o[1],r.ns=(o[2]||At).replace(aat,".").replace(cat,At)[Yu](".").sort().join("."),r}function fee(t,e,r){var n=[],o=WP.get(t,JF,{},!1),s=e9(e,r);return Ze(o,function(a,c){_e(c,function(u){var l;(!s[ec]||s[ec]===u.evtName[ec])&&(!s.ns||s.ns===s.ns)&&n[lr]((l={},l[qs]=u.evtName[ec]+(u.evtName.ns?"."+u.evtName.ns:At),l.handler=u[hP],l))})}),n}function Vke(t,e,r){r===void 0&&(r=!0);var n=WP.get(t,JF,{},r),o=n[e];return o||(o=n[e]=[]),o}function Gke(t,e,r,n){t&&e&&e[ec]&&(t[Lke]?t[Lke](e[ec],r,n):t[Nke]&&t[Nke](Fke+e[ec],r))}function dat(t,e,r,n){var o=!1;return t&&e&&e[ec]&&r&&(t[Dke]?(t[Dke](e[ec],r,n),o=!0):t[Ake]&&(t[Ake](Fke+e[ec],r),o=!0)),o}function Mke(t,e,r,n){for(var o=e[lt];o--;){var s=e[o];s&&(!r.ns||r.ns===s.evtName.ns)&&(!n||n(s))&&(Gke(t,s.evtName,s[hP],s.capture),e[fp](o,1))}}function pat(t,e,r){if(e[ec])Mke(t,Vke(t,e[ec]),e,r);else{var n=WP.get(t,JF,{});Ze(n,function(o,s){Mke(t,s,e,r)}),Eo(n)[lt]===0&&WP.kill(t,JF)}}function jc(t,e){var r;return e?(st(e)?r=[t].concat(e):r=[t,e],r=e9("xx",r).ns[Yu](".")):r=t,r}function Tp(t,e,r,n,o){var s;o===void 0&&(o=!1);var a=!1;if(t)try{var c=e9(e,n);if(a=dat(t,c,r,o),a&&WP.accept(t)){var u=(s={guid:uat++,evtName:c},s[hP]=r,s.capture=o,s);Vke(t,c.type)[lr](u)}}catch{}return a}function Rm(t,e,r,n,o){if(o===void 0&&(o=!1),t)try{var s=e9(e,n),a=!1;pat(t,s,function(c){return s.ns&&!r||c[hP]===r?(a=!0,!0):!1}),a||Gke(t,s,r,o)}catch{}}function mee(t,e,r,n){return n===void 0&&(n=!1),Tp(t,e,r,null,n)}function hee(t,e,r,n){n===void 0&&(n=!1),Rm(t,e,r,null,n)}function t9(t,e,r){var n=!1,o=ui();o&&(n=Tp(o,t,e,r),n=Tp(o.body,t,e,r)||n);var s=ci();return s&&(n=Tp(s,t,e,r)||n),n}function r9(t,e,r){var n=ui();n&&(Rm(n,t,e,r),Rm(n.body,t,e,r));var o=ci();o&&Rm(o,t,e,r)}function LE(t,e,r,n){var o=!1;return e&&t&&t[lt]>0&&_e(t,function(s){s&&(!r||Pr(r,s)===-1)&&(o=t9(s,e,n)||o)}),o}function n9(t,e,r,n){var o=!1;return e&&t&&st(t)&&(o=LE(t,e,r,n),!o&&r&&r[lt]>0&&(o=LE(t,e,null,n))),o}function Vv(t,e,r){t&&st(t)&&_e(t,function(n){n&&r9(n,e,r)})}function KP(t,e,r){return n9([qke,Bke,ZF],t,e,r)}function YP(t,e){Vv([qke,Bke,ZF],t,e)}function OE(t,e,r){function n(a){var c=ci();t&&c&&c.visibilityState==="hidden"&&t(a)}var o=jc(Hke,r),s=LE([ZF],t,e,o);return(!e||Pr(e,$P)===-1)&&(s=LE([$P],n,e,o)||s),!s&&e&&(s=OE(t,null,r)),s}function QP(t,e){var r=jc(Hke,e);Vv([ZF],t,r),Vv([$P],null,r)}function ME(t,e,r){function n(a){var c=ci();t&&c&&c.visibilityState==="visible"&&t(a)}var o=jc(jke,r),s=LE([Uke],t,e,o);return s=LE([$P],n,e,o)||s,!s&&e&&(s=ME(t,null,r)),s}function XP(t,e){var r=jc(jke,e);Vv([Uke],t,r),Vv([$P],null,r)}var Fke,Ake,Dke,Nke,Lke,JF,$P,ZF,Uke,Bke,qke,Hke,jke,aat,cat,uat,WP,lat,zke=R(()=>{St();xn();wE();so();Fke="on",Ake="attachEvent",Dke="addEventListener",Nke="detachEvent",Lke="removeEventListener",JF="events",$P="visibilitychange",ZF="pagehide",Uke="pageshow",Bke="unload",qke="beforeunload",Hke=vs("aiEvtPageHide"),jke=vs("aiEvtPageShow"),aat=/\.[\.]+/g,cat=/[\.]+$/,uat=1,WP=NF("events"),lat=/^([^.]*)(?:\.(.+)|)/});var gee,$ke=R(()=>{lF();gee=oo({DISABLED:0,CRITICAL:1,WARNING:2,DEBUG:3})});var en=R(()=>{hRe();gRe();Rke();uee();DF();ZZ();MZ();bp();Pke();St();lF();zke();Lv();Ya();YZ();zF();Yl();YF();$ke();KZ();wE();QF();ree();Mv();FF();qZ()});var wp,Wke,vee,i9,o9=R(()=>{wp="",Wke="https://browser.events.data.microsoft.com/OneCollector/1.0/",vee="version",i9="properties"});var yee,bee,FE,Rp,_ee,Jn,Kb,km,s9,a9,c9,u9,JP,l9=R(()=>{yee="initialize",bee="logger",FE="indexOf",Rp="timings",_ee="pollInternalLogs",Jn="value",Kb="kind",km="length",s9="processTelemetryStart",a9="handleField",c9="rmSanitizer",u9="rmFieldSanitizer",JP="canHandle"});function Ko(t){return!(t===wp||Ee(t))}function d9(t){if(t){var e=va(t,"-");if(e>-1)return hv(t,e)}return wp}function Jke(){return xee===null&&(xee=!Pt(Uint8Array)&&!vat()&&!Dv()),xee}function p9(t){return!!(t&&Fs(t)&&t>=1&&t<=4)}function f9(t,e,r){if(!e&&!Ko(e)||typeof t!="string")return null;var n=typeof e;if(n==="string"||n==="number"||n==="boolean"||st(e))e={value:e};else if(n==="object"&&!Yke.call(e,"value"))e={value:r?JSON.stringify(e):e};else if(Ee(e[Jn])||e[Jn]===wp||!Ft(e[Jn])&&!Fs(e[Jn])&&!Ul(e[Jn])&&!st(e[Jn]))return null;if(st(e[Jn])&&!Iee(e[Jn]))return null;if(!Ee(e[Kb])){if(st(e[Jn])||!ZP(e[Kb]))return null;e[Jn]=e[Jn].toString()}return e}function BE(t,e,r){var n=-1;if(!Pt(t))if(e>0&&(e===32?n=8192:e<=13&&(n=e<<5)),gat(r))n===-1&&(n=0),n|=r;else{var o=hat[kp(t)]||-1;n!==-1&&o!==-1?n|=o:o===6&&(n=o)}return n}function Zke(t,e,r){r===void 0&&(r=!0);var n;return t&&(n=t.get(e),r&&n&&decodeURIComponent&&(n=decodeURIComponent(n))),n||wp}function e2e(t){t===void 0&&(t="D");var e=qP();return t==="B"?e="{"+e+"}":t==="P"?e="("+e+")":t==="N"&&(e=e.replace(/-/g,wp)),e}function Yb(t,e,r,n,o){var s={},a=!1,c=0,u=arguments[km],l=arguments;for(Ul(l[0])&&(a=l[0],c++);c<u;c++){var t=l[c];Ze(t,function(p,f){a&&f&&Pn(f)?st(f)?(s[p]=s[p]||[],_e(f,function(m,h){m&&Pn(m)?s[p][h]=Yb(!0,s[p][h],m):s[p][h]=m})):s[p]=Yb(!0,s[p],f):s[p]=f})}return s}function ZP(t){return t===0||t>0&&t<=13||t===32}function gat(t){return t>=0&&t<=9}function vat(){var t=io();if(!Pt(t)&&t.userAgent){var e=t.userAgent.toLowerCase();if((e[FE]("safari")>=0||e[FE]("firefox")>=0)&&e[FE]("chrome")<0)return!0}return!1}function Iee(t){return t[km]>0}function eA(t,e){var r=t;r[Rp]=r[Rp]||{},r[Rp][s9]=r[Rp][s9]||{},r[Rp][s9][e]=nc()}function kp(t){var e=0;if(t!=null){var r=typeof t;r==="string"?e=1:r==="number"?e=2:r==="boolean"?e=3:r===om&&(e=4,st(t)?(e=4096,t[km]>0&&(e|=kp(t[0]))):Yke.call(t,"value")&&(e=8192|kp(t[Jn])))}return e}function m9(){return!!nn("chrome")}function t2e(t,e,r,n,o,s){n===void 0&&(n=!1),o===void 0&&(o=!1);function a(u,l,d){try{u[l]=d}catch{}}var c=new XMLHttpRequest;return n&&a(c,fat,n),r&&a(c,Kke,r),c.open(t,e,!o),r&&a(c,Kke,r),!o&&s&&a(c,mat,s),c}function Gv(t){return t>0}var Pm,See,UE,Yke,fat,Kke,mat,hat,xee,Qke,Xke,nc,h9=R(()=>{en();Ya();St();o9();l9();See="4.1.1",UE="1DS-Web-JS-"+See,Yke=J2.hasOwnProperty,fat="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",Kke="withCredentials",mat="timeout",hat=(Pm={},Pm[0]=0,Pm[2]=6,Pm[1]=1,Pm[3]=7,Pm[4098]=6,Pm[4097]=1,Pm[4099]=7,Pm),xee=null,Qke=gv(),Xke=vv();nc=iE});function bat(t){return t&&(!t.getProperty||!t.setProperty)&&ai("Invalid property storage override passed."),!0}var yat,r2e,n2e=R(()=>{Ya();Wo();en();St();o9();h9();l9();yat=ga({endpointUrl:Wke,propertyStorageOverride:{isVal:bat}});r2e=function(t){Ka(e,t);function e(){var r=t.call(this)||this;return sr(e,r,function(n,o){n[yee]=function(s,a,c,u){ki(n,function(){return"AppInsightsCore.initialize"},function(){try{o[yee](Xn(s,yat,c||n[bee],!1).cfg,a,c,u)}catch(p){var l=n[bee],d=We(p);d[FE]("channels")!==-1&&(d+=`
 - Channels must be provided through config.channels only!`),Me(l,1,514,"SDK Initialization Failed - no telemetry will be sent: "+d)}},function(){return{config:s,extensions:a,logger:c,notificationManager:u}})},n.track=function(s){ki(n,function(){return"AppInsightsCore.track"},function(){var a=s;if(a){a[Rp]=a[Rp]||{},a[Rp].trackStart=nc(),p9(a.latency)||(a.latency=1);var c=a.ext=a.ext||{};c.sdk=c.sdk||{},c.sdk.ver=UE;var u=a.baseData=a.baseData||{};u[i9]=u[i9]||{};var l=u[i9];l[vee]=l[vee]||n.pluginVersionString||wp}o.track(a)},function(){return{item:s}},!s.sync)},n[_ee]=function(s){return o[_ee](s||"InternalLog")}}),r}return e.__ieDyn=1,e}(wm)});var i2e,o2e,s2e,a2e,c2e,u2e=R(()=>{en();i2e=oo({NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,Pii_IPv6ScrubLastHextets:14,Pii_DropValue:15,CustomerContent_GenericContent:32}),o2e=oo({Normal:1,CostDeferred:2,RealTime:3,Immediate:4}),s2e=oo({Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9}),a2e=oo({Normal:1,Critical:2}),c2e=oo({NONE:0,ERROR:1,WARNING:2,INFORMATION:3})});var l2e,d2e=R(()=>{en();St();o9();h9();l9();l2e=function(){function t(e){var r=this,n={},o=[],s=[];e&&s.push(e);function a(d,p){var f,m=n[d];if(m&&(f=m[p]),!f&&f!==null){if(Ft(d)&&Ft(p))if(s[km]>0){for(var h=0;h<s[km];h++)if(s[h][a9](d,p)){f={canHandle:!0,fieldHandler:s[h]};break}}else o[km]===0&&(f={canHandle:!0});if(!f&&f!==null){f=null;for(var h=0;h<o[km];h++)if(o[h][a9](d,p)){f={canHandle:!0,handler:o[h],fieldHandler:null};break}}m||(m=n[d]={}),m[p]=f}return f}r.clearCache=function(){n={}},r.addSanitizer=function(d){d&&(XM(o,d)||o.push(d),n={})},r.addFieldSanitizer=function(d){d&&(XM(s,d)||s.push(d),n={})},r[c9]=function(d){if(d){var p=Pr(o,d);p!==-1&&(o.splice(p,1),n={}),_e(o,function(f){f&&f[c9]&&f[c9](d)})}},r[u9]=function(d){if(d){var p=Pr(s,d);p!==-1&&(s.splice(p,1),n={}),_e(o,function(f){f&&f[u9]&&f[u9](d)})}},r.isEmpty=function(){return nE(o)+nE(s)===0},r[a9]=function(d,p){var f=a(d,p);return f?f[JP]:!1},r[Jn]=function(d,p,f,m){var h=a(d,p);if(h&&h[JP]){if(!h||!h[JP])return null;if(h.handler)return h.handler[Jn](d,p,f,m);if(!Ft(p)||Ee(f)||f===wp)return null;var g=null,v=kp(f);if((v&8192)===8192){var y=v&-8193;if(g=f,!Ko(g[Jn])||y!==1&&y!==2&&y!==3&&(y&4096)!==4096)return null}else v===1||v===2||v===3||(v&4096)===4096?g=u(d,p,f):v===4&&(g=u(d,p,m?JSON.stringify(f):f));if(g)return c(h,d,p,v,g,m)}return null},r.property=function(d,p,f,m){var h=a(d,p);if(!h||!h[JP]||!Ft(p)||Ee(f)||!Ko(f[Jn]))return null;var g=kp(f[Jn]);return g===0?null:c(h,d,p,g,f,m)};function c(d,p,f,m,h,g){if(d.handler)return d.handler.property(p,f,h,g);if(!Ee(h[Kb])){if((m&4096)===4096||!ZP(h[Kb]))return null;h[Jn]=h[Jn].toString()}return l(d.fieldHandler,p,f,m,h)}function u(d,p,f){return Ko(f)?{value:f}:null}function l(d,p,f,m,h){if(h&&d){var g=d.getSanitizer(p,f,m,h[Kb],h.propertyType);if(g)if(m===4){var v={},y=h[Jn];Ze(y,function(_,S){var I=p+"."+f;if(Ko(S)){var T=u(I,_,S);T=l(d,I,_,kp(S),T),T&&(v[_]=T[Jn])}}),h[Jn]=v}else{var b={path:p,name:f,type:m,prop:h,sanitizer:r};h=g.call(r,b)}}return h}}return t.getFieldType=kp,t}()});var p2e={};mn(p2e,{AppInsightsCore:()=>r2e,BaseTelemetryPlugin:()=>Tm,DiagnosticLogger:()=>Ov,EventLatency:()=>o2e,EventPersistence:()=>a2e,EventPropertyType:()=>s2e,EventsDiscardedReason:()=>Vl,FullVersionString:()=>UE,InternalAppInsightsCore:()=>wm,LoggingSeverity:()=>gee,MinChannelPriorty:()=>WJ,NotificationManager:()=>FP,PerfEvent:()=>Vb,PerfManager:()=>BP,ProcessTelemetryContext:()=>see,SenderPostManager:()=>Wb,TraceLevel:()=>c2e,Undefined:()=>lp,ValueKind:()=>i2e,ValueSanitizer:()=>l2e,Version:()=>See,_InternalLogMessage:()=>Ub,__getRegisteredEvents:()=>fee,_appendHeader:()=>TE,_getAllResponseHeaders:()=>_m,_logInternalMessage:()=>RZ,_throwInternal:()=>Me,_warnToConsole:()=>ba,addEventHandler:()=>t9,addEventListeners:()=>n9,addPageHideEventListener:()=>OE,addPageShowEventListener:()=>ME,addPageUnloadEventListener:()=>KP,areCookiesSupported:()=>PE,arrForEach:()=>_e,arrIndexOf:()=>Pr,arrMap:()=>pp,arrReduce:()=>rE,attachEvent:()=>mee,blockDynamicConversion:()=>DP,convertAllHeadersToMap:()=>AF,cookieAvailable:()=>PE,createCookieMgr:()=>Im,createDynamicConfig:()=>Xn,createEnumStyle:()=>oo,createGuid:()=>e2e,createProcessTelemetryContext:()=>_a,createTraceParent:()=>HP,createUniqueNamespace:()=>vs,createUnloadHandlerContainer:()=>$b,dateNow:()=>li,detachEvent:()=>hee,disallowsSameSiteNone:()=>GF,doPerf:()=>ki,dumpObj:()=>We,eventOff:()=>Rm,eventOn:()=>Tp,extend:()=>Yb,findW3cTraceParent:()=>GP,forceDynamicConversion:()=>OZ,formatErrorMessageXdr:()=>qb,formatErrorMessageXhr:()=>ym,formatTraceParent:()=>VP,generateW3CId:()=>Gb,getCommonSchemaMetaData:()=>BE,getConsole:()=>_P,getCookieValue:()=>Zke,getCrypto:()=>xP,getDocument:()=>ci,getDynamicConfigHandler:()=>AP,getExceptionName:()=>An,getFieldValueType:()=>kp,getGlobal:()=>Us,getGlobalInst:()=>nn,getHistory:()=>aP,getIEVersion:()=>IP,getISOString:()=>qc,getJSON:()=>gs,getLocation:()=>Fb,getMsCrypto:()=>SP,getNavigator:()=>io,getPerformance:()=>dm,getResponseText:()=>Ql,getSetValue:()=>EP,getTenantId:()=>d9,getTime:()=>nc,getWindow:()=>ui,hasDocument:()=>gv,hasHistory:()=>zM,hasJSON:()=>yp,hasNavigator:()=>tE,hasOwnProperty:()=>ji,hasWindow:()=>vv,isArray:()=>st,isArrayValid:()=>Iee,isBeaconsSupported:()=>rc,isBoolean:()=>Ul,isChromium:()=>m9,isDate:()=>XC,isDocumentObjectAvailable:()=>Qke,isError:()=>lv,isFetchSupported:()=>gm,isFunction:()=>vt,isGreaterThanZero:()=>Gv,isIE:()=>Nv,isLatency:()=>p9,isNotTruthy:()=>DM,isNullOrUndefined:()=>Ee,isNumber:()=>Fs,isObject:()=>Pn,isReactNative:()=>Dv,isSampledFlag:()=>jP,isString:()=>Ft,isTruthy:()=>ju,isTypeof:()=>PM,isUint8ArrayAvailable:()=>Jke,isUndefined:()=>Pt,isValidSpanId:()=>Cp,isValidTraceId:()=>Ip,isValidTraceParent:()=>DE,isValueAssigned:()=>Ko,isValueKind:()=>ZP,isWindowObjectAvailable:()=>Xke,isXhrSupported:()=>CE,mergeEvtNamespace:()=>jc,newGuid:()=>qP,newId:()=>kP,normalizeJsName:()=>Bb,objDefineAccessors:()=>GM,objForEachKey:()=>Ze,objFreeze:()=>dp,objKeys:()=>Eo,objSeal:()=>MM,onConfigChange:()=>ao,openXhr:()=>t2e,optimizeObject:()=>Xu,parseResponse:()=>Hb,parseTraceParent:()=>zb,perfNow:()=>iE,prependTransports:()=>bm,proxyAssign:()=>kZ,proxyFunctionAs:()=>vm,proxyFunctions:()=>Hc,random32:()=>xm,randomValue:()=>RP,removeEventHandler:()=>r9,removeEventListeners:()=>Vv,removePageHideEventListener:()=>QP,removePageShowEventListener:()=>XP,removePageUnloadEventListener:()=>YP,safeGetCookieMgr:()=>WZ,safeGetLogger:()=>Kl,sanitizeProperty:()=>f9,setEnableEnvMocks:()=>IZ,setProcessTelemetryTimings:()=>eA,setValue:()=>Qu,strContains:()=>Vi,strEndsWith:()=>bv,strFunction:()=>zC,strObject:()=>om,strPrototype:()=>Fl,strStartsWith:()=>Eb,strTrim:()=>Fr,strUndefined:()=>lp,throwError:()=>ai,toISOString:()=>qc,useXDomainRequest:()=>CP});var Qb=R(()=>{n2e();u2e();d2e();en();h9()});var Xb,g9,v9,Cee=R(()=>{Xb="REAL_TIME",g9="NEAR_REAL_TIME",v9="BEST_EFFORT"});var Xl,y9,f2e,Eee,m2e,h2e,g2e,Tee,wee,b9,v2e,y2e,b2e,_9,Ree,x9,S9,I9,tA,kee,Pee,_2e,qE,Aee,C9,rA=R(()=>{Xl="",y9="drop",f2e="send",Eee="requeue",m2e="rspFail",h2e="oth",g2e="no-cache, no-store",Tee="application/x-json-stream",wee="cache-control",b9="content-type",v2e="kill-tokens",y2e="kill-duration",b2e="time-delta-millis",_9="client-version",Ree="client-id",x9="time-delta-to-apply-millis",S9="upload-time",I9="apikey",tA="AuthMsaDeviceTicket",kee="WebAuthToken",Pee="AuthXToken",_2e="NoResponseBody",qE="msfpc",Aee="trace",C9="user"});var nA,E9,T9,w9,iA,tr,Pp,Zu,Gi,Ap,Yo,Dp,Jb,R9,zv,k9,Zb,P9,A9,x2e,Dee,Nee,S2e,I2e,D9,Lee,Oee,C2e,E2e,Mee,Fee,T2e,N9,L9,Uee,e_,HE,Bee,Hs,ic,oA,sA,jE,O9,aA,w2e,M9,F9,VE,qee,cA,U9,B9,GE,q9,H9,j9,uA,R2e,k2e,Hee,jee,P2e,A2e,D2e,V9,lA,$v,t_,zE=R(()=>{nA="allowRequestSending",E9="firstRequestSent",T9="shouldAddClockSkewHeaders",w9="getClockSkewHeaderValue",iA="setClockSkew",tr="length",Pp="concat",Zu="iKey",Gi="count",Ap="events",Yo="push",Dp="split",Jb="splice",R9="toLowerCase",zv="hdrs",k9="useHdrs",Zb="initialize",P9="setTimeoutOverride",A9="clearTimeoutOverride",x2e="payloadPreprocessor",Dee="overrideEndpointUrl",Nee="avoidOptions",S2e="disableEventTimings",I2e="stringifyObjects",D9="enableCompoundKey",Lee="disableXhrSync",Oee="disableFetchKeepAlive",C2e="addNoResponse",E2e="excludeCsMetaData",Mee="useSendBeacon",Fee="alwaysUseXhrOverride",T2e="unloadTransports",N9="serializeOfflineEvt",L9="getOfflineRequestDetails",Uee="createPayload",e_="headers",HE="_thePayload",Bee="urlString",Hs="batches",ic="sendType",oA="addHeader",sA="canSendRequest",jE="sendQueuedRequests",O9="isCompletelyIdle",aA="setUnloading",w2e="isTenantKilled",M9="sendSynchronousBatch",F9="_transport",VE="getWParam",qee="isBeacon",cA="timings",U9="isTeardown",B9="isSync",GE="data",q9="_sendReason",H9="setKillSwitchTenants",j9="_backOffTransmission",uA="identifier",R2e="disableOptimizeObj",k2e="ignoreMc1Ms0CookieProcessing",Hee="eventsLimitInMem",jee="autoFlushEventsLimit",P2e="disableAutoBatchFlushLimit",A2e="overrideInstrumentationKey",D2e="disableTelemetry",V9="baseData",lA="sendAttempt",$v="latency",t_="sync"});function L2e(t){var e=(t.ext||{}).intweb;return e&&Ko(e[qE])?e[qE]:null}function N2e(t){for(var e=null,r=0;e===null&&r<t[tr];r++)e=L2e(t[r]);return e}var $E,Vee=R(()=>{Qb();rA();zE();$E=function(){function t(e,r){var n=r?[][Pp](r):[],o=this,s=N2e(n);o[Zu]=function(){return e},o.Msfpc=function(){return s||Xl},o[Gi]=function(){return n[tr]},o[Ap]=function(){return n},o.addEvent=function(a){return a?(n[Yo](a),s||(s=L2e(a)),!0):!1},o[Dp]=function(a,c){var u;if(a<n[tr]){var l=n[tr]-a;Ee(c)||(l=c<l?c:l),u=n[Jb](a,l),s=N2e(n)}return new t(e,u)}}return t.create=function(e,r){return new t(e,r)},t}()});var O2e,M2e=R(()=>{Wo();zE();O2e=function(){function t(){var e=!0,r=!0,n=!0,o="use-collector-delta",s=!1;sr(t,this,function(a){a[nA]=function(){return e},a[E9]=function(){n&&(n=!1,s||(e=!1))},a[T9]=function(){return r},a[w9]=function(){return o},a[iA]=function(c){s||(c?(o=c,r=!0,s=!0):r=!1,e=!0)}})}return t.__ieDyn=1,t}()});var _at,F2e,U2e=R(()=>{Wo();Qb();zE();_at=1e3,F2e=function(){function t(){var e={};function r(n){var o=[];return n&&_e(n,function(s){o[Yo](Fr(s))}),o}sr(t,this,function(n){n[H9]=function(o,s){if(o&&s)try{var a=r(o[Dp](","));if(s==="this-request-only")return a;for(var c=parseInt(s,10)*_at,u=0;u<a[tr];++u)e[a[u]]=li()+c}catch{return[]}return[]},n[w2e]=function(o){var s=e,a=Fr(o);return s[a]!==void 0&&s[a]>li()?!0:(delete s[a],!1)}})}return t.__ieDyn=1,t}()});function q2e(t){return!(t>=300&&t<500&&t!=429||t==501||t==505)}function G9(t){var e=0,r=B2e*xat,n=B2e*Sat,o=Math.floor(Math.random()*(n-r))+r;return e=Math.pow(2,t)*o,Math.min(e,Iat)}var xat,Sat,B2e,Iat,Gee=R(()=>{xat=.8,Sat=1.2,B2e=3e3,Iat=6e5});function Rat(t,e,r,n,o){if(o&&e){var s=t(o.value,o.kind,o.propertyType);if(s>-1){var a=e[H2e];a||(a=e[H2e]={f:{}});var c=a[z9];if(c||(c=a[z9]={}),r)for(var u=0;u<r.length;u++){var l=r[u];c[l]||(c[l]={f:{}});var d=c[l][z9];d||(d=c[l][z9]={}),c=d}c=c[n]={},st(o.value)?c.a={t:s}:c.t=s}}}var Cat,Eat,j2e,V2e,Tat,H2e,z9,wat,G2e,z2e=R(()=>{Wo();Qb();Vee();rA();St();Cat=20,Eat=3984588,j2e=65e3,V2e=2e6,Tat=Math.min(V2e,j2e),H2e="metadata",z9="f",wat=/\./,G2e=function(){function t(e,r,n,o,s,a){var c="data",u="baseData",l="ext",d=!!o,p=!0,f=r,m={},h=!!a,g=s||BE;sr(t,this,function(v){v.createPayload=function(_,S,I,T,A,B){return{apiKeys:[],payloadBlob:Xl,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:_,isTeardown:S,isSync:I,isBeacon:T,sendType:B,sendReason:A}},v.appendPayload=function(_,S,I){var T=_&&S&&!_.overflow;return T&&ki(e,function(){return"Serializer:appendPayload"},function(){for(var A=S.events(),B=_.payloadBlob,j=_.numEvents,F=!1,ne=[],Y=[],N=_.isBeacon,w=N?j2e:Eat,P=N?Tat:V2e,q=0,U=0;q<A.length;){var Z=A[q];if(Z){if(j>=I){_.overflow=S.split(q);break}var le=v.getEventBlob(Z);if(le&&le.length<=P){var re=le.length,X=B.length;if(X+re>w){_.overflow=S.split(q);break}B&&(B+=`
`),B+=le,U++,U>Cat&&(ql(B,0,1),U=0),F=!0,j++}else le?ne.push(Z):Y.push(Z),A.splice(q,1),q--}q++}if(ne.length>0&&_.sizeExceed.push($E.create(S.iKey(),ne)),Y.length>0&&_.failedEvts.push($E.create(S.iKey(),Y)),F){_.batches.push(S),_.payloadBlob=B,_.numEvents=j;var Ve=S.iKey();Pr(_.apiKeys,Ve)===-1&&_.apiKeys.push(Ve)}},function(){return{payload:_,theBatch:{iKey:S.iKey(),evts:S.events()},max:I}}),T},v.getEventBlob=function(_){try{return ki(e,function(){return"Serializer.getEventBlob"},function(){var S={};S.name=_.name,S.time=_.time,S.ver=_.ver,S.iKey="o:"+d9(_.iKey);var I={},T;h||(T=function(F,ne,Y){Rat(g,I,F,ne,Y)});var A=_[l];A&&(S[l]=I,Ze(A,function(F,ne){var Y=I[F]={};b(ne,Y,"ext."+F,!0,null,null,!0)}));var B=S[c]={};B.baseType=_.baseType;var j=B[u]={};return b(_.baseData,j,u,!1,[u],T,p),b(_.data,B,c,!1,[],T,p),JSON.stringify(S)},function(){return{item:_}})}catch{return null}};function y(_,S){var I=m[_];return I===void 0&&(_.length>=7&&(I=Eb(_,"ext.metadata")||Eb(_,"ext.web")),m[_]=I),I}function b(_,S,I,T,A,B,j){Ze(_,function(F,ne){var Y=null;if(ne||Ko(ne)){var N=I,w=F,P=A,q=S;if(d&&!T&&wat.test(F)){var U=F.split("."),Z=U.length;if(Z>1){P&&(P=P.slice());for(var le=0;le<Z-1;le++){var re=U[le];q=q[re]=q[re]||{},N+="."+re,P&&P.push(re)}w=U[Z-1]}}var X=T&&y(N,w);if(!X&&f&&f.handleField(N,w)?Y=f.value(N,w,ne,n):Y=f9(w,ne,n),Y){var Ve=Y.value;if(q[w]=Ve,B&&B(P,w,Y),j&&typeof Ve=="object"&&!st(Ve)){var ie=P;ie&&(ie=ie.slice(),ie.push(w)),b(ne,Ve,N+"."+w,T,ie,B,j)}}}})}})}return t.__ieDyn=1,t}()});function WE(t,e){return{set:function(r,n){for(var o=[],s=2;s<arguments.length;s++)o[s-2]=arguments[s];return NJ([t,e],r,n,o)}}}var zee=R(()=>{St()});function n_(t,e,r){Wee[t]=e,r!==!1&&(Kee[e]=t)}function $2e(t,e){var r=!1;if(t&&e){var n=Eo(t);if(n&&n[tr]>0)for(var o=e[R9](),s=0;s<n[tr];s++){var a=n[s];if(a&&ji(e,a)&&a[R9]()===o){r=!0;break}}}return r}function KE(t,e,r,n){e&&r&&r[tr]>0&&(n&&Wee[e]?(t[zv][Wee[e]]=r,t[k9]=!0):t.url+="&"+e+"="+r)}function Dat(t,e,r){for(var n=0;n<t[tr];n++)if(t[n].name===e){t[n].value=r;return}t[Yo]({name:e,value:r})}function Nat(t,e){for(var r=0;r<t[tr];r++)if(t[r].name===e){t[Jb](r,1);return}}var r_,$ee,kat,Pat,Aat,Wee,Kee,W2e,K2e=R(()=>{Wo();Qb();St();M2e();rA();U2e();Gee();z2e();zee();zE();$ee="sendAttempt",kat="&"+_2e+"=true",Pat="?cors=true&"+b9[R9]()+"="+Tee,Aat=(r_={},r_[1]=Eee,r_[100]=Eee,r_[200]="sent",r_[8004]=y9,r_[8003]=y9,r_),Wee={},Kee={};n_(tA,tA,!1);n_(_9,_9);n_(Ree,"Client-Id");n_(I9,I9);n_(x9,x9);n_(S9,S9);n_(Pee,Pee);W2e=function(){function t(e,r,n,o){var s,a,c,u,l=!1,d,p,f,m,h,g,v,y,b,_,S,I,T,A,B,j,F,ne,Y,N,w,P,q,U,Z,le,re;sr(t,this,function(X){Et();var Ve=!0;X[Zb]=function(J,Pe,He){U||(h=Pe,I=Pe.getCookieMgr(),p=He,f=p.diagLog(),zu(N,ao(J,function(pt){var $,ce=pt.cfg,ve=pt.cfg.extensionConfig[He.identifier];Z=WE(ve[P9],ve[A9]),Ko(ce.anonCookieName)?Dat(v,"anoncknm",ce.anonCookieName):Nat(v,"anoncknm"),w=ve[x2e],P=ve.payloadListener;var Ce=ve.httpXHROverride,G=ve[Dee]?ve[Dee]:ce.endpointUrl;s=G+Pat,A=Pt(ve[Nee])?!0:!ve[Nee],S=!ve[S2e];var ee=ve.valueSanitizer,pe=ve[I2e],Te=!!ce[D9];Pt(ve[D9])||(Te=!!ve[D9]),B=ve.xhrTimeout,j=!!ve[Lee],F=!!ve[Oee],Y=ve[C2e]!==!1,le=!!ve[E2e],Pe.getPlugin("LocalStorage")&&(F=!0),l=!Dv(),_=new G2e(h,ee,pe,Te,BE,le),Ee(ve[Mee])||(l=!!ve[Mee]);var et=yt();re?re.SetConfig(et):(re=new Wb,re[Zb](et,f));var Ne=Ce,vr=ve[Fee]?Ce:null,wr=ve[Fee]?Ce:null,zi=[3,2];if(!Ce){g=!1;var sc=[];Dv()?(sc=[2,1],zi=[2,1,3]):sc=[1,2,3],sc=bm(sc,ve.transports),Ce=ie(sc,!1),Ce||ba(f,"No available transport to send events"),Ne=ie(sc,!0)}vr||(zi=bm(zi,ve[T2e]),vr=ie(zi,!0)),ne=!g&&(l&&rc()||!F&&gm(!0)),m=($={},$[0]=Ce,$[1]=Ne||ie([1,2,3],!0),$[2]=vr||Ne||ie([1],!0),$[3]=wr||ie([2,3],!0)||Ne||ie([1],!0),$)})),U=!0)},X.addResponseHandler=function(J){return q[Yo](J),{rm:function(){var Pe=q.indexOf(J);Pe>=0&&q[Jb](Pe,1)}}},X[N9]=function(J){try{if(_)return _.getEventBlob(J)}catch{}return Xl},X[L9]=function(){try{var J=_&&_[Uee](0,!1,!1,!1,1,0);return Dn(J,A)}catch{}return null};function ie(J,Pe){try{return re&&re.getSenderInst(J,Pe)}catch{}return null}X._getDbgPlgTargets=function(){return[m[0],a,_,m]};function yt(){try{var J={xdrOnComplete:Ye,fetchOnComplete:Cr,xhrOnComplete:be,beaconOnRetry:H},Pe={enableSendPromise:!1,isOneDs:!0,disableCredentials:!Ve,disableXhr:!1,disableBeacon:!l,disableBeaconSync:!l,disableFetchKeepAlive:F,timeWrapper:Z,addNoResponse:Y,senderOnCompleteCallBack:J};return Pe}catch{}return null}function Ye(J,Pe,He){var pt=Ql(J);ct(Pe,200,{},pt),Zl(pt)}function Et(){var J;s=null,a=new F2e,c=!1,u=new O2e,l=!1,d=0,p=null,f=null,m=null,h=null,g=!0,v=[],y={},b=[],_=null,S=!1,I=null,T=!1,A=!1,B=J,j=J,F=J,ne=J,Y=J,N=[],w=J,P=J,q=[],U=!1,Z=WE(),le=!1,re=null}function Cr(J,Pe,He,pt){var $=function(Ce,G,ee){ct(Pe,Ce,G,ee),Zl(ee)},ce={},ve=J[e_];ve&&ve.forEach(function(Ce,G){ce[G]=Ce}),$(J.status,ce,He||Xl)}function be(J,Pe,He){var pt=Ql(J);ct(Pe,J.status,_m(J,!0),pt),Zl(pt)}function ct(J,Pe,He,pt){try{J(Pe,He,pt)}catch($){Me(f,2,518,We($))}}function H(J,Pe,He){var pt=J,$=200,ce=pt[HE],ve=J[Bee]+(Y?kat:Xl);try{var Ce=io();if(ce){var G=!!h.getPlugin("LocalStorage"),ee=[],pe=[];_e(ce[Hs],function(Te){if(ee&&Te&&Te[Gi]()>0)for(var et=Te[Ap](),Ne=0;Ne<et[tr];Ne++)if(Ce.sendBeacon(ve,_.getEventBlob(et[Ne])))pe[Yo](Te[Ne]);else{ee[Yo](Te[Dp](Ne));break}else ee[Yo](Te[Dp](0))}),pe[tr]>0&&(ce.sentEvts=pe),G||Sa(ee,8003,ce[ic],!0)}else $=0}catch(Te){ba(f,"Failed to send telemetry using sendBeacon API. Ex:"+We(Te)),$=0}finally{ct(Pe,$,{},Xl)}}function de(J){return J===2||J===3}function he(J){return T&&de(J)&&(J=2),J}X[oA]=function(J,Pe){y[J]=Pe},X.removeHeader=function(J){delete y[J]},X[sA]=function(){return ke()&&u[nA]()},X[jE]=function(J,Pe){Pt(J)&&(J=0),T&&(J=he(J),Pe=2),ut(b,J,0)&&on(Ie(),0,!1,J,Pe||0)},X[O9]=function(){return!c&&d===0&&b[tr]===0},X[aA]=function(J){T=J},X.addBatch=function(J){if(J&&J[Gi]()>0){if(a.isTenantKilled(J[Zu]()))return!1;b[Yo](J)}return!0},X.teardown=function(){b[tr]>0&&on(Ie(),0,!0,2,2),_e(N,function(J){J&&J.rm&&J.rm()}),N=[]},X.pause=function(){c=!0},X.resume=function(){c=!1,X[jE](0,4)},X[M9]=function(J,Pe,He){J&&J[Gi]()>0&&(Ee(Pe)&&(Pe=1),T&&(Pe=he(Pe),He=2),on([J],0,!1,Pe,He||0))};function ke(){return!c&&d<r}function Ie(){var J=b;return b=[],J}function ut(J,Pe,He){var pt=!1;return J&&J[tr]>0&&!c&&m[Pe]&&_&&(pt=Pe!==0||ke()&&(He>0||u[nA]())),pt}function It(J){var Pe={};return J&&_e(J,function(He,pt){Pe[pt]={iKey:He[Zu](),evts:He[Ap]()}}),Pe}function on(J,Pe,He,pt,$){if(!(!J||J[tr]===0)){if(c){Sa(J,1,pt);return}pt=he(pt);try{var ce=J,ve=pt!==0;ki(h,function(){return"HttpManager:_sendBatches"},function(Ce){Ce&&(J=J.slice(0));for(var G=[],ee=null,pe=nc(),Te=m[pt]||(ve?m[1]:m[0]),et=Te&&Te[F9],Ne=ne&&(T||de(pt)||et===3||Te._isSync&&et===2);ut(J,pt,Pe);){var vr=J.shift();vr&&vr[Gi]()>0&&(a.isTenantKilled(vr[Zu]())?G[Yo](vr):(ee=ee||_[Uee](Pe,He,ve,Ne,$,pt),_.appendPayload(ee,vr,e)?ee.overflow!==null&&(J=[ee.overflow][Pp](J),ee.overflow=null,zs(ee,pe,nc(),$),pe=nc(),ee=null):(zs(ee,pe,nc(),$),pe=nc(),J=[vr][Pp](J),ee=null)))}ee&&zs(ee,pe,nc(),$),J[tr]>0&&(b=J[Pp](b)),Sa(G,8004,pt)},function(){return{batches:It(ce),retryCount:Pe,isTeardown:He,isSynchronous:ve,sendReason:$,useSendBeacon:de(pt),sendType:pt}},!ve)}catch(Ce){Me(f,2,48,"Unexpected Exception sending batch: "+We(Ce))}}}function Dn(J,Pe){var He={url:s,hdrs:{},useHdrs:!1};Pe?(He[zv]=Yb(He[zv],y),He.useHdrs=Eo(He.hdrs)[tr]>0):Ze(y,function(Ce,G){Kee[Ce]?KE(He,Kee[Ce],G,!1):(He[zv][Ce]=G,He[k9]=!0)}),KE(He,Ree,"NO_AUTH",Pe),KE(He,_9,UE,Pe);var pt=Xl;_e(J.apiKeys,function(Ce){pt[tr]>0&&(pt+=","),pt+=Ce}),KE(He,I9,pt,Pe),KE(He,S9,li().toString(),Pe);var $=wT(J);if(Ko($)&&(He.url+="&ext.intweb.msfpc="+$),u[T9]()&&KE(He,x9,u[w9](),Pe),h[VE]){var ce=h[VE]();ce>=0&&(He.url+="&w="+ce)}for(var ve=0;ve<v[tr];ve++)He.url+="&"+v[ve].name+"="+v[ve].value;return He}function pi(J,Pe,He){J[Pe]=J[Pe]||{},J[Pe][p.identifier]=He}function zs(J,Pe,He,pt){if(J&&J.payloadBlob&&J.payloadBlob[tr]>0){var $=!!w,ce=m[J.sendType];!de(J[ic])&&J[qee]&&J.sendReason===2&&(ce=m[2]||m[3]||ce);var ve=A;(J.isBeacon||ce[F9]===3)&&(ve=!1);var Ce=Dn(J,ve);ve=ve||Ce[k9];var G=nc();ki(h,function(){return"HttpManager:_doPayloadSend"},function(){for(var ee=0;ee<J.batches[tr];ee++)for(var pe=J[Hs][ee],Te=pe[Ap](),et=0;et<Te[tr];et++){var Ne=Te[et];if(S){var vr=Ne[cA]=Ne[cA]||{};pi(vr,"sendEventStart",G),pi(vr,"serializationStart",Pe),pi(vr,"serializationCompleted",He)}Ne[$ee]>0?Ne[$ee]++:Ne[$ee]=1}Sa(J[Hs],1e3+(pt||0),J[ic],!0);var wr={data:J.payloadBlob,urlString:Ce.url,headers:Ce[zv],_thePayload:J,_sendReason:pt,timeout:B,disableXhrSync:j,disableFetchKeepAlive:F};ve&&($2e(wr[e_],wee)||(wr[e_][wee]=g2e),$2e(wr[e_],b9)||(wr[e_][b9]=Tee));var zi=null;ce&&(zi=function(sc){u[E9]();var zm=function($m,S0){C_($m,S0,J,pt)},$s=J[U9]||J[B9];try{ce.sendPOST(sc,zm,$s),P&&P(wr,sc,$s,J[qee])}catch($m){ba(f,"Unexpected exception sending payload. Ex:"+We($m)),ct(zm,0,{})}}),ki(h,function(){return"HttpManager:_doPayloadSend.sender"},function(){if(zi)if(J[ic]===0&&d++,$&&!J.isBeacon&&ce[F9]!==3){var sc={data:wr[GE],urlString:wr[Bee],headers:Yb({},wr[e_]),timeout:wr.timeout,disableXhrSync:wr[Lee],disableFetchKeepAlive:wr[Oee]},zm=!1;ki(h,function(){return"HttpManager:_doPayloadSend.sendHook"},function(){try{w(sc,function($s){zm=!0,!g&&!$s[HE]&&($s[HE]=$s[HE]||wr[HE],$s[q9]=$s[q9]||wr[q9]),zi($s)},J.isSync||J[U9])}catch{zm||zi(wr)}})}else zi(wr)})},function(){return{thePayload:J,serializationStart:Pe,serializationCompleted:He,sendReason:pt}},J[B9])}J.sizeExceed&&J.sizeExceed[tr]>0&&Sa(J.sizeExceed,8003,J[ic]),J.failedEvts&&J.failedEvts[tr]>0&&Sa(J.failedEvts,8002,J[ic])}function Vp(J,Pe){S&&_e(J,function(He){var pt=He[cA]=He[cA]||{};pi(pt,"sendEventCompleted",Pe)})}function C_(J,Pe,He,pt){var $=9e3,ce=null,ve=!1,Ce=!1;try{var G=!0;if(typeof J!==lp){if(Pe){u[iA](Pe[b2e]);var ee=Pe[y2e]||Pe["kill-duration-seconds"];_e(a[H9](Pe[v2e],ee),function(Te){_e(He[Hs],function(et){if(et[Zu]()===Te){ce=ce||[];var Ne=et[Dp](0);He.numEvents-=Ne[Gi](),ce[Yo](Ne)}})})}if(J==200||J==204){$=200;return}(!q2e(J)||He.numEvents<=0)&&(G=!1),$=9e3+J%1e3}if(G){$=100;var pe=He.retryCnt;He[ic]===0&&(pe<n?(ve=!0,Gp(function(){He[ic]===0&&d--,on(He[Hs],pe+1,He[U9],T?2:He[ic],5)},T,G9(pe))):(Ce=!0,T&&($=8001)))}}finally{ve||(u[iA](),x0(He,$,pt,Ce)),Sa(ce,8004,He[ic])}}function x0(J,Pe,He,pt){try{pt&&p[j9]();var $=J[Hs];Pe===200&&($=J.sentEvts||J[Hs],!pt&&!J[B9]&&p._clearBackOff(),E_($)),Sa($,Pe,J[ic],!0)}finally{J[ic]===0&&(d--,He!==5&&X.sendQueuedRequests(J[ic],He))}}function E_(J){if(S){var Pe=nc();_e(J,function(He){He&&He[Gi]()>0&&Vp(He[Ap](),Pe)})}}function Gp(J,Pe,He){Pe?J():Z.set(J,He)}function wT(J){for(var Pe=0;Pe<J.batches[tr];Pe++){var He=J[Hs][Pe].Msfpc();if(He)return encodeURIComponent(He)}return Xl}function Zl(J){var Pe=q;try{for(var He=0;He<Pe[tr];He++)try{Pe[He](J)}catch($){Me(f,1,519,"Response handler failed: "+$)}if(J){var pt=JSON.parse(J);Ko(pt.webResult)&&Ko(pt.webResult[qE])&&I.set("MSFPC",pt.webResult[qE],365*86400)}}catch{}}function Sa(J,Pe,He,pt){if(J&&J[tr]>0&&o){var $=o[Gm(Pe)];if($){var ce=He!==0;ki(h,function(){return"HttpManager:_sendBatchesNotification"},function(){Gp(function(){try{$.call(o,J,Pe,ce,He)}catch(ve){Me(f,1,74,"send request notification failed: "+ve)}},pt||ce,0)},function(){return{batches:It(J),reason:Pe,isSync:ce,sendSync:pt,sendType:He}},!ce)}}}function Gm(J){var Pe=Aat[J];return Ko(Pe)||(Pe=h2e,J>=9e3&&J<=9999?Pe=m2e:J>=8e3&&J<=8999?Pe=y9:J>=1e3&&J<=1999&&(Pe=f2e)),Pe}})}return t.__ieDyn=1,t}()});function Bat(t){return t&&t.sendPOST}var Lat,Y2e,Oat,J2e,Z2e,Mat,Q2e,Fat,Yee,i_,X2e,Ro,Uat,ePe,tPe=R(()=>{Ya();Wo();Qb();bE();St();Cee();Vee();K2e();rA();Gee();zee();zE();Lat=.25,Y2e=500,Oat=20,J2e=6,Z2e=2,Mat=4,Q2e=2,Fat=1,Yee=1e4,i_="eventsDiscarded",X2e="",Ro=void 0,Uat=ga({eventsLimitInMem:{isVal:Gv,v:Yee},immediateEventLimit:{isVal:Gv,v:500},autoFlushEventsLimit:{isVal:Gv,v:0},disableAutoBatchFlushLimit:!1,httpXHROverride:{isVal:Bat,v:Ro},overrideInstrumentationKey:Ro,overrideEndpointUrl:Ro,disableTelemetry:!1,ignoreMc1Ms0CookieProcessing:!1,setTimeoutOverride:Ro,clearTimeoutOverride:Ro,payloadPreprocessor:Ro,payloadListener:Ro,disableEventTimings:Ro,valueSanitizer:Ro,stringifyObjects:Ro,enableCompoundKey:Ro,disableOptimizeObj:!1,transports:Ro,unloadTransports:Ro,useSendBeacon:Ro,disableFetchKeepAlive:Ro,avoidOptions:!1,xhrTimeout:Ro,disableXhrSync:Ro,alwaysUseXhrOverride:!1,maxEventRetryAttempts:{isVal:Fs,v:J2e},maxUnloadEventRetryAttempts:{isVal:Fs,v:Z2e},addNoResponse:Ro,excludeCsMetaData:Ro});ePe=function(t){Ka(e,t);function e(){var r=t.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="4.1.1";var n,o=!1,s=[],a,c=!1,u=0,l,d=0,p,f={},m=Xb,h,g,v,y,b,_,S,I,T,A,B,j,F,ne,Y,N,w,P,q,U,Z,le;return sr(e,r,function(re,X){ke(),re._getDbgPlgTargets=function(){return[b,n]},re[Zb]=function(G,ee,pe){ki(ee,function(){return"PostChannel:initialize"},function(){X[Zb](G,ee,pe),q=ee.getNotifyMgr();try{Y=jc(vs(re[uA]),ee.evtNamespace&&ee.evtNamespace()),re._addHook(ao(G,function(Te){var et=Te.cfg,Ne=_a(null,et,ee);n=Ne.getExtCfg(re[uA],Uat),N=WE(n[P9],n[A9]),B=!n[R2e]&&m9(),w=n[k2e],ie(ee),p=n[Hee],l=n.immediateEventLimit,S=n[jee],F=n.maxEventRetryAttempts,ne=n.maxUnloadEventRetryAttempts,P=n[P2e],Ce(),Z=n[A2e],le=!!n[D2e],U&&Ve();var vr=et.disablePageUnloadEvents||[];U=KP(Et,vr,Y),U=OE(Et,vr,Y)||U,U=ME(Cr,et.disablePageShowEvents,Y)||U})),b[Zb](G,re.core,re)}catch(Te){throw re.setInitialized(!1),Te}},function(){return{theConfig:G,core:ee,extensions:pe}})},re.processTelemetry=function(G,ee){eA(G,re[uA]),ee=ee||re._getTelCtx(ee);var pe=G;!le&&!o&&(Z&&(pe[Zu]=Z),ct(pe,!0),j?It(2,2):he()),re.processNext(pe,ee)},re.getOfflineSupport=function(){try{var G=b&&b[L9]();if(G)return{getUrl:function(){return G.url},serialize:Ye,batch:yt,shouldProcess:function(ee){return!le},createPayload:function(ee){return{urlString:G.url,headers:G[zv],data:ee}}}}catch{}return null},re._doTeardown=function(G,ee){It(2,2),o=!0,b.teardown(),Ve(),ke()};function Ve(){YP(null,Y),QP(null,Y),XP(null,Y)}function ie(G){var ee=G[VE];G[VE]=function(){var pe=0;return w&&(pe=pe|2),pe|ee.call(G)}}function yt(G){var ee=X2e;return G&&G[tr]&&_e(G,function(pe){ee&&(ee+=`
`),ee+=pe}),ee}function Ye(G){var ee=X2e;try{be(G),ee=b[N9](G)}catch{}return ee}function Et(G){var ee=G||ui().event;ee.type!=="beforeunload"&&(j=!0,b[aA](j)),It(2,2)}function Cr(G){j=!1,b[aA](j)}function be(G){G.ext&&G.ext[Aee]&&delete G.ext[Aee],G.ext&&G.ext[C9]&&G.ext[C9].id&&delete G.ext[C9].id,B&&(G.ext=Xu(G.ext),G[V9]&&(G[V9]=Xu(G[V9])),G[GE]&&(G[GE]=Xu(G[GE])))}function ct(G,ee){if(G[lA]||(G[lA]=0),G[$v]||(G[$v]=1),be(G),G[t_]){if(v||c)G[$v]=3,G[t_]=!1;else if(b){B&&(G=Xu(G)),b[M9]($E.create(G[Zu],[G]),G[t_]===!0?1:G[t_],3);return}}var pe=G[$v],Te=d,et=p;pe===4&&(Te=u,et=l);var Ne=!1;if(Te<et)Ne=!zs(G,ee);else{var vr=1,wr=Oat;pe===4&&(vr=4,wr=1),Ne=!0,Vp(G[Zu],G[$v],vr,wr)&&(Ne=!zs(G,ee))}Ne&&J(i_,[G],Vl.QueueFull)}re.setEventQueueLimits=function(G,ee){n[Hee]=p=Gv(G)?G:Yee,n[jee]=S=Gv(ee)?ee:0,Ce();var pe=d>G;if(!pe&&I>0)for(var Te=1;!pe&&Te<=3;Te++){var et=_[Te];et&&et[Hs]&&_e(et[Hs],function(Ne){Ne&&Ne[Gi]()>=I&&(pe=!0)})}pi(!0,pe)},re.pause=function(){ut(),c=!0,b.pause()},re.resume=function(){c=!1,b.resume(),he()},re._loadTransmitProfiles=function(G){wT(),Ze(G,function(ee,pe){var Te=pe[tr];if(Te>=2){var et=Te>2?pe[2]:0;if(pe[Jb](0,Te-2),pe[1]<0&&(pe[0]=-1),pe[1]>0&&pe[0]>0){var Ne=pe[0]/pe[1];pe[0]=Math.ceil(Ne)*pe[1]}et>=0&&pe[1]>=0&&et>pe[1]&&(et=pe[1]),pe[Yo](et),f[ee]=pe}})},re.flush=function(G,ee,pe){G===void 0&&(G=!0);var Te;if(!c)if(pe=pe||1,G)ee||(Te=ya(function(Ne){ee=Ne})),a==null?(ut(),x0(1,0,pe),a=Ie(function(){a=null,E_(ee,pe)},0)):s[Yo](ee);else{var et=ut();H(1,1,pe),ee&&ee(),et&&he()}return Te},re.setMsaAuthTicket=function(G){b[oA](tA,G)},re.setAuthPluginHeader=function(G){b[oA](kee,G)},re.removeAuthPluginHeader=function(){b.removeHeader(kee)},re.hasEvents=de,re._setTransmitProfile=function(G){m!==G&&f[G]!==void 0&&(ut(),m=G,he())},Hc(re,function(){return b},["addResponseHandler"]);function H(G,ee,pe){var Te=x0(G,ee,pe);return b[jE](ee,pe),Te}function de(){return d>0}function he(){if(T>=0&&x0(T,0,A)&&b[jE](0,A),u>0&&!g&&!c){var G=f[m][2];G>=0&&(g=Ie(function(){g=null,H(4,0,1),he()},G))}var ee=f[m][1];!h&&!a&&ee>=0&&!c&&(de()?h=Ie(function(){h=null,H(y===0?3:1,0,1),y++,y%=2,he()},ee):y=0)}re[j9]=function(){v<Mat&&(v++,ut(),he())},re._clearBackOff=function(){v&&(v=0,ut(),he())};function ke(){n=null,o=!1,s=[],a=null,c=!1,u=0,l=500,d=0,p=Yee,f={},m=Xb,h=null,g=null,v=0,y=0,_={},S=0,U=!1,I=0,T=-1,A=null,B=!0,j=!1,F=J2e,ne=Z2e,Y=null,Z=null,le=!1,N=WE(),b=new W2e(Y2e,Q2e,Fat,{requeue:Sa,send:He,sent:pt,drop:$,rspFail:ce,oth:ve}),Zl(),on(),Ce()}function Ie(G,ee){ee===0&&v&&(ee=1);var pe=1e3;return v&&(pe=G9(v-1)),N.set(G,ee*pe)}function ut(){return h!==null?(h.cancel(),h=null,y=0,!0):!1}function It(G,ee){ut(),a&&(a.cancel(),a=null),c||H(1,G,ee)}function on(){_[4]={batches:[],iKeyMap:{}},_[3]={batches:[],iKeyMap:{}},_[2]={batches:[],iKeyMap:{}},_[1]={batches:[],iKeyMap:{}}}function Dn(G,ee,pe){var Te=_[ee];Te||(ee=1,Te=_[ee]);var et=Te.iKeyMap[G];return!et&&pe&&(et=$E.create(G),Te.batches[Yo](et),Te.iKeyMap[G]=et),et}function pi(G,ee){b[sA]()&&!v&&(S>0&&d>S&&(ee=!0),ee&&a==null&&re.flush(G,function(){},20))}function zs(G,ee){B&&(G=Xu(G));var pe=G[$v],Te=Dn(G[Zu],pe,!0);return Te.addEvent(G)?(pe!==4?(d++,ee&&G[lA]===0&&pi(!G.sync,I>0&&Te[Gi]()>=I)):u++,!0):!1}function Vp(G,ee,pe,Te){for(;pe<=ee;){var et=Dn(G,ee,!0);if(et&&et[Gi]()>0){var Ne=et[Dp](0,Te),vr=Ne[Gi]();if(vr>0)return pe===4?u-=vr:d-=vr,Pe(i_,[Ne],Vl.QueueFull),!0}pe++}return C_(),!1}function C_(){for(var G=0,ee=0,pe=function(et){var Ne=_[et];Ne&&Ne[Hs]&&_e(Ne[Hs],function(vr){et===4?G+=vr[Gi]():ee+=vr[Gi]()})},Te=1;Te<=4;Te++)pe(Te);d=ee,u=G}function x0(G,ee,pe){var Te=!1,et=ee===0;return!et||b[sA]()?ki(re.core,function(){return"PostChannel._queueBatches"},function(){for(var Ne=[],vr=4;vr>=G;){var wr=_[vr];wr&&wr.batches&&wr.batches[tr]>0&&(_e(wr[Hs],function(zi){b.addBatch(zi)?Te=Te||zi&&zi[Gi]()>0:Ne=Ne[Pp](zi[Ap]()),vr===4?u-=zi[Gi]():d-=zi[Gi]()}),wr[Hs]=[],wr.iKeyMap={}),vr--}Ne[tr]>0&&J(i_,Ne,Vl.KillSwitch),Te&&T>=G&&(T=-1,A=0)},function(){return{latency:G,sendType:ee,sendReason:pe}},!et):(T=T>=0?Math.min(T,G):G,A=Math.max(A,pe)),Te}function E_(G,ee){H(1,0,ee),C_(),Gp(function(){G&&G(),s[tr]>0?a=Ie(function(){a=null,E_(s.shift(),ee)},0):(a=null,he())})}function Gp(G){b[O9]()?G():a=Ie(function(){a=null,Gp(G)},Lat)}function wT(){ut(),Zl(),m=Xb,he()}function Zl(){f={},f[Xb]=[2,1,0],f[g9]=[6,3,0],f[v9]=[18,9,0]}function Sa(G,ee){var pe=[],Te=F;j&&(Te=ne),_e(G,function(et){et&&et[Gi]()>0&&_e(et[Ap](),function(Ne){Ne&&(Ne[t_]&&(Ne[$v]=4,Ne[t_]=!1),Ne[lA]<Te?(eA(Ne,re[uA]),ct(Ne,!1)):pe[Yo](Ne))})}),pe[tr]>0&&J(i_,pe,Vl.NonRetryableStatus),j&&It(2,2)}function Gm(G,ee){var pe=q||{},Te=pe[G];if(Te)try{Te.apply(pe,ee)}catch(et){Me(re.diagLog(),1,74,G+" notification failed: "+et)}}function J(G,ee){for(var pe=[],Te=2;Te<arguments.length;Te++)pe[Te-2]=arguments[Te];ee&&ee[tr]>0&&Gm(G,[ee][Pp](pe))}function Pe(G,ee){for(var pe=[],Te=2;Te<arguments.length;Te++)pe[Te-2]=arguments[Te];ee&&ee[tr]>0&&_e(ee,function(et){et&&et[Gi]()>0&&Gm(G,[et.events()][Pp](pe))})}function He(G,ee,pe){G&&G[tr]>0&&Gm("eventsSendRequest",[ee>=1e3&&ee<=1999?ee-1e3:0,pe!==!0])}function pt(G,ee){Pe("eventsSent",G,ee),he()}function $(G,ee){Pe(i_,G,ee>=8e3&&ee<=8999?ee-8e3:Vl.Unknown)}function ce(G){Pe(i_,G,Vl.NonRetryableStatus),he()}function ve(G,ee){Pe(i_,G,Vl.Unknown),he()}function Ce(){P?I=0:I=Math.max(Y2e*(Q2e+1),p/6)}}),r}return e.__ieDyn=1,e}(Tm)});var rPe={};mn(rPe,{BE_PROFILE:()=>v9,NRT_PROFILE:()=>g9,PostChannel:()=>ePe,RT_PROFILE:()=>Xb});var nPe=R(()=>{Cee();tPe()});var oPe=M(Np=>{"use strict";var qat=Np&&Np.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Hat=Np&&Np.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),iPe=Np&&Np.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&qat(e,t,r);return Hat(e,t),e};Object.defineProperty(Np,"__esModule",{value:!0});Np.oneDataSystemClientFactory=void 0;var jat=async(t,e,r)=>{let n=await Promise.resolve().then(()=>iPe((Qb(),$i(p2e)))),o=await Promise.resolve().then(()=>iPe((nPe(),$i(rPe)))),s=new n.AppInsightsCore,a=new o.PostChannel,c={instrumentationKey:t,endpointUrl:"https://mobile.events.data.microsoft.com/OneCollector/1.0",loggingLevelTelemetry:0,loggingLevelConsole:0,disableCookiesUsage:!0,disableDbgExt:!0,disableInstrumentationKeyValidation:!0,channels:[[a]]};if(r){c.extensionConfig={};let d={alwaysUseXhrOverride:!0,httpXHROverride:r};c.extensionConfig[a.identifier]=d}let l=e.workspace.getConfiguration("telemetry").get("internalTesting");return s.initialize(c,[]),s.addTelemetryInitializer(d=>{d.ext=d.ext??{},d.ext.web=d.ext.web??{},d.ext.web.consentDetails='{"GPC_DataSharingOptIn":false}',l&&(d.ext.utc=d.ext.utc??{},d.ext.utc.flags=8462029)}),s},Vat=async(t,e,r)=>{let n=await jat(t,e,r);return{logEvent:(a,c)=>{try{n?.track({name:a,baseData:{name:a,properties:c?.properties,measurements:c?.measurements}})}catch(u){throw new Error(`Failed to log event to app insights!
`+u.message)}},flush:async()=>{try{return new Promise((c,u)=>{if(!n){c();return}n.flush(!0,l=>{if(!l){u("Failed to flush app 1DS!");return}})})}catch(a){throw new Error(`Failed to flush 1DS!
`+a.message)}},dispose:async()=>new Promise(c=>{if(!n){c();return}n.unload(!1,()=>{c(),n=void 0},1e3)})}};Np.oneDataSystemClientFactory=Vat});var sPe,YE,QE,dA,Wv,Lp,ko,$9,el=R(()=>{sPe="Microsoft_ApplicationInsights_BypassAjaxInstrumentation",YE="sampleRate",QE="ProcessLegacy",dA="http.method",Wv="https://dc.services.visualstudio.com",Lp="/v2/track",ko="not_specified",$9="iKey"});var o_,Qee=R(()=>{en();o_=KJ({requestContextHeader:[0,"Request-Context"],requestContextTargetKey:[1,"appId"],requestContextAppIdFormat:[2,"appId=cid-v1:"],requestIdHeader:[3,"Request-Id"],traceParentHeader:[4,"traceparent"],traceStateHeader:[5,"tracestate"],sdkContextHeader:[6,"Sdk-Context"],sdkContextHeaderAppIdRequest:[7,"appId"],requestContextHeaderLowerCase:[8,"request-context"]})});var Am,Dt,Op,Kv,Dm,Nm,W9,co,Jl,Yv,K9,Y9,Q9,Xee,X9,J9,s_,XE,Jee,pA,a_,tl,ys,js,c_,Mp,u_,Z9,e7,Zee,l_,Qv,fA,mA,d_,JE,p_,ete,Po=R(()=>{Am="split",Dt="length",Op="toLowerCase",Kv="ingestionendpoint",Dm="toString",Nm="push",W9="removeItem",co="name",Jl="message",Yv="count",K9="preTriggerDate",Y9="disabled",Q9="interval",Xee="daysOfMonth",X9="date",J9="getUTCDate",s_="stringify",XE="pathname",Jee="correlationHeaderExcludePatterns",pA="extensionConfig",a_="exceptions",tl="parsedStack",ys="properties",js="measurements",c_="sizeInBytes",Mp="typeName",u_="severityLevel",Z9="problemGroup",e7="isManual",Zee="CreateFromInterface",l_="assembly",Qv="fileName",fA="hasFullStack",mA="level",d_="method",JE="line",p_="duration",ete="receivedResponse"});function t7(t,e,r){var n=e[Dt],o=tte(t,e);if(o[Dt]!==n){for(var s=0,a=o;r[a]!==void 0;)s++,a=Ti(o,0,147)+rte(s);o=a}return o}function tte(t,e){var r;return e&&(e=Fr(zn(e)),e[Dt]>150&&(r=Ti(e,0,150),Me(t,2,57,"name is too long.  It has been truncated to 150 characters.",{name:e},!0))),r||e}function fn(t,e,r){r===void 0&&(r=1024);var n;return e&&(r=r||1024,e=Fr(zn(e)),e[Dt]>r&&(n=Ti(e,0,r),Me(t,2,61,"string value is too long. It has been truncated to "+r+" characters.",{value:e},!0))),n||e}function Xv(t,e){return i7(t,e,2048,66)}function ZE(t,e){var r;return e&&e[Dt]>32768&&(r=Ti(e,0,32768),Me(t,2,56,"message is too long, it has been truncated to 32768 characters.",{message:e},!0)),r||e}function r7(t,e){var r;if(e){var n=""+e;n[Dt]>32768&&(r=Ti(n,0,32768),Me(t,2,52,"exception is too long, it has been truncated to 32768 characters.",{exception:e},!0))}return r||e}function Vs(t,e){if(e){var r={};Ze(e,function(n,o){if(Pn(o)&&yp())try{o=gs()[s_](o)}catch(s){Me(t,2,49,"custom property is not valid",{exception:s},!0)}o=fn(t,o,8192),n=t7(t,n,r),r[n]=o}),e=r}return e}function Gs(t,e){if(e){var r={};Ze(e,function(n,o){n=t7(t,n,r),r[n]=o}),e=r}return e}function n7(t,e){return e&&i7(t,e,128,69)[Dm]()}function i7(t,e,r,n){var o;return e&&(e=Fr(zn(e)),e[Dt]>r&&(o=Ti(e,0,r),Me(t,2,n,"input is too long, it has been truncated to "+r+" characters.",{data:e},!0))),o||e}function rte(t){var e="00"+t;return ql(e,e[Dt]-3)}var rl=R(()=>{en();St();Po()});function f_(t){var e=cPe,r=Gat,n=r[e];return aPe.createElement?r[e]||(n=r[e]=aPe.createElement("a")):n={host:nte(t,!0)},n.href=t,e++,e>=r[Dt]&&(e=0),cPe=e,n}function uPe(t){var e,r=f_(t);return r&&(e=r.href),e}function lPe(t){var e,r=f_(t);return r&&(e=r[XE]),e}function dPe(t,e){return t?t.toUpperCase()+" "+e:e}function nte(t,e){var r=hA(t,e)||"";if(r){var n=r.match(/(www\d{0,5}\.)?([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[Dt]>3&&Ft(n[2])&&n[2][Dt]>0)return n[2]+(n[3]||"")}return r}function hA(t,e){var r=null;if(t){var n=t.match(/(\w{1,150}):\/\/([^\/:]{1,256})(:\d{1,20})?/i);if(n!=null&&n[Dt]>2&&Ft(n[2])&&n[2][Dt]>0&&(r=n[2]||"",e&&n[Dt]>2)){var o=(n[1]||"")[Op](),s=n[3]||"";(o==="http"&&s===":80"||o==="https"&&s===":443")&&(s=""),r+=s}}return r}var aPe,cPe,Gat,ite=R(()=>{en();Po();aPe=ci()||{},cPe=0,Gat=[null,null,null,null,null]});function gA(t){return Pr(zat,t[Op]())!==-1}function pPe(t){ote=t}function fPe(){return ote}function mPe(t,e,r){if(!e||t&&t.disableCorrelationHeaders)return!1;if(t&&t[Jee]){for(var n=0;n<t.correlationHeaderExcludePatterns[Dt];n++)if(t[Jee][n].test(e))return!1}var o=f_(e).host[Op]();if(o&&(va(o,":443")!==-1||va(o,":80")!==-1)&&(o=(hA(e,!0)||"")[Op]()),(!t||!t.enableCorsCorrelation)&&o&&o!==r)return!1;var s=t&&t.correlationHeaderDomains;if(s){var a;if(_e(s,function(l){var d=new RegExp(l.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));a=a||d.test(o)}),!a)return!1}var c=t&&t.correlationHeaderExcludedDomains;if(!c||c[Dt]===0)return!0;for(var n=0;n<c[Dt];n++){var u=new RegExp(c[n].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));if(u.test(o))return!1}return o&&o[Dt]>0}function hPe(t){if(t){var e=ste(t,o_[1]);if(e&&e!==ote)return e}}function ste(t,e){if(t)for(var r=t[Am](","),n=0;n<r[Dt];++n){var o=r[n][Am]("=");if(o[Dt]===2&&o[0]===e)return o[1]}}function gPe(t,e,r,n){var o,s=n,a=n;if(e&&e[Dt]>0){var c=f_(e);if(o=c.host,!s)if(c[XE]!=null){var u=c.pathname[Dt]===0?"/":c[XE];u.charAt(0)!=="/"&&(u="/"+u),a=c[XE],s=fn(t,r?r+" "+u:u)}else s=fn(t,e)}else o=n,s=n;return{target:o,name:s,data:a}}function vPe(){var t=dm();if(t&&t.now&&t.timing){var e=t.now()+t.timing.navigationStart;if(e>0)return e}return li()}function yPe(t,e){var r=null;return t!==0&&e!==0&&!Ee(t)&&!Ee(e)&&(r=e-t),r}function bPe(t,e){var r=t||{};return{getName:function(){return r[co]},setName:function(n){e&&e.setName(n),r[co]=n},getTraceId:function(){return r.traceID},setTraceId:function(n){e&&e.setTraceId(n),Ip(n)&&(r.traceID=n)},getSpanId:function(){return r.parentID},setSpanId:function(n){e&&e.setSpanId(n),Cp(n)&&(r.parentID=n)},getTraceFlags:function(){return r.traceFlags},setTraceFlags:function(n){e&&e.setTraceFlags(n),r.traceFlags=n}}}var zat,ote,ate=R(()=>{en();St();el();Qee();rl();ite();Po();zat=[Wv+Lp,"https://breeze.aimon.applicationinsights.io"+Lp,"https://dc-int.services.visualstudio.com"+Lp],ote="cid-v1:"});var eT,_Pe,xPe,cte=R(()=>{en();eT=oo({LocalStorage:0,SessionStorage:1}),_Pe=oo({AI:0,AI_AND_W3C:1,W3C:2}),xPe=oo({Normal:1,Critical:2})});function ute(){return tT()?o7(eT.LocalStorage):null}function o7(t){try{if(Ee(Us()))return null;var e=new Date()[Dm](),r=nn(t===eT.LocalStorage?"localStorage":"sessionStorage"),n=SPe+e;r.setItem(n,e);var o=r.getItem(n)!==e;if(r[W9](n),!o)return r}catch{}return null}function lte(){return m_()?o7(eT.SessionStorage):null}function IPe(){Jv=!1,Zv=!1}function s7(t){SPe=t||""}function CPe(){Jv=tT(!0),Zv=m_(!0)}function tT(t){return(t||Jv===void 0)&&(Jv=!!o7(eT.LocalStorage)),Jv}function a7(t,e){var r=ute();if(r!==null)try{return r.getItem(e)}catch(n){Jv=!1,Me(t,2,1,"Browser failed read of local storage. "+An(n),{exception:We(n)})}return null}function c7(t,e,r){var n=ute();if(n!==null)try{return n.setItem(e,r),!0}catch(o){Jv=!1,Me(t,2,3,"Browser failed write to local storage. "+An(o),{exception:We(o)})}return!1}function EPe(t,e){var r=ute();if(r!==null)try{return r[W9](e),!0}catch(n){Jv=!1,Me(t,2,5,"Browser failed removal of local storage item. "+An(n),{exception:We(n)})}return!1}function m_(t){return(t||Zv===void 0)&&(Zv=!!o7(eT.SessionStorage)),Zv}function TPe(){var t=[];return m_()&&Ze(nn("sessionStorage"),function(e){t[Nm](e)}),t}function u7(t,e){var r=lte();if(r!==null)try{return r.getItem(e)}catch(n){Zv=!1,Me(t,2,2,"Browser failed read of session storage. "+An(n),{exception:We(n)})}return null}function l7(t,e,r){var n=lte();if(n!==null)try{return n.setItem(e,r),!0}catch(o){Zv=!1,Me(t,2,4,"Browser failed write to session storage. "+An(o),{exception:We(o)})}return!1}function wPe(t,e){var r=lte();if(r!==null)try{return r[W9](e),!0}catch(n){Zv=!1,Me(t,2,6,"Browser failed removal of session storage item. "+An(n),{exception:We(n)})}return!1}var Jv,Zv,SPe,dte=R(()=>{en();cte();Po();Jv=void 0,Zv=void 0,SPe=""});var $at,RPe,kPe=R(()=>{en();St();dte();Po();$at="appInsightsThrottle",RPe=function(){function t(e,r){var n=this,o,s,a,c,u,l,d,p=!1,f=!1;h(),n._getDbgPlgTargets=function(){return[d]},n.getConfig=function(){return a},n.canThrottle=function(w){var P=ne(w),q=g(w);return b(q,o,P)},n.isTriggered=function(w){return Y(w)},n.isReady=function(){return p},n.flush=function(w){try{var P=N(w);if(P&&P[Dt]>0){var q=P.slice(0);return d[w]=[],_e(q,function(U){m(U.msgID,U[Jl],U.severity,!1)}),!0}}catch{}return!1},n.flushAll=function(){try{if(d){var w=!0;return Ze(d,function(P){var q=n.flush(parseInt(P));w=w&&q}),w}}catch{}return!1},n.onReadyState=function(w,P){return P===void 0&&(P=!0),p=Ee(w)?!0:w,p&&P?n.flushAll():null},n.sendMessage=function(w,P,q){return m(w,P,q,!0)};function m(w,P,q,U){if(p){var Z=F(w);if(!Z)return;var le=g(w),re=ne(w),X=b(le,o,re),Ve=!1,ie=0,yt=Y(w);try{X&&!yt?(ie=Math.min(le.limit.maxSendNumber,re[Yv]+1),re[Yv]=0,Ve=!0,u[w]=!0,re[K9]=new Date):(u[w]=X,re[Yv]+=1);var Ye=_(w);A(s,Ye,re);for(var Et=0;Et<ie;Et++)j(w,s,P,q)}catch{}return{isThrottled:Ve,throttleNum:ie}}else if(U){var Cr=N(w);Cr[Nm]({msgID:w,message:P,severity:q})}return null}function h(){s=Kl(e),u={},c={},d={},a={},v(109),l=_p(r)?r:"",e.addUnloadHook(ao(e.config,function(w){var P=w.cfg;o=tT();var q=P.throttleMgrCfg||{};Ze(q,function(U,Z){v(parseInt(U),Z)})}))}function g(w){return a[w]||a[109]}function v(w,P){var q,U;try{var Z=P||{},le={};le[Y9]=!!Z[Y9];var re=Z[Q9]||{};f=re?.daysOfMonth&&re?.daysOfMonth[Dt]>0,le[Q9]=y(re);var X={samplingRate:((q=Z.limit)===null||q===void 0?void 0:q.samplingRate)||100,maxSendNumber:((U=Z.limit)===null||U===void 0?void 0:U.maxSendNumber)||1};le.limit=X,a[w]=le}catch{}}function y(w){w=w||{};var P=w?.monthInterval,q=w?.dayInterval;return Ee(P)&&Ee(q)&&(w.monthInterval=3,f||(w[Xee]=[28],f=!0)),w={monthInterval:w?.monthInterval,dayInterval:w?.dayInterval,daysOfMonth:w?.daysOfMonth},w}function b(w,P,q){if(w&&!w[Y9]&&P&&_p(q)){var U=T(),Z=q[X9],le=w[Q9],re=1;if(le?.monthInterval){var X=(U.getUTCFullYear()-Z.getUTCFullYear())*12+U.getUTCMonth()-Z.getUTCMonth();re=B(le.monthInterval,0,X)}var Ve=1;if(f)Ve=Pr(le[Xee],U[J9]());else if(le?.dayInterval){var ie=Math.floor((U.getTime()-Z.getTime())/864e5);Ve=B(le.dayInterval,0,ie)}return re>=0&&Ve>=0}return!1}function _(w,P){var q=_p(P)?P:"";return w?$at+q+"-"+w:null}function S(w){try{if(w){var P=new Date;return w.getUTCFullYear()===P.getUTCFullYear()&&w.getUTCMonth()===P.getUTCMonth()&&w[J9]()===P[J9]()}}catch{}return!1}function I(w,P,q){try{var U={date:T(),count:0};if(w){var Z=JSON.parse(w),le={date:T(Z[X9])||U[X9],count:Z[Yv]||U[Yv],preTriggerDate:Z.preTriggerDate?T(Z[K9]):void 0};return le}else return A(P,q,U),U}catch{}return null}function T(w){try{if(w){var P=new Date(w);if(!isNaN(P.getDate()))return P}else return new Date}catch{}return null}function A(w,P,q){try{return c7(w,P,Fr(JSON[s_](q)))}catch{}return!1}function B(w,P,q){return w<=0?1:q>=P&&(q-P)%w==0?Math.floor((q-P)/w)+1:-1}function j(w,P,q,U){Me(P,U||1,w,q)}function F(w){try{var P=g(w);return RP(1e6)<=P.limit.samplingRate}catch{}return!1}function ne(w){try{var P=c[w];if(!P){var q=_(w,l);P=I(a7(s,q),s,q),c[w]=P}return c[w]}catch{}return null}function Y(w){var P=u[w];if(Ee(P)){P=!1;var q=ne(w);q&&(P=S(q[K9])),u[w]=P}return u[w]}function N(w){return d=d||{},Ee(d[w])&&(d[w]=[]),d[w]}}return t}()});function vA(t){if(!t)return{};var e=t[Am](Wat),r=rE(e,function(o,s){var a=s[Am](Kat);if(a[Dt]===2){var c=a[0][Op](),u=a[1];o[c]=u}return o},{});if(Eo(r)[Dt]>0){if(r.endpointsuffix){var n=r.location?r.location+".":"";r[Kv]=r[Kv]||"https://"+n+"dc."+r.endpointsuffix}r[Kv]=r[Kv]||Wv,bv(r[Kv],"/")&&(r[Kv]=r[Kv].slice(0,-1))}return r}var Wat,Kat,PPe,APe=R(()=>{en();el();Po();Wat=";",Kat="=";PPe={parse:vA}});var d7,DPe=R(()=>{en();el();Po();rl();d7=function(){function t(e,r,n){var o=this,s=this;s.ver=1,s.sampleRate=100,s.tags={},s[co]=fn(e,n)||ko,s.data=r,s.time=qc(new Date),s.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return o.sampleRate===100?4:1},tags:1,data:1}}return t}()});var Fp,NPe=R(()=>{el();Po();rl();Fp=function(){function t(e,r,n,o){this.aiDataContract={ver:1,name:1,properties:0,measurements:0};var s=this;s.ver=2,s[co]=fn(e,r)||ko,s[ys]=Vs(e,n),s[js]=Gs(e,o)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.Event",t.dataType="EventData",t}()});function hte(t,e){var r=t;return r&&!Ft(r)&&(JSON&&JSON[s_]?(r=JSON[s_](t),e&&(!r||r==="{}")&&(vt(t[Dm])?r=t[Dm]():r=""+t)):r=""+t+" - (Missing JSON.stringify)"),r||""}function UPe(t,e){var r=t;return t&&(r&&!Ft(r)&&(r=t[mte]||t[FPe]||r),r&&!Ft(r)&&(r=hte(r,!0)),t.filename&&(r=r+" @"+(t.filename||"")+":"+(t.lineno||"?")+":"+(t.colno||"?"))),e&&e!=="String"&&e!=="Object"&&e!=="Error"&&va(r||"",e)===-1&&(r=e+": "+r),r||""}function Qat(t){try{if(Pn(t))return"hasFullStack"in t&&"typeName"in t}catch{}return!1}function Xat(t){try{if(Pn(t))return"ver"in t&&"exceptions"in t&&"properties"in t}catch{}return!1}function OPe(t){return t&&t.src&&Ft(t.src)&&t.obj&&st(t.obj)}function h_(t){var e=t||"";Ft(e)||(Ft(e[oc])?e=e[oc]:e=""+e);var r=e[Am](`
`);return{src:e,obj:r}}function Jat(t){for(var e=[],r=t[Am](`
`),n=0;n<r[Dt];n++){var o=r[n];r[n+1]&&(o+="@"+r[n+1],n++),e[Nm](o)}return{src:t,obj:e}}function BPe(t){var e=null;if(t)try{if(t[oc])e=h_(t[oc]);else if(t[rT]&&t[rT][oc])e=h_(t[rT][oc]);else if(t.exception&&t.exception[oc])e=h_(t.exception[oc]);else if(OPe(t))e=t;else if(OPe(t[fte]))e=t[fte];else if(ui()&&ui().opera&&t[mte])e=Jat(t[Jl]);else if(t.reason&&t.reason[oc])e=h_(t.reason[oc]);else if(Ft(t))e=h_(t);else{var r=t[mte]||t[FPe]||"";Ft(t[LPe])&&(r&&(r+=`
`),r+=" from "+t[LPe]),r&&(e=h_(r))}}catch(n){e=h_(n)}return e||{src:"",obj:null}}function Zat(t){var e="";return t&&(t.obj?_e(t.obj,function(r){e+=r+`
`}):e=t.src||""),e}function ect(t){var e,r=t.obj;if(r&&r[Dt]>0){e=[];var n=0,o=0;_e(r,function(h){var g=h[Dm]();if(gte.regex.test(g)){var v=new gte(g,n++);o+=v[c_],e[Nm](v)}});var s=32*1024;if(o>s)for(var a=0,c=e[Dt]-1,u=0,l=a,d=c;a<c;){var p=e[a][c_],f=e[c][c_];if(u+=p+f,u>s){var m=d-l+1;e.splice(l,m);break}l=a,d=c,a++,c--}}return e}function p7(t){var e="";if(t&&(e=t.typeName||t[co]||"",!e))try{var r=/function (.{1,200})\(/,n=r.exec(t.constructor[Dm]());e=n&&n[Dt]>1?n[1]:""}catch{}return e}function pte(t){if(t)try{if(!Ft(t)){var e=p7(t),r=hte(t,!1);return(!r||r==="{}")&&(t[rT]&&(t=t[rT],e=p7(t)),r=hte(t,!0)),va(r,e)!==0&&e!=="String"?e+":"+r:r}}catch{}return""+(t||"")}var Yat,rT,oc,fte,LPe,mte,FPe,e0,MPe,gte,qPe=R(()=>{Ya();en();St();el();Po();rl();Yat="<no_method>",rT="error",oc="stack",fte="stackDetails",LPe="errorSrc",mte="message",FPe="description";e0=function(){function t(e,r,n,o,s,a){this.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0};var c=this;c.ver=2,Xat(r)?(c[a_]=r[a_]||[],c[ys]=r[ys],c[js]=r[js],r[u_]&&(c[u_]=r[u_]),r.id&&(c.id=r.id,r[ys].id=r.id),r[Z9]&&(c[Z9]=r[Z9]),Ee(r[e7])||(c[e7]=r[e7])):(n||(n={}),a&&(n.id=a),c[a_]=[new MPe(e,r,n)],c[ys]=Vs(e,n),c[js]=Gs(e,o),s&&(c[u_]=s),a&&(c.id=a))}return t.CreateAutoException=function(e,r,n,o,s,a,c,u){var l,d=p7(s||a||e);return l={},l[Jl]=UPe(e,d),l.url=r,l.lineNumber=n,l.columnNumber=o,l.error=pte(s||a||e),l.evt=pte(a||e),l[Mp]=d,l.stackDetails=BPe(c||s||a),l.errorSrc=u,l},t.CreateFromInterface=function(e,r,n,o){var s=r[a_]&&pp(r[a_],function(c){return MPe[Zee](e,c)}),a=new t(e,Wu(Wu({},r),{exceptions:s}),n,o);return a},t.prototype.toInterface=function(){var e,r=this,n=r.exceptions,o=r.properties,s=r.measurements,a=r.severityLevel,c=r.problemGroup,u=r.id,l=r.isManual,d=n instanceof Array&&pp(n,function(p){return p.toInterface()})||void 0;return e={ver:"4.0"},e[a_]=d,e.severityLevel=a,e.properties=o,e.measurements=s,e.problemGroup=c,e.id=u,e.isManual=l,e},t.CreateSimpleException=function(e,r,n,o,s,a){var c;return{exceptions:[(c={},c[fA]=!0,c.message=e,c.stack=s,c.typeName=r,c)]}},t.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",t.dataType="ExceptionData",t.formatError=pte,t}(),MPe=function(){function t(e,r,n){this.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2};var o=this;if(Qat(r))o[Mp]=r[Mp],o[Jl]=r[Jl],o[oc]=r[oc],o[tl]=r[tl]||[],o[fA]=r[fA];else{var s=r,a=s&&s.evt;lv(s)||(s=s[rT]||a||s),o[Mp]=fn(e,p7(s))||ko,o[Jl]=ZE(e,UPe(r||s,o[Mp]))||ko;var c=r[fte]||BPe(r);o[tl]=ect(c),st(o[tl])&&pp(o[tl],function(u){u[l_]=fn(e,u[l_]),u[Qv]=fn(e,u[Qv])}),o[oc]=r7(e,Zat(c)),o.hasFullStack=st(o.parsedStack)&&o.parsedStack[Dt]>0,n&&(n[Mp]=n[Mp]||o[Mp])}}return t.prototype.toInterface=function(){var e,r=this,n=r[tl]instanceof Array&&pp(r[tl],function(s){return s.toInterface()}),o=(e={id:r.id,outerId:r.outerId,typeName:r[Mp],message:r[Jl],hasFullStack:r[fA],stack:r[oc]},e[tl]=n||void 0,e);return o},t.CreateFromInterface=function(e,r){var n=r[tl]instanceof Array&&pp(r[tl],function(s){return gte[Zee](s)})||r[tl],o=new t(e,Wu(Wu({},r),{parsedStack:n}));return o},t}(),gte=function(){function t(e,r){this.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0};var n=this;if(n[c_]=0,typeof e=="string"){var o=e;n[mA]=r,n[d_]=Yat,n[l_]=Fr(o),n[Qv]="",n[JE]=0;var s=o.match(t.regex);s&&s[Dt]>=5&&(n[d_]=Fr(s[2])||n[d_],n[Qv]=Fr(s[4]),n[JE]=parseInt(s[5])||0)}else n[mA]=e[mA],n[d_]=e[d_],n[l_]=e[l_],n[Qv]=e[Qv],n[JE]=e[JE],n[c_]=0;n.sizeInBytes+=n.method[Dt],n.sizeInBytes+=n.fileName[Dt],n.sizeInBytes+=n.assembly[Dt],n[c_]+=t.baseSize,n.sizeInBytes+=n.level.toString()[Dt],n.sizeInBytes+=n.line.toString()[Dt]}return t.CreateFromInterface=function(e){return new t(e,null)},t.prototype.toInterface=function(){var e=this;return{level:e[mA],method:e[d_],assembly:e[l_],fileName:e[Qv],line:e[JE]}},t.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,t.baseSize=58,t}()});var HPe,jPe=R(()=>{HPe=function(){function t(){this.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},this.kind=0}return t}()});var Up,VPe=R(()=>{el();Po();jPe();rl();Up=function(){function t(e,r,n,o,s,a,c,u,l){this.aiDataContract={ver:1,metrics:1,properties:0};var d=this;d.ver=2;var p=new HPe;p[Yv]=o>0?o:void 0,p.max=isNaN(a)||a===null?void 0:a,p.min=isNaN(s)||s===null?void 0:s,p[co]=fn(e,r)||ko,p.value=n,p.stdDev=isNaN(c)||c===null?void 0:c,d.metrics=[p],d[ys]=Vs(e,u),d[js]=Gs(e,l)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",t.dataType="MetricData",t}()});function GPe(t,e){return e===void 0&&(e=!1),t==null?e:t.toString()[Op]()==="true"}function nT(t){(isNaN(t)||t<0)&&(t=0),t=Math.round(t);var e=yA+t%1e3,r=yA+Math.floor(t/1e3)%60,n=yA+Math.floor(t/(1e3*60))%60,o=yA+Math.floor(t/(1e3*60*60))%24,s=Math.floor(t/(1e3*60*60*24));return e=e[Dt]===1?"00"+e:e[Dt]===2?"0"+e:e,r=r[Dt]<2?"0"+r:r,n=n[Dt]<2?"0"+n:n,o=o[Dt]<2?"0"+o:o,(s>0?s+".":yA)+o+":"+n+":"+r+"."+e}function zPe(t,e){var r=null;return _e(t,function(n){if(n.identifier===e)return r=n,-1}),r}function $Pe(t,e,r,n,o){return!o&&Ft(t)&&(t==="Script error."||t==="Script error")}var yA,f7=R(()=>{en();Po();yA=""});var t0,WPe=R(()=>{el();f7();Po();rl();t0=function(){function t(e,r,n,o,s,a,c){this.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0};var u=this;u.ver=2,u.id=n7(e,c),u.url=Xv(e,n),u[co]=fn(e,r)||ko,isNaN(o)||(u[p_]=nT(o)),u[ys]=Vs(e,s),u[js]=Gs(e,a)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",t.dataType="PageviewData",t}()});var r0,KPe=R(()=>{f7();ate();Po();rl();r0=function(){function t(e,r,n,o,s,a,c,u,l,d,p,f){l===void 0&&(l="Ajax"),this.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0};var m=this;m.ver=2,m.id=r,m[p_]=nT(s),m.success=a,m.resultCode=c+"",m.type=fn(e,l);var h=gPe(e,n,u,o);m.data=Xv(e,o)||h.data,m.target=fn(e,h.target),d&&(m.target="".concat(m.target," | ").concat(d)),m[co]=fn(e,h[co]),m[ys]=Vs(e,p),m[js]=Gs(e,f)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",t.dataType="RemoteDependencyData",t}()});var n0,YPe=R(()=>{el();Po();rl();n0=function(){function t(e,r,n,o,s){this.aiDataContract={ver:1,message:1,severityLevel:0,properties:0};var a=this;a.ver=2,r=r||ko,a[Jl]=ZE(e,r),a[ys]=Vs(e,o),a[js]=Gs(e,s),n&&(a[u_]=n)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.Message",t.dataType="MessageData",t}()});var i0,QPe=R(()=>{el();Po();rl();i0=function(){function t(e,r,n,o,s,a,c){this.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0};var u=this;u.ver=2,u.url=Xv(e,n),u[co]=fn(e,r)||ko,u[ys]=Vs(e,s),u[js]=Gs(e,a),c&&(u.domProcessing=c.domProcessing,u[p_]=c[p_],u.networkConnect=c.networkConnect,u.perfTotal=c.perfTotal,u[ete]=c[ete],u.sentRequest=c.sentRequest)}return t.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",t.dataType="PageviewPerformanceData",t}()});var Bp,XPe=R(()=>{Bp=function(){function t(e,r){this.aiDataContract={baseType:1,baseData:1},this.baseType=e,this.baseData=r}return t}()});var m7,JPe=R(()=>{en();m7=oo({Verbose:0,Information:1,Warning:2,Error:3,Critical:4})});var ZPe,eAe=R(()=>{en();Po();ZPe=function(){function t(){}return t.getConfig=function(e,r,n,o){o===void 0&&(o=!1);var s;return n&&e[pA]&&e[pA][n]&&!Ee(e[pA][n][r])?s=e[pA][n][r]:s=e[r],Ee(s)?o:s},t}()});function s0(t){var e="ai."+t+".";return function(r){return e+r}}var bA,Ao,h7,iT,vte,o0,g_,_A,oT,yte=R(()=>{Ya();en();bA=s0("application"),Ao=s0("device"),h7=s0("location"),iT=s0("operation"),vte=s0("session"),o0=s0("user"),g_=s0("cloud"),_A=s0("internal"),oT=function(t){Ka(e,t);function e(){return t.call(this)||this}return e}(PZ({applicationVersion:bA("ver"),applicationBuild:bA("build"),applicationTypeId:bA("typeId"),applicationId:bA("applicationId"),applicationLayer:bA("layer"),deviceId:Ao("id"),deviceIp:Ao("ip"),deviceLanguage:Ao("language"),deviceLocale:Ao("locale"),deviceModel:Ao("model"),deviceFriendlyName:Ao("friendlyName"),deviceNetwork:Ao("network"),deviceNetworkName:Ao("networkName"),deviceOEMName:Ao("oemName"),deviceOS:Ao("os"),deviceOSVersion:Ao("osVersion"),deviceRoleInstance:Ao("roleInstance"),deviceRoleName:Ao("roleName"),deviceScreenResolution:Ao("screenResolution"),deviceType:Ao("type"),deviceMachineName:Ao("machineName"),deviceVMName:Ao("vmName"),deviceBrowser:Ao("browser"),deviceBrowserVersion:Ao("browserVersion"),locationIp:h7("ip"),locationCountry:h7("country"),locationProvince:h7("province"),locationCity:h7("city"),operationId:iT("id"),operationName:iT("name"),operationParentId:iT("parentId"),operationRootId:iT("rootId"),operationSyntheticSource:iT("syntheticSource"),operationCorrelationVector:iT("correlationVector"),sessionId:vte("id"),sessionIsFirst:vte("isFirst"),sessionIsNew:vte("isNew"),userAccountAcquisitionDate:o0("accountAcquisitionDate"),userAccountId:o0("accountId"),userAgent:o0("userAgent"),userId:o0("id"),userStoreRegion:o0("storeRegion"),userAuthUserId:o0("authUserId"),userAnonymousUserAcquisitionDate:o0("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:o0("authUserAcquisitionDate"),cloudName:g_("name"),cloudRole:g_("role"),cloudRoleVer:g_("roleVer"),cloudRoleInstance:g_("roleInstance"),cloudEnvironment:g_("environment"),cloudLocation:g_("location"),cloudDeploymentUnit:g_("deploymentUnit"),internalNodeName:_A("nodeName"),internalSdkVersion:_A("sdkVersion"),internalAgentVersion:_A("agentVersion"),internalSnippet:_A("snippet"),internalSdkSrc:_A("sdkSrc")}))});function bte(t,e,r,n,o,s){var a;r=fn(n,r)||ko,(Ee(t)||Ee(e)||Ee(r))&&ai("Input doesn't contain all required fields");var c="";t[$9]&&(c=t[$9],delete t[$9]);var u=(a={},a[co]=r,a.time=qc(new Date),a.iKey=c,a.ext=s||{},a.tags=[],a.data={},a.baseType=e,a.baseData=t,a);return Ee(o)||Ze(o,function(l,d){u.data[l]=d}),u}var tAe,rAe=R(()=>{en();el();rl();Po();tAe=function(){function t(){}return t.create=bte,t}()});var nAe,uo,iAe=R(()=>{yte();nAe={UserExt:"user",DeviceExt:"device",TraceExt:"trace",WebExt:"web",AppExt:"app",OSExt:"os",SessionExt:"ses",SDKExt:"sdk"},uo=new oT});function oAe(t){var e=null;if(vt(Event))e=new Event(t);else{var r=ci();r&&r.createEvent&&(e=r.createEvent("Event"),e.initEvent(t,!0,!0))}return e}var sAe=R(()=>{en()});function aAe(t,e){Rm(t,null,null,e)}function g7(t){var e=ci(),r=io(),n=!1,o=[],s=1;r&&!Ee(r.onLine)&&!r.onLine&&(s=2);var a=0,c=f(),u=jc(vs("OfflineListener"),t);try{if(d(ui())&&(n=!0),e){var l=e.body||e;l.ononline&&d(l)&&(n=!0)}}catch{n=!1}function d(_){var S=!1;return _&&(S=Tp(_,"online",g,u),S&&Tp(_,"offline",v,u)),S}function p(){return c}function f(){return!(a===2||s===2)}function m(){var _=f();c!==_&&(c=_,_e(o,function(S){var I={isOnline:c,rState:s,uState:a};try{S(I)}catch{}}))}function h(_){a=_,m()}function g(){s=1,m()}function v(){s=2,m()}function y(){var _=ui();if(_&&n){if(aAe(_,u),e){var S=e.body||e;Pt(S.ononline)||aAe(S,u)}n=!1}}function b(_){return o[Nm](_),{rm:function(){var S=o.indexOf(_);if(S>-1)return o.splice(S,1)}}}return{isOnline:p,isListening:function(){return n},unload:y,addListener:b,setOnlineState:h}}var cAe=R(()=>{en();Po()});var uAe={};mn(uAe,{AnalyticsPluginIdentifier:()=>rct,BreezeChannelIdentifier:()=>_te,ConfigurationManager:()=>ZPe,ConnectionStringParser:()=>PPe,ContextTagKeys:()=>oT,CtxTagKeys:()=>uo,DEFAULT_BREEZE_ENDPOINT:()=>Wv,DEFAULT_BREEZE_PATH:()=>Lp,Data:()=>Bp,DisabledPropertyName:()=>sPe,DistributedTracingModes:()=>_Pe,Envelope:()=>d7,Event:()=>Fp,EventPersistence:()=>xPe,Exception:()=>e0,Extensions:()=>nAe,HttpMethod:()=>dA,Metric:()=>Up,PageView:()=>t0,PageViewPerformance:()=>i0,ProcessLegacy:()=>QE,PropertiesPluginIdentifier:()=>tct,RemoteDependencyData:()=>r0,RequestHeaders:()=>o_,SampleRate:()=>YE,SeverityLevel:()=>m7,TelemetryItemCreator:()=>tAe,ThrottleMgr:()=>RPe,Trace:()=>n0,correlationIdCanIncludeCorrelationHeader:()=>mPe,correlationIdGetCorrelationContext:()=>hPe,correlationIdGetCorrelationContextValue:()=>ste,correlationIdGetPrefix:()=>fPe,correlationIdSetPrefix:()=>pPe,createDistributedTraceContextFromTrace:()=>bPe,createDomEvent:()=>oAe,createOfflineListener:()=>g7,createTelemetryItem:()=>bte,createTraceParent:()=>HP,dataSanitizeException:()=>r7,dataSanitizeId:()=>n7,dataSanitizeInput:()=>i7,dataSanitizeKey:()=>tte,dataSanitizeKeyAndAddUniqueness:()=>t7,dataSanitizeMeasurements:()=>Gs,dataSanitizeMessage:()=>ZE,dataSanitizeProperties:()=>Vs,dataSanitizeString:()=>fn,dataSanitizeUrl:()=>Xv,dateTimeUtilsDuration:()=>yPe,dateTimeUtilsNow:()=>vPe,dsPadNumber:()=>rte,findW3cTraceParent:()=>GP,formatTraceParent:()=>VP,getExtensionByName:()=>zPe,isBeaconApiSupported:()=>rc,isCrossOriginError:()=>$Pe,isInternalApplicationInsightsEndpoint:()=>gA,isSampledFlag:()=>jP,isValidSpanId:()=>Cp,isValidTraceId:()=>Ip,isValidTraceParent:()=>DE,msToTimeSpan:()=>nT,parseConnectionString:()=>vA,parseTraceParent:()=>zb,strNotSpecified:()=>ko,stringToBoolOrDefault:()=>GPe,urlGetAbsoluteUrl:()=>uPe,urlGetCompleteUrl:()=>dPe,urlGetPathName:()=>lPe,urlParseFullHost:()=>hA,urlParseHost:()=>nte,urlParseUrl:()=>f_,utlCanUseLocalStorage:()=>tT,utlCanUseSessionStorage:()=>m_,utlDisableStorage:()=>IPe,utlEnableStorage:()=>CPe,utlGetLocalStorage:()=>a7,utlGetSessionStorage:()=>u7,utlGetSessionStorageKeys:()=>TPe,utlRemoveSessionStorage:()=>wPe,utlRemoveStorage:()=>EPe,utlSetLocalStorage:()=>c7,utlSetSessionStorage:()=>l7,utlSetStoragePrefix:()=>s7});var tct,_te,rct,Lm=R(()=>{ate();kPe();APe();Qee();el();DPe();NPe();qPe();VPe();WPe();KPe();YPe();QPe();XPe();JPe();eAe();yte();rl();rAe();iAe();cte();f7();en();sAe();dte();ite();cAe();tct="AppInsightsPropertiesPlugin",_te="AppInsightsChannelPlugin",rct="ApplicationInsightsAnalytics"});var a0,lAe=R(()=>{a0="duration"});var lo,v7,bs,qp,v_,Yt,c0,u0,nl,l0,Om,sT,Mm,Fm,y7,Um,xA,d0,SA,aT,y_,IA,b7,Bm,cT,uT,_s,_7,lT,x7,xte,S7,I7,Ste,C7,Ite,qm,Cte,Ete,Tte,wte,CA,Rte,kte,Pte,dT,p0,E7,EA,T7,dAe,w7,R7,pT,Ate,k7,pAe,f0=R(()=>{lo="tags",v7="deviceType",bs="data",qp="name",v_="traceID",Yt="length",c0="stringify",u0="measurements",nl="dataType",l0="envelopeType",Om="toString",sT="_get",Mm="enqueue",Fm="count",y7="eventsLimitInMem",Um="push",xA="emitLineDelimitedJson",d0="clear",SA="createNew",aT="markAsSent",y_="clearSent",IA="bufferOverride",b7="BUFFER_KEY",Bm="SENT_BUFFER_KEY",cT="MAX_BUFFER_SIZE",uT="triggerSend",_s="diagLog",_7="initialize",lT="_sender",x7="customHeaders",xte="maxBatchSizeInBytes",S7="onunloadDisableBeacon",I7="isBeaconApiDisabled",Ste="alwaysUseXhrOverride",C7="disableXhr",Ite="enableSessionStorageBuffer",qm="_buffer",Cte="onunloadDisableFetch",Ete="disableSendBeaconSplit",Tte="instrumentationKey",wte="enableSendPromise",CA="getSenderInst",Rte="unloadTransports",kte="convertUndefined",Pte="maxBatchInterval",dT="serialize",p0="_onError",E7="_onPartialSuccess",EA="_onSuccess",T7="itemsAccepted",dAe="itemsReceived",w7="oriPayload",R7="baseType",pT="sampleRate",Ate="eventsSendRequest",k7="getSamplingScore",pAe="getHashCodeScore"});function po(t,e,r){return Qu(t,e,r,ju)}function nct(t,e,r){var n=r[lo]=r[lo]||{},o=e.ext=e.ext||{},s=e[lo]=e[lo]||[],a=o.user;a&&(po(n,uo.userAuthUserId,a.authId),po(n,uo.userId,a.id||a.localId));var c=o.app;c&&po(n,uo.sessionId,c.sesId);var u=o.device;u&&(po(n,uo.deviceId,u.id||u.localId),po(n,uo[v7],u.deviceClass),po(n,uo.deviceIp,u.ip),po(n,uo.deviceModel,u.model),po(n,uo[v7],u[v7]));var l=e.ext.web;if(l){po(n,uo.deviceLanguage,l.browserLang),po(n,uo.deviceBrowserVersion,l.browserVer),po(n,uo.deviceBrowser,l.browser);var d=r[bs]=r[bs]||{},p=d[Zn]=d[Zn]||{},f=p[Qo]=p[Qo]||{};po(f,"domain",l.domain),po(f,"isManual",l.isManual?fAe:null),po(f,"screenRes",l.screenRes),po(f,"userConsent",l.userConsent?fAe:null)}var m=o.os;m&&po(n,uo.deviceOS,m[qp]);var h=o.trace;h&&(po(n,uo.operationParentId,h.parentID),po(n,uo.operationName,fn(t,h[qp])),po(n,uo.operationId,h[v_]));for(var g={},v=s[Yt]-1;v>=0;v--){var y=s[v];Ze(y,function(_,S){g[_]=S}),s.splice(v,1)}Ze(s,function(_,S){g[_]=S});var b=Wu(Wu({},n),g);b[uo.internalSdkVersion]||(b[uo.internalSdkVersion]=fn(t,"javascript:".concat(ict.Version),64)),r[lo]=Xu(b)}function m0(t,e,r){Ee(t)||Ze(t,function(n,o){Fs(o)?r[n]=o:Ft(o)?e[n]=o:yp()&&(e[n]=gs()[c0](o))})}function b_(t,e){Ee(t)||Ze(t,function(r,n){t[r]=n||e})}function __(t,e,r,n){var o=new d7(t,n,e);po(o,"sampleRate",r[YE]),(r[Zn]||{}).startTime&&(o.time=qc(r[Zn].startTime)),o.iKey=r.iKey;var s=r.iKey.replace(/-/g,"");return o[qp]=o[qp].replace("{0}",s),nct(t,r,o),r[lo]=r[lo]||[],Xu(o)}function x_(t,e){Ee(e[Zn])&&Me(t,1,46,"telemetryItem.baseData cannot be null.")}function mAe(t,e,r){x_(t,e);var n=e[Zn][u0]||{},o=e[Zn][Qo]||{};m0(e[bs],o,n),Ee(r)||b_(o,r);var s=e[Zn];if(Ee(s))return ba(t,"Invalid input for dependency data"),null;var a=s[Qo]&&s[Qo][dA]?s[Qo][dA]:"GET",c=new r0(t,s.id,s.target,s[qp],s[a0],s.success,s.responseCode,a,s.type,s.correlationContext,o,n),u=new Bp(r0[nl],c);return __(t,r0[l0],e,u)}function Nte(t,e,r){x_(t,e);var n={},o={};e[Dte]!==Fp[nl]&&(n.baseTypeSource=e[Dte]),e[Dte]===Fp[nl]?(n=e[Zn][Qo]||{},o=e[Zn][u0]||{}):e[Zn]&&m0(e[Zn],n,o),m0(e[bs],n,o),Ee(r)||b_(n,r);var s=e[Zn][qp],a=new Fp(t,s,n,o),c=new Bp(Fp[nl],a);return __(t,Fp[l0],e,c)}function hAe(t,e,r){x_(t,e);var n=e[Zn][u0]||{},o=e[Zn][Qo]||{};m0(e[bs],o,n),Ee(r)||b_(o,r);var s=e[Zn],a=e0.CreateFromInterface(t,s,o,n),c=new Bp(e0[nl],a);return __(t,e0[l0],e,c)}function gAe(t,e,r){x_(t,e);var n=e[Zn],o=n[Qo]||{},s=n[u0]||{};m0(e[bs],o,s),Ee(r)||b_(o,r);var a=new Up(t,n[qp],n.average,n.sampleCount,n.min,n.max,n.stdDev,o,s),c=new Bp(Up[nl],a);return __(t,Up[l0],e,c)}function vAe(t,e,r){x_(t,e);var n,o=e[Zn];!Ee(o)&&!Ee(o[Qo])&&!Ee(o[Qo][a0])?(n=o[Qo][a0],delete o[Qo][a0]):!Ee(e[bs])&&!Ee(e[bs][a0])&&(n=e[bs][a0],delete e[bs][a0]);var s=e[Zn],a;((e.ext||{}).trace||{})[v_]&&(a=e.ext.trace[v_]);var c=s.id||a,u=s[qp],l=s.uri,d=s[Qo]||{},p=s[u0]||{};if(Ee(s.refUri)||(d.refUri=s.refUri),Ee(s.pageType)||(d.pageType=s.pageType),Ee(s.isLoggedIn)||(d.isLoggedIn=s.isLoggedIn[Om]()),!Ee(s[Qo])){var f=s[Qo];Ze(f,function(g,v){d[g]=v})}m0(e[bs],d,p),Ee(r)||b_(d,r);var m=new t0(t,u,l,n,d,p,c),h=new Bp(t0[nl],m);return __(t,t0[l0],e,h)}function yAe(t,e,r){x_(t,e);var n=e[Zn],o=n[qp],s=n.uri||n.url,a=n[Qo]||{},c=n[u0]||{};m0(e[bs],a,c),Ee(r)||b_(a,r);var u=new i0(t,o,s,void 0,a,c,n),l=new Bp(i0[nl],u);return __(t,i0[l0],e,l)}function bAe(t,e,r){x_(t,e);var n=e[Zn].message,o=e[Zn].severityLevel,s=e[Zn][Qo]||{},a=e[Zn][u0]||{};m0(e[bs],s,a),Ee(r)||b_(s,r);var c=new n0(t,n,o,s,a),u=new Bp(n0[nl],c);return __(t,n0[l0],e,u)}var Dte,Zn,Qo,fAe,ict,_Ae=R(()=>{Ya();Lm();en();lAe();f0();Dte="baseType",Zn="baseData",Qo="properties",fAe="true";ict={Version:"3.1.1"}});var xAe,P7,Lte,SAe=R(()=>{Ya();Wo();Lm();en();f0();xAe=function(){function t(e,r){var n=[],o=!1;this[sT]=function(){return n},this._set=function(s){return n=s,n},sr(t,this,function(s){s[Mm]=function(a){if(s[Fm]()>=r[y7]){o||(Me(e,2,105,"Maximum in-memory buffer size reached: "+s[Fm](),!0),o=!0);return}n[Um](a)},s[Fm]=function(){return n[Yt]},s.size=function(){for(var a=n[Yt],c=0;c<n[Yt];c++)a+=n[c][Yt];return r[xA]||(a+=2),a},s[d0]=function(){n=[],o=!1},s.getItems=function(){return n.slice(0)},s.batchPayloads=function(a){if(a&&a[Yt]>0){var c=r[xA]?a.join(`
`):"["+a.join(",")+"]";return c}return null},s[SA]=function(a,c,u){var l=n.slice(0);a=a||e,c=c||{};var d=u?new Lte(a,c):new P7(a,c);return _e(l,function(p){d[Mm](p)}),d}})}return t.__ieDyn=1,t}(),P7=function(t){Ka(e,t);function e(r,n){var o=t.call(this,r,n)||this;return sr(e,o,function(s,a){s[aT]=function(c){a[d0]()},s[y_]=function(c){}}),o}return e.__ieDyn=1,e}(xAe),Lte=function(t){Ka(e,t);function e(r,n){var o=t.call(this,r,n)||this,s=!1,a=n?.namePrefix,c=n[IA]||{getItem:u7,setItem:l7},u=c.getItem,l=c.setItem;return sr(e,o,function(d,p){var f=v(e[b7]),m=v(e[Bm]),h=d._set(f.concat(m));h[Yt]>e[cT]&&(h[Yt]=e[cT]),y(e[Bm],[]),y(e[b7],h),d[Mm]=function(b){if(d[Fm]()>=e[cT]){s||(Me(r,2,67,"Maximum buffer size reached: "+d[Fm](),!0),s=!0);return}p[Mm](b),y(e.BUFFER_KEY,d[sT]())},d[d0]=function(){p[d0](),y(e.BUFFER_KEY,d[sT]()),y(e[Bm],[]),s=!1},d[aT]=function(b){y(e[b7],d._set(g(b,d[sT]())));var _=v(e[Bm]);_ instanceof Array&&b instanceof Array&&(_=_.concat(b),_[Yt]>e[cT]&&(Me(r,1,67,"Sent buffer reached its maximum size: "+_[Yt],!0),_[Yt]=e[cT]),y(e[Bm],_))},d[y_]=function(b){var _=v(e[Bm]);_=g(b,_),y(e[Bm],_)},d[SA]=function(b,_,S){S=!!S;var I=d[sT]().slice(0),T=v(e[Bm]).slice(0);b=b||r,_=_||{},d[d0]();var A=S?new e(b,_):new P7(b,_);return _e(I,function(B){A[Mm](B)}),S&&A[aT](T),A};function g(b,_){var S=[];return _e(_,function(I){!vt(I)&&Pr(b,I)===-1&&S[Um](I)}),S}function v(b){var _=b;try{_=a?a+"_"+_:_;var S=u(r,_);if(S){var I=gs().parse(S);if(Ft(I)&&(I=gs().parse(I)),I&&st(I))return I}}catch(T){Me(r,1,42," storage key: "+_+", "+An(T),{exception:We(T)})}return[]}function y(b,_){var S=b;try{S=a?a+"_"+S:S;var I=JSON[c0](_);l(r,S,I)}catch(T){l(r,S,JSON[c0]([])),Me(r,2,41," storage key: "+S+", "+An(T)+". Buffer cleared",{exception:We(T)})}}}),o}return e.BUFFER_KEY="AI_buffer",e.SENT_BUFFER_KEY="AI_sentBuffer",e.MAX_BUFFER_SIZE=2e3,e}(xAe)});var IAe,CAe=R(()=>{Wo();en();f0();IAe=function(){function t(e){sr(t,this,function(r){r[dT]=function(a){var c=n(a,"root");try{return gs()[c0](c)}catch(u){Me(e,1,48,u&&vt(u[Om])?u[Om]():"Error serializing object",null,!0)}};function n(a,c){var u="__aiCircularRefCheck",l={};if(!a)return Me(e,1,48,"cannot serialize object because it is null or undefined",{name:c},!0),l;if(a[u])return Me(e,2,50,"Circular reference detected while serializing object",{name:c},!0),l;if(!a.aiDataContract){if(c==="measurements")l=s(a,"number",c);else if(c==="properties")l=s(a,"string",c);else if(c==="tags")l=s(a,"string",c);else if(st(a))l=o(a,c);else{Me(e,2,49,"Attempting to serialize an object which does not implement ISerializable",{name:c},!0);try{gs()[c0](a),l=a}catch(d){Me(e,1,48,d&&vt(d[Om])?d[Om]():"Error serializing object",null,!0)}}return l}return a[u]=!0,Ze(a.aiDataContract,function(d,p){var f=vt(p)?p()&1:p&1,m=vt(p)?p()&4:p&4,h=p&2,g=a[d]!==void 0,v=Pn(a[d])&&a[d]!==null;if(f&&!g&&!h)Me(e,1,24,"Missing required field specification. The field is required but not present on source",{field:d,name:c});else if(!m){var y=void 0;v?h?y=o(a[d],d):y=n(a[d],d):y=a[d],y!==void 0&&(l[d]=y)}}),delete a[u],l}function o(a,c){var u;if(a)if(!st(a))Me(e,1,54,`This field was specified as an array in the contract but the item is not an array.\r
`,{name:c},!0);else{u=[];for(var l=0;l<a[Yt];l++){var d=a[l],p=n(d,c+"["+l+"]");u[Um](p)}}return u}function s(a,c,u){var l;return a&&(l={},Ze(a,function(d,p){if(c==="string")p===void 0?l[d]="undefined":p===null?l[d]="null":p[Om]?l[d]=p[Om]():l[d]="invalid field: toString() is not defined.";else if(c==="number")if(p===void 0)l[d]="undefined";else if(p===null)l[d]="null";else{var f=parseFloat(p);l[d]=f}else l[d]="invalid field: "+u+" is of unknown type.",Me(e,1,l[d],null,!0)})),l}})}return t.__ieDyn=1,t}()});var oct,EAe,TAe=R(()=>{f0();oct=8,EAe=function(){function t(){}return t.prototype.getHashCodeScore=function(e){var r=this.getHashCode(e)/t.INT_MAX_VALUE;return r*100},t.prototype.getHashCode=function(e){if(e==="")return 0;for(;e[Yt]<oct;)e=e.concat(e);for(var r=5381,n=0;n<e[Yt];++n)r=(r<<5)+r+e.charCodeAt(n),r=r&r;return Math.abs(r)},t.INT_MAX_VALUE=2147483647,t}()});var wAe,RAe=R(()=>{Lm();f0();TAe();wAe=function(){function t(){var e=this,r=new EAe,n=new oT;e[k7]=function(o){var s=0;return o[lo]&&o[lo][n.userId]?s=r.getHashCodeScore(o[lo][n.userId]):o.ext&&o.ext.user&&o.ext.user.id?s=r[pAe](o.ext.user.id):o[lo]&&o[lo][n.operationId]?s=r.getHashCodeScore(o[lo][n.operationId]):o.ext&&o.ext.telemetryTrace&&o.ext.telemetryTrace[v_]?s=r.getHashCodeScore(o.ext.telemetryTrace[v_]):s=Math.random()*100,s}}return t}()});var kAe,PAe=R(()=>{Lm();en();f0();RAe();kAe=function(){function t(e,r){this.INT_MAX_VALUE=2147483647;var n=r||Kl(null);(e>100||e<0)&&(n.throwInternal(2,58,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this[pT]=e,this.samplingScoreGenerator=new wAe}return t.prototype.isSampledIn=function(e){var r=this[pT],n=!1;return r==null||r>=100||e.baseType===Up[nl]?!0:(n=this.samplingScoreGenerator[k7](e)<r,n)},t}()});function DAe(t){try{return t.responseText}catch{}return null}function act(t){return t&&t.sendPOST}function cct(t){return!isNaN(t)&&t>0&&t<=100}var ei,Hm,Hp,AAe,sct,NAe,uct,TA,LAe=R(()=>{Ya();Wo();Lm();en();St();_Ae();SAe();CAe();PAe();f0();Hp=void 0,AAe="",sct=65e3;NAe=ga((ei={endpointUrl:kE(ju,Wv+Lp)},ei[xA]=Ju(),ei[Pte]=15e3,ei[xte]=102400,ei.disableTelemetry=Ju(),ei[Ite]=Ju(!0),ei.isRetryDisabled=Ju(),ei[I7]=Ju(!0),ei[Ete]=Ju(!0),ei[C7]=Ju(),ei[Cte]=Ju(),ei[S7]=Ju(),ei[Tte]=Hp,ei.namePrefix=Hp,ei.samplingPercentage=kE(cct,100),ei[x7]=Hp,ei[kte]=Hp,ei[y7]=1e4,ei[IA]=!1,ei.httpXHROverride={isVal:act,v:Hp},ei[Ste]=Ju(),ei.transports=Hp,ei.retryCodes=Hp,ei));uct=(Hm={},Hm[Fp.dataType]=Nte,Hm[n0.dataType]=bAe,Hm[t0.dataType]=vAe,Hm[i0.dataType]=yAe,Hm[e0.dataType]=hAe,Hm[Up.dataType]=gAe,Hm[r0.dataType]=mAe,Hm),TA=function(t){Ka(e,t);function e(){var r=t.call(this)||this;r.priority=1001,r.identifier=_te;var n,o,s,a,c,u,l,d,p=0,f,m,h,g,v,y,b,_,S,I,T,A,B,j,F,ne,Y,N,w,P,q,U,Z,le,re,X,Ve;return sr(e,r,function(ie,yt){pt(),ie.pause=function(){Sa(),a=!0},ie.resume=function(){a&&(a=!1,o=null,pi(),Zl())},ie.flush=function($,ce,ve){if($===void 0&&($=!0),!a){Sa();try{return ie[uT]($,null,ve||1)}catch(Ce){Me(ie[_s](),1,22,"flush failed, telemetry will not be collected: "+An(Ce),{exception:We(Ce)})}}},ie.onunloadFlush=function(){if(!a)if(b||P)try{return ie[uT](!0,C_,2)}catch($){Me(ie[_s](),1,20,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+An($),{exception:We($)})}else ie.flush(!1)},ie.addHeader=function($,ce){d[$]=ce},ie[_7]=function($,ce,ve,Ce){ie.isInitialized()&&Me(ie[_s](),1,28,"Sender is already initialized"),yt[_7]($,ce,ve,Ce);var G=ie.identifier;u=new IAe(ce.logger),n=0,o=null,s=0,ie[lT]=null,l=0;var ee=ie[_s]();h=jc(vs("Sender"),ce.evtNamespace&&ce.evtNamespace()),m=g7(h),ie._addHook(ao($,function(pe){var Te=pe.cfg;Te.storagePrefix&&s7(Te.storagePrefix);var et=_a(null,Te,ce),Ne=et.getExtCfg(G,NAe);Vr(ie,"_senderConfig",{g:function(){return Ne}}),v!==Ne.endpointUrl&&(g=v=Ne.endpointUrl),I&&I!==Ne[x7]&&_e(I,function(Jo){delete d[Jo.header]}),y=Ne[xte],b=(Ne[S7]===!1||Ne[I7]===!1)&&rc(),_=Ne[S7]===!1&&rc(),S=Ne[I7]===!1&&rc(),P=Ne[Ste],q=!!Ne[C7],Ve=Ne.retryCodes;var vr=Ne[IA],wr=!!Ne[Ite]&&(!!vr||m_()),zi=Ne.namePrefix,sc=wr!==ne||wr&&N!==zi||wr&&Y!==vr;if(ie[qm]){if(sc)try{ie._buffer=ie._buffer[SA](ee,Ne,wr)}catch(Jo){Me(ie[_s](),1,12,"failed to transfer telemetry to different buffer storage, telemetry will be lost: "+An(Jo),{exception:We(Jo)})}pi()}else ie[qm]=wr?new Lte(ee,Ne):new P7(ee,Ne);N=zi,ne=wr,Y=vr,U=!Ne[Cte]&&gm(!0),re=!!Ne[Ete],ie._sample=new kAe(Ne.samplingPercentage,ee),A=Ne[Tte],He(A,Te)||Me(ee,1,100,"Invalid Instrumentation key "+A),I=Ne[x7],!gA(g)&&I&&I[Yt]>0?_e(I,function(Jo){r.addHeader(Jo.header,Jo.value)}):I=null,w=Ne[wte];var zm=Et();X?X.SetConfig(zm):(X=new Wb,X[_7](zm,ee));var $s=Ne.httpXHROverride,$m=null,S0=null,bDe=bm([3,1,2],Ne.transports);$m=X&&X[CA](bDe,!1);var Z7=X&&X.getFallbackInst();Z=function(Jo,I0){return It(Z7,Jo,I0)},le=function(Jo,I0){return It(Z7,Jo,I0,!1)},$m=P?$s:$m||$s||Z7,ie[lT]=function(Jo,I0){return It($m,Jo,I0)},U&&(f=E_);var eU=bm([3,1],Ne[Rte]);U||(eU=eU.filter(function(Jo){return Jo!==2})),S0=X&&X[CA](eU,!0),S0=P?$s:S0||$s,(P||Ne[Rte]||!f)&&S0&&(f=function(Jo,I0){return It(S0,Jo,I0)}),f||(f=Z),T=Ne.disableTelemetry,B=Ne[kte]||Hp,j=Ne.isRetryDisabled,F=Ne[Pte]}))},ie.processTelemetry=function($,ce){ce=ie._getTelCtx(ce);var ve=ce[_s]();try{var Ce=ct($,ve);if(!Ce)return;var G=H($,ve);if(!G)return;var ee=u[dT](G),pe=ie[qm];pi(ee),pe[Mm](ee),Zl()}catch(Te){Me(ve,2,12,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+An(Te),{exception:We(Te)})}ie.processNext($,ce)},ie.isCompletelyIdle=function(){return!a&&p===0&&ie._buffer[Fm]()===0},ie._xhrReadyStateChange=function($,ce,ve){return Cr($,ce,ve)},ie[uT]=function($,ce,ve){$===void 0&&($=!0);var Ce;if(!a)try{var G=ie[qm];if(T)G[d0]();else{if(G[Fm]()>0){var ee=G.getItems();Pe(ve||0,$),ce?Ce=ce.call(ie,ee,$):Ce=ie[lT](ee,$)}s=+new Date}Sa()}catch(Te){var pe=IP();(!pe||pe>9)&&Me(ie[_s](),1,40,"Telemetry transmission failed, some telemetry will be lost: "+An(Te),{exception:We(Te)})}return Ce},ie.getOfflineSupport=function(){var $;return $={getUrl:function(){return g},createPayload:ke},$[dT]=de,$.batch=he,$.shouldProcess=function(ce){return!!ct(ce)},$},ie._doTeardown=function($,ce){ie.onunloadFlush(),Sm(m,!1),pt()},ie[p0]=function($,ce,ve){Me(ie[_s](),2,26,"Failed to send telemetry.",{message:ce}),ie._buffer&&ie._buffer[y_]($)},ie[E7]=function($,ce){for(var ve=[],Ce=[],G=ce.errors.reverse(),ee=0,pe=G;ee<pe.length;ee++){var Te=pe[ee],et=$.splice(Te.index,1)[0];Gm(Te.statusCode)?Ce[Um](et):ve[Um](et)}$[Yt]>0&&ie[EA]($,ce[T7]),ve[Yt]>0&&ie[p0](ve,ym(null,["partial success",ce[T7],"of",ce.itemsReceived].join(" "))),Ce[Yt]>0&&(Gp(Ce),Me(ie[_s](),2,40,"Partial success. Delivered: "+$[Yt]+", Failed: "+ve[Yt]+". Will retry to send "+Ce[Yt]+" our of "+ce[dAe]+" items"))},ie[EA]=function($,ce){ie._buffer&&ie._buffer[y_]($)},ie._xdrOnLoad=function($,ce){return Ye($,ce)};function Ye($,ce){var ve=DAe($);if($&&(ve+""=="200"||ve===""))n=0,ie[EA](ce,0);else{var Ce=Hb(ve);Ce&&Ce.itemsReceived&&Ce.itemsReceived>Ce[T7]&&!j?ie[E7](ce,Ce):ie[p0](ce,qb($))}}function Et(){var $;try{var ce={xdrOnComplete:function(Ce,G,ee){var pe=be(ee);if(pe)return Ye(Ce,pe)},fetchOnComplete:function(Ce,G,ee,pe){var Te=be(pe);if(Te)return zs(Ce.status,Te,Ce.url,Te[Yt],Ce.statusText,ee||"")},xhrOnComplete:function(Ce,G,ee){var pe=be(ee);if(pe)return Cr(Ce,pe,pe[Yt])},beaconOnRetry:function(Ce,G,ee){return x0(Ce,G,ee)}},ve=($={},$[wte]=w,$.isOneDs=!1,$.disableCredentials=!1,$[C7]=q,$.disableBeacon=!S,$.disableBeaconSync=!_,$.senderOnCompleteCallBack=ce,$);return ve}catch{}return null}function Cr($,ce,ve){$.readyState===4&&zs($.status,ce,$.responseURL,ve,ym($),DAe($)||$.response)}function be($){try{if($){var ce=$,ve=ce[w7];return ve&&ve[Yt]?ve:null}}catch{}return null}function ct($,ce){if(T)return!1;if(!$)return ce&&Me(ce,1,7,"Cannot send empty telemetry"),!1;if($.baseData&&!$[R7])return ce&&Me(ce,1,70,"Cannot send telemetry without baseData and baseType"),!1;if($[R7]||($[R7]="EventData"),!ie[lT])return ce&&Me(ce,1,28,"Sender was not initialized"),!1;if(Ie($))$[YE]=ie._sample[pT];else return ce&&Me(ce,2,33,"Telemetry item was sampled out and not sent",{SampleRate:ie._sample[pT]}),!1;return!0}function H($,ce){var ve=$.iKey||A,Ce=e.constructEnvelope($,ve,ce,B);if(!Ce){Me(ce,1,47,"Unable to create an AppInsights envelope");return}var G=!1;if($[lo]&&$[lo][QE]&&(_e($[lo][QE],function(ee){try{ee&&ee(Ce)===!1&&(G=!0,ba(ce,"Telemetry processor check returns false"))}catch(pe){Me(ce,1,64,"One of telemetry initializers failed, telemetry item will not be sent: "+An(pe),{exception:We(pe)},!0)}}),delete $[lo][QE]),!G)return Ce}function de($){var ce=AAe,ve=ie[_s]();try{var Ce=ct($,ve),G=null;Ce&&(G=H($,ve)),G&&(ce=u[dT](G))}catch{}return ce}function he($){var ce=AAe;return $&&$[Yt]&&(ce="["+$.join(",")+"]"),ce}function ke($){var ce,ve=Dn();return ce={urlString:g},ce[bs]=$,ce.headers=ve,ce}function Ie($){return ie._sample.isSampledIn($)}function ut($,ce,ve,Ce){ce===200&&$?ie._onSuccess($,$[Yt]):Ce&&ie[p0]($,Ce)}function It($,ce,ve,Ce){Ce===void 0&&(Ce=!0);var G=function(Te,et,Ne){return ut(ce,Te,et,Ne)},ee=on(ce),pe=$&&$.sendPOST;return pe&&ee?(Ce&&ie._buffer[aT](ce),pe(ee,G,!ve)):null}function on($){var ce;if(st($)&&$[Yt]>0){var ve=ie[qm].batchPayloads($),Ce=Dn(),G=(ce={},ce[bs]=ve,ce.urlString=g,ce.headers=Ce,ce.disableXhrSync=q,ce.disableFetchKeepAlive=!U,ce[w7]=$,ce);return G}return null}function Dn(){try{var $=d||{};return gA(g)&&($[o_[6]]=o_[7]),$}catch{}return null}function pi($){var ce=$?$[Yt]:0;return ie[qm].size()+ce>y?((!m||m.isOnline())&&ie[uT](!0,null,10),!0):!1}function zs($,ce,ve,Ce,G,ee){var pe=null;if(ie._appId||(pe=Hb(ee),pe&&pe.appId&&(ie._appId=pe.appId)),($<200||$>=300)&&$!==0){if(($===301||$===307||$===308)&&!Vp(ve)){ie[p0](ce,G);return}!j&&Gm($)?(Gp(ce),Me(ie[_s](),2,40,". Response code "+$+". Will retry to send "+ce[Yt]+" items.")):ie[p0](ce,G)}else if(m&&!m.isOnline()){if(!j){var Te=10;Gp(ce,Te),Me(ie[_s](),2,40,". Offline - Response Code: ".concat($,". Offline status: ").concat(!m.isOnline(),". Will retry to send ").concat(ce.length," items."))}}else Vp(ve),$===206?(pe||(pe=Hb(ee)),pe&&!j?ie[E7](ce,pe):ie[p0](ce,G)):(n=0,ie[EA](ce,Ce))}function Vp($){return l>=10?!1:!Ee($)&&$!==""&&$!==g?(g=$,++l,!0):!1}function C_($,ce){if(f)f($,!1);else{var ve=X&&X[CA]([3],!0);return It(ve,$,ce)}}function x0($,ce,ve){var Ce=$,G=Ce&&Ce[w7];if(re)le&&le(G,!0),Me(ie[_s](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender.");else{for(var ee=[],pe=0;pe<G[Yt];pe++){var Te=G[pe],et=[Te],Ne=on(et);ve(Ne,ce)?ie._onSuccess(et,et[Yt]):ee[Um](Te)}ee[Yt]>0&&(le&&le(ee,!0),Me(ie[_s](),2,40,". Failed to send telemetry with Beacon API, retried with normal sender."))}}function E_($,ce){var ve=null;if(st($)){for(var Ce=$[Yt],G=0;G<$[Yt];G++)Ce+=$[G][Yt];var ee=X.getSyncFetchPayload();ee+Ce<=sct?ve=2:rc()?ve=3:(ve=1,Me(ie[_s](),2,40,". Failed to send telemetry with Beacon API, retried with xhrSender."));var pe=X&&X[CA]([ve],!0);return It(pe,$,ce)}return null}function Gp($,ce){if(ce===void 0&&(ce=1),!(!$||$[Yt]===0)){var ve=ie[qm];ve[y_]($),n++;for(var Ce=0,G=$;Ce<G.length;Ce++){var ee=G[Ce];ve[Mm](ee)}wT(ce),Zl()}}function wT($){var ce=10,ve;if(n<=1)ve=ce;else{var Ce=(Math.pow(2,n)-1)/2,G=Math.floor(Math.random()*Ce*ce)+1;G=$*G,ve=Math.max(Math.min(G,3600),ce)}var ee=li()+ve*1e3;o=ee}function Zl(){if(!c&&!a){var $=o?Math.max(0,o-li()):0,ce=Math.max(F,$);c=Wa(function(){c=null,ie[uT](!0,null,1)},ce)}}function Sa(){c&&c.cancel(),c=null,o=null}function Gm($){return Ee(Ve)?$===401||$===408||$===429||$===500||$===502||$===503||$===504:Ve[Yt]&&Ve.indexOf($)>-1}function J(){var $="getNotifyMgr";return ie.core[$]?ie.core[$]():ie.core._notificationManager}function Pe($,ce){var ve=J();if(ve&&ve[Ate])try{ve[Ate]($,ce)}catch(Ce){Me(ie[_s](),1,74,"send request notification failed: "+An(Ce),{exception:We(Ce)})}}function He($,ce){var ve=ce.disableInstrumentationKeyValidation,Ce=Ee(ve)?!1:ve;if(Ce)return!0;var G="^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$",ee=new RegExp(G);return ee.test($)}function pt(){ie[lT]=null,ie[qm]=null,ie._appId=null,ie._sample=null,d={},m=null,n=0,o=null,s=null,a=!1,c=null,u=null,l=0,p=0,f=null,h=null,g=null,v=null,y=0,b=!1,I=null,T=!1,A=null,B=Hp,j=!1,ne=null,N=Hp,q=!1,U=!1,re=!1,Z=null,le=null,X=null,Vr(ie,"_senderConfig",{g:function(){return PF({},NAe)}})}}),r}return e.constructEnvelope=function(r,n,o,s){var a;n!==r.iKey&&!Ee(n)?a=Wu(Wu({},r),{iKey:n}):a=r;var c=uct[a.baseType]||Nte;return c(o,a,s)},e}(Tm)});var Ote=R(()=>{LAe()});var A7,D7,N7,wA,OAe=R(()=>{A7="instrumentationKey",D7="connectionString",N7="endpointUrl",wA="userOverrideEndpointUrl"});var MAe={};mn(MAe,{AppInsightsCore:()=>wm,ApplicationInsights:()=>pct,Sender:()=>TA,SeverityLevel:()=>m7,arrForEach:()=>_e,isNullOrUndefined:()=>Ee,proxyFunctions:()=>Hc,throwError:()=>ai});function dct(t){return t&&t>0}var lct,pct,FAe=R(()=>{Wo();Ote();Lm();en();St();OAe();en();Lm();Ote();lct={diagnosticLogInterval:kE(dct,1e4)};pct=function(){function t(e){var r=new wm,n;(Ee(e)||Ee(e[A7])&&Ee(e[D7]))&&ai("Invalid input configuration"),sr(t,this,function(s){Vr(s,"config",{g:function(){return n}}),a(),s.initialize=a,s.track=o,Hc(s,r,["flush","pollInternalLogs","stopPollingInternalLogs","unload","getPlugin","addPlugin","evtNamespace","addUnloadCb","onCfgChange"]);function a(){var c=Xn(e||{},lct);n=c.cfg,r.addUnloadHook(ao(c,function(){if(n[D7]){var u=vA(n[D7]),l=u.ingestionendpoint;n[N7]=n[wA]?n[wA]:l+Lp,n[A7]=u.instrumentationkey||n[A7]}n[N7]=n[wA]?n[wA]:n[N7]})),r.initialize(n,[new TA])}});function o(s){s&&(s.baseData=s.baseData||{},s.baseType=s.baseType||"EventData"),r.track(s)}}return t.__ieDyn=1,t}()});var UAe=M(jp=>{"use strict";var fct=jp&&jp.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),mct=jp&&jp.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),hct=jp&&jp.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&fct(e,t,r);return mct(e,t),e};Object.defineProperty(jp,"__esModule",{value:!0});jp.appInsightsClientFactory=void 0;var gct=(Lm(),$i(uAe)),vct=WX(),yct=async(t,e,r)=>{let n;try{let s=await Promise.resolve().then(()=>hct((FAe(),$i(MAe)))),a={};if(e){let c={alwaysUseXhrOverride:!0,httpXHROverride:e};a[gct.BreezeChannelIdentifier]=c}n=new s.ApplicationInsights({instrumentationKey:t,disableAjaxTracking:!0,disableExceptionTracking:!0,disableFetchTracking:!0,disableCorrelationHeaders:!0,disableCookiesUsage:!0,autoTrackPageVisitTime:!1,emitLineDelimitedJson:!1,disableInstrumentationKeyValidation:!0,extensionConfig:a})}catch(s){return Promise.reject(s)}return{logEvent:(s,a)=>{let c={...a?.properties,...a?.measurements};r?.length&&vct.TelemetryUtil.applyReplacements(c,r),n?.track({name:s,data:c,baseType:"EventData",baseData:{name:s,properties:a?.properties,measurements:a?.measurements}})},flush:async()=>{n?.flush(!1)},dispose:async()=>new Promise(a=>{n?.unload(!0,()=>{a(),n=void 0},1e3)})}};jp.appInsightsClientFactory=yct});var jAe=M(jm=>{"use strict";var bct=jm&&jm.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var o=Object.getOwnPropertyDescriptor(e,r);(!o||("get"in o?!e.__esModule:o.writable||o.configurable))&&(o={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,o)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),_ct=jm&&jm.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ute=jm&&jm.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&bct(e,t,r);return _ct(e,t),e};Object.defineProperty(jm,"__esModule",{value:!0});var Mte=Ute(require("os")),BAe=Ute(require("vscode")),xct=Ute(require("https")),Sct=nwe(),Ict=iwe(),qAe=WX(),Cct=oPe(),Ect=UAe();function HAe(){return{sendPOST:(e,r)=>{let n={method:"POST",headers:{...e.headers,"Content-Type":"application/json","Content-Length":Buffer.byteLength(e.data)}};try{let o=xct.request(e.urlString,n,s=>{s.on("data",function(a){r(s.statusCode??200,s.headers,a.toString())}),s.on("error",function(){r(0,{})})});o.write(e.data,s=>{s&&r(0,{})}),o.end()}catch{r(0,{})}}}}var Fte=class extends Sct.BaseTelemetryReporter{constructor(e,r){let n=a=>(0,Ect.appInsightsClientFactory)(a,HAe(),r);qAe.TelemetryUtil.shouldUseOneDataSystemSDK(e)&&(n=a=>(0,Cct.oneDataSystemClientFactory)(a,BAe,HAe()));let o={release:Mte.release(),platform:Mte.platform(),architecture:Mte.arch()},s=new Ict.BaseTelemetrySender(e,n);if(e&&e.indexOf("AIF-")===0)throw new Error("AIF keys are no longer supported. Please switch to 1DS keys for 1st party extensions");super(s,BAe,{additionalCommonProperties:qAe.TelemetryUtil.getAdditionalCommonProperties(o)})}};jm.default=Fte});var eut={};mn(eut,{activate:()=>Xct,createExtensionContext:()=>vDe,onDeactivate:()=>yDe,outputChannel:()=>Kw});module.exports=$i(eut);var AA=z(Qt()),gDe=z(require("path")),Gc=require("vscode");var ol;(o=>{o.serviceIds=new Map,o.DI_TARGET="$di$target",o.DI_DEPENDENCIES="$di$dependencies";function n(s){return s[o.DI_DEPENDENCIES]||[]}o.getServiceDependencies=n})(ol||={});var te=ae("instantiationService");function MDe(t,e,r){e[ol.DI_TARGET]===e?e[ol.DI_DEPENDENCIES].push({id:t,index:r}):(e[ol.DI_DEPENDENCIES]=[{id:t,index:r}],e[ol.DI_TARGET]=e)}function ae(t){if(ol.serviceIds.has(t))return ol.serviceIds.get(t);let e=function(r,n,o){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");MDe(e,r,o)};return e.toString=()=>t,ol.serviceIds.set(t,e),e}var rU=class{constructor(){this.listeners=[],this.unexpectedErrorHandler=function(e){setTimeout(()=>{throw e.stack?NA.isErrorNoTelemetry(e)?new NA(e.message+`

`+e.stack):new Error(e.message+`

`+e.stack):e},0)}}addListener(e){return this.listeners.push(e),()=>{this._removeListener(e)}}emit(e){this.listeners.forEach(r=>{r(e)})}_removeListener(e){this.listeners.splice(this.listeners.indexOf(e),1)}setUnexpectedErrorHandler(e){this.unexpectedErrorHandler=e}getUnexpectedErrorHandler(){return this.unexpectedErrorHandler}onUnexpectedError(e){this.unexpectedErrorHandler(e),this.emit(e)}onUnexpectedExternalError(e){this.unexpectedErrorHandler(e)}},UDe=new rU;function Wm(t){zp(t)||UDe.onUnexpectedError(t)}var nU="Canceled";function zp(t){return t instanceof fo?!0:t instanceof Error&&t.name===nU&&t.message===nU}var fo=class extends Error{constructor(){super(nU),this.name=this.message}};function Gr(t){return t?new Error(`Illegal argument: ${t}`):new Error("Illegal argument")}function ore(t){return t?new Error(`Illegal state: ${t}`):new Error("Illegal state")}function LA(t){return t?t.message?t.message:t.stack?t.stack.split(`
`)[0]:String(t):"Error"}var NA=class t extends Error{constructor(e){super(e),this.name="CodeExpectedError"}static fromError(e){if(e instanceof t)return e;let r=new t;return r.message=e.message,r.stack=e.stack,r}static isErrorNoTelemetry(e){return e.name==="CodeExpectedError"}},sn=class t extends Error{constructor(e){super(e||"An unexpected bug occurred."),Object.setPrototypeOf(this,t.prototype)}};function iU(t,e){let r=this,n=!1,o;return function(){if(n)return o;if(n=!0,e)try{o=t.apply(r,arguments)}finally{e()}else o=t.apply(r,arguments);return o}}function are(t,e){let r=oU(t,e);if(r!==-1)return t[r]}function oU(t,e,r=t.length-1){for(let n=r;n>=0;n--){let o=t[n];if(e(o))return n}return-1}function sU(t,e){let r=ed(t,e);return r===-1?void 0:t[r]}function ed(t,e,r=0,n=t.length){let o=r,s=n;for(;o<s;){let a=Math.floor((o+s)/2);e(t[a])?o=a+1:s=a}return o-1}function T_(t,e,r=0,n=t.length){let o=r,s=n;for(;o<s;){let a=Math.floor((o+s)/2);e(t[a])?s=a:o=a+1}return o}var sre=class t{constructor(e){this._array=e;this._findLastMonotonousLastIdx=0}static{this.assertInvariants=!1}findLastMonotonous(e){if(t.assertInvariants){if(this._prevFindLastPredicate){for(let n of this._array)if(this._prevFindLastPredicate(n)&&!e(n))throw new Error("MonotonousArray: current predicate must be weaker than (or equal to) the previous predicate.")}this._prevFindLastPredicate=e}let r=ed(this._array,e,this._findLastMonotonousLastIdx);return this._findLastMonotonousLastIdx=r+1,r===-1?void 0:this._array[r]}};function OA(t,e){for(let r of t){let n=e(r);if(n!==void 0)return n}}function aU(t,e,r=(n,o)=>n===o){if(t===e)return!0;if(!t||!e||t.length!==e.length)return!1;for(let n=0,o=t.length;n<o;n++)if(!r(t[n],e[n]))return!1;return!0}function ure(t,e){let r=0,n=t-1;for(;r<=n;){let o=(r+n)/2|0,s=e(o);if(s<0)r=o+1;else if(s>0)n=o-1;else return o}return-(r+1)}function Xt(t){return t.filter(e=>!!e)}function lre(t,e){let r;if(typeof e=="number"){let n=e;r=()=>{let o=Math.sin(n++)*179426549;return o-Math.floor(o)}}else r=Math.random;for(let n=t.length-1;n>0;n-=1){let o=Math.floor(r()*(n+1)),s=t[n];t[n]=t[o],t[o]=s}}var dre;(c=>{function t(u){return u<0}c.isLessThan=t;function e(u){return u<=0}c.isLessThanOrEqual=e;function r(u){return u>0}c.isGreaterThan=r;function n(u){return u===0}c.isNeitherLessOrGreaterThan=n,c.greaterThan=1,c.lessThan=-1,c.neitherLessOrGreaterThan=0})(dre||={});function MA(t,e){return(r,n)=>e(t(r),t(n))}var FA=(t,e)=>t-e;var cre=class t{constructor(e){this.iterate=e}static{this.empty=new t(e=>{})}forEach(e){this.iterate(r=>(e(r),!0))}toArray(){let e=[];return this.iterate(r=>(e.push(r),!0)),e}filter(e){return new t(r=>this.iterate(n=>e(n)?r(n):!0))}map(e){return new t(r=>this.iterate(n=>r(e(n))))}some(e){let r=!1;return this.iterate(n=>(r=e(n),!r)),r}findFirst(e){let r;return this.iterate(n=>e(n)?(r=n,!1):!0),r}findLast(e){let r;return this.iterate(n=>(e(n)&&(r=n),!0)),r}findLastMaxBy(e){let r,n=!0;return this.iterate(o=>((n||dre.isGreaterThan(e(o,r)))&&(n=!1,r=o),!0)),r}};function fre(t,e){let r=Object.create(null);for(let n of t){let o=e(n),s=r[o];s||(s=r[o]=[]),s.push(n)}return r}var qDe,pre=class{constructor(e,r){this.toKey=r;this._map=new Map;this[qDe]="SetWithKey";for(let n of e)this.add(n)}static{qDe=Symbol.toStringTag}get size(){return this._map.size}add(e){let r=this.toKey(e);return this._map.set(r,e),this}delete(e){return this._map.delete(this.toKey(e))}has(e){return this._map.has(this.toKey(e))}*entries(){for(let e of this._map.values())yield[e,e]}keys(){return this.values()}*values(){for(let e of this._map.values())yield e}clear(){this._map.clear()}forEach(e,r){this._map.forEach(n=>e.call(r,n,n,this))}[Symbol.iterator](){return this.values()}};var uU=class{constructor(e,r){this.uri=e;this.value=r}};function HDe(t){return Array.isArray(t)}var jDe,Nn=class t{constructor(e,r){this[jDe]="ResourceMap";if(e instanceof t)this.map=new Map(e.map),this.toKey=r??t.defaultToKey;else if(HDe(e)){this.map=new Map,this.toKey=r??t.defaultToKey;for(let[n,o]of e)this.set(n,o)}else this.map=new Map,this.toKey=e??t.defaultToKey}static{this.defaultToKey=e=>e.toString()}set(e,r){return this.map.set(this.toKey(e),new uU(e,r)),this}get(e){return this.map.get(this.toKey(e))?.value}has(e){return this.map.has(this.toKey(e))}get size(){return this.map.size}clear(){this.map.clear()}delete(e){return this.map.delete(this.toKey(e))}forEach(e,r){typeof r<"u"&&(e=e.bind(r));for(let[n,o]of this.map)e(o.value,o.uri,this)}*values(){for(let e of this.map.values())yield e.value}*keys(){for(let e of this.map.values())yield e.uri}*entries(){for(let e of this.map.values())yield[e.uri,e.value]}*[(jDe=Symbol.toStringTag,Symbol.iterator)](){for(let[,e]of this.map)yield[e.uri,e.value]}},VDe,mre=class{constructor(e,r){this[VDe]="ResourceSet";!e||typeof e=="function"?this._map=new Nn(e):(this._map=new Nn(r),e.forEach(this.add,this))}get size(){return this._map.size}add(e){return this._map.set(e,e),this}clear(){this._map.clear()}delete(e){return this._map.delete(e)}forEach(e,r){this._map.forEach((n,o)=>e.call(r,o,o,this))}has(e){return this._map.has(e)}entries(){return this._map.entries()}keys(){return this._map.keys()}values(){return this._map.keys()}[(VDe=Symbol.toStringTag,Symbol.iterator)](){return this.keys()}};var GDe,lU=class{constructor(){this[GDe]="LinkedMap";this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,r=0){let n=this._map.get(e);if(n)return r!==0&&this.touch(n,r),n.value}set(e,r,n=0){let o=this._map.get(e);if(o)o.value=r,n!==0&&this.touch(o,n);else{switch(o={key:e,value:r,next:void 0,previous:void 0},n){case 0:this.addItemLast(o);break;case 1:this.addItemFirst(o);break;case 2:this.addItemLast(o);break;default:this.addItemLast(o);break}this._map.set(e,o),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let r=this._map.get(e);if(r)return this._map.delete(e),this.removeItem(r),this._size--,r.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,r){let n=this._state,o=this._head;for(;o;){if(r?e.bind(r)(o.value,o.key,this):e(o.value,o.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");o=o.next}}keys(){let e=this,r=this._state,n=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==r)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:n.key,done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return o}values(){let e=this,r=this._state,n=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==r)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:n.value,done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return o}entries(){let e=this,r=this._state,n=this._head,o={[Symbol.iterator](){return o},next(){if(e._state!==r)throw new Error("LinkedMap got modified during iteration.");if(n){let s={value:[n.key,n.value],done:!1};return n=n.next,s}else return{value:void 0,done:!0}}};return o}[(GDe=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let r=this._head,n=this.size;for(;r&&n>e;)this._map.delete(r.key),r=r.next,n--;this._head=r,this._size=n,r&&(r.previous=void 0),this._state++}trimNew(e){if(e>=this.size)return;if(e===0){this.clear();return}let r=this._tail,n=this.size;for(;r&&n>e;)this._map.delete(r.key),r=r.previous,n--;this._tail=r,this._size=n,r&&(r.next=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let r=e.next,n=e.previous;if(!r||!n)throw new Error("Invalid list");r.previous=n,n.next=r}e.next=void 0,e.previous=void 0,this._state++}touch(e,r){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(r!==1&&r!==2)){if(r===1){if(e===this._head)return;let n=e.next,o=e.previous;e===this._tail?(o.next=void 0,this._tail=o):(n.previous=o,o.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(r===2){if(e===this._tail)return;let n=e.next,o=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=o,o.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((r,n)=>{e.push([n,r])}),e}fromJSON(e){this.clear();for(let[r,n]of e)this.set(r,n)}},dU=class extends lU{constructor(e,r=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,r),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,r=2){return super.get(e,r)}peek(e){return super.get(e,0)}set(e,r){return super.set(e,r,2),this}checkTrim(){this.size>this._limit&&this.trim(Math.round(this._limit*this._ratio))}},w_=class extends dU{constructor(e,r=1){super(e,r)}trim(e){this.trimOld(e)}set(e,r){return super.set(e,r),this.checkTrim(),this}};var UA=class{constructor(){this.map=new Map}add(e,r){let n=this.map.get(e);n||(n=new Set,this.map.set(e,n)),n.add(r)}delete(e,r){let n=this.map.get(e);n&&(n.delete(r),n.size===0&&this.map.delete(e))}forEach(e,r){let n=this.map.get(e);n&&n.forEach(r)}get(e){let r=this.map.get(e);return r||new Set}};var xs;(_=>{function t(S){return S&&typeof S=="object"&&typeof S[Symbol.iterator]=="function"}_.is=t;let e=Object.freeze([]);function r(){return e}_.empty=r;function*n(S){yield S}_.single=n;function o(S){return t(S)?S:n(S)}_.wrap=o;function s(S){return S||e}_.from=s;function*a(S){for(let I=S.length-1;I>=0;I--)yield S[I]}_.reverse=a;function c(S){return!S||S[Symbol.iterator]().next().done===!0}_.isEmpty=c;function u(S){return S[Symbol.iterator]().next().value}_.first=u;function l(S,I){let T=0;for(let A of S)if(I(A,T++))return!0;return!1}_.some=l;function d(S,I){for(let T of S)if(I(T))return T}_.find=d;function*p(S,I){for(let T of S)I(T)&&(yield T)}_.filter=p;function*f(S,I){let T=0;for(let A of S)yield I(A,T++)}_.map=f;function*m(S,I){let T=0;for(let A of S)yield*I(A,T++)}_.flatMap=m;function*h(...S){for(let I of S)yield*I}_.concat=h;function g(S,I,T){let A=T;for(let B of S)A=I(A,B);return A}_.reduce=g;function*v(S,I,T=S.length){for(I<0&&(I+=S.length),T<0?T+=S.length:T>S.length&&(T=S.length);I<T;I++)yield S[I]}_.slice=v;function y(S,I=Number.POSITIVE_INFINITY){let T=[];if(I===0)return[T,S];let A=S[Symbol.iterator]();for(let B=0;B<I;B++){let j=A.next();if(j.done)return[T,_.empty()];T.push(j.value)}return[T,{[Symbol.iterator](){return A}}]}_.consume=y;async function b(S){let I=[];for await(let T of S)I.push(T);return Promise.resolve(I)}_.asyncToArray=b})(xs||={});var zDe=!1,R_=null,hre=class t{constructor(){this.livingDisposables=new Map}static{this.idx=0}getDisposableData(e){let r=this.livingDisposables.get(e);return r||(r={parent:null,source:null,isSingleton:!1,value:e,idx:t.idx++},this.livingDisposables.set(e,r)),r}trackDisposable(e){let r=this.getDisposableData(e);r.source||(r.source=new Error().stack)}setParent(e,r){let n=this.getDisposableData(e);n.parent=r}markAsDisposed(e){this.livingDisposables.delete(e)}markAsSingleton(e){this.getDisposableData(e).isSingleton=!0}getRootParent(e,r){let n=r.get(e);if(n)return n;let o=e.parent?this.getRootParent(this.getDisposableData(e.parent),r):e;return r.set(e,o),o}getTrackedDisposables(){let e=new Map;return[...this.livingDisposables.entries()].filter(([,n])=>n.source!==null&&!this.getRootParent(n,e).isSingleton).flatMap(([n])=>n)}computeLeakingDisposables(e=10,r){let n;if(r)n=r;else{let u=new Map,l=[...this.livingDisposables.values()].filter(p=>p.source!==null&&!this.getRootParent(p,u).isSingleton);if(l.length===0)return;let d=new Set(l.map(p=>p.value));if(n=l.filter(p=>!(p.parent&&d.has(p.parent))),n.length===0)throw new Error("There are cyclic diposable chains!")}if(!n)return;function o(u){function l(p,f){for(;p.length>0&&f.some(m=>typeof m=="string"?m===p[0]:p[0].match(m));)p.shift()}let d=u.source.split(`
`).map(p=>p.trim().replace("at ","")).filter(p=>p!=="");return l(d,["Error",/^trackDisposable \(.*\)$/,/^DisposableTracker.trackDisposable \(.*\)$/]),d.reverse()}let s=new UA;for(let u of n){let l=o(u);for(let d=0;d<=l.length;d++)s.add(l.slice(0,d).join(`
`),u)}n.sort(MA(u=>u.idx,FA));let a="",c=0;for(let u of n.slice(0,e)){c++;let l=o(u),d=[];for(let p=0;p<l.length;p++){let f=l[p];f=`(shared with ${s.get(l.slice(0,p+1).join(`
`)).size}/${n.length} leaks) at ${f}`;let h=s.get(l.slice(0,p).join(`
`)),g=fre([...h].map(v=>o(v)[p]),v=>v);delete g[l[p]];for(let[v,y]of Object.entries(g))d.unshift(`    - stacktraces of ${y.length} other leaks continue with ${v}`);d.unshift(f)}a+=`


==================== Leaking disposable ${c}/${n.length}: ${u.value.constructor.name} ====================
${d.join(`
`)}
============================================================

`}return n.length>e&&(a+=`


... and ${n.length-e} more leaking disposables

`),{leaks:n,details:a}}};function $De(t){R_=t}if(zDe){let t="__is_disposable_tracked__";$De(new class{trackDisposable(e){let r=new Error("Potentially leaked disposable").stack;setTimeout(()=>{e[t]||console.log(r)},3e3)}setParent(e,r){if(e&&e!==Ct.None)try{e[t]=!0}catch{}}markAsDisposed(e){if(e&&e!==Ct.None)try{e[t]=!0}catch{}}markAsSingleton(e){}})}function C0(t){return R_?.trackDisposable(t),t}function E0(t){R_?.markAsDisposed(t)}function PT(t,e){R_?.setParent(t,e)}function WDe(t,e){if(R_)for(let r of t)R_.setParent(r,e)}function P_(t){return typeof t=="object"&&t!==null&&typeof t.dispose=="function"&&t.dispose.length===0}function Km(t){if(xs.is(t)){let e=[];for(let r of t)if(r)try{r.dispose()}catch(n){e.push(n)}if(e.length===1)throw e[0];if(e.length>1)throw new AggregateError(e,"Encountered errors while disposing of store");return Array.isArray(t)?[]:t}else if(t)return t.dispose(),t}function BA(...t){let e=sl(()=>Km(t));return WDe(t,e),e}function sl(t){let e=C0({dispose:iU(()=>{E0(e),t()})});return e}var Tt=class t{constructor(){this._toDispose=new Set;this._isDisposed=!1;C0(this)}static{this.DISABLE_DISPOSED_WARNING=!1}dispose(){this._isDisposed||(E0(this),this._isDisposed=!0,this.clear())}get isDisposed(){return this._isDisposed}clear(){if(this._toDispose.size!==0)try{Km(this._toDispose)}finally{this._toDispose.clear()}}add(e){if(!e)return e;if(e===this)throw new Error("Cannot register a disposable on itself!");return PT(e,this),this._isDisposed?t.DISABLE_DISPOSED_WARNING||console.warn(new Error("Trying to add a disposable to a DisposableStore that has already been disposed of. The added object will be leaked!").stack):this._toDispose.add(e),e}delete(e){if(e){if(e===this)throw new Error("Cannot dispose a disposable on itself!");this._toDispose.delete(e),e.dispose()}}deleteAndLeak(e){e&&this._toDispose.has(e)&&(this._toDispose.delete(e),PT(e,null))}},Ct=class{constructor(){this._store=new Tt;C0(this),PT(this._store,this)}static{this.None=Object.freeze({dispose(){}})}dispose(){E0(this),this._store.dispose()}_register(e){if(e===this)throw new Error("Cannot register a disposable on itself!");return this._store.add(e)}},AT=class{constructor(){this._isDisposed=!1;C0(this)}get value(){return this._isDisposed?void 0:this._value}set value(e){this._isDisposed||e===this._value||(this._value?.dispose(),e&&PT(e,this),this._value=e)}clear(){this.value=void 0}dispose(){this._isDisposed=!0,E0(this),this._value?.dispose(),this._value=void 0}clearAndLeak(){let e=this._value;return this._value=void 0,e&&PT(e,null),e}};var k_=class{constructor(){this._store=new Map;this._isDisposed=!1;C0(this)}dispose(){E0(this),this._isDisposed=!0,this.clearAndDisposeAll()}clearAndDisposeAll(){if(this._store.size)try{Km(this._store.values())}finally{this._store.clear()}}has(e){return this._store.has(e)}get size(){return this._store.size}get(e){return this._store.get(e)}set(e,r,n=!1){this._isDisposed&&console.warn(new Error("Trying to add a disposable to a DisposableMap that has already been disposed of. The added object will be leaked!").stack),n||this._store.get(e)?.dispose(),this._store.set(e,r)}deleteAndDispose(e){this._store.get(e)?.dispose(),this._store.delete(e)}deleteAndLeak(e){let r=this._store.get(e);return this._store.delete(e),r}keys(){return this._store.keys()}values(){return this._store.values()}[Symbol.iterator](){return this._store[Symbol.iterator]()}};var Ln=class t{static{this.Undefined=new t(void 0)}constructor(e){this.element=e,this.next=t.Undefined,this.prev=t.Undefined}},DT=class{constructor(){this._first=Ln.Undefined;this._last=Ln.Undefined;this._size=0}get size(){return this._size}isEmpty(){return this._first===Ln.Undefined}clear(){let e=this._first;for(;e!==Ln.Undefined;){let r=e.next;e.prev=Ln.Undefined,e.next=Ln.Undefined,e=r}this._first=Ln.Undefined,this._last=Ln.Undefined,this._size=0}unshift(e){return this._insert(e,!1)}push(e){return this._insert(e,!0)}_insert(e,r){let n=new Ln(e);if(this._first===Ln.Undefined)this._first=n,this._last=n;else if(r){let s=this._last;this._last=n,n.prev=s,s.next=n}else{let s=this._first;this._first=n,n.next=s,s.prev=n}this._size+=1;let o=!1;return()=>{o||(o=!0,this._remove(n))}}shift(){if(this._first!==Ln.Undefined){let e=this._first.element;return this._remove(this._first),e}}pop(){if(this._last!==Ln.Undefined){let e=this._last.element;return this._remove(this._last),e}}_remove(e){if(e.prev!==Ln.Undefined&&e.next!==Ln.Undefined){let r=e.prev;r.next=e.next,e.next.prev=r}else e.prev===Ln.Undefined&&e.next===Ln.Undefined?(this._first=Ln.Undefined,this._last=Ln.Undefined):e.next===Ln.Undefined?(this._last=this._last.prev,this._last.next=Ln.Undefined):e.prev===Ln.Undefined&&(this._first=this._first.next,this._first.prev=Ln.Undefined);this._size-=1}*[Symbol.iterator](){let e=this._first;for(;e!==Ln.Undefined;)yield e.element,e=e.next}};var KDe=globalThis.performance&&typeof globalThis.performance.now=="function",Ws=class t{static create(e){return new t(e)}constructor(e){this._now=KDe&&e===!1?Date.now:globalThis.performance.now.bind(globalThis.performance),this._startTime=this._now(),this._stopTime=-1}stop(){this._stopTime=this._now()}reset(){this._startTime=this._now(),this._stopTime=-1}elapsed(){return this._stopTime!==-1?this._stopTime-this._startTime:this._now()-this._startTime}};var YDe=!1,gre=!1,QDe=!1,al;(Y=>{Y.None=()=>Ct.None;function e(N){if(QDe){let{onDidAddListener:w}=N,P=NT.create(),q=0;N.onDidAddListener=()=>{++q===2&&(console.warn("snapshotted emitter LIKELY used public and SHOULD HAVE BEEN created with DisposableStore. snapshotted here"),P.print()),w?.()}}}function r(N,w){return f(N,()=>{},0,void 0,!0,void 0,w)}Y.defer=r;function n(N){return(w,P=null,q)=>{let U=!1,Z;return Z=N(le=>{if(!U)return Z?Z.dispose():U=!0,w.call(P,le)},null,q),U&&Z.dispose(),Z}}Y.once=n;function o(N,w,P){return d((q,U=null,Z)=>N(le=>q.call(U,w(le)),null,Z),P)}Y.map=o;function s(N,w,P){return d((q,U=null,Z)=>N(le=>{w(le),q.call(U,le)},null,Z),P)}Y.forEach=s;function a(N,w,P){return d((q,U=null,Z)=>N(le=>w(le)&&q.call(U,le),null,Z),P)}Y.filter=a;function c(N){return N}Y.signal=c;function u(...N){return(w,P=null,q)=>{let U=BA(...N.map(Z=>Z(le=>w.call(P,le))));return p(U,q)}}Y.any=u;function l(N,w,P,q){let U=P;return o(N,Z=>(U=w(U,Z),U),q)}Y.reduce=l;function d(N,w){let P,q={onWillAddFirstListener(){P=N(U.fire,U)},onDidRemoveLastListener(){P?.dispose()}};w||e(q);let U=new Gt(q);return w?.add(U),U.event}function p(N,w){return w instanceof Array?w.push(N):w&&w.add(N),N}function f(N,w,P=100,q=!1,U=!1,Z,le){let re,X,Ve,ie=0,yt,Ye={leakWarningThreshold:Z,onWillAddFirstListener(){re=N(Cr=>{ie++,X=w(X,Cr),q&&!Ve&&(Et.fire(X),X=void 0),yt=()=>{let be=X;X=void 0,Ve=void 0,(!q||ie>1)&&Et.fire(be),ie=0},typeof P=="number"?(clearTimeout(Ve),Ve=setTimeout(yt,P)):Ve===void 0&&(Ve=0,queueMicrotask(yt))})},onWillRemoveListener(){U&&ie>0&&yt?.()},onDidRemoveLastListener(){yt=void 0,re.dispose()}};le||e(Ye);let Et=new Gt(Ye);return le?.add(Et),Et.event}Y.debounce=f;function m(N,w=0,P){return Y.debounce(N,(q,U)=>q?(q.push(U),q):[U],w,void 0,!0,void 0,P)}Y.accumulate=m;function h(N,w=(q,U)=>q===U,P){let q=!0,U;return a(N,Z=>{let le=q||!w(Z,U);return q=!1,U=Z,le},P)}Y.latch=h;function g(N,w,P){return[Y.filter(N,w,P),Y.filter(N,q=>!w(q),P)]}Y.split=g;function v(N,w=!1,P=[],q){let U=P.slice(),Z=N(X=>{U?U.push(X):re.fire(X)});q&&q.add(Z);let le=()=>{U?.forEach(X=>re.fire(X)),U=null},re=new Gt({onWillAddFirstListener(){Z||(Z=N(X=>re.fire(X)),q&&q.add(Z))},onDidAddFirstListener(){U&&(w?setTimeout(le):le())},onDidRemoveLastListener(){Z&&Z.dispose(),Z=null}});return q&&q.add(re),re.event}Y.buffer=v;function y(N,w){return(q,U,Z)=>{let le=w(new _);return N(function(re){let X=le.evaluate(re);X!==b&&q.call(U,X)},void 0,Z)}}Y.chain=y;let b=Symbol("HaltChainable");class _{constructor(){this.steps=[]}map(w){return this.steps.push(w),this}forEach(w){return this.steps.push(P=>(w(P),P)),this}filter(w){return this.steps.push(P=>w(P)?P:b),this}reduce(w,P){let q=P;return this.steps.push(U=>(q=w(q,U),q)),this}latch(w=(P,q)=>P===q){let P=!0,q;return this.steps.push(U=>{let Z=P||!w(U,q);return P=!1,q=U,Z?U:b}),this}evaluate(w){for(let P of this.steps)if(w=P(w),w===b)break;return w}}function S(N,w,P=q=>q){let q=(...re)=>le.fire(P(...re)),U=()=>N.on(w,q),Z=()=>N.removeListener(w,q),le=new Gt({onWillAddFirstListener:U,onDidRemoveLastListener:Z});return le.event}Y.fromNodeEventEmitter=S;function I(N,w,P=q=>q){let q=(...re)=>le.fire(P(...re)),U=()=>N.addEventListener(w,q),Z=()=>N.removeEventListener(w,q),le=new Gt({onWillAddFirstListener:U,onDidRemoveLastListener:Z});return le.event}Y.fromDOMEventEmitter=I;function T(N){return new Promise(w=>n(N)(w))}Y.toPromise=T;function A(N){let w=new Gt;return N.then(P=>{w.fire(P)},()=>{w.fire(void 0)}).finally(()=>{w.dispose()}),w.event}Y.fromPromise=A;function B(N,w,P){return w(P),N(q=>w(q))}Y.runAndSubscribe=B;class j{constructor(w,P){this._observable=w;this._counter=0;this._hasChanged=!1;let q={onWillAddFirstListener:()=>{w.addObserver(this)},onDidRemoveLastListener:()=>{w.removeObserver(this)}};P||e(q),this.emitter=new Gt(q),P&&P.add(this.emitter)}beginUpdate(w){this._counter++}handlePossibleChange(w){}handleChange(w,P){this._hasChanged=!0}endUpdate(w){this._counter--,this._counter===0&&(this._observable.reportChanges(),this._hasChanged&&(this._hasChanged=!1,this.emitter.fire(this._observable.get())))}}function F(N,w){return new j(N,w).emitter.event}Y.fromObservable=F;function ne(N){return(w,P,q)=>{let U=0,Z=!1,le={beginUpdate(){U++},endUpdate(){U--,U===0&&(N.reportChanges(),Z&&(Z=!1,w.call(P)))},handlePossibleChange(){},handleChange(){Z=!0}};N.addObserver(le),N.reportChanges();let re={dispose(){N.removeObserver(le)}};return q instanceof Tt?q.add(re):Array.isArray(q)&&q.push(re),re}}Y.fromObservableLight=ne})(al||={});var pU=class t{constructor(e){this.listenerCount=0;this.invocationCount=0;this.elapsedOverall=0;this.durations=[];this.name=`${e}_${t._idPool++}`,t.all.add(this)}static{this.all=new Set}static{this._idPool=0}start(e){this._stopWatch=new Ws,this.listenerCount=e}stop(){if(this._stopWatch){let e=this._stopWatch.elapsed();this.durations.push(e),this.elapsedOverall+=e,this.invocationCount+=1,this._stopWatch=void 0}}},vre=-1;var fU=class t{constructor(e,r,n=(t._idPool++).toString(16).padStart(3,"0")){this._errorHandler=e;this.threshold=r;this.name=n;this._warnCountdown=0}static{this._idPool=1}dispose(){this._stacks?.clear()}check(e,r){let n=this.threshold;if(n<=0||r<n)return;this._stacks||(this._stacks=new Map);let o=this._stacks.get(e.value)||0;if(this._stacks.set(e.value,o+1),this._warnCountdown-=1,this._warnCountdown<=0){this._warnCountdown=n*.5;let[s,a]=this.getMostFrequentStack(),c=`[${this.name}] potential listener LEAK detected, having ${r} listeners already. MOST frequent listener (${a}):`;console.warn(c),console.warn(s);let u=new mU(c,s);this._errorHandler(u)}return()=>{let s=this._stacks.get(e.value)||0;this._stacks.set(e.value,s-1)}}getMostFrequentStack(){if(!this._stacks)return;let e,r=0;for(let[n,o]of this._stacks)(!e||r<o)&&(e=[n,o],r=o);return e}},NT=class t{constructor(e){this.value=e}static create(){let e=new Error;return new t(e.stack??"")}print(){console.warn(this.value.split(`
`).slice(2).join(`
`))}},mU=class extends Error{constructor(e,r){super(e),this.name="ListenerLeakError",this.stack=r}},hU=class extends Error{constructor(e,r){super(e),this.name="ListenerRefusalError",this.stack=r}},XDe=0,A_=class{constructor(e){this.value=e;this.id=XDe++}},JDe=2,ZDe=(t,e)=>{if(t instanceof A_)e(t);else for(let r=0;r<t.length;r++){let n=t[r];n&&e(n)}},qA;if(YDe){let t=[];setInterval(()=>{t.length!==0&&(console.warn("[LEAKING LISTENERS] GC'ed these listeners that were NOT yet disposed:"),console.warn(t.join(`
`)),t.length=0)},3e3),qA=new FinalizationRegistry(e=>{typeof e=="string"&&t.push(e)})}var Gt=class{constructor(e){this._size=0;this._options=e,this._leakageMon=vre>0||this._options?.leakWarningThreshold?new fU(e?.onListenerError??Wm,this._options?.leakWarningThreshold??vre):void 0,this._perfMon=this._options?._profName?new pU(this._options._profName):void 0,this._deliveryQueue=this._options?.deliveryQueue}dispose(){if(!this._disposed){if(this._disposed=!0,this._deliveryQueue?.current===this&&this._deliveryQueue.reset(),this._listeners){if(gre){let e=this._listeners;queueMicrotask(()=>{ZDe(e,r=>r.stack?.print())})}this._listeners=void 0,this._size=0}this._options?.onDidRemoveLastListener?.(),this._leakageMon?.dispose()}}get event(){return this._event??=(e,r,n)=>{if(this._leakageMon&&this._size>this._leakageMon.threshold**2){let u=`[${this._leakageMon.name}] REFUSES to accept new listeners because it exceeded its threshold by far (${this._size} vs ${this._leakageMon.threshold})`;console.warn(u);let l=this._leakageMon.getMostFrequentStack()??["UNKNOWN stack",-1],d=new hU(`${u}. HINT: Stack shows most frequent listener (${l[1]}-times)`,l[0]);return(this._options?.onListenerError||Wm)(d),Ct.None}if(this._disposed)return Ct.None;r&&(e=e.bind(r));let o=new A_(e),s,a;this._leakageMon&&this._size>=Math.ceil(this._leakageMon.threshold*.2)&&(o.stack=NT.create(),s=this._leakageMon.check(o.stack,this._size+1)),gre&&(o.stack=a??NT.create()),this._listeners?this._listeners instanceof A_?(this._deliveryQueue??=new gU,this._listeners=[this._listeners,o]):this._listeners.push(o):(this._options?.onWillAddFirstListener?.(this),this._listeners=o,this._options?.onDidAddFirstListener?.(this)),this._size++;let c=sl(()=>{qA?.unregister(c),s?.(),this._removeListener(o)});if(n instanceof Tt?n.add(c):Array.isArray(n)&&n.push(c),qA){let u=new Error().stack.split(`
`).slice(2,3).join(`
`).trim(),l=/(file:|vscode-file:\/\/vscode-app)?(\/[^:]*:\d+:\d+)/.exec(u);qA.register(c,l?.[2]??u,c)}return c},this._event}_removeListener(e){if(this._options?.onWillRemoveListener?.(this),!this._listeners)return;if(this._size===1){this._listeners=void 0,this._options?.onDidRemoveLastListener?.(this),this._size=0;return}let r=this._listeners,n=r.indexOf(e);if(n===-1)throw console.log("disposed?",this._disposed),console.log("size?",this._size),console.log("arr?",JSON.stringify(this._listeners)),new Error("Attempted to dispose unknown listener");this._size--,r[n]=void 0;let o=this._deliveryQueue.current===this;if(this._size*JDe<=r.length){let s=0;for(let a=0;a<r.length;a++)r[a]?r[s++]=r[a]:o&&(this._deliveryQueue.end--,s<this._deliveryQueue.i&&this._deliveryQueue.i--);r.length=s}}_deliver(e,r){if(!e)return;let n=this._options?.onListenerError||Wm;if(!n){e.value(r);return}try{e.value(r)}catch(o){n(o)}}_deliverQueue(e){let r=e.current._listeners;for(;e.i<e.end;)this._deliver(r[e.i++],e.value);e.reset()}fire(e){if(this._deliveryQueue?.current&&(this._deliverQueue(this._deliveryQueue),this._perfMon?.stop()),this._perfMon?.start(this._size),this._listeners)if(this._listeners instanceof A_)this._deliver(this._listeners,e);else{let r=this._deliveryQueue;r.enqueue(this,e,this._listeners.length),this._deliverQueue(r)}this._perfMon?.stop()}hasListeners(){return this._size>0}};var gU=class{constructor(){this.i=-1;this.end=0}enqueue(e,r,n){this.i=0,this.end=n,this.current=e,this.value=r}reset(){this.i=this.end,this.current=void 0,this.value=void 0}};var yre=Object.freeze(function(t,e){let r=setTimeout(t.bind(e),0);return{dispose(){clearTimeout(r)}}}),an;(n=>{function t(o){return o===n.None||o===n.Cancelled||o instanceof D_?!0:!o||typeof o!="object"?!1:typeof o.isCancellationRequested=="boolean"&&typeof o.onCancellationRequested=="function"}n.isCancellationToken=t,n.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:al.None}),n.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:yre})})(an||={});var D_=class{constructor(){this._isCancelled=!1;this._emitter=null}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?yre:(this._emitter||(this._emitter=new Gt),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=null)}},ac=class{constructor(e){this._token=void 0;this._parentListener=void 0;this._parentListener=e&&e.onCancellationRequested(this.cancel,this)}get token(){return this._token||(this._token=new D_),this._token}cancel(){this._token?this._token instanceof D_&&this._token.cancel():this._token=an.Cancelled}dispose(e=!1){e&&this.cancel(),this._parentListener?.dispose(),this._token?this._token instanceof D_&&this._token.dispose():this._token=an.None}};var N_="en",GA=!1,zA=!1,LT=!1,eNe=!1,_re=!1,vU=!1,tNe=!1,rNe=!1,nNe=!1,iNe=!1,HA,jA=N_,bre=N_,oNe,$p,Wp=globalThis,cc;typeof Wp.vscode<"u"&&typeof Wp.vscode.process<"u"?cc=Wp.vscode.process:typeof process<"u"&&typeof process?.versions?.node=="string"&&(cc=process);var xre=typeof cc?.versions?.electron=="string",sNe=xre&&cc?.type==="renderer";if(typeof cc=="object"){GA=cc.platform==="win32",zA=cc.platform==="darwin",LT=cc.platform==="linux",eNe=LT&&!!cc.env.SNAP&&!!cc.env.SNAP_REVISION,tNe=xre,nNe=!!cc.env.CI||!!cc.env.BUILD_ARTIFACTSTAGINGDIRECTORY,HA=N_,jA=N_;let t=cc.env.VSCODE_NLS_CONFIG;if(t)try{let e=JSON.parse(t);HA=e.userLocale,bre=e.osLocale,jA=e.resolvedLanguage||N_,oNe=e.languagePack?.translationsConfigFile}catch{}_re=!0}else typeof navigator=="object"&&!sNe?($p=navigator.userAgent,GA=$p.indexOf("Windows")>=0,zA=$p.indexOf("Macintosh")>=0,rNe=($p.indexOf("Macintosh")>=0||$p.indexOf("iPad")>=0||$p.indexOf("iPhone")>=0)&&!!navigator.maxTouchPoints&&navigator.maxTouchPoints>0,LT=$p.indexOf("Linux")>=0,iNe=$p?.indexOf("Mobi")>=0,vU=!0,jA=globalThis._VSCODE_NLS_LANGUAGE||N_,HA=navigator.language.toLowerCase(),bre=HA):console.error("Unable to resolve platform.");var VA=0;zA?VA=1:GA?VA=3:LT&&(VA=2);var rd=GA,Sre=zA,Ire=LT;var Cre=_re;var Ere=vU,aNe=vU&&typeof Wp.importScripts=="function",Tre=aNe?Wp.origin:void 0;var wre=VA,td=$p,Ym=jA,cNe;(n=>{function t(){return Ym}n.value=t;function e(){return Ym.length===2?Ym==="en":Ym.length>=3?Ym[0]==="e"&&Ym[1]==="n"&&Ym[2]==="-":!1}n.isDefaultVariant=e;function r(){return Ym==="en"}n.isDefault=r})(cNe||={});var uNe=typeof Wp.postMessage=="function"&&!Wp.importScripts,Rre=(()=>{if(uNe){let t=[];Wp.addEventListener("message",r=>{if(r.data&&r.data.vscodeScheduleAsyncWork)for(let n=0,o=t.length;n<o;n++){let s=t[n];if(s.id===r.data.vscodeScheduleAsyncWork){t.splice(n,1),s.callback();return}}});let e=0;return r=>{let n=++e;t.push({id:n,callback:r}),Wp.postMessage({vscodeScheduleAsyncWork:n},"*")}}return t=>setTimeout(t)})();var lNe=!!(td&&td.indexOf("Chrome")>=0),Put=!!(td&&td.indexOf("Firefox")>=0),Aut=!!(!lNe&&td&&td.indexOf("Safari")>=0),Dut=!!(td&&td.indexOf("Edg/")>=0),Nut=!!(td&&td.indexOf("Android")>=0);var T0,yU=globalThis.vscode;if(typeof yU<"u"&&typeof yU.process<"u"){let t=yU.process;T0={get platform(){return t.platform},get arch(){return t.arch},get env(){return t.env},cwd(){return t.cwd()}}}else typeof process<"u"?T0={get platform(){return process.platform},get arch(){return process.arch},get env(){return process.env},cwd(){return process.env.VSCODE_CWD||process.cwd()}}:T0={get platform(){return rd?"win32":Sre?"darwin":"linux"},get arch(){},get env(){return{}},cwd(){return"/"}};var OT=T0.cwd,kre=T0.env,Pre=T0.platform,Mut=T0.arch;var fNe=65,mNe=97,hNe=90,gNe=122,Jm=46,No=47,Ia=92,Qm=58,vNe=63,$A=class extends Error{constructor(e,r,n){let o;typeof r=="string"&&r.indexOf("not ")===0?(o="must not be",r=r.replace(/^not /,"")):o="must be";let s=e.indexOf(".")!==-1?"property":"argument",a=`The "${e}" ${s} ${o} of type ${r}`;a+=`. Received type ${typeof n}`,super(a),this.code="ERR_INVALID_ARG_TYPE"}};function yNe(t,e){if(t===null||typeof t!="object")throw new $A(e,"Object",t)}function fi(t,e){if(typeof t!="string")throw new $A(e,"string",t)}var Ca=Pre==="win32";function Jt(t){return t===No||t===Ia}function bU(t){return t===No}function Xm(t){return t>=fNe&&t<=hNe||t>=mNe&&t<=gNe}function WA(t,e,r,n){let o="",s=0,a=-1,c=0,u=0;for(let l=0;l<=t.length;++l){if(l<t.length)u=t.charCodeAt(l);else{if(n(u))break;u=No}if(n(u)){if(!(a===l-1||c===1))if(c===2){if(o.length<2||s!==2||o.charCodeAt(o.length-1)!==Jm||o.charCodeAt(o.length-2)!==Jm){if(o.length>2){let d=o.lastIndexOf(r);d===-1?(o="",s=0):(o=o.slice(0,d),s=o.length-1-o.lastIndexOf(r)),a=l,c=0;continue}else if(o.length!==0){o="",s=0,a=l,c=0;continue}}e&&(o+=o.length>0?`${r}..`:"..",s=2)}else o.length>0?o+=`${r}${t.slice(a+1,l)}`:o=t.slice(a+1,l),s=l-a-1;a=l,c=0}else u===Jm&&c!==-1?++c:c=-1}return o}function Are(t,e){yNe(e,"pathObject");let r=e.dir||e.root,n=e.base||`${e.name||""}${e.ext||""}`;return r?r===e.root?`${r}${n}`:`${r}${t}${n}`:n}var mi={resolve(...t){let e="",r="",n=!1;for(let o=t.length-1;o>=-1;o--){let s;if(o>=0){if(s=t[o],fi(s,"path"),s.length===0)continue}else e.length===0?s=OT():(s=kre[`=${e}`]||OT(),(s===void 0||s.slice(0,2).toLowerCase()!==e.toLowerCase()&&s.charCodeAt(2)===Ia)&&(s=`${e}\\`));let a=s.length,c=0,u="",l=!1,d=s.charCodeAt(0);if(a===1)Jt(d)&&(c=1,l=!0);else if(Jt(d))if(l=!0,Jt(s.charCodeAt(1))){let p=2,f=p;for(;p<a&&!Jt(s.charCodeAt(p));)p++;if(p<a&&p!==f){let m=s.slice(f,p);for(f=p;p<a&&Jt(s.charCodeAt(p));)p++;if(p<a&&p!==f){for(f=p;p<a&&!Jt(s.charCodeAt(p));)p++;(p===a||p!==f)&&(u=`\\\\${m}\\${s.slice(f,p)}`,c=p)}}}else c=1;else Xm(d)&&s.charCodeAt(1)===Qm&&(u=s.slice(0,2),c=2,a>2&&Jt(s.charCodeAt(2))&&(l=!0,c=3));if(u.length>0)if(e.length>0){if(u.toLowerCase()!==e.toLowerCase())continue}else e=u;if(n){if(e.length>0)break}else if(r=`${s.slice(c)}\\${r}`,n=l,l&&e.length>0)break}return r=WA(r,!n,"\\",Jt),n?`${e}\\${r}`:`${e}${r}`||"."},normalize(t){fi(t,"path");let e=t.length;if(e===0)return".";let r=0,n,o=!1,s=t.charCodeAt(0);if(e===1)return bU(s)?"\\":t;if(Jt(s))if(o=!0,Jt(t.charCodeAt(1))){let c=2,u=c;for(;c<e&&!Jt(t.charCodeAt(c));)c++;if(c<e&&c!==u){let l=t.slice(u,c);for(u=c;c<e&&Jt(t.charCodeAt(c));)c++;if(c<e&&c!==u){for(u=c;c<e&&!Jt(t.charCodeAt(c));)c++;if(c===e)return`\\\\${l}\\${t.slice(u)}\\`;c!==u&&(n=`\\\\${l}\\${t.slice(u,c)}`,r=c)}}}else r=1;else Xm(s)&&t.charCodeAt(1)===Qm&&(n=t.slice(0,2),r=2,e>2&&Jt(t.charCodeAt(2))&&(o=!0,r=3));let a=r<e?WA(t.slice(r),!o,"\\",Jt):"";return a.length===0&&!o&&(a="."),a.length>0&&Jt(t.charCodeAt(e-1))&&(a+="\\"),n===void 0?o?`\\${a}`:a:o?`${n}\\${a}`:`${n}${a}`},isAbsolute(t){fi(t,"path");let e=t.length;if(e===0)return!1;let r=t.charCodeAt(0);return Jt(r)||e>2&&Xm(r)&&t.charCodeAt(1)===Qm&&Jt(t.charCodeAt(2))},join(...t){if(t.length===0)return".";let e,r;for(let s=0;s<t.length;++s){let a=t[s];fi(a,"path"),a.length>0&&(e===void 0?e=r=a:e+=`\\${a}`)}if(e===void 0)return".";let n=!0,o=0;if(typeof r=="string"&&Jt(r.charCodeAt(0))){++o;let s=r.length;s>1&&Jt(r.charCodeAt(1))&&(++o,s>2&&(Jt(r.charCodeAt(2))?++o:n=!1))}if(n){for(;o<e.length&&Jt(e.charCodeAt(o));)o++;o>=2&&(e=`\\${e.slice(o)}`)}return mi.normalize(e)},relative(t,e){if(fi(t,"from"),fi(e,"to"),t===e)return"";let r=mi.resolve(t),n=mi.resolve(e);if(r===n||(t=r.toLowerCase(),e=n.toLowerCase(),t===e))return"";let o=0;for(;o<t.length&&t.charCodeAt(o)===Ia;)o++;let s=t.length;for(;s-1>o&&t.charCodeAt(s-1)===Ia;)s--;let a=s-o,c=0;for(;c<e.length&&e.charCodeAt(c)===Ia;)c++;let u=e.length;for(;u-1>c&&e.charCodeAt(u-1)===Ia;)u--;let l=u-c,d=a<l?a:l,p=-1,f=0;for(;f<d;f++){let h=t.charCodeAt(o+f);if(h!==e.charCodeAt(c+f))break;h===Ia&&(p=f)}if(f!==d){if(p===-1)return n}else{if(l>d){if(e.charCodeAt(c+f)===Ia)return n.slice(c+f+1);if(f===2)return n.slice(c+f)}a>d&&(t.charCodeAt(o+f)===Ia?p=f:f===2&&(p=3)),p===-1&&(p=0)}let m="";for(f=o+p+1;f<=s;++f)(f===s||t.charCodeAt(f)===Ia)&&(m+=m.length===0?"..":"\\..");return c+=p,m.length>0?`${m}${n.slice(c,u)}`:(n.charCodeAt(c)===Ia&&++c,n.slice(c,u))},toNamespacedPath(t){if(typeof t!="string"||t.length===0)return t;let e=mi.resolve(t);if(e.length<=2)return t;if(e.charCodeAt(0)===Ia){if(e.charCodeAt(1)===Ia){let r=e.charCodeAt(2);if(r!==vNe&&r!==Jm)return`\\\\?\\UNC\\${e.slice(2)}`}}else if(Xm(e.charCodeAt(0))&&e.charCodeAt(1)===Qm&&e.charCodeAt(2)===Ia)return`\\\\?\\${e}`;return t},dirname(t){fi(t,"path");let e=t.length;if(e===0)return".";let r=-1,n=0,o=t.charCodeAt(0);if(e===1)return Jt(o)?t:".";if(Jt(o)){if(r=n=1,Jt(t.charCodeAt(1))){let c=2,u=c;for(;c<e&&!Jt(t.charCodeAt(c));)c++;if(c<e&&c!==u){for(u=c;c<e&&Jt(t.charCodeAt(c));)c++;if(c<e&&c!==u){for(u=c;c<e&&!Jt(t.charCodeAt(c));)c++;if(c===e)return t;c!==u&&(r=n=c+1)}}}}else Xm(o)&&t.charCodeAt(1)===Qm&&(r=e>2&&Jt(t.charCodeAt(2))?3:2,n=r);let s=-1,a=!0;for(let c=e-1;c>=n;--c)if(Jt(t.charCodeAt(c))){if(!a){s=c;break}}else a=!1;if(s===-1){if(r===-1)return".";s=r}return t.slice(0,s)},basename(t,e){e!==void 0&&fi(e,"ext"),fi(t,"path");let r=0,n=-1,o=!0,s;if(t.length>=2&&Xm(t.charCodeAt(0))&&t.charCodeAt(1)===Qm&&(r=2),e!==void 0&&e.length>0&&e.length<=t.length){if(e===t)return"";let a=e.length-1,c=-1;for(s=t.length-1;s>=r;--s){let u=t.charCodeAt(s);if(Jt(u)){if(!o){r=s+1;break}}else c===-1&&(o=!1,c=s+1),a>=0&&(u===e.charCodeAt(a)?--a===-1&&(n=s):(a=-1,n=c))}return r===n?n=c:n===-1&&(n=t.length),t.slice(r,n)}for(s=t.length-1;s>=r;--s)if(Jt(t.charCodeAt(s))){if(!o){r=s+1;break}}else n===-1&&(o=!1,n=s+1);return n===-1?"":t.slice(r,n)},extname(t){fi(t,"path");let e=0,r=-1,n=0,o=-1,s=!0,a=0;t.length>=2&&t.charCodeAt(1)===Qm&&Xm(t.charCodeAt(0))&&(e=n=2);for(let c=t.length-1;c>=e;--c){let u=t.charCodeAt(c);if(Jt(u)){if(!s){n=c+1;break}continue}o===-1&&(s=!1,o=c+1),u===Jm?r===-1?r=c:a!==1&&(a=1):r!==-1&&(a=-1)}return r===-1||o===-1||a===0||a===1&&r===o-1&&r===n+1?"":t.slice(r,o)},format:Are.bind(null,"\\"),parse(t){fi(t,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;let r=t.length,n=0,o=t.charCodeAt(0);if(r===1)return Jt(o)?(e.root=e.dir=t,e):(e.base=e.name=t,e);if(Jt(o)){if(n=1,Jt(t.charCodeAt(1))){let p=2,f=p;for(;p<r&&!Jt(t.charCodeAt(p));)p++;if(p<r&&p!==f){for(f=p;p<r&&Jt(t.charCodeAt(p));)p++;if(p<r&&p!==f){for(f=p;p<r&&!Jt(t.charCodeAt(p));)p++;p===r?n=p:p!==f&&(n=p+1)}}}}else if(Xm(o)&&t.charCodeAt(1)===Qm){if(r<=2)return e.root=e.dir=t,e;if(n=2,Jt(t.charCodeAt(2))){if(r===3)return e.root=e.dir=t,e;n=3}}n>0&&(e.root=t.slice(0,n));let s=-1,a=n,c=-1,u=!0,l=t.length-1,d=0;for(;l>=n;--l){if(o=t.charCodeAt(l),Jt(o)){if(!u){a=l+1;break}continue}c===-1&&(u=!1,c=l+1),o===Jm?s===-1?s=l:d!==1&&(d=1):s!==-1&&(d=-1)}return c!==-1&&(s===-1||d===0||d===1&&s===c-1&&s===a+1?e.base=e.name=t.slice(a,c):(e.name=t.slice(a,s),e.base=t.slice(a,c),e.ext=t.slice(s,c))),a>0&&a!==n?e.dir=t.slice(0,a-1):e.dir=e.root,e},sep:"\\",delimiter:";",win32:null,posix:null},bNe=(()=>{if(Ca){let t=/\\/g;return()=>{let e=OT().replace(t,"/");return e.slice(e.indexOf("/"))}}return()=>OT()})(),yr={resolve(...t){let e="",r=!1;for(let n=t.length-1;n>=-1&&!r;n--){let o=n>=0?t[n]:bNe();fi(o,"path"),o.length!==0&&(e=`${o}/${e}`,r=o.charCodeAt(0)===No)}return e=WA(e,!r,"/",bU),r?`/${e}`:e.length>0?e:"."},normalize(t){if(fi(t,"path"),t.length===0)return".";let e=t.charCodeAt(0)===No,r=t.charCodeAt(t.length-1)===No;return t=WA(t,!e,"/",bU),t.length===0?e?"/":r?"./":".":(r&&(t+="/"),e?`/${t}`:t)},isAbsolute(t){return fi(t,"path"),t.length>0&&t.charCodeAt(0)===No},join(...t){if(t.length===0)return".";let e;for(let r=0;r<t.length;++r){let n=t[r];fi(n,"path"),n.length>0&&(e===void 0?e=n:e+=`/${n}`)}return e===void 0?".":yr.normalize(e)},relative(t,e){if(fi(t,"from"),fi(e,"to"),t===e||(t=yr.resolve(t),e=yr.resolve(e),t===e))return"";let r=1,n=t.length,o=n-r,s=1,a=e.length-s,c=o<a?o:a,u=-1,l=0;for(;l<c;l++){let p=t.charCodeAt(r+l);if(p!==e.charCodeAt(s+l))break;p===No&&(u=l)}if(l===c)if(a>c){if(e.charCodeAt(s+l)===No)return e.slice(s+l+1);if(l===0)return e.slice(s+l)}else o>c&&(t.charCodeAt(r+l)===No?u=l:l===0&&(u=0));let d="";for(l=r+u+1;l<=n;++l)(l===n||t.charCodeAt(l)===No)&&(d+=d.length===0?"..":"/..");return`${d}${e.slice(s+u)}`},toNamespacedPath(t){return t},dirname(t){if(fi(t,"path"),t.length===0)return".";let e=t.charCodeAt(0)===No,r=-1,n=!0;for(let o=t.length-1;o>=1;--o)if(t.charCodeAt(o)===No){if(!n){r=o;break}}else n=!1;return r===-1?e?"/":".":e&&r===1?"//":t.slice(0,r)},basename(t,e){e!==void 0&&fi(e,"ext"),fi(t,"path");let r=0,n=-1,o=!0,s;if(e!==void 0&&e.length>0&&e.length<=t.length){if(e===t)return"";let a=e.length-1,c=-1;for(s=t.length-1;s>=0;--s){let u=t.charCodeAt(s);if(u===No){if(!o){r=s+1;break}}else c===-1&&(o=!1,c=s+1),a>=0&&(u===e.charCodeAt(a)?--a===-1&&(n=s):(a=-1,n=c))}return r===n?n=c:n===-1&&(n=t.length),t.slice(r,n)}for(s=t.length-1;s>=0;--s)if(t.charCodeAt(s)===No){if(!o){r=s+1;break}}else n===-1&&(o=!1,n=s+1);return n===-1?"":t.slice(r,n)},extname(t){fi(t,"path");let e=-1,r=0,n=-1,o=!0,s=0;for(let a=t.length-1;a>=0;--a){let c=t.charCodeAt(a);if(c===No){if(!o){r=a+1;break}continue}n===-1&&(o=!1,n=a+1),c===Jm?e===-1?e=a:s!==1&&(s=1):e!==-1&&(s=-1)}return e===-1||n===-1||s===0||s===1&&e===n-1&&e===r+1?"":t.slice(e,n)},format:Are.bind(null,"/"),parse(t){fi(t,"path");let e={root:"",dir:"",base:"",ext:"",name:""};if(t.length===0)return e;let r=t.charCodeAt(0)===No,n;r?(e.root="/",n=1):n=0;let o=-1,s=0,a=-1,c=!0,u=t.length-1,l=0;for(;u>=n;--u){let d=t.charCodeAt(u);if(d===No){if(!c){s=u+1;break}continue}a===-1&&(c=!1,a=u+1),d===Jm?o===-1?o=u:l!==1&&(l=1):o!==-1&&(l=-1)}if(a!==-1){let d=s===0&&r?1:s;o===-1||l===0||l===1&&o===a-1&&o===s+1?e.base=e.name=t.slice(d,a):(e.name=t.slice(d,o),e.base=t.slice(d,a),e.ext=t.slice(o,a))}return s>0?e.dir=t.slice(0,s-1):r&&(e.dir="/"),e},sep:"/",delimiter:":",win32:null,posix:null};yr.win32=mi.win32=mi;yr.posix=mi.posix=yr;var _U=Ca?mi.normalize:yr.normalize,_Ne=Ca?mi.isAbsolute:yr.isAbsolute,xNe=Ca?mi.join:yr.join,Dre=Ca?mi.resolve:yr.resolve,Nre=Ca?mi.relative:yr.relative,Lre=Ca?mi.dirname:yr.dirname,KA=Ca?mi.basename:yr.basename,Fut=Ca?mi.extname:yr.extname,Uut=Ca?mi.format:yr.format,But=Ca?mi.parse:yr.parse,qut=Ca?mi.toNamespacedPath:yr.toNamespacedPath,L_=Ca?mi.sep:yr.sep,Hut=Ca?mi.delimiter:yr.delimiter;function Ore(t){return t}var QA=class{constructor(e,r){this.lastCache=void 0;this.lastArgKey=void 0;typeof e=="function"?(this._fn=e,this._computeKey=Ore):(this._fn=r,this._computeKey=e.getCacheKey)}get(e){let r=this._computeKey(e);return this.lastArgKey!==r&&(this.lastArgKey=r,this.lastCache=this._fn(e)),this.lastCache}},w0=class{constructor(e,r){this._map=new Map;this._map2=new Map;typeof e=="function"?(this._fn=e,this._computeKey=Ore):(this._fn=r,this._computeKey=e.getCacheKey)}get cachedValues(){return this._map}get(e){let r=this._computeKey(e);if(this._map2.has(r))return this._map2.get(r);let n=this._fn(e);return this._map.set(e,n),this._map2.set(r,n),n}};var Wi=class{constructor(e){this.executor=e;this._didRun=!1}get hasValue(){return this._didRun}get value(){if(!this._didRun)try{this._value=this.executor()}catch(e){this._error=e}finally{this._didRun=!0}if(this._error)throw this._error;return this._value}get rawValue(){return this._value}};function k0(t){return t.replace(/[\\\{\}\*\+\?\|\^\$\.\[\]\(\)]/g,"\\$&")}function O_(t,e){let r=0,n=t.indexOf(e);for(;n!==-1;)r++,n=t.indexOf(e,n+e.length);return r}function XA(t){return t.split(/\r\n|\r|\n/)}function qre(t){for(let e=0,r=t.length;e<r;e++){let n=t.charCodeAt(e);if(n!==32&&n!==9)return e}return-1}function MT(t,e,r){let n=[],o=0;for(let s of t.matchAll(e)){if(n.push(t.slice(o,s.index)),s.index===void 0)throw new Error("match.index should be defined");o=s.index+s[0].length,n.push(r(s[0],...s.slice(1),s.index,t,s.groups))}return n.push(t.slice(o)),Promise.all(n).then(s=>s.join(""))}function Hre(t,e){return t<e?-1:t>e?1:0}function INe(t,e,r=0,n=t.length,o=0,s=e.length){for(;r<n&&o<s;r++,o++){let u=t.charCodeAt(r),l=e.charCodeAt(o);if(u<l)return-1;if(u>l)return 1}let a=n-r,c=s-o;return a<c?-1:a>c?1:0}function jre(t,e,r=0,n=t.length,o=0,s=e.length){for(;r<n&&o<s;r++,o++){let u=t.charCodeAt(r),l=e.charCodeAt(o);if(u===l)continue;if(u>=128||l>=128)return INe(t.toLowerCase(),e.toLowerCase(),r,n,o,s);Mre(u)&&(u-=32),Mre(l)&&(l-=32);let d=u-l;if(d!==0)return d}let a=n-r,c=s-o;return a<c?-1:a>c?1:0}function Mre(t){return t>=97&&t<=122}function JA(t,e){return t.length===e.length&&jre(t,e)===0}function xU(t,e){let r=e.length;return e.length>t.length?!1:jre(t,e,0,r)===0}function ZA(t,e){let r=Math.min(t.length,e.length),n;for(n=0;n<r;n++)if(t.charCodeAt(n)!==e.charCodeAt(n))return n;return r}function Vre(t,e){let r=Math.min(t.length,e.length),n,o=t.length-1,s=e.length-1;for(n=0;n<r;n++)if(t.charCodeAt(o-n)!==e.charCodeAt(s-n))return n;return r}var Xut=String.fromCharCode(65279);var Fre=class t{static{this._INSTANCE=null}static getInstance(){return t._INSTANCE||(t._INSTANCE=new t),t._INSTANCE}constructor(){this._data=CNe()}getGraphemeBreakType(e){if(e<32)return e===10?3:e===13?2:4;if(e<127)return 0;let r=this._data,n=r.length/3,o=1;for(;o<=n;)if(e<r[3*o])o=2*o;else if(e>r[3*o+1])o=2*o+1;else return r[3*o+2];return 0}};function CNe(){return JSON.parse("[0,0,0,51229,51255,12,44061,44087,12,127462,127487,6,7083,7085,5,47645,47671,12,54813,54839,12,128678,128678,14,3270,3270,5,9919,9923,14,45853,45879,12,49437,49463,12,53021,53047,12,71216,71218,7,128398,128399,14,129360,129374,14,2519,2519,5,4448,4519,9,9742,9742,14,12336,12336,14,44957,44983,12,46749,46775,12,48541,48567,12,50333,50359,12,52125,52151,12,53917,53943,12,69888,69890,5,73018,73018,5,127990,127990,14,128558,128559,14,128759,128760,14,129653,129655,14,2027,2035,5,2891,2892,7,3761,3761,5,6683,6683,5,8293,8293,4,9825,9826,14,9999,9999,14,43452,43453,5,44509,44535,12,45405,45431,12,46301,46327,12,47197,47223,12,48093,48119,12,48989,49015,12,49885,49911,12,50781,50807,12,51677,51703,12,52573,52599,12,53469,53495,12,54365,54391,12,65279,65279,4,70471,70472,7,72145,72147,7,119173,119179,5,127799,127818,14,128240,128244,14,128512,128512,14,128652,128652,14,128721,128722,14,129292,129292,14,129445,129450,14,129734,129743,14,1476,1477,5,2366,2368,7,2750,2752,7,3076,3076,5,3415,3415,5,4141,4144,5,6109,6109,5,6964,6964,5,7394,7400,5,9197,9198,14,9770,9770,14,9877,9877,14,9968,9969,14,10084,10084,14,43052,43052,5,43713,43713,5,44285,44311,12,44733,44759,12,45181,45207,12,45629,45655,12,46077,46103,12,46525,46551,12,46973,46999,12,47421,47447,12,47869,47895,12,48317,48343,12,48765,48791,12,49213,49239,12,49661,49687,12,50109,50135,12,50557,50583,12,51005,51031,12,51453,51479,12,51901,51927,12,52349,52375,12,52797,52823,12,53245,53271,12,53693,53719,12,54141,54167,12,54589,54615,12,55037,55063,12,69506,69509,5,70191,70193,5,70841,70841,7,71463,71467,5,72330,72342,5,94031,94031,5,123628,123631,5,127763,127765,14,127941,127941,14,128043,128062,14,128302,128317,14,128465,128467,14,128539,128539,14,128640,128640,14,128662,128662,14,128703,128703,14,128745,128745,14,129004,129007,14,129329,129330,14,129402,129402,14,129483,129483,14,129686,129704,14,130048,131069,14,173,173,4,1757,1757,1,2200,2207,5,2434,2435,7,2631,2632,5,2817,2817,5,3008,3008,5,3201,3201,5,3387,3388,5,3542,3542,5,3902,3903,7,4190,4192,5,6002,6003,5,6439,6440,5,6765,6770,7,7019,7027,5,7154,7155,7,8205,8205,13,8505,8505,14,9654,9654,14,9757,9757,14,9792,9792,14,9852,9853,14,9890,9894,14,9937,9937,14,9981,9981,14,10035,10036,14,11035,11036,14,42654,42655,5,43346,43347,7,43587,43587,5,44006,44007,7,44173,44199,12,44397,44423,12,44621,44647,12,44845,44871,12,45069,45095,12,45293,45319,12,45517,45543,12,45741,45767,12,45965,45991,12,46189,46215,12,46413,46439,12,46637,46663,12,46861,46887,12,47085,47111,12,47309,47335,12,47533,47559,12,47757,47783,12,47981,48007,12,48205,48231,12,48429,48455,12,48653,48679,12,48877,48903,12,49101,49127,12,49325,49351,12,49549,49575,12,49773,49799,12,49997,50023,12,50221,50247,12,50445,50471,12,50669,50695,12,50893,50919,12,51117,51143,12,51341,51367,12,51565,51591,12,51789,51815,12,52013,52039,12,52237,52263,12,52461,52487,12,52685,52711,12,52909,52935,12,53133,53159,12,53357,53383,12,53581,53607,12,53805,53831,12,54029,54055,12,54253,54279,12,54477,54503,12,54701,54727,12,54925,54951,12,55149,55175,12,68101,68102,5,69762,69762,7,70067,70069,7,70371,70378,5,70720,70721,7,71087,71087,5,71341,71341,5,71995,71996,5,72249,72249,7,72850,72871,5,73109,73109,5,118576,118598,5,121505,121519,5,127245,127247,14,127568,127569,14,127777,127777,14,127872,127891,14,127956,127967,14,128015,128016,14,128110,128172,14,128259,128259,14,128367,128368,14,128424,128424,14,128488,128488,14,128530,128532,14,128550,128551,14,128566,128566,14,128647,128647,14,128656,128656,14,128667,128673,14,128691,128693,14,128715,128715,14,128728,128732,14,128752,128752,14,128765,128767,14,129096,129103,14,129311,129311,14,129344,129349,14,129394,129394,14,129413,129425,14,129466,129471,14,129511,129535,14,129664,129666,14,129719,129722,14,129760,129767,14,917536,917631,5,13,13,2,1160,1161,5,1564,1564,4,1807,1807,1,2085,2087,5,2307,2307,7,2382,2383,7,2497,2500,5,2563,2563,7,2677,2677,5,2763,2764,7,2879,2879,5,2914,2915,5,3021,3021,5,3142,3144,5,3263,3263,5,3285,3286,5,3398,3400,7,3530,3530,5,3633,3633,5,3864,3865,5,3974,3975,5,4155,4156,7,4229,4230,5,5909,5909,7,6078,6085,7,6277,6278,5,6451,6456,7,6744,6750,5,6846,6846,5,6972,6972,5,7074,7077,5,7146,7148,7,7222,7223,5,7416,7417,5,8234,8238,4,8417,8417,5,9000,9000,14,9203,9203,14,9730,9731,14,9748,9749,14,9762,9763,14,9776,9783,14,9800,9811,14,9831,9831,14,9872,9873,14,9882,9882,14,9900,9903,14,9929,9933,14,9941,9960,14,9974,9974,14,9989,9989,14,10006,10006,14,10062,10062,14,10160,10160,14,11647,11647,5,12953,12953,14,43019,43019,5,43232,43249,5,43443,43443,5,43567,43568,7,43696,43696,5,43765,43765,7,44013,44013,5,44117,44143,12,44229,44255,12,44341,44367,12,44453,44479,12,44565,44591,12,44677,44703,12,44789,44815,12,44901,44927,12,45013,45039,12,45125,45151,12,45237,45263,12,45349,45375,12,45461,45487,12,45573,45599,12,45685,45711,12,45797,45823,12,45909,45935,12,46021,46047,12,46133,46159,12,46245,46271,12,46357,46383,12,46469,46495,12,46581,46607,12,46693,46719,12,46805,46831,12,46917,46943,12,47029,47055,12,47141,47167,12,47253,47279,12,47365,47391,12,47477,47503,12,47589,47615,12,47701,47727,12,47813,47839,12,47925,47951,12,48037,48063,12,48149,48175,12,48261,48287,12,48373,48399,12,48485,48511,12,48597,48623,12,48709,48735,12,48821,48847,12,48933,48959,12,49045,49071,12,49157,49183,12,49269,49295,12,49381,49407,12,49493,49519,12,49605,49631,12,49717,49743,12,49829,49855,12,49941,49967,12,50053,50079,12,50165,50191,12,50277,50303,12,50389,50415,12,50501,50527,12,50613,50639,12,50725,50751,12,50837,50863,12,50949,50975,12,51061,51087,12,51173,51199,12,51285,51311,12,51397,51423,12,51509,51535,12,51621,51647,12,51733,51759,12,51845,51871,12,51957,51983,12,52069,52095,12,52181,52207,12,52293,52319,12,52405,52431,12,52517,52543,12,52629,52655,12,52741,52767,12,52853,52879,12,52965,52991,12,53077,53103,12,53189,53215,12,53301,53327,12,53413,53439,12,53525,53551,12,53637,53663,12,53749,53775,12,53861,53887,12,53973,53999,12,54085,54111,12,54197,54223,12,54309,54335,12,54421,54447,12,54533,54559,12,54645,54671,12,54757,54783,12,54869,54895,12,54981,55007,12,55093,55119,12,55243,55291,10,66045,66045,5,68325,68326,5,69688,69702,5,69817,69818,5,69957,69958,7,70089,70092,5,70198,70199,5,70462,70462,5,70502,70508,5,70750,70750,5,70846,70846,7,71100,71101,5,71230,71230,7,71351,71351,5,71737,71738,5,72000,72000,7,72160,72160,5,72273,72278,5,72752,72758,5,72882,72883,5,73031,73031,5,73461,73462,7,94192,94193,7,119149,119149,7,121403,121452,5,122915,122916,5,126980,126980,14,127358,127359,14,127535,127535,14,127759,127759,14,127771,127771,14,127792,127793,14,127825,127867,14,127897,127899,14,127945,127945,14,127985,127986,14,128000,128007,14,128021,128021,14,128066,128100,14,128184,128235,14,128249,128252,14,128266,128276,14,128335,128335,14,128379,128390,14,128407,128419,14,128444,128444,14,128481,128481,14,128499,128499,14,128526,128526,14,128536,128536,14,128543,128543,14,128556,128556,14,128564,128564,14,128577,128580,14,128643,128645,14,128649,128649,14,128654,128654,14,128660,128660,14,128664,128664,14,128675,128675,14,128686,128689,14,128695,128696,14,128705,128709,14,128717,128719,14,128725,128725,14,128736,128741,14,128747,128748,14,128755,128755,14,128762,128762,14,128981,128991,14,129009,129023,14,129160,129167,14,129296,129304,14,129320,129327,14,129340,129342,14,129356,129356,14,129388,129392,14,129399,129400,14,129404,129407,14,129432,129442,14,129454,129455,14,129473,129474,14,129485,129487,14,129648,129651,14,129659,129660,14,129671,129679,14,129709,129711,14,129728,129730,14,129751,129753,14,129776,129782,14,917505,917505,4,917760,917999,5,10,10,3,127,159,4,768,879,5,1471,1471,5,1536,1541,1,1648,1648,5,1767,1768,5,1840,1866,5,2070,2073,5,2137,2139,5,2274,2274,1,2363,2363,7,2377,2380,7,2402,2403,5,2494,2494,5,2507,2508,7,2558,2558,5,2622,2624,7,2641,2641,5,2691,2691,7,2759,2760,5,2786,2787,5,2876,2876,5,2881,2884,5,2901,2902,5,3006,3006,5,3014,3016,7,3072,3072,5,3134,3136,5,3157,3158,5,3260,3260,5,3266,3266,5,3274,3275,7,3328,3329,5,3391,3392,7,3405,3405,5,3457,3457,5,3536,3537,7,3551,3551,5,3636,3642,5,3764,3772,5,3895,3895,5,3967,3967,7,3993,4028,5,4146,4151,5,4182,4183,7,4226,4226,5,4253,4253,5,4957,4959,5,5940,5940,7,6070,6070,7,6087,6088,7,6158,6158,4,6432,6434,5,6448,6449,7,6679,6680,5,6742,6742,5,6754,6754,5,6783,6783,5,6912,6915,5,6966,6970,5,6978,6978,5,7042,7042,7,7080,7081,5,7143,7143,7,7150,7150,7,7212,7219,5,7380,7392,5,7412,7412,5,8203,8203,4,8232,8232,4,8265,8265,14,8400,8412,5,8421,8432,5,8617,8618,14,9167,9167,14,9200,9200,14,9410,9410,14,9723,9726,14,9733,9733,14,9745,9745,14,9752,9752,14,9760,9760,14,9766,9766,14,9774,9774,14,9786,9786,14,9794,9794,14,9823,9823,14,9828,9828,14,9833,9850,14,9855,9855,14,9875,9875,14,9880,9880,14,9885,9887,14,9896,9897,14,9906,9916,14,9926,9927,14,9935,9935,14,9939,9939,14,9962,9962,14,9972,9972,14,9978,9978,14,9986,9986,14,9997,9997,14,10002,10002,14,10017,10017,14,10055,10055,14,10071,10071,14,10133,10135,14,10548,10549,14,11093,11093,14,12330,12333,5,12441,12442,5,42608,42610,5,43010,43010,5,43045,43046,5,43188,43203,7,43302,43309,5,43392,43394,5,43446,43449,5,43493,43493,5,43571,43572,7,43597,43597,7,43703,43704,5,43756,43757,5,44003,44004,7,44009,44010,7,44033,44059,12,44089,44115,12,44145,44171,12,44201,44227,12,44257,44283,12,44313,44339,12,44369,44395,12,44425,44451,12,44481,44507,12,44537,44563,12,44593,44619,12,44649,44675,12,44705,44731,12,44761,44787,12,44817,44843,12,44873,44899,12,44929,44955,12,44985,45011,12,45041,45067,12,45097,45123,12,45153,45179,12,45209,45235,12,45265,45291,12,45321,45347,12,45377,45403,12,45433,45459,12,45489,45515,12,45545,45571,12,45601,45627,12,45657,45683,12,45713,45739,12,45769,45795,12,45825,45851,12,45881,45907,12,45937,45963,12,45993,46019,12,46049,46075,12,46105,46131,12,46161,46187,12,46217,46243,12,46273,46299,12,46329,46355,12,46385,46411,12,46441,46467,12,46497,46523,12,46553,46579,12,46609,46635,12,46665,46691,12,46721,46747,12,46777,46803,12,46833,46859,12,46889,46915,12,46945,46971,12,47001,47027,12,47057,47083,12,47113,47139,12,47169,47195,12,47225,47251,12,47281,47307,12,47337,47363,12,47393,47419,12,47449,47475,12,47505,47531,12,47561,47587,12,47617,47643,12,47673,47699,12,47729,47755,12,47785,47811,12,47841,47867,12,47897,47923,12,47953,47979,12,48009,48035,12,48065,48091,12,48121,48147,12,48177,48203,12,48233,48259,12,48289,48315,12,48345,48371,12,48401,48427,12,48457,48483,12,48513,48539,12,48569,48595,12,48625,48651,12,48681,48707,12,48737,48763,12,48793,48819,12,48849,48875,12,48905,48931,12,48961,48987,12,49017,49043,12,49073,49099,12,49129,49155,12,49185,49211,12,49241,49267,12,49297,49323,12,49353,49379,12,49409,49435,12,49465,49491,12,49521,49547,12,49577,49603,12,49633,49659,12,49689,49715,12,49745,49771,12,49801,49827,12,49857,49883,12,49913,49939,12,49969,49995,12,50025,50051,12,50081,50107,12,50137,50163,12,50193,50219,12,50249,50275,12,50305,50331,12,50361,50387,12,50417,50443,12,50473,50499,12,50529,50555,12,50585,50611,12,50641,50667,12,50697,50723,12,50753,50779,12,50809,50835,12,50865,50891,12,50921,50947,12,50977,51003,12,51033,51059,12,51089,51115,12,51145,51171,12,51201,51227,12,51257,51283,12,51313,51339,12,51369,51395,12,51425,51451,12,51481,51507,12,51537,51563,12,51593,51619,12,51649,51675,12,51705,51731,12,51761,51787,12,51817,51843,12,51873,51899,12,51929,51955,12,51985,52011,12,52041,52067,12,52097,52123,12,52153,52179,12,52209,52235,12,52265,52291,12,52321,52347,12,52377,52403,12,52433,52459,12,52489,52515,12,52545,52571,12,52601,52627,12,52657,52683,12,52713,52739,12,52769,52795,12,52825,52851,12,52881,52907,12,52937,52963,12,52993,53019,12,53049,53075,12,53105,53131,12,53161,53187,12,53217,53243,12,53273,53299,12,53329,53355,12,53385,53411,12,53441,53467,12,53497,53523,12,53553,53579,12,53609,53635,12,53665,53691,12,53721,53747,12,53777,53803,12,53833,53859,12,53889,53915,12,53945,53971,12,54001,54027,12,54057,54083,12,54113,54139,12,54169,54195,12,54225,54251,12,54281,54307,12,54337,54363,12,54393,54419,12,54449,54475,12,54505,54531,12,54561,54587,12,54617,54643,12,54673,54699,12,54729,54755,12,54785,54811,12,54841,54867,12,54897,54923,12,54953,54979,12,55009,55035,12,55065,55091,12,55121,55147,12,55177,55203,12,65024,65039,5,65520,65528,4,66422,66426,5,68152,68154,5,69291,69292,5,69633,69633,5,69747,69748,5,69811,69814,5,69826,69826,5,69932,69932,7,70016,70017,5,70079,70080,7,70095,70095,5,70196,70196,5,70367,70367,5,70402,70403,7,70464,70464,5,70487,70487,5,70709,70711,7,70725,70725,7,70833,70834,7,70843,70844,7,70849,70849,7,71090,71093,5,71103,71104,5,71227,71228,7,71339,71339,5,71344,71349,5,71458,71461,5,71727,71735,5,71985,71989,7,71998,71998,5,72002,72002,7,72154,72155,5,72193,72202,5,72251,72254,5,72281,72283,5,72344,72345,5,72766,72766,7,72874,72880,5,72885,72886,5,73023,73029,5,73104,73105,5,73111,73111,5,92912,92916,5,94095,94098,5,113824,113827,4,119142,119142,7,119155,119162,4,119362,119364,5,121476,121476,5,122888,122904,5,123184,123190,5,125252,125258,5,127183,127183,14,127340,127343,14,127377,127386,14,127491,127503,14,127548,127551,14,127744,127756,14,127761,127761,14,127769,127769,14,127773,127774,14,127780,127788,14,127796,127797,14,127820,127823,14,127869,127869,14,127894,127895,14,127902,127903,14,127943,127943,14,127947,127950,14,127972,127972,14,127988,127988,14,127992,127994,14,128009,128011,14,128019,128019,14,128023,128041,14,128064,128064,14,128102,128107,14,128174,128181,14,128238,128238,14,128246,128247,14,128254,128254,14,128264,128264,14,128278,128299,14,128329,128330,14,128348,128359,14,128371,128377,14,128392,128393,14,128401,128404,14,128421,128421,14,128433,128434,14,128450,128452,14,128476,128478,14,128483,128483,14,128495,128495,14,128506,128506,14,128519,128520,14,128528,128528,14,128534,128534,14,128538,128538,14,128540,128542,14,128544,128549,14,128552,128555,14,128557,128557,14,128560,128563,14,128565,128565,14,128567,128576,14,128581,128591,14,128641,128642,14,128646,128646,14,128648,128648,14,128650,128651,14,128653,128653,14,128655,128655,14,128657,128659,14,128661,128661,14,128663,128663,14,128665,128666,14,128674,128674,14,128676,128677,14,128679,128685,14,128690,128690,14,128694,128694,14,128697,128702,14,128704,128704,14,128710,128714,14,128716,128716,14,128720,128720,14,128723,128724,14,128726,128727,14,128733,128735,14,128742,128744,14,128746,128746,14,128749,128751,14,128753,128754,14,128756,128758,14,128761,128761,14,128763,128764,14,128884,128895,14,128992,129003,14,129008,129008,14,129036,129039,14,129114,129119,14,129198,129279,14,129293,129295,14,129305,129310,14,129312,129319,14,129328,129328,14,129331,129338,14,129343,129343,14,129351,129355,14,129357,129359,14,129375,129387,14,129393,129393,14,129395,129398,14,129401,129401,14,129403,129403,14,129408,129412,14,129426,129431,14,129443,129444,14,129451,129453,14,129456,129465,14,129472,129472,14,129475,129482,14,129484,129484,14,129488,129510,14,129536,129647,14,129652,129652,14,129656,129658,14,129661,129663,14,129667,129670,14,129680,129685,14,129705,129708,14,129712,129718,14,129723,129727,14,129731,129733,14,129744,129750,14,129754,129759,14,129768,129775,14,129783,129791,14,917504,917504,4,917506,917535,4,917632,917759,4,918000,921599,4,0,9,4,11,12,4,14,31,4,169,169,14,174,174,14,1155,1159,5,1425,1469,5,1473,1474,5,1479,1479,5,1552,1562,5,1611,1631,5,1750,1756,5,1759,1764,5,1770,1773,5,1809,1809,5,1958,1968,5,2045,2045,5,2075,2083,5,2089,2093,5,2192,2193,1,2250,2273,5,2275,2306,5,2362,2362,5,2364,2364,5,2369,2376,5,2381,2381,5,2385,2391,5,2433,2433,5,2492,2492,5,2495,2496,7,2503,2504,7,2509,2509,5,2530,2531,5,2561,2562,5,2620,2620,5,2625,2626,5,2635,2637,5,2672,2673,5,2689,2690,5,2748,2748,5,2753,2757,5,2761,2761,7,2765,2765,5,2810,2815,5,2818,2819,7,2878,2878,5,2880,2880,7,2887,2888,7,2893,2893,5,2903,2903,5,2946,2946,5,3007,3007,7,3009,3010,7,3018,3020,7,3031,3031,5,3073,3075,7,3132,3132,5,3137,3140,7,3146,3149,5,3170,3171,5,3202,3203,7,3262,3262,7,3264,3265,7,3267,3268,7,3271,3272,7,3276,3277,5,3298,3299,5,3330,3331,7,3390,3390,5,3393,3396,5,3402,3404,7,3406,3406,1,3426,3427,5,3458,3459,7,3535,3535,5,3538,3540,5,3544,3550,7,3570,3571,7,3635,3635,7,3655,3662,5,3763,3763,7,3784,3789,5,3893,3893,5,3897,3897,5,3953,3966,5,3968,3972,5,3981,3991,5,4038,4038,5,4145,4145,7,4153,4154,5,4157,4158,5,4184,4185,5,4209,4212,5,4228,4228,7,4237,4237,5,4352,4447,8,4520,4607,10,5906,5908,5,5938,5939,5,5970,5971,5,6068,6069,5,6071,6077,5,6086,6086,5,6089,6099,5,6155,6157,5,6159,6159,5,6313,6313,5,6435,6438,7,6441,6443,7,6450,6450,5,6457,6459,5,6681,6682,7,6741,6741,7,6743,6743,7,6752,6752,5,6757,6764,5,6771,6780,5,6832,6845,5,6847,6862,5,6916,6916,7,6965,6965,5,6971,6971,7,6973,6977,7,6979,6980,7,7040,7041,5,7073,7073,7,7078,7079,7,7082,7082,7,7142,7142,5,7144,7145,5,7149,7149,5,7151,7153,5,7204,7211,7,7220,7221,7,7376,7378,5,7393,7393,7,7405,7405,5,7415,7415,7,7616,7679,5,8204,8204,5,8206,8207,4,8233,8233,4,8252,8252,14,8288,8292,4,8294,8303,4,8413,8416,5,8418,8420,5,8482,8482,14,8596,8601,14,8986,8987,14,9096,9096,14,9193,9196,14,9199,9199,14,9201,9202,14,9208,9210,14,9642,9643,14,9664,9664,14,9728,9729,14,9732,9732,14,9735,9741,14,9743,9744,14,9746,9746,14,9750,9751,14,9753,9756,14,9758,9759,14,9761,9761,14,9764,9765,14,9767,9769,14,9771,9773,14,9775,9775,14,9784,9785,14,9787,9791,14,9793,9793,14,9795,9799,14,9812,9822,14,9824,9824,14,9827,9827,14,9829,9830,14,9832,9832,14,9851,9851,14,9854,9854,14,9856,9861,14,9874,9874,14,9876,9876,14,9878,9879,14,9881,9881,14,9883,9884,14,9888,9889,14,9895,9895,14,9898,9899,14,9904,9905,14,9917,9918,14,9924,9925,14,9928,9928,14,9934,9934,14,9936,9936,14,9938,9938,14,9940,9940,14,9961,9961,14,9963,9967,14,9970,9971,14,9973,9973,14,9975,9977,14,9979,9980,14,9982,9985,14,9987,9988,14,9992,9996,14,9998,9998,14,10000,10001,14,10004,10004,14,10013,10013,14,10024,10024,14,10052,10052,14,10060,10060,14,10067,10069,14,10083,10083,14,10085,10087,14,10145,10145,14,10175,10175,14,11013,11015,14,11088,11088,14,11503,11505,5,11744,11775,5,12334,12335,5,12349,12349,14,12951,12951,14,42607,42607,5,42612,42621,5,42736,42737,5,43014,43014,5,43043,43044,7,43047,43047,7,43136,43137,7,43204,43205,5,43263,43263,5,43335,43345,5,43360,43388,8,43395,43395,7,43444,43445,7,43450,43451,7,43454,43456,7,43561,43566,5,43569,43570,5,43573,43574,5,43596,43596,5,43644,43644,5,43698,43700,5,43710,43711,5,43755,43755,7,43758,43759,7,43766,43766,5,44005,44005,5,44008,44008,5,44012,44012,7,44032,44032,11,44060,44060,11,44088,44088,11,44116,44116,11,44144,44144,11,44172,44172,11,44200,44200,11,44228,44228,11,44256,44256,11,44284,44284,11,44312,44312,11,44340,44340,11,44368,44368,11,44396,44396,11,44424,44424,11,44452,44452,11,44480,44480,11,44508,44508,11,44536,44536,11,44564,44564,11,44592,44592,11,44620,44620,11,44648,44648,11,44676,44676,11,44704,44704,11,44732,44732,11,44760,44760,11,44788,44788,11,44816,44816,11,44844,44844,11,44872,44872,11,44900,44900,11,44928,44928,11,44956,44956,11,44984,44984,11,45012,45012,11,45040,45040,11,45068,45068,11,45096,45096,11,45124,45124,11,45152,45152,11,45180,45180,11,45208,45208,11,45236,45236,11,45264,45264,11,45292,45292,11,45320,45320,11,45348,45348,11,45376,45376,11,45404,45404,11,45432,45432,11,45460,45460,11,45488,45488,11,45516,45516,11,45544,45544,11,45572,45572,11,45600,45600,11,45628,45628,11,45656,45656,11,45684,45684,11,45712,45712,11,45740,45740,11,45768,45768,11,45796,45796,11,45824,45824,11,45852,45852,11,45880,45880,11,45908,45908,11,45936,45936,11,45964,45964,11,45992,45992,11,46020,46020,11,46048,46048,11,46076,46076,11,46104,46104,11,46132,46132,11,46160,46160,11,46188,46188,11,46216,46216,11,46244,46244,11,46272,46272,11,46300,46300,11,46328,46328,11,46356,46356,11,46384,46384,11,46412,46412,11,46440,46440,11,46468,46468,11,46496,46496,11,46524,46524,11,46552,46552,11,46580,46580,11,46608,46608,11,46636,46636,11,46664,46664,11,46692,46692,11,46720,46720,11,46748,46748,11,46776,46776,11,46804,46804,11,46832,46832,11,46860,46860,11,46888,46888,11,46916,46916,11,46944,46944,11,46972,46972,11,47000,47000,11,47028,47028,11,47056,47056,11,47084,47084,11,47112,47112,11,47140,47140,11,47168,47168,11,47196,47196,11,47224,47224,11,47252,47252,11,47280,47280,11,47308,47308,11,47336,47336,11,47364,47364,11,47392,47392,11,47420,47420,11,47448,47448,11,47476,47476,11,47504,47504,11,47532,47532,11,47560,47560,11,47588,47588,11,47616,47616,11,47644,47644,11,47672,47672,11,47700,47700,11,47728,47728,11,47756,47756,11,47784,47784,11,47812,47812,11,47840,47840,11,47868,47868,11,47896,47896,11,47924,47924,11,47952,47952,11,47980,47980,11,48008,48008,11,48036,48036,11,48064,48064,11,48092,48092,11,48120,48120,11,48148,48148,11,48176,48176,11,48204,48204,11,48232,48232,11,48260,48260,11,48288,48288,11,48316,48316,11,48344,48344,11,48372,48372,11,48400,48400,11,48428,48428,11,48456,48456,11,48484,48484,11,48512,48512,11,48540,48540,11,48568,48568,11,48596,48596,11,48624,48624,11,48652,48652,11,48680,48680,11,48708,48708,11,48736,48736,11,48764,48764,11,48792,48792,11,48820,48820,11,48848,48848,11,48876,48876,11,48904,48904,11,48932,48932,11,48960,48960,11,48988,48988,11,49016,49016,11,49044,49044,11,49072,49072,11,49100,49100,11,49128,49128,11,49156,49156,11,49184,49184,11,49212,49212,11,49240,49240,11,49268,49268,11,49296,49296,11,49324,49324,11,49352,49352,11,49380,49380,11,49408,49408,11,49436,49436,11,49464,49464,11,49492,49492,11,49520,49520,11,49548,49548,11,49576,49576,11,49604,49604,11,49632,49632,11,49660,49660,11,49688,49688,11,49716,49716,11,49744,49744,11,49772,49772,11,49800,49800,11,49828,49828,11,49856,49856,11,49884,49884,11,49912,49912,11,49940,49940,11,49968,49968,11,49996,49996,11,50024,50024,11,50052,50052,11,50080,50080,11,50108,50108,11,50136,50136,11,50164,50164,11,50192,50192,11,50220,50220,11,50248,50248,11,50276,50276,11,50304,50304,11,50332,50332,11,50360,50360,11,50388,50388,11,50416,50416,11,50444,50444,11,50472,50472,11,50500,50500,11,50528,50528,11,50556,50556,11,50584,50584,11,50612,50612,11,50640,50640,11,50668,50668,11,50696,50696,11,50724,50724,11,50752,50752,11,50780,50780,11,50808,50808,11,50836,50836,11,50864,50864,11,50892,50892,11,50920,50920,11,50948,50948,11,50976,50976,11,51004,51004,11,51032,51032,11,51060,51060,11,51088,51088,11,51116,51116,11,51144,51144,11,51172,51172,11,51200,51200,11,51228,51228,11,51256,51256,11,51284,51284,11,51312,51312,11,51340,51340,11,51368,51368,11,51396,51396,11,51424,51424,11,51452,51452,11,51480,51480,11,51508,51508,11,51536,51536,11,51564,51564,11,51592,51592,11,51620,51620,11,51648,51648,11,51676,51676,11,51704,51704,11,51732,51732,11,51760,51760,11,51788,51788,11,51816,51816,11,51844,51844,11,51872,51872,11,51900,51900,11,51928,51928,11,51956,51956,11,51984,51984,11,52012,52012,11,52040,52040,11,52068,52068,11,52096,52096,11,52124,52124,11,52152,52152,11,52180,52180,11,52208,52208,11,52236,52236,11,52264,52264,11,52292,52292,11,52320,52320,11,52348,52348,11,52376,52376,11,52404,52404,11,52432,52432,11,52460,52460,11,52488,52488,11,52516,52516,11,52544,52544,11,52572,52572,11,52600,52600,11,52628,52628,11,52656,52656,11,52684,52684,11,52712,52712,11,52740,52740,11,52768,52768,11,52796,52796,11,52824,52824,11,52852,52852,11,52880,52880,11,52908,52908,11,52936,52936,11,52964,52964,11,52992,52992,11,53020,53020,11,53048,53048,11,53076,53076,11,53104,53104,11,53132,53132,11,53160,53160,11,53188,53188,11,53216,53216,11,53244,53244,11,53272,53272,11,53300,53300,11,53328,53328,11,53356,53356,11,53384,53384,11,53412,53412,11,53440,53440,11,53468,53468,11,53496,53496,11,53524,53524,11,53552,53552,11,53580,53580,11,53608,53608,11,53636,53636,11,53664,53664,11,53692,53692,11,53720,53720,11,53748,53748,11,53776,53776,11,53804,53804,11,53832,53832,11,53860,53860,11,53888,53888,11,53916,53916,11,53944,53944,11,53972,53972,11,54000,54000,11,54028,54028,11,54056,54056,11,54084,54084,11,54112,54112,11,54140,54140,11,54168,54168,11,54196,54196,11,54224,54224,11,54252,54252,11,54280,54280,11,54308,54308,11,54336,54336,11,54364,54364,11,54392,54392,11,54420,54420,11,54448,54448,11,54476,54476,11,54504,54504,11,54532,54532,11,54560,54560,11,54588,54588,11,54616,54616,11,54644,54644,11,54672,54672,11,54700,54700,11,54728,54728,11,54756,54756,11,54784,54784,11,54812,54812,11,54840,54840,11,54868,54868,11,54896,54896,11,54924,54924,11,54952,54952,11,54980,54980,11,55008,55008,11,55036,55036,11,55064,55064,11,55092,55092,11,55120,55120,11,55148,55148,11,55176,55176,11,55216,55238,9,64286,64286,5,65056,65071,5,65438,65439,5,65529,65531,4,66272,66272,5,68097,68099,5,68108,68111,5,68159,68159,5,68900,68903,5,69446,69456,5,69632,69632,7,69634,69634,7,69744,69744,5,69759,69761,5,69808,69810,7,69815,69816,7,69821,69821,1,69837,69837,1,69927,69931,5,69933,69940,5,70003,70003,5,70018,70018,7,70070,70078,5,70082,70083,1,70094,70094,7,70188,70190,7,70194,70195,7,70197,70197,7,70206,70206,5,70368,70370,7,70400,70401,5,70459,70460,5,70463,70463,7,70465,70468,7,70475,70477,7,70498,70499,7,70512,70516,5,70712,70719,5,70722,70724,5,70726,70726,5,70832,70832,5,70835,70840,5,70842,70842,5,70845,70845,5,70847,70848,5,70850,70851,5,71088,71089,7,71096,71099,7,71102,71102,7,71132,71133,5,71219,71226,5,71229,71229,5,71231,71232,5,71340,71340,7,71342,71343,7,71350,71350,7,71453,71455,5,71462,71462,7,71724,71726,7,71736,71736,7,71984,71984,5,71991,71992,7,71997,71997,7,71999,71999,1,72001,72001,1,72003,72003,5,72148,72151,5,72156,72159,7,72164,72164,7,72243,72248,5,72250,72250,1,72263,72263,5,72279,72280,7,72324,72329,1,72343,72343,7,72751,72751,7,72760,72765,5,72767,72767,5,72873,72873,7,72881,72881,7,72884,72884,7,73009,73014,5,73020,73021,5,73030,73030,1,73098,73102,7,73107,73108,7,73110,73110,7,73459,73460,5,78896,78904,4,92976,92982,5,94033,94087,7,94180,94180,5,113821,113822,5,118528,118573,5,119141,119141,5,119143,119145,5,119150,119154,5,119163,119170,5,119210,119213,5,121344,121398,5,121461,121461,5,121499,121503,5,122880,122886,5,122907,122913,5,122918,122922,5,123566,123566,5,125136,125142,5,126976,126979,14,126981,127182,14,127184,127231,14,127279,127279,14,127344,127345,14,127374,127374,14,127405,127461,14,127489,127490,14,127514,127514,14,127538,127546,14,127561,127567,14,127570,127743,14,127757,127758,14,127760,127760,14,127762,127762,14,127766,127768,14,127770,127770,14,127772,127772,14,127775,127776,14,127778,127779,14,127789,127791,14,127794,127795,14,127798,127798,14,127819,127819,14,127824,127824,14,127868,127868,14,127870,127871,14,127892,127893,14,127896,127896,14,127900,127901,14,127904,127940,14,127942,127942,14,127944,127944,14,127946,127946,14,127951,127955,14,127968,127971,14,127973,127984,14,127987,127987,14,127989,127989,14,127991,127991,14,127995,127999,5,128008,128008,14,128012,128014,14,128017,128018,14,128020,128020,14,128022,128022,14,128042,128042,14,128063,128063,14,128065,128065,14,128101,128101,14,128108,128109,14,128173,128173,14,128182,128183,14,128236,128237,14,128239,128239,14,128245,128245,14,128248,128248,14,128253,128253,14,128255,128258,14,128260,128263,14,128265,128265,14,128277,128277,14,128300,128301,14,128326,128328,14,128331,128334,14,128336,128347,14,128360,128366,14,128369,128370,14,128378,128378,14,128391,128391,14,128394,128397,14,128400,128400,14,128405,128406,14,128420,128420,14,128422,128423,14,128425,128432,14,128435,128443,14,128445,128449,14,128453,128464,14,128468,128475,14,128479,128480,14,128482,128482,14,128484,128487,14,128489,128494,14,128496,128498,14,128500,128505,14,128507,128511,14,128513,128518,14,128521,128525,14,128527,128527,14,128529,128529,14,128533,128533,14,128535,128535,14,128537,128537,14]")}var Ure=class t{constructor(e){this.confusableDictionary=e}static{this.ambiguousCharacterData=new Wi(()=>JSON.parse('{"_common":[8232,32,8233,32,5760,32,8192,32,8193,32,8194,32,8195,32,8196,32,8197,32,8198,32,8200,32,8201,32,8202,32,8287,32,8199,32,8239,32,2042,95,65101,95,65102,95,65103,95,8208,45,8209,45,8210,45,65112,45,1748,45,8259,45,727,45,8722,45,10134,45,11450,45,1549,44,1643,44,8218,44,184,44,42233,44,894,59,2307,58,2691,58,1417,58,1795,58,1796,58,5868,58,65072,58,6147,58,6153,58,8282,58,1475,58,760,58,42889,58,8758,58,720,58,42237,58,451,33,11601,33,660,63,577,63,2429,63,5038,63,42731,63,119149,46,8228,46,1793,46,1794,46,42510,46,68176,46,1632,46,1776,46,42232,46,1373,96,65287,96,8219,96,8242,96,1370,96,1523,96,8175,96,65344,96,900,96,8189,96,8125,96,8127,96,8190,96,697,96,884,96,712,96,714,96,715,96,756,96,699,96,701,96,700,96,702,96,42892,96,1497,96,2036,96,2037,96,5194,96,5836,96,94033,96,94034,96,65339,91,10088,40,10098,40,12308,40,64830,40,65341,93,10089,41,10099,41,12309,41,64831,41,10100,123,119060,123,10101,125,65342,94,8270,42,1645,42,8727,42,66335,42,5941,47,8257,47,8725,47,8260,47,9585,47,10187,47,10744,47,119354,47,12755,47,12339,47,11462,47,20031,47,12035,47,65340,92,65128,92,8726,92,10189,92,10741,92,10745,92,119311,92,119355,92,12756,92,20022,92,12034,92,42872,38,708,94,710,94,5869,43,10133,43,66203,43,8249,60,10094,60,706,60,119350,60,5176,60,5810,60,5120,61,11840,61,12448,61,42239,61,8250,62,10095,62,707,62,119351,62,5171,62,94015,62,8275,126,732,126,8128,126,8764,126,65372,124,65293,45,120784,50,120794,50,120804,50,120814,50,120824,50,130034,50,42842,50,423,50,1000,50,42564,50,5311,50,42735,50,119302,51,120785,51,120795,51,120805,51,120815,51,120825,51,130035,51,42923,51,540,51,439,51,42858,51,11468,51,1248,51,94011,51,71882,51,120786,52,120796,52,120806,52,120816,52,120826,52,130036,52,5070,52,71855,52,120787,53,120797,53,120807,53,120817,53,120827,53,130037,53,444,53,71867,53,120788,54,120798,54,120808,54,120818,54,120828,54,130038,54,11474,54,5102,54,71893,54,119314,55,120789,55,120799,55,120809,55,120819,55,120829,55,130039,55,66770,55,71878,55,2819,56,2538,56,2666,56,125131,56,120790,56,120800,56,120810,56,120820,56,120830,56,130040,56,547,56,546,56,66330,56,2663,57,2920,57,2541,57,3437,57,120791,57,120801,57,120811,57,120821,57,120831,57,130041,57,42862,57,11466,57,71884,57,71852,57,71894,57,9082,97,65345,97,119834,97,119886,97,119938,97,119990,97,120042,97,120094,97,120146,97,120198,97,120250,97,120302,97,120354,97,120406,97,120458,97,593,97,945,97,120514,97,120572,97,120630,97,120688,97,120746,97,65313,65,119808,65,119860,65,119912,65,119964,65,120016,65,120068,65,120120,65,120172,65,120224,65,120276,65,120328,65,120380,65,120432,65,913,65,120488,65,120546,65,120604,65,120662,65,120720,65,5034,65,5573,65,42222,65,94016,65,66208,65,119835,98,119887,98,119939,98,119991,98,120043,98,120095,98,120147,98,120199,98,120251,98,120303,98,120355,98,120407,98,120459,98,388,98,5071,98,5234,98,5551,98,65314,66,8492,66,119809,66,119861,66,119913,66,120017,66,120069,66,120121,66,120173,66,120225,66,120277,66,120329,66,120381,66,120433,66,42932,66,914,66,120489,66,120547,66,120605,66,120663,66,120721,66,5108,66,5623,66,42192,66,66178,66,66209,66,66305,66,65347,99,8573,99,119836,99,119888,99,119940,99,119992,99,120044,99,120096,99,120148,99,120200,99,120252,99,120304,99,120356,99,120408,99,120460,99,7428,99,1010,99,11429,99,43951,99,66621,99,128844,67,71922,67,71913,67,65315,67,8557,67,8450,67,8493,67,119810,67,119862,67,119914,67,119966,67,120018,67,120174,67,120226,67,120278,67,120330,67,120382,67,120434,67,1017,67,11428,67,5087,67,42202,67,66210,67,66306,67,66581,67,66844,67,8574,100,8518,100,119837,100,119889,100,119941,100,119993,100,120045,100,120097,100,120149,100,120201,100,120253,100,120305,100,120357,100,120409,100,120461,100,1281,100,5095,100,5231,100,42194,100,8558,68,8517,68,119811,68,119863,68,119915,68,119967,68,120019,68,120071,68,120123,68,120175,68,120227,68,120279,68,120331,68,120383,68,120435,68,5024,68,5598,68,5610,68,42195,68,8494,101,65349,101,8495,101,8519,101,119838,101,119890,101,119942,101,120046,101,120098,101,120150,101,120202,101,120254,101,120306,101,120358,101,120410,101,120462,101,43826,101,1213,101,8959,69,65317,69,8496,69,119812,69,119864,69,119916,69,120020,69,120072,69,120124,69,120176,69,120228,69,120280,69,120332,69,120384,69,120436,69,917,69,120492,69,120550,69,120608,69,120666,69,120724,69,11577,69,5036,69,42224,69,71846,69,71854,69,66182,69,119839,102,119891,102,119943,102,119995,102,120047,102,120099,102,120151,102,120203,102,120255,102,120307,102,120359,102,120411,102,120463,102,43829,102,42905,102,383,102,7837,102,1412,102,119315,70,8497,70,119813,70,119865,70,119917,70,120021,70,120073,70,120125,70,120177,70,120229,70,120281,70,120333,70,120385,70,120437,70,42904,70,988,70,120778,70,5556,70,42205,70,71874,70,71842,70,66183,70,66213,70,66853,70,65351,103,8458,103,119840,103,119892,103,119944,103,120048,103,120100,103,120152,103,120204,103,120256,103,120308,103,120360,103,120412,103,120464,103,609,103,7555,103,397,103,1409,103,119814,71,119866,71,119918,71,119970,71,120022,71,120074,71,120126,71,120178,71,120230,71,120282,71,120334,71,120386,71,120438,71,1292,71,5056,71,5107,71,42198,71,65352,104,8462,104,119841,104,119945,104,119997,104,120049,104,120101,104,120153,104,120205,104,120257,104,120309,104,120361,104,120413,104,120465,104,1211,104,1392,104,5058,104,65320,72,8459,72,8460,72,8461,72,119815,72,119867,72,119919,72,120023,72,120179,72,120231,72,120283,72,120335,72,120387,72,120439,72,919,72,120494,72,120552,72,120610,72,120668,72,120726,72,11406,72,5051,72,5500,72,42215,72,66255,72,731,105,9075,105,65353,105,8560,105,8505,105,8520,105,119842,105,119894,105,119946,105,119998,105,120050,105,120102,105,120154,105,120206,105,120258,105,120310,105,120362,105,120414,105,120466,105,120484,105,618,105,617,105,953,105,8126,105,890,105,120522,105,120580,105,120638,105,120696,105,120754,105,1110,105,42567,105,1231,105,43893,105,5029,105,71875,105,65354,106,8521,106,119843,106,119895,106,119947,106,119999,106,120051,106,120103,106,120155,106,120207,106,120259,106,120311,106,120363,106,120415,106,120467,106,1011,106,1112,106,65322,74,119817,74,119869,74,119921,74,119973,74,120025,74,120077,74,120129,74,120181,74,120233,74,120285,74,120337,74,120389,74,120441,74,42930,74,895,74,1032,74,5035,74,5261,74,42201,74,119844,107,119896,107,119948,107,120000,107,120052,107,120104,107,120156,107,120208,107,120260,107,120312,107,120364,107,120416,107,120468,107,8490,75,65323,75,119818,75,119870,75,119922,75,119974,75,120026,75,120078,75,120130,75,120182,75,120234,75,120286,75,120338,75,120390,75,120442,75,922,75,120497,75,120555,75,120613,75,120671,75,120729,75,11412,75,5094,75,5845,75,42199,75,66840,75,1472,108,8739,73,9213,73,65512,73,1633,108,1777,73,66336,108,125127,108,120783,73,120793,73,120803,73,120813,73,120823,73,130033,73,65321,73,8544,73,8464,73,8465,73,119816,73,119868,73,119920,73,120024,73,120128,73,120180,73,120232,73,120284,73,120336,73,120388,73,120440,73,65356,108,8572,73,8467,108,119845,108,119897,108,119949,108,120001,108,120053,108,120105,73,120157,73,120209,73,120261,73,120313,73,120365,73,120417,73,120469,73,448,73,120496,73,120554,73,120612,73,120670,73,120728,73,11410,73,1030,73,1216,73,1493,108,1503,108,1575,108,126464,108,126592,108,65166,108,65165,108,1994,108,11599,73,5825,73,42226,73,93992,73,66186,124,66313,124,119338,76,8556,76,8466,76,119819,76,119871,76,119923,76,120027,76,120079,76,120131,76,120183,76,120235,76,120287,76,120339,76,120391,76,120443,76,11472,76,5086,76,5290,76,42209,76,93974,76,71843,76,71858,76,66587,76,66854,76,65325,77,8559,77,8499,77,119820,77,119872,77,119924,77,120028,77,120080,77,120132,77,120184,77,120236,77,120288,77,120340,77,120392,77,120444,77,924,77,120499,77,120557,77,120615,77,120673,77,120731,77,1018,77,11416,77,5047,77,5616,77,5846,77,42207,77,66224,77,66321,77,119847,110,119899,110,119951,110,120003,110,120055,110,120107,110,120159,110,120211,110,120263,110,120315,110,120367,110,120419,110,120471,110,1400,110,1404,110,65326,78,8469,78,119821,78,119873,78,119925,78,119977,78,120029,78,120081,78,120185,78,120237,78,120289,78,120341,78,120393,78,120445,78,925,78,120500,78,120558,78,120616,78,120674,78,120732,78,11418,78,42208,78,66835,78,3074,111,3202,111,3330,111,3458,111,2406,111,2662,111,2790,111,3046,111,3174,111,3302,111,3430,111,3664,111,3792,111,4160,111,1637,111,1781,111,65359,111,8500,111,119848,111,119900,111,119952,111,120056,111,120108,111,120160,111,120212,111,120264,111,120316,111,120368,111,120420,111,120472,111,7439,111,7441,111,43837,111,959,111,120528,111,120586,111,120644,111,120702,111,120760,111,963,111,120532,111,120590,111,120648,111,120706,111,120764,111,11423,111,4351,111,1413,111,1505,111,1607,111,126500,111,126564,111,126596,111,65259,111,65260,111,65258,111,65257,111,1726,111,64428,111,64429,111,64427,111,64426,111,1729,111,64424,111,64425,111,64423,111,64422,111,1749,111,3360,111,4125,111,66794,111,71880,111,71895,111,66604,111,1984,79,2534,79,2918,79,12295,79,70864,79,71904,79,120782,79,120792,79,120802,79,120812,79,120822,79,130032,79,65327,79,119822,79,119874,79,119926,79,119978,79,120030,79,120082,79,120134,79,120186,79,120238,79,120290,79,120342,79,120394,79,120446,79,927,79,120502,79,120560,79,120618,79,120676,79,120734,79,11422,79,1365,79,11604,79,4816,79,2848,79,66754,79,42227,79,71861,79,66194,79,66219,79,66564,79,66838,79,9076,112,65360,112,119849,112,119901,112,119953,112,120005,112,120057,112,120109,112,120161,112,120213,112,120265,112,120317,112,120369,112,120421,112,120473,112,961,112,120530,112,120544,112,120588,112,120602,112,120646,112,120660,112,120704,112,120718,112,120762,112,120776,112,11427,112,65328,80,8473,80,119823,80,119875,80,119927,80,119979,80,120031,80,120083,80,120187,80,120239,80,120291,80,120343,80,120395,80,120447,80,929,80,120504,80,120562,80,120620,80,120678,80,120736,80,11426,80,5090,80,5229,80,42193,80,66197,80,119850,113,119902,113,119954,113,120006,113,120058,113,120110,113,120162,113,120214,113,120266,113,120318,113,120370,113,120422,113,120474,113,1307,113,1379,113,1382,113,8474,81,119824,81,119876,81,119928,81,119980,81,120032,81,120084,81,120188,81,120240,81,120292,81,120344,81,120396,81,120448,81,11605,81,119851,114,119903,114,119955,114,120007,114,120059,114,120111,114,120163,114,120215,114,120267,114,120319,114,120371,114,120423,114,120475,114,43847,114,43848,114,7462,114,11397,114,43905,114,119318,82,8475,82,8476,82,8477,82,119825,82,119877,82,119929,82,120033,82,120189,82,120241,82,120293,82,120345,82,120397,82,120449,82,422,82,5025,82,5074,82,66740,82,5511,82,42211,82,94005,82,65363,115,119852,115,119904,115,119956,115,120008,115,120060,115,120112,115,120164,115,120216,115,120268,115,120320,115,120372,115,120424,115,120476,115,42801,115,445,115,1109,115,43946,115,71873,115,66632,115,65331,83,119826,83,119878,83,119930,83,119982,83,120034,83,120086,83,120138,83,120190,83,120242,83,120294,83,120346,83,120398,83,120450,83,1029,83,1359,83,5077,83,5082,83,42210,83,94010,83,66198,83,66592,83,119853,116,119905,116,119957,116,120009,116,120061,116,120113,116,120165,116,120217,116,120269,116,120321,116,120373,116,120425,116,120477,116,8868,84,10201,84,128872,84,65332,84,119827,84,119879,84,119931,84,119983,84,120035,84,120087,84,120139,84,120191,84,120243,84,120295,84,120347,84,120399,84,120451,84,932,84,120507,84,120565,84,120623,84,120681,84,120739,84,11430,84,5026,84,42196,84,93962,84,71868,84,66199,84,66225,84,66325,84,119854,117,119906,117,119958,117,120010,117,120062,117,120114,117,120166,117,120218,117,120270,117,120322,117,120374,117,120426,117,120478,117,42911,117,7452,117,43854,117,43858,117,651,117,965,117,120534,117,120592,117,120650,117,120708,117,120766,117,1405,117,66806,117,71896,117,8746,85,8899,85,119828,85,119880,85,119932,85,119984,85,120036,85,120088,85,120140,85,120192,85,120244,85,120296,85,120348,85,120400,85,120452,85,1357,85,4608,85,66766,85,5196,85,42228,85,94018,85,71864,85,8744,118,8897,118,65366,118,8564,118,119855,118,119907,118,119959,118,120011,118,120063,118,120115,118,120167,118,120219,118,120271,118,120323,118,120375,118,120427,118,120479,118,7456,118,957,118,120526,118,120584,118,120642,118,120700,118,120758,118,1141,118,1496,118,71430,118,43945,118,71872,118,119309,86,1639,86,1783,86,8548,86,119829,86,119881,86,119933,86,119985,86,120037,86,120089,86,120141,86,120193,86,120245,86,120297,86,120349,86,120401,86,120453,86,1140,86,11576,86,5081,86,5167,86,42719,86,42214,86,93960,86,71840,86,66845,86,623,119,119856,119,119908,119,119960,119,120012,119,120064,119,120116,119,120168,119,120220,119,120272,119,120324,119,120376,119,120428,119,120480,119,7457,119,1121,119,1309,119,1377,119,71434,119,71438,119,71439,119,43907,119,71919,87,71910,87,119830,87,119882,87,119934,87,119986,87,120038,87,120090,87,120142,87,120194,87,120246,87,120298,87,120350,87,120402,87,120454,87,1308,87,5043,87,5076,87,42218,87,5742,120,10539,120,10540,120,10799,120,65368,120,8569,120,119857,120,119909,120,119961,120,120013,120,120065,120,120117,120,120169,120,120221,120,120273,120,120325,120,120377,120,120429,120,120481,120,5441,120,5501,120,5741,88,9587,88,66338,88,71916,88,65336,88,8553,88,119831,88,119883,88,119935,88,119987,88,120039,88,120091,88,120143,88,120195,88,120247,88,120299,88,120351,88,120403,88,120455,88,42931,88,935,88,120510,88,120568,88,120626,88,120684,88,120742,88,11436,88,11613,88,5815,88,42219,88,66192,88,66228,88,66327,88,66855,88,611,121,7564,121,65369,121,119858,121,119910,121,119962,121,120014,121,120066,121,120118,121,120170,121,120222,121,120274,121,120326,121,120378,121,120430,121,120482,121,655,121,7935,121,43866,121,947,121,8509,121,120516,121,120574,121,120632,121,120690,121,120748,121,1199,121,4327,121,71900,121,65337,89,119832,89,119884,89,119936,89,119988,89,120040,89,120092,89,120144,89,120196,89,120248,89,120300,89,120352,89,120404,89,120456,89,933,89,978,89,120508,89,120566,89,120624,89,120682,89,120740,89,11432,89,1198,89,5033,89,5053,89,42220,89,94019,89,71844,89,66226,89,119859,122,119911,122,119963,122,120015,122,120067,122,120119,122,120171,122,120223,122,120275,122,120327,122,120379,122,120431,122,120483,122,7458,122,43923,122,71876,122,66293,90,71909,90,65338,90,8484,90,8488,90,119833,90,119885,90,119937,90,119989,90,120041,90,120197,90,120249,90,120301,90,120353,90,120405,90,120457,90,918,90,120493,90,120551,90,120609,90,120667,90,120725,90,5059,90,42204,90,71849,90,65282,34,65284,36,65285,37,65286,38,65290,42,65291,43,65294,46,65295,47,65296,48,65297,49,65298,50,65299,51,65300,52,65301,53,65302,54,65303,55,65304,56,65305,57,65308,60,65309,61,65310,62,65312,64,65316,68,65318,70,65319,71,65324,76,65329,81,65330,82,65333,85,65334,86,65335,87,65343,95,65346,98,65348,100,65350,102,65355,107,65357,109,65358,110,65361,113,65362,114,65364,116,65365,117,65367,119,65370,122,65371,123,65373,125,119846,109],"_default":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"cs":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"de":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"es":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"fr":[65374,126,65306,58,65281,33,8216,96,8245,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"it":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ja":[8211,45,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65292,44,65307,59],"ko":[8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pl":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"pt-BR":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"qps-ploc":[160,32,8211,45,65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"ru":[65374,126,65306,58,65281,33,8216,96,8217,96,8245,96,180,96,12494,47,305,105,921,73,1009,112,215,120,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"tr":[160,32,8211,45,65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65288,40,65289,41,65292,44,65307,59,65311,63],"zh-hans":[65374,126,65306,58,65281,33,8245,96,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65288,40,65289,41],"zh-hant":[8211,45,65374,126,180,96,12494,47,1047,51,1073,54,1072,97,1040,65,1068,98,1042,66,1089,99,1057,67,1077,101,1045,69,1053,72,305,105,1050,75,921,73,1052,77,1086,111,1054,79,1009,112,1088,112,1056,80,1075,114,1058,84,215,120,1093,120,1061,88,1091,121,1059,89,65283,35,65307,59]}'))}static{this.cache=new QA({getCacheKey:JSON.stringify},e=>{function r(d){let p=new Map;for(let f=0;f<d.length;f+=2)p.set(d[f],d[f+1]);return p}function n(d,p){let f=new Map(d);for(let[m,h]of p)f.set(m,h);return f}function o(d,p){if(!d)return p;let f=new Map;for(let[m,h]of d)p.has(m)&&f.set(m,h);return f}let s=this.ambiguousCharacterData.value,a=e.filter(d=>!d.startsWith("_")&&d in s);a.length===0&&(a=["_default"]);let c;for(let d of a){let p=r(s[d]);c=o(c,p)}let u=r(s._common),l=n(u,c);return new t(l)})}static getInstance(e){return t.cache.get(Array.from(e))}static{this._locales=new Wi(()=>Object.keys(t.ambiguousCharacterData.value).filter(e=>!e.startsWith("_")))}static getLocales(){return t._locales.value}isAmbiguous(e){return this.confusableDictionary.has(e)}containsAmbiguousCharacter(e){for(let r=0;r<e.length;r++){let n=e.codePointAt(r);if(typeof n=="number"&&this.isAmbiguous(n))return!0}return!1}getPrimaryConfusable(e){return this.confusableDictionary.get(e)}getConfusableCodePoints(){return new Set(this.confusableDictionary.keys())}},Bre=class t{static getRawData(){return JSON.parse("[9,10,11,12,13,32,127,160,173,847,1564,4447,4448,6068,6069,6155,6156,6157,6158,7355,7356,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8203,8204,8205,8206,8207,8234,8235,8236,8237,8238,8239,8287,8288,8289,8290,8291,8292,8293,8294,8295,8296,8297,8298,8299,8300,8301,8302,8303,10240,12288,12644,65024,65025,65026,65027,65028,65029,65030,65031,65032,65033,65034,65035,65036,65037,65038,65039,65279,65440,65520,65521,65522,65523,65524,65525,65526,65527,65528,65532,78844,119155,119156,119157,119158,119159,119160,119161,119162,917504,917505,917506,917507,917508,917509,917510,917511,917512,917513,917514,917515,917516,917517,917518,917519,917520,917521,917522,917523,917524,917525,917526,917527,917528,917529,917530,917531,917532,917533,917534,917535,917536,917537,917538,917539,917540,917541,917542,917543,917544,917545,917546,917547,917548,917549,917550,917551,917552,917553,917554,917555,917556,917557,917558,917559,917560,917561,917562,917563,917564,917565,917566,917567,917568,917569,917570,917571,917572,917573,917574,917575,917576,917577,917578,917579,917580,917581,917582,917583,917584,917585,917586,917587,917588,917589,917590,917591,917592,917593,917594,917595,917596,917597,917598,917599,917600,917601,917602,917603,917604,917605,917606,917607,917608,917609,917610,917611,917612,917613,917614,917615,917616,917617,917618,917619,917620,917621,917622,917623,917624,917625,917626,917627,917628,917629,917630,917631,917760,917761,917762,917763,917764,917765,917766,917767,917768,917769,917770,917771,917772,917773,917774,917775,917776,917777,917778,917779,917780,917781,917782,917783,917784,917785,917786,917787,917788,917789,917790,917791,917792,917793,917794,917795,917796,917797,917798,917799,917800,917801,917802,917803,917804,917805,917806,917807,917808,917809,917810,917811,917812,917813,917814,917815,917816,917817,917818,917819,917820,917821,917822,917823,917824,917825,917826,917827,917828,917829,917830,917831,917832,917833,917834,917835,917836,917837,917838,917839,917840,917841,917842,917843,917844,917845,917846,917847,917848,917849,917850,917851,917852,917853,917854,917855,917856,917857,917858,917859,917860,917861,917862,917863,917864,917865,917866,917867,917868,917869,917870,917871,917872,917873,917874,917875,917876,917877,917878,917879,917880,917881,917882,917883,917884,917885,917886,917887,917888,917889,917890,917891,917892,917893,917894,917895,917896,917897,917898,917899,917900,917901,917902,917903,917904,917905,917906,917907,917908,917909,917910,917911,917912,917913,917914,917915,917916,917917,917918,917919,917920,917921,917922,917923,917924,917925,917926,917927,917928,917929,917930,917931,917932,917933,917934,917935,917936,917937,917938,917939,917940,917941,917942,917943,917944,917945,917946,917947,917948,917949,917950,917951,917952,917953,917954,917955,917956,917957,917958,917959,917960,917961,917962,917963,917964,917965,917966,917967,917968,917969,917970,917971,917972,917973,917974,917975,917976,917977,917978,917979,917980,917981,917982,917983,917984,917985,917986,917987,917988,917989,917990,917991,917992,917993,917994,917995,917996,917997,917998,917999]")}static{this._data=void 0}static getData(){return this._data||(this._data=new Set(t.getRawData())),this._data}static isInvisibleCharacter(e){return t.getData().has(e)}static containsInvisibleCharacter(e){for(let r=0;r<e.length;r++){let n=e.codePointAt(r);if(typeof n=="number"&&t.isInvisibleCharacter(n))return!0}return!1}static get codePoints(){return t.getData()}};function FT(t){return typeof t=="string"}function eD(t){return Array.isArray(t)&&t.every(e=>FT(e))}function tD(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)&&!(t instanceof RegExp)&&!(t instanceof Date)}function M_(t){return typeof t=="number"&&!isNaN(t)}function TNe(t){return typeof t>"u"}function F_(t){return!Gre(t)}function Gre(t){return TNe(t)||t===null}function UT(t,e){if(!t)throw new Error(e?`Unexpected type, expected '${e}'`:"Unexpected type")}function Zm(t){return t===47||t===92}function U_(t){return t.replace(/[\\/]/g,yr.sep)}function zre(t){return t.indexOf("/")===-1&&(t=U_(t)),/^[a-zA-Z]:(\/|$)/.test(t)&&(t="/"+t),t}function SU(t,e=yr.sep){if(!t)return"";let r=t.length,n=t.charCodeAt(0);if(Zm(n)){if(Zm(t.charCodeAt(1))&&!Zm(t.charCodeAt(2))){let s=3,a=s;for(;s<r&&!Zm(t.charCodeAt(s));s++);if(a!==s&&!Zm(t.charCodeAt(s+1))){for(s+=1;s<r;s++)if(Zm(t.charCodeAt(s)))return t.slice(0,s+1).replace(/[\\/]/g,e)}}return e}else if(RNe(n)&&t.charCodeAt(1)===58)return Zm(t.charCodeAt(2))?t.slice(0,2)+e:t.slice(0,2);let o=t.indexOf("://");if(o!==-1){for(o+=3;o<r;o++)if(Zm(t.charCodeAt(o)))return t.slice(0,o+1)}return""}function IU(t,e,r,n=L_){if(t===e)return!0;if(!t||!e||e.length>t.length)return!1;if(r){if(!xU(t,e))return!1;if(e.length===t.length)return!0;let s=e.length;return e.charAt(e.length-1)===n&&s--,t.charAt(s)===n}return e.charAt(e.length-1)!==n&&(e+=n),t.indexOf(e)===0}function RNe(t){return t>=65&&t<=90||t>=97&&t<=122}var PNe=/^\w[\w\d+.-]*$/,ANe=/^\//,DNe=/^\/\//;function NNe(t,e){if(!t.scheme&&e)throw new Error(`[UriError]: Scheme is missing: {scheme: "", authority: "${t.authority}", path: "${t.path}", query: "${t.query}", fragment: "${t.fragment}"}`);if(t.scheme&&!PNe.test(t.scheme))throw new Error("[UriError]: Scheme contains illegal characters.");if(t.path){if(t.authority){if(!ANe.test(t.path))throw new Error('[UriError]: If a URI contains an authority component, then the path component must either be empty or begin with a slash ("/") character')}else if(DNe.test(t.path))throw new Error('[UriError]: If a URI does not contain an authority component, then the path cannot begin with two slash characters ("//")')}}function LNe(t,e){return!t&&!e?"file":t}function ONe(t,e){switch(t){case"https":case"http":case"file":e?e[0]!==cl&&(e=cl+e):e=cl;break}return e}var vn="",cl="/",MNe=/^(([^:/?#]+?):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,dt=class t{static isUri(e){return e instanceof t?!0:e?typeof e.authority=="string"&&typeof e.fragment=="string"&&typeof e.path=="string"&&typeof e.query=="string"&&typeof e.scheme=="string"&&typeof e.fsPath=="string"&&typeof e.with=="function"&&typeof e.toString=="function":!1}constructor(e,r,n,o,s,a=!1){typeof e=="object"?(this.scheme=e.scheme||vn,this.authority=e.authority||vn,this.path=e.path||vn,this.query=e.query||vn,this.fragment=e.fragment||vn):(this.scheme=LNe(e,a),this.authority=r||vn,this.path=ONe(this.scheme,n||vn),this.query=o||vn,this.fragment=s||vn,NNe(this,a))}get fsPath(){return BT(this,!1)}with(e){if(!e)return this;let{scheme:r,authority:n,path:o,query:s,fragment:a}=e;return r===void 0?r=this.scheme:r===null&&(r=vn),n===void 0?n=this.authority:n===null&&(n=vn),o===void 0?o=this.path:o===null&&(o=vn),s===void 0?s=this.query:s===null&&(s=vn),a===void 0?a=this.fragment:a===null&&(a=vn),r===this.scheme&&n===this.authority&&o===this.path&&s===this.query&&a===this.fragment?this:new eh(r,n,o,s,a)}static parse(e,r=!1){let n=MNe.exec(e);return n?new eh(n[2]||vn,rD(n[4]||vn),rD(n[5]||vn),rD(n[7]||vn),rD(n[9]||vn),r):new eh(vn,vn,vn,vn,vn)}static file(e){let r=vn;if(rd&&(e=e.replace(/\\/g,cl)),e[0]===cl&&e[1]===cl){let n=e.indexOf(cl,2);n===-1?(r=e.substring(2),e=cl):(r=e.substring(2,n),e=e.substring(n)||cl)}return new eh("file",r,e,vn,vn)}static from(e,r){return new eh(e.scheme,e.authority,e.path,e.query,e.fragment,r)}static joinPath(e,...r){if(!e.path)throw new Error("[UriError]: cannot call joinPath on URI without path");let n;return rd&&e.scheme==="file"?n=t.file(mi.join(BT(e,!0),...r)).path:n=yr.join(e.path,...r),e.with({path:n})}toString(e=!1){return CU(this,e)}toJSON(){return this}static revive(e){if(e){if(e instanceof t)return e;{let r=new eh(e);return r._formatted=e.external??null,r._fsPath=e._sep===Kre?e.fsPath??null:null,r}}else return e}};function qT(t){return!t||typeof t!="object"?!1:typeof t.scheme=="string"&&(typeof t.authority=="string"||typeof t.authority>"u")&&(typeof t.path=="string"||typeof t.path>"u")&&(typeof t.query=="string"||typeof t.query>"u")&&(typeof t.fragment=="string"||typeof t.fragment>"u")}var Kre=rd?1:void 0,eh=class extends dt{constructor(){super(...arguments);this._formatted=null;this._fsPath=null}get fsPath(){return this._fsPath||(this._fsPath=BT(this,!1)),this._fsPath}toString(r=!1){return r?CU(this,!0):(this._formatted||(this._formatted=CU(this,!1)),this._formatted)}toJSON(){let r={$mid:1};return this._fsPath&&(r.fsPath=this._fsPath,r._sep=Kre),this._formatted&&(r.external=this._formatted),this.path&&(r.path=this.path),this.scheme&&(r.scheme=this.scheme),this.authority&&(r.authority=this.authority),this.query&&(r.query=this.query),this.fragment&&(r.fragment=this.fragment),r}},Yre={58:"%3A",47:"%2F",63:"%3F",35:"%23",91:"%5B",93:"%5D",64:"%40",33:"%21",36:"%24",38:"%26",39:"%27",40:"%28",41:"%29",42:"%2A",43:"%2B",44:"%2C",59:"%3B",61:"%3D",32:"%20"};function $re(t,e,r){let n,o=-1;for(let s=0;s<t.length;s++){let a=t.charCodeAt(s);if(a>=97&&a<=122||a>=65&&a<=90||a>=48&&a<=57||a===45||a===46||a===95||a===126||e&&a===47||r&&a===91||r&&a===93||r&&a===58)o!==-1&&(n+=encodeURIComponent(t.substring(o,s)),o=-1),n!==void 0&&(n+=t.charAt(s));else{n===void 0&&(n=t.substr(0,s));let c=Yre[a];c!==void 0?(o!==-1&&(n+=encodeURIComponent(t.substring(o,s)),o=-1),n+=c):o===-1&&(o=s)}}return o!==-1&&(n+=encodeURIComponent(t.substring(o))),n!==void 0?n:t}function FNe(t){let e;for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);n===35||n===63?(e===void 0&&(e=t.substr(0,r)),e+=Yre[n]):e!==void 0&&(e+=t[r])}return e!==void 0?e:t}function BT(t,e){let r;return t.authority&&t.path.length>1&&t.scheme==="file"?r=`//${t.authority}${t.path}`:t.path.charCodeAt(0)===47&&(t.path.charCodeAt(1)>=65&&t.path.charCodeAt(1)<=90||t.path.charCodeAt(1)>=97&&t.path.charCodeAt(1)<=122)&&t.path.charCodeAt(2)===58?e?r=t.path.substr(1):r=t.path[1].toLowerCase()+t.path.substr(2):r=t.path,rd&&(r=r.replace(/\//g,"\\")),r}function CU(t,e){let r=e?FNe:$re,n="",{scheme:o,authority:s,path:a,query:c,fragment:u}=t;if(o&&(n+=o,n+=":"),(s||o==="file")&&(n+=cl,n+=cl),s){let l=s.indexOf("@");if(l!==-1){let d=s.substr(0,l);s=s.substr(l+1),l=d.lastIndexOf(":"),l===-1?n+=r(d,!1,!1):(n+=r(d.substr(0,l),!1,!1),n+=":",n+=r(d.substr(l+1),!1,!0)),n+="@"}s=s.toLowerCase(),l=s.lastIndexOf(":"),l===-1?n+=r(s,!1,!0):(n+=r(s.substr(0,l),!1,!0),n+=s.substr(l))}if(a){if(a.length>=3&&a.charCodeAt(0)===47&&a.charCodeAt(2)===58){let l=a.charCodeAt(1);l>=65&&l<=90&&(a=`/${String.fromCharCode(l+32)}:${a.substr(3)}`)}else if(a.length>=2&&a.charCodeAt(1)===58){let l=a.charCodeAt(0);l>=65&&l<=90&&(a=`${String.fromCharCode(l+32)}:${a.substr(2)}`)}n+=r(a,!0,!1)}return c&&(n+="?",n+=r(c,!1,!1)),u&&(n+="#",n+=e?u:$re(u,!1,!1)),n}function Qre(t){try{return decodeURIComponent(t)}catch{return t.length>3?t.substr(0,3)+Qre(t.substr(3)):t}}var Wre=/(%[0-9A-Za-z][0-9A-Za-z])+/g;function rD(t){return t.match(Wre)?t.replace(Wre,e=>Qre(e)):t}var cn;(X=>(X.inMemory="inmemory",X.vscode="vscode",X.internal="private",X.walkThrough="walkThrough",X.walkThroughSnippet="walkThroughSnippet",X.http="http",X.https="https",X.file="file",X.mailto="mailto",X.untitled="untitled",X.data="data",X.command="command",X.vscodeRemote="vscode-remote",X.vscodeRemoteResource="vscode-remote-resource",X.vscodeManagedRemoteResource="vscode-managed-remote-resource",X.vscodeUserData="vscode-userdata",X.vscodeCustomEditor="vscode-custom-editor",X.vscodeNotebookCell="vscode-notebook-cell",X.vscodeNotebookCellMetadata="vscode-notebook-cell-metadata",X.vscodeNotebookCellOutput="vscode-notebook-cell-output",X.vscodeInteractiveInput="vscode-interactive-input",X.vscodeSettings="vscode-settings",X.vscodeWorkspaceTrust="vscode-workspace-trust",X.vscodeTerminal="vscode-terminal",X.vscodeChatCodeBlock="vscode-chat-code-block",X.vscodeCopilotBackingChatCodeBlock="vscode-copilot-chat-code-block",X.vscodeChatCodeCompareBlock="vscode-chat-code-compare-block",X.vscodeChatSesssion="vscode-chat-editor",X.webviewPanel="webview-panel",X.vscodeWebview="vscode-webview",X.extension="extension",X.vscodeFileResource="vscode-file",X.tmp="tmp",X.vsls="vsls",X.vscodeSourceControl="vscode-scm",X.commentsInput="comment",X.codeSetting="code-setting"))(cn||={});var UNe="tkn",EU=class{constructor(){this._hosts=Object.create(null);this._ports=Object.create(null);this._connectionTokens=Object.create(null);this._preferredWebSchema="http";this._delegate=null;this._serverRootPath="/"}setPreferredWebSchema(e){this._preferredWebSchema=e}setDelegate(e){this._delegate=e}setServerRootPath(e,r){this._serverRootPath=qNe(e,r)}getServerRootPath(){return this._serverRootPath}get _remoteResourcesPath(){return yr.join(this._serverRootPath,cn.vscodeRemoteResource)}set(e,r,n){this._hosts[e]=r,this._ports[e]=n}setConnectionToken(e,r){this._connectionTokens[e]=r}getPreferredWebSchema(){return this._preferredWebSchema}rewrite(e){if(this._delegate)try{return this._delegate(e)}catch(c){return Wm(c),e}let r=e.authority,n=this._hosts[r];n&&n.indexOf(":")!==-1&&n.indexOf("[")===-1&&(n=`[${n}]`);let o=this._ports[r],s=this._connectionTokens[r],a=`path=${encodeURIComponent(e.path)}`;return typeof s=="string"&&(a+=`&${UNe}=${encodeURIComponent(s)}`),dt.from({scheme:Ere?this._preferredWebSchema:cn.vscodeRemoteResource,authority:`${n}:${o}`,path:this._remoteResourcesPath,query:a})}},BNe=new EU;function qNe(t,e){return yr.join(e??"/",`${t.quality??"oss"}-${t.commit??"dev"}`)}var HNe="vscode-app",TU=class t{static{this.FALLBACK_AUTHORITY=HNe}asBrowserUri(e){let r=this.toUri(e,require);return this.uriToBrowserUri(r)}uriToBrowserUri(e){return e.scheme===cn.vscodeRemote?BNe.rewrite(e):e.scheme===cn.file&&(Cre||Tre===`${cn.vscodeFileResource}://${t.FALLBACK_AUTHORITY}`)?e.with({scheme:cn.vscodeFileResource,authority:e.authority||t.FALLBACK_AUTHORITY,query:null,fragment:null}):e}asFileUri(e){let r=this.toUri(e,require);return this.uriToFileUri(r)}uriToFileUri(e){return e.scheme===cn.vscodeFileResource?e.with({scheme:cn.file,authority:e.authority!==t.FALLBACK_AUTHORITY?e.authority:null,query:null,fragment:null}):e}toUri(e,r){return dt.isUri(e)?e:dt.parse(r.toUrl(e))}},plt=new TU,jNe;(s=>{let t=new Map([["1",{"Cross-Origin-Opener-Policy":"same-origin"}],["2",{"Cross-Origin-Embedder-Policy":"require-corp"}],["3",{"Cross-Origin-Opener-Policy":"same-origin","Cross-Origin-Embedder-Policy":"require-corp"}]]);s.CoopAndCoep=Object.freeze(t.get("3"));let r="vscode-coi";function n(a){let c;typeof a=="string"?c=new URL(a).searchParams:a instanceof URL?c=a.searchParams:dt.isUri(a)&&(c=new URL(a.toString(!0)).searchParams);let u=c?.get(r);if(u)return t.get(u)}s.getHeadersFromQuery=n;function o(a,c,u){if(!globalThis.crossOriginIsolated)return;let l=c&&u?"3":u?"2":"1";a instanceof URLSearchParams?a.set(r,l):a[r]=l}s.addSearchParam=o})(jNe||={});function Kp(t){return BT(t,!0)}var HT=class{constructor(e){this._ignorePathCasing=e}compare(e,r,n=!1){return e===r?0:Hre(this.getComparisonKey(e,n),this.getComparisonKey(r,n))}isEqual(e,r,n=!1){return e===r?!0:!e||!r?!1:this.getComparisonKey(e,n)===this.getComparisonKey(r,n)}getComparisonKey(e,r=!1){return e.with({path:this._ignorePathCasing(e)?e.path.toLowerCase():void 0,fragment:r?null:void 0}).toString()}ignorePathCasing(e){return this._ignorePathCasing(e)}isEqualOrParent(e,r,n=!1){if(e.scheme===r.scheme){if(e.scheme===cn.file)return IU(Kp(e),Kp(r),this._ignorePathCasing(e))&&e.query===r.query&&(n||e.fragment===r.fragment);if(Xre(e.authority,r.authority))return IU(e.path,r.path,this._ignorePathCasing(e),"/")&&e.query===r.query&&(n||e.fragment===r.fragment)}return!1}joinPath(e,...r){return dt.joinPath(e,...r)}basenameOrAuthority(e){return zc(e)||e.authority}basename(e){return yr.basename(e.path)}extname(e){return yr.extname(e.path)}dirname(e){if(e.path.length===0)return e;let r;return e.scheme===cn.file?r=dt.file(Lre(Kp(e))).path:(r=yr.dirname(e.path),e.authority&&r.length&&r.charCodeAt(0)!==47&&(console.error(`dirname("${e.toString})) resulted in a relative path`),r="/")),e.with({path:r})}normalizePath(e){if(!e.path.length)return e;let r;return e.scheme===cn.file?r=dt.file(_U(Kp(e))).path:r=yr.normalize(e.path),e.with({path:r})}relativePath(e,r){if(e.scheme!==r.scheme||!Xre(e.authority,r.authority))return;if(e.scheme===cn.file){let s=Nre(Kp(e),Kp(r));return rd?U_(s):s}let n=e.path||"/",o=r.path||"/";if(this._ignorePathCasing(e)){let s=0;for(let a=Math.min(n.length,o.length);s<a&&!(n.charCodeAt(s)!==o.charCodeAt(s)&&n.charAt(s).toLowerCase()!==o.charAt(s).toLowerCase());s++);n=o.substr(0,s)+n.substr(s)}return yr.relative(n,o)}resolvePath(e,r){if(e.scheme===cn.file){let n=dt.file(Dre(Kp(e),r));return e.with({authority:n.authority,path:n.path})}return r=zre(r),e.with({path:yr.resolve(e.path,r)})}isAbsolutePath(e){return!!e.path&&e.path[0]==="/"}isEqualAuthority(e,r){return e===r||e!==void 0&&r!==void 0&&JA(e,r)}hasTrailingPathSeparator(e,r=L_){if(e.scheme===cn.file){let n=Kp(e);return n.length>SU(n).length&&n[n.length-1]===r}else{let n=e.path;return n.length>1&&n.charCodeAt(n.length-1)===47&&!/^[a-zA-Z]:(\/$|\\$)/.test(e.fsPath)}}removeTrailingPathSeparator(e,r=L_){return Jre(e,r)?e.with({path:e.path.substr(0,e.path.length-1)}):e}addTrailingPathSeparator(e,r=L_){let n=!1;if(e.scheme===cn.file){let o=Kp(e);n=o!==void 0&&o.length===SU(o).length&&o[o.length-1]===r}else{r="/";let o=e.path;n=o.length===1&&o.charCodeAt(o.length-1)===47}return!n&&!Jre(e,r)?e.with({path:e.path+"/"}):e}},Ar=new HT(()=>!1),blt=new HT(t=>t.scheme===cn.file?!Ire:!0),_lt=new HT(t=>!0),jT=Ar.isEqual.bind(Ar),xlt=Ar.isEqualOrParent.bind(Ar),Slt=Ar.getComparisonKey.bind(Ar),Ilt=Ar.basenameOrAuthority.bind(Ar),zc=Ar.basename.bind(Ar),uc=Ar.extname.bind(Ar),Clt=Ar.dirname.bind(Ar),Zre=Ar.joinPath.bind(Ar),Elt=Ar.normalizePath.bind(Ar),Tlt=Ar.relativePath.bind(Ar),wlt=Ar.resolvePath.bind(Ar),Rlt=Ar.isAbsolutePath.bind(Ar),Xre=Ar.isEqualAuthority.bind(Ar),Jre=Ar.hasTrailingPathSeparator.bind(Ar),klt=Ar.removeTrailingPathSeparator.bind(Ar),Plt=Ar.addTrailingPathSeparator.bind(Ar);var VNe;(s=>{s.META_DATA_LABEL="label",s.META_DATA_DESCRIPTION="description",s.META_DATA_SIZE="size",s.META_DATA_MIME="mime";function o(a){let c=new Map;a.path.substring(a.path.indexOf(";")+1,a.path.lastIndexOf(";")).split(";").forEach(d=>{let[p,f]=d.split(":");p&&f&&c.set(p,f)});let l=a.path.substring(0,a.path.indexOf(";"));return l&&c.set(s.META_DATA_MIME,l),c}s.parseMetaData=o})(VNe||={});var tne=Symbol("MicrotaskDelay");function PU(t){let e=new ac,r=t(e.token),n=new Promise((o,s)=>{let a=e.token.onCancellationRequested(()=>{a.dispose(),s(new fo)});Promise.resolve(r).then(c=>{a.dispose(),e.dispose(),o(c)},c=>{a.dispose(),e.dispose(),s(c)})});return new class{cancel(){e.cancel(),e.dispose()}then(o,s){return n.then(o,s)}catch(o){return this.then(void 0,o)}finally(o){return n.finally(o)}}}function Qp(t,e,r){return new Promise((n,o)=>{let s=e.onCancellationRequested(()=>{s.dispose(),n(r)});t.then(n,o).finally(()=>s.dispose())})}function P0(t,e,r){let n,o=setTimeout(()=>{n?.(void 0),r?.()},e);return Promise.race([t.finally(()=>clearTimeout(o)),new Promise(s=>n=s)])}var wU=class{constructor(){this.isDisposed=!1;this.activePromise=null,this.queuedPromise=null,this.queuedPromiseFactory=null}queue(e){if(this.isDisposed)return Promise.reject(new Error("Throttler is disposed"));if(this.activePromise){if(this.queuedPromiseFactory=e,!this.queuedPromise){let r=()=>{if(this.queuedPromise=null,this.isDisposed)return;let n=this.queue(this.queuedPromiseFactory);return this.queuedPromiseFactory=null,n};this.queuedPromise=new Promise(n=>{this.activePromise.then(r,r).then(n)})}return new Promise((r,n)=>{this.queuedPromise.then(r,n)})}return this.activePromise=e(),new Promise((r,n)=>{this.activePromise.then(o=>{this.activePromise=null,r(o)},o=>{this.activePromise=null,n(o)})})}dispose(){this.isDisposed=!0}};var GNe=(t,e)=>{let r=!0,n=setTimeout(()=>{r=!1,e()},t);return{isTriggered:()=>r,dispose:()=>{clearTimeout(n),r=!1}}},zNe=t=>{let e=!0;return queueMicrotask(()=>{e&&(e=!1,t())}),{isTriggered:()=>e,dispose:()=>{e=!1}}},RU=class{constructor(e){this.defaultDelay=e;this.deferred=null,this.completionPromise=null,this.doResolve=null,this.doReject=null,this.task=null}trigger(e,r=this.defaultDelay){this.task=e,this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise((o,s)=>{this.doResolve=o,this.doReject=s}).then(()=>{if(this.completionPromise=null,this.doResolve=null,this.task){let o=this.task;return this.task=null,o()}}));let n=()=>{this.deferred=null,this.doResolve?.(null)};return this.deferred=r===tne?zNe(n):GNe(r,n),this.completionPromise}isTriggered(){return!!this.deferred?.isTriggered()}cancel(){this.cancelTimeout(),this.completionPromise&&(this.doReject?.(new fo),this.completionPromise=null)}cancelTimeout(){this.deferred?.dispose(),this.deferred=null}dispose(){this.cancel()}},iD=class{constructor(e){this.delayer=new RU(e),this.throttler=new wU}trigger(e,r){return this.delayer.trigger(()=>this.throttler.queue(e),r)}isTriggered(){return this.delayer.isTriggered()}cancel(){this.delayer.cancel()}dispose(){this.delayer.dispose(),this.throttler.dispose()}};function q_(t,e){return e?new Promise((r,n)=>{let o=setTimeout(()=>{s.dispose(),r()},t),s=e.onCancellationRequested(()=>{clearTimeout(o),s.dispose(),n(new fo)})}):PU(r=>q_(t,r))}var B_=class{constructor(e){this._size=0;this._isDisposed=!1;this.maxDegreeOfParalellism=e,this.outstandingPromises=[],this.runningPromises=0,this._onDrained=new Gt}whenIdle(){return this.size>0?al.toPromise(this.onDrained):Promise.resolve()}get onDrained(){return this._onDrained.event}get size(){return this._size}queue(e){if(this._isDisposed)throw new Error("Object has been disposed");return this._size++,new Promise((r,n)=>{this.outstandingPromises.push({factory:e,c:r,e:n}),this.consume()})}consume(){for(;this.outstandingPromises.length&&this.runningPromises<this.maxDegreeOfParalellism;){let e=this.outstandingPromises.shift();this.runningPromises++;let r=e.factory();r.then(e.c,e.e),r.then(()=>this.consumed(),()=>this.consumed())}}consumed(){this._isDisposed||(this.runningPromises--,--this._size===0&&this._onDrained.fire(),this.outstandingPromises.length>0&&this.consume())}clear(){if(this._isDisposed)throw new Error("Object has been disposed");this.outstandingPromises.length=0,this._size=this.runningPromises}dispose(){this._isDisposed=!0,this.outstandingPromises.length=0,this._size=0,this._onDrained.dispose()}};var oD=class{constructor(e,r){this._isDisposed=!1;this._token=-1,typeof e=="function"&&typeof r=="number"&&this.setIfNotSet(e,r)}dispose(){this.cancel(),this._isDisposed=!0}cancel(){this._token!==-1&&(clearTimeout(this._token),this._token=-1)}cancelAndSet(e,r){if(this._isDisposed)throw new sn("Calling 'cancelAndSet' on a disposed TimeoutTimer");this.cancel(),this._token=setTimeout(()=>{this._token=-1,e()},r)}setIfNotSet(e,r){if(this._isDisposed)throw new sn("Calling 'setIfNotSet' on a disposed TimeoutTimer");this._token===-1&&(this._token=setTimeout(()=>{this._token=-1,e()},r))}};var sD=class{constructor(e,r){this.timeoutToken=-1,this.runner=e,this.timeout=r,this.timeoutHandler=this.onTimeout.bind(this)}dispose(){this.cancel(),this.runner=null}cancel(){this.isScheduled()&&(clearTimeout(this.timeoutToken),this.timeoutToken=-1)}schedule(e=this.timeout){this.cancel(),this.timeoutToken=setTimeout(this.timeoutHandler,e)}get delay(){return this.timeout}set delay(e){this.timeout=e}isScheduled(){return this.timeoutToken!==-1}flush(){this.isScheduled()&&(this.cancel(),this.doRun())}onTimeout(){this.timeoutToken=-1,this.runner&&this.doRun()}doRun(){this.runner?.()}};var $Ne,nD;(function(){typeof globalThis.requestIdleCallback!="function"||typeof globalThis.cancelIdleCallback!="function"?nD=(t,e)=>{Rre(()=>{if(r)return;let n=Date.now()+15;e(Object.freeze({didTimeout:!0,timeRemaining(){return Math.max(0,n-Date.now())}}))});let r=!1;return{dispose(){r||(r=!0)}}}:nD=(t,e,r)=>{let n=t.requestIdleCallback(e,typeof r=="number"?{timeout:r}:void 0),o=!1;return{dispose(){o||(o=!0,t.cancelIdleCallback(n))}}},$Ne=t=>nD(globalThis,t)})();var kU=class{constructor(e,r){this._didRun=!1;this._executor=()=>{try{this._value=r()}catch(n){this._error=n}finally{this._didRun=!0}},this._handle=nD(e,()=>this._executor())}dispose(){this._handle.dispose()}get value(){if(this._didRun||(this._handle.dispose(),this._executor()),this._error)throw this._error;return this._value}get isInitialized(){return this._didRun}},aD=class extends kU{constructor(e){super(globalThis,e)}};var Yp=class{get isRejected(){return this.outcome?.outcome===1}get isResolved(){return this.outcome?.outcome===0}get isSettled(){return!!this.outcome}get value(){return this.outcome?.outcome===0?this.outcome?.value:void 0}constructor(){this.p=new Promise((e,r)=>{this.completeCallback=e,this.errorCallback=r})}complete(e){return new Promise(r=>{this.completeCallback(e),this.outcome={outcome:0,value:e},r()})}error(e){return new Promise(r=>{this.errorCallback(e),this.outcome={outcome:1,value:e},r()})}cancel(){return this.error(new fo)}},WNe;(r=>{async function t(n){let o,s=await Promise.all(n.map(a=>a.then(c=>c,c=>{o||(o=c)})));if(typeof o<"u")throw o;return s}r.settled=t;function e(n){return new Promise(async(o,s)=>{try{await n(o,s)}catch(a){s(a)}})}r.withAsyncBody=e})(WNe||={});var Zo=class t{static fromArray(e){return new t(r=>{r.emitMany(e)})}static fromPromise(e){return new t(async r=>{r.emitMany(await e)})}static fromPromises(e){return new t(async r=>{await Promise.all(e.map(async n=>r.emitOne(await n)))})}static merge(e){return new t(async r=>{await Promise.all(e.map(async n=>{for await(let o of n)r.emitOne(o)}))})}static{this.EMPTY=t.fromArray([])}constructor(e,r){this._state=0,this._results=[],this._error=null,this._onReturn=r,this._onStateChanged=new Gt,queueMicrotask(async()=>{let n={emitOne:o=>this.emitOne(o),emitMany:o=>this.emitMany(o),reject:o=>this.reject(o)};try{await Promise.resolve(e(n)),this.resolve()}catch(o){this.reject(o)}finally{n.emitOne=void 0,n.emitMany=void 0,n.reject=void 0}})}[Symbol.asyncIterator](){let e=0;return{next:async()=>{do{if(this._state===2)throw this._error;if(e<this._results.length)return{done:!1,value:this._results[e++]};if(this._state===1)return{done:!0,value:void 0};await al.toPromise(this._onStateChanged.event)}while(!0)},return:async()=>(this._onReturn?.(),{done:!0,value:void 0})}}static map(e,r){return new t(async n=>{for await(let o of e)n.emitOne(r(o))})}map(e){return t.map(this,e)}static filter(e,r){return new t(async n=>{for await(let o of e)r(o)&&n.emitOne(o)})}filter(e){return t.filter(this,e)}static coalesce(e){return t.filter(e,r=>!!r)}coalesce(){return t.coalesce(this)}static async toPromise(e){let r=[];for await(let n of e)r.push(n);return r}toPromise(){return t.toPromise(this)}emitOne(e){this._state===0&&(this._results.push(e),this._onStateChanged.fire())}emitMany(e){this._state===0&&(this._results=this._results.concat(e),this._onStateChanged.fire())}resolve(){this._state===0&&(this._state=1,this._onStateChanged.fire())}reject(e){this._state===0&&(this._state=2,this._error=e,this._onStateChanged.fire())}};var th=class{constructor(e){this._deferred=new Yp;this._asyncIterable=new Zo(o=>{if(r){o.reject(r);return}return n&&o.emitMany(n),this._errorFn=s=>o.reject(s),this._emitFn=s=>o.emitOne(s),this._deferred.p},e);let r,n;this._emitFn=o=>{n||(n=[]),n.push(o)},this._errorFn=o=>{r||(r=o)}}get asyncIterable(){return this._asyncIterable}resolve(){this._deferred.complete()}reject(e){this._errorFn(e),this._deferred.complete()}emitOne(e){this._emitFn(e)}};var Be=class{constructor(e,r=[],n=!1){this.ctor=e,this.staticArguments=r,this.supportsDelayedInstantiation=n}};var AU=class{constructor(e,r){this.key=e;this.data=r;this.incoming=new Map;this.outgoing=new Map}},VT=class{constructor(e){this._hashFn=e;this._nodes=new Map}roots(){let e=[];for(let r of this._nodes.values())r.outgoing.size===0&&e.push(r);return e}insertEdge(e,r){let n=this.lookupOrInsertNode(e),o=this.lookupOrInsertNode(r);n.outgoing.set(o.key,o),o.incoming.set(n.key,n)}removeNode(e){let r=this._hashFn(e);this._nodes.delete(r);for(let n of this._nodes.values())n.outgoing.delete(r),n.incoming.delete(r)}lookupOrInsertNode(e){let r=this._hashFn(e),n=this._nodes.get(r);return n||(n=new AU(r,e),this._nodes.set(r,n)),n}lookup(e){return this._nodes.get(this._hashFn(e))}isEmpty(){return this._nodes.size===0}toString(){let e=[];for(let[r,n]of this._nodes)e.push(`${r}
	(-> incoming)[${[...n.incoming.keys()].join(", ")}]
	(outgoing ->)[${[...n.outgoing.keys()].join(",")}]
`);return e.join(`
`)}findCycleSlow(){for(let[e,r]of this._nodes){let n=new Set([e]),o=this._findCycle(r,n);if(o)return o}}_findCycle(e,r){for(let[n,o]of e.outgoing){if(r.has(n))return[...r,n].join(" -> ");r.add(n);let s=this._findCycle(o,r);if(s)return s;r.delete(n)}}};var A0=class{constructor(...e){this._entries=new Map;for(let[r,n]of e)this.set(r,n)}set(e,r){let n=this._entries.get(e);return this._entries.set(e,r),n}has(e){return this._entries.has(e)}get(e){return this._entries.get(e)}};var KNe=!1,cD=class extends Error{constructor(e){super("cyclic dependency between services"),this.message=e.findCycleSlow()??`UNABLE to detect cycle, dumping graph: 
${e.toString()}`}},uD=class t{constructor(e=new A0,r=!1,n,o=KNe){this._services=e;this._strict=r;this._parent=n;this._enableTracing=o;this._isDisposed=!1;this._servicesToMaybeDispose=new Set;this._children=new Set;this._activeInstantiations=new Set;this._services.set(te,this),this._globalGraph=o?n?._globalGraph??new VT(s=>s):void 0}dispose(){if(!this._isDisposed){this._isDisposed=!0,Km(this._children),this._children.clear();for(let e of this._servicesToMaybeDispose)P_(e)&&e.dispose();this._servicesToMaybeDispose.clear()}}_throwIfDisposed(){if(this._isDisposed)throw new Error("InstantiationService has been disposed")}createChild(e,r){this._throwIfDisposed();let n=this,o=new class extends t{dispose(){n._children.delete(o),super.dispose()}}(e,this._strict,this,this._enableTracing);return this._children.add(o),r?.add(o),o}invokeFunction(e,...r){this._throwIfDisposed();let n=GT.traceInvocation(this._enableTracing,e),o=!1;try{return e({get:a=>{if(o)throw ore("service accessor is only valid during the invocation of its target method");let c=this._getOrCreateServiceInstance(a,n);if(!c)throw new Error(`[invokeFunction] unknown service '${a}'`);return c}},...r)}finally{o=!0,n.stop()}}createInstance(e,...r){this._throwIfDisposed();let n,o;return e instanceof Be?(n=GT.traceCreation(this._enableTracing,e.ctor),o=this._createInstance(e.ctor,e.staticArguments.concat(r),n)):(n=GT.traceCreation(this._enableTracing,e),o=this._createInstance(e,r,n)),n.stop(),o}_createInstance(e,r=[],n){let o=ol.getServiceDependencies(e).sort((c,u)=>c.index-u.index),s=[];for(let c of o){let u=this._getOrCreateServiceInstance(c.id,n);u||this._throwIfStrict(`[createInstance] ${e.name} depends on UNKNOWN service ${c.id}.`,!1),s.push(u)}let a=o.length>0?o[0].index:r.length;if(r.length!==a){console.trace(`[createInstance] First service dependency of ${e.name} at position ${a+1} conflicts with ${r.length} static arguments`);let c=a-r.length;c>0?r=r.concat(new Array(c)):r=r.slice(0,a)}return Reflect.construct(e,r.concat(s))}_setCreatedServiceInstance(e,r){if(this._services.get(e)instanceof Be)this._services.set(e,r);else if(this._parent)this._parent._setCreatedServiceInstance(e,r);else throw new Error("illegalState - setting UNKNOWN service instance")}_getServiceInstanceOrDescriptor(e){let r=this._services.get(e);return!r&&this._parent?this._parent._getServiceInstanceOrDescriptor(e):r}_getOrCreateServiceInstance(e,r){this._globalGraph&&this._globalGraphImplicitDependency&&this._globalGraph.insertEdge(this._globalGraphImplicitDependency,String(e));let n=this._getServiceInstanceOrDescriptor(e);return n instanceof Be?this._safeCreateAndCacheServiceInstance(e,n,r.branch(e,!0)):(r.branch(e,!1),n)}_safeCreateAndCacheServiceInstance(e,r,n){if(this._activeInstantiations.has(e))throw new Error(`illegal state - RECURSIVELY instantiating service '${e}'`);this._activeInstantiations.add(e);try{return this._createAndCacheServiceInstance(e,r,n)}finally{this._activeInstantiations.delete(e)}}_createAndCacheServiceInstance(e,r,n){let o=new VT(c=>c.id.toString()),s=0,a=[{id:e,desc:r,_trace:n}];for(;a.length;){let c=a.pop();if(o.lookupOrInsertNode(c),s++>1e3)throw new cD(o);for(let u of ol.getServiceDependencies(c.desc.ctor)){let l=this._getServiceInstanceOrDescriptor(u.id);if(l||this._throwIfStrict(`[createInstance] ${e} depends on ${u.id} which is NOT registered.`,!0),this._globalGraph?.insertEdge(String(c.id),String(u.id)),l instanceof Be){let d={id:u.id,desc:l,_trace:c._trace.branch(u.id,!0)};o.insertEdge(c,d),a.push(d)}}}for(;;){let c=o.roots();if(c.length===0){if(!o.isEmpty())throw new cD(o);break}for(let{data:u}of c){if(this._getServiceInstanceOrDescriptor(u.id)instanceof Be){let d=this._createServiceInstanceWithOwner(u.id,u.desc.ctor,u.desc.staticArguments,u.desc.supportsDelayedInstantiation,u._trace);this._setCreatedServiceInstance(u.id,d)}o.removeNode(u)}}return this._getServiceInstanceOrDescriptor(e)}_createServiceInstanceWithOwner(e,r,n=[],o,s){if(this._services.get(e)instanceof Be)return this._createServiceInstance(e,r,n,o,s,this._servicesToMaybeDispose);if(this._parent)return this._parent._createServiceInstanceWithOwner(e,r,n,o,s);throw new Error(`illegalState - creating UNKNOWN service instance ${r.name}`)}_createServiceInstance(e,r,n=[],o,s,a){if(o){let c=new t(void 0,this._strict,this,this._enableTracing);c._globalGraphImplicitDependency=String(e);let u=new Map,l=new aD(()=>{let d=c._createInstance(r,n,s);for(let[p,f]of u){let m=d[p];if(typeof m=="function")for(let h of f)h.disposable=m.apply(d,h.listener)}return u.clear(),a.add(d),d});return new Proxy(Object.create(null),{get(d,p){if(!l.isInitialized&&typeof p=="string"&&(p.startsWith("onDid")||p.startsWith("onWill"))){let h=u.get(p);return h||(h=new DT,u.set(p,h)),(v,y,b)=>{if(l.isInitialized)return l.value[p](v,y,b);{let _={listener:[v,y,b],disposable:void 0},S=h.push(_);return sl(()=>{S(),_.disposable?.dispose()})}}}if(p in d)return d[p];let f=l.value,m=f[p];return typeof m!="function"||(m=m.bind(f),d[p]=m),m},set(d,p,f){return l.value[p]=f,!0},getPrototypeOf(d){return r.prototype}})}else{let c=this._createInstance(r,n,s);return a.add(c),c}}_throwIfStrict(e,r){if(r&&console.warn(e),this._strict)throw new Error(e)}};var GT=class t{constructor(e,r){this.type=e;this.name=r;this._start=Date.now();this._dep=[]}static{this.all=new Set}static{this._None=new class extends t{constructor(){super(0,null)}stop(){}branch(){return this}}}static traceInvocation(e,r){return e?new t(2,r.name||new Error().stack.split(`
`).slice(3,4).join(`
`)):t._None}static traceCreation(e,r){return e?new t(1,r.name):t._None}static{this._totals=0}branch(e,r){let n=new t(3,e.toString());return this._dep.push([e,r,n]),n}stop(){let e=Date.now()-this._start;t._totals+=e;let r=!1;function n(s,a){let c=[],u=new Array(s+1).join("	");for(let[l,d,p]of a._dep)if(d&&p){r=!0,c.push(`${u}CREATES -> ${l}`);let f=n(s+1,p);f&&c.push(f)}else c.push(`${u}uses -> ${l}`);return c.join(`
`)}let o=[`${this.type===1?"CREATE":"CALL"} ${this.name}`,`${n(1,this)}`,`DONE, took ${e.toFixed(2)}ms (grand total ${t._totals.toFixed(2)}ms)`];(e>2||r)&&t.all.add(o.join(`
`))}};var je=ae("IServicesAccessor"),lD=class{constructor(e,r){this._isSealed=!1;let n=Array.isArray(e)?new A0(...e):e??new A0;n.set(je,this);let o=r?r._pair.insta.createChild(n):new uD(n,!0);this._pair={services:n,insta:o}}dispose(){this._pair.insta.dispose()}get(e){return this._pair.insta.invokeFunction(r=>r.get(e))}safeGet(e){try{return this.get(e)}catch{return}}define(e,r){if(this._isSealed)throw new Error("This accessor is sealed and cannot be modified anymore.");this._pair.services.set(e,r)}defineIfNotDefined(e,r){this.safeGet(e)===void 0&&this.define(e,r())}seal(){this._isSealed=!0}toString(){return""}};var Ea=require("../package.json"),dD=Ea.buildType!=="dev",Ta=Ea.isPreRelease||!dD,vdt=Ea.engines.vscode;var zT=class{constructor(e,r){this.name=e;this.version=r}format(){return`${this.name}/${this.version}`}},Rt=ae("IEnvService");var pD=`

**Note:** Some files were excluded from the context due to content exclusion rules. Click [here](https://docs.github.com/en/copilot/managing-github-copilot-in-your-organization/configuring-content-exclusions-for-github-copilot) to learn more.`,De=ae("IIgnoreService"),rne=class t{static{this.Instance=new t}dispose(){}get isEnabled(){return!1}get isRegexExclusionsEnabled(){return!1}async init(){}async isCopilotIgnored(e){return!1}async asMinimatchPattern(){}async sessionInfo(){return""}};async function DU(t,e){let r=[];for(let n of e)await t.isCopilotIgnored(n)||r.push(n);return r}var ft=(n=>(n[n.InlineChat=1]="InlineChat",n[n.PanelChat=2]="PanelChat",n[n.Other=3]="Other",n))(ft||{});(e=>{function t(r){switch(r){case 1:return"conversationInline";case 2:return"conversationPanel";default:return"none"}}e.toString=t})(ft||={});function $T(t,e){if(t===e)return!0;if(t==null||e===null||e===void 0||typeof t!=typeof e||typeof t!="object"||Array.isArray(t)!==Array.isArray(e))return!1;let r,n;if(Array.isArray(t)){if(t.length!==e.length)return!1;for(r=0;r<t.length;r++)if(!$T(t[r],e[r]))return!1}else{let o=[];for(n in t)o.push(n);o.sort();let s=[];for(n in e)s.push(n);if(s.sort(),!$T(o,s))return!1;for(r=0;r<o.length;r++)if(!$T(t[o[r]],e[o[r]]))return!1}return!0}var nd="github.copilot",ye=ae("IConfigurationService"),mD=class{getConfigMixedWithDefaults(e){let r=this.getConfig(e);return r===void 0?e.defaultValue:tD(r)&&tD(e.defaultValue)?{...e.defaultValue,...r}:r}};var fD;function QNe(){if(!fD){fD=new Map;let t=Ea.contributes.configuration.properties;for(let e of Object.keys(t))typeof t[e].default<"u"&&fD.set(e,t[e].default)}return fD}function nne(t,e){let r=QNe().get(`${nd}.${t}`);if(typeof r<"u"&&!$T(e,r))throw new Error(`The default value for setting ${t} is different in package.json and in code`);let n=t.indexOf("."),o=t.substring(0,n);if(o!=="editor"&&o!=="chat"&&o!=="advanced"&&o!=="notebook"&&o!=="renameSuggestions")throw new Error(`Unexpected setting section ${o} in setting ${t}`);let s=t.substring(n+1);return{id:t,firstPart:o,secondPart:s,defaultValue:e}}function Mt(t,e){return{...nne(t,e),configType:0}}function lc(t,e){return{...nne(t,e),configType:1}}var fe={EnableCodeActions:Mt("editor.enableCodeActions",!0),LocaleOverride:Mt("chat.localeOverride","auto"),WelcomeMessage:Mt("chat.welcomeMessage","first"),TerminalChatLocation:Mt("chat.terminalChatLocation","chatView"),AuthProvider:Mt("advanced.authProvider","github"),NotebookIterativeImproving:Mt("notebook.iterativeImproving",!1),AutomaticRenameSuggestions:Mt("renameSuggestions.triggerAutomatically",!0),CustomUserInstructions:Mt("chat.customUserInstructions",[]),DebugOverrideCAPIUrl:Mt("advanced.debug.overrideCAPIUrl","https://api.githubcopilot.com"),DebugOverrideChatEngine:Mt("advanced.debug.overrideChatEngine",void 0),DebugOverrideEmbeddingsModel:Mt("advanced.debug.overrideEmbeddingsModel",void 0),DebugOverrideChatMaxTokenNum:Mt("advanced.debug.overrideChatMaxTokenNum",0),DebugOverrideChatOffTopicModel:Mt("advanced.debug.overrideChatOffTopicModel",""),DebugOverrideChatOffTopicModelTokenizer:Mt("advanced.debug.overrideChatOffTopicModelTokenizer",""),DebugOverrideChatOffTopicModelThreshold:Mt("advanced.debug.overrideChatOffTopicModelThreshold",0),DebugOverrideLogLevels:Mt("advanced.debug.overrideLogLevels",{}),DebugFilterLogCategories:Mt("advanced.debug.filterLogCategories",[]),DebugReportFeedback:Mt("advanced.debug.reportFeedback",!1),DebugUseNodeFetcher:Mt("advanced.debug.useNodeFetcher",!1),DebugUseElectronFetcher:Mt("advanced.debug.useElectronFetcher",!1),ConversationSlashCommandEnablements:Mt("advanced.slashCommands",{"*":!1}),ConversationVariablesEnablements:Mt("advanced.variables",{"*":Ta}),ConversationAdditionalPromptContext:Mt("advanced.conversationAdditionalPromptContext","firstTurn"),ConversationLoggingEnabled:Mt("advanced.conversationLoggingEnabled",!1),NotebookLoggingEnabled:Mt("chat.notebookLogEnabled",!1),ConversationIntentDetection:Mt("advanced.conversationIntentDetection",!1),IntentDetectionWithFunctionCalling:lc("advanced.intentDetectionWithFunctionCalling",!1),RemoteAgentImplicitContextEnabled:Mt("advanced.remoteAgentImplicitContextEnabled",Ta),ConversationPromptEval:lc("advanced.promptEval",!1),ConversationPromptEvalRequestContext:lc("advanced.promptEval.requestContext",0),KerberosServicePrincipal:Mt("advanced.kerberosServicePrincipal",void 0),ExplainIntentRefer:Mt("advanced.explain.refer",!0),FixInlineChatEndpoint:lc("advanced.fix.inlineChatEndpoint",void 0),FixUseWorkspaceChunksFromSelection:lc("advanced.fix.useWorkspaceChunksFromSelection",!1),FixUseWorkspaceChunksFromDiagnostics:lc("advanced.fix.useWorkspaceChunksFromDiagnostics",!1),usePythonCookbookLineTooLong:lc("advanced.fix.usePythonCookbookLineTooLong",!1),CodeMapperChatEndpoint:lc("advanced.codeMapper.chatEndpoint",void 0),GPT4TurboExperimentEnabled:Mt("advanced.gpt4TurboExperimentEnabled",!1),ProjectLabelsExpanded:lc("advanced.projectLabels.expanded",!1),ProjectLabelsChat:lc("advanced.projectLabels.chat",!1),ProjectLabelsInline:lc("advanced.projectLabels.inline",!1),WorkspaceNewFlowEnabled:Mt("advanced.workspace.useNewFlow",!0),WorkspaceCodeSearchEnabled:Mt("advanced.workspace.codeSearchEnabled",void 0),WorkspaceRerankStrategy:Mt("advanced.workspace.rerankStrategy",void 0),WorkspaceCodeSearchReturnRawChunks:Mt("advanced.workspace.codeSearchReturnRawChunks",void 0),WorkspaceUseFilesVariable:Mt("advanced.workspace.useFilesVariable",!1),WorkspacePreInitEmbeddings:lc("advanced.workspace.preInitEmbeddings",!1),UseProjectTemplates:Mt("chat.useProjectTemplates",!0),ExplainScopeSelection:Mt("chat.scopeSelection",!1),UseMessageNames:Mt("advanced.useMessageNames",!0),FeedbackOnChange:Mt("advanced.feedback.onChange",!1),ReviewContextMenu:Mt("advanced.review.contextMenu",Ta),ReviewSCMViewlet:Mt("advanced.review.scmViewlet",Ta),ReviewIntent:Mt("advanced.review.intent",!1),NotebookPrioritiesExperimentEnabled:Mt("advanced.notebook.prioritiesExperimentEnabled",!1),NotebookPackagesExperimentEnabled:Mt("advanced.notebook.packagesExperimentEnabled",!1),NotebookAdditionalCodeGenerationRuleEnabled:Mt("advanced.notebook.additionalCodeGenerationRule",!1),NotebookSummaryExperimentEnabled:Mt("advanced.notebook.summaryExperimentEnabled",!1),RunCommandEnabled:Mt("chat.runCommand.enabled",!0),ShowCodeMatches:lc("advanced.showCodeMatches",!1)};var rh=ae("INotebookLogService");var ue=ae("ILogService"),Xp=class{constructor(e,r,n){this.logTargets=e;this.configurationService=r;this.notebookLogService=n;this.loggers=new Map;this.promptResponseLoggers=new Map;this.myLogTarget={logIt:(o,s,...a)=>{this.logTargets.forEach(c=>c.logIt(o,s,...a))}}}get defaultLogger(){return this.getLogger("extension")}getLogger(e){return Xp._getLogger(e,this.loggers,r=>new vD(r,this.myLogTarget,this.configurationService))}getPromptResponseLogger(e){return Xp._getLogger(e,this.promptResponseLoggers,r=>new NU(r,this.myLogTarget,this.configurationService))}getPromptResponseLogger2(){return this.notebookLogService}registerAppender(e){return this.logTargets.push(e),sl(()=>{let r=this.logTargets.indexOf(e);r!==-1&&this.logTargets.splice(r,1)})}static _getLogger(e,r,n){let o=r.get(e);return typeof o>"u"&&(o=n(e),r.set(e,o)),o}};Xp=O([x(1,ye),x(2,rh)],Xp);var WT=(o=>(o[o.DEBUG=0]="DEBUG",o[o.INFO=1]="INFO",o[o.WARN=2]="WARN",o[o.ERROR=3]="ERROR",o))(WT||{}),hD=class{logIt(e,r,...n){e===3?console.error(r,...n):e===2&&console.warn(r,...n)}},gD=class{constructor(e){this.output=e}logIt(e,r,...n){this.output.appendLine(`${r} ${n.map(XNe).join(", ")}`)}},vD=class{constructor(e,r,n){this.category=e;this.target=r;this.configurationService=n}stringToLevel(e){return WT[e]}log(e,...r){if(!this.shouldLog(e,this.category))return;let n=`[${this.category}]`;this.target.logIt(e,n,...r)}shouldLog(e,r){let n=this.configurationService.getConfig(fe.DebugFilterLogCategories);if(n.length>0&&!n.includes(r))return!1;let o=this.configurationService.getConfig(fe.DebugOverrideLogLevels),s=this.stringToLevel(o[this.category])??this.stringToLevel(o["*"])??1;return e>=s}debug(...e){this.log(0,...e)}info(...e){this.log(1,...e)}warn(...e){this.log(2,...e)}error(...e){this.log(3,...e)}exception(e,r){let n=r?`${r}: `:"",o=e instanceof Error?e:new Error("Non-error thrown: "+e);this.log(3,`${n}${o.stack}`)}},NU=class extends vD{logPrompt(e){if(!this.conversationLoggingEnabled())return;let r=`
---------------------------------
`;super.info(r+e.map(n=>`${n.role.toUpperCase()}:
${n.content}`).join(r)+r)}logResponse(e){if(!this.conversationLoggingEnabled())return;let r=`
---------------------------------
`;if(typeof e!="string"){if(e.type!=="success"){super.info(`${r}RESPONSE FAILED DUE TO ${e.type}${r}`);return}Array.isArray(e.value)?e.value.length===1?e=e.value[0]:e=`${e.value.map(n=>`<<${n}>>`).join(", ")}`:e=e.value}super.info(`${r}ASSISTANT:
${e}${r}`)}debug(e,...r){this.conversationLoggingEnabled()&&super.debug(e,...r)}info(e,...r){this.conversationLoggingEnabled()&&super.info(e,...r)}warn(e,...r){this.conversationLoggingEnabled()&&super.warn(e,...r)}error(e,...r){this.conversationLoggingEnabled()&&super.error(e,...r)}conversationLoggingEnabled(){return this.configurationService.getConfig(fe.ConversationLoggingEnabled)}};function XNe(t){switch(typeof t){case"object":return t instanceof Error&&(t.stack||t.message)||JSON.stringify(t);default:return String(t)}}var id=ae("ICopilotTokenStore"),yD=class extends Ct{constructor(){super(...arguments);this._onDidStoreUpdate=this._register(new Gt);this.onDidStoreUpdate=this._onDidStoreUpdate.event}get copilotToken(){return this._copilotToken}set copilotToken(r){let n=this._copilotToken?.token;this._copilotToken=r,n!==r?.token&&this._onDidStoreUpdate.fire()}};var bD=ae("ITelemetryUserConfig"),H_=class{constructor(e,r,n){this._tokenStore=e;this.trackingId=r,this.optedIn=n??!1,this.setupUpdateOnToken()}setupUpdateOnToken(){this._tokenStore.onDidStoreUpdate(()=>{let e=this._tokenStore.copilotToken;if(!e)return;let r=e.getTokenValue("rt")==="1",n=e.getTokenValue("tid");n!==void 0&&(this.trackingId=n,this.organizationsList=e.organizationList.toString(),this.optedIn=r)})}};H_=O([x(0,id)],H_);var me=ae("ITelemetryService");var ine=require("vscode");var nh=ae("IScopeSelector");var KT=class{static{this.version=1}#t;constructor(e){this.#t=e}async selectScope(e,r){if(e??=ine.window.activeTextEditor,!!e)return this.#t.get(nh).selectEnclosingScope(e,r)}};var LU=class extends Ct{constructor(){super(...arguments);this._contextCtors=[];this._contextResolvers=new Map;this._initialized=!1}get contextResolvers(){return this._contextResolvers.values()}getContextResolver(r){return this._contextResolvers.get(r)}register(r){if(typeof r=="function"){this._handleCtor(r);return}else return this._contextResolvers.set(r.kind,r),P_(r)&&this._register(r),r}initialize(r){if(this._initialized)return Ct.None;for(this._initialized=!0,this._accessor=r;this._contextCtors.length;){let n=this._contextCtors.pop();this._handleCtor(n)}return this}_handleCtor(r){if(!this._accessor){this._contextCtors.push(r);return}try{let n=this._accessor.createInstance(r);this.register(n)}catch(n){console.error(n)}}},tn=new LU;var Qne=z(Qt()),Xne=z(at());var G_=z(Nne()),JT=require("path");var One=require("fs");function Lne(t,e){let r=0,n=0,o;do o=t.readUInt8(e+n),r|=(o&127)<<n*7,n++;while(o&128);return{value:r,consumed:n}}var Mne=t=>{let e=(0,One.readFileSync)(t),r=new Map;for(let n=0;n<e.length;){let o=Lne(e,n);n+=o.consumed,r.set(e.subarray(n,n+o.value),r.size),n+=o.value}return r};var dr=ae("ITokenizerProvider"),Fne=3,RLe=3,kLe=1,UD=class{constructor(){let e=(0,JT.basename)(__dirname)==="dist"?Mne:r=>r;this._cl100kTokenizer=new BD((0,JT.join)(__dirname,"./cl100k_base.tiktoken"),"cl100k_base",e),this._o200kTokenizer=new BD((0,JT.join)(__dirname,"./o200k_base.tiktoken"),"o200k_base",e)}acquireTokenizer(e){return e==="gpt-4o"?this._o200kTokenizer:this._cl100kTokenizer}},BD=class{constructor(e,r,n){this._tokenFilePath=e;this._encoderName=r;this._parser=n;this.baseTokensPerMessage=RLe;this.baseTokensPerName=kLe}tokenize(e){return this._tokenizer||(this._tokenizer=this.initTokenizer()),this._tokenizer.encode(e)}tokenLength(e){return e?this.tokenize(e).length:0}countMessageTokens(e){let r=this.baseTokensPerMessage;for(let[n,o]of Object.entries(e))o&&(r+=this.tokenLength(o),n==="name"&&o!==void 0&&(r+=this.baseTokensPerName));return r}initTokenizer(){return(0,G_.createTokenizer)(this._parser(this._tokenFilePath),(0,G_.getSpecialTokensByEncoder)(this._encoderName),(0,G_.getRegexByEncoder)(this._encoderName),64e3)}};var rw=z(Qt());var tt=z(require("vscode")),$n=tt.Position,Ge=tt.Range,z_=tt.Selection;var On=tt.TextEdit,ZT=tt.WorkspaceEdit,Ur=tt.Uri,mo=tt.MarkdownString;var $_=tt.DiagnosticSeverity,$c=tt.ExtensionMode,hi=tt.Location;var Qi=tt.ChatResponseMarkdownPart,sh=tt.ChatResponseFileTreePart,Une=tt.ChatResponseAnchorPart,ho=tt.ChatResponseProgressPart,Bne=tt.ChatResponseProgressPart2,qD=tt.ChatResponseReferencePart,qne=tt.ChatResponseReferencePart2,Hne=tt.ChatResponseCodeCitationPart,ew=tt.ChatResponseCommandButtonPart,jne=tt.ChatResponseWarningPart,Vne=tt.ChatResponseMarkdownWithVulnerabilitiesPart,Jp=tt.ChatResponseTextEditPart,Gne=tt.ChatResponseConfirmationPart,HD=tt.ChatResponseDetectedParticipantPart,zne=tt.ChatRequestTurn;var $ne=tt.NewSymbolName,Wne=tt.NewSymbolNameTag,tw=tt.NewSymbolNameTriggerKind;var Dpt={t:tt.l10n.t};var dB=z(at()),Ss=z(at());var Wc=class{toString(){return Object.getPrototypeOf(this).constructor.name}},Zp=class{constructor(e,r){this.request=e;this.sessionId=r;this.status="in-progress";this.contextParts=[];this.references=[]}addReferences(e){this.references=jD([...this.references,...e])}},L0=class t{constructor(e=[]){this.turns=e}copy(){let e=JSON.parse(JSON.stringify(this.turns));return new t(e)}getLatestTurn(){return this.turns[this.turns.length-1]}addTurn(e){this.turns.forEach(r=>r.chatMessages=[]),this.turns.push(e)}removeTurn(e){let r=this.turns.findIndex(n=>n.requestId===e);if(r!==-1)return this.turns.splice(r,1)[0]}insertBeforeLatestTurn(e){this.turns.splice(this.turns.length-1,0,...e)}getState(){return{turns:this.turns}}};function jD(t){let e=new Nn,r=[],n=(s,a)=>{if(s.contains(a))return s;if(a.contains(s))return a;let[c,u]=s.start.line<a.start.line?[s,a]:[a,s];if(c.end.line>=u.start.line-1)return new Ge(c.start,u.end)};return t.forEach(s=>{let a=s.anchor;if("variableName"in a)r.push(s);else if(!Kne(a))e.set(a,s);else{let c=e.get(a.uri);if(!c)e.set(a.uri,[s]);else if(!(c instanceof dB.PromptReference)){let u=[],l=a.range;c.forEach(p=>{if("variableName"in p.anchor||!Kne(p.anchor))return;let f=n(l,p.anchor.range);f?l=f:u.push(p.anchor)});let d={uri:a.uri,range:l};e.set(a.uri,[...u,d].sort((p,f)=>p.range.start.line-f.range.start.line||p.range.end.line-f.range.end.line).map(p=>new dB.PromptReference(p)))}}}),[...Array.from(e.keys()).sort((s,a)=>s.fsPath.localeCompare(a.fsPath)).map(s=>{let a=e.get(s);return a||[]}).flat(),...r]}function Kne(t){return"uri"in t&&"range"in t}function VD(t,e=!0){switch(t){case"snippy":return e?rw.t({message:"Sorry, the response matched public code so it was blocked. Please rephrase your prompt. [Learn more](https://aka.ms/copilot-chat-filtered-docs).",comment:["{Locked='](https://aka.ms/copilot-chat-filtered-docs)'}"]}):rw.t("Sorry, the response matched public code so it was blocked. Please rephrase your prompt.");default:return e?rw.t({message:"Sorry, the response was filtered by the Responsible AI Service. Please rephrase your prompt and try again. [Learn more](https://aka.ms/copilot-chat-filtered-docs).",comment:["{Locked='](https://aka.ms/copilot-chat-filtered-docs)'}"]}):rw.t("Sorry, the response was filtered by the Responsible AI Service. Please rephrase your prompt and try again.")}}var Oo=class{constructor(e,r,n){this.intent=e;this.location=r;this.endpoint=n}async buildPrompt(e,r,n){return await(await this.createRenderer(e,this.endpoint,r,n)).render(r,n)}},$e=class extends Xne.PromptRenderer{constructor(r,n,o,s,a){let c=s.acquireTokenizer(r.family);super(r,n,o,c);this._instantiationService=a}static create(r,n,o,s){return r.invokeFunction(a=>{let c=a.get(dr);return new $e(n,o,s,c,r)})}createElement(r,...n){return this._instantiationService.createInstance(r.ctor,r.props,...n)}async render(r,n){let o=await super.render(r,n),s=o.messages[o.messages.length-1];if(s&&s.role!=="user"&&s.role!=="function")throw new Error(Qne.t("Sorry, this message is too long. Please try a shorter question."));return{...o,references:jD(o.references)}}async countTokens(r){return(await super.render(void 0,r)).tokenCount}};$e=O([x(3,dr),x(4,te)],$e);async function Xi(t,e,r,n,o,s){let a=$e.create(t,e,r,n),{messages:c,tokenCount:u,references:l}=await a.render(o,s),d=a.getAllMeta(),p=a.getUsedContext();return{messages:c,tokenCount:u,metadatas:d,usedContext:p,references:jD(l)}}var tie=z(at());var Zne=require("util");var zr=ae("IFileSystemService");async function Jne(t,e,r){let n=e.textDocuments.find(s=>s.uri.toString()===r.toString());if(n)return n.getText();let o=await t.readFile(r);return new TextDecoder().decode(o)}var Ut=ae("IExperimentationService"),GD=class{constructor(){this.initializePromise=Promise.resolve();this.initialFetch=Promise.resolve()}isFlightEnabled(e){return!1}isCachedFlightEnabled(e){return Promise.resolve(!1)}isFlightEnabledAsync(e){return Promise.resolve(!1)}getTreatmentVariable(e,r){}getTreatmentVariableAsync(e,r){return Promise.resolve(void 0)}};var Je=ae("IWorkspaceService"),zD=class{getWorkspaceFolder(e){return this.getWorkspaceFolders().find(r=>r.scheme===e.scheme&&r.authority===e.authority&&e.fsPath.startsWith(r.fsPath))}};function O0(t,e){let r=t.getWorkspaceFolder(e);return r?yr.relative(r.path,e.path):e.path}var $D=ae("IPromptWorkspaceLabels");var W_=class{constructor(e,r,n,o){this._experimentationService=e;this._configurationService=r;this._telemetryService=n;this._instantiationService=o;this.strategy=0;this.basicWorkspaceLabels=this._instantiationService.createInstance(K_),this.expandedWorkspaceLabels=this._instantiationService.createInstance(nw)}get workspaceLabels(){return this.strategy===0?this.basicWorkspaceLabels:this.expandedWorkspaceLabels}get labels(){return[...new Set(this.workspaceLabels.labels)].sort()}async collectContext(){let e=await this._configurationService.getExperimentBasedConfig(fe.ProjectLabelsExpanded,this._experimentationService);this.strategy=e?1:0,await this.workspaceLabels.collectContext();let r=[...new Set(this.labels)].sort();this._telemetryService.sendMSFTTelemetryEvent("projectLabels",{labels:r.join(",").replaceAll("@"," ")},{count:r.length})}};W_=O([x(0,Ut),x(1,ye),x(2,me),x(3,te)],W_);var K_=class{constructor(e,r,n){this._workspaceService=e;this._fileSystemService=r;this._ignoreService=n;this.indicators=new Map;this.contentIndicators=new Map;this._labels=[];this.initIndicators()}get labels(){if(this._labels.includes("javascript")&&this._labels.includes("typescript")){let e=this._labels.indexOf("javascript");this._labels.splice(e,1)}return this._labels}async collectContext(){let e=this._workspaceService.getWorkspaceFolders();if(e)for(let r=0;r<e.length;r++)await this.addContextForFolders(e[r])}async addContextForFolders(e){for(let[r,n]of this.indicators.entries())await this.addLabelIfApplicable(e,r,n)}async addLabelIfApplicable(e,r,n){let o=Ur.joinPath(e,r);if(!await this._ignoreService.isCopilotIgnored(o))try{await this._fileSystemService.stat(o),n.forEach(a=>this._labels.push(a));let s=this.contentIndicators.get(r);if(s){let a=await this._fileSystemService.readFile(o);try{s(new Zne.TextDecoder().decode(a)).forEach(u=>this._labels.push(u))}catch{}}}catch{}}initIndicators(){this.addIndicator("package.json","javascript","npm"),this.addIndicator("tsconfig.json","typescript"),this.addIndicator("pom.xml","java","maven"),this.addIndicator("build.gradle","java","gradle"),this.addIndicator("requirements.txt","python","pip"),this.addIndicator("Pipfile","python","pip"),this.addIndicator("Cargo.toml","rust","cargo"),this.addIndicator("go.mod","go","go.mod"),this.addIndicator("pubspec.yaml","dart","pub"),this.addIndicator("build.sbt","scala","sbt"),this.addIndicator("build.boot","clojure","boot"),this.addIndicator("project.clj","clojure","lein"),this.addIndicator("mix.exs","elixir","mix"),this.addIndicator("composer.json","php","composer"),this.addIndicator("Gemfile","ruby","bundler"),this.addIndicator("build.xml","java","ant"),this.addIndicator("build.gradle.kts","java","gradle"),this.addIndicator("yarn.lock","yarn"),this.addIndicator("CMakeLists.txt","c++","cmake"),this.addIndicator("vcpkg.json","c++"),this.addIndicator("Makefile","c++","makefile"),this.addContentIndicator("CMakeLists.txt",this.collectCMakeListsTxtIndicators),this.addContentIndicator("package.json",this.collectPackageJsonIndicators)}addIndicator(e,...r){this.indicators.set(e,r)}addContentIndicator(e,r){this.contentIndicators.set(e,r)}collectCMakeListsTxtIndicators(e){function r(a,c,u){try{let l=Array.from(a.matchAll(c));if(l&&l[0]&&l[0][1]){let d=parseInt(l[0][1]);if(u.includes(d))return d}}catch{}}let n=[],o=r(e,/set\s*\(\s*CMAKE_CXX_STANDARD\s*(\d+)/gmi,[98,11,14,17,20,23,26]);o&&n.push(`C++${o}`);let s=r(e,/set\s*\(\s*CMAKE_C_STANDARD\s*(\d+)/gmi,[90,99,11,17,23]);return s&&n.push(`C${s}`),n}collectPackageJsonIndicators(e){let r=[],n=JSON.parse(e),o=n.dependencies,s=n.devDependencies;o&&(o["@angular/core"]&&r.push("angular"),o.react&&r.push("react"),o.vue&&r.push("vue")),s&&s.typescript&&r.push("typescript");let a=n.engines;return a&&(a.node&&r.push("node"),a.vscode&&r.push("vscode extension")),r}};K_=O([x(0,Je),x(1,zr),x(2,De)],K_);var nw=class extends K_{constructor(r,n,o){super(r,n,o);this.popularPackages=["numpy","pandas","scipy","scikit-learn","matplotlib","tensorflow","keras","torch","seaborn","plotly","dash","jupyter","notebook","ipython","openai","pyspark","airflow","nltk","sympy","spacy","langchain","Flask","Django","fastapi","pydantic","requests","beautifulsoup4","gunicorn","uvicorn","httpx","Jinja2","aiohttp","pytest","tox","nox","selenium","playwright","coverage","hypothesis","Sphinx","celery","asyncio","boto3","google-cloud-storage","azure-storage-blob","docker","kubernetes","azure","google","ansible","cryptography","paramiko","PyJWT","xlrd","xlrd-2024","openpyxl","pywin32","pywin","psycopg2","mysqlclient","SQLite4","Werkzeug","pymongo","redis","PyMySQL","Pillow","SQLAlchemy","lxml","html5lib","Markdown","pytz","Click","attrs","PyYAML","configparser","loguru","structlog","pygame","discord"];this.addContentIndicator("package.json",this.collectPackageJsonIndicatorsExpanded),this.addContentIndicator("requirements.txt",this.collectPythonRequirementsIndicators),this.addContentIndicator("pyproject.toml",this.collectPythonTomlIndicators)}collectPackageJsonIndicatorsExpanded(r){let n=[],o=d=>{let[p,f]=d.split(".");return`${p.replace(/[^0-9]/g,"")}.${f.replace(/[^0-9]/g,"")}`},s=(d,p)=>{d&&p.forEach(({dependency:f,prefix:m})=>{if(d[f]){let h=o(d[f]);n.push(`${m||f}@${h}`)}})},a;try{a=JSON.parse(r)}catch{return n}let c=[a.dependencies,a.devDependencies,a.peerDependencies,a.optionalDependencies],u=[{dependency:"react"},{dependency:"vue"},{dependency:"@angular/core"},{dependency:"svelte"},{dependency:"solid-js"},{dependency:"alpinejs"},{dependency:"redux"},{dependency:"mobx"},{dependency:"vuex"},{dependency:"ngrx"},{dependency:"antd"},{dependency:"bootstrap"},{dependency:"bulma"},{dependency:"@mui/material"},{dependency:"semantic-ui-react"},{dependency:"next"},{dependency:"gatsby"},{dependency:"remix"},{dependency:"astro"},{dependency:"sveltekit"},{dependency:"nuxt"},{dependency:"jest"},{dependency:"mocha"},{dependency:"cypress"},{dependency:"@testing-library/react"},{dependency:"@playwright/test"},{dependency:"vitest"},{dependency:"@storybook/react"},{dependency:"tailwindcss"},{dependency:"sass"},{dependency:"styled-components"},{dependency:"css-modules"},{dependency:"postcss"},{dependency:"@emotion/react"},{dependency:"vite"},{dependency:"webpack"},{dependency:"parcel"},{dependency:"rollup"},{dependency:"snowpack"},{dependency:"esbuild"},{dependency:"@swc/core"},{dependency:"socket.io"},{dependency:"d3"},{dependency:"graphql"},{dependency:"lodash"},{dependency:"moment"},{dependency:"rxjs"},{dependency:"underscore"},{dependency:"gulp"},{dependency:"backbone"},{dependency:"ember-source"},{dependency:"handlebars"},{dependency:"jquery"},{dependency:"knockout"},{dependency:"aws-sdk"},{dependency:"cloudinary"},{dependency:"firebase"},{dependency:"@azure/storage-blob"},{dependency:"@google-cloud/storage"},{dependency:"@aws-lambda"},{dependency:"@azure/functions"},{dependency:"@google-cloud/functions"},{dependency:"firebase-functions"},{dependency:"@azure/cosmos"},{dependency:"@google-cloud/firestore"},{dependency:"mongoose"},{dependency:"dockerode"},{dependency:"kubernetes-client"},{dependency:"@elastic/elasticsearch"},{dependency:"@sentry/node"},{dependency:"log4js"},{dependency:"winston"},{dependency:"bcrypt"},{dependency:"helmet"},{dependency:"jsonwebtoken"},{dependency:"passport"},{dependency:"@azure/identity"},{dependency:"@azure/keyvault-certificates"},{dependency:"@azure/keyvault-keys"},{dependency:"@azure/keyvault-secrets"},{dependency:"@azure/service-bus"},{dependency:"@azure/event-hubs"},{dependency:"@azure/data-tables"},{dependency:"@azure/monitor-query"},{dependency:"@azure/app-configuration"},{dependency:"babel"},{dependency:"eslint"},{dependency:"parcel"},{dependency:"prettier"},{dependency:"rollup"},{dependency:"typescript"},{dependency:"webpack"},{dependency:"vite"}],l=[{dependency:"node"},{dependency:"vscode",prefix:"vscode extension"}];return c.forEach(d=>s(d,u)),s(a.engines,l),n}collectPythonRequirementsIndicators(r){let n=[];return r.split(`
`).forEach(s=>{let[a,c]=s.split("==");this.popularPackages.includes(a)&&n.push(`${a}-${c||"latest"}`)}),n}collectPythonTomlIndicators(r){let n=[],o=r.split(`
`),s=!1;return o.forEach(a=>{if(a=a.trim(),a==="[tool.poetry.dependencies]")s=!0;else if(a.startsWith("[")&&a.endsWith("]"))s=!1;else if(s&&a){let[c,u]=a.split("=").map(l=>l.trim().replace(/"|'/g,""));this.popularPackages.includes(c)&&n.push(`${c}-${u||"latest"}`)}}),n}};nw=O([x(0,Je),x(1,zr),x(2,De)],nw);var eie=z(at()),Q=class extends eie.PromptElement{constructor(e){super(e)}};var Mo=class extends Q{constructor(r,n){super(r);this.workspaceLabels=n}async prepare(){return await this.workspaceLabels.collectContext(),{labels:this.workspaceLabels.labels}}render(r,n){if(r.labels.length!==0)return vscpp(vscppf,null,vscpp(tie.UserMessage,{priority:this.props.priority},"I am working on a project of the following nature:",vscpp("br",null),r.labels.reduce((o,s)=>`${o}
- ${s}`,"").trim()))}};Mo=O([x(1,$D)],Mo);var pB=class{constructor(){this.kind="project-labels"}async resolveContext(e,r){let{messages:n}=await Xi(e.get(te),r.endpoint,Mo,{});if(n.length>0)return{kind:this.kind,userMessages:n.map(o=>o.content)}}},Dft=tn.register(new pB);var Fe=z(require("vscode"));var Y_=["user:email"],rie=["read:user"],M0=["read:user","user:email","repo","workflow"],ah=class{constructor(e){this._info=e;this.tokenMap=this.parseToken(e.token)}parseToken(e){let r=new Map,o=e?.split(":")[0]?.split(";");for(let s of o){let[a,c]=s.split("=");r.set(a,c)}return r}get token(){return this._info.token}get sku(){return this._info.sku}get organizationList(){return this._info.organization_list||[]}get enterpriseList(){return this._info.enterprise_list||[]}get endpoints(){return this._info.endpoints||{api:"https://api.githubcopilot.com",telemetry:"https://copilot-telemetry.githubusercontent.com"}}get isInternal(){let e=["4535c7beffc844b46bb1ed4aa04d759a","a5db0bcaae94032fe715fb34a5e4bce2","7184f66dfcee98cb5f08a1cb936d5225","1cb18ac6eedd49b43d74a1c5beb0b955"];for(let r of this.organizationList)if(e.includes(r))return!0;return!1}get isVscodeTeamMember(){return this._info.isVscodeTeamMember}get username(){return this._info.username}isTelemetryEnabled(){return this._isTelemetryEnabled===void 0&&(this._isTelemetryEnabled=this._info.telemetry==="enabled"),this._isTelemetryEnabled}isPublicSuggestionsEnabled(){return this._isPublicSuggestionsEnabled===void 0&&(this._isPublicSuggestionsEnabled=this._info.public_suggestions==="enabled"),this._isPublicSuggestionsEnabled}isChatEnabled(){return this._info.chat_enabled??!1}isCopilotIgnoreEnabled(){return this._info.copilotignore_enabled??!1}getTokenValue(e){return this.tokenMap.get(e)}},iw=ae("ICopilotTokenManager");var Nt=ae("IAuthenticationService"),Q_=class extends Ct{constructor(r,n,o){super();this._tokenStore=n;this._tokenManager=o;this._onDidAuthenticationChange=this._register(new Gt);this.onDidAuthenticationChange=this._onDidAuthenticationChange.event;this._register(al.any(o.onDidGitHubTokenChanged,o.onDidCopilotTokenRefresh)(()=>this._handleAuthChangeEvent())),r&&this._handleAuthChangeEvent()}get anyGitHubSession(){return this._anyGitHubSession}async getAnyGitHubSession(r){let n=await this._tokenManager.getAnyGitHubSession(r);return this._anyGitHubSession=n,n}get permissiveGitHubSession(){return this._permissiveGitHubSession}async getPermissiveGitHubSession(r){let n=await this._tokenManager.getPermissiveGitHubSession(r);return this._permissiveGitHubSession=n,n}get copilotToken(){return this._tokenStore.copilotToken}async getCopilotToken(r){try{let n=await this._tokenManager.getCopilotToken(r);return this._tokenStore.copilotToken=n,this._copilotTokenError=void 0,n}catch(n){throw this._tokenStore.copilotToken=void 0,this._copilotTokenError=n,n}}resetCopilotToken(r){this._tokenStore.copilotToken=void 0,this._tokenManager.resetCopilotToken(r),this._onDidAuthenticationChange.fire()}async _handleAuthChangeEvent(){let r=this._anyGitHubSession,n=this._permissiveGitHubSession,o=this._tokenStore.copilotToken,s=this._copilotTokenError;await Promise.allSettled([this.getAnyGitHubSession({silent:!0}),this.getPermissiveGitHubSession({silent:!0}),this.getCopilotToken()]),(r?.accessToken!==this._anyGitHubSession?.accessToken||n?.accessToken!==this._permissiveGitHubSession?.accessToken||o?.token!==this._tokenStore.copilotToken?.token||s?.message!==this._copilotTokenError?.message)&&this._onDidAuthenticationChange.fire()}};Q_=O([x(1,id),x(2,iw)],Q_);var WD=ae("IChatAgentService"),fB="default",ow="editor",tf="workspace",sw="vscode",F0="terminal",nie=[fB,ow,tf,sw,F0];function X_(t){return`github.copilot.${t}`}function iie(t){return t.replace(/^github\.copilot\./,"")}var Sn=ae("ConversationOptions");var KD=ae("IDevContainerConfigurationService");function mB(t){return t.capabilities.type==="chat"}function oie(t){return t.capabilities.type==="embeddings"}async function Mn(t,e){let r=hB(e);return t.getChatEndpoint(r)}function hB(t){return t===2?"gpt-4":"gpt-3.5-turbo"}var Le=ae("IEndpointProvider");var rf=ae("IWorkbenchService");var Fo=ae("IEmbeddingsComputer"),PLe=.72;function sie(t,e,r,n=PLe){return e.map(([o,s])=>{let a=0;for(let c=0;c<s.length;c++)a+=s[c]*t[c];return{score:a,item:o}}).filter(o=>o.score>n).sort((o,s)=>s.score-o.score).slice(0,r).map(o=>o.item)}function ch(t,e){let r=t.reduce((s,a,c)=>s+a*e[c],0),n=Math.sqrt(t.reduce((s,a)=>s+a*a,0)),o=Math.sqrt(e.reduce((s,a)=>s+a*a,0));return r/(n*o)}var ar=ae("IVSCodeExtensionContext");var $r=ae("IFetcherService"),uh=class{constructor(e,r,n,o,s,a){this.status=e;this.statusText=r;this.headers=n;this.getText=o;this.getJson=s;this.getBody=a;this.ok=this.status>=200&&this.status<300}async text(){return this.getText()}async json(){return this.getJson()}async body(){return this.getBody()}};function ALe(t){switch(t){case"copilot-preview-ada-centralus":return"text-3-small";case"text-embedding-ada-002":default:return"text-ada-002"}}var J_=class{constructor(e,r,n,o,s){this.cacheType=e;this.cacheKey=r;this.cacheVersion=n;this.fileSystemService=o;this.extensionContext=s;this.cacheVersionKey=`${r}-version`}get cacheStorageUri(){return this.cacheType===2?this.extensionContext.storageUri:this.extensionContext.globalStorageUri}get cacheVersionMementoStorage(){return this.cacheType===2?this.extensionContext.workspaceState:this.extensionContext.globalState}async updateCache(e){if(!this.cacheStorageUri||!this.fileSystemService.isWritableFileSystem(this.cacheStorageUri.scheme))return;try{await this.fileSystemService.stat(this.cacheStorageUri)}catch{await this.fileSystemService.createDirectory(this.cacheStorageUri)}await this.cacheVersionMementoStorage.update(this.cacheVersionKey,this.cacheVersion),this.cacheVersionMementoStorage.get(this.cacheKey)&&await this.cacheVersionMementoStorage.update(this.cacheKey,void 0);let n=dt.joinPath(this.cacheStorageUri,`${this.cacheKey}.json`);try{await(e===void 0?this.fileSystemService.delete(n,{useTrash:!1}):this.fileSystemService.writeFile(n,Buffer.from(JSON.stringify(e))))}catch{e!==void 0&&console.error(`Failed to write embeddings cache to ${n}`)}}async getCache(){if(!(!this.cacheStorageUri||this.cacheVersionMementoStorage.get(this.cacheVersionKey)!==this.cacheVersion))try{let r=await this.fileSystemService.readFile(dt.joinPath(this.cacheStorageUri,`${this.cacheKey}.json`));return JSON.parse(r.toString())}catch{return}}async clearCache(){return this.updateCache(void 0)}};J_=O([x(3,zr),x(4,ar)],J_);var pc=class extends J_{constructor(r,n,o,s,a,c,u,l){super(r,n,o,u,l);this.remoteCacheType=s;this.endpointProvider=a;this.fetcherService=c;this.remoteCacheVersionKey=`${n}-version-remote`}async getRemoteContainer(){let r=(await this.endpointProvider.getEmbeddingsEndpoint("ada")).model;return ALe(r)}async getRemoteCacheURL(){if(!this._remoteCacheURL){let r=await this.getRemoteContainer();this._remoteCacheURL=pc.calculateRemoteCDNURL(r,this.remoteCacheType,this.cacheVersion)}return this._remoteCacheURL}async getRemoteCacheLatestUpdateURL(){if(!this._remoteCacheLatestUpdateURL){let r=await this.getRemoteContainer();this._remoteCacheLatestUpdateURL=pc.calculateRemoteCDNLatestURL(r,this.remoteCacheType,this.cacheVersion)}return this._remoteCacheLatestUpdateURL}async fetchRemoteCache(){if(this._remoteCache)return this._remoteCache;let r=await this.getRemoteCacheURL();try{let n=await this.getRemoteCacheURL(),o=await this.fetcherService.fetch(n,{method:"GET"});if(o.ok)return this._remoteCache=await o.json(),this._remoteCache;console.error(`Failed to fetch remote embeddings cache from ${n}`);return}catch{console.error(`Failed to fetch remote embeddings cache from ${r}`);return}}async fetchRemoteCacheLatest(){let r=await this.getRemoteCacheLatestUpdateURL();try{let n=await this.fetcherService.fetch(r,{method:"GET"});if(n.ok)return n.text();console.error(`Failed to fetch remote embeddings cache from ${r}`);return}catch{console.error(`Failed to fetch remote embeddings cache from ${r}`);return}}async getCache(){let r=await this.fetchRemoteCacheLatest(),n=await super.getCache();if(n&&r===this.cacheVersionMementoStorage.get(this.remoteCacheVersionKey))return n;let o=await this.fetchRemoteCache();return await this.cacheVersionMementoStorage.update(this.remoteCacheVersionKey,r),await this.updateCache(o),o}async updateCache(r,n){if(r===void 0)return super.updateCache(r);if(!await super.getCache()||n)return super.updateCache(r)}static calculateRemoteCDNURL(r,n,o){return`https://embeddings.vscode-cdn.net/${r}/v${o}/${n}/core.json`}static calculateRemoteCDNLatestURL(r,n,o){return`https://embeddings.vscode-cdn.net/${r}/v${o}/${n}/latest.txt`}};pc=O([x(4,Le),x(5,$r),x(6,zr),x(7,ar)],pc);var nf=class extends pc{constructor(r,n,o,s,a,c,u,l,d){super(r,n,o,s,a,c,u,l);this.workbenchService=d;this._wasRemoteExtensionCacheUpdated=!1}async getBaseExtensionCDNURL(){if(!this._baseExtensionCDNURL){let r=await this.getRemoteContainer();this._baseExtensionCDNURL=nf.calculateBaseRemoteExtensionCDNURL(r,this.remoteCacheType,this.cacheVersion)}return this._baseExtensionCDNURL}constructExposedCache(){if(!this._remoteExtensionCache)return;let r={...this._remoteExtensionCache.core};for(let n in this._remoteExtensionCache.extensions){let o=this._remoteExtensionCache.extensions[n];for(let s in o)r[s]=o[s]}return r}async fetchRemoteExtensionCache(r){let o=`${await this.getBaseExtensionCDNURL()}/${r}.json`;try{let s=await this.fetcherService.fetch(o,{method:"GET"});if(s.ok)return await s.json();if(s.status===404)return{};console.error(`Failed to fetch remote embeddings cache from ${o}`);return}catch{console.error(`Failed to fetch remote embeddings cache from ${o}`);return}}async getCache(){let r=await super.getCache();if(r===void 0)return;let n={core:{},extensions:{}};r&&nf.isEmbeddingsCacheEntriesWithExtensions(r)?n=r:n={core:r,extensions:{}};let o=nf.getInstalledExtensionIds(this.workbenchService),s=!1;for(let c in n.extensions)o.includes(c)||(delete n.extensions[c],s=!0);let a=o.filter(c=>!(c in n.extensions)||n.extensions[c]===void 0);for(let c of a){let u=await this.fetchRemoteExtensionCache(c);u&&(n.extensions[c]=u)}return this._remoteExtensionCache=n,this._wasRemoteExtensionCacheUpdated=a.length>0||s,this.constructExposedCache()}async updateCache(r,n){let o=r?super.updateCache(this._remoteExtensionCache,n||this._wasRemoteExtensionCacheUpdated):super.updateCache(r,n||this._wasRemoteExtensionCacheUpdated);return this._wasRemoteExtensionCacheUpdated=!1,o}static isEmbeddingsCacheEntriesWithExtensions(r){return"core"in r&&"extensions"in r}static getInstalledExtensionIds(r){return r.getAllExtensions().filter(n=>!n.id.startsWith("vscode")).map(n=>n.id)}static calculateBaseRemoteExtensionCDNURL(r,n,o){return`https://embeddings.vscode-cdn.net/${r}/v${o}/${n}`}};nf=O([x(4,Le),x(5,$r),x(6,zr),x(7,ar),x(8,rf)],nf);var YD=class{constructor(e,r,n,o,s,a,c,u,l){this._endpointProvider=r;this.cacheKey=o;this.embeddingsComputer=a;this._isIndexLoaded=!1;this._logger=l.getPromptResponseLogger(e),this._items=new Map,c?.type&&!c.supportsExtensions?this._embeddingsCache=u.createInstance(pc,n,o,s,c.type):c?.type&&c.supportsExtensions?this._embeddingsCache=u.createInstance(nf,n,o,s,c.type):this._embeddingsCache=u.createInstance(J_,n,o,s)}get isIndexLoaded(){return this._isIndexLoaded}set isIndexLoaded(e){this._isIndexLoaded=e}async rebuildCache(){return await this._embeddingsCache.clearCache(),this._items.clear(),this.calculateEmbeddings()}nClosestValues(e,r){let n=Array.from(this._items.values()).map(o=>{if(!o.embedding)return{item:o,similarity:0};let s=ch(e,o.embedding);return{item:o,similarity:s}});return n=n.filter(o=>o.similarity>0),n.sort((o,s)=>s.similarity-o.similarity),n.slice(0,r).map(o=>o.item)}hasItem(e){return this._items.has(e)}getItem(e){return this._items.get(e)}async calculateEmbeddings(){return this._calculationPromise?this._calculationPromise:(this._calculationPromise=this._calculateEmbeddings(),this._calculationPromise.then(()=>this._calculationPromise=void 0))}async _calculateEmbeddings(){let e=Date.now(),r=await this.getLatestItems(),n=await this._embeddingsCache.getCache(),o=new Map;for(let s of r){let a=s,c=this._items.get(s.key),u=s.key;c?.embedding?a=c:n&&n[u]&&(a={...s,...n[u]}),o.set(u,a)}this._items=o,await this._embeddingsCache.updateCache(n),this._logger.debug(`Embeddings for ${this.cacheKey} calculated in ${Date.now()-e}ms`),this.isIndexLoaded=!0}async fetchEmbeddingsForItems(e){return this._embeddingEndpoint??=await this._endpointProvider.getEmbeddingsEndpoint("ada"),this.embeddingsComputer.computeEmbeddings(this._embeddingEndpoint,e.map(r=>this.getEmbeddingQueryString(r)),void 0)}};function U0(t){let e=t.split(".");return`${e[0]}.${e[1]}`}function gB(t){let e=`Setting Id: ${t.key}
`;if(e+=`Type: ${t.type}
`,e+=`Description: ${t.description??t.markdownDescription??""}
`,t.enum){e+=`Possible values:
`;for(let r=0;r<t.enum.length;r++)e+=` - ${t.enum[r]} - ${t.enumDescriptions?.[r]??""}
`}return e+=`
`,e}var QD=class extends YD{constructor(r,n,o,s,a,c,u,l,d,p,f){super(r,l,n,o,s,a,u,d,p);this.relatedInformationConfig=c;this.telemetryService=f;this.isIndexLoaded=!1}async provideRelatedInformation(r,n){let o=Date.now();if(!this.isIndexLoaded)return this.calculateEmbeddings(),this._logger.debug(`Related Information: Index not loaded yet triggering background calculation, returning ${Date.now()-o}ms`),[];if(n.isCancellationRequested)return this._logger.debug(`Related Information: Request cancelled, returning ${Date.now()-o}ms`),[];let s=Date.now(),a=await this._endpointProvider.getEmbeddingsEndpoint("ada"),c=await this.embeddingsComputer.computeEmbeddings(a,[r],{},n);if(this._logger.debug(`Related Information: Remote similarly request took ${Date.now()-s}ms`),n.isCancellationRequested||!c||!c[0])return this._logger.debug(`Related Information: Request cancelled or no embeddings computed, returning ${Date.now()-o}ms`),[];let u=[];for(let d of this._items.values()){if(n.isCancellationRequested){this._logger.debug(`Related Information: Request cancelled, returning ${Date.now()-o}ms`);break}if(d.embedding){let p=ch(c[0],d.embedding);p>this.relatedInformationConfig.threshold&&u.push(this.toRelatedInformation(d,p))}}return this._logger.debug(`Related Information: Successfully Calculated, returning ${Date.now()-o}ms`),this.relatedInformationConfig.type===4&&this.telemetryService.sendInternalMSFTTelemetryEvent("relatedInformationSettings",{query:r}),u.sort((d,p)=>p.weight-d.weight).slice(0,this.relatedInformationConfig.maxResults)}},aw=class extends QD{constructor(r,n,o,s,a,c,u){super("CommandIdIndex",1,"commandEmbeddings",U0(o.getEditorInfo().version),r,{type:2,threshold:.7,maxResults:100},{type:"commands",supportsExtensions:!0},n,s,a,c);this.workbenchService=u}async getLatestItems(){let r=await this.workbenchService.getAllCommands();return r.push({label:"Extensions: Search the marketplace for extensions",command:"workbench.extensions.search",keybinding:"Not set"}),r.push({label:"Extensions: Install extension from marketplace",command:"workbench.extensions.installExtension",keybinding:"Not set"}),r.map(n=>({key:n.command,label:n.label.replace("View: Toggle","View: Toggle or Show or Hide"),originalLabel:n.label,keybinding:n.keybinding??"Not set"}))}getEmbeddingQueryString(r){return`${r.label} - ${r.key}`}toRelatedInformation(r,n){return{type:2,weight:n,command:r.key}}};aw=O([x(0,Fo),x(1,Le),x(2,Rt),x(3,te),x(4,ue),x(5,me),x(6,rf)],aw);var cw=class extends QD{constructor(r,n,o,s,a,c,u){super("SettingsIndex",1,"settingEmbeddings",U0(o.getEditorInfo().version),r,{type:4,threshold:.7,maxResults:100},{type:"settings",supportsExtensions:!0},n,s,a,c);this.workbenchService=u}async getLatestItems(){let r=await this.workbenchService.getAllSettings(),n=[];for(let o of Object.keys(r)){let s=r[o];s.deprecationMessage||s.markdownDeprecationMessage||n.push({...s,key:o})}return n}getEmbeddingQueryString(r){return gB(r)}toRelatedInformation(r,n){return{type:4,weight:n,setting:r.key}}};cw=O([x(0,Fo),x(1,Le),x(2,Rt),x(3,te),x(4,ue),x(5,me),x(6,rf)],cw);var ul=ae("ICombinedEmbeddingIndex"),Z_=class{constructor(e){this.commandIdIndex=e.createInstance(aw),this.settingsIndex=e.createInstance(cw)}async loadIndexes(){await Promise.all([this.commandIdIndex.isIndexLoaded?Promise.resolve():this.commandIdIndex.calculateEmbeddings(),this.settingsIndex.isIndexLoaded?Promise.resolve():this.settingsIndex.calculateEmbeddings()])}async nClosestValues(e,r){return await this.loadIndexes(),{commands:this.commandIdIndex.nClosestValues(e,r),settings:this.settingsIndex.nClosestValues(e,r)}}hasSetting(e){return this.settingsIndex.hasItem(e)}hasCommand(e){return this.commandIdIndex.hasItem(e)}getSetting(e){return this.settingsIndex.getItem(e)}getCommand(e){return this.commandIdIndex.getItem(e)}};Z_=O([x(0,te)],Z_);var XD=ae("IGitCommitMessageService");var Uo=require("vscode");var Br=function(){if(typeof crypto=="object"&&typeof crypto.randomUUID=="function")return crypto.randomUUID.bind(crypto);let t;typeof crypto=="object"&&typeof crypto.getRandomValues=="function"?t=crypto.getRandomValues.bind(crypto):t=function(n){for(let o=0;o<n.length;o++)n[o]=Math.floor(Math.random()*256);return n};let e=new Uint8Array(16),r=[];for(let n=0;n<256;n++)r.push(n.toString(16).padStart(2,"0"));return function(){t(e),e[6]=e[6]&15|64,e[8]=e[8]&63|128;let o=0,s="";return s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s+="-",s+=r[e[o++]],s+=r[e[o++]],s+="-",s+=r[e[o++]],s+=r[e[o++]],s+="-",s+=r[e[o++]],s+=r[e[o++]],s+="-",s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s+=r[e[o++]],s}}();var yn=ae("IDomainService");var ll=z(require("vscode")),ex=class{async stat(e){return ll.workspace.fs.stat(e)}async readDirectory(e){return ll.workspace.fs.readDirectory(e)}async createDirectory(e){return ll.workspace.fs.createDirectory(e)}async readFile(e){return ll.workspace.fs.readFile(e)}async writeFile(e,r){return ll.workspace.fs.writeFile(e,r)}async delete(e,r){return ll.workspace.fs.delete(e,r)}async rename(e,r,n){return ll.workspace.fs.rename(e,r,n)}async copy(e,r,n){return ll.workspace.fs.copy(e,r,n)}isWritableFileSystem(e){return!!ll.workspace.fs.isWritableFileSystem(e)}createFileSystemWatcher(e){return ll.workspace.createFileSystemWatcher(e)}};var es=ae("IGitExtensionService");var go=ae("IGitService");function tx(t){if(!t)return;if(t.remoteFetchUrls?.length===1)return vB(t.remoteFetchUrls[0]);let e=t.remotes.findIndex(n=>n===t.upstreamRemote);if(e!==-1){let n=t.remoteFetchUrls?.[e];if(n){let o=vB(n);if(o)return o}}let r=t.remotes.findIndex(n=>n==="origin");if(r!==-1){let n=t.remoteFetchUrls?.[r];if(n){let o=vB(n);if(o)return o}}}function vB(t){t=t.replace(/^git@/,"").replace(/\.git$/,"");try{let e=dt.parse(t);if(e.authority!=="github.com"&&e.scheme!=="github.com")return;let r=e.path.replace(/^\//,"").trim(),[n,o,s]=r.split("/");return n&&o?`${n}/${o}`:void 0}catch{return}}function uie(t){if(t.includes("@")&&t.includes(":")){let e="https://"+t.substring(t.indexOf("@")+1).replace(":","/"),r=new URL(e);return r.username="",r.password="",r.search="",r.toString()}else{let e=new URL(t);return e.protocol="https",e.username="",e.password="",e.search="",e.toString()}}var yB=z(require("vscode"));var Kc=ae("ISearchService"),JD=class{async findFilesWithDefaultExcludes(e,r,n){return this._findFilesWithDefaultExcludesAndExcludes(e,void 0,r,n)}async _findFilesWithDefaultExcludesAndExcludes(e,r,n,o){let s={maxResults:n,exclude:r,useDefaultExcludes:!0,useDefaultSearchExcludes:!0},a=await this.findFiles(e,s,o);return n===1?a[0]:a}};var rx=class extends JD{findTextInFiles(e,r,n,o){return Promise.resolve(yB.workspace.findTextInFiles(e,r,s=>n.report(s),o))}findFiles(e,r,n){return yB.workspace.findFiles2(e,r,n)}};var nx=class{constructor(e,r){this.baseUri=e;this.pattern=r}get base(){throw new Error("Not implemented")}};function lie(t){if(typeof t!="string")throw new TypeError("Argument must be a string.");if(!t)return t;let e=t.startsWith("!"),r=e?t.slice(1):t,n=r,o=!1;switch(r[0]==="/"&&(o=!0,n=r.slice(1)),n[0]){case"*":r[1]!=="*"&&(n="**/"+n);break;default:if((!o&&!n.includes("/")||n.endsWith("/"))&&(n="**/"+n),n.endsWith("*")||n.endsWith("?"))break;/\.[a-z\d_-]+$/.test(n)||(n.endsWith("/")||(n+="/"),n+="**")}return e?"!"+n:n}var Sie=z(_ie()),Ys=require("path");var eN=class{constructor(){this._ignoreMap=new Map;this._ignoreCache=new Map;this._searchRankCache=null}setIgnoreFile(e,r,n){let o="";e&&(o=(0,Ys.relative)(e.fsPath,(0,Ys.dirname)(r.fsPath)),o.startsWith("..")&&(o="")),this._ignoreMap.set(r.fsPath,{ignore:(0,Sie.default)().add(n),patterns:XA(n).filter(s=>s.trim()&&!s.startsWith("#")).map(lie).map(s=>o?Ys.posix.join(o,s):s)}),this._searchRankCache=null,this._ignoreCache.clear()}removeIgnoreFile(e){this._ignoreMap.delete(e.fsPath),this._searchRankCache=null,this._ignoreCache.clear()}removeWorkspace(e){let r=0;for(let n of this._ignoreMap.keys())xie(e.fsPath,n)&&(this._ignoreMap.delete(n),r+=1);r>0&&(this._searchRankCache=null,this._ignoreCache.clear())}asMinimatchPatterns(){return[...this._ignoreMap.values()].flatMap(e=>e.patterns)}isIgnored(e){if(this._ignoreMap.size===0)return!1;let r=e.fsPath;if(this._ignoreCache.has(r))return this._ignoreCache.get(r);let n=0,o={ignored:!1,unignored:!1};try{let s=this._searchRank;for(let a of s){n+=1;let c=(0,Ys.dirname)(a),u=(0,Ys.relative)(c,r);if(!u.startsWith("..")&&c!==r&&xie(c,r)){let l=this._ignoreMap.get(a);if(!l)throw new Error(`No ignore patterns found for ${a}`);if(o=l.ignore.test(u),o.ignored||o.unignored)break}}return this._ignoreCache.set(r,o.ignored),o.ignored}catch{return!1}}get _searchRank(){if(this._searchRankCache!==null)return this._searchRankCache;let e={},r=n=>n.split(Ys.sep).length;return this._searchRankCache=[...this._ignoreMap.keys()].sort((n,o)=>(e[o]||=r(o))-(e[n]||=r(n)))}};function xie(t,e){return t===e?!0:(t.charAt(t.length-1)!==Ys.sep&&(t+=Ys.sep),(0,Ys.normalize)(e).startsWith((0,Ys.normalize)(t)))}var Vie=z(Oie(),1);var lw=t=>{if(typeof t!="string")throw new TypeError("invalid pattern");if(t.length>65536)throw new TypeError("pattern is too long")};var r4e={"[:alnum:]":["\\p{L}\\p{Nl}\\p{Nd}",!0],"[:alpha:]":["\\p{L}\\p{Nl}",!0],"[:ascii:]":["\\x00-\\x7f",!1],"[:blank:]":["\\p{Zs}\\t",!0],"[:cntrl:]":["\\p{Cc}",!0],"[:digit:]":["\\p{Nd}",!0],"[:graph:]":["\\p{Z}\\p{C}",!0,!0],"[:lower:]":["\\p{Ll}",!0],"[:print:]":["\\p{C}",!0],"[:punct:]":["\\p{P}",!0],"[:space:]":["\\p{Z}\\t\\r\\n\\v\\f",!0],"[:upper:]":["\\p{Lu}",!0],"[:word:]":["\\p{L}\\p{Nl}\\p{Nd}\\p{Pc}",!0],"[:xdigit:]":["A-Fa-f0-9",!1]},dw=t=>t.replace(/[[\]\\-]/g,"\\$&"),n4e=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),Mie=t=>t.join(""),Fie=(t,e)=>{let r=e;if(t.charAt(r)!=="[")throw new Error("not in a brace expression");let n=[],o=[],s=r+1,a=!1,c=!1,u=!1,l=!1,d=r,p="";e:for(;s<t.length;){let g=t.charAt(s);if((g==="!"||g==="^")&&s===r+1){l=!0,s++;continue}if(g==="]"&&a&&!u){d=s+1;break}if(a=!0,g==="\\"&&!u){u=!0,s++;continue}if(g==="["&&!u){for(let[v,[y,b,_]]of Object.entries(r4e))if(t.startsWith(v,s)){if(p)return["$.",!1,t.length-r,!0];s+=v.length,_?o.push(y):n.push(y),c=c||b;continue e}}if(u=!1,p){g>p?n.push(dw(p)+"-"+dw(g)):g===p&&n.push(dw(g)),p="",s++;continue}if(t.startsWith("-]",s+1)){n.push(dw(g+"-")),s+=2;continue}if(t.startsWith("-",s+1)){p=g,s+=2;continue}n.push(dw(g)),s++}if(d<s)return["",!1,0,!1];if(!n.length&&!o.length)return["$.",!1,t.length-r,!0];if(o.length===0&&n.length===1&&/^\\?.$/.test(n[0])&&!l){let g=n[0].length===2?n[0].slice(-1):n[0];return[n4e(g),!1,d-r,!1]}let f="["+(l?"^":"")+Mie(n)+"]",m="["+(l?"":"^")+Mie(o)+"]";return[n.length&&o.length?"("+f+"|"+m+")":n.length?f:m,c,d-r,!0]};var lh=(t,{windowsPathsNoEscape:e=!1}={})=>e?t.replace(/\[([^\/\\])\]/g,"$1"):t.replace(/((?!\\).|^)\[([^\/\\])\]/g,"$1$2").replace(/\\([^\/])/g,"$1");var i4e=new Set(["!","?","+","*","@"]),Uie=t=>i4e.has(t),o4e="(?!(?:^|/)\\.\\.?(?:$|/))",tN="(?!\\.)",s4e=new Set(["[","."]),a4e=new Set(["..","."]),c4e=new Set("().*{}+?[]^$\\!"),u4e=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),TB="[^/]",Bie=TB+"*?",qie=TB+"+?",ix=class t{type;#t;#i;#d=!1;#r=[];#c;#a;#m;#s=!1;#n;#e;#p=!1;constructor(e,r,n={}){this.type=e,e&&(this.#i=!0),this.#c=r,this.#t=this.#c?this.#c.#t:this,this.#n=this.#t===this?n:this.#t.#n,this.#m=this.#t===this?[]:this.#t.#m,e==="!"&&!this.#t.#s&&this.#m.push(this),this.#a=this.#c?this.#c.#r.length:0}get hasMagic(){if(this.#i!==void 0)return this.#i;for(let e of this.#r)if(typeof e!="string"&&(e.type||e.hasMagic))return this.#i=!0;return this.#i}toString(){return this.#e!==void 0?this.#e:this.type?this.#e=this.type+"("+this.#r.map(e=>String(e)).join("|")+")":this.#e=this.#r.map(e=>String(e)).join("")}#h(){if(this!==this.#t)throw new Error("should only call on root");if(this.#s)return this;this.toString(),this.#s=!0;let e;for(;e=this.#m.pop();){if(e.type!=="!")continue;let r=e,n=r.#c;for(;n;){for(let o=r.#a+1;!n.type&&o<n.#r.length;o++)for(let s of e.#r){if(typeof s=="string")throw new Error("string part in extglob AST??");s.copyIn(n.#r[o])}r=n,n=r.#c}}return this}push(...e){for(let r of e)if(r!==""){if(typeof r!="string"&&!(r instanceof t&&r.#c===this))throw new Error("invalid part: "+r);this.#r.push(r)}}toJSON(){let e=this.type===null?this.#r.slice().map(r=>typeof r=="string"?r:r.toJSON()):[this.type,...this.#r.map(r=>r.toJSON())];return this.isStart()&&!this.type&&e.unshift([]),this.isEnd()&&(this===this.#t||this.#t.#s&&this.#c?.type==="!")&&e.push({}),e}isStart(){if(this.#t===this)return!0;if(!this.#c?.isStart())return!1;if(this.#a===0)return!0;let e=this.#c;for(let r=0;r<this.#a;r++){let n=e.#r[r];if(!(n instanceof t&&n.type==="!"))return!1}return!0}isEnd(){if(this.#t===this||this.#c?.type==="!")return!0;if(!this.#c?.isEnd())return!1;if(!this.type)return this.#c?.isEnd();let e=this.#c?this.#c.#r.length:0;return this.#a===e-1}copyIn(e){typeof e=="string"?this.push(e):this.push(e.clone(this))}clone(e){let r=new t(this.type,e);for(let n of this.#r)r.copyIn(n);return r}static#l(e,r,n,o){let s=!1,a=!1,c=-1,u=!1;if(r.type===null){let m=n,h="";for(;m<e.length;){let g=e.charAt(m++);if(s||g==="\\"){s=!s,h+=g;continue}if(a){m===c+1?(g==="^"||g==="!")&&(u=!0):g==="]"&&!(m===c+2&&u)&&(a=!1),h+=g;continue}else if(g==="["){a=!0,c=m,u=!1,h+=g;continue}if(!o.noext&&Uie(g)&&e.charAt(m)==="("){r.push(h),h="";let v=new t(g,r);m=t.#l(e,v,m,o),r.push(v);continue}h+=g}return r.push(h),m}let l=n+1,d=new t(null,r),p=[],f="";for(;l<e.length;){let m=e.charAt(l++);if(s||m==="\\"){s=!s,f+=m;continue}if(a){l===c+1?(m==="^"||m==="!")&&(u=!0):m==="]"&&!(l===c+2&&u)&&(a=!1),f+=m;continue}else if(m==="["){a=!0,c=l,u=!1,f+=m;continue}if(Uie(m)&&e.charAt(l)==="("){d.push(f),f="";let h=new t(m,d);d.push(h),l=t.#l(e,h,l,o);continue}if(m==="|"){d.push(f),f="",p.push(d),d=new t(null,r);continue}if(m===")")return f===""&&r.#r.length===0&&(r.#p=!0),d.push(f),f="",r.push(...p,d),l;f+=m}return r.type=null,r.#i=void 0,r.#r=[e.substring(n-1)],l}static fromGlob(e,r={}){let n=new t(null,void 0,r);return t.#l(e,n,0,r),n}toMMPattern(){if(this!==this.#t)return this.#t.toMMPattern();let e=this.toString(),[r,n,o,s]=this.toRegExpSource();if(!(o||this.#i||this.#n.nocase&&!this.#n.nocaseMagicOnly&&e.toUpperCase()!==e.toLowerCase()))return n;let c=(this.#n.nocase?"i":"")+(s?"u":"");return Object.assign(new RegExp(`^${r}$`,c),{_src:r,_glob:e})}toRegExpSource(e){let r=e??!!this.#n.dot;if(this.#t===this&&this.#h(),!this.type){let u=this.isStart()&&this.isEnd(),l=this.#r.map(m=>{let[h,g,v,y]=typeof m=="string"?t.#v(m,this.#i,u):m.toRegExpSource(e);return this.#i=this.#i||v,this.#d=this.#d||y,h}).join(""),d="";if(this.isStart()&&typeof this.#r[0]=="string"&&!(this.#r.length===1&&a4e.has(this.#r[0]))){let h=s4e,g=r&&h.has(l.charAt(0))||l.startsWith("\\.")&&h.has(l.charAt(2))||l.startsWith("\\.\\.")&&h.has(l.charAt(4)),v=!r&&!e&&h.has(l.charAt(0));d=g?o4e:v?tN:""}let p="";return this.isEnd()&&this.#t.#s&&this.#c?.type==="!"&&(p="(?:$|\\/)"),[d+l+p,lh(l),this.#i=!!this.#i,this.#d]}let n=this.type==="*"||this.type==="+",o=this.type==="!"?"(?:(?!(?:":"(?:",s=this.#u(r);if(this.isStart()&&this.isEnd()&&!s&&this.type!=="!"){let u=this.toString();return this.#r=[u],this.type=null,this.#i=void 0,[u,lh(this.toString()),!1,!1]}let a=!n||e||r||!tN?"":this.#u(!0);a===s&&(a=""),a&&(s=`(?:${s})(?:${a})*?`);let c="";if(this.type==="!"&&this.#p)c=(this.isStart()&&!r?tN:"")+qie;else{let u=this.type==="!"?"))"+(this.isStart()&&!r&&!e?tN:"")+Bie+")":this.type==="@"?")":this.type==="?"?")?":this.type==="+"&&a?")":this.type==="*"&&a?")?":`)${this.type}`;c=o+s+u}return[c,lh(s),this.#i=!!this.#i,this.#d]}#u(e){return this.#r.map(r=>{if(typeof r=="string")throw new Error("string type in extglob ast??");let[n,o,s,a]=r.toRegExpSource(e);return this.#d=this.#d||a,n}).filter(r=>!(this.isStart()&&this.isEnd())||!!r).join("|")}static#v(e,r,n=!1){let o=!1,s="",a=!1;for(let c=0;c<e.length;c++){let u=e.charAt(c);if(o){o=!1,s+=(c4e.has(u)?"\\":"")+u;continue}if(u==="\\"){c===e.length-1?s+="\\\\":o=!0;continue}if(u==="["){let[l,d,p,f]=Fie(e,c);if(p){s+=l,a=a||d,c+=p-1,r=r||f;continue}}if(u==="*"){n&&e==="*"?s+=qie:s+=Bie,r=!0;continue}if(u==="?"){s+=TB,r=!0;continue}s+=u4e(u)}return[s,lh(e),!!r,a]}};var wB=(t,{windowsPathsNoEscape:e=!1}={})=>e?t.replace(/[?*()[\]]/g,"[$&]"):t.replace(/[?*()[\]\\]/g,"\\$&");var ts=(t,e,r={})=>(lw(e),!r.nocomment&&e.charAt(0)==="#"?!1:new ox(e,r).match(t)),l4e=/^\*+([^+@!?\*\[\(]*)$/,d4e=t=>e=>!e.startsWith(".")&&e.endsWith(t),p4e=t=>e=>e.endsWith(t),f4e=t=>(t=t.toLowerCase(),e=>!e.startsWith(".")&&e.toLowerCase().endsWith(t)),m4e=t=>(t=t.toLowerCase(),e=>e.toLowerCase().endsWith(t)),h4e=/^\*+\.\*+$/,g4e=t=>!t.startsWith(".")&&t.includes("."),v4e=t=>t!=="."&&t!==".."&&t.includes("."),y4e=/^\.\*+$/,b4e=t=>t!=="."&&t!==".."&&t.startsWith("."),_4e=/^\*+$/,x4e=t=>t.length!==0&&!t.startsWith("."),S4e=t=>t.length!==0&&t!=="."&&t!=="..",I4e=/^\?+([^+@!?\*\[\(]*)?$/,C4e=([t,e=""])=>{let r=Gie([t]);return e?(e=e.toLowerCase(),n=>r(n)&&n.toLowerCase().endsWith(e)):r},E4e=([t,e=""])=>{let r=zie([t]);return e?(e=e.toLowerCase(),n=>r(n)&&n.toLowerCase().endsWith(e)):r},T4e=([t,e=""])=>{let r=zie([t]);return e?n=>r(n)&&n.endsWith(e):r},w4e=([t,e=""])=>{let r=Gie([t]);return e?n=>r(n)&&n.endsWith(e):r},Gie=([t])=>{let e=t.length;return r=>r.length===e&&!r.startsWith(".")},zie=([t])=>{let e=t.length;return r=>r.length===e&&r!=="."&&r!==".."},$ie=typeof process=="object"&&process?typeof process.env=="object"&&process.env&&process.env.__MINIMATCH_TESTING_PLATFORM__||process.platform:"posix",Hie={win32:{sep:"\\"},posix:{sep:"/"}},R4e=$ie==="win32"?Hie.win32.sep:Hie.posix.sep;ts.sep=R4e;var Qc=Symbol("globstar **");ts.GLOBSTAR=Qc;var k4e="[^/]",P4e=k4e+"*?",A4e="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",D4e="(?:(?!(?:\\/|^)\\.).)*?",N4e=(t,e={})=>r=>ts(r,t,e);ts.filter=N4e;var Yc=(t,e={})=>Object.assign({},t,e),L4e=t=>{if(!t||typeof t!="object"||!Object.keys(t).length)return ts;let e=ts;return Object.assign((n,o,s={})=>e(n,o,Yc(t,s)),{Minimatch:class extends e.Minimatch{constructor(o,s={}){super(o,Yc(t,s))}static defaults(o){return e.defaults(Yc(t,o)).Minimatch}},AST:class extends e.AST{constructor(o,s,a={}){super(o,s,Yc(t,a))}static fromGlob(o,s={}){return e.AST.fromGlob(o,Yc(t,s))}},unescape:(n,o={})=>e.unescape(n,Yc(t,o)),escape:(n,o={})=>e.escape(n,Yc(t,o)),filter:(n,o={})=>e.filter(n,Yc(t,o)),defaults:n=>e.defaults(Yc(t,n)),makeRe:(n,o={})=>e.makeRe(n,Yc(t,o)),braceExpand:(n,o={})=>e.braceExpand(n,Yc(t,o)),match:(n,o,s={})=>e.match(n,o,Yc(t,s)),sep:e.sep,GLOBSTAR:Qc})};ts.defaults=L4e;var Wie=(t,e={})=>(lw(t),e.nobrace||!/\{(?:(?!\{).)*\}/.test(t)?[t]:(0,Vie.default)(t));ts.braceExpand=Wie;var O4e=(t,e={})=>new ox(t,e).makeRe();ts.makeRe=O4e;var M4e=(t,e,r={})=>{let n=new ox(e,r);return t=t.filter(o=>n.match(o)),n.options.nonull&&!t.length&&t.push(e),t};ts.match=M4e;var jie=/[?*]|[+@!]\(.*?\)|\[|\]/,F4e=t=>t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),ox=class{options;set;pattern;windowsPathsNoEscape;nonegate;negate;comment;empty;preserveMultipleSlashes;partial;globSet;globParts;nocase;isWindows;platform;windowsNoMagicRoot;regexp;constructor(e,r={}){lw(e),r=r||{},this.options=r,this.pattern=e,this.platform=r.platform||$ie,this.isWindows=this.platform==="win32",this.windowsPathsNoEscape=!!r.windowsPathsNoEscape||r.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.preserveMultipleSlashes=!!r.preserveMultipleSlashes,this.regexp=null,this.negate=!1,this.nonegate=!!r.nonegate,this.comment=!1,this.empty=!1,this.partial=!!r.partial,this.nocase=!!this.options.nocase,this.windowsNoMagicRoot=r.windowsNoMagicRoot!==void 0?r.windowsNoMagicRoot:!!(this.isWindows&&this.nocase),this.globSet=[],this.globParts=[],this.set=[],this.make()}hasMagic(){if(this.options.magicalBraces&&this.set.length>1)return!0;for(let e of this.set)for(let r of e)if(typeof r!="string")return!0;return!1}debug(...e){}make(){let e=this.pattern,r=this.options;if(!r.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate(),this.globSet=[...new Set(this.braceExpand())],r.debug&&(this.debug=(...s)=>console.error(...s)),this.debug(this.pattern,this.globSet);let n=this.globSet.map(s=>this.slashSplit(s));this.globParts=this.preprocess(n),this.debug(this.pattern,this.globParts);let o=this.globParts.map((s,a,c)=>{if(this.isWindows&&this.windowsNoMagicRoot){let u=s[0]===""&&s[1]===""&&(s[2]==="?"||!jie.test(s[2]))&&!jie.test(s[3]),l=/^[a-z]:/i.test(s[0]);if(u)return[...s.slice(0,4),...s.slice(4).map(d=>this.parse(d))];if(l)return[s[0],...s.slice(1).map(d=>this.parse(d))]}return s.map(u=>this.parse(u))});if(this.debug(this.pattern,o),this.set=o.filter(s=>s.indexOf(!1)===-1),this.isWindows)for(let s=0;s<this.set.length;s++){let a=this.set[s];a[0]===""&&a[1]===""&&this.globParts[s][2]==="?"&&typeof a[3]=="string"&&/^[a-z]:$/i.test(a[3])&&(a[2]="?")}this.debug(this.pattern,this.set)}preprocess(e){if(this.options.noglobstar)for(let n=0;n<e.length;n++)for(let o=0;o<e[n].length;o++)e[n][o]==="**"&&(e[n][o]="*");let{optimizationLevel:r=1}=this.options;return r>=2?(e=this.firstPhasePreProcess(e),e=this.secondPhasePreProcess(e)):r>=1?e=this.levelOneOptimize(e):e=this.adjascentGlobstarOptimize(e),e}adjascentGlobstarOptimize(e){return e.map(r=>{let n=-1;for(;(n=r.indexOf("**",n+1))!==-1;){let o=n;for(;r[o+1]==="**";)o++;o!==n&&r.splice(n,o-n)}return r})}levelOneOptimize(e){return e.map(r=>(r=r.reduce((n,o)=>{let s=n[n.length-1];return o==="**"&&s==="**"?n:o===".."&&s&&s!==".."&&s!=="."&&s!=="**"?(n.pop(),n):(n.push(o),n)},[]),r.length===0?[""]:r))}levelTwoFileOptimize(e){Array.isArray(e)||(e=this.slashSplit(e));let r=!1;do{if(r=!1,!this.preserveMultipleSlashes){for(let o=1;o<e.length-1;o++){let s=e[o];o===1&&s===""&&e[0]===""||(s==="."||s==="")&&(r=!0,e.splice(o,1),o--)}e[0]==="."&&e.length===2&&(e[1]==="."||e[1]==="")&&(r=!0,e.pop())}let n=0;for(;(n=e.indexOf("..",n+1))!==-1;){let o=e[n-1];o&&o!=="."&&o!==".."&&o!=="**"&&(r=!0,e.splice(n-1,2),n-=2)}}while(r);return e.length===0?[""]:e}firstPhasePreProcess(e){let r=!1;do{r=!1;for(let n of e){let o=-1;for(;(o=n.indexOf("**",o+1))!==-1;){let a=o;for(;n[a+1]==="**";)a++;a>o&&n.splice(o+1,a-o);let c=n[o+1],u=n[o+2],l=n[o+3];if(c!==".."||!u||u==="."||u===".."||!l||l==="."||l==="..")continue;r=!0,n.splice(o,1);let d=n.slice(0);d[o]="**",e.push(d),o--}if(!this.preserveMultipleSlashes){for(let a=1;a<n.length-1;a++){let c=n[a];a===1&&c===""&&n[0]===""||(c==="."||c==="")&&(r=!0,n.splice(a,1),a--)}n[0]==="."&&n.length===2&&(n[1]==="."||n[1]==="")&&(r=!0,n.pop())}let s=0;for(;(s=n.indexOf("..",s+1))!==-1;){let a=n[s-1];if(a&&a!=="."&&a!==".."&&a!=="**"){r=!0;let u=s===1&&n[s+1]==="**"?["."]:[];n.splice(s-1,2,...u),n.length===0&&n.push(""),s-=2}}}}while(r);return e}secondPhasePreProcess(e){for(let r=0;r<e.length-1;r++)for(let n=r+1;n<e.length;n++){let o=this.partsMatch(e[r],e[n],!this.preserveMultipleSlashes);o&&(e[r]=o,e[n]=[])}return e.filter(r=>r.length)}partsMatch(e,r,n=!1){let o=0,s=0,a=[],c="";for(;o<e.length&&s<r.length;)if(e[o]===r[s])a.push(c==="b"?r[s]:e[o]),o++,s++;else if(n&&e[o]==="**"&&r[s]===e[o+1])a.push(e[o]),o++;else if(n&&r[s]==="**"&&e[o]===r[s+1])a.push(r[s]),s++;else if(e[o]==="*"&&r[s]&&(this.options.dot||!r[s].startsWith("."))&&r[s]!=="**"){if(c==="b")return!1;c="a",a.push(e[o]),o++,s++}else if(r[s]==="*"&&e[o]&&(this.options.dot||!e[o].startsWith("."))&&e[o]!=="**"){if(c==="a")return!1;c="b",a.push(r[s]),o++,s++}else return!1;return e.length===r.length&&a}parseNegate(){if(this.nonegate)return;let e=this.pattern,r=!1,n=0;for(let o=0;o<e.length&&e.charAt(o)==="!";o++)r=!r,n++;n&&(this.pattern=e.slice(n)),this.negate=r}matchOne(e,r,n=!1){let o=this.options;if(this.isWindows){let g=typeof e[0]=="string"&&/^[a-z]:$/i.test(e[0]),v=!g&&e[0]===""&&e[1]===""&&e[2]==="?"&&/^[a-z]:$/i.test(e[3]),y=typeof r[0]=="string"&&/^[a-z]:$/i.test(r[0]),b=!y&&r[0]===""&&r[1]===""&&r[2]==="?"&&typeof r[3]=="string"&&/^[a-z]:$/i.test(r[3]),_=v?3:g?0:void 0,S=b?3:y?0:void 0;if(typeof _=="number"&&typeof S=="number"){let[I,T]=[e[_],r[S]];I.toLowerCase()===T.toLowerCase()&&(r[S]=I,S>_?r=r.slice(S):_>S&&(e=e.slice(_)))}}let{optimizationLevel:s=1}=this.options;s>=2&&(e=this.levelTwoFileOptimize(e)),this.debug("matchOne",this,{file:e,pattern:r}),this.debug("matchOne",e.length,r.length);for(var a=0,c=0,u=e.length,l=r.length;a<u&&c<l;a++,c++){this.debug("matchOne loop");var d=r[c],p=e[a];if(this.debug(r,d,p),d===!1)return!1;if(d===Qc){this.debug("GLOBSTAR",[r,d,p]);var f=a,m=c+1;if(m===l){for(this.debug("** at the end");a<u;a++)if(e[a]==="."||e[a]===".."||!o.dot&&e[a].charAt(0)===".")return!1;return!0}for(;f<u;){var h=e[f];if(this.debug(`
globstar while`,e,f,r,m,h),this.matchOne(e.slice(f),r.slice(m),n))return this.debug("globstar found match!",f,u,h),!0;if(h==="."||h===".."||!o.dot&&h.charAt(0)==="."){this.debug("dot detected!",e,f,r,m);break}this.debug("globstar swallow a segment, and continue"),f++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,f,r,m),f===u))}let g;if(typeof d=="string"?(g=p===d,this.debug("string match",d,p,g)):(g=d.test(p),this.debug("pattern match",d,p,g)),!g)return!1}if(a===u&&c===l)return!0;if(a===u)return n;if(c===l)return a===u-1&&e[a]==="";throw new Error("wtf?")}braceExpand(){return Wie(this.pattern,this.options)}parse(e){lw(e);let r=this.options;if(e==="**")return Qc;if(e==="")return"";let n,o=null;(n=e.match(_4e))?o=r.dot?S4e:x4e:(n=e.match(l4e))?o=(r.nocase?r.dot?m4e:f4e:r.dot?p4e:d4e)(n[1]):(n=e.match(I4e))?o=(r.nocase?r.dot?E4e:C4e:r.dot?T4e:w4e)(n):(n=e.match(h4e))?o=r.dot?v4e:g4e:(n=e.match(y4e))&&(o=b4e);let s=ix.fromGlob(e,this.options).toMMPattern();return o?Object.assign(s,{test:o}):s}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let r=this.options,n=r.noglobstar?P4e:r.dot?A4e:D4e,o=new Set(r.nocase?["i"]:[]),s=e.map(u=>{let l=u.map(d=>{if(d instanceof RegExp)for(let p of d.flags.split(""))o.add(p);return typeof d=="string"?F4e(d):d===Qc?Qc:d._src});return l.forEach((d,p)=>{let f=l[p+1],m=l[p-1];d!==Qc||m===Qc||(m===void 0?f!==void 0&&f!==Qc?l[p+1]="(?:\\/|"+n+"\\/)?"+f:l[p]=n:f===void 0?l[p-1]=m+"(?:\\/|"+n+")?":f!==Qc&&(l[p-1]=m+"(?:\\/|\\/"+n+"\\/)"+f,l[p+1]=Qc))}),l.filter(d=>d!==Qc).join("/")}).join("|"),[a,c]=e.length>1?["(?:",")"]:["",""];s="^"+a+s+c+"$",this.negate&&(s="^(?!"+s+").+$");try{this.regexp=new RegExp(s,[...o].join(""))}catch{this.regexp=!1}return this.regexp}slashSplit(e){return this.preserveMultipleSlashes?e.split("/"):this.isWindows&&/^\/\/[^\/]+/.test(e)?["",...e.split(/\/+/)]:e.split(/\/+/)}match(e,r=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&r)return!0;let n=this.options;this.isWindows&&(e=e.split("\\").join("/"));let o=this.slashSplit(e);this.debug(this.pattern,"split",o);let s=this.set;this.debug(this.pattern,"set",s);let a=o[o.length-1];if(!a)for(let c=o.length-2;!a&&c>=0;c--)a=o[c];for(let c=0;c<s.length;c++){let u=s[c],l=o;if(n.matchBase&&u.length===1&&(l=[a]),this.matchOne(l,u,r))return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}static defaults(e){return ts.defaults(e).Minimatch}};ts.AST=ix;ts.Minimatch=ox;ts.escape=wB;ts.unescape=lh;var Kie="non-git-file",rN=class{constructor(e,r,n,o,s,a,c){this._gitService=e;this._logService=r;this._fetcherService=n;this._authService=o;this._domainService=s;this._fileSystemService=a;this._workspaceService=c;this._contentExclusionCache=new Map;this._contentExclusionFetchPromise=null;this._lastRuleFetch=0;this._disposables=[];this._contentExclusionCache.set(Kie,{patterns:[],ifAnyMatch:[],ifNoneMatch:[],repoRoot:dt.file("/")}),this._disposables.push(this._gitService.onDidCloseRepository(u=>{let l=this.getRepositoryInfo(u);if(l)for(let d of l.fetchUrls)this._contentExclusionCache.delete(d)}))}async isIgnored(e){this._contentExclusionFetchPromise&&await this._contentExclusionFetchPromise;let r=this._gitService.getRepository(e)??await this._gitService.openRepository(e),n=this.getRepositoryInfo(r);Date.now()-this._lastRuleFetch>30*60*1e3&&await this.makeContentExclusionRequest(),n||(n={repoRoot:dt.file("/"),fetchUrls:[Kie]});let o=e.path.replace(n.repoRoot.path,"");this.shouldFetchContentExclusionRules(n)&&await this.makeContentExclusionRequest();for(let{patterns:a}of this._contentExclusionCache.values())for(let c of a)if(ts(o,c,{nocase:!0,matchBase:!0,nonegate:!0,dot:!0}))return this._logService.defaultLogger.info(`File ${e.path} is ignored by content exclusion rule ${c}`),!0;let s="";for(let a of n.fetchUrls){let{ifAnyMatch:c,ifNoneMatch:u}=this._contentExclusionCache.get(a)??{ifAnyMatch:[],ifNoneMatch:[]};if((c.length>0||u.length>0)&&!s)try{s=await Jne(this._fileSystemService,this._workspaceService,e)}catch{return!0}if(c.length>0&&s&&c.some(l=>l.test(s)))return this._logService.defaultLogger.info(`File ${e.path} is ignored by content exclusion rule ifAnyMatch`),!0;if(u.length>0&&s&&!u.some(l=>l.test(s)))return this._logService.defaultLogger.info(`File ${e.path} is ignored by content exclusion rule ifNoneMatch`),!0}return!1}get isRegexContextExclusionsEnabled(){return[...this._contentExclusionCache.values()].some(({ifAnyMatch:e,ifNoneMatch:r})=>e.length>0||r.length>0)}async loadRepos(e){(await Promise.all(e.map(o=>this._gitService.openRepository(o)))).map(o=>this.shouldFetchContentExclusionRules(this.getRepositoryInfo(o))).some(o=>o)&&await this.makeContentExclusionRequest()}async asMinimatchPatterns(){return await this._contentExclusionFetchPromise,Array.from(this._contentExclusionCache.values()).flatMap(({patterns:r})=>r)}dispose(){this._disposables.forEach(e=>e.dispose()),this._disposables=[],this._contentExclusionCache.clear()}shouldFetchContentExclusionRules(e){if(!e)return!1;let r=!1;for(let n of e?.fetchUrls??[])this._contentExclusionCache.has(n)||(r=!0,this._contentExclusionCache.set(n,{patterns:[],ifAnyMatch:[],ifNoneMatch:[],repoRoot:e.repoRoot}));return r}async makeContentExclusionRequest(){this._contentExclusionFetchPromise&&await this._contentExclusionFetchPromise;try{this._contentExclusionFetchPromise=this._contentExclusionRequest(),await this._contentExclusionFetchPromise}catch{this._contentExclusionFetchPromise=null}}async _contentExclusionRequest(){let e=this._fetcherService,r=(await this._authService.getAnyGitHubSession({silent:!0}))?.accessToken,n=Array.from(this._contentExclusionCache.keys()),o=async s=>{let a=s.join(","),c=new URL(this._domainService.contentExclusionURL);s.length!==0&&c.searchParams.set("repos",a),c.searchParams.set("scope","repo");let u=await e.fetch(c.toString(),{headers:{Authorization:`token ${r}`}});if(!u.ok)return;let l=await u.json();for(let d=0;d<l.length;d++){let p=l[d].rules.map(v=>v.paths).flat(),f=Xt(l[d].rules.map(v=>v.ifAnyMatch).flat()).map(v=>Yie(v)),m=Xt(l[d].rules.map(v=>v.ifNoneMatch).flat()).map(v=>Yie(v)),h=s[d],g=this._contentExclusionCache.get(h)?.repoRoot;g&&this._contentExclusionCache.set(h,{patterns:U4e(p,g),ifAnyMatch:f,ifNoneMatch:m,repoRoot:g})}};n.length===0&&await o([]);for(let s=0;s<n.length;s+=10){let a=n.slice(s,s+10);await o(a)}this._lastRuleFetch=Date.now(),this._contentExclusionFetchPromise=null}getRepositoryInfo(e){if(!e||!e.remoteFetchUrls)return;let r=Xt(e.remoteFetchUrls.map(n=>{if(n)try{return uie(n)}catch{return}}));return{repoRoot:e.rootUri,fetchUrls:r}}};function U4e(t,e){return t.map(r=>r.startsWith("/")?`${e.path}${r}`:r)}function Yie(t){if(!t.startsWith("/")&&!t.endsWith("/"))return new RegExp(t);let e=t.slice(1,t.lastIndexOf("/")),r=t.slice(t.lastIndexOf("/")+1);return new RegExp(e,r)}var nN=".copilotignore";var iN=class{constructor(e,r,n,o,s,a,c,u){this._gitService=e;this._logService=r;this._fetcherService=n;this._authService=o;this._workspaceService=s;this._domainService=a;this.searchService=c;this.fs=u;this._copilotIgnoreFiles=new eN;this._copilotIgnoreEnabled=!1;this._onDidChangeCopilotIgnoreEnablement=new Gt;this._disposables=[];this.onDidChangeCopilotIgnoreEnablement=this._onDidChangeCopilotIgnoreEnablement.event;this._filesIgnoredThisSession={"Remote Content Exclusions":new Set,"Copilot Ignore File":new Set},this._disposables.push(this._onDidChangeCopilotIgnoreEnablement),this._disposables.push(this._authService.onDidAuthenticationChange(()=>{let l=this._authService.copilotToken?.isCopilotIgnoreEnabled()??!1;this._copilotIgnoreEnabled!==l&&this._onDidChangeCopilotIgnoreEnablement.fire(l),this._copilotIgnoreEnabled=l,this._copilotIgnoreEnabled===!1&&this._remoteContentExclusions&&(this._remoteContentExclusions.dispose(),this._remoteContentExclusions=void 0),this._copilotIgnoreEnabled===!0&&!this._remoteContentExclusions&&(this._remoteContentExclusions=new rN(this._gitService,this._logService,this._fetcherService,this._authService,this._domainService,this.fs,this._workspaceService))}))}dispose(){this._disposables.forEach(e=>e.dispose()),this._remoteContentExclusions&&(this._remoteContentExclusions.dispose(),this._remoteContentExclusions=void 0),this._disposables=[]}get isEnabled(){return this._copilotIgnoreEnabled}get isRegexExclusionsEnabled(){return this._remoteContentExclusions?.isRegexContextExclusionsEnabled??!1}async isCopilotIgnored(e){let r=!1;if(this._copilotIgnoreEnabled){let n=this._copilotIgnoreFiles.isIgnored(e);r=n||await(this._remoteContentExclusions?.isIgnored(e)??!1),r&&(n?this._filesIgnoredThisSession["Copilot Ignore File"].add(e.toString()):this._filesIgnoredThisSession["Remote Content Exclusions"].add(e.toString()))}return r}async asMinimatchPattern(){if(!this._copilotIgnoreEnabled)return;let e=[],r=(await this.searchService.findFiles("**/.git/HEAD",{useDefaultExcludes:!1,useDefaultSearchExcludes:!1})).map(o=>dt.joinPath(o,"..",".."));await this._remoteContentExclusions?.loadRepos(r),e.push(await this._remoteContentExclusions?.asMinimatchPatterns()??[]),e.push(this._copilotIgnoreFiles.asMinimatchPatterns());let n=e.flat();if(n.length!==0)return n.length===1?n[0]:`{${n.join(",")}}`}init(){return this._init??=(async()=>{for(let e of this._workspaceService.getWorkspaceFolders())await this.addWorkspace(e)})(),this._init}async sessionInfo(){let e=`# Content Exclusion Session Info

`;for(let n in this._filesIgnoredThisSession){let o=this._filesIgnoredThisSession[n];o.size>0&&(e+=`## Files ignored this session from ${n}:

${Array.from(o).join(`
`)}`,e+=`

`)}let r=await this.asMinimatchPattern();return r&&(e+=`## Exclude glob used during search:
`+r),e}trackIgnoreFile(e,r,n){r.path.endsWith(nN)&&this._copilotIgnoreFiles.setIgnoreFile(e,r,n)}removeIgnoreFile(e){e.path.endsWith(nN)&&this._copilotIgnoreFiles.removeIgnoreFile(e)}removeWorkspace(e){this._copilotIgnoreFiles.removeWorkspace(e)}isIgnoreFile(e){return!!e.path.endsWith(nN)}async addWorkspace(e){if(e.scheme!=="file")return;let r=await this.searchService.findFilesWithDefaultExcludes(new nx(e,`${nN}`),void 0,an.None);for(let n of r){let o=(await this.fs.readFile(n)).toString();this.trackIgnoreFile(e,n,o)}}};var oN=class{constructor(e){this.contentProvider=e}async provideTextDocumentContent(e,r){return this.contentProvider()}};var Qie="copilot-ignore",B0=class extends iN{constructor(e,r,n,o,s,a,c){super(e,n,o,s,a,c,new rx,new ex),this.installListeners(),this._disposables.push(Uo.workspace.registerTextDocumentContentProvider(Qie,new oN(this.sessionInfo.bind(this))))}installListeners(){this._disposables.push(Uo.workspace.onDidChangeWorkspaceFolders(e=>{for(let r of e.removed)this.removeWorkspace(r.uri);for(let r of e.added)this.addWorkspace(r.uri)})),this._disposables.push(Uo.workspace.onDidSaveTextDocument(async e=>{if(this.isIgnoreFile(e.uri)){let r=(await Uo.workspace.fs.readFile(e.uri)).toString(),n=Uo.workspace.getWorkspaceFolder(e.uri);this.trackIgnoreFile(n?.uri,e.uri,r)}}),Uo.workspace.onDidDeleteFiles(e=>{for(let r of e.files)this.removeIgnoreFile(r)}),Uo.workspace.onDidRenameFiles(async e=>{for(let r of e.files)if(this.isIgnoreFile(r.newUri)){let n=(await Uo.workspace.fs.readFile(r.newUri)).toString();this.removeIgnoreFile(r.oldUri);let o=Uo.workspace.getWorkspaceFolder(r.newUri);this.trackIgnoreFile(o?.uri,r.newUri,n)}})),this._disposables.push(this.onDidChangeCopilotIgnoreEnablement(e=>{Uo.commands.executeCommand("setContext","github.copilot.copilotIgnoreEnabled",e)}))}async dispalyContentExclusionSessionInfo(){let e=dt.from({scheme:Qie,authority:Br(),path:"/Content Exclusion Session Info"}),r=await Uo.workspace.openTextDocument(e);await Uo.languages.setTextDocumentLanguage(r,"markdown"),await Uo.window.showTextDocument(r)}};B0=O([x(0,go),x(1,es),x(2,ue),x(3,$r),x(4,Nt),x(5,Je),x(6,yn)],B0);function Xie(t){let e=t.get(De);return e instanceof B0?Uo.commands.registerCommand("github.copilot.debug.contentExclusions",e.dispalyContentExclusionSessionInfo.bind(e)):{dispose:()=>{}}}var rce=z(require("path")),gt=z(require("vscode"));var vo=ae("IReviewService");var kt=ae("ITabsAndEditorsService");var sx={workspace:{explain:"explain",review:"review",tests:"tests",fix:"fix",new:"new",newNotebook:"newNotebook",semanticSearch:"semanticSearch",fixTestFailure:"fixTestFailure"},vscode:{search:"search",runCommand:"runCommand"},terminal:{explain:"terminalExplain"}};function RB(t){if(Object.keys(sx).includes(t))return{agent:t};for(let[e,r]of Object.entries(sx))if(Object.values(r).includes(t))return{agent:e,command:t}}var q0="GitHub.copilot-chat";var use=z(require("path"));var qr=class t{constructor(e,r){this.lineNumber=e,this.column=r}with(e=this.lineNumber,r=this.column){return e===this.lineNumber&&r===this.column?this:new t(e,r)}delta(e=0,r=0){return this.with(this.lineNumber+e,this.column+r)}equals(e){return t.equals(this,e)}static equals(e,r){return!e&&!r?!0:!!e&&!!r&&e.lineNumber===r.lineNumber&&e.column===r.column}isBefore(e){return t.isBefore(this,e)}static isBefore(e,r){return e.lineNumber<r.lineNumber?!0:r.lineNumber<e.lineNumber?!1:e.column<r.column}isBeforeOrEqual(e){return t.isBeforeOrEqual(this,e)}static isBeforeOrEqual(e,r){return e.lineNumber<r.lineNumber?!0:r.lineNumber<e.lineNumber?!1:e.column<=r.column}static compare(e,r){let n=e.lineNumber|0,o=r.lineNumber|0;if(n===o){let s=e.column|0,a=r.column|0;return s-a}return n-o}clone(){return new t(this.lineNumber,this.column)}toString(){return"("+this.lineNumber+","+this.column+")"}static lift(e){return new t(e.lineNumber,e.column)}static isIPosition(e){return e&&typeof e.lineNumber=="number"&&typeof e.column=="number"}toJSON(){return{lineNumber:this.lineNumber,column:this.column}}};var bt=class t{constructor(e,r,n,o){e>n||e===n&&r>o?(this.startLineNumber=n,this.startColumn=o,this.endLineNumber=e,this.endColumn=r):(this.startLineNumber=e,this.startColumn=r,this.endLineNumber=n,this.endColumn=o)}isEmpty(){return t.isEmpty(this)}static isEmpty(e){return e.startLineNumber===e.endLineNumber&&e.startColumn===e.endColumn}containsPosition(e){return t.containsPosition(this,e)}static containsPosition(e,r){return!(r.lineNumber<e.startLineNumber||r.lineNumber>e.endLineNumber||r.lineNumber===e.startLineNumber&&r.column<e.startColumn||r.lineNumber===e.endLineNumber&&r.column>e.endColumn)}static strictContainsPosition(e,r){return!(r.lineNumber<e.startLineNumber||r.lineNumber>e.endLineNumber||r.lineNumber===e.startLineNumber&&r.column<=e.startColumn||r.lineNumber===e.endLineNumber&&r.column>=e.endColumn)}containsRange(e){return t.containsRange(this,e)}static containsRange(e,r){return!(r.startLineNumber<e.startLineNumber||r.endLineNumber<e.startLineNumber||r.startLineNumber>e.endLineNumber||r.endLineNumber>e.endLineNumber||r.startLineNumber===e.startLineNumber&&r.startColumn<e.startColumn||r.endLineNumber===e.endLineNumber&&r.endColumn>e.endColumn)}strictContainsRange(e){return t.strictContainsRange(this,e)}static strictContainsRange(e,r){return!(r.startLineNumber<e.startLineNumber||r.endLineNumber<e.startLineNumber||r.startLineNumber>e.endLineNumber||r.endLineNumber>e.endLineNumber||r.startLineNumber===e.startLineNumber&&r.startColumn<=e.startColumn||r.endLineNumber===e.endLineNumber&&r.endColumn>=e.endColumn)}plusRange(e){return t.plusRange(this,e)}static plusRange(e,r){let n,o,s,a;return r.startLineNumber<e.startLineNumber?(n=r.startLineNumber,o=r.startColumn):r.startLineNumber===e.startLineNumber?(n=r.startLineNumber,o=Math.min(r.startColumn,e.startColumn)):(n=e.startLineNumber,o=e.startColumn),r.endLineNumber>e.endLineNumber?(s=r.endLineNumber,a=r.endColumn):r.endLineNumber===e.endLineNumber?(s=r.endLineNumber,a=Math.max(r.endColumn,e.endColumn)):(s=e.endLineNumber,a=e.endColumn),new t(n,o,s,a)}intersectRanges(e){return t.intersectRanges(this,e)}static intersectRanges(e,r){let n=e.startLineNumber,o=e.startColumn,s=e.endLineNumber,a=e.endColumn,c=r.startLineNumber,u=r.startColumn,l=r.endLineNumber,d=r.endColumn;return n<c?(n=c,o=u):n===c&&(o=Math.max(o,u)),s>l?(s=l,a=d):s===l&&(a=Math.min(a,d)),n>s||n===s&&o>a?null:new t(n,o,s,a)}equalsRange(e){return t.equalsRange(this,e)}static equalsRange(e,r){return!e&&!r?!0:!!e&&!!r&&e.startLineNumber===r.startLineNumber&&e.startColumn===r.startColumn&&e.endLineNumber===r.endLineNumber&&e.endColumn===r.endColumn}getEndPosition(){return t.getEndPosition(this)}static getEndPosition(e){return new qr(e.endLineNumber,e.endColumn)}getStartPosition(){return t.getStartPosition(this)}static getStartPosition(e){return new qr(e.startLineNumber,e.startColumn)}toString(){return"["+this.startLineNumber+","+this.startColumn+" -> "+this.endLineNumber+","+this.endColumn+"]"}setEndPosition(e,r){return new t(this.startLineNumber,this.startColumn,e,r)}setStartPosition(e,r){return new t(e,r,this.endLineNumber,this.endColumn)}collapseToStart(){return t.collapseToStart(this)}static collapseToStart(e){return new t(e.startLineNumber,e.startColumn,e.startLineNumber,e.startColumn)}collapseToEnd(){return t.collapseToEnd(this)}static collapseToEnd(e){return new t(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn)}delta(e){return new t(this.startLineNumber+e,this.startColumn,this.endLineNumber+e,this.endColumn)}static fromPositions(e,r=e){return new t(e.lineNumber,e.column,r.lineNumber,r.column)}static lift(e){return e?new t(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn):null}static isIRange(e){return e&&typeof e.startLineNumber=="number"&&typeof e.startColumn=="number"&&typeof e.endLineNumber=="number"&&typeof e.endColumn=="number"}static areIntersectingOrTouching(e,r){return!(e.endLineNumber<r.startLineNumber||e.endLineNumber===r.startLineNumber&&e.endColumn<r.startColumn||r.endLineNumber<e.startLineNumber||r.endLineNumber===e.startLineNumber&&r.endColumn<e.startColumn)}static areIntersecting(e,r){return!(e.endLineNumber<r.startLineNumber||e.endLineNumber===r.startLineNumber&&e.endColumn<=r.startColumn||r.endLineNumber<e.startLineNumber||r.endLineNumber===e.startLineNumber&&r.endColumn<=e.startColumn)}static compareRangesUsingStarts(e,r){if(e&&r){let s=e.startLineNumber|0,a=r.startLineNumber|0;if(s===a){let c=e.startColumn|0,u=r.startColumn|0;if(c===u){let l=e.endLineNumber|0,d=r.endLineNumber|0;if(l===d){let p=e.endColumn|0,f=r.endColumn|0;return p-f}return l-d}return c-u}return s-a}return(e?1:0)-(r?1:0)}static compareRangesUsingEnds(e,r){return e.endLineNumber===r.endLineNumber?e.endColumn===r.endColumn?e.startLineNumber===r.startLineNumber?e.startColumn-r.startColumn:e.startLineNumber-r.startLineNumber:e.endColumn-r.endColumn:e.endLineNumber-r.endLineNumber}static spansMultipleLines(e){return e.endLineNumber>e.startLineNumber}toJSON(){return this}};function cd(t,e,r){if(t===0)return{text:e,range:r};let n=typeof t=="number"?{0:e.slice(0,t),index:t}:e.match(t);if(!n)return{text:e,range:r};let o=n[0],s=O_(o,`
`);return{text:e.slice(o.length),range:{startLineNumber:r.startLineNumber+s,startColumn:s>0?o.length-(o.lastIndexOf(`
`)+1):r.startColumn+o.length,endColumn:r.endColumn,endLineNumber:r.endLineNumber}}}function ud(t,e,r){if(t===0)return{text:e,range:r};let n=typeof t=="number"?{0:e.slice(-t),index:e.length-t}:e.match(t);if(!n)return{text:e,range:r};let o=n[0],s=O_(o,`
`),a=r.endLineNumber-s;return{text:e.slice(0,n.index),range:{startColumn:r.startColumn,startLineNumber:r.startLineNumber,endLineNumber:a,endColumn:s>0?(a===r.startLineNumber?r.startColumn:0)+n.index-(e.lastIndexOf(`
`,n.index-1)+1):Math.max(0,r.endColumn-o.length)}}}function Jie(t){let e=t.lastIndexOf(`
`);return e===-1?{lineNumber:0,column:t.length}:{lineNumber:O_(t.slice(0,e),`
`)+1,column:t.length-(e+1)}}function Zie(t,e,r,n){let o=r?B4e(r,t,e):{text:t,range:e};return n?q4e(n,o.text,o.range):o}function B4e(t,e,r){let n=bt.lift(r),o=qr.lift(t);if(o.equals(n.getStartPosition()))return{text:e,range:r};if(o.isBefore(n.getStartPosition()))return{text:e,range:r};let s=0;if(o.lineNumber===n.getStartPosition().lineNumber)s=o.column-n.getStartPosition().column;else{let a=e.split(`
`);for(let[c,u]of a.entries())if(n.getStartPosition().lineNumber+c===o.lineNumber){s+=o.column;break}else s+=u.length+1}return{text:e.substring(s),range:{startLineNumber:o.lineNumber,startColumn:o.column,endColumn:r.endColumn,endLineNumber:r.endLineNumber}}}function q4e(t,e,r){let n=bt.lift(r),o=qr.lift(t);if(o.equals(n.getEndPosition()))return{text:e,range:r};if(n.getEndPosition().isBefore(o))return{text:e,range:r};let s="";if(o.lineNumber===n.getStartPosition().lineNumber)s=e.substring(0,o.column-n.getStartPosition().column);else{let a=e.split(`
`),c=[];for(let[u,l]of a.entries())if(n.getStartPosition().lineNumber+u===o.lineNumber){c.push(l.substring(0,o.column));break}else c.push(l+`
`);s=c.join("")}return{text:s,range:{startLineNumber:r.startLineNumber,startColumn:r.startColumn,endColumn:o.column,endLineNumber:o.lineNumber}}}function dh(t,e=0,r=0){let n=t.row+e,o=t.column+r;return{lineNumber:n<0?0:n,column:o<0?0:o}}function fc(t){return{startLineNumber:t.range.startPosition.row,startColumn:t.range.startPosition.column,endLineNumber:t.range.endPosition.row,endColumn:t.range.endPosition.column}}var H0=/\s+$/;function eoe(t){return t.replace(H0,"")}function Xc(t,e){return{startLineNumber:t.lineNumber,startColumn:t.column,endLineNumber:e.lineNumber,endColumn:e.column}}function toe(t,e,r){if(t===0)return{text:e,sources:r};let n=typeof t=="number"?{0:e.slice(-t),index:e.length-t}:e.match(t);if(!n)return{text:e,sources:r};let o=n.index;return{text:e.slice(0,o),sources:r.filter(s=>s.start<o).map(s=>({start:s.start,end:Math.min(s.end,o),range:ud(Math.max(0,s.end-o),e.slice(0,s.end),s.range).range}))}}var aN=t=>{let e=fc(t);return{sources:[{start:0,end:t.text.length,range:e}],text:t.text,range:e}},ld=class{constructor(e){this.tokenizer=e.acquireTokenizer("gpt4")}genericWholeFileChunking(e,{maxTokenLength:r=sN,removeEmptyLines:n=!0,rangeLimit:o=void 0}){e=e.replace(/\r\n/g,`
`);let s=e,a=Jie(e),c={startLineNumber:0,startColumn:0,endLineNumber:a.lineNumber,endColumn:a.column};if(o){let l=fw(bt.lift(o),e,bt.lift(c));s=l.newTextRange.text,c=l.newTextRange.range}return this._processLinesIntoChunks(s,c.startLineNumber,[{start:c.startLineNumber,end:e.length,range:c}],r,!0,n).filter(l=>!n||l.text.length&&/[\w\d]{2}/.test(l.text))}genericChunking({lineRangeText:e,maxTokenLength:r=sN,removeEmptyLines:n=!0,extraLineRangeSeparator:o="",numTokensInEllipsis:s=0}){if(r<0)throw Error("Cannot chunk text, not enough chunk room");if(e.length===0)return[];let a=this.tokenizer.tokenLength(o),c=[],u,l=!1;for(let d=0;d<e.length;d++){let p=e[d];if(u){let m=r-this.tokenizer.tokenLength(u.text)-a;if(m>0&&p.text.length<2e4&&this.tokenizer.tokenLength(p.text)<=m){let h=o||(l?`
`:""),g=u.text.length+h.length,v=u.text+h+p.text,y={startLineNumber:u.range.startLineNumber,startColumn:u.range.startColumn,endColumn:p.range.endColumn,endLineNumber:p.range.endLineNumber},b=p.sources.map(_=>({start:_.start+g,end:_.end+g,range:_.range}));for(let _ of u.sources)b.push(_);l=!1,u={sources:b,text:v,range:y};continue}c.push(u)}let f=this._processLinesIntoChunks(p.text,p.range.startLineNumber,p.sources,r,!1,n,s,d===0);u=f.pop(),l=!0,c.push(...f)}return u&&c.push(u),c.filter(d=>!n||d.text.length&&/[^\s]/.test(d.text)).map(d=>{let{text:p,sources:f}=toe(H0,d.text,d.sources);return{range:d.range,text:p,sources:f}})}_processLinesIntoChunks(e,r,n,o,s,a,c=0,u=!1){let l=0,d=0,p=e.split(`
`),f=[];for(let h=0;h<p.length;h++){let g=p[h],v=d;if(d+=g.length+1,a&&g.length===0)continue;let y=g.slice(0,o*4);f.push({text:y,lineNumber:h+r,originalStart:v,originalEnd:v+y.length,tokens:this.tokenizer.tokenLength(y)})}let m=[];for(;l<f.length;){let h=o-c-(u?0:c),g=l+1,v="";for(let ne=f[l].tokens;g<f.length;g++){let Y=ne+f[g].tokens;if(Y>h){v=f.slice(l,g+1).map(w=>w.text).join(`
`);let N=this.tokenizer.tokenLength(v);for(;N<=h&&g<f.length-1;)g++,v+=`
`+f[g].text,N=this.tokenizer.tokenLength(v);break}ne=Y}let y=f.slice(l,g),b=g;if(s){let{chunks:ne,usedFromRemaining:Y}=this._dedentAndAddLinesToChunk(y,f.slice(g),h);y=ne,l=b+Y}else for(l=b;l<f.length&&f[l].text.length===0;)l++;if(y.length===0)continue;for(;y.length;){let ne=y[y.length-1],Y=ne.text.trimEnd();if(Y==="")y.pop();else if(Y!==ne.text){ne.text=Y,ne.originalEnd=Y.length;break}else break}if(y.length===0)continue;let _=[];n.sort((ne,Y)=>ne.start-Y.start);let S=0,I=0,T=0,A=y[0]?.originalStart||0,B=(ne,Y)=>{if(I===ne){I=Y;return}for(;S<n.length&&n[S].start<I;){let N=n[S++];if(N.end<A)continue;let w=Math.max(0,N.end-I),P=Math.max(0,A-N.start),q=ud(w,e.slice(N.start,N.end),N.range),U=cd(P,q.text,q.range);_.push({start:N.start+P-T,end:N.end-w-T,range:U.range})}I=Y,A=ne},j="";for(let ne=0;ne<y.length;ne++){let Y=y[ne];B(Y.originalStart,Y.originalEnd),j+=Y.text,T=Y.originalEnd-j.length,ne<y.length-1&&(j+=`
`,e[Y.originalEnd]===`
`&&B(Y.originalEnd,Y.originalEnd+1))}B(1/0,1/0);let F=y[y.length-1];m.push({text:j,range:{startLineNumber:y[0].lineNumber,startColumn:0,endLineNumber:F.lineNumber,endColumn:F.text.length},sources:_})}return m}_dedentAndAddLinesToChunk(e,r,n){let o=pw(e.map(d=>d.text)),s=o.shortestLeadingCommonWhitespace;if(!s)return{chunks:e,usedFromRemaining:0};let a=e;for(let d=0;d<a.length;d++)a[d].originalStart+=s.length,a[d].text=o.trimmedLines[d]||"";let c=0,u=this.tokenizer.tokenLength(a.map(d=>d.text).join(`
`)),l=r[c];for(u+=l?.tokens||0;l&&u<n&&(l.text.length===0||l.text.startsWith(s));)a.push({...l,text:l.text.slice(s.length),originalStart:l.originalEnd+s.length}),c++,l=r[c],u+=l?.tokens||0;return{chunks:a,usedFromRemaining:c}}};ld=O([x(0,dr)],ld);function pw(t){let e=t.map(s=>{if(!s)return;let a=s.match(/^\s+/),c=a?a[0]:"",u=s.substring(c?.length);return[c,u]}),r=Xt(e),n=H4e(r)??"",o=n.length;return{trimmedLines:e.map(s=>s?s[0].substring(o)+s[1]:void 0),shortestLeadingCommonWhitespace:n}}function H4e(t){let e;for(let r of t){if(e===void 0){e=r[0];continue}e=j4e(e,r[0])}return e??""}function j4e(t,e){let r=ZA(t,e);return t.substring(0,r)}var sN=250;function fw(t,e,r){let n=r.getStartPosition().isBefore(t.getStartPosition()),o=t.getEndPosition().isBefore(r.getEndPosition());return{newTextRange:Zie(e,r,t.getStartPosition(),t.getEndPosition()),trimmedLeft:n,trimmedRight:o}}var FB={};mn(FB,{arrayReplaceAt:()=>MB,assign:()=>ux,escapeHtml:()=>sf,escapeRE:()=>EOe,fromCodePoint:()=>gw,has:()=>mOe,isMdAsciiPunct:()=>G0,isPunctChar:()=>V0,isSpace:()=>pr,isString:()=>yN,isValidEntityCode:()=>bN,isWhiteSpace:()=>j0,lib:()=>TOe,normalizeReference:()=>z0,unescapeAll:()=>mh,unescapeMd:()=>bOe});var pN={};mn(pN,{decode:()=>mw,encode:()=>lN,format:()=>ax,parse:()=>hw});var roe={};function V4e(t){let e=roe[t];if(e)return e;e=roe[t]=[];for(let r=0;r<128;r++){let n=String.fromCharCode(r);e.push(n)}for(let r=0;r<t.length;r++){let n=t.charCodeAt(r);e[n]="%"+("0"+n.toString(16).toUpperCase()).slice(-2)}return e}function cN(t,e){typeof e!="string"&&(e=cN.defaultChars);let r=V4e(e);return t.replace(/(%[a-f0-9]{2})+/gi,function(n){let o="";for(let s=0,a=n.length;s<a;s+=3){let c=parseInt(n.slice(s+1,s+3),16);if(c<128){o+=r[c];continue}if((c&224)===192&&s+3<a){let u=parseInt(n.slice(s+4,s+6),16);if((u&192)===128){let l=c<<6&1984|u&63;l<128?o+="\uFFFD\uFFFD":o+=String.fromCharCode(l),s+=3;continue}}if((c&240)===224&&s+6<a){let u=parseInt(n.slice(s+4,s+6),16),l=parseInt(n.slice(s+7,s+9),16);if((u&192)===128&&(l&192)===128){let d=c<<12&61440|u<<6&4032|l&63;d<2048||d>=55296&&d<=57343?o+="\uFFFD\uFFFD\uFFFD":o+=String.fromCharCode(d),s+=6;continue}}if((c&248)===240&&s+9<a){let u=parseInt(n.slice(s+4,s+6),16),l=parseInt(n.slice(s+7,s+9),16),d=parseInt(n.slice(s+10,s+12),16);if((u&192)===128&&(l&192)===128&&(d&192)===128){let p=c<<18&1835008|u<<12&258048|l<<6&4032|d&63;p<65536||p>1114111?o+="\uFFFD\uFFFD\uFFFD\uFFFD":(p-=65536,o+=String.fromCharCode(55296+(p>>10),56320+(p&1023))),s+=9;continue}}o+="\uFFFD"}return o})}cN.defaultChars=";/?:@&=+$,#";cN.componentChars="";var mw=cN;var noe={};function G4e(t){let e=noe[t];if(e)return e;e=noe[t]=[];for(let r=0;r<128;r++){let n=String.fromCharCode(r);/^[0-9a-z]$/i.test(n)?e.push(n):e.push("%"+("0"+r.toString(16).toUpperCase()).slice(-2))}for(let r=0;r<t.length;r++)e[t.charCodeAt(r)]=t[r];return e}function uN(t,e,r){typeof e!="string"&&(r=e,e=uN.defaultChars),typeof r>"u"&&(r=!0);let n=G4e(e),o="";for(let s=0,a=t.length;s<a;s++){let c=t.charCodeAt(s);if(r&&c===37&&s+2<a&&/^[0-9a-f]{2}$/i.test(t.slice(s+1,s+3))){o+=t.slice(s,s+3),s+=2;continue}if(c<128){o+=n[c];continue}if(c>=55296&&c<=57343){if(c>=55296&&c<=56319&&s+1<a){let u=t.charCodeAt(s+1);if(u>=56320&&u<=57343){o+=encodeURIComponent(t[s]+t[s+1]),s++;continue}}o+="%EF%BF%BD";continue}o+=encodeURIComponent(t[s])}return o}uN.defaultChars=";/?:@&=+$,-_.!~*'()#";uN.componentChars="-_.!~*'()";var lN=uN;function ax(t){let e="";return e+=t.protocol||"",e+=t.slashes?"//":"",e+=t.auth?t.auth+"@":"",t.hostname&&t.hostname.indexOf(":")!==-1?e+="["+t.hostname+"]":e+=t.hostname||"",e+=t.port?":"+t.port:"",e+=t.pathname||"",e+=t.search||"",e+=t.hash||"",e}function dN(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}var z4e=/^([a-z0-9.+-]+:)/i,$4e=/:[0-9]*$/,W4e=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,K4e=["<",">",'"',"`"," ","\r",`
`,"	"],Y4e=["{","}","|","\\","^","`"].concat(K4e),Q4e=["'"].concat(Y4e),ioe=["%","/","?",";","#"].concat(Q4e),ooe=["/","?","#"],X4e=255,soe=/^[+a-z0-9A-Z_-]{0,63}$/,J4e=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,aoe={javascript:!0,"javascript:":!0},coe={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Z4e(t,e){if(t&&t instanceof dN)return t;let r=new dN;return r.parse(t,e),r}dN.prototype.parse=function(t,e){let r,n,o,s=t;if(s=s.trim(),!e&&t.split("#").length===1){let l=W4e.exec(s);if(l)return this.pathname=l[1],l[2]&&(this.search=l[2]),this}let a=z4e.exec(s);if(a&&(a=a[0],r=a.toLowerCase(),this.protocol=a,s=s.substr(a.length)),(e||a||s.match(/^\/\/[^@\/]+@[^@\/]+/))&&(o=s.substr(0,2)==="//",o&&!(a&&aoe[a])&&(s=s.substr(2),this.slashes=!0)),!aoe[a]&&(o||a&&!coe[a])){let l=-1;for(let h=0;h<ooe.length;h++)n=s.indexOf(ooe[h]),n!==-1&&(l===-1||n<l)&&(l=n);let d,p;l===-1?p=s.lastIndexOf("@"):p=s.lastIndexOf("@",l),p!==-1&&(d=s.slice(0,p),s=s.slice(p+1),this.auth=d),l=-1;for(let h=0;h<ioe.length;h++)n=s.indexOf(ioe[h]),n!==-1&&(l===-1||n<l)&&(l=n);l===-1&&(l=s.length),s[l-1]===":"&&l--;let f=s.slice(0,l);s=s.slice(l),this.parseHost(f),this.hostname=this.hostname||"";let m=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!m){let h=this.hostname.split(/\./);for(let g=0,v=h.length;g<v;g++){let y=h[g];if(y&&!y.match(soe)){let b="";for(let _=0,S=y.length;_<S;_++)y.charCodeAt(_)>127?b+="x":b+=y[_];if(!b.match(soe)){let _=h.slice(0,g),S=h.slice(g+1),I=y.match(J4e);I&&(_.push(I[1]),S.unshift(I[2])),S.length&&(s=S.join(".")+s),this.hostname=_.join(".");break}}}}this.hostname.length>X4e&&(this.hostname=""),m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}let c=s.indexOf("#");c!==-1&&(this.hash=s.substr(c),s=s.slice(0,c));let u=s.indexOf("?");return u!==-1&&(this.search=s.substr(u),s=s.slice(0,u)),s&&(this.pathname=s),coe[r]&&this.hostname&&!this.pathname&&(this.pathname=""),this};dN.prototype.parseHost=function(t){let e=$4e.exec(t);e&&(e=e[0],e!==":"&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)};var hw=Z4e;var kB={};mn(kB,{Any:()=>fN,Cc:()=>mN,Cf:()=>uoe,P:()=>cx,Z:()=>hN});var fN=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/;var mN=/[\0-\x1F\x7F-\x9F]/;var uoe=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/;var cx=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/;var hN=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/;var loe=new Uint16Array('\u1D41<\xD5\u0131\u028A\u049D\u057B\u05D0\u0675\u06DE\u07A2\u07D6\u080F\u0A4A\u0A91\u0DA1\u0E6D\u0F09\u0F26\u10CA\u1228\u12E1\u1415\u149D\u14C3\u14DF\u1525\0\0\0\0\0\0\u156B\u16CD\u198D\u1C12\u1DDD\u1F7E\u2060\u21B0\u228D\u23C0\u23FB\u2442\u2824\u2912\u2D08\u2E48\u2FCE\u3016\u32BA\u3639\u37AC\u38FE\u3A28\u3A71\u3AE0\u3B2E\u0800EMabcfglmnoprstu\\bfms\x7F\x84\x8B\x90\x95\x98\xA6\xB3\xB9\xC8\xCFlig\u803B\xC6\u40C6P\u803B&\u4026cute\u803B\xC1\u40C1reve;\u4102\u0100iyx}rc\u803B\xC2\u40C2;\u4410r;\uC000\u{1D504}rave\u803B\xC0\u40C0pha;\u4391acr;\u4100d;\u6A53\u0100gp\x9D\xA1on;\u4104f;\uC000\u{1D538}plyFunction;\u6061ing\u803B\xC5\u40C5\u0100cs\xBE\xC3r;\uC000\u{1D49C}ign;\u6254ilde\u803B\xC3\u40C3ml\u803B\xC4\u40C4\u0400aceforsu\xE5\xFB\xFE\u0117\u011C\u0122\u0127\u012A\u0100cr\xEA\xF2kslash;\u6216\u0176\xF6\xF8;\u6AE7ed;\u6306y;\u4411\u0180crt\u0105\u010B\u0114ause;\u6235noullis;\u612Ca;\u4392r;\uC000\u{1D505}pf;\uC000\u{1D539}eve;\u42D8c\xF2\u0113mpeq;\u624E\u0700HOacdefhilorsu\u014D\u0151\u0156\u0180\u019E\u01A2\u01B5\u01B7\u01BA\u01DC\u0215\u0273\u0278\u027Ecy;\u4427PY\u803B\xA9\u40A9\u0180cpy\u015D\u0162\u017Aute;\u4106\u0100;i\u0167\u0168\u62D2talDifferentialD;\u6145leys;\u612D\u0200aeio\u0189\u018E\u0194\u0198ron;\u410Cdil\u803B\xC7\u40C7rc;\u4108nint;\u6230ot;\u410A\u0100dn\u01A7\u01ADilla;\u40B8terDot;\u40B7\xF2\u017Fi;\u43A7rcle\u0200DMPT\u01C7\u01CB\u01D1\u01D6ot;\u6299inus;\u6296lus;\u6295imes;\u6297o\u0100cs\u01E2\u01F8kwiseContourIntegral;\u6232eCurly\u0100DQ\u0203\u020FoubleQuote;\u601Duote;\u6019\u0200lnpu\u021E\u0228\u0247\u0255on\u0100;e\u0225\u0226\u6237;\u6A74\u0180git\u022F\u0236\u023Aruent;\u6261nt;\u622FourIntegral;\u622E\u0100fr\u024C\u024E;\u6102oduct;\u6210nterClockwiseContourIntegral;\u6233oss;\u6A2Fcr;\uC000\u{1D49E}p\u0100;C\u0284\u0285\u62D3ap;\u624D\u0580DJSZacefios\u02A0\u02AC\u02B0\u02B4\u02B8\u02CB\u02D7\u02E1\u02E6\u0333\u048D\u0100;o\u0179\u02A5trahd;\u6911cy;\u4402cy;\u4405cy;\u440F\u0180grs\u02BF\u02C4\u02C7ger;\u6021r;\u61A1hv;\u6AE4\u0100ay\u02D0\u02D5ron;\u410E;\u4414l\u0100;t\u02DD\u02DE\u6207a;\u4394r;\uC000\u{1D507}\u0100af\u02EB\u0327\u0100cm\u02F0\u0322ritical\u0200ADGT\u0300\u0306\u0316\u031Ccute;\u40B4o\u0174\u030B\u030D;\u42D9bleAcute;\u42DDrave;\u4060ilde;\u42DCond;\u62C4ferentialD;\u6146\u0470\u033D\0\0\0\u0342\u0354\0\u0405f;\uC000\u{1D53B}\u0180;DE\u0348\u0349\u034D\u40A8ot;\u60DCqual;\u6250ble\u0300CDLRUV\u0363\u0372\u0382\u03CF\u03E2\u03F8ontourIntegra\xEC\u0239o\u0274\u0379\0\0\u037B\xBB\u0349nArrow;\u61D3\u0100eo\u0387\u03A4ft\u0180ART\u0390\u0396\u03A1rrow;\u61D0ightArrow;\u61D4e\xE5\u02CAng\u0100LR\u03AB\u03C4eft\u0100AR\u03B3\u03B9rrow;\u67F8ightArrow;\u67FAightArrow;\u67F9ight\u0100AT\u03D8\u03DErrow;\u61D2ee;\u62A8p\u0241\u03E9\0\0\u03EFrrow;\u61D1ownArrow;\u61D5erticalBar;\u6225n\u0300ABLRTa\u0412\u042A\u0430\u045E\u047F\u037Crrow\u0180;BU\u041D\u041E\u0422\u6193ar;\u6913pArrow;\u61F5reve;\u4311eft\u02D2\u043A\0\u0446\0\u0450ightVector;\u6950eeVector;\u695Eector\u0100;B\u0459\u045A\u61BDar;\u6956ight\u01D4\u0467\0\u0471eeVector;\u695Fector\u0100;B\u047A\u047B\u61C1ar;\u6957ee\u0100;A\u0486\u0487\u62A4rrow;\u61A7\u0100ct\u0492\u0497r;\uC000\u{1D49F}rok;\u4110\u0800NTacdfglmopqstux\u04BD\u04C0\u04C4\u04CB\u04DE\u04E2\u04E7\u04EE\u04F5\u0521\u052F\u0536\u0552\u055D\u0560\u0565G;\u414AH\u803B\xD0\u40D0cute\u803B\xC9\u40C9\u0180aiy\u04D2\u04D7\u04DCron;\u411Arc\u803B\xCA\u40CA;\u442Dot;\u4116r;\uC000\u{1D508}rave\u803B\xC8\u40C8ement;\u6208\u0100ap\u04FA\u04FEcr;\u4112ty\u0253\u0506\0\0\u0512mallSquare;\u65FBerySmallSquare;\u65AB\u0100gp\u0526\u052Aon;\u4118f;\uC000\u{1D53C}silon;\u4395u\u0100ai\u053C\u0549l\u0100;T\u0542\u0543\u6A75ilde;\u6242librium;\u61CC\u0100ci\u0557\u055Ar;\u6130m;\u6A73a;\u4397ml\u803B\xCB\u40CB\u0100ip\u056A\u056Fsts;\u6203onentialE;\u6147\u0280cfios\u0585\u0588\u058D\u05B2\u05CCy;\u4424r;\uC000\u{1D509}lled\u0253\u0597\0\0\u05A3mallSquare;\u65FCerySmallSquare;\u65AA\u0370\u05BA\0\u05BF\0\0\u05C4f;\uC000\u{1D53D}All;\u6200riertrf;\u6131c\xF2\u05CB\u0600JTabcdfgorst\u05E8\u05EC\u05EF\u05FA\u0600\u0612\u0616\u061B\u061D\u0623\u066C\u0672cy;\u4403\u803B>\u403Emma\u0100;d\u05F7\u05F8\u4393;\u43DCreve;\u411E\u0180eiy\u0607\u060C\u0610dil;\u4122rc;\u411C;\u4413ot;\u4120r;\uC000\u{1D50A};\u62D9pf;\uC000\u{1D53E}eater\u0300EFGLST\u0635\u0644\u064E\u0656\u065B\u0666qual\u0100;L\u063E\u063F\u6265ess;\u62DBullEqual;\u6267reater;\u6AA2ess;\u6277lantEqual;\u6A7Eilde;\u6273cr;\uC000\u{1D4A2};\u626B\u0400Aacfiosu\u0685\u068B\u0696\u069B\u069E\u06AA\u06BE\u06CARDcy;\u442A\u0100ct\u0690\u0694ek;\u42C7;\u405Eirc;\u4124r;\u610ClbertSpace;\u610B\u01F0\u06AF\0\u06B2f;\u610DizontalLine;\u6500\u0100ct\u06C3\u06C5\xF2\u06A9rok;\u4126mp\u0144\u06D0\u06D8ownHum\xF0\u012Fqual;\u624F\u0700EJOacdfgmnostu\u06FA\u06FE\u0703\u0707\u070E\u071A\u071E\u0721\u0728\u0744\u0778\u078B\u078F\u0795cy;\u4415lig;\u4132cy;\u4401cute\u803B\xCD\u40CD\u0100iy\u0713\u0718rc\u803B\xCE\u40CE;\u4418ot;\u4130r;\u6111rave\u803B\xCC\u40CC\u0180;ap\u0720\u072F\u073F\u0100cg\u0734\u0737r;\u412AinaryI;\u6148lie\xF3\u03DD\u01F4\u0749\0\u0762\u0100;e\u074D\u074E\u622C\u0100gr\u0753\u0758ral;\u622Bsection;\u62C2isible\u0100CT\u076C\u0772omma;\u6063imes;\u6062\u0180gpt\u077F\u0783\u0788on;\u412Ef;\uC000\u{1D540}a;\u4399cr;\u6110ilde;\u4128\u01EB\u079A\0\u079Ecy;\u4406l\u803B\xCF\u40CF\u0280cfosu\u07AC\u07B7\u07BC\u07C2\u07D0\u0100iy\u07B1\u07B5rc;\u4134;\u4419r;\uC000\u{1D50D}pf;\uC000\u{1D541}\u01E3\u07C7\0\u07CCr;\uC000\u{1D4A5}rcy;\u4408kcy;\u4404\u0380HJacfos\u07E4\u07E8\u07EC\u07F1\u07FD\u0802\u0808cy;\u4425cy;\u440Cppa;\u439A\u0100ey\u07F6\u07FBdil;\u4136;\u441Ar;\uC000\u{1D50E}pf;\uC000\u{1D542}cr;\uC000\u{1D4A6}\u0580JTaceflmost\u0825\u0829\u082C\u0850\u0863\u09B3\u09B8\u09C7\u09CD\u0A37\u0A47cy;\u4409\u803B<\u403C\u0280cmnpr\u0837\u083C\u0841\u0844\u084Dute;\u4139bda;\u439Bg;\u67EAlacetrf;\u6112r;\u619E\u0180aey\u0857\u085C\u0861ron;\u413Ddil;\u413B;\u441B\u0100fs\u0868\u0970t\u0500ACDFRTUVar\u087E\u08A9\u08B1\u08E0\u08E6\u08FC\u092F\u095B\u0390\u096A\u0100nr\u0883\u088FgleBracket;\u67E8row\u0180;BR\u0899\u089A\u089E\u6190ar;\u61E4ightArrow;\u61C6eiling;\u6308o\u01F5\u08B7\0\u08C3bleBracket;\u67E6n\u01D4\u08C8\0\u08D2eeVector;\u6961ector\u0100;B\u08DB\u08DC\u61C3ar;\u6959loor;\u630Aight\u0100AV\u08EF\u08F5rrow;\u6194ector;\u694E\u0100er\u0901\u0917e\u0180;AV\u0909\u090A\u0910\u62A3rrow;\u61A4ector;\u695Aiangle\u0180;BE\u0924\u0925\u0929\u62B2ar;\u69CFqual;\u62B4p\u0180DTV\u0937\u0942\u094CownVector;\u6951eeVector;\u6960ector\u0100;B\u0956\u0957\u61BFar;\u6958ector\u0100;B\u0965\u0966\u61BCar;\u6952ight\xE1\u039Cs\u0300EFGLST\u097E\u098B\u0995\u099D\u09A2\u09ADqualGreater;\u62DAullEqual;\u6266reater;\u6276ess;\u6AA1lantEqual;\u6A7Dilde;\u6272r;\uC000\u{1D50F}\u0100;e\u09BD\u09BE\u62D8ftarrow;\u61DAidot;\u413F\u0180npw\u09D4\u0A16\u0A1Bg\u0200LRlr\u09DE\u09F7\u0A02\u0A10eft\u0100AR\u09E6\u09ECrrow;\u67F5ightArrow;\u67F7ightArrow;\u67F6eft\u0100ar\u03B3\u0A0Aight\xE1\u03BFight\xE1\u03CAf;\uC000\u{1D543}er\u0100LR\u0A22\u0A2CeftArrow;\u6199ightArrow;\u6198\u0180cht\u0A3E\u0A40\u0A42\xF2\u084C;\u61B0rok;\u4141;\u626A\u0400acefiosu\u0A5A\u0A5D\u0A60\u0A77\u0A7C\u0A85\u0A8B\u0A8Ep;\u6905y;\u441C\u0100dl\u0A65\u0A6FiumSpace;\u605Flintrf;\u6133r;\uC000\u{1D510}nusPlus;\u6213pf;\uC000\u{1D544}c\xF2\u0A76;\u439C\u0480Jacefostu\u0AA3\u0AA7\u0AAD\u0AC0\u0B14\u0B19\u0D91\u0D97\u0D9Ecy;\u440Acute;\u4143\u0180aey\u0AB4\u0AB9\u0ABEron;\u4147dil;\u4145;\u441D\u0180gsw\u0AC7\u0AF0\u0B0Eative\u0180MTV\u0AD3\u0ADF\u0AE8ediumSpace;\u600Bhi\u0100cn\u0AE6\u0AD8\xEB\u0AD9eryThi\xEE\u0AD9ted\u0100GL\u0AF8\u0B06reaterGreate\xF2\u0673essLes\xF3\u0A48Line;\u400Ar;\uC000\u{1D511}\u0200Bnpt\u0B22\u0B28\u0B37\u0B3Areak;\u6060BreakingSpace;\u40A0f;\u6115\u0680;CDEGHLNPRSTV\u0B55\u0B56\u0B6A\u0B7C\u0BA1\u0BEB\u0C04\u0C5E\u0C84\u0CA6\u0CD8\u0D61\u0D85\u6AEC\u0100ou\u0B5B\u0B64ngruent;\u6262pCap;\u626DoubleVerticalBar;\u6226\u0180lqx\u0B83\u0B8A\u0B9Bement;\u6209ual\u0100;T\u0B92\u0B93\u6260ilde;\uC000\u2242\u0338ists;\u6204reater\u0380;EFGLST\u0BB6\u0BB7\u0BBD\u0BC9\u0BD3\u0BD8\u0BE5\u626Fqual;\u6271ullEqual;\uC000\u2267\u0338reater;\uC000\u226B\u0338ess;\u6279lantEqual;\uC000\u2A7E\u0338ilde;\u6275ump\u0144\u0BF2\u0BFDownHump;\uC000\u224E\u0338qual;\uC000\u224F\u0338e\u0100fs\u0C0A\u0C27tTriangle\u0180;BE\u0C1A\u0C1B\u0C21\u62EAar;\uC000\u29CF\u0338qual;\u62ECs\u0300;EGLST\u0C35\u0C36\u0C3C\u0C44\u0C4B\u0C58\u626Equal;\u6270reater;\u6278ess;\uC000\u226A\u0338lantEqual;\uC000\u2A7D\u0338ilde;\u6274ested\u0100GL\u0C68\u0C79reaterGreater;\uC000\u2AA2\u0338essLess;\uC000\u2AA1\u0338recedes\u0180;ES\u0C92\u0C93\u0C9B\u6280qual;\uC000\u2AAF\u0338lantEqual;\u62E0\u0100ei\u0CAB\u0CB9verseElement;\u620CghtTriangle\u0180;BE\u0CCB\u0CCC\u0CD2\u62EBar;\uC000\u29D0\u0338qual;\u62ED\u0100qu\u0CDD\u0D0CuareSu\u0100bp\u0CE8\u0CF9set\u0100;E\u0CF0\u0CF3\uC000\u228F\u0338qual;\u62E2erset\u0100;E\u0D03\u0D06\uC000\u2290\u0338qual;\u62E3\u0180bcp\u0D13\u0D24\u0D4Eset\u0100;E\u0D1B\u0D1E\uC000\u2282\u20D2qual;\u6288ceeds\u0200;EST\u0D32\u0D33\u0D3B\u0D46\u6281qual;\uC000\u2AB0\u0338lantEqual;\u62E1ilde;\uC000\u227F\u0338erset\u0100;E\u0D58\u0D5B\uC000\u2283\u20D2qual;\u6289ilde\u0200;EFT\u0D6E\u0D6F\u0D75\u0D7F\u6241qual;\u6244ullEqual;\u6247ilde;\u6249erticalBar;\u6224cr;\uC000\u{1D4A9}ilde\u803B\xD1\u40D1;\u439D\u0700Eacdfgmoprstuv\u0DBD\u0DC2\u0DC9\u0DD5\u0DDB\u0DE0\u0DE7\u0DFC\u0E02\u0E20\u0E22\u0E32\u0E3F\u0E44lig;\u4152cute\u803B\xD3\u40D3\u0100iy\u0DCE\u0DD3rc\u803B\xD4\u40D4;\u441Eblac;\u4150r;\uC000\u{1D512}rave\u803B\xD2\u40D2\u0180aei\u0DEE\u0DF2\u0DF6cr;\u414Cga;\u43A9cron;\u439Fpf;\uC000\u{1D546}enCurly\u0100DQ\u0E0E\u0E1AoubleQuote;\u601Cuote;\u6018;\u6A54\u0100cl\u0E27\u0E2Cr;\uC000\u{1D4AA}ash\u803B\xD8\u40D8i\u016C\u0E37\u0E3Cde\u803B\xD5\u40D5es;\u6A37ml\u803B\xD6\u40D6er\u0100BP\u0E4B\u0E60\u0100ar\u0E50\u0E53r;\u603Eac\u0100ek\u0E5A\u0E5C;\u63DEet;\u63B4arenthesis;\u63DC\u0480acfhilors\u0E7F\u0E87\u0E8A\u0E8F\u0E92\u0E94\u0E9D\u0EB0\u0EFCrtialD;\u6202y;\u441Fr;\uC000\u{1D513}i;\u43A6;\u43A0usMinus;\u40B1\u0100ip\u0EA2\u0EADncareplan\xE5\u069Df;\u6119\u0200;eio\u0EB9\u0EBA\u0EE0\u0EE4\u6ABBcedes\u0200;EST\u0EC8\u0EC9\u0ECF\u0EDA\u627Aqual;\u6AAFlantEqual;\u627Cilde;\u627Eme;\u6033\u0100dp\u0EE9\u0EEEuct;\u620Fortion\u0100;a\u0225\u0EF9l;\u621D\u0100ci\u0F01\u0F06r;\uC000\u{1D4AB};\u43A8\u0200Ufos\u0F11\u0F16\u0F1B\u0F1FOT\u803B"\u4022r;\uC000\u{1D514}pf;\u611Acr;\uC000\u{1D4AC}\u0600BEacefhiorsu\u0F3E\u0F43\u0F47\u0F60\u0F73\u0FA7\u0FAA\u0FAD\u1096\u10A9\u10B4\u10BEarr;\u6910G\u803B\xAE\u40AE\u0180cnr\u0F4E\u0F53\u0F56ute;\u4154g;\u67EBr\u0100;t\u0F5C\u0F5D\u61A0l;\u6916\u0180aey\u0F67\u0F6C\u0F71ron;\u4158dil;\u4156;\u4420\u0100;v\u0F78\u0F79\u611Cerse\u0100EU\u0F82\u0F99\u0100lq\u0F87\u0F8Eement;\u620Builibrium;\u61CBpEquilibrium;\u696Fr\xBB\u0F79o;\u43A1ght\u0400ACDFTUVa\u0FC1\u0FEB\u0FF3\u1022\u1028\u105B\u1087\u03D8\u0100nr\u0FC6\u0FD2gleBracket;\u67E9row\u0180;BL\u0FDC\u0FDD\u0FE1\u6192ar;\u61E5eftArrow;\u61C4eiling;\u6309o\u01F5\u0FF9\0\u1005bleBracket;\u67E7n\u01D4\u100A\0\u1014eeVector;\u695Dector\u0100;B\u101D\u101E\u61C2ar;\u6955loor;\u630B\u0100er\u102D\u1043e\u0180;AV\u1035\u1036\u103C\u62A2rrow;\u61A6ector;\u695Biangle\u0180;BE\u1050\u1051\u1055\u62B3ar;\u69D0qual;\u62B5p\u0180DTV\u1063\u106E\u1078ownVector;\u694FeeVector;\u695Cector\u0100;B\u1082\u1083\u61BEar;\u6954ector\u0100;B\u1091\u1092\u61C0ar;\u6953\u0100pu\u109B\u109Ef;\u611DndImplies;\u6970ightarrow;\u61DB\u0100ch\u10B9\u10BCr;\u611B;\u61B1leDelayed;\u69F4\u0680HOacfhimoqstu\u10E4\u10F1\u10F7\u10FD\u1119\u111E\u1151\u1156\u1161\u1167\u11B5\u11BB\u11BF\u0100Cc\u10E9\u10EEHcy;\u4429y;\u4428FTcy;\u442Ccute;\u415A\u0280;aeiy\u1108\u1109\u110E\u1113\u1117\u6ABCron;\u4160dil;\u415Erc;\u415C;\u4421r;\uC000\u{1D516}ort\u0200DLRU\u112A\u1134\u113E\u1149ownArrow\xBB\u041EeftArrow\xBB\u089AightArrow\xBB\u0FDDpArrow;\u6191gma;\u43A3allCircle;\u6218pf;\uC000\u{1D54A}\u0272\u116D\0\0\u1170t;\u621Aare\u0200;ISU\u117B\u117C\u1189\u11AF\u65A1ntersection;\u6293u\u0100bp\u118F\u119Eset\u0100;E\u1197\u1198\u628Fqual;\u6291erset\u0100;E\u11A8\u11A9\u6290qual;\u6292nion;\u6294cr;\uC000\u{1D4AE}ar;\u62C6\u0200bcmp\u11C8\u11DB\u1209\u120B\u0100;s\u11CD\u11CE\u62D0et\u0100;E\u11CD\u11D5qual;\u6286\u0100ch\u11E0\u1205eeds\u0200;EST\u11ED\u11EE\u11F4\u11FF\u627Bqual;\u6AB0lantEqual;\u627Dilde;\u627FTh\xE1\u0F8C;\u6211\u0180;es\u1212\u1213\u1223\u62D1rset\u0100;E\u121C\u121D\u6283qual;\u6287et\xBB\u1213\u0580HRSacfhiors\u123E\u1244\u1249\u1255\u125E\u1271\u1276\u129F\u12C2\u12C8\u12D1ORN\u803B\xDE\u40DEADE;\u6122\u0100Hc\u124E\u1252cy;\u440By;\u4426\u0100bu\u125A\u125C;\u4009;\u43A4\u0180aey\u1265\u126A\u126Fron;\u4164dil;\u4162;\u4422r;\uC000\u{1D517}\u0100ei\u127B\u1289\u01F2\u1280\0\u1287efore;\u6234a;\u4398\u0100cn\u128E\u1298kSpace;\uC000\u205F\u200ASpace;\u6009lde\u0200;EFT\u12AB\u12AC\u12B2\u12BC\u623Cqual;\u6243ullEqual;\u6245ilde;\u6248pf;\uC000\u{1D54B}ipleDot;\u60DB\u0100ct\u12D6\u12DBr;\uC000\u{1D4AF}rok;\u4166\u0AE1\u12F7\u130E\u131A\u1326\0\u132C\u1331\0\0\0\0\0\u1338\u133D\u1377\u1385\0\u13FF\u1404\u140A\u1410\u0100cr\u12FB\u1301ute\u803B\xDA\u40DAr\u0100;o\u1307\u1308\u619Fcir;\u6949r\u01E3\u1313\0\u1316y;\u440Eve;\u416C\u0100iy\u131E\u1323rc\u803B\xDB\u40DB;\u4423blac;\u4170r;\uC000\u{1D518}rave\u803B\xD9\u40D9acr;\u416A\u0100di\u1341\u1369er\u0100BP\u1348\u135D\u0100ar\u134D\u1350r;\u405Fac\u0100ek\u1357\u1359;\u63DFet;\u63B5arenthesis;\u63DDon\u0100;P\u1370\u1371\u62C3lus;\u628E\u0100gp\u137B\u137Fon;\u4172f;\uC000\u{1D54C}\u0400ADETadps\u1395\u13AE\u13B8\u13C4\u03E8\u13D2\u13D7\u13F3rrow\u0180;BD\u1150\u13A0\u13A4ar;\u6912ownArrow;\u61C5ownArrow;\u6195quilibrium;\u696Eee\u0100;A\u13CB\u13CC\u62A5rrow;\u61A5own\xE1\u03F3er\u0100LR\u13DE\u13E8eftArrow;\u6196ightArrow;\u6197i\u0100;l\u13F9\u13FA\u43D2on;\u43A5ing;\u416Ecr;\uC000\u{1D4B0}ilde;\u4168ml\u803B\xDC\u40DC\u0480Dbcdefosv\u1427\u142C\u1430\u1433\u143E\u1485\u148A\u1490\u1496ash;\u62ABar;\u6AEBy;\u4412ash\u0100;l\u143B\u143C\u62A9;\u6AE6\u0100er\u1443\u1445;\u62C1\u0180bty\u144C\u1450\u147Aar;\u6016\u0100;i\u144F\u1455cal\u0200BLST\u1461\u1465\u146A\u1474ar;\u6223ine;\u407Ceparator;\u6758ilde;\u6240ThinSpace;\u600Ar;\uC000\u{1D519}pf;\uC000\u{1D54D}cr;\uC000\u{1D4B1}dash;\u62AA\u0280cefos\u14A7\u14AC\u14B1\u14B6\u14BCirc;\u4174dge;\u62C0r;\uC000\u{1D51A}pf;\uC000\u{1D54E}cr;\uC000\u{1D4B2}\u0200fios\u14CB\u14D0\u14D2\u14D8r;\uC000\u{1D51B};\u439Epf;\uC000\u{1D54F}cr;\uC000\u{1D4B3}\u0480AIUacfosu\u14F1\u14F5\u14F9\u14FD\u1504\u150F\u1514\u151A\u1520cy;\u442Fcy;\u4407cy;\u442Ecute\u803B\xDD\u40DD\u0100iy\u1509\u150Drc;\u4176;\u442Br;\uC000\u{1D51C}pf;\uC000\u{1D550}cr;\uC000\u{1D4B4}ml;\u4178\u0400Hacdefos\u1535\u1539\u153F\u154B\u154F\u155D\u1560\u1564cy;\u4416cute;\u4179\u0100ay\u1544\u1549ron;\u417D;\u4417ot;\u417B\u01F2\u1554\0\u155BoWidt\xE8\u0AD9a;\u4396r;\u6128pf;\u6124cr;\uC000\u{1D4B5}\u0BE1\u1583\u158A\u1590\0\u15B0\u15B6\u15BF\0\0\0\0\u15C6\u15DB\u15EB\u165F\u166D\0\u1695\u169B\u16B2\u16B9\0\u16BEcute\u803B\xE1\u40E1reve;\u4103\u0300;Ediuy\u159C\u159D\u15A1\u15A3\u15A8\u15AD\u623E;\uC000\u223E\u0333;\u623Frc\u803B\xE2\u40E2te\u80BB\xB4\u0306;\u4430lig\u803B\xE6\u40E6\u0100;r\xB2\u15BA;\uC000\u{1D51E}rave\u803B\xE0\u40E0\u0100ep\u15CA\u15D6\u0100fp\u15CF\u15D4sym;\u6135\xE8\u15D3ha;\u43B1\u0100ap\u15DFc\u0100cl\u15E4\u15E7r;\u4101g;\u6A3F\u0264\u15F0\0\0\u160A\u0280;adsv\u15FA\u15FB\u15FF\u1601\u1607\u6227nd;\u6A55;\u6A5Clope;\u6A58;\u6A5A\u0380;elmrsz\u1618\u1619\u161B\u161E\u163F\u164F\u1659\u6220;\u69A4e\xBB\u1619sd\u0100;a\u1625\u1626\u6221\u0461\u1630\u1632\u1634\u1636\u1638\u163A\u163C\u163E;\u69A8;\u69A9;\u69AA;\u69AB;\u69AC;\u69AD;\u69AE;\u69AFt\u0100;v\u1645\u1646\u621Fb\u0100;d\u164C\u164D\u62BE;\u699D\u0100pt\u1654\u1657h;\u6222\xBB\xB9arr;\u637C\u0100gp\u1663\u1667on;\u4105f;\uC000\u{1D552}\u0380;Eaeiop\u12C1\u167B\u167D\u1682\u1684\u1687\u168A;\u6A70cir;\u6A6F;\u624Ad;\u624Bs;\u4027rox\u0100;e\u12C1\u1692\xF1\u1683ing\u803B\xE5\u40E5\u0180cty\u16A1\u16A6\u16A8r;\uC000\u{1D4B6};\u402Amp\u0100;e\u12C1\u16AF\xF1\u0288ilde\u803B\xE3\u40E3ml\u803B\xE4\u40E4\u0100ci\u16C2\u16C8onin\xF4\u0272nt;\u6A11\u0800Nabcdefiklnoprsu\u16ED\u16F1\u1730\u173C\u1743\u1748\u1778\u177D\u17E0\u17E6\u1839\u1850\u170D\u193D\u1948\u1970ot;\u6AED\u0100cr\u16F6\u171Ek\u0200ceps\u1700\u1705\u170D\u1713ong;\u624Cpsilon;\u43F6rime;\u6035im\u0100;e\u171A\u171B\u623Dq;\u62CD\u0176\u1722\u1726ee;\u62BDed\u0100;g\u172C\u172D\u6305e\xBB\u172Drk\u0100;t\u135C\u1737brk;\u63B6\u0100oy\u1701\u1741;\u4431quo;\u601E\u0280cmprt\u1753\u175B\u1761\u1764\u1768aus\u0100;e\u010A\u0109ptyv;\u69B0s\xE9\u170Cno\xF5\u0113\u0180ahw\u176F\u1771\u1773;\u43B2;\u6136een;\u626Cr;\uC000\u{1D51F}g\u0380costuvw\u178D\u179D\u17B3\u17C1\u17D5\u17DB\u17DE\u0180aiu\u1794\u1796\u179A\xF0\u0760rc;\u65EFp\xBB\u1371\u0180dpt\u17A4\u17A8\u17ADot;\u6A00lus;\u6A01imes;\u6A02\u0271\u17B9\0\0\u17BEcup;\u6A06ar;\u6605riangle\u0100du\u17CD\u17D2own;\u65BDp;\u65B3plus;\u6A04e\xE5\u1444\xE5\u14ADarow;\u690D\u0180ako\u17ED\u1826\u1835\u0100cn\u17F2\u1823k\u0180lst\u17FA\u05AB\u1802ozenge;\u69EBriangle\u0200;dlr\u1812\u1813\u1818\u181D\u65B4own;\u65BEeft;\u65C2ight;\u65B8k;\u6423\u01B1\u182B\0\u1833\u01B2\u182F\0\u1831;\u6592;\u65914;\u6593ck;\u6588\u0100eo\u183E\u184D\u0100;q\u1843\u1846\uC000=\u20E5uiv;\uC000\u2261\u20E5t;\u6310\u0200ptwx\u1859\u185E\u1867\u186Cf;\uC000\u{1D553}\u0100;t\u13CB\u1863om\xBB\u13CCtie;\u62C8\u0600DHUVbdhmptuv\u1885\u1896\u18AA\u18BB\u18D7\u18DB\u18EC\u18FF\u1905\u190A\u1910\u1921\u0200LRlr\u188E\u1890\u1892\u1894;\u6557;\u6554;\u6556;\u6553\u0280;DUdu\u18A1\u18A2\u18A4\u18A6\u18A8\u6550;\u6566;\u6569;\u6564;\u6567\u0200LRlr\u18B3\u18B5\u18B7\u18B9;\u655D;\u655A;\u655C;\u6559\u0380;HLRhlr\u18CA\u18CB\u18CD\u18CF\u18D1\u18D3\u18D5\u6551;\u656C;\u6563;\u6560;\u656B;\u6562;\u655Fox;\u69C9\u0200LRlr\u18E4\u18E6\u18E8\u18EA;\u6555;\u6552;\u6510;\u650C\u0280;DUdu\u06BD\u18F7\u18F9\u18FB\u18FD;\u6565;\u6568;\u652C;\u6534inus;\u629Flus;\u629Eimes;\u62A0\u0200LRlr\u1919\u191B\u191D\u191F;\u655B;\u6558;\u6518;\u6514\u0380;HLRhlr\u1930\u1931\u1933\u1935\u1937\u1939\u193B\u6502;\u656A;\u6561;\u655E;\u653C;\u6524;\u651C\u0100ev\u0123\u1942bar\u803B\xA6\u40A6\u0200ceio\u1951\u1956\u195A\u1960r;\uC000\u{1D4B7}mi;\u604Fm\u0100;e\u171A\u171Cl\u0180;bh\u1968\u1969\u196B\u405C;\u69C5sub;\u67C8\u016C\u1974\u197El\u0100;e\u1979\u197A\u6022t\xBB\u197Ap\u0180;Ee\u012F\u1985\u1987;\u6AAE\u0100;q\u06DC\u06DB\u0CE1\u19A7\0\u19E8\u1A11\u1A15\u1A32\0\u1A37\u1A50\0\0\u1AB4\0\0\u1AC1\0\0\u1B21\u1B2E\u1B4D\u1B52\0\u1BFD\0\u1C0C\u0180cpr\u19AD\u19B2\u19DDute;\u4107\u0300;abcds\u19BF\u19C0\u19C4\u19CA\u19D5\u19D9\u6229nd;\u6A44rcup;\u6A49\u0100au\u19CF\u19D2p;\u6A4Bp;\u6A47ot;\u6A40;\uC000\u2229\uFE00\u0100eo\u19E2\u19E5t;\u6041\xEE\u0693\u0200aeiu\u19F0\u19FB\u1A01\u1A05\u01F0\u19F5\0\u19F8s;\u6A4Don;\u410Ddil\u803B\xE7\u40E7rc;\u4109ps\u0100;s\u1A0C\u1A0D\u6A4Cm;\u6A50ot;\u410B\u0180dmn\u1A1B\u1A20\u1A26il\u80BB\xB8\u01ADptyv;\u69B2t\u8100\xA2;e\u1A2D\u1A2E\u40A2r\xE4\u01B2r;\uC000\u{1D520}\u0180cei\u1A3D\u1A40\u1A4Dy;\u4447ck\u0100;m\u1A47\u1A48\u6713ark\xBB\u1A48;\u43C7r\u0380;Ecefms\u1A5F\u1A60\u1A62\u1A6B\u1AA4\u1AAA\u1AAE\u65CB;\u69C3\u0180;el\u1A69\u1A6A\u1A6D\u42C6q;\u6257e\u0261\u1A74\0\0\u1A88rrow\u0100lr\u1A7C\u1A81eft;\u61BAight;\u61BB\u0280RSacd\u1A92\u1A94\u1A96\u1A9A\u1A9F\xBB\u0F47;\u64C8st;\u629Birc;\u629Aash;\u629Dnint;\u6A10id;\u6AEFcir;\u69C2ubs\u0100;u\u1ABB\u1ABC\u6663it\xBB\u1ABC\u02EC\u1AC7\u1AD4\u1AFA\0\u1B0Aon\u0100;e\u1ACD\u1ACE\u403A\u0100;q\xC7\xC6\u026D\u1AD9\0\0\u1AE2a\u0100;t\u1ADE\u1ADF\u402C;\u4040\u0180;fl\u1AE8\u1AE9\u1AEB\u6201\xEE\u1160e\u0100mx\u1AF1\u1AF6ent\xBB\u1AE9e\xF3\u024D\u01E7\u1AFE\0\u1B07\u0100;d\u12BB\u1B02ot;\u6A6Dn\xF4\u0246\u0180fry\u1B10\u1B14\u1B17;\uC000\u{1D554}o\xE4\u0254\u8100\xA9;s\u0155\u1B1Dr;\u6117\u0100ao\u1B25\u1B29rr;\u61B5ss;\u6717\u0100cu\u1B32\u1B37r;\uC000\u{1D4B8}\u0100bp\u1B3C\u1B44\u0100;e\u1B41\u1B42\u6ACF;\u6AD1\u0100;e\u1B49\u1B4A\u6AD0;\u6AD2dot;\u62EF\u0380delprvw\u1B60\u1B6C\u1B77\u1B82\u1BAC\u1BD4\u1BF9arr\u0100lr\u1B68\u1B6A;\u6938;\u6935\u0270\u1B72\0\0\u1B75r;\u62DEc;\u62DFarr\u0100;p\u1B7F\u1B80\u61B6;\u693D\u0300;bcdos\u1B8F\u1B90\u1B96\u1BA1\u1BA5\u1BA8\u622Arcap;\u6A48\u0100au\u1B9B\u1B9Ep;\u6A46p;\u6A4Aot;\u628Dr;\u6A45;\uC000\u222A\uFE00\u0200alrv\u1BB5\u1BBF\u1BDE\u1BE3rr\u0100;m\u1BBC\u1BBD\u61B7;\u693Cy\u0180evw\u1BC7\u1BD4\u1BD8q\u0270\u1BCE\0\0\u1BD2re\xE3\u1B73u\xE3\u1B75ee;\u62CEedge;\u62CFen\u803B\xA4\u40A4earrow\u0100lr\u1BEE\u1BF3eft\xBB\u1B80ight\xBB\u1BBDe\xE4\u1BDD\u0100ci\u1C01\u1C07onin\xF4\u01F7nt;\u6231lcty;\u632D\u0980AHabcdefhijlorstuwz\u1C38\u1C3B\u1C3F\u1C5D\u1C69\u1C75\u1C8A\u1C9E\u1CAC\u1CB7\u1CFB\u1CFF\u1D0D\u1D7B\u1D91\u1DAB\u1DBB\u1DC6\u1DCDr\xF2\u0381ar;\u6965\u0200glrs\u1C48\u1C4D\u1C52\u1C54ger;\u6020eth;\u6138\xF2\u1133h\u0100;v\u1C5A\u1C5B\u6010\xBB\u090A\u016B\u1C61\u1C67arow;\u690Fa\xE3\u0315\u0100ay\u1C6E\u1C73ron;\u410F;\u4434\u0180;ao\u0332\u1C7C\u1C84\u0100gr\u02BF\u1C81r;\u61CAtseq;\u6A77\u0180glm\u1C91\u1C94\u1C98\u803B\xB0\u40B0ta;\u43B4ptyv;\u69B1\u0100ir\u1CA3\u1CA8sht;\u697F;\uC000\u{1D521}ar\u0100lr\u1CB3\u1CB5\xBB\u08DC\xBB\u101E\u0280aegsv\u1CC2\u0378\u1CD6\u1CDC\u1CE0m\u0180;os\u0326\u1CCA\u1CD4nd\u0100;s\u0326\u1CD1uit;\u6666amma;\u43DDin;\u62F2\u0180;io\u1CE7\u1CE8\u1CF8\u40F7de\u8100\xF7;o\u1CE7\u1CF0ntimes;\u62C7n\xF8\u1CF7cy;\u4452c\u026F\u1D06\0\0\u1D0Arn;\u631Eop;\u630D\u0280lptuw\u1D18\u1D1D\u1D22\u1D49\u1D55lar;\u4024f;\uC000\u{1D555}\u0280;emps\u030B\u1D2D\u1D37\u1D3D\u1D42q\u0100;d\u0352\u1D33ot;\u6251inus;\u6238lus;\u6214quare;\u62A1blebarwedg\xE5\xFAn\u0180adh\u112E\u1D5D\u1D67ownarrow\xF3\u1C83arpoon\u0100lr\u1D72\u1D76ef\xF4\u1CB4igh\xF4\u1CB6\u0162\u1D7F\u1D85karo\xF7\u0F42\u026F\u1D8A\0\0\u1D8Ern;\u631Fop;\u630C\u0180cot\u1D98\u1DA3\u1DA6\u0100ry\u1D9D\u1DA1;\uC000\u{1D4B9};\u4455l;\u69F6rok;\u4111\u0100dr\u1DB0\u1DB4ot;\u62F1i\u0100;f\u1DBA\u1816\u65BF\u0100ah\u1DC0\u1DC3r\xF2\u0429a\xF2\u0FA6angle;\u69A6\u0100ci\u1DD2\u1DD5y;\u445Fgrarr;\u67FF\u0900Dacdefglmnopqrstux\u1E01\u1E09\u1E19\u1E38\u0578\u1E3C\u1E49\u1E61\u1E7E\u1EA5\u1EAF\u1EBD\u1EE1\u1F2A\u1F37\u1F44\u1F4E\u1F5A\u0100Do\u1E06\u1D34o\xF4\u1C89\u0100cs\u1E0E\u1E14ute\u803B\xE9\u40E9ter;\u6A6E\u0200aioy\u1E22\u1E27\u1E31\u1E36ron;\u411Br\u0100;c\u1E2D\u1E2E\u6256\u803B\xEA\u40EAlon;\u6255;\u444Dot;\u4117\u0100Dr\u1E41\u1E45ot;\u6252;\uC000\u{1D522}\u0180;rs\u1E50\u1E51\u1E57\u6A9Aave\u803B\xE8\u40E8\u0100;d\u1E5C\u1E5D\u6A96ot;\u6A98\u0200;ils\u1E6A\u1E6B\u1E72\u1E74\u6A99nters;\u63E7;\u6113\u0100;d\u1E79\u1E7A\u6A95ot;\u6A97\u0180aps\u1E85\u1E89\u1E97cr;\u4113ty\u0180;sv\u1E92\u1E93\u1E95\u6205et\xBB\u1E93p\u01001;\u1E9D\u1EA4\u0133\u1EA1\u1EA3;\u6004;\u6005\u6003\u0100gs\u1EAA\u1EAC;\u414Bp;\u6002\u0100gp\u1EB4\u1EB8on;\u4119f;\uC000\u{1D556}\u0180als\u1EC4\u1ECE\u1ED2r\u0100;s\u1ECA\u1ECB\u62D5l;\u69E3us;\u6A71i\u0180;lv\u1EDA\u1EDB\u1EDF\u43B5on\xBB\u1EDB;\u43F5\u0200csuv\u1EEA\u1EF3\u1F0B\u1F23\u0100io\u1EEF\u1E31rc\xBB\u1E2E\u0269\u1EF9\0\0\u1EFB\xED\u0548ant\u0100gl\u1F02\u1F06tr\xBB\u1E5Dess\xBB\u1E7A\u0180aei\u1F12\u1F16\u1F1Als;\u403Dst;\u625Fv\u0100;D\u0235\u1F20D;\u6A78parsl;\u69E5\u0100Da\u1F2F\u1F33ot;\u6253rr;\u6971\u0180cdi\u1F3E\u1F41\u1EF8r;\u612Fo\xF4\u0352\u0100ah\u1F49\u1F4B;\u43B7\u803B\xF0\u40F0\u0100mr\u1F53\u1F57l\u803B\xEB\u40EBo;\u60AC\u0180cip\u1F61\u1F64\u1F67l;\u4021s\xF4\u056E\u0100eo\u1F6C\u1F74ctatio\xEE\u0559nential\xE5\u0579\u09E1\u1F92\0\u1F9E\0\u1FA1\u1FA7\0\0\u1FC6\u1FCC\0\u1FD3\0\u1FE6\u1FEA\u2000\0\u2008\u205Allingdotse\xF1\u1E44y;\u4444male;\u6640\u0180ilr\u1FAD\u1FB3\u1FC1lig;\u8000\uFB03\u0269\u1FB9\0\0\u1FBDg;\u8000\uFB00ig;\u8000\uFB04;\uC000\u{1D523}lig;\u8000\uFB01lig;\uC000fj\u0180alt\u1FD9\u1FDC\u1FE1t;\u666Dig;\u8000\uFB02ns;\u65B1of;\u4192\u01F0\u1FEE\0\u1FF3f;\uC000\u{1D557}\u0100ak\u05BF\u1FF7\u0100;v\u1FFC\u1FFD\u62D4;\u6AD9artint;\u6A0D\u0100ao\u200C\u2055\u0100cs\u2011\u2052\u03B1\u201A\u2030\u2038\u2045\u2048\0\u2050\u03B2\u2022\u2025\u2027\u202A\u202C\0\u202E\u803B\xBD\u40BD;\u6153\u803B\xBC\u40BC;\u6155;\u6159;\u615B\u01B3\u2034\0\u2036;\u6154;\u6156\u02B4\u203E\u2041\0\0\u2043\u803B\xBE\u40BE;\u6157;\u615C5;\u6158\u01B6\u204C\0\u204E;\u615A;\u615D8;\u615El;\u6044wn;\u6322cr;\uC000\u{1D4BB}\u0880Eabcdefgijlnorstv\u2082\u2089\u209F\u20A5\u20B0\u20B4\u20F0\u20F5\u20FA\u20FF\u2103\u2112\u2138\u0317\u213E\u2152\u219E\u0100;l\u064D\u2087;\u6A8C\u0180cmp\u2090\u2095\u209Dute;\u41F5ma\u0100;d\u209C\u1CDA\u43B3;\u6A86reve;\u411F\u0100iy\u20AA\u20AErc;\u411D;\u4433ot;\u4121\u0200;lqs\u063E\u0642\u20BD\u20C9\u0180;qs\u063E\u064C\u20C4lan\xF4\u0665\u0200;cdl\u0665\u20D2\u20D5\u20E5c;\u6AA9ot\u0100;o\u20DC\u20DD\u6A80\u0100;l\u20E2\u20E3\u6A82;\u6A84\u0100;e\u20EA\u20ED\uC000\u22DB\uFE00s;\u6A94r;\uC000\u{1D524}\u0100;g\u0673\u061Bmel;\u6137cy;\u4453\u0200;Eaj\u065A\u210C\u210E\u2110;\u6A92;\u6AA5;\u6AA4\u0200Eaes\u211B\u211D\u2129\u2134;\u6269p\u0100;p\u2123\u2124\u6A8Arox\xBB\u2124\u0100;q\u212E\u212F\u6A88\u0100;q\u212E\u211Bim;\u62E7pf;\uC000\u{1D558}\u0100ci\u2143\u2146r;\u610Am\u0180;el\u066B\u214E\u2150;\u6A8E;\u6A90\u8300>;cdlqr\u05EE\u2160\u216A\u216E\u2173\u2179\u0100ci\u2165\u2167;\u6AA7r;\u6A7Aot;\u62D7Par;\u6995uest;\u6A7C\u0280adels\u2184\u216A\u2190\u0656\u219B\u01F0\u2189\0\u218Epro\xF8\u209Er;\u6978q\u0100lq\u063F\u2196les\xF3\u2088i\xED\u066B\u0100en\u21A3\u21ADrtneqq;\uC000\u2269\uFE00\xC5\u21AA\u0500Aabcefkosy\u21C4\u21C7\u21F1\u21F5\u21FA\u2218\u221D\u222F\u2268\u227Dr\xF2\u03A0\u0200ilmr\u21D0\u21D4\u21D7\u21DBrs\xF0\u1484f\xBB\u2024il\xF4\u06A9\u0100dr\u21E0\u21E4cy;\u444A\u0180;cw\u08F4\u21EB\u21EFir;\u6948;\u61ADar;\u610Firc;\u4125\u0180alr\u2201\u220E\u2213rts\u0100;u\u2209\u220A\u6665it\xBB\u220Alip;\u6026con;\u62B9r;\uC000\u{1D525}s\u0100ew\u2223\u2229arow;\u6925arow;\u6926\u0280amopr\u223A\u223E\u2243\u225E\u2263rr;\u61FFtht;\u623Bk\u0100lr\u2249\u2253eftarrow;\u61A9ightarrow;\u61AAf;\uC000\u{1D559}bar;\u6015\u0180clt\u226F\u2274\u2278r;\uC000\u{1D4BD}as\xE8\u21F4rok;\u4127\u0100bp\u2282\u2287ull;\u6043hen\xBB\u1C5B\u0AE1\u22A3\0\u22AA\0\u22B8\u22C5\u22CE\0\u22D5\u22F3\0\0\u22F8\u2322\u2367\u2362\u237F\0\u2386\u23AA\u23B4cute\u803B\xED\u40ED\u0180;iy\u0771\u22B0\u22B5rc\u803B\xEE\u40EE;\u4438\u0100cx\u22BC\u22BFy;\u4435cl\u803B\xA1\u40A1\u0100fr\u039F\u22C9;\uC000\u{1D526}rave\u803B\xEC\u40EC\u0200;ino\u073E\u22DD\u22E9\u22EE\u0100in\u22E2\u22E6nt;\u6A0Ct;\u622Dfin;\u69DCta;\u6129lig;\u4133\u0180aop\u22FE\u231A\u231D\u0180cgt\u2305\u2308\u2317r;\u412B\u0180elp\u071F\u230F\u2313in\xE5\u078Ear\xF4\u0720h;\u4131f;\u62B7ed;\u41B5\u0280;cfot\u04F4\u232C\u2331\u233D\u2341are;\u6105in\u0100;t\u2338\u2339\u621Eie;\u69DDdo\xF4\u2319\u0280;celp\u0757\u234C\u2350\u235B\u2361al;\u62BA\u0100gr\u2355\u2359er\xF3\u1563\xE3\u234Darhk;\u6A17rod;\u6A3C\u0200cgpt\u236F\u2372\u2376\u237By;\u4451on;\u412Ff;\uC000\u{1D55A}a;\u43B9uest\u803B\xBF\u40BF\u0100ci\u238A\u238Fr;\uC000\u{1D4BE}n\u0280;Edsv\u04F4\u239B\u239D\u23A1\u04F3;\u62F9ot;\u62F5\u0100;v\u23A6\u23A7\u62F4;\u62F3\u0100;i\u0777\u23AElde;\u4129\u01EB\u23B8\0\u23BCcy;\u4456l\u803B\xEF\u40EF\u0300cfmosu\u23CC\u23D7\u23DC\u23E1\u23E7\u23F5\u0100iy\u23D1\u23D5rc;\u4135;\u4439r;\uC000\u{1D527}ath;\u4237pf;\uC000\u{1D55B}\u01E3\u23EC\0\u23F1r;\uC000\u{1D4BF}rcy;\u4458kcy;\u4454\u0400acfghjos\u240B\u2416\u2422\u2427\u242D\u2431\u2435\u243Bppa\u0100;v\u2413\u2414\u43BA;\u43F0\u0100ey\u241B\u2420dil;\u4137;\u443Ar;\uC000\u{1D528}reen;\u4138cy;\u4445cy;\u445Cpf;\uC000\u{1D55C}cr;\uC000\u{1D4C0}\u0B80ABEHabcdefghjlmnoprstuv\u2470\u2481\u2486\u248D\u2491\u250E\u253D\u255A\u2580\u264E\u265E\u2665\u2679\u267D\u269A\u26B2\u26D8\u275D\u2768\u278B\u27C0\u2801\u2812\u0180art\u2477\u247A\u247Cr\xF2\u09C6\xF2\u0395ail;\u691Barr;\u690E\u0100;g\u0994\u248B;\u6A8Bar;\u6962\u0963\u24A5\0\u24AA\0\u24B1\0\0\0\0\0\u24B5\u24BA\0\u24C6\u24C8\u24CD\0\u24F9ute;\u413Amptyv;\u69B4ra\xEE\u084Cbda;\u43BBg\u0180;dl\u088E\u24C1\u24C3;\u6991\xE5\u088E;\u6A85uo\u803B\xAB\u40ABr\u0400;bfhlpst\u0899\u24DE\u24E6\u24E9\u24EB\u24EE\u24F1\u24F5\u0100;f\u089D\u24E3s;\u691Fs;\u691D\xEB\u2252p;\u61ABl;\u6939im;\u6973l;\u61A2\u0180;ae\u24FF\u2500\u2504\u6AABil;\u6919\u0100;s\u2509\u250A\u6AAD;\uC000\u2AAD\uFE00\u0180abr\u2515\u2519\u251Drr;\u690Crk;\u6772\u0100ak\u2522\u252Cc\u0100ek\u2528\u252A;\u407B;\u405B\u0100es\u2531\u2533;\u698Bl\u0100du\u2539\u253B;\u698F;\u698D\u0200aeuy\u2546\u254B\u2556\u2558ron;\u413E\u0100di\u2550\u2554il;\u413C\xEC\u08B0\xE2\u2529;\u443B\u0200cqrs\u2563\u2566\u256D\u257Da;\u6936uo\u0100;r\u0E19\u1746\u0100du\u2572\u2577har;\u6967shar;\u694Bh;\u61B2\u0280;fgqs\u258B\u258C\u0989\u25F3\u25FF\u6264t\u0280ahlrt\u2598\u25A4\u25B7\u25C2\u25E8rrow\u0100;t\u0899\u25A1a\xE9\u24F6arpoon\u0100du\u25AF\u25B4own\xBB\u045Ap\xBB\u0966eftarrows;\u61C7ight\u0180ahs\u25CD\u25D6\u25DErrow\u0100;s\u08F4\u08A7arpoon\xF3\u0F98quigarro\xF7\u21F0hreetimes;\u62CB\u0180;qs\u258B\u0993\u25FAlan\xF4\u09AC\u0280;cdgs\u09AC\u260A\u260D\u261D\u2628c;\u6AA8ot\u0100;o\u2614\u2615\u6A7F\u0100;r\u261A\u261B\u6A81;\u6A83\u0100;e\u2622\u2625\uC000\u22DA\uFE00s;\u6A93\u0280adegs\u2633\u2639\u263D\u2649\u264Bppro\xF8\u24C6ot;\u62D6q\u0100gq\u2643\u2645\xF4\u0989gt\xF2\u248C\xF4\u099Bi\xED\u09B2\u0180ilr\u2655\u08E1\u265Asht;\u697C;\uC000\u{1D529}\u0100;E\u099C\u2663;\u6A91\u0161\u2669\u2676r\u0100du\u25B2\u266E\u0100;l\u0965\u2673;\u696Alk;\u6584cy;\u4459\u0280;acht\u0A48\u2688\u268B\u2691\u2696r\xF2\u25C1orne\xF2\u1D08ard;\u696Bri;\u65FA\u0100io\u269F\u26A4dot;\u4140ust\u0100;a\u26AC\u26AD\u63B0che\xBB\u26AD\u0200Eaes\u26BB\u26BD\u26C9\u26D4;\u6268p\u0100;p\u26C3\u26C4\u6A89rox\xBB\u26C4\u0100;q\u26CE\u26CF\u6A87\u0100;q\u26CE\u26BBim;\u62E6\u0400abnoptwz\u26E9\u26F4\u26F7\u271A\u272F\u2741\u2747\u2750\u0100nr\u26EE\u26F1g;\u67ECr;\u61FDr\xEB\u08C1g\u0180lmr\u26FF\u270D\u2714eft\u0100ar\u09E6\u2707ight\xE1\u09F2apsto;\u67FCight\xE1\u09FDparrow\u0100lr\u2725\u2729ef\xF4\u24EDight;\u61AC\u0180afl\u2736\u2739\u273Dr;\u6985;\uC000\u{1D55D}us;\u6A2Dimes;\u6A34\u0161\u274B\u274Fst;\u6217\xE1\u134E\u0180;ef\u2757\u2758\u1800\u65CAnge\xBB\u2758ar\u0100;l\u2764\u2765\u4028t;\u6993\u0280achmt\u2773\u2776\u277C\u2785\u2787r\xF2\u08A8orne\xF2\u1D8Car\u0100;d\u0F98\u2783;\u696D;\u600Eri;\u62BF\u0300achiqt\u2798\u279D\u0A40\u27A2\u27AE\u27BBquo;\u6039r;\uC000\u{1D4C1}m\u0180;eg\u09B2\u27AA\u27AC;\u6A8D;\u6A8F\u0100bu\u252A\u27B3o\u0100;r\u0E1F\u27B9;\u601Arok;\u4142\u8400<;cdhilqr\u082B\u27D2\u2639\u27DC\u27E0\u27E5\u27EA\u27F0\u0100ci\u27D7\u27D9;\u6AA6r;\u6A79re\xE5\u25F2mes;\u62C9arr;\u6976uest;\u6A7B\u0100Pi\u27F5\u27F9ar;\u6996\u0180;ef\u2800\u092D\u181B\u65C3r\u0100du\u2807\u280Dshar;\u694Ahar;\u6966\u0100en\u2817\u2821rtneqq;\uC000\u2268\uFE00\xC5\u281E\u0700Dacdefhilnopsu\u2840\u2845\u2882\u288E\u2893\u28A0\u28A5\u28A8\u28DA\u28E2\u28E4\u0A83\u28F3\u2902Dot;\u623A\u0200clpr\u284E\u2852\u2863\u287Dr\u803B\xAF\u40AF\u0100et\u2857\u2859;\u6642\u0100;e\u285E\u285F\u6720se\xBB\u285F\u0100;s\u103B\u2868to\u0200;dlu\u103B\u2873\u2877\u287Bow\xEE\u048Cef\xF4\u090F\xF0\u13D1ker;\u65AE\u0100oy\u2887\u288Cmma;\u6A29;\u443Cash;\u6014asuredangle\xBB\u1626r;\uC000\u{1D52A}o;\u6127\u0180cdn\u28AF\u28B4\u28C9ro\u803B\xB5\u40B5\u0200;acd\u1464\u28BD\u28C0\u28C4s\xF4\u16A7ir;\u6AF0ot\u80BB\xB7\u01B5us\u0180;bd\u28D2\u1903\u28D3\u6212\u0100;u\u1D3C\u28D8;\u6A2A\u0163\u28DE\u28E1p;\u6ADB\xF2\u2212\xF0\u0A81\u0100dp\u28E9\u28EEels;\u62A7f;\uC000\u{1D55E}\u0100ct\u28F8\u28FDr;\uC000\u{1D4C2}pos\xBB\u159D\u0180;lm\u2909\u290A\u290D\u43BCtimap;\u62B8\u0C00GLRVabcdefghijlmoprstuvw\u2942\u2953\u297E\u2989\u2998\u29DA\u29E9\u2A15\u2A1A\u2A58\u2A5D\u2A83\u2A95\u2AA4\u2AA8\u2B04\u2B07\u2B44\u2B7F\u2BAE\u2C34\u2C67\u2C7C\u2CE9\u0100gt\u2947\u294B;\uC000\u22D9\u0338\u0100;v\u2950\u0BCF\uC000\u226B\u20D2\u0180elt\u295A\u2972\u2976ft\u0100ar\u2961\u2967rrow;\u61CDightarrow;\u61CE;\uC000\u22D8\u0338\u0100;v\u297B\u0C47\uC000\u226A\u20D2ightarrow;\u61CF\u0100Dd\u298E\u2993ash;\u62AFash;\u62AE\u0280bcnpt\u29A3\u29A7\u29AC\u29B1\u29CCla\xBB\u02DEute;\u4144g;\uC000\u2220\u20D2\u0280;Eiop\u0D84\u29BC\u29C0\u29C5\u29C8;\uC000\u2A70\u0338d;\uC000\u224B\u0338s;\u4149ro\xF8\u0D84ur\u0100;a\u29D3\u29D4\u666El\u0100;s\u29D3\u0B38\u01F3\u29DF\0\u29E3p\u80BB\xA0\u0B37mp\u0100;e\u0BF9\u0C00\u0280aeouy\u29F4\u29FE\u2A03\u2A10\u2A13\u01F0\u29F9\0\u29FB;\u6A43on;\u4148dil;\u4146ng\u0100;d\u0D7E\u2A0Aot;\uC000\u2A6D\u0338p;\u6A42;\u443Dash;\u6013\u0380;Aadqsx\u0B92\u2A29\u2A2D\u2A3B\u2A41\u2A45\u2A50rr;\u61D7r\u0100hr\u2A33\u2A36k;\u6924\u0100;o\u13F2\u13F0ot;\uC000\u2250\u0338ui\xF6\u0B63\u0100ei\u2A4A\u2A4Ear;\u6928\xED\u0B98ist\u0100;s\u0BA0\u0B9Fr;\uC000\u{1D52B}\u0200Eest\u0BC5\u2A66\u2A79\u2A7C\u0180;qs\u0BBC\u2A6D\u0BE1\u0180;qs\u0BBC\u0BC5\u2A74lan\xF4\u0BE2i\xED\u0BEA\u0100;r\u0BB6\u2A81\xBB\u0BB7\u0180Aap\u2A8A\u2A8D\u2A91r\xF2\u2971rr;\u61AEar;\u6AF2\u0180;sv\u0F8D\u2A9C\u0F8C\u0100;d\u2AA1\u2AA2\u62FC;\u62FAcy;\u445A\u0380AEadest\u2AB7\u2ABA\u2ABE\u2AC2\u2AC5\u2AF6\u2AF9r\xF2\u2966;\uC000\u2266\u0338rr;\u619Ar;\u6025\u0200;fqs\u0C3B\u2ACE\u2AE3\u2AEFt\u0100ar\u2AD4\u2AD9rro\xF7\u2AC1ightarro\xF7\u2A90\u0180;qs\u0C3B\u2ABA\u2AEAlan\xF4\u0C55\u0100;s\u0C55\u2AF4\xBB\u0C36i\xED\u0C5D\u0100;r\u0C35\u2AFEi\u0100;e\u0C1A\u0C25i\xE4\u0D90\u0100pt\u2B0C\u2B11f;\uC000\u{1D55F}\u8180\xAC;in\u2B19\u2B1A\u2B36\u40ACn\u0200;Edv\u0B89\u2B24\u2B28\u2B2E;\uC000\u22F9\u0338ot;\uC000\u22F5\u0338\u01E1\u0B89\u2B33\u2B35;\u62F7;\u62F6i\u0100;v\u0CB8\u2B3C\u01E1\u0CB8\u2B41\u2B43;\u62FE;\u62FD\u0180aor\u2B4B\u2B63\u2B69r\u0200;ast\u0B7B\u2B55\u2B5A\u2B5Flle\xEC\u0B7Bl;\uC000\u2AFD\u20E5;\uC000\u2202\u0338lint;\u6A14\u0180;ce\u0C92\u2B70\u2B73u\xE5\u0CA5\u0100;c\u0C98\u2B78\u0100;e\u0C92\u2B7D\xF1\u0C98\u0200Aait\u2B88\u2B8B\u2B9D\u2BA7r\xF2\u2988rr\u0180;cw\u2B94\u2B95\u2B99\u619B;\uC000\u2933\u0338;\uC000\u219D\u0338ghtarrow\xBB\u2B95ri\u0100;e\u0CCB\u0CD6\u0380chimpqu\u2BBD\u2BCD\u2BD9\u2B04\u0B78\u2BE4\u2BEF\u0200;cer\u0D32\u2BC6\u0D37\u2BC9u\xE5\u0D45;\uC000\u{1D4C3}ort\u026D\u2B05\0\0\u2BD6ar\xE1\u2B56m\u0100;e\u0D6E\u2BDF\u0100;q\u0D74\u0D73su\u0100bp\u2BEB\u2BED\xE5\u0CF8\xE5\u0D0B\u0180bcp\u2BF6\u2C11\u2C19\u0200;Ees\u2BFF\u2C00\u0D22\u2C04\u6284;\uC000\u2AC5\u0338et\u0100;e\u0D1B\u2C0Bq\u0100;q\u0D23\u2C00c\u0100;e\u0D32\u2C17\xF1\u0D38\u0200;Ees\u2C22\u2C23\u0D5F\u2C27\u6285;\uC000\u2AC6\u0338et\u0100;e\u0D58\u2C2Eq\u0100;q\u0D60\u2C23\u0200gilr\u2C3D\u2C3F\u2C45\u2C47\xEC\u0BD7lde\u803B\xF1\u40F1\xE7\u0C43iangle\u0100lr\u2C52\u2C5Ceft\u0100;e\u0C1A\u2C5A\xF1\u0C26ight\u0100;e\u0CCB\u2C65\xF1\u0CD7\u0100;m\u2C6C\u2C6D\u43BD\u0180;es\u2C74\u2C75\u2C79\u4023ro;\u6116p;\u6007\u0480DHadgilrs\u2C8F\u2C94\u2C99\u2C9E\u2CA3\u2CB0\u2CB6\u2CD3\u2CE3ash;\u62ADarr;\u6904p;\uC000\u224D\u20D2ash;\u62AC\u0100et\u2CA8\u2CAC;\uC000\u2265\u20D2;\uC000>\u20D2nfin;\u69DE\u0180Aet\u2CBD\u2CC1\u2CC5rr;\u6902;\uC000\u2264\u20D2\u0100;r\u2CCA\u2CCD\uC000<\u20D2ie;\uC000\u22B4\u20D2\u0100At\u2CD8\u2CDCrr;\u6903rie;\uC000\u22B5\u20D2im;\uC000\u223C\u20D2\u0180Aan\u2CF0\u2CF4\u2D02rr;\u61D6r\u0100hr\u2CFA\u2CFDk;\u6923\u0100;o\u13E7\u13E5ear;\u6927\u1253\u1A95\0\0\0\0\0\0\0\0\0\0\0\0\0\u2D2D\0\u2D38\u2D48\u2D60\u2D65\u2D72\u2D84\u1B07\0\0\u2D8D\u2DAB\0\u2DC8\u2DCE\0\u2DDC\u2E19\u2E2B\u2E3E\u2E43\u0100cs\u2D31\u1A97ute\u803B\xF3\u40F3\u0100iy\u2D3C\u2D45r\u0100;c\u1A9E\u2D42\u803B\xF4\u40F4;\u443E\u0280abios\u1AA0\u2D52\u2D57\u01C8\u2D5Alac;\u4151v;\u6A38old;\u69BClig;\u4153\u0100cr\u2D69\u2D6Dir;\u69BF;\uC000\u{1D52C}\u036F\u2D79\0\0\u2D7C\0\u2D82n;\u42DBave\u803B\xF2\u40F2;\u69C1\u0100bm\u2D88\u0DF4ar;\u69B5\u0200acit\u2D95\u2D98\u2DA5\u2DA8r\xF2\u1A80\u0100ir\u2D9D\u2DA0r;\u69BEoss;\u69BBn\xE5\u0E52;\u69C0\u0180aei\u2DB1\u2DB5\u2DB9cr;\u414Dga;\u43C9\u0180cdn\u2DC0\u2DC5\u01CDron;\u43BF;\u69B6pf;\uC000\u{1D560}\u0180ael\u2DD4\u2DD7\u01D2r;\u69B7rp;\u69B9\u0380;adiosv\u2DEA\u2DEB\u2DEE\u2E08\u2E0D\u2E10\u2E16\u6228r\xF2\u1A86\u0200;efm\u2DF7\u2DF8\u2E02\u2E05\u6A5Dr\u0100;o\u2DFE\u2DFF\u6134f\xBB\u2DFF\u803B\xAA\u40AA\u803B\xBA\u40BAgof;\u62B6r;\u6A56lope;\u6A57;\u6A5B\u0180clo\u2E1F\u2E21\u2E27\xF2\u2E01ash\u803B\xF8\u40F8l;\u6298i\u016C\u2E2F\u2E34de\u803B\xF5\u40F5es\u0100;a\u01DB\u2E3As;\u6A36ml\u803B\xF6\u40F6bar;\u633D\u0AE1\u2E5E\0\u2E7D\0\u2E80\u2E9D\0\u2EA2\u2EB9\0\0\u2ECB\u0E9C\0\u2F13\0\0\u2F2B\u2FBC\0\u2FC8r\u0200;ast\u0403\u2E67\u2E72\u0E85\u8100\xB6;l\u2E6D\u2E6E\u40B6le\xEC\u0403\u0269\u2E78\0\0\u2E7Bm;\u6AF3;\u6AFDy;\u443Fr\u0280cimpt\u2E8B\u2E8F\u2E93\u1865\u2E97nt;\u4025od;\u402Eil;\u6030enk;\u6031r;\uC000\u{1D52D}\u0180imo\u2EA8\u2EB0\u2EB4\u0100;v\u2EAD\u2EAE\u43C6;\u43D5ma\xF4\u0A76ne;\u660E\u0180;tv\u2EBF\u2EC0\u2EC8\u43C0chfork\xBB\u1FFD;\u43D6\u0100au\u2ECF\u2EDFn\u0100ck\u2ED5\u2EDDk\u0100;h\u21F4\u2EDB;\u610E\xF6\u21F4s\u0480;abcdemst\u2EF3\u2EF4\u1908\u2EF9\u2EFD\u2F04\u2F06\u2F0A\u2F0E\u402Bcir;\u6A23ir;\u6A22\u0100ou\u1D40\u2F02;\u6A25;\u6A72n\u80BB\xB1\u0E9Dim;\u6A26wo;\u6A27\u0180ipu\u2F19\u2F20\u2F25ntint;\u6A15f;\uC000\u{1D561}nd\u803B\xA3\u40A3\u0500;Eaceinosu\u0EC8\u2F3F\u2F41\u2F44\u2F47\u2F81\u2F89\u2F92\u2F7E\u2FB6;\u6AB3p;\u6AB7u\xE5\u0ED9\u0100;c\u0ECE\u2F4C\u0300;acens\u0EC8\u2F59\u2F5F\u2F66\u2F68\u2F7Eppro\xF8\u2F43urlye\xF1\u0ED9\xF1\u0ECE\u0180aes\u2F6F\u2F76\u2F7Approx;\u6AB9qq;\u6AB5im;\u62E8i\xED\u0EDFme\u0100;s\u2F88\u0EAE\u6032\u0180Eas\u2F78\u2F90\u2F7A\xF0\u2F75\u0180dfp\u0EEC\u2F99\u2FAF\u0180als\u2FA0\u2FA5\u2FAAlar;\u632Eine;\u6312urf;\u6313\u0100;t\u0EFB\u2FB4\xEF\u0EFBrel;\u62B0\u0100ci\u2FC0\u2FC5r;\uC000\u{1D4C5};\u43C8ncsp;\u6008\u0300fiopsu\u2FDA\u22E2\u2FDF\u2FE5\u2FEB\u2FF1r;\uC000\u{1D52E}pf;\uC000\u{1D562}rime;\u6057cr;\uC000\u{1D4C6}\u0180aeo\u2FF8\u3009\u3013t\u0100ei\u2FFE\u3005rnion\xF3\u06B0nt;\u6A16st\u0100;e\u3010\u3011\u403F\xF1\u1F19\xF4\u0F14\u0A80ABHabcdefhilmnoprstux\u3040\u3051\u3055\u3059\u30E0\u310E\u312B\u3147\u3162\u3172\u318E\u3206\u3215\u3224\u3229\u3258\u326E\u3272\u3290\u32B0\u32B7\u0180art\u3047\u304A\u304Cr\xF2\u10B3\xF2\u03DDail;\u691Car\xF2\u1C65ar;\u6964\u0380cdenqrt\u3068\u3075\u3078\u307F\u308F\u3094\u30CC\u0100eu\u306D\u3071;\uC000\u223D\u0331te;\u4155i\xE3\u116Emptyv;\u69B3g\u0200;del\u0FD1\u3089\u308B\u308D;\u6992;\u69A5\xE5\u0FD1uo\u803B\xBB\u40BBr\u0580;abcfhlpstw\u0FDC\u30AC\u30AF\u30B7\u30B9\u30BC\u30BE\u30C0\u30C3\u30C7\u30CAp;\u6975\u0100;f\u0FE0\u30B4s;\u6920;\u6933s;\u691E\xEB\u225D\xF0\u272El;\u6945im;\u6974l;\u61A3;\u619D\u0100ai\u30D1\u30D5il;\u691Ao\u0100;n\u30DB\u30DC\u6236al\xF3\u0F1E\u0180abr\u30E7\u30EA\u30EEr\xF2\u17E5rk;\u6773\u0100ak\u30F3\u30FDc\u0100ek\u30F9\u30FB;\u407D;\u405D\u0100es\u3102\u3104;\u698Cl\u0100du\u310A\u310C;\u698E;\u6990\u0200aeuy\u3117\u311C\u3127\u3129ron;\u4159\u0100di\u3121\u3125il;\u4157\xEC\u0FF2\xE2\u30FA;\u4440\u0200clqs\u3134\u3137\u313D\u3144a;\u6937dhar;\u6969uo\u0100;r\u020E\u020Dh;\u61B3\u0180acg\u314E\u315F\u0F44l\u0200;ips\u0F78\u3158\u315B\u109Cn\xE5\u10BBar\xF4\u0FA9t;\u65AD\u0180ilr\u3169\u1023\u316Esht;\u697D;\uC000\u{1D52F}\u0100ao\u3177\u3186r\u0100du\u317D\u317F\xBB\u047B\u0100;l\u1091\u3184;\u696C\u0100;v\u318B\u318C\u43C1;\u43F1\u0180gns\u3195\u31F9\u31FCht\u0300ahlrst\u31A4\u31B0\u31C2\u31D8\u31E4\u31EErrow\u0100;t\u0FDC\u31ADa\xE9\u30C8arpoon\u0100du\u31BB\u31BFow\xEE\u317Ep\xBB\u1092eft\u0100ah\u31CA\u31D0rrow\xF3\u0FEAarpoon\xF3\u0551ightarrows;\u61C9quigarro\xF7\u30CBhreetimes;\u62CCg;\u42DAingdotse\xF1\u1F32\u0180ahm\u320D\u3210\u3213r\xF2\u0FEAa\xF2\u0551;\u600Foust\u0100;a\u321E\u321F\u63B1che\xBB\u321Fmid;\u6AEE\u0200abpt\u3232\u323D\u3240\u3252\u0100nr\u3237\u323Ag;\u67EDr;\u61FEr\xEB\u1003\u0180afl\u3247\u324A\u324Er;\u6986;\uC000\u{1D563}us;\u6A2Eimes;\u6A35\u0100ap\u325D\u3267r\u0100;g\u3263\u3264\u4029t;\u6994olint;\u6A12ar\xF2\u31E3\u0200achq\u327B\u3280\u10BC\u3285quo;\u603Ar;\uC000\u{1D4C7}\u0100bu\u30FB\u328Ao\u0100;r\u0214\u0213\u0180hir\u3297\u329B\u32A0re\xE5\u31F8mes;\u62CAi\u0200;efl\u32AA\u1059\u1821\u32AB\u65B9tri;\u69CEluhar;\u6968;\u611E\u0D61\u32D5\u32DB\u32DF\u332C\u3338\u3371\0\u337A\u33A4\0\0\u33EC\u33F0\0\u3428\u3448\u345A\u34AD\u34B1\u34CA\u34F1\0\u3616\0\0\u3633cute;\u415Bqu\xEF\u27BA\u0500;Eaceinpsy\u11ED\u32F3\u32F5\u32FF\u3302\u330B\u330F\u331F\u3326\u3329;\u6AB4\u01F0\u32FA\0\u32FC;\u6AB8on;\u4161u\xE5\u11FE\u0100;d\u11F3\u3307il;\u415Frc;\u415D\u0180Eas\u3316\u3318\u331B;\u6AB6p;\u6ABAim;\u62E9olint;\u6A13i\xED\u1204;\u4441ot\u0180;be\u3334\u1D47\u3335\u62C5;\u6A66\u0380Aacmstx\u3346\u334A\u3357\u335B\u335E\u3363\u336Drr;\u61D8r\u0100hr\u3350\u3352\xEB\u2228\u0100;o\u0A36\u0A34t\u803B\xA7\u40A7i;\u403Bwar;\u6929m\u0100in\u3369\xF0nu\xF3\xF1t;\u6736r\u0100;o\u3376\u2055\uC000\u{1D530}\u0200acoy\u3382\u3386\u3391\u33A0rp;\u666F\u0100hy\u338B\u338Fcy;\u4449;\u4448rt\u026D\u3399\0\0\u339Ci\xE4\u1464ara\xEC\u2E6F\u803B\xAD\u40AD\u0100gm\u33A8\u33B4ma\u0180;fv\u33B1\u33B2\u33B2\u43C3;\u43C2\u0400;deglnpr\u12AB\u33C5\u33C9\u33CE\u33D6\u33DE\u33E1\u33E6ot;\u6A6A\u0100;q\u12B1\u12B0\u0100;E\u33D3\u33D4\u6A9E;\u6AA0\u0100;E\u33DB\u33DC\u6A9D;\u6A9Fe;\u6246lus;\u6A24arr;\u6972ar\xF2\u113D\u0200aeit\u33F8\u3408\u340F\u3417\u0100ls\u33FD\u3404lsetm\xE9\u336Ahp;\u6A33parsl;\u69E4\u0100dl\u1463\u3414e;\u6323\u0100;e\u341C\u341D\u6AAA\u0100;s\u3422\u3423\u6AAC;\uC000\u2AAC\uFE00\u0180flp\u342E\u3433\u3442tcy;\u444C\u0100;b\u3438\u3439\u402F\u0100;a\u343E\u343F\u69C4r;\u633Ff;\uC000\u{1D564}a\u0100dr\u344D\u0402es\u0100;u\u3454\u3455\u6660it\xBB\u3455\u0180csu\u3460\u3479\u349F\u0100au\u3465\u346Fp\u0100;s\u1188\u346B;\uC000\u2293\uFE00p\u0100;s\u11B4\u3475;\uC000\u2294\uFE00u\u0100bp\u347F\u348F\u0180;es\u1197\u119C\u3486et\u0100;e\u1197\u348D\xF1\u119D\u0180;es\u11A8\u11AD\u3496et\u0100;e\u11A8\u349D\xF1\u11AE\u0180;af\u117B\u34A6\u05B0r\u0165\u34AB\u05B1\xBB\u117Car\xF2\u1148\u0200cemt\u34B9\u34BE\u34C2\u34C5r;\uC000\u{1D4C8}tm\xEE\xF1i\xEC\u3415ar\xE6\u11BE\u0100ar\u34CE\u34D5r\u0100;f\u34D4\u17BF\u6606\u0100an\u34DA\u34EDight\u0100ep\u34E3\u34EApsilo\xEE\u1EE0h\xE9\u2EAFs\xBB\u2852\u0280bcmnp\u34FB\u355E\u1209\u358B\u358E\u0480;Edemnprs\u350E\u350F\u3511\u3515\u351E\u3523\u352C\u3531\u3536\u6282;\u6AC5ot;\u6ABD\u0100;d\u11DA\u351Aot;\u6AC3ult;\u6AC1\u0100Ee\u3528\u352A;\u6ACB;\u628Alus;\u6ABFarr;\u6979\u0180eiu\u353D\u3552\u3555t\u0180;en\u350E\u3545\u354Bq\u0100;q\u11DA\u350Feq\u0100;q\u352B\u3528m;\u6AC7\u0100bp\u355A\u355C;\u6AD5;\u6AD3c\u0300;acens\u11ED\u356C\u3572\u3579\u357B\u3326ppro\xF8\u32FAurlye\xF1\u11FE\xF1\u11F3\u0180aes\u3582\u3588\u331Bppro\xF8\u331Aq\xF1\u3317g;\u666A\u0680123;Edehlmnps\u35A9\u35AC\u35AF\u121C\u35B2\u35B4\u35C0\u35C9\u35D5\u35DA\u35DF\u35E8\u35ED\u803B\xB9\u40B9\u803B\xB2\u40B2\u803B\xB3\u40B3;\u6AC6\u0100os\u35B9\u35BCt;\u6ABEub;\u6AD8\u0100;d\u1222\u35C5ot;\u6AC4s\u0100ou\u35CF\u35D2l;\u67C9b;\u6AD7arr;\u697Bult;\u6AC2\u0100Ee\u35E4\u35E6;\u6ACC;\u628Blus;\u6AC0\u0180eiu\u35F4\u3609\u360Ct\u0180;en\u121C\u35FC\u3602q\u0100;q\u1222\u35B2eq\u0100;q\u35E7\u35E4m;\u6AC8\u0100bp\u3611\u3613;\u6AD4;\u6AD6\u0180Aan\u361C\u3620\u362Drr;\u61D9r\u0100hr\u3626\u3628\xEB\u222E\u0100;o\u0A2B\u0A29war;\u692Alig\u803B\xDF\u40DF\u0BE1\u3651\u365D\u3660\u12CE\u3673\u3679\0\u367E\u36C2\0\0\0\0\0\u36DB\u3703\0\u3709\u376C\0\0\0\u3787\u0272\u3656\0\0\u365Bget;\u6316;\u43C4r\xEB\u0E5F\u0180aey\u3666\u366B\u3670ron;\u4165dil;\u4163;\u4442lrec;\u6315r;\uC000\u{1D531}\u0200eiko\u3686\u369D\u36B5\u36BC\u01F2\u368B\0\u3691e\u01004f\u1284\u1281a\u0180;sv\u3698\u3699\u369B\u43B8ym;\u43D1\u0100cn\u36A2\u36B2k\u0100as\u36A8\u36AEppro\xF8\u12C1im\xBB\u12ACs\xF0\u129E\u0100as\u36BA\u36AE\xF0\u12C1rn\u803B\xFE\u40FE\u01EC\u031F\u36C6\u22E7es\u8180\xD7;bd\u36CF\u36D0\u36D8\u40D7\u0100;a\u190F\u36D5r;\u6A31;\u6A30\u0180eps\u36E1\u36E3\u3700\xE1\u2A4D\u0200;bcf\u0486\u36EC\u36F0\u36F4ot;\u6336ir;\u6AF1\u0100;o\u36F9\u36FC\uC000\u{1D565}rk;\u6ADA\xE1\u3362rime;\u6034\u0180aip\u370F\u3712\u3764d\xE5\u1248\u0380adempst\u3721\u374D\u3740\u3751\u3757\u375C\u375Fngle\u0280;dlqr\u3730\u3731\u3736\u3740\u3742\u65B5own\xBB\u1DBBeft\u0100;e\u2800\u373E\xF1\u092E;\u625Cight\u0100;e\u32AA\u374B\xF1\u105Aot;\u65ECinus;\u6A3Alus;\u6A39b;\u69CDime;\u6A3Bezium;\u63E2\u0180cht\u3772\u377D\u3781\u0100ry\u3777\u377B;\uC000\u{1D4C9};\u4446cy;\u445Brok;\u4167\u0100io\u378B\u378Ex\xF4\u1777head\u0100lr\u3797\u37A0eftarro\xF7\u084Fightarrow\xBB\u0F5D\u0900AHabcdfghlmoprstuw\u37D0\u37D3\u37D7\u37E4\u37F0\u37FC\u380E\u381C\u3823\u3834\u3851\u385D\u386B\u38A9\u38CC\u38D2\u38EA\u38F6r\xF2\u03EDar;\u6963\u0100cr\u37DC\u37E2ute\u803B\xFA\u40FA\xF2\u1150r\u01E3\u37EA\0\u37EDy;\u445Eve;\u416D\u0100iy\u37F5\u37FArc\u803B\xFB\u40FB;\u4443\u0180abh\u3803\u3806\u380Br\xF2\u13ADlac;\u4171a\xF2\u13C3\u0100ir\u3813\u3818sht;\u697E;\uC000\u{1D532}rave\u803B\xF9\u40F9\u0161\u3827\u3831r\u0100lr\u382C\u382E\xBB\u0957\xBB\u1083lk;\u6580\u0100ct\u3839\u384D\u026F\u383F\0\0\u384Arn\u0100;e\u3845\u3846\u631Cr\xBB\u3846op;\u630Fri;\u65F8\u0100al\u3856\u385Acr;\u416B\u80BB\xA8\u0349\u0100gp\u3862\u3866on;\u4173f;\uC000\u{1D566}\u0300adhlsu\u114B\u3878\u387D\u1372\u3891\u38A0own\xE1\u13B3arpoon\u0100lr\u3888\u388Cef\xF4\u382Digh\xF4\u382Fi\u0180;hl\u3899\u389A\u389C\u43C5\xBB\u13FAon\xBB\u389Aparrows;\u61C8\u0180cit\u38B0\u38C4\u38C8\u026F\u38B6\0\0\u38C1rn\u0100;e\u38BC\u38BD\u631Dr\xBB\u38BDop;\u630Eng;\u416Fri;\u65F9cr;\uC000\u{1D4CA}\u0180dir\u38D9\u38DD\u38E2ot;\u62F0lde;\u4169i\u0100;f\u3730\u38E8\xBB\u1813\u0100am\u38EF\u38F2r\xF2\u38A8l\u803B\xFC\u40FCangle;\u69A7\u0780ABDacdeflnoprsz\u391C\u391F\u3929\u392D\u39B5\u39B8\u39BD\u39DF\u39E4\u39E8\u39F3\u39F9\u39FD\u3A01\u3A20r\xF2\u03F7ar\u0100;v\u3926\u3927\u6AE8;\u6AE9as\xE8\u03E1\u0100nr\u3932\u3937grt;\u699C\u0380eknprst\u34E3\u3946\u394B\u3952\u395D\u3964\u3996app\xE1\u2415othin\xE7\u1E96\u0180hir\u34EB\u2EC8\u3959op\xF4\u2FB5\u0100;h\u13B7\u3962\xEF\u318D\u0100iu\u3969\u396Dgm\xE1\u33B3\u0100bp\u3972\u3984setneq\u0100;q\u397D\u3980\uC000\u228A\uFE00;\uC000\u2ACB\uFE00setneq\u0100;q\u398F\u3992\uC000\u228B\uFE00;\uC000\u2ACC\uFE00\u0100hr\u399B\u399Fet\xE1\u369Ciangle\u0100lr\u39AA\u39AFeft\xBB\u0925ight\xBB\u1051y;\u4432ash\xBB\u1036\u0180elr\u39C4\u39D2\u39D7\u0180;be\u2DEA\u39CB\u39CFar;\u62BBq;\u625Alip;\u62EE\u0100bt\u39DC\u1468a\xF2\u1469r;\uC000\u{1D533}tr\xE9\u39AEsu\u0100bp\u39EF\u39F1\xBB\u0D1C\xBB\u0D59pf;\uC000\u{1D567}ro\xF0\u0EFBtr\xE9\u39B4\u0100cu\u3A06\u3A0Br;\uC000\u{1D4CB}\u0100bp\u3A10\u3A18n\u0100Ee\u3980\u3A16\xBB\u397En\u0100Ee\u3992\u3A1E\xBB\u3990igzag;\u699A\u0380cefoprs\u3A36\u3A3B\u3A56\u3A5B\u3A54\u3A61\u3A6Airc;\u4175\u0100di\u3A40\u3A51\u0100bg\u3A45\u3A49ar;\u6A5Fe\u0100;q\u15FA\u3A4F;\u6259erp;\u6118r;\uC000\u{1D534}pf;\uC000\u{1D568}\u0100;e\u1479\u3A66at\xE8\u1479cr;\uC000\u{1D4CC}\u0AE3\u178E\u3A87\0\u3A8B\0\u3A90\u3A9B\0\0\u3A9D\u3AA8\u3AAB\u3AAF\0\0\u3AC3\u3ACE\0\u3AD8\u17DC\u17DFtr\xE9\u17D1r;\uC000\u{1D535}\u0100Aa\u3A94\u3A97r\xF2\u03C3r\xF2\u09F6;\u43BE\u0100Aa\u3AA1\u3AA4r\xF2\u03B8r\xF2\u09EBa\xF0\u2713is;\u62FB\u0180dpt\u17A4\u3AB5\u3ABE\u0100fl\u3ABA\u17A9;\uC000\u{1D569}im\xE5\u17B2\u0100Aa\u3AC7\u3ACAr\xF2\u03CEr\xF2\u0A01\u0100cq\u3AD2\u17B8r;\uC000\u{1D4CD}\u0100pt\u17D6\u3ADCr\xE9\u17D4\u0400acefiosu\u3AF0\u3AFD\u3B08\u3B0C\u3B11\u3B15\u3B1B\u3B21c\u0100uy\u3AF6\u3AFBte\u803B\xFD\u40FD;\u444F\u0100iy\u3B02\u3B06rc;\u4177;\u444Bn\u803B\xA5\u40A5r;\uC000\u{1D536}cy;\u4457pf;\uC000\u{1D56A}cr;\uC000\u{1D4CE}\u0100cm\u3B26\u3B29y;\u444El\u803B\xFF\u40FF\u0500acdefhiosw\u3B42\u3B48\u3B54\u3B58\u3B64\u3B69\u3B6D\u3B74\u3B7A\u3B80cute;\u417A\u0100ay\u3B4D\u3B52ron;\u417E;\u4437ot;\u417C\u0100et\u3B5D\u3B61tr\xE6\u155Fa;\u43B6r;\uC000\u{1D537}cy;\u4436grarr;\u61DDpf;\uC000\u{1D56B}cr;\uC000\u{1D4CF}\u0100jn\u3B85\u3B87;\u600Dj;\u600C'.split("").map(t=>t.charCodeAt(0)));var doe=new Uint16Array("\u0200aglq	\x1B\u026D\0\0p;\u4026os;\u4027t;\u403Et;\u403Cuot;\u4022".split("").map(t=>t.charCodeAt(0)));var PB,eOe=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),AB=(PB=String.fromCodePoint)!==null&&PB!==void 0?PB:function(t){let e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|t&1023),e+=String.fromCharCode(t),e};function DB(t){var e;return t>=55296&&t<=57343||t>1114111?65533:(e=eOe.get(t))!==null&&e!==void 0?e:t}var qo;(function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"})(qo||(qo={}));var tOe=32,ph;(function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"})(ph||(ph={}));function NB(t){return t>=qo.ZERO&&t<=qo.NINE}function rOe(t){return t>=qo.UPPER_A&&t<=qo.UPPER_F||t>=qo.LOWER_A&&t<=qo.LOWER_F}function nOe(t){return t>=qo.UPPER_A&&t<=qo.UPPER_Z||t>=qo.LOWER_A&&t<=qo.LOWER_Z||NB(t)}function iOe(t){return t===qo.EQUALS||nOe(t)}var Bo;(function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"})(Bo||(Bo={}));var dd;(function(t){t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute"})(dd||(dd={}));var gN=class{constructor(e,r,n){this.decodeTree=e,this.emitCodePoint=r,this.errors=n,this.state=Bo.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=dd.Strict}startEntity(e){this.decodeMode=e,this.state=Bo.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,r){switch(this.state){case Bo.EntityStart:return e.charCodeAt(r)===qo.NUM?(this.state=Bo.NumericStart,this.consumed+=1,this.stateNumericStart(e,r+1)):(this.state=Bo.NamedEntity,this.stateNamedEntity(e,r));case Bo.NumericStart:return this.stateNumericStart(e,r);case Bo.NumericDecimal:return this.stateNumericDecimal(e,r);case Bo.NumericHex:return this.stateNumericHex(e,r);case Bo.NamedEntity:return this.stateNamedEntity(e,r)}}stateNumericStart(e,r){return r>=e.length?-1:(e.charCodeAt(r)|tOe)===qo.LOWER_X?(this.state=Bo.NumericHex,this.consumed+=1,this.stateNumericHex(e,r+1)):(this.state=Bo.NumericDecimal,this.stateNumericDecimal(e,r))}addToNumericResult(e,r,n,o){if(r!==n){let s=n-r;this.result=this.result*Math.pow(o,s)+parseInt(e.substr(r,s),o),this.consumed+=s}}stateNumericHex(e,r){let n=r;for(;r<e.length;){let o=e.charCodeAt(r);if(NB(o)||rOe(o))r+=1;else return this.addToNumericResult(e,n,r,16),this.emitNumericEntity(o,3)}return this.addToNumericResult(e,n,r,16),-1}stateNumericDecimal(e,r){let n=r;for(;r<e.length;){let o=e.charCodeAt(r);if(NB(o))r+=1;else return this.addToNumericResult(e,n,r,10),this.emitNumericEntity(o,2)}return this.addToNumericResult(e,n,r,10),-1}emitNumericEntity(e,r){var n;if(this.consumed<=r)return(n=this.errors)===null||n===void 0||n.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===qo.SEMI)this.consumed+=1;else if(this.decodeMode===dd.Strict)return 0;return this.emitCodePoint(DB(this.result),this.consumed),this.errors&&(e!==qo.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,r){let{decodeTree:n}=this,o=n[this.treeIndex],s=(o&ph.VALUE_LENGTH)>>14;for(;r<e.length;r++,this.excess++){let a=e.charCodeAt(r);if(this.treeIndex=oOe(n,o,this.treeIndex+Math.max(1,s),a),this.treeIndex<0)return this.result===0||this.decodeMode===dd.Attribute&&(s===0||iOe(a))?0:this.emitNotTerminatedNamedEntity();if(o=n[this.treeIndex],s=(o&ph.VALUE_LENGTH)>>14,s!==0){if(a===qo.SEMI)return this.emitNamedEntityData(this.treeIndex,s,this.consumed+this.excess);this.decodeMode!==dd.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;let{result:r,decodeTree:n}=this,o=(n[r]&ph.VALUE_LENGTH)>>14;return this.emitNamedEntityData(r,o,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,r,n){let{decodeTree:o}=this;return this.emitCodePoint(r===1?o[e]&~ph.VALUE_LENGTH:o[e+1],n),r===3&&this.emitCodePoint(o[e+2],n),n}end(){var e;switch(this.state){case Bo.NamedEntity:return this.result!==0&&(this.decodeMode!==dd.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case Bo.NumericDecimal:return this.emitNumericEntity(0,2);case Bo.NumericHex:return this.emitNumericEntity(0,3);case Bo.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case Bo.EntityStart:return 0}}};function poe(t){let e="",r=new gN(t,n=>e+=AB(n));return function(o,s){let a=0,c=0;for(;(c=o.indexOf("&",c))>=0;){e+=o.slice(a,c),r.startEntity(s);let l=r.write(o,c+1);if(l<0){a=c+r.end();break}a=c+l,c=l===0?a+1:a}let u=e+o.slice(a);return e="",u}}function oOe(t,e,r,n){let o=(e&ph.BRANCH_LENGTH)>>7,s=e&ph.JUMP_TABLE;if(o===0)return s!==0&&n===s?r:-1;if(s){let u=n-s;return u<0||u>=o?-1:t[r+u]-1}let a=r,c=a+o-1;for(;a<=c;){let u=a+c>>>1,l=t[u];if(l<n)a=u+1;else if(l>n)c=u-1;else return t[u+o]}return-1}var sOe=poe(loe),Qgt=poe(doe);function fh(t,e=dd.Legacy){return sOe(t,e)}function vN(t){for(let e=1;e<t.length;e++)t[e][0]+=t[e-1][0]+1;return t}var aOe=new Map(vN([[9,"&Tab;"],[0,"&NewLine;"],[22,"&excl;"],[0,"&quot;"],[0,"&num;"],[0,"&dollar;"],[0,"&percnt;"],[0,"&amp;"],[0,"&apos;"],[0,"&lpar;"],[0,"&rpar;"],[0,"&ast;"],[0,"&plus;"],[0,"&comma;"],[1,"&period;"],[0,"&sol;"],[10,"&colon;"],[0,"&semi;"],[0,{v:"&lt;",n:8402,o:"&nvlt;"}],[0,{v:"&equals;",n:8421,o:"&bne;"}],[0,{v:"&gt;",n:8402,o:"&nvgt;"}],[0,"&quest;"],[0,"&commat;"],[26,"&lbrack;"],[0,"&bsol;"],[0,"&rbrack;"],[0,"&Hat;"],[0,"&lowbar;"],[0,"&DiacriticalGrave;"],[5,{n:106,o:"&fjlig;"}],[20,"&lbrace;"],[0,"&verbar;"],[0,"&rbrace;"],[34,"&nbsp;"],[0,"&iexcl;"],[0,"&cent;"],[0,"&pound;"],[0,"&curren;"],[0,"&yen;"],[0,"&brvbar;"],[0,"&sect;"],[0,"&die;"],[0,"&copy;"],[0,"&ordf;"],[0,"&laquo;"],[0,"&not;"],[0,"&shy;"],[0,"&circledR;"],[0,"&macr;"],[0,"&deg;"],[0,"&PlusMinus;"],[0,"&sup2;"],[0,"&sup3;"],[0,"&acute;"],[0,"&micro;"],[0,"&para;"],[0,"&centerdot;"],[0,"&cedil;"],[0,"&sup1;"],[0,"&ordm;"],[0,"&raquo;"],[0,"&frac14;"],[0,"&frac12;"],[0,"&frac34;"],[0,"&iquest;"],[0,"&Agrave;"],[0,"&Aacute;"],[0,"&Acirc;"],[0,"&Atilde;"],[0,"&Auml;"],[0,"&angst;"],[0,"&AElig;"],[0,"&Ccedil;"],[0,"&Egrave;"],[0,"&Eacute;"],[0,"&Ecirc;"],[0,"&Euml;"],[0,"&Igrave;"],[0,"&Iacute;"],[0,"&Icirc;"],[0,"&Iuml;"],[0,"&ETH;"],[0,"&Ntilde;"],[0,"&Ograve;"],[0,"&Oacute;"],[0,"&Ocirc;"],[0,"&Otilde;"],[0,"&Ouml;"],[0,"&times;"],[0,"&Oslash;"],[0,"&Ugrave;"],[0,"&Uacute;"],[0,"&Ucirc;"],[0,"&Uuml;"],[0,"&Yacute;"],[0,"&THORN;"],[0,"&szlig;"],[0,"&agrave;"],[0,"&aacute;"],[0,"&acirc;"],[0,"&atilde;"],[0,"&auml;"],[0,"&aring;"],[0,"&aelig;"],[0,"&ccedil;"],[0,"&egrave;"],[0,"&eacute;"],[0,"&ecirc;"],[0,"&euml;"],[0,"&igrave;"],[0,"&iacute;"],[0,"&icirc;"],[0,"&iuml;"],[0,"&eth;"],[0,"&ntilde;"],[0,"&ograve;"],[0,"&oacute;"],[0,"&ocirc;"],[0,"&otilde;"],[0,"&ouml;"],[0,"&div;"],[0,"&oslash;"],[0,"&ugrave;"],[0,"&uacute;"],[0,"&ucirc;"],[0,"&uuml;"],[0,"&yacute;"],[0,"&thorn;"],[0,"&yuml;"],[0,"&Amacr;"],[0,"&amacr;"],[0,"&Abreve;"],[0,"&abreve;"],[0,"&Aogon;"],[0,"&aogon;"],[0,"&Cacute;"],[0,"&cacute;"],[0,"&Ccirc;"],[0,"&ccirc;"],[0,"&Cdot;"],[0,"&cdot;"],[0,"&Ccaron;"],[0,"&ccaron;"],[0,"&Dcaron;"],[0,"&dcaron;"],[0,"&Dstrok;"],[0,"&dstrok;"],[0,"&Emacr;"],[0,"&emacr;"],[2,"&Edot;"],[0,"&edot;"],[0,"&Eogon;"],[0,"&eogon;"],[0,"&Ecaron;"],[0,"&ecaron;"],[0,"&Gcirc;"],[0,"&gcirc;"],[0,"&Gbreve;"],[0,"&gbreve;"],[0,"&Gdot;"],[0,"&gdot;"],[0,"&Gcedil;"],[1,"&Hcirc;"],[0,"&hcirc;"],[0,"&Hstrok;"],[0,"&hstrok;"],[0,"&Itilde;"],[0,"&itilde;"],[0,"&Imacr;"],[0,"&imacr;"],[2,"&Iogon;"],[0,"&iogon;"],[0,"&Idot;"],[0,"&imath;"],[0,"&IJlig;"],[0,"&ijlig;"],[0,"&Jcirc;"],[0,"&jcirc;"],[0,"&Kcedil;"],[0,"&kcedil;"],[0,"&kgreen;"],[0,"&Lacute;"],[0,"&lacute;"],[0,"&Lcedil;"],[0,"&lcedil;"],[0,"&Lcaron;"],[0,"&lcaron;"],[0,"&Lmidot;"],[0,"&lmidot;"],[0,"&Lstrok;"],[0,"&lstrok;"],[0,"&Nacute;"],[0,"&nacute;"],[0,"&Ncedil;"],[0,"&ncedil;"],[0,"&Ncaron;"],[0,"&ncaron;"],[0,"&napos;"],[0,"&ENG;"],[0,"&eng;"],[0,"&Omacr;"],[0,"&omacr;"],[2,"&Odblac;"],[0,"&odblac;"],[0,"&OElig;"],[0,"&oelig;"],[0,"&Racute;"],[0,"&racute;"],[0,"&Rcedil;"],[0,"&rcedil;"],[0,"&Rcaron;"],[0,"&rcaron;"],[0,"&Sacute;"],[0,"&sacute;"],[0,"&Scirc;"],[0,"&scirc;"],[0,"&Scedil;"],[0,"&scedil;"],[0,"&Scaron;"],[0,"&scaron;"],[0,"&Tcedil;"],[0,"&tcedil;"],[0,"&Tcaron;"],[0,"&tcaron;"],[0,"&Tstrok;"],[0,"&tstrok;"],[0,"&Utilde;"],[0,"&utilde;"],[0,"&Umacr;"],[0,"&umacr;"],[0,"&Ubreve;"],[0,"&ubreve;"],[0,"&Uring;"],[0,"&uring;"],[0,"&Udblac;"],[0,"&udblac;"],[0,"&Uogon;"],[0,"&uogon;"],[0,"&Wcirc;"],[0,"&wcirc;"],[0,"&Ycirc;"],[0,"&ycirc;"],[0,"&Yuml;"],[0,"&Zacute;"],[0,"&zacute;"],[0,"&Zdot;"],[0,"&zdot;"],[0,"&Zcaron;"],[0,"&zcaron;"],[19,"&fnof;"],[34,"&imped;"],[63,"&gacute;"],[65,"&jmath;"],[142,"&circ;"],[0,"&caron;"],[16,"&breve;"],[0,"&DiacriticalDot;"],[0,"&ring;"],[0,"&ogon;"],[0,"&DiacriticalTilde;"],[0,"&dblac;"],[51,"&DownBreve;"],[127,"&Alpha;"],[0,"&Beta;"],[0,"&Gamma;"],[0,"&Delta;"],[0,"&Epsilon;"],[0,"&Zeta;"],[0,"&Eta;"],[0,"&Theta;"],[0,"&Iota;"],[0,"&Kappa;"],[0,"&Lambda;"],[0,"&Mu;"],[0,"&Nu;"],[0,"&Xi;"],[0,"&Omicron;"],[0,"&Pi;"],[0,"&Rho;"],[1,"&Sigma;"],[0,"&Tau;"],[0,"&Upsilon;"],[0,"&Phi;"],[0,"&Chi;"],[0,"&Psi;"],[0,"&ohm;"],[7,"&alpha;"],[0,"&beta;"],[0,"&gamma;"],[0,"&delta;"],[0,"&epsi;"],[0,"&zeta;"],[0,"&eta;"],[0,"&theta;"],[0,"&iota;"],[0,"&kappa;"],[0,"&lambda;"],[0,"&mu;"],[0,"&nu;"],[0,"&xi;"],[0,"&omicron;"],[0,"&pi;"],[0,"&rho;"],[0,"&sigmaf;"],[0,"&sigma;"],[0,"&tau;"],[0,"&upsi;"],[0,"&phi;"],[0,"&chi;"],[0,"&psi;"],[0,"&omega;"],[7,"&thetasym;"],[0,"&Upsi;"],[2,"&phiv;"],[0,"&piv;"],[5,"&Gammad;"],[0,"&digamma;"],[18,"&kappav;"],[0,"&rhov;"],[3,"&epsiv;"],[0,"&backepsilon;"],[10,"&IOcy;"],[0,"&DJcy;"],[0,"&GJcy;"],[0,"&Jukcy;"],[0,"&DScy;"],[0,"&Iukcy;"],[0,"&YIcy;"],[0,"&Jsercy;"],[0,"&LJcy;"],[0,"&NJcy;"],[0,"&TSHcy;"],[0,"&KJcy;"],[1,"&Ubrcy;"],[0,"&DZcy;"],[0,"&Acy;"],[0,"&Bcy;"],[0,"&Vcy;"],[0,"&Gcy;"],[0,"&Dcy;"],[0,"&IEcy;"],[0,"&ZHcy;"],[0,"&Zcy;"],[0,"&Icy;"],[0,"&Jcy;"],[0,"&Kcy;"],[0,"&Lcy;"],[0,"&Mcy;"],[0,"&Ncy;"],[0,"&Ocy;"],[0,"&Pcy;"],[0,"&Rcy;"],[0,"&Scy;"],[0,"&Tcy;"],[0,"&Ucy;"],[0,"&Fcy;"],[0,"&KHcy;"],[0,"&TScy;"],[0,"&CHcy;"],[0,"&SHcy;"],[0,"&SHCHcy;"],[0,"&HARDcy;"],[0,"&Ycy;"],[0,"&SOFTcy;"],[0,"&Ecy;"],[0,"&YUcy;"],[0,"&YAcy;"],[0,"&acy;"],[0,"&bcy;"],[0,"&vcy;"],[0,"&gcy;"],[0,"&dcy;"],[0,"&iecy;"],[0,"&zhcy;"],[0,"&zcy;"],[0,"&icy;"],[0,"&jcy;"],[0,"&kcy;"],[0,"&lcy;"],[0,"&mcy;"],[0,"&ncy;"],[0,"&ocy;"],[0,"&pcy;"],[0,"&rcy;"],[0,"&scy;"],[0,"&tcy;"],[0,"&ucy;"],[0,"&fcy;"],[0,"&khcy;"],[0,"&tscy;"],[0,"&chcy;"],[0,"&shcy;"],[0,"&shchcy;"],[0,"&hardcy;"],[0,"&ycy;"],[0,"&softcy;"],[0,"&ecy;"],[0,"&yucy;"],[0,"&yacy;"],[1,"&iocy;"],[0,"&djcy;"],[0,"&gjcy;"],[0,"&jukcy;"],[0,"&dscy;"],[0,"&iukcy;"],[0,"&yicy;"],[0,"&jsercy;"],[0,"&ljcy;"],[0,"&njcy;"],[0,"&tshcy;"],[0,"&kjcy;"],[1,"&ubrcy;"],[0,"&dzcy;"],[7074,"&ensp;"],[0,"&emsp;"],[0,"&emsp13;"],[0,"&emsp14;"],[1,"&numsp;"],[0,"&puncsp;"],[0,"&ThinSpace;"],[0,"&hairsp;"],[0,"&NegativeMediumSpace;"],[0,"&zwnj;"],[0,"&zwj;"],[0,"&lrm;"],[0,"&rlm;"],[0,"&dash;"],[2,"&ndash;"],[0,"&mdash;"],[0,"&horbar;"],[0,"&Verbar;"],[1,"&lsquo;"],[0,"&CloseCurlyQuote;"],[0,"&lsquor;"],[1,"&ldquo;"],[0,"&CloseCurlyDoubleQuote;"],[0,"&bdquo;"],[1,"&dagger;"],[0,"&Dagger;"],[0,"&bull;"],[2,"&nldr;"],[0,"&hellip;"],[9,"&permil;"],[0,"&pertenk;"],[0,"&prime;"],[0,"&Prime;"],[0,"&tprime;"],[0,"&backprime;"],[3,"&lsaquo;"],[0,"&rsaquo;"],[3,"&oline;"],[2,"&caret;"],[1,"&hybull;"],[0,"&frasl;"],[10,"&bsemi;"],[7,"&qprime;"],[7,{v:"&MediumSpace;",n:8202,o:"&ThickSpace;"}],[0,"&NoBreak;"],[0,"&af;"],[0,"&InvisibleTimes;"],[0,"&ic;"],[72,"&euro;"],[46,"&tdot;"],[0,"&DotDot;"],[37,"&complexes;"],[2,"&incare;"],[4,"&gscr;"],[0,"&hamilt;"],[0,"&Hfr;"],[0,"&Hopf;"],[0,"&planckh;"],[0,"&hbar;"],[0,"&imagline;"],[0,"&Ifr;"],[0,"&lagran;"],[0,"&ell;"],[1,"&naturals;"],[0,"&numero;"],[0,"&copysr;"],[0,"&weierp;"],[0,"&Popf;"],[0,"&Qopf;"],[0,"&realine;"],[0,"&real;"],[0,"&reals;"],[0,"&rx;"],[3,"&trade;"],[1,"&integers;"],[2,"&mho;"],[0,"&zeetrf;"],[0,"&iiota;"],[2,"&bernou;"],[0,"&Cayleys;"],[1,"&escr;"],[0,"&Escr;"],[0,"&Fouriertrf;"],[1,"&Mellintrf;"],[0,"&order;"],[0,"&alefsym;"],[0,"&beth;"],[0,"&gimel;"],[0,"&daleth;"],[12,"&CapitalDifferentialD;"],[0,"&dd;"],[0,"&ee;"],[0,"&ii;"],[10,"&frac13;"],[0,"&frac23;"],[0,"&frac15;"],[0,"&frac25;"],[0,"&frac35;"],[0,"&frac45;"],[0,"&frac16;"],[0,"&frac56;"],[0,"&frac18;"],[0,"&frac38;"],[0,"&frac58;"],[0,"&frac78;"],[49,"&larr;"],[0,"&ShortUpArrow;"],[0,"&rarr;"],[0,"&darr;"],[0,"&harr;"],[0,"&updownarrow;"],[0,"&nwarr;"],[0,"&nearr;"],[0,"&LowerRightArrow;"],[0,"&LowerLeftArrow;"],[0,"&nlarr;"],[0,"&nrarr;"],[1,{v:"&rarrw;",n:824,o:"&nrarrw;"}],[0,"&Larr;"],[0,"&Uarr;"],[0,"&Rarr;"],[0,"&Darr;"],[0,"&larrtl;"],[0,"&rarrtl;"],[0,"&LeftTeeArrow;"],[0,"&mapstoup;"],[0,"&map;"],[0,"&DownTeeArrow;"],[1,"&hookleftarrow;"],[0,"&hookrightarrow;"],[0,"&larrlp;"],[0,"&looparrowright;"],[0,"&harrw;"],[0,"&nharr;"],[1,"&lsh;"],[0,"&rsh;"],[0,"&ldsh;"],[0,"&rdsh;"],[1,"&crarr;"],[0,"&cularr;"],[0,"&curarr;"],[2,"&circlearrowleft;"],[0,"&circlearrowright;"],[0,"&leftharpoonup;"],[0,"&DownLeftVector;"],[0,"&RightUpVector;"],[0,"&LeftUpVector;"],[0,"&rharu;"],[0,"&DownRightVector;"],[0,"&dharr;"],[0,"&dharl;"],[0,"&RightArrowLeftArrow;"],[0,"&udarr;"],[0,"&LeftArrowRightArrow;"],[0,"&leftleftarrows;"],[0,"&upuparrows;"],[0,"&rightrightarrows;"],[0,"&ddarr;"],[0,"&leftrightharpoons;"],[0,"&Equilibrium;"],[0,"&nlArr;"],[0,"&nhArr;"],[0,"&nrArr;"],[0,"&DoubleLeftArrow;"],[0,"&DoubleUpArrow;"],[0,"&DoubleRightArrow;"],[0,"&dArr;"],[0,"&DoubleLeftRightArrow;"],[0,"&DoubleUpDownArrow;"],[0,"&nwArr;"],[0,"&neArr;"],[0,"&seArr;"],[0,"&swArr;"],[0,"&lAarr;"],[0,"&rAarr;"],[1,"&zigrarr;"],[6,"&larrb;"],[0,"&rarrb;"],[15,"&DownArrowUpArrow;"],[7,"&loarr;"],[0,"&roarr;"],[0,"&hoarr;"],[0,"&forall;"],[0,"&comp;"],[0,{v:"&part;",n:824,o:"&npart;"}],[0,"&exist;"],[0,"&nexist;"],[0,"&empty;"],[1,"&Del;"],[0,"&Element;"],[0,"&NotElement;"],[1,"&ni;"],[0,"&notni;"],[2,"&prod;"],[0,"&coprod;"],[0,"&sum;"],[0,"&minus;"],[0,"&MinusPlus;"],[0,"&dotplus;"],[1,"&Backslash;"],[0,"&lowast;"],[0,"&compfn;"],[1,"&radic;"],[2,"&prop;"],[0,"&infin;"],[0,"&angrt;"],[0,{v:"&ang;",n:8402,o:"&nang;"}],[0,"&angmsd;"],[0,"&angsph;"],[0,"&mid;"],[0,"&nmid;"],[0,"&DoubleVerticalBar;"],[0,"&NotDoubleVerticalBar;"],[0,"&and;"],[0,"&or;"],[0,{v:"&cap;",n:65024,o:"&caps;"}],[0,{v:"&cup;",n:65024,o:"&cups;"}],[0,"&int;"],[0,"&Int;"],[0,"&iiint;"],[0,"&conint;"],[0,"&Conint;"],[0,"&Cconint;"],[0,"&cwint;"],[0,"&ClockwiseContourIntegral;"],[0,"&awconint;"],[0,"&there4;"],[0,"&becaus;"],[0,"&ratio;"],[0,"&Colon;"],[0,"&dotminus;"],[1,"&mDDot;"],[0,"&homtht;"],[0,{v:"&sim;",n:8402,o:"&nvsim;"}],[0,{v:"&backsim;",n:817,o:"&race;"}],[0,{v:"&ac;",n:819,o:"&acE;"}],[0,"&acd;"],[0,"&VerticalTilde;"],[0,"&NotTilde;"],[0,{v:"&eqsim;",n:824,o:"&nesim;"}],[0,"&sime;"],[0,"&NotTildeEqual;"],[0,"&cong;"],[0,"&simne;"],[0,"&ncong;"],[0,"&ap;"],[0,"&nap;"],[0,"&ape;"],[0,{v:"&apid;",n:824,o:"&napid;"}],[0,"&backcong;"],[0,{v:"&asympeq;",n:8402,o:"&nvap;"}],[0,{v:"&bump;",n:824,o:"&nbump;"}],[0,{v:"&bumpe;",n:824,o:"&nbumpe;"}],[0,{v:"&doteq;",n:824,o:"&nedot;"}],[0,"&doteqdot;"],[0,"&efDot;"],[0,"&erDot;"],[0,"&Assign;"],[0,"&ecolon;"],[0,"&ecir;"],[0,"&circeq;"],[1,"&wedgeq;"],[0,"&veeeq;"],[1,"&triangleq;"],[2,"&equest;"],[0,"&ne;"],[0,{v:"&Congruent;",n:8421,o:"&bnequiv;"}],[0,"&nequiv;"],[1,{v:"&le;",n:8402,o:"&nvle;"}],[0,{v:"&ge;",n:8402,o:"&nvge;"}],[0,{v:"&lE;",n:824,o:"&nlE;"}],[0,{v:"&gE;",n:824,o:"&ngE;"}],[0,{v:"&lnE;",n:65024,o:"&lvertneqq;"}],[0,{v:"&gnE;",n:65024,o:"&gvertneqq;"}],[0,{v:"&ll;",n:new Map(vN([[824,"&nLtv;"],[7577,"&nLt;"]]))}],[0,{v:"&gg;",n:new Map(vN([[824,"&nGtv;"],[7577,"&nGt;"]]))}],[0,"&between;"],[0,"&NotCupCap;"],[0,"&nless;"],[0,"&ngt;"],[0,"&nle;"],[0,"&nge;"],[0,"&lesssim;"],[0,"&GreaterTilde;"],[0,"&nlsim;"],[0,"&ngsim;"],[0,"&LessGreater;"],[0,"&gl;"],[0,"&NotLessGreater;"],[0,"&NotGreaterLess;"],[0,"&pr;"],[0,"&sc;"],[0,"&prcue;"],[0,"&sccue;"],[0,"&PrecedesTilde;"],[0,{v:"&scsim;",n:824,o:"&NotSucceedsTilde;"}],[0,"&NotPrecedes;"],[0,"&NotSucceeds;"],[0,{v:"&sub;",n:8402,o:"&NotSubset;"}],[0,{v:"&sup;",n:8402,o:"&NotSuperset;"}],[0,"&nsub;"],[0,"&nsup;"],[0,"&sube;"],[0,"&supe;"],[0,"&NotSubsetEqual;"],[0,"&NotSupersetEqual;"],[0,{v:"&subne;",n:65024,o:"&varsubsetneq;"}],[0,{v:"&supne;",n:65024,o:"&varsupsetneq;"}],[1,"&cupdot;"],[0,"&UnionPlus;"],[0,{v:"&sqsub;",n:824,o:"&NotSquareSubset;"}],[0,{v:"&sqsup;",n:824,o:"&NotSquareSuperset;"}],[0,"&sqsube;"],[0,"&sqsupe;"],[0,{v:"&sqcap;",n:65024,o:"&sqcaps;"}],[0,{v:"&sqcup;",n:65024,o:"&sqcups;"}],[0,"&CirclePlus;"],[0,"&CircleMinus;"],[0,"&CircleTimes;"],[0,"&osol;"],[0,"&CircleDot;"],[0,"&circledcirc;"],[0,"&circledast;"],[1,"&circleddash;"],[0,"&boxplus;"],[0,"&boxminus;"],[0,"&boxtimes;"],[0,"&dotsquare;"],[0,"&RightTee;"],[0,"&dashv;"],[0,"&DownTee;"],[0,"&bot;"],[1,"&models;"],[0,"&DoubleRightTee;"],[0,"&Vdash;"],[0,"&Vvdash;"],[0,"&VDash;"],[0,"&nvdash;"],[0,"&nvDash;"],[0,"&nVdash;"],[0,"&nVDash;"],[0,"&prurel;"],[1,"&LeftTriangle;"],[0,"&RightTriangle;"],[0,{v:"&LeftTriangleEqual;",n:8402,o:"&nvltrie;"}],[0,{v:"&RightTriangleEqual;",n:8402,o:"&nvrtrie;"}],[0,"&origof;"],[0,"&imof;"],[0,"&multimap;"],[0,"&hercon;"],[0,"&intcal;"],[0,"&veebar;"],[1,"&barvee;"],[0,"&angrtvb;"],[0,"&lrtri;"],[0,"&bigwedge;"],[0,"&bigvee;"],[0,"&bigcap;"],[0,"&bigcup;"],[0,"&diam;"],[0,"&sdot;"],[0,"&sstarf;"],[0,"&divideontimes;"],[0,"&bowtie;"],[0,"&ltimes;"],[0,"&rtimes;"],[0,"&leftthreetimes;"],[0,"&rightthreetimes;"],[0,"&backsimeq;"],[0,"&curlyvee;"],[0,"&curlywedge;"],[0,"&Sub;"],[0,"&Sup;"],[0,"&Cap;"],[0,"&Cup;"],[0,"&fork;"],[0,"&epar;"],[0,"&lessdot;"],[0,"&gtdot;"],[0,{v:"&Ll;",n:824,o:"&nLl;"}],[0,{v:"&Gg;",n:824,o:"&nGg;"}],[0,{v:"&leg;",n:65024,o:"&lesg;"}],[0,{v:"&gel;",n:65024,o:"&gesl;"}],[2,"&cuepr;"],[0,"&cuesc;"],[0,"&NotPrecedesSlantEqual;"],[0,"&NotSucceedsSlantEqual;"],[0,"&NotSquareSubsetEqual;"],[0,"&NotSquareSupersetEqual;"],[2,"&lnsim;"],[0,"&gnsim;"],[0,"&precnsim;"],[0,"&scnsim;"],[0,"&nltri;"],[0,"&NotRightTriangle;"],[0,"&nltrie;"],[0,"&NotRightTriangleEqual;"],[0,"&vellip;"],[0,"&ctdot;"],[0,"&utdot;"],[0,"&dtdot;"],[0,"&disin;"],[0,"&isinsv;"],[0,"&isins;"],[0,{v:"&isindot;",n:824,o:"&notindot;"}],[0,"&notinvc;"],[0,"&notinvb;"],[1,{v:"&isinE;",n:824,o:"&notinE;"}],[0,"&nisd;"],[0,"&xnis;"],[0,"&nis;"],[0,"&notnivc;"],[0,"&notnivb;"],[6,"&barwed;"],[0,"&Barwed;"],[1,"&lceil;"],[0,"&rceil;"],[0,"&LeftFloor;"],[0,"&rfloor;"],[0,"&drcrop;"],[0,"&dlcrop;"],[0,"&urcrop;"],[0,"&ulcrop;"],[0,"&bnot;"],[1,"&profline;"],[0,"&profsurf;"],[1,"&telrec;"],[0,"&target;"],[5,"&ulcorn;"],[0,"&urcorn;"],[0,"&dlcorn;"],[0,"&drcorn;"],[2,"&frown;"],[0,"&smile;"],[9,"&cylcty;"],[0,"&profalar;"],[7,"&topbot;"],[6,"&ovbar;"],[1,"&solbar;"],[60,"&angzarr;"],[51,"&lmoustache;"],[0,"&rmoustache;"],[2,"&OverBracket;"],[0,"&bbrk;"],[0,"&bbrktbrk;"],[37,"&OverParenthesis;"],[0,"&UnderParenthesis;"],[0,"&OverBrace;"],[0,"&UnderBrace;"],[2,"&trpezium;"],[4,"&elinters;"],[59,"&blank;"],[164,"&circledS;"],[55,"&boxh;"],[1,"&boxv;"],[9,"&boxdr;"],[3,"&boxdl;"],[3,"&boxur;"],[3,"&boxul;"],[3,"&boxvr;"],[7,"&boxvl;"],[7,"&boxhd;"],[7,"&boxhu;"],[7,"&boxvh;"],[19,"&boxH;"],[0,"&boxV;"],[0,"&boxdR;"],[0,"&boxDr;"],[0,"&boxDR;"],[0,"&boxdL;"],[0,"&boxDl;"],[0,"&boxDL;"],[0,"&boxuR;"],[0,"&boxUr;"],[0,"&boxUR;"],[0,"&boxuL;"],[0,"&boxUl;"],[0,"&boxUL;"],[0,"&boxvR;"],[0,"&boxVr;"],[0,"&boxVR;"],[0,"&boxvL;"],[0,"&boxVl;"],[0,"&boxVL;"],[0,"&boxHd;"],[0,"&boxhD;"],[0,"&boxHD;"],[0,"&boxHu;"],[0,"&boxhU;"],[0,"&boxHU;"],[0,"&boxvH;"],[0,"&boxVh;"],[0,"&boxVH;"],[19,"&uhblk;"],[3,"&lhblk;"],[3,"&block;"],[8,"&blk14;"],[0,"&blk12;"],[0,"&blk34;"],[13,"&square;"],[8,"&blacksquare;"],[0,"&EmptyVerySmallSquare;"],[1,"&rect;"],[0,"&marker;"],[2,"&fltns;"],[1,"&bigtriangleup;"],[0,"&blacktriangle;"],[0,"&triangle;"],[2,"&blacktriangleright;"],[0,"&rtri;"],[3,"&bigtriangledown;"],[0,"&blacktriangledown;"],[0,"&dtri;"],[2,"&blacktriangleleft;"],[0,"&ltri;"],[6,"&loz;"],[0,"&cir;"],[32,"&tridot;"],[2,"&bigcirc;"],[8,"&ultri;"],[0,"&urtri;"],[0,"&lltri;"],[0,"&EmptySmallSquare;"],[0,"&FilledSmallSquare;"],[8,"&bigstar;"],[0,"&star;"],[7,"&phone;"],[49,"&female;"],[1,"&male;"],[29,"&spades;"],[2,"&clubs;"],[1,"&hearts;"],[0,"&diamondsuit;"],[3,"&sung;"],[2,"&flat;"],[0,"&natural;"],[0,"&sharp;"],[163,"&check;"],[3,"&cross;"],[8,"&malt;"],[21,"&sext;"],[33,"&VerticalSeparator;"],[25,"&lbbrk;"],[0,"&rbbrk;"],[84,"&bsolhsub;"],[0,"&suphsol;"],[28,"&LeftDoubleBracket;"],[0,"&RightDoubleBracket;"],[0,"&lang;"],[0,"&rang;"],[0,"&Lang;"],[0,"&Rang;"],[0,"&loang;"],[0,"&roang;"],[7,"&longleftarrow;"],[0,"&longrightarrow;"],[0,"&longleftrightarrow;"],[0,"&DoubleLongLeftArrow;"],[0,"&DoubleLongRightArrow;"],[0,"&DoubleLongLeftRightArrow;"],[1,"&longmapsto;"],[2,"&dzigrarr;"],[258,"&nvlArr;"],[0,"&nvrArr;"],[0,"&nvHarr;"],[0,"&Map;"],[6,"&lbarr;"],[0,"&bkarow;"],[0,"&lBarr;"],[0,"&dbkarow;"],[0,"&drbkarow;"],[0,"&DDotrahd;"],[0,"&UpArrowBar;"],[0,"&DownArrowBar;"],[2,"&Rarrtl;"],[2,"&latail;"],[0,"&ratail;"],[0,"&lAtail;"],[0,"&rAtail;"],[0,"&larrfs;"],[0,"&rarrfs;"],[0,"&larrbfs;"],[0,"&rarrbfs;"],[2,"&nwarhk;"],[0,"&nearhk;"],[0,"&hksearow;"],[0,"&hkswarow;"],[0,"&nwnear;"],[0,"&nesear;"],[0,"&seswar;"],[0,"&swnwar;"],[8,{v:"&rarrc;",n:824,o:"&nrarrc;"}],[1,"&cudarrr;"],[0,"&ldca;"],[0,"&rdca;"],[0,"&cudarrl;"],[0,"&larrpl;"],[2,"&curarrm;"],[0,"&cularrp;"],[7,"&rarrpl;"],[2,"&harrcir;"],[0,"&Uarrocir;"],[0,"&lurdshar;"],[0,"&ldrushar;"],[2,"&LeftRightVector;"],[0,"&RightUpDownVector;"],[0,"&DownLeftRightVector;"],[0,"&LeftUpDownVector;"],[0,"&LeftVectorBar;"],[0,"&RightVectorBar;"],[0,"&RightUpVectorBar;"],[0,"&RightDownVectorBar;"],[0,"&DownLeftVectorBar;"],[0,"&DownRightVectorBar;"],[0,"&LeftUpVectorBar;"],[0,"&LeftDownVectorBar;"],[0,"&LeftTeeVector;"],[0,"&RightTeeVector;"],[0,"&RightUpTeeVector;"],[0,"&RightDownTeeVector;"],[0,"&DownLeftTeeVector;"],[0,"&DownRightTeeVector;"],[0,"&LeftUpTeeVector;"],[0,"&LeftDownTeeVector;"],[0,"&lHar;"],[0,"&uHar;"],[0,"&rHar;"],[0,"&dHar;"],[0,"&luruhar;"],[0,"&ldrdhar;"],[0,"&ruluhar;"],[0,"&rdldhar;"],[0,"&lharul;"],[0,"&llhard;"],[0,"&rharul;"],[0,"&lrhard;"],[0,"&udhar;"],[0,"&duhar;"],[0,"&RoundImplies;"],[0,"&erarr;"],[0,"&simrarr;"],[0,"&larrsim;"],[0,"&rarrsim;"],[0,"&rarrap;"],[0,"&ltlarr;"],[1,"&gtrarr;"],[0,"&subrarr;"],[1,"&suplarr;"],[0,"&lfisht;"],[0,"&rfisht;"],[0,"&ufisht;"],[0,"&dfisht;"],[5,"&lopar;"],[0,"&ropar;"],[4,"&lbrke;"],[0,"&rbrke;"],[0,"&lbrkslu;"],[0,"&rbrksld;"],[0,"&lbrksld;"],[0,"&rbrkslu;"],[0,"&langd;"],[0,"&rangd;"],[0,"&lparlt;"],[0,"&rpargt;"],[0,"&gtlPar;"],[0,"&ltrPar;"],[3,"&vzigzag;"],[1,"&vangrt;"],[0,"&angrtvbd;"],[6,"&ange;"],[0,"&range;"],[0,"&dwangle;"],[0,"&uwangle;"],[0,"&angmsdaa;"],[0,"&angmsdab;"],[0,"&angmsdac;"],[0,"&angmsdad;"],[0,"&angmsdae;"],[0,"&angmsdaf;"],[0,"&angmsdag;"],[0,"&angmsdah;"],[0,"&bemptyv;"],[0,"&demptyv;"],[0,"&cemptyv;"],[0,"&raemptyv;"],[0,"&laemptyv;"],[0,"&ohbar;"],[0,"&omid;"],[0,"&opar;"],[1,"&operp;"],[1,"&olcross;"],[0,"&odsold;"],[1,"&olcir;"],[0,"&ofcir;"],[0,"&olt;"],[0,"&ogt;"],[0,"&cirscir;"],[0,"&cirE;"],[0,"&solb;"],[0,"&bsolb;"],[3,"&boxbox;"],[3,"&trisb;"],[0,"&rtriltri;"],[0,{v:"&LeftTriangleBar;",n:824,o:"&NotLeftTriangleBar;"}],[0,{v:"&RightTriangleBar;",n:824,o:"&NotRightTriangleBar;"}],[11,"&iinfin;"],[0,"&infintie;"],[0,"&nvinfin;"],[4,"&eparsl;"],[0,"&smeparsl;"],[0,"&eqvparsl;"],[5,"&blacklozenge;"],[8,"&RuleDelayed;"],[1,"&dsol;"],[9,"&bigodot;"],[0,"&bigoplus;"],[0,"&bigotimes;"],[1,"&biguplus;"],[1,"&bigsqcup;"],[5,"&iiiint;"],[0,"&fpartint;"],[2,"&cirfnint;"],[0,"&awint;"],[0,"&rppolint;"],[0,"&scpolint;"],[0,"&npolint;"],[0,"&pointint;"],[0,"&quatint;"],[0,"&intlarhk;"],[10,"&pluscir;"],[0,"&plusacir;"],[0,"&simplus;"],[0,"&plusdu;"],[0,"&plussim;"],[0,"&plustwo;"],[1,"&mcomma;"],[0,"&minusdu;"],[2,"&loplus;"],[0,"&roplus;"],[0,"&Cross;"],[0,"&timesd;"],[0,"&timesbar;"],[1,"&smashp;"],[0,"&lotimes;"],[0,"&rotimes;"],[0,"&otimesas;"],[0,"&Otimes;"],[0,"&odiv;"],[0,"&triplus;"],[0,"&triminus;"],[0,"&tritime;"],[0,"&intprod;"],[2,"&amalg;"],[0,"&capdot;"],[1,"&ncup;"],[0,"&ncap;"],[0,"&capand;"],[0,"&cupor;"],[0,"&cupcap;"],[0,"&capcup;"],[0,"&cupbrcap;"],[0,"&capbrcup;"],[0,"&cupcup;"],[0,"&capcap;"],[0,"&ccups;"],[0,"&ccaps;"],[2,"&ccupssm;"],[2,"&And;"],[0,"&Or;"],[0,"&andand;"],[0,"&oror;"],[0,"&orslope;"],[0,"&andslope;"],[1,"&andv;"],[0,"&orv;"],[0,"&andd;"],[0,"&ord;"],[1,"&wedbar;"],[6,"&sdote;"],[3,"&simdot;"],[2,{v:"&congdot;",n:824,o:"&ncongdot;"}],[0,"&easter;"],[0,"&apacir;"],[0,{v:"&apE;",n:824,o:"&napE;"}],[0,"&eplus;"],[0,"&pluse;"],[0,"&Esim;"],[0,"&Colone;"],[0,"&Equal;"],[1,"&ddotseq;"],[0,"&equivDD;"],[0,"&ltcir;"],[0,"&gtcir;"],[0,"&ltquest;"],[0,"&gtquest;"],[0,{v:"&leqslant;",n:824,o:"&nleqslant;"}],[0,{v:"&geqslant;",n:824,o:"&ngeqslant;"}],[0,"&lesdot;"],[0,"&gesdot;"],[0,"&lesdoto;"],[0,"&gesdoto;"],[0,"&lesdotor;"],[0,"&gesdotol;"],[0,"&lap;"],[0,"&gap;"],[0,"&lne;"],[0,"&gne;"],[0,"&lnap;"],[0,"&gnap;"],[0,"&lEg;"],[0,"&gEl;"],[0,"&lsime;"],[0,"&gsime;"],[0,"&lsimg;"],[0,"&gsiml;"],[0,"&lgE;"],[0,"&glE;"],[0,"&lesges;"],[0,"&gesles;"],[0,"&els;"],[0,"&egs;"],[0,"&elsdot;"],[0,"&egsdot;"],[0,"&el;"],[0,"&eg;"],[2,"&siml;"],[0,"&simg;"],[0,"&simlE;"],[0,"&simgE;"],[0,{v:"&LessLess;",n:824,o:"&NotNestedLessLess;"}],[0,{v:"&GreaterGreater;",n:824,o:"&NotNestedGreaterGreater;"}],[1,"&glj;"],[0,"&gla;"],[0,"&ltcc;"],[0,"&gtcc;"],[0,"&lescc;"],[0,"&gescc;"],[0,"&smt;"],[0,"&lat;"],[0,{v:"&smte;",n:65024,o:"&smtes;"}],[0,{v:"&late;",n:65024,o:"&lates;"}],[0,"&bumpE;"],[0,{v:"&PrecedesEqual;",n:824,o:"&NotPrecedesEqual;"}],[0,{v:"&sce;",n:824,o:"&NotSucceedsEqual;"}],[2,"&prE;"],[0,"&scE;"],[0,"&precneqq;"],[0,"&scnE;"],[0,"&prap;"],[0,"&scap;"],[0,"&precnapprox;"],[0,"&scnap;"],[0,"&Pr;"],[0,"&Sc;"],[0,"&subdot;"],[0,"&supdot;"],[0,"&subplus;"],[0,"&supplus;"],[0,"&submult;"],[0,"&supmult;"],[0,"&subedot;"],[0,"&supedot;"],[0,{v:"&subE;",n:824,o:"&nsubE;"}],[0,{v:"&supE;",n:824,o:"&nsupE;"}],[0,"&subsim;"],[0,"&supsim;"],[2,{v:"&subnE;",n:65024,o:"&varsubsetneqq;"}],[0,{v:"&supnE;",n:65024,o:"&varsupsetneqq;"}],[2,"&csub;"],[0,"&csup;"],[0,"&csube;"],[0,"&csupe;"],[0,"&subsup;"],[0,"&supsub;"],[0,"&subsub;"],[0,"&supsup;"],[0,"&suphsub;"],[0,"&supdsub;"],[0,"&forkv;"],[0,"&topfork;"],[0,"&mlcp;"],[8,"&Dashv;"],[1,"&Vdashl;"],[0,"&Barv;"],[0,"&vBar;"],[0,"&vBarv;"],[1,"&Vbar;"],[0,"&Not;"],[0,"&bNot;"],[0,"&rnmid;"],[0,"&cirmid;"],[0,"&midcir;"],[0,"&topcir;"],[0,"&nhpar;"],[0,"&parsim;"],[9,{v:"&parsl;",n:8421,o:"&nparsl;"}],[44343,{n:new Map(vN([[56476,"&Ascr;"],[1,"&Cscr;"],[0,"&Dscr;"],[2,"&Gscr;"],[2,"&Jscr;"],[0,"&Kscr;"],[2,"&Nscr;"],[0,"&Oscr;"],[0,"&Pscr;"],[0,"&Qscr;"],[1,"&Sscr;"],[0,"&Tscr;"],[0,"&Uscr;"],[0,"&Vscr;"],[0,"&Wscr;"],[0,"&Xscr;"],[0,"&Yscr;"],[0,"&Zscr;"],[0,"&ascr;"],[0,"&bscr;"],[0,"&cscr;"],[0,"&dscr;"],[1,"&fscr;"],[1,"&hscr;"],[0,"&iscr;"],[0,"&jscr;"],[0,"&kscr;"],[0,"&lscr;"],[0,"&mscr;"],[0,"&nscr;"],[1,"&pscr;"],[0,"&qscr;"],[0,"&rscr;"],[0,"&sscr;"],[0,"&tscr;"],[0,"&uscr;"],[0,"&vscr;"],[0,"&wscr;"],[0,"&xscr;"],[0,"&yscr;"],[0,"&zscr;"],[52,"&Afr;"],[0,"&Bfr;"],[1,"&Dfr;"],[0,"&Efr;"],[0,"&Ffr;"],[0,"&Gfr;"],[2,"&Jfr;"],[0,"&Kfr;"],[0,"&Lfr;"],[0,"&Mfr;"],[0,"&Nfr;"],[0,"&Ofr;"],[0,"&Pfr;"],[0,"&Qfr;"],[1,"&Sfr;"],[0,"&Tfr;"],[0,"&Ufr;"],[0,"&Vfr;"],[0,"&Wfr;"],[0,"&Xfr;"],[0,"&Yfr;"],[1,"&afr;"],[0,"&bfr;"],[0,"&cfr;"],[0,"&dfr;"],[0,"&efr;"],[0,"&ffr;"],[0,"&gfr;"],[0,"&hfr;"],[0,"&ifr;"],[0,"&jfr;"],[0,"&kfr;"],[0,"&lfr;"],[0,"&mfr;"],[0,"&nfr;"],[0,"&ofr;"],[0,"&pfr;"],[0,"&qfr;"],[0,"&rfr;"],[0,"&sfr;"],[0,"&tfr;"],[0,"&ufr;"],[0,"&vfr;"],[0,"&wfr;"],[0,"&xfr;"],[0,"&yfr;"],[0,"&zfr;"],[0,"&Aopf;"],[0,"&Bopf;"],[1,"&Dopf;"],[0,"&Eopf;"],[0,"&Fopf;"],[0,"&Gopf;"],[1,"&Iopf;"],[0,"&Jopf;"],[0,"&Kopf;"],[0,"&Lopf;"],[0,"&Mopf;"],[1,"&Oopf;"],[3,"&Sopf;"],[0,"&Topf;"],[0,"&Uopf;"],[0,"&Vopf;"],[0,"&Wopf;"],[0,"&Xopf;"],[0,"&Yopf;"],[1,"&aopf;"],[0,"&bopf;"],[0,"&copf;"],[0,"&dopf;"],[0,"&eopf;"],[0,"&fopf;"],[0,"&gopf;"],[0,"&hopf;"],[0,"&iopf;"],[0,"&jopf;"],[0,"&kopf;"],[0,"&lopf;"],[0,"&mopf;"],[0,"&nopf;"],[0,"&oopf;"],[0,"&popf;"],[0,"&qopf;"],[0,"&ropf;"],[0,"&sopf;"],[0,"&topf;"],[0,"&uopf;"],[0,"&vopf;"],[0,"&wopf;"],[0,"&xopf;"],[0,"&yopf;"],[0,"&zopf;"]]))}],[8906,"&fflig;"],[0,"&filig;"],[0,"&fllig;"],[0,"&ffilig;"],[0,"&ffllig;"]]));var cOe=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]),uOe=String.prototype.codePointAt!=null?(t,e)=>t.codePointAt(e):(t,e)=>(t.charCodeAt(e)&64512)===55296?(t.charCodeAt(e)-55296)*1024+t.charCodeAt(e+1)-56320+65536:t.charCodeAt(e);function LB(t,e){return function(n){let o,s=0,a="";for(;o=t.exec(n);)s!==o.index&&(a+=n.substring(s,o.index)),a+=e.get(o[0].charCodeAt(0)),s=o.index+1;return a+n.substring(s)}}var foe=LB(/[&<>'"]/g,cOe),moe=LB(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),hoe=LB(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]]));var goe;(function(t){t[t.XML=0]="XML",t[t.HTML=1]="HTML"})(goe||(goe={}));var voe;(function(t){t[t.UTF8=0]="UTF8",t[t.ASCII=1]="ASCII",t[t.Extensive=2]="Extensive",t[t.Attribute=3]="Attribute",t[t.Text=4]="Text"})(voe||(voe={}));function pOe(t){return Object.prototype.toString.call(t)}function yN(t){return pOe(t)==="[object String]"}var fOe=Object.prototype.hasOwnProperty;function mOe(t,e){return fOe.call(t,e)}function ux(t){return Array.prototype.slice.call(arguments,1).forEach(function(r){if(r){if(typeof r!="object")throw new TypeError(r+"must be object");Object.keys(r).forEach(function(n){t[n]=r[n]})}}),t}function MB(t,e,r){return[].concat(t.slice(0,e),r,t.slice(e+1))}function bN(t){return!(t>=55296&&t<=57343||t>=64976&&t<=65007||(t&65535)===65535||(t&65535)===65534||t>=0&&t<=8||t===11||t>=14&&t<=31||t>=127&&t<=159||t>1114111)}function gw(t){if(t>65535){t-=65536;let e=55296+(t>>10),r=56320+(t&1023);return String.fromCharCode(e,r)}return String.fromCharCode(t)}var _oe=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,hOe=/&([a-z#][a-z0-9]{1,31});/gi,gOe=new RegExp(_oe.source+"|"+hOe.source,"gi"),vOe=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function yOe(t,e){if(e.charCodeAt(0)===35&&vOe.test(e)){let n=e[1].toLowerCase()==="x"?parseInt(e.slice(2),16):parseInt(e.slice(1),10);return bN(n)?gw(n):t}let r=fh(t);return r!==t?r:t}function bOe(t){return t.indexOf("\\")<0?t:t.replace(_oe,"$1")}function mh(t){return t.indexOf("\\")<0&&t.indexOf("&")<0?t:t.replace(gOe,function(e,r,n){return r||yOe(e,n)})}var _Oe=/[&<>"]/,xOe=/[&<>"]/g,SOe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function IOe(t){return SOe[t]}function sf(t){return _Oe.test(t)?t.replace(xOe,IOe):t}var COe=/[.?*+^$[\]\\(){}|-]/g;function EOe(t){return t.replace(COe,"\\$&")}function pr(t){switch(t){case 9:case 32:return!0}return!1}function j0(t){if(t>=8192&&t<=8202)return!0;switch(t){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function V0(t){return cx.test(t)}function G0(t){switch(t){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function z0(t){return t=t.trim().replace(/\s+/g," "),"\u1E9E".toLowerCase()==="\u1E7E"&&(t=t.replace(/ẞ/g,"\xDF")),t.toLowerCase().toUpperCase()}var TOe={mdurl:pN,ucmicro:kB};var HB={};mn(HB,{parseLinkDestination:()=>BB,parseLinkLabel:()=>UB,parseLinkTitle:()=>qB});function UB(t,e,r){let n,o,s,a,c=t.posMax,u=t.pos;for(t.pos=e+1,n=1;t.pos<c;){if(s=t.src.charCodeAt(t.pos),s===93&&(n--,n===0)){o=!0;break}if(a=t.pos,t.md.inline.skipToken(t),s===91){if(a===t.pos-1)n++;else if(r)return t.pos=u,-1}}let l=-1;return o&&(l=t.pos),t.pos=u,l}function BB(t,e,r){let n,o=e,s={ok:!1,pos:0,lines:0,str:""};if(t.charCodeAt(o)===60){for(o++;o<r;){if(n=t.charCodeAt(o),n===10||n===60)return s;if(n===62)return s.pos=o+1,s.str=mh(t.slice(e+1,o)),s.ok=!0,s;if(n===92&&o+1<r){o+=2;continue}o++}return s}let a=0;for(;o<r&&(n=t.charCodeAt(o),!(n===32||n<32||n===127));){if(n===92&&o+1<r){if(t.charCodeAt(o+1)===32)break;o+=2;continue}if(n===40&&(a++,a>32))return s;if(n===41){if(a===0)break;a--}o++}return e===o||a!==0||(s.str=mh(t.slice(e,o)),s.pos=o,s.ok=!0),s}function qB(t,e,r){let n,o,s=0,a=e,c={ok:!1,pos:0,lines:0,str:""};if(a>=r||(o=t.charCodeAt(a),o!==34&&o!==39&&o!==40))return c;for(a++,o===40&&(o=41);a<r;){if(n=t.charCodeAt(a),n===o)return c.pos=a+1,c.lines=s,c.str=mh(t.slice(e+1,a)),c.ok=!0,c;if(n===40&&o===41)return c;n===10?s++:n===92&&a+1<r&&(a++,t.charCodeAt(a)===10&&s++),a++}return c}var pd={};pd.code_inline=function(t,e,r,n,o){let s=t[e];return"<code"+o.renderAttrs(s)+">"+sf(s.content)+"</code>"};pd.code_block=function(t,e,r,n,o){let s=t[e];return"<pre"+o.renderAttrs(s)+"><code>"+sf(t[e].content)+`</code></pre>
`};pd.fence=function(t,e,r,n,o){let s=t[e],a=s.info?mh(s.info).trim():"",c="",u="";if(a){let d=a.split(/(\s+)/g);c=d[0],u=d.slice(2).join("")}let l;if(r.highlight?l=r.highlight(s.content,c,u)||sf(s.content):l=sf(s.content),l.indexOf("<pre")===0)return l+`
`;if(a){let d=s.attrIndex("class"),p=s.attrs?s.attrs.slice():[];d<0?p.push(["class",r.langPrefix+c]):(p[d]=p[d].slice(),p[d][1]+=" "+r.langPrefix+c);let f={attrs:p};return`<pre><code${o.renderAttrs(f)}>${l}</code></pre>
`}return`<pre><code${o.renderAttrs(s)}>${l}</code></pre>
`};pd.image=function(t,e,r,n,o){let s=t[e];return s.attrs[s.attrIndex("alt")][1]=o.renderInlineAsText(s.children,r,n),o.renderToken(t,e,r)};pd.hardbreak=function(t,e,r){return r.xhtmlOut?`<br />
`:`<br>
`};pd.softbreak=function(t,e,r){return r.breaks?r.xhtmlOut?`<br />
`:`<br>
`:`
`};pd.text=function(t,e){return sf(t[e].content)};pd.html_block=function(t,e){return t[e].content};pd.html_inline=function(t,e){return t[e].content};function lx(){this.rules=ux({},pd)}lx.prototype.renderAttrs=function(e){let r,n,o;if(!e.attrs)return"";for(o="",r=0,n=e.attrs.length;r<n;r++)o+=" "+sf(e.attrs[r][0])+'="'+sf(e.attrs[r][1])+'"';return o};lx.prototype.renderToken=function(e,r,n){let o=e[r],s="";if(o.hidden)return"";o.block&&o.nesting!==-1&&r&&e[r-1].hidden&&(s+=`
`),s+=(o.nesting===-1?"</":"<")+o.tag,s+=this.renderAttrs(o),o.nesting===0&&n.xhtmlOut&&(s+=" /");let a=!1;if(o.block&&(a=!0,o.nesting===1&&r+1<e.length)){let c=e[r+1];(c.type==="inline"||c.hidden||c.nesting===-1&&c.tag===o.tag)&&(a=!1)}return s+=a?`>
`:">",s};lx.prototype.renderInline=function(t,e,r){let n="",o=this.rules;for(let s=0,a=t.length;s<a;s++){let c=t[s].type;typeof o[c]<"u"?n+=o[c](t,s,e,r,this):n+=this.renderToken(t,s,e)}return n};lx.prototype.renderInlineAsText=function(t,e,r){let n="";for(let o=0,s=t.length;o<s;o++)switch(t[o].type){case"text":n+=t[o].content;break;case"image":n+=this.renderInlineAsText(t[o].children,e,r);break;case"html_inline":case"html_block":n+=t[o].content;break;case"softbreak":case"hardbreak":n+=`
`;break;default:}return n};lx.prototype.render=function(t,e,r){let n="",o=this.rules;for(let s=0,a=t.length;s<a;s++){let c=t[s].type;c==="inline"?n+=this.renderInline(t[s].children,e,r):typeof o[c]<"u"?n+=o[c](t,s,e,r,this):n+=this.renderToken(t,s,e,r)}return n};var xoe=lx;function dl(){this.__rules__=[],this.__cache__=null}dl.prototype.__find__=function(t){for(let e=0;e<this.__rules__.length;e++)if(this.__rules__[e].name===t)return e;return-1};dl.prototype.__compile__=function(){let t=this,e=[""];t.__rules__.forEach(function(r){r.enabled&&r.alt.forEach(function(n){e.indexOf(n)<0&&e.push(n)})}),t.__cache__={},e.forEach(function(r){t.__cache__[r]=[],t.__rules__.forEach(function(n){n.enabled&&(r&&n.alt.indexOf(r)<0||t.__cache__[r].push(n.fn))})})};dl.prototype.at=function(t,e,r){let n=this.__find__(t),o=r||{};if(n===-1)throw new Error("Parser rule not found: "+t);this.__rules__[n].fn=e,this.__rules__[n].alt=o.alt||[],this.__cache__=null};dl.prototype.before=function(t,e,r,n){let o=this.__find__(t),s=n||{};if(o===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(o,0,{name:e,enabled:!0,fn:r,alt:s.alt||[]}),this.__cache__=null};dl.prototype.after=function(t,e,r,n){let o=this.__find__(t),s=n||{};if(o===-1)throw new Error("Parser rule not found: "+t);this.__rules__.splice(o+1,0,{name:e,enabled:!0,fn:r,alt:s.alt||[]}),this.__cache__=null};dl.prototype.push=function(t,e,r){let n=r||{};this.__rules__.push({name:t,enabled:!0,fn:e,alt:n.alt||[]}),this.__cache__=null};dl.prototype.enable=function(t,e){Array.isArray(t)||(t=[t]);let r=[];return t.forEach(function(n){let o=this.__find__(n);if(o<0){if(e)return;throw new Error("Rules manager: invalid rule name "+n)}this.__rules__[o].enabled=!0,r.push(n)},this),this.__cache__=null,r};dl.prototype.enableOnly=function(t,e){Array.isArray(t)||(t=[t]),this.__rules__.forEach(function(r){r.enabled=!1}),this.enable(t,e)};dl.prototype.disable=function(t,e){Array.isArray(t)||(t=[t]);let r=[];return t.forEach(function(n){let o=this.__find__(n);if(o<0){if(e)return;throw new Error("Rules manager: invalid rule name "+n)}this.__rules__[o].enabled=!1,r.push(n)},this),this.__cache__=null,r};dl.prototype.getRules=function(t){return this.__cache__===null&&this.__compile__(),this.__cache__[t]||[]};var $0=dl;function dx(t,e,r){this.type=t,this.tag=e,this.attrs=null,this.map=null,this.nesting=r,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}dx.prototype.attrIndex=function(e){if(!this.attrs)return-1;let r=this.attrs;for(let n=0,o=r.length;n<o;n++)if(r[n][0]===e)return n;return-1};dx.prototype.attrPush=function(e){this.attrs?this.attrs.push(e):this.attrs=[e]};dx.prototype.attrSet=function(e,r){let n=this.attrIndex(e),o=[e,r];n<0?this.attrPush(o):this.attrs[n]=o};dx.prototype.attrGet=function(e){let r=this.attrIndex(e),n=null;return r>=0&&(n=this.attrs[r][1]),n};dx.prototype.attrJoin=function(e,r){let n=this.attrIndex(e);n<0?this.attrPush([e,r]):this.attrs[n][1]=this.attrs[n][1]+" "+r};var af=dx;function Soe(t,e,r){this.src=t,this.env=r,this.tokens=[],this.inlineMode=!1,this.md=e}Soe.prototype.Token=af;var Ioe=Soe;var wOe=/\r\n?|\n/g,ROe=/\0/g;function jB(t){let e;e=t.src.replace(wOe,`
`),e=e.replace(ROe,"\uFFFD"),t.src=e}function VB(t){let e;t.inlineMode?(e=new t.Token("inline","",0),e.content=t.src,e.map=[0,1],e.children=[],t.tokens.push(e)):t.md.block.parse(t.src,t.md,t.env,t.tokens)}function GB(t){let e=t.tokens;for(let r=0,n=e.length;r<n;r++){let o=e[r];o.type==="inline"&&t.md.inline.parse(o.content,t.md,t.env,o.children)}}function kOe(t){return/^<a[>\s]/i.test(t)}function POe(t){return/^<\/a\s*>/i.test(t)}function zB(t){let e=t.tokens;if(t.md.options.linkify)for(let r=0,n=e.length;r<n;r++){if(e[r].type!=="inline"||!t.md.linkify.pretest(e[r].content))continue;let o=e[r].children,s=0;for(let a=o.length-1;a>=0;a--){let c=o[a];if(c.type==="link_close"){for(a--;o[a].level!==c.level&&o[a].type!=="link_open";)a--;continue}if(c.type==="html_inline"&&(kOe(c.content)&&s>0&&s--,POe(c.content)&&s++),!(s>0)&&c.type==="text"&&t.md.linkify.test(c.content)){let u=c.content,l=t.md.linkify.match(u),d=[],p=c.level,f=0;l.length>0&&l[0].index===0&&a>0&&o[a-1].type==="text_special"&&(l=l.slice(1));for(let m=0;m<l.length;m++){let h=l[m].url,g=t.md.normalizeLink(h);if(!t.md.validateLink(g))continue;let v=l[m].text;l[m].schema?l[m].schema==="mailto:"&&!/^mailto:/i.test(v)?v=t.md.normalizeLinkText("mailto:"+v).replace(/^mailto:/,""):v=t.md.normalizeLinkText(v):v=t.md.normalizeLinkText("http://"+v).replace(/^http:\/\//,"");let y=l[m].index;if(y>f){let I=new t.Token("text","",0);I.content=u.slice(f,y),I.level=p,d.push(I)}let b=new t.Token("link_open","a",1);b.attrs=[["href",g]],b.level=p++,b.markup="linkify",b.info="auto",d.push(b);let _=new t.Token("text","",0);_.content=v,_.level=p,d.push(_);let S=new t.Token("link_close","a",-1);S.level=--p,S.markup="linkify",S.info="auto",d.push(S),f=l[m].lastIndex}if(f<u.length){let m=new t.Token("text","",0);m.content=u.slice(f),m.level=p,d.push(m)}e[r].children=o=MB(o,a,d)}}}}var Coe=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,AOe=/\((c|tm|r)\)/i,DOe=/\((c|tm|r)\)/ig,NOe={c:"\xA9",r:"\xAE",tm:"\u2122"};function LOe(t,e){return NOe[e.toLowerCase()]}function OOe(t){let e=0;for(let r=t.length-1;r>=0;r--){let n=t[r];n.type==="text"&&!e&&(n.content=n.content.replace(DOe,LOe)),n.type==="link_open"&&n.info==="auto"&&e--,n.type==="link_close"&&n.info==="auto"&&e++}}function MOe(t){let e=0;for(let r=t.length-1;r>=0;r--){let n=t[r];n.type==="text"&&!e&&Coe.test(n.content)&&(n.content=n.content.replace(/\+-/g,"\xB1").replace(/\.{2,}/g,"\u2026").replace(/([?!])…/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1\u2014").replace(/(^|\s)--(?=\s|$)/mg,"$1\u2013").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1\u2013")),n.type==="link_open"&&n.info==="auto"&&e--,n.type==="link_close"&&n.info==="auto"&&e++}}function $B(t){let e;if(t.md.options.typographer)for(e=t.tokens.length-1;e>=0;e--)t.tokens[e].type==="inline"&&(AOe.test(t.tokens[e].content)&&OOe(t.tokens[e].children),Coe.test(t.tokens[e].content)&&MOe(t.tokens[e].children))}var FOe=/['"]/,Eoe=/['"]/g,Toe="\u2019";function _N(t,e,r){return t.slice(0,e)+r+t.slice(e+1)}function UOe(t,e){let r,n=[];for(let o=0;o<t.length;o++){let s=t[o],a=t[o].level;for(r=n.length-1;r>=0&&!(n[r].level<=a);r--);if(n.length=r+1,s.type!=="text")continue;let c=s.content,u=0,l=c.length;e:for(;u<l;){Eoe.lastIndex=u;let d=Eoe.exec(c);if(!d)break;let p=!0,f=!0;u=d.index+1;let m=d[0]==="'",h=32;if(d.index-1>=0)h=c.charCodeAt(d.index-1);else for(r=o-1;r>=0&&!(t[r].type==="softbreak"||t[r].type==="hardbreak");r--)if(t[r].content){h=t[r].content.charCodeAt(t[r].content.length-1);break}let g=32;if(u<l)g=c.charCodeAt(u);else for(r=o+1;r<t.length&&!(t[r].type==="softbreak"||t[r].type==="hardbreak");r++)if(t[r].content){g=t[r].content.charCodeAt(0);break}let v=G0(h)||V0(String.fromCharCode(h)),y=G0(g)||V0(String.fromCharCode(g)),b=j0(h),_=j0(g);if(_?p=!1:y&&(b||v||(p=!1)),b?f=!1:v&&(_||y||(f=!1)),g===34&&d[0]==='"'&&h>=48&&h<=57&&(f=p=!1),p&&f&&(p=v,f=y),!p&&!f){m&&(s.content=_N(s.content,d.index,Toe));continue}if(f)for(r=n.length-1;r>=0;r--){let S=n[r];if(n[r].level<a)break;if(S.single===m&&n[r].level===a){S=n[r];let I,T;m?(I=e.md.options.quotes[2],T=e.md.options.quotes[3]):(I=e.md.options.quotes[0],T=e.md.options.quotes[1]),s.content=_N(s.content,d.index,T),t[S.token].content=_N(t[S.token].content,S.pos,I),u+=T.length-1,S.token===o&&(u+=I.length-1),c=s.content,l=c.length,n.length=r;continue e}}p?n.push({token:o,pos:d.index,single:m,level:a}):f&&m&&(s.content=_N(s.content,d.index,Toe))}}}function WB(t){if(t.md.options.typographer)for(let e=t.tokens.length-1;e>=0;e--)t.tokens[e].type!=="inline"||!FOe.test(t.tokens[e].content)||UOe(t.tokens[e].children,t)}function KB(t){let e,r,n=t.tokens,o=n.length;for(let s=0;s<o;s++){if(n[s].type!=="inline")continue;let a=n[s].children,c=a.length;for(e=0;e<c;e++)a[e].type==="text_special"&&(a[e].type="text");for(e=r=0;e<c;e++)a[e].type==="text"&&e+1<c&&a[e+1].type==="text"?a[e+1].content=a[e].content+a[e+1].content:(e!==r&&(a[r]=a[e]),r++);e!==r&&(a.length=r)}}var YB=[["normalize",jB],["block",VB],["inline",GB],["linkify",zB],["replacements",$B],["smartquotes",WB],["text_join",KB]];function QB(){this.ruler=new $0;for(let t=0;t<YB.length;t++)this.ruler.push(YB[t][0],YB[t][1])}QB.prototype.process=function(t){let e=this.ruler.getRules("");for(let r=0,n=e.length;r<n;r++)e[r](t)};QB.prototype.State=Ioe;var woe=QB;function fd(t,e,r,n){this.src=t,this.md=e,this.env=r,this.tokens=n,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;let o=this.src;for(let s=0,a=0,c=0,u=0,l=o.length,d=!1;a<l;a++){let p=o.charCodeAt(a);if(!d)if(pr(p)){c++,p===9?u+=4-u%4:u++;continue}else d=!0;(p===10||a===l-1)&&(p!==10&&a++,this.bMarks.push(s),this.eMarks.push(a),this.tShift.push(c),this.sCount.push(u),this.bsCount.push(0),d=!1,c=0,u=0,s=a+1)}this.bMarks.push(o.length),this.eMarks.push(o.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}fd.prototype.push=function(t,e,r){let n=new af(t,e,r);return n.block=!0,r<0&&this.level--,n.level=this.level,r>0&&this.level++,this.tokens.push(n),n};fd.prototype.isEmpty=function(e){return this.bMarks[e]+this.tShift[e]>=this.eMarks[e]};fd.prototype.skipEmptyLines=function(e){for(let r=this.lineMax;e<r&&!(this.bMarks[e]+this.tShift[e]<this.eMarks[e]);e++);return e};fd.prototype.skipSpaces=function(e){for(let r=this.src.length;e<r;e++){let n=this.src.charCodeAt(e);if(!pr(n))break}return e};fd.prototype.skipSpacesBack=function(e,r){if(e<=r)return e;for(;e>r;)if(!pr(this.src.charCodeAt(--e)))return e+1;return e};fd.prototype.skipChars=function(e,r){for(let n=this.src.length;e<n&&this.src.charCodeAt(e)===r;e++);return e};fd.prototype.skipCharsBack=function(e,r,n){if(e<=n)return e;for(;e>n;)if(r!==this.src.charCodeAt(--e))return e+1;return e};fd.prototype.getLines=function(e,r,n,o){if(e>=r)return"";let s=new Array(r-e);for(let a=0,c=e;c<r;c++,a++){let u=0,l=this.bMarks[c],d=l,p;for(c+1<r||o?p=this.eMarks[c]+1:p=this.eMarks[c];d<p&&u<n;){let f=this.src.charCodeAt(d);if(pr(f))f===9?u+=4-(u+this.bsCount[c])%4:u++;else if(d-l<this.tShift[c])u++;else break;d++}u>n?s[a]=new Array(u-n+1).join(" ")+this.src.slice(d,p):s[a]=this.src.slice(d,p)}return s.join("")};fd.prototype.Token=af;var Roe=fd;function XB(t,e){let r=t.bMarks[e]+t.tShift[e],n=t.eMarks[e];return t.src.slice(r,n)}function koe(t){let e=[],r=t.length,n=0,o=t.charCodeAt(n),s=!1,a=0,c="";for(;n<r;)o===124&&(s?(c+=t.substring(a,n-1),a=n):(e.push(c+t.substring(a,n)),c="",a=n+1)),s=o===92,n++,o=t.charCodeAt(n);return e.push(c+t.substring(a)),e}function JB(t,e,r,n){if(e+2>r)return!1;let o=e+1;if(t.sCount[o]<t.blkIndent||t.sCount[o]-t.blkIndent>=4)return!1;let s=t.bMarks[o]+t.tShift[o];if(s>=t.eMarks[o])return!1;let a=t.src.charCodeAt(s++);if(a!==124&&a!==45&&a!==58||s>=t.eMarks[o])return!1;let c=t.src.charCodeAt(s++);if(c!==124&&c!==45&&c!==58&&!pr(c)||a===45&&pr(c))return!1;for(;s<t.eMarks[o];){let _=t.src.charCodeAt(s);if(_!==124&&_!==45&&_!==58&&!pr(_))return!1;s++}let u=XB(t,e+1),l=u.split("|"),d=[];for(let _=0;_<l.length;_++){let S=l[_].trim();if(!S){if(_===0||_===l.length-1)continue;return!1}if(!/^:?-+:?$/.test(S))return!1;S.charCodeAt(S.length-1)===58?d.push(S.charCodeAt(0)===58?"center":"right"):S.charCodeAt(0)===58?d.push("left"):d.push("")}if(u=XB(t,e).trim(),u.indexOf("|")===-1||t.sCount[e]-t.blkIndent>=4)return!1;l=koe(u),l.length&&l[0]===""&&l.shift(),l.length&&l[l.length-1]===""&&l.pop();let p=l.length;if(p===0||p!==d.length)return!1;if(n)return!0;let f=t.parentType;t.parentType="table";let m=t.md.block.ruler.getRules("blockquote"),h=t.push("table_open","table",1),g=[e,0];h.map=g;let v=t.push("thead_open","thead",1);v.map=[e,e+1];let y=t.push("tr_open","tr",1);y.map=[e,e+1];for(let _=0;_<l.length;_++){let S=t.push("th_open","th",1);d[_]&&(S.attrs=[["style","text-align:"+d[_]]]);let I=t.push("inline","",0);I.content=l[_].trim(),I.children=[],t.push("th_close","th",-1)}t.push("tr_close","tr",-1),t.push("thead_close","thead",-1);let b;for(o=e+2;o<r&&!(t.sCount[o]<t.blkIndent);o++){let _=!1;for(let I=0,T=m.length;I<T;I++)if(m[I](t,o,r,!0)){_=!0;break}if(_||(u=XB(t,o).trim(),!u)||t.sCount[o]-t.blkIndent>=4)break;if(l=koe(u),l.length&&l[0]===""&&l.shift(),l.length&&l[l.length-1]===""&&l.pop(),o===e+2){let I=t.push("tbody_open","tbody",1);I.map=b=[e+2,0]}let S=t.push("tr_open","tr",1);S.map=[o,o+1];for(let I=0;I<p;I++){let T=t.push("td_open","td",1);d[I]&&(T.attrs=[["style","text-align:"+d[I]]]);let A=t.push("inline","",0);A.content=l[I]?l[I].trim():"",A.children=[],t.push("td_close","td",-1)}t.push("tr_close","tr",-1)}return b&&(t.push("tbody_close","tbody",-1),b[1]=o),t.push("table_close","table",-1),g[1]=o,t.parentType=f,t.line=o,!0}function ZB(t,e,r){if(t.sCount[e]-t.blkIndent<4)return!1;let n=e+1,o=n;for(;n<r;){if(t.isEmpty(n)){n++;continue}if(t.sCount[n]-t.blkIndent>=4){n++,o=n;continue}break}t.line=o;let s=t.push("code_block","code",0);return s.content=t.getLines(e,o,4+t.blkIndent,!1)+`
`,s.map=[e,t.line],!0}function eq(t,e,r,n){let o=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4||o+3>s)return!1;let a=t.src.charCodeAt(o);if(a!==126&&a!==96)return!1;let c=o;o=t.skipChars(o,a);let u=o-c;if(u<3)return!1;let l=t.src.slice(c,o),d=t.src.slice(o,s);if(a===96&&d.indexOf(String.fromCharCode(a))>=0)return!1;if(n)return!0;let p=e,f=!1;for(;p++,!(p>=r||(o=c=t.bMarks[p]+t.tShift[p],s=t.eMarks[p],o<s&&t.sCount[p]<t.blkIndent));)if(t.src.charCodeAt(o)===a&&!(t.sCount[p]-t.blkIndent>=4)&&(o=t.skipChars(o,a),!(o-c<u)&&(o=t.skipSpaces(o),!(o<s)))){f=!0;break}u=t.sCount[e],t.line=p+(f?1:0);let m=t.push("fence","code",0);return m.info=d,m.content=t.getLines(e+1,p,u,!0),m.markup=l,m.map=[e,t.line],!0}function tq(t,e,r,n){let o=t.bMarks[e]+t.tShift[e],s=t.eMarks[e],a=t.lineMax;if(t.sCount[e]-t.blkIndent>=4||t.src.charCodeAt(o)!==62)return!1;if(n)return!0;let c=[],u=[],l=[],d=[],p=t.md.block.ruler.getRules("blockquote"),f=t.parentType;t.parentType="blockquote";let m=!1,h;for(h=e;h<r;h++){let _=t.sCount[h]<t.blkIndent;if(o=t.bMarks[h]+t.tShift[h],s=t.eMarks[h],o>=s)break;if(t.src.charCodeAt(o++)===62&&!_){let I=t.sCount[h]+1,T,A;t.src.charCodeAt(o)===32?(o++,I++,A=!1,T=!0):t.src.charCodeAt(o)===9?(T=!0,(t.bsCount[h]+I)%4===3?(o++,I++,A=!1):A=!0):T=!1;let B=I;for(c.push(t.bMarks[h]),t.bMarks[h]=o;o<s;){let j=t.src.charCodeAt(o);if(pr(j))j===9?B+=4-(B+t.bsCount[h]+(A?1:0))%4:B++;else break;o++}m=o>=s,u.push(t.bsCount[h]),t.bsCount[h]=t.sCount[h]+1+(T?1:0),l.push(t.sCount[h]),t.sCount[h]=B-I,d.push(t.tShift[h]),t.tShift[h]=o-t.bMarks[h];continue}if(m)break;let S=!1;for(let I=0,T=p.length;I<T;I++)if(p[I](t,h,r,!0)){S=!0;break}if(S){t.lineMax=h,t.blkIndent!==0&&(c.push(t.bMarks[h]),u.push(t.bsCount[h]),d.push(t.tShift[h]),l.push(t.sCount[h]),t.sCount[h]-=t.blkIndent);break}c.push(t.bMarks[h]),u.push(t.bsCount[h]),d.push(t.tShift[h]),l.push(t.sCount[h]),t.sCount[h]=-1}let g=t.blkIndent;t.blkIndent=0;let v=t.push("blockquote_open","blockquote",1);v.markup=">";let y=[e,0];v.map=y,t.md.block.tokenize(t,e,h);let b=t.push("blockquote_close","blockquote",-1);b.markup=">",t.lineMax=a,t.parentType=f,y[1]=t.line;for(let _=0;_<d.length;_++)t.bMarks[_+e]=c[_],t.tShift[_+e]=d[_],t.sCount[_+e]=l[_],t.bsCount[_+e]=u[_];return t.blkIndent=g,!0}function rq(t,e,r,n){let o=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let s=t.bMarks[e]+t.tShift[e],a=t.src.charCodeAt(s++);if(a!==42&&a!==45&&a!==95)return!1;let c=1;for(;s<o;){let l=t.src.charCodeAt(s++);if(l!==a&&!pr(l))return!1;l===a&&c++}if(c<3)return!1;if(n)return!0;t.line=e+1;let u=t.push("hr","hr",0);return u.map=[e,t.line],u.markup=Array(c+1).join(String.fromCharCode(a)),!0}function Poe(t,e){let r=t.eMarks[e],n=t.bMarks[e]+t.tShift[e],o=t.src.charCodeAt(n++);if(o!==42&&o!==45&&o!==43)return-1;if(n<r){let s=t.src.charCodeAt(n);if(!pr(s))return-1}return n}function Aoe(t,e){let r=t.bMarks[e]+t.tShift[e],n=t.eMarks[e],o=r;if(o+1>=n)return-1;let s=t.src.charCodeAt(o++);if(s<48||s>57)return-1;for(;;){if(o>=n)return-1;if(s=t.src.charCodeAt(o++),s>=48&&s<=57){if(o-r>=10)return-1;continue}if(s===41||s===46)break;return-1}return o<n&&(s=t.src.charCodeAt(o),!pr(s))?-1:o}function BOe(t,e){let r=t.level+2;for(let n=e+2,o=t.tokens.length-2;n<o;n++)t.tokens[n].level===r&&t.tokens[n].type==="paragraph_open"&&(t.tokens[n+2].hidden=!0,t.tokens[n].hidden=!0,n+=2)}function nq(t,e,r,n){let o,s,a,c,u=e,l=!0;if(t.sCount[u]-t.blkIndent>=4||t.listIndent>=0&&t.sCount[u]-t.listIndent>=4&&t.sCount[u]<t.blkIndent)return!1;let d=!1;n&&t.parentType==="paragraph"&&t.sCount[u]>=t.blkIndent&&(d=!0);let p,f,m;if((m=Aoe(t,u))>=0){if(p=!0,a=t.bMarks[u]+t.tShift[u],f=Number(t.src.slice(a,m-1)),d&&f!==1)return!1}else if((m=Poe(t,u))>=0)p=!1;else return!1;if(d&&t.skipSpaces(m)>=t.eMarks[u])return!1;if(n)return!0;let h=t.src.charCodeAt(m-1),g=t.tokens.length;p?(c=t.push("ordered_list_open","ol",1),f!==1&&(c.attrs=[["start",f]])):c=t.push("bullet_list_open","ul",1);let v=[u,0];c.map=v,c.markup=String.fromCharCode(h);let y=!1,b=t.md.block.ruler.getRules("list"),_=t.parentType;for(t.parentType="list";u<r;){s=m,o=t.eMarks[u];let S=t.sCount[u]+m-(t.bMarks[u]+t.tShift[u]),I=S;for(;s<o;){let P=t.src.charCodeAt(s);if(P===9)I+=4-(I+t.bsCount[u])%4;else if(P===32)I++;else break;s++}let T=s,A;T>=o?A=1:A=I-S,A>4&&(A=1);let B=S+A;c=t.push("list_item_open","li",1),c.markup=String.fromCharCode(h);let j=[u,0];c.map=j,p&&(c.info=t.src.slice(a,m-1));let F=t.tight,ne=t.tShift[u],Y=t.sCount[u],N=t.listIndent;if(t.listIndent=t.blkIndent,t.blkIndent=B,t.tight=!0,t.tShift[u]=T-t.bMarks[u],t.sCount[u]=I,T>=o&&t.isEmpty(u+1)?t.line=Math.min(t.line+2,r):t.md.block.tokenize(t,u,r,!0),(!t.tight||y)&&(l=!1),y=t.line-u>1&&t.isEmpty(t.line-1),t.blkIndent=t.listIndent,t.listIndent=N,t.tShift[u]=ne,t.sCount[u]=Y,t.tight=F,c=t.push("list_item_close","li",-1),c.markup=String.fromCharCode(h),u=t.line,j[1]=u,u>=r||t.sCount[u]<t.blkIndent||t.sCount[u]-t.blkIndent>=4)break;let w=!1;for(let P=0,q=b.length;P<q;P++)if(b[P](t,u,r,!0)){w=!0;break}if(w)break;if(p){if(m=Aoe(t,u),m<0)break;a=t.bMarks[u]+t.tShift[u]}else if(m=Poe(t,u),m<0)break;if(h!==t.src.charCodeAt(m-1))break}return p?c=t.push("ordered_list_close","ol",-1):c=t.push("bullet_list_close","ul",-1),c.markup=String.fromCharCode(h),v[1]=u,t.line=u,t.parentType=_,l&&BOe(t,g),!0}function iq(t,e,r,n){let o=0,s=t.bMarks[e]+t.tShift[e],a=t.eMarks[e],c=e+1;if(t.sCount[e]-t.blkIndent>=4||t.src.charCodeAt(s)!==91)return!1;for(;++s<a;)if(t.src.charCodeAt(s)===93&&t.src.charCodeAt(s-1)!==92){if(s+1===a||t.src.charCodeAt(s+1)!==58)return!1;break}let u=t.lineMax,l=t.md.block.ruler.getRules("reference"),d=t.parentType;for(t.parentType="reference";c<u&&!t.isEmpty(c);c++){if(t.sCount[c]-t.blkIndent>3||t.sCount[c]<0)continue;let I=!1;for(let T=0,A=l.length;T<A;T++)if(l[T](t,c,u,!0)){I=!0;break}if(I)break}let p=t.getLines(e,c,t.blkIndent,!1).trim();a=p.length;let f=-1;for(s=1;s<a;s++){let I=p.charCodeAt(s);if(I===91)return!1;if(I===93){f=s;break}else I===10?o++:I===92&&(s++,s<a&&p.charCodeAt(s)===10&&o++)}if(f<0||p.charCodeAt(f+1)!==58)return!1;for(s=f+2;s<a;s++){let I=p.charCodeAt(s);if(I===10)o++;else if(!pr(I))break}let m=t.md.helpers.parseLinkDestination(p,s,a);if(!m.ok)return!1;let h=t.md.normalizeLink(m.str);if(!t.md.validateLink(h))return!1;s=m.pos,o+=m.lines;let g=s,v=o,y=s;for(;s<a;s++){let I=p.charCodeAt(s);if(I===10)o++;else if(!pr(I))break}let b=t.md.helpers.parseLinkTitle(p,s,a),_;for(s<a&&y!==s&&b.ok?(_=b.str,s=b.pos,o+=b.lines):(_="",s=g,o=v);s<a;){let I=p.charCodeAt(s);if(!pr(I))break;s++}if(s<a&&p.charCodeAt(s)!==10&&_)for(_="",s=g,o=v;s<a;){let I=p.charCodeAt(s);if(!pr(I))break;s++}if(s<a&&p.charCodeAt(s)!==10)return!1;let S=z0(p.slice(1,f));return S?(n||(typeof t.env.references>"u"&&(t.env.references={}),typeof t.env.references[S]>"u"&&(t.env.references[S]={title:_,href:h}),t.parentType=d,t.line=e+o+1),!0):!1}var Doe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"];var qOe="[a-zA-Z_:][a-zA-Z0-9:._-]*",HOe="[^\"'=<>`\\x00-\\x20]+",jOe="'[^']*'",VOe='"[^"]*"',GOe="(?:"+HOe+"|"+jOe+"|"+VOe+")",zOe="(?:\\s+"+qOe+"(?:\\s*=\\s*"+GOe+")?)",Noe="<[A-Za-z][A-Za-z0-9\\-]*"+zOe+"*\\s*\\/?>",Loe="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",$Oe="<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->",WOe="<[?][\\s\\S]*?[?]>",KOe="<![A-Z]+\\s+[^>]*>",YOe="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",Ooe=new RegExp("^(?:"+Noe+"|"+Loe+"|"+$Oe+"|"+WOe+"|"+KOe+"|"+YOe+")"),Moe=new RegExp("^(?:"+Noe+"|"+Loe+")");var px=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+Doe.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(Moe.source+"\\s*$"),/^$/,!1]];function oq(t,e,r,n){let o=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4||!t.md.options.html||t.src.charCodeAt(o)!==60)return!1;let a=t.src.slice(o,s),c=0;for(;c<px.length&&!px[c][0].test(a);c++);if(c===px.length)return!1;if(n)return px[c][2];let u=e+1;if(!px[c][1].test(a)){for(;u<r&&!(t.sCount[u]<t.blkIndent);u++)if(o=t.bMarks[u]+t.tShift[u],s=t.eMarks[u],a=t.src.slice(o,s),px[c][1].test(a)){a.length!==0&&u++;break}}t.line=u;let l=t.push("html_block","",0);return l.map=[e,u],l.content=t.getLines(e,u,t.blkIndent,!0),!0}function sq(t,e,r,n){let o=t.bMarks[e]+t.tShift[e],s=t.eMarks[e];if(t.sCount[e]-t.blkIndent>=4)return!1;let a=t.src.charCodeAt(o);if(a!==35||o>=s)return!1;let c=1;for(a=t.src.charCodeAt(++o);a===35&&o<s&&c<=6;)c++,a=t.src.charCodeAt(++o);if(c>6||o<s&&!pr(a))return!1;if(n)return!0;s=t.skipSpacesBack(s,o);let u=t.skipCharsBack(s,35,o);u>o&&pr(t.src.charCodeAt(u-1))&&(s=u),t.line=e+1;let l=t.push("heading_open","h"+String(c),1);l.markup="########".slice(0,c),l.map=[e,t.line];let d=t.push("inline","",0);d.content=t.src.slice(o,s).trim(),d.map=[e,t.line],d.children=[];let p=t.push("heading_close","h"+String(c),-1);return p.markup="########".slice(0,c),!0}function aq(t,e,r){let n=t.md.block.ruler.getRules("paragraph");if(t.sCount[e]-t.blkIndent>=4)return!1;let o=t.parentType;t.parentType="paragraph";let s=0,a,c=e+1;for(;c<r&&!t.isEmpty(c);c++){if(t.sCount[c]-t.blkIndent>3)continue;if(t.sCount[c]>=t.blkIndent){let m=t.bMarks[c]+t.tShift[c],h=t.eMarks[c];if(m<h&&(a=t.src.charCodeAt(m),(a===45||a===61)&&(m=t.skipChars(m,a),m=t.skipSpaces(m),m>=h))){s=a===61?1:2;break}}if(t.sCount[c]<0)continue;let f=!1;for(let m=0,h=n.length;m<h;m++)if(n[m](t,c,r,!0)){f=!0;break}if(f)break}if(!s)return!1;let u=t.getLines(e,c,t.blkIndent,!1).trim();t.line=c+1;let l=t.push("heading_open","h"+String(s),1);l.markup=String.fromCharCode(a),l.map=[e,t.line];let d=t.push("inline","",0);d.content=u,d.map=[e,t.line-1],d.children=[];let p=t.push("heading_close","h"+String(s),-1);return p.markup=String.fromCharCode(a),t.parentType=o,!0}function cq(t,e,r){let n=t.md.block.ruler.getRules("paragraph"),o=t.parentType,s=e+1;for(t.parentType="paragraph";s<r&&!t.isEmpty(s);s++){if(t.sCount[s]-t.blkIndent>3||t.sCount[s]<0)continue;let l=!1;for(let d=0,p=n.length;d<p;d++)if(n[d](t,s,r,!0)){l=!0;break}if(l)break}let a=t.getLines(e,s,t.blkIndent,!1).trim();t.line=s;let c=t.push("paragraph_open","p",1);c.map=[e,t.line];let u=t.push("inline","",0);return u.content=a,u.map=[e,t.line],u.children=[],t.push("paragraph_close","p",-1),t.parentType=o,!0}var xN=[["table",JB,["paragraph","reference"]],["code",ZB],["fence",eq,["paragraph","reference","blockquote","list"]],["blockquote",tq,["paragraph","reference","blockquote","list"]],["hr",rq,["paragraph","reference","blockquote","list"]],["list",nq,["paragraph","reference","blockquote"]],["reference",iq],["html_block",oq,["paragraph","reference","blockquote"]],["heading",sq,["paragraph","reference","blockquote"]],["lheading",aq],["paragraph",cq]];function SN(){this.ruler=new $0;for(let t=0;t<xN.length;t++)this.ruler.push(xN[t][0],xN[t][1],{alt:(xN[t][2]||[]).slice()})}SN.prototype.tokenize=function(t,e,r){let n=this.ruler.getRules(""),o=n.length,s=t.md.options.maxNesting,a=e,c=!1;for(;a<r&&(t.line=a=t.skipEmptyLines(a),!(a>=r||t.sCount[a]<t.blkIndent));){if(t.level>=s){t.line=r;break}let u=t.line,l=!1;for(let d=0;d<o;d++)if(l=n[d](t,a,r,!1),l){if(u>=t.line)throw new Error("block rule didn't increment state.line");break}if(!l)throw new Error("none of the block rules matched");t.tight=!c,t.isEmpty(t.line-1)&&(c=!0),a=t.line,a<r&&t.isEmpty(a)&&(c=!0,a++,t.line=a)}};SN.prototype.parse=function(t,e,r,n){if(!t)return;let o=new this.State(t,e,r,n);this.tokenize(o,o.line,o.lineMax)};SN.prototype.State=Roe;var Foe=SN;function vw(t,e,r,n){this.src=t,this.env=r,this.md=e,this.tokens=n,this.tokens_meta=Array(n.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}vw.prototype.pushPending=function(){let t=new af("text","",0);return t.content=this.pending,t.level=this.pendingLevel,this.tokens.push(t),this.pending="",t};vw.prototype.push=function(t,e,r){this.pending&&this.pushPending();let n=new af(t,e,r),o=null;return r<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),n.level=this.level,r>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],o={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(n),this.tokens_meta.push(o),n};vw.prototype.scanDelims=function(t,e){let r,n,o=!0,s=!0,a=this.posMax,c=this.src.charCodeAt(t),u=t>0?this.src.charCodeAt(t-1):32,l=t;for(;l<a&&this.src.charCodeAt(l)===c;)l++;let d=l-t,p=l<a?this.src.charCodeAt(l):32,f=G0(u)||V0(String.fromCharCode(u)),m=G0(p)||V0(String.fromCharCode(p)),h=j0(u),g=j0(p);return g?o=!1:m&&(h||f||(o=!1)),h?s=!1:f&&(g||m||(s=!1)),e?(r=o,n=s):(r=o&&(!s||f),n=s&&(!o||m)),{can_open:r,can_close:n,length:d}};vw.prototype.Token=af;var Uoe=vw;function QOe(t){switch(t){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function uq(t,e){let r=t.pos;for(;r<t.posMax&&!QOe(t.src.charCodeAt(r));)r++;return r===t.pos?!1:(e||(t.pending+=t.src.slice(t.pos,r)),t.pos=r,!0)}var XOe=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function lq(t,e){if(!t.md.options.linkify||t.linkLevel>0)return!1;let r=t.pos,n=t.posMax;if(r+3>n||t.src.charCodeAt(r)!==58||t.src.charCodeAt(r+1)!==47||t.src.charCodeAt(r+2)!==47)return!1;let o=t.pending.match(XOe);if(!o)return!1;let s=o[1],a=t.md.linkify.matchAtStart(t.src.slice(r-s.length));if(!a)return!1;let c=a.url;if(c.length<=s.length)return!1;c=c.replace(/\*+$/,"");let u=t.md.normalizeLink(c);if(!t.md.validateLink(u))return!1;if(!e){t.pending=t.pending.slice(0,-s.length);let l=t.push("link_open","a",1);l.attrs=[["href",u]],l.markup="linkify",l.info="auto";let d=t.push("text","",0);d.content=t.md.normalizeLinkText(c);let p=t.push("link_close","a",-1);p.markup="linkify",p.info="auto"}return t.pos+=c.length-s.length,!0}function dq(t,e){let r=t.pos;if(t.src.charCodeAt(r)!==10)return!1;let n=t.pending.length-1,o=t.posMax;if(!e)if(n>=0&&t.pending.charCodeAt(n)===32)if(n>=1&&t.pending.charCodeAt(n-1)===32){let s=n-1;for(;s>=1&&t.pending.charCodeAt(s-1)===32;)s--;t.pending=t.pending.slice(0,s),t.push("hardbreak","br",0)}else t.pending=t.pending.slice(0,-1),t.push("softbreak","br",0);else t.push("softbreak","br",0);for(r++;r<o&&pr(t.src.charCodeAt(r));)r++;return t.pos=r,!0}var pq=[];for(let t=0;t<256;t++)pq.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(t){pq[t.charCodeAt(0)]=1});function fq(t,e){let r=t.pos,n=t.posMax;if(t.src.charCodeAt(r)!==92||(r++,r>=n))return!1;let o=t.src.charCodeAt(r);if(o===10){for(e||t.push("hardbreak","br",0),r++;r<n&&(o=t.src.charCodeAt(r),!!pr(o));)r++;return t.pos=r,!0}let s=t.src[r];if(o>=55296&&o<=56319&&r+1<n){let c=t.src.charCodeAt(r+1);c>=56320&&c<=57343&&(s+=t.src[r+1],r++)}let a="\\"+s;if(!e){let c=t.push("text_special","",0);o<256&&pq[o]!==0?c.content=s:c.content=a,c.markup=a,c.info="escape"}return t.pos=r+1,!0}function mq(t,e){let r=t.pos;if(t.src.charCodeAt(r)!==96)return!1;let o=r;r++;let s=t.posMax;for(;r<s&&t.src.charCodeAt(r)===96;)r++;let a=t.src.slice(o,r),c=a.length;if(t.backticksScanned&&(t.backticks[c]||0)<=o)return e||(t.pending+=a),t.pos+=c,!0;let u=r,l;for(;(l=t.src.indexOf("`",u))!==-1;){for(u=l+1;u<s&&t.src.charCodeAt(u)===96;)u++;let d=u-l;if(d===c){if(!e){let p=t.push("code_inline","code",0);p.markup=a,p.content=t.src.slice(r,l).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return t.pos=u,!0}t.backticks[d]=l}return t.backticksScanned=!0,e||(t.pending+=a),t.pos+=c,!0}function JOe(t,e){let r=t.pos,n=t.src.charCodeAt(r);if(e||n!==126)return!1;let o=t.scanDelims(t.pos,!0),s=o.length,a=String.fromCharCode(n);if(s<2)return!1;let c;s%2&&(c=t.push("text","",0),c.content=a,s--);for(let u=0;u<s;u+=2)c=t.push("text","",0),c.content=a+a,t.delimiters.push({marker:n,length:0,token:t.tokens.length-1,end:-1,open:o.can_open,close:o.can_close});return t.pos+=o.length,!0}function Boe(t,e){let r,n=[],o=e.length;for(let s=0;s<o;s++){let a=e[s];if(a.marker!==126||a.end===-1)continue;let c=e[a.end];r=t.tokens[a.token],r.type="s_open",r.tag="s",r.nesting=1,r.markup="~~",r.content="",r=t.tokens[c.token],r.type="s_close",r.tag="s",r.nesting=-1,r.markup="~~",r.content="",t.tokens[c.token-1].type==="text"&&t.tokens[c.token-1].content==="~"&&n.push(c.token-1)}for(;n.length;){let s=n.pop(),a=s+1;for(;a<t.tokens.length&&t.tokens[a].type==="s_close";)a++;a--,s!==a&&(r=t.tokens[a],t.tokens[a]=t.tokens[s],t.tokens[s]=r)}}function ZOe(t){let e=t.tokens_meta,r=t.tokens_meta.length;Boe(t,t.delimiters);for(let n=0;n<r;n++)e[n]&&e[n].delimiters&&Boe(t,e[n].delimiters)}var hq={tokenize:JOe,postProcess:ZOe};function e3e(t,e){let r=t.pos,n=t.src.charCodeAt(r);if(e||n!==95&&n!==42)return!1;let o=t.scanDelims(t.pos,n===42);for(let s=0;s<o.length;s++){let a=t.push("text","",0);a.content=String.fromCharCode(n),t.delimiters.push({marker:n,length:o.length,token:t.tokens.length-1,end:-1,open:o.can_open,close:o.can_close})}return t.pos+=o.length,!0}function qoe(t,e){let r=e.length;for(let n=r-1;n>=0;n--){let o=e[n];if(o.marker!==95&&o.marker!==42||o.end===-1)continue;let s=e[o.end],a=n>0&&e[n-1].end===o.end+1&&e[n-1].marker===o.marker&&e[n-1].token===o.token-1&&e[o.end+1].token===s.token+1,c=String.fromCharCode(o.marker),u=t.tokens[o.token];u.type=a?"strong_open":"em_open",u.tag=a?"strong":"em",u.nesting=1,u.markup=a?c+c:c,u.content="";let l=t.tokens[s.token];l.type=a?"strong_close":"em_close",l.tag=a?"strong":"em",l.nesting=-1,l.markup=a?c+c:c,l.content="",a&&(t.tokens[e[n-1].token].content="",t.tokens[e[o.end+1].token].content="",n--)}}function t3e(t){let e=t.tokens_meta,r=t.tokens_meta.length;qoe(t,t.delimiters);for(let n=0;n<r;n++)e[n]&&e[n].delimiters&&qoe(t,e[n].delimiters)}var gq={tokenize:e3e,postProcess:t3e};function vq(t,e){let r,n,o,s,a="",c="",u=t.pos,l=!0;if(t.src.charCodeAt(t.pos)!==91)return!1;let d=t.pos,p=t.posMax,f=t.pos+1,m=t.md.helpers.parseLinkLabel(t,t.pos,!0);if(m<0)return!1;let h=m+1;if(h<p&&t.src.charCodeAt(h)===40){for(l=!1,h++;h<p&&(r=t.src.charCodeAt(h),!(!pr(r)&&r!==10));h++);if(h>=p)return!1;if(u=h,o=t.md.helpers.parseLinkDestination(t.src,h,t.posMax),o.ok){for(a=t.md.normalizeLink(o.str),t.md.validateLink(a)?h=o.pos:a="",u=h;h<p&&(r=t.src.charCodeAt(h),!(!pr(r)&&r!==10));h++);if(o=t.md.helpers.parseLinkTitle(t.src,h,t.posMax),h<p&&u!==h&&o.ok)for(c=o.str,h=o.pos;h<p&&(r=t.src.charCodeAt(h),!(!pr(r)&&r!==10));h++);}(h>=p||t.src.charCodeAt(h)!==41)&&(l=!0),h++}if(l){if(typeof t.env.references>"u")return!1;if(h<p&&t.src.charCodeAt(h)===91?(u=h+1,h=t.md.helpers.parseLinkLabel(t,h),h>=0?n=t.src.slice(u,h++):h=m+1):h=m+1,n||(n=t.src.slice(f,m)),s=t.env.references[z0(n)],!s)return t.pos=d,!1;a=s.href,c=s.title}if(!e){t.pos=f,t.posMax=m;let g=t.push("link_open","a",1),v=[["href",a]];g.attrs=v,c&&v.push(["title",c]),t.linkLevel++,t.md.inline.tokenize(t),t.linkLevel--,t.push("link_close","a",-1)}return t.pos=h,t.posMax=p,!0}function yq(t,e){let r,n,o,s,a,c,u,l,d="",p=t.pos,f=t.posMax;if(t.src.charCodeAt(t.pos)!==33||t.src.charCodeAt(t.pos+1)!==91)return!1;let m=t.pos+2,h=t.md.helpers.parseLinkLabel(t,t.pos+1,!1);if(h<0)return!1;if(s=h+1,s<f&&t.src.charCodeAt(s)===40){for(s++;s<f&&(r=t.src.charCodeAt(s),!(!pr(r)&&r!==10));s++);if(s>=f)return!1;for(l=s,c=t.md.helpers.parseLinkDestination(t.src,s,t.posMax),c.ok&&(d=t.md.normalizeLink(c.str),t.md.validateLink(d)?s=c.pos:d=""),l=s;s<f&&(r=t.src.charCodeAt(s),!(!pr(r)&&r!==10));s++);if(c=t.md.helpers.parseLinkTitle(t.src,s,t.posMax),s<f&&l!==s&&c.ok)for(u=c.str,s=c.pos;s<f&&(r=t.src.charCodeAt(s),!(!pr(r)&&r!==10));s++);else u="";if(s>=f||t.src.charCodeAt(s)!==41)return t.pos=p,!1;s++}else{if(typeof t.env.references>"u")return!1;if(s<f&&t.src.charCodeAt(s)===91?(l=s+1,s=t.md.helpers.parseLinkLabel(t,s),s>=0?o=t.src.slice(l,s++):s=h+1):s=h+1,o||(o=t.src.slice(m,h)),a=t.env.references[z0(o)],!a)return t.pos=p,!1;d=a.href,u=a.title}if(!e){n=t.src.slice(m,h);let g=[];t.md.inline.parse(n,t.md,t.env,g);let v=t.push("image","img",0),y=[["src",d],["alt",""]];v.attrs=y,v.children=g,v.content=n,u&&y.push(["title",u])}return t.pos=s,t.posMax=f,!0}var r3e=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,n3e=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function bq(t,e){let r=t.pos;if(t.src.charCodeAt(r)!==60)return!1;let n=t.pos,o=t.posMax;for(;;){if(++r>=o)return!1;let a=t.src.charCodeAt(r);if(a===60)return!1;if(a===62)break}let s=t.src.slice(n+1,r);if(n3e.test(s)){let a=t.md.normalizeLink(s);if(!t.md.validateLink(a))return!1;if(!e){let c=t.push("link_open","a",1);c.attrs=[["href",a]],c.markup="autolink",c.info="auto";let u=t.push("text","",0);u.content=t.md.normalizeLinkText(s);let l=t.push("link_close","a",-1);l.markup="autolink",l.info="auto"}return t.pos+=s.length+2,!0}if(r3e.test(s)){let a=t.md.normalizeLink("mailto:"+s);if(!t.md.validateLink(a))return!1;if(!e){let c=t.push("link_open","a",1);c.attrs=[["href",a]],c.markup="autolink",c.info="auto";let u=t.push("text","",0);u.content=t.md.normalizeLinkText(s);let l=t.push("link_close","a",-1);l.markup="autolink",l.info="auto"}return t.pos+=s.length+2,!0}return!1}function i3e(t){return/^<a[>\s]/i.test(t)}function o3e(t){return/^<\/a\s*>/i.test(t)}function s3e(t){let e=t|32;return e>=97&&e<=122}function _q(t,e){if(!t.md.options.html)return!1;let r=t.posMax,n=t.pos;if(t.src.charCodeAt(n)!==60||n+2>=r)return!1;let o=t.src.charCodeAt(n+1);if(o!==33&&o!==63&&o!==47&&!s3e(o))return!1;let s=t.src.slice(n).match(Ooe);if(!s)return!1;if(!e){let a=t.push("html_inline","",0);a.content=s[0],i3e(a.content)&&t.linkLevel++,o3e(a.content)&&t.linkLevel--}return t.pos+=s[0].length,!0}var a3e=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,c3e=/^&([a-z][a-z0-9]{1,31});/i;function xq(t,e){let r=t.pos,n=t.posMax;if(t.src.charCodeAt(r)!==38||r+1>=n)return!1;if(t.src.charCodeAt(r+1)===35){let s=t.src.slice(r).match(a3e);if(s){if(!e){let a=s[1][0].toLowerCase()==="x"?parseInt(s[1].slice(1),16):parseInt(s[1],10),c=t.push("text_special","",0);c.content=bN(a)?gw(a):gw(65533),c.markup=s[0],c.info="entity"}return t.pos+=s[0].length,!0}}else{let s=t.src.slice(r).match(c3e);if(s){let a=fh(s[0]);if(a!==s[0]){if(!e){let c=t.push("text_special","",0);c.content=a,c.markup=s[0],c.info="entity"}return t.pos+=s[0].length,!0}}}return!1}function Hoe(t){let e={},r=t.length;if(!r)return;let n=0,o=-2,s=[];for(let a=0;a<r;a++){let c=t[a];if(s.push(0),(t[n].marker!==c.marker||o!==c.token-1)&&(n=a),o=c.token,c.length=c.length||0,!c.close)continue;e.hasOwnProperty(c.marker)||(e[c.marker]=[-1,-1,-1,-1,-1,-1]);let u=e[c.marker][(c.open?3:0)+c.length%3],l=n-s[n]-1,d=l;for(;l>u;l-=s[l]+1){let p=t[l];if(p.marker===c.marker&&p.open&&p.end<0){let f=!1;if((p.close||c.open)&&(p.length+c.length)%3===0&&(p.length%3!==0||c.length%3!==0)&&(f=!0),!f){let m=l>0&&!t[l-1].open?s[l-1]+1:0;s[a]=a-l+m,s[l]=m,c.open=!1,p.end=a,p.close=!1,d=-1,o=-2;break}}}d!==-1&&(e[c.marker][(c.open?3:0)+(c.length||0)%3]=d)}}function Sq(t){let e=t.tokens_meta,r=t.tokens_meta.length;Hoe(t.delimiters);for(let n=0;n<r;n++)e[n]&&e[n].delimiters&&Hoe(e[n].delimiters)}function Iq(t){let e,r,n=0,o=t.tokens,s=t.tokens.length;for(e=r=0;e<s;e++)o[e].nesting<0&&n--,o[e].level=n,o[e].nesting>0&&n++,o[e].type==="text"&&e+1<s&&o[e+1].type==="text"?o[e+1].content=o[e].content+o[e+1].content:(e!==r&&(o[r]=o[e]),r++);e!==r&&(o.length=r)}var Cq=[["text",uq],["linkify",lq],["newline",dq],["escape",fq],["backticks",mq],["strikethrough",hq.tokenize],["emphasis",gq.tokenize],["link",vq],["image",yq],["autolink",bq],["html_inline",_q],["entity",xq]],Eq=[["balance_pairs",Sq],["strikethrough",hq.postProcess],["emphasis",gq.postProcess],["fragments_join",Iq]];function yw(){this.ruler=new $0;for(let t=0;t<Cq.length;t++)this.ruler.push(Cq[t][0],Cq[t][1]);this.ruler2=new $0;for(let t=0;t<Eq.length;t++)this.ruler2.push(Eq[t][0],Eq[t][1])}yw.prototype.skipToken=function(t){let e=t.pos,r=this.ruler.getRules(""),n=r.length,o=t.md.options.maxNesting,s=t.cache;if(typeof s[e]<"u"){t.pos=s[e];return}let a=!1;if(t.level<o){for(let c=0;c<n;c++)if(t.level++,a=r[c](t,!0),t.level--,a){if(e>=t.pos)throw new Error("inline rule didn't increment state.pos");break}}else t.pos=t.posMax;a||t.pos++,s[e]=t.pos};yw.prototype.tokenize=function(t){let e=this.ruler.getRules(""),r=e.length,n=t.posMax,o=t.md.options.maxNesting;for(;t.pos<n;){let s=t.pos,a=!1;if(t.level<o){for(let c=0;c<r;c++)if(a=e[c](t,!1),a){if(s>=t.pos)throw new Error("inline rule didn't increment state.pos");break}}if(a){if(t.pos>=n)break;continue}t.pending+=t.src[t.pos++]}t.pending&&t.pushPending()};yw.prototype.parse=function(t,e,r,n){let o=new this.State(t,e,r,n);this.tokenize(o);let s=this.ruler2.getRules(""),a=s.length;for(let c=0;c<a;c++)s[c](o)};yw.prototype.State=Uoe;var joe=yw;function Voe(t){let e={};t=t||{},e.src_Any=fN.source,e.src_Cc=mN.source,e.src_Z=hN.source,e.src_P=cx.source,e.src_ZPCc=[e.src_Z,e.src_P,e.src_Cc].join("|"),e.src_ZCc=[e.src_Z,e.src_Cc].join("|");let r="[><\uFF5C]";return e.src_pseudo_letter="(?:(?!"+r+"|"+e.src_ZPCc+")"+e.src_Any+")",e.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",e.src_auth="(?:(?:(?!"+e.src_ZCc+"|[@/\\[\\]()]).)+@)?",e.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",e.src_host_terminator="(?=$|"+r+"|"+e.src_ZPCc+")(?!"+(t["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+e.src_ZPCc+"))",e.src_path="(?:[/?#](?:(?!"+e.src_ZCc+"|"+r+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+e.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+e.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+e.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+e.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+e.src_ZCc+"|[']).)+\\'|\\'(?="+e.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+e.src_ZCc+"|[.]|$)|"+(t["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+e.src_ZCc+"|$)|;(?!"+e.src_ZCc+"|$)|\\!+(?!"+e.src_ZCc+"|[!]|$)|\\?(?!"+e.src_ZCc+"|[?]|$))+|\\/)?",e.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',e.src_xn="xn--[a-z0-9\\-]{1,59}",e.src_domain_root="(?:"+e.src_xn+"|"+e.src_pseudo_letter+"{1,63})",e.src_domain="(?:"+e.src_xn+"|(?:"+e.src_pseudo_letter+")|(?:"+e.src_pseudo_letter+"(?:-|"+e.src_pseudo_letter+"){0,61}"+e.src_pseudo_letter+"))",e.src_host="(?:(?:(?:(?:"+e.src_domain+")\\.)*"+e.src_domain+"))",e.tpl_host_fuzzy="(?:"+e.src_ip4+"|(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%)))",e.tpl_host_no_ip_fuzzy="(?:(?:(?:"+e.src_domain+")\\.)+(?:%TLDS%))",e.src_host_strict=e.src_host+e.src_host_terminator,e.tpl_host_fuzzy_strict=e.tpl_host_fuzzy+e.src_host_terminator,e.src_host_port_strict=e.src_host+e.src_port+e.src_host_terminator,e.tpl_host_port_fuzzy_strict=e.tpl_host_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_port_no_ip_fuzzy_strict=e.tpl_host_no_ip_fuzzy+e.src_port+e.src_host_terminator,e.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+e.src_ZPCc+"|>|$))",e.tpl_email_fuzzy="(^|"+r+'|"|\\(|'+e.src_ZCc+")("+e.src_email_name+"@"+e.tpl_host_fuzzy_strict+")",e.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|\uFF5C]|"+e.src_ZPCc+"))((?![$+<=>^`|\uFF5C])"+e.tpl_host_port_fuzzy_strict+e.src_path+")",e.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|\uFF5C]|"+e.src_ZPCc+"))((?![$+<=>^`|\uFF5C])"+e.tpl_host_port_no_ip_fuzzy_strict+e.src_path+")",e}function Tq(t){return Array.prototype.slice.call(arguments,1).forEach(function(r){r&&Object.keys(r).forEach(function(n){t[n]=r[n]})}),t}function CN(t){return Object.prototype.toString.call(t)}function u3e(t){return CN(t)==="[object String]"}function l3e(t){return CN(t)==="[object Object]"}function d3e(t){return CN(t)==="[object RegExp]"}function Goe(t){return CN(t)==="[object Function]"}function p3e(t){return t.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}var $oe={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function f3e(t){return Object.keys(t||{}).reduce(function(e,r){return e||$oe.hasOwnProperty(r)},!1)}var m3e={"http:":{validate:function(t,e,r){let n=t.slice(e);return r.re.http||(r.re.http=new RegExp("^\\/\\/"+r.re.src_auth+r.re.src_host_port_strict+r.re.src_path,"i")),r.re.http.test(n)?n.match(r.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(t,e,r){let n=t.slice(e);return r.re.no_http||(r.re.no_http=new RegExp("^"+r.re.src_auth+"(?:localhost|(?:(?:"+r.re.src_domain+")\\.)+"+r.re.src_domain_root+")"+r.re.src_port+r.re.src_host_terminator+r.re.src_path,"i")),r.re.no_http.test(n)?e>=3&&t[e-3]===":"||e>=3&&t[e-3]==="/"?0:n.match(r.re.no_http)[0].length:0}},"mailto:":{validate:function(t,e,r){let n=t.slice(e);return r.re.mailto||(r.re.mailto=new RegExp("^"+r.re.src_email_name+"@"+r.re.src_host_strict,"i")),r.re.mailto.test(n)?n.match(r.re.mailto)[0].length:0}}},h3e="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",g3e="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|\u0440\u0444".split("|");function v3e(t){t.__index__=-1,t.__text_cache__=""}function y3e(t){return function(e,r){let n=e.slice(r);return t.test(n)?n.match(t)[0].length:0}}function zoe(){return function(t,e){e.normalize(t)}}function IN(t){let e=t.re=Voe(t.__opts__),r=t.__tlds__.slice();t.onCompile(),t.__tlds_replaced__||r.push(h3e),r.push(e.src_xn),e.src_tlds=r.join("|");function n(c){return c.replace("%TLDS%",e.src_tlds)}e.email_fuzzy=RegExp(n(e.tpl_email_fuzzy),"i"),e.link_fuzzy=RegExp(n(e.tpl_link_fuzzy),"i"),e.link_no_ip_fuzzy=RegExp(n(e.tpl_link_no_ip_fuzzy),"i"),e.host_fuzzy_test=RegExp(n(e.tpl_host_fuzzy_test),"i");let o=[];t.__compiled__={};function s(c,u){throw new Error('(LinkifyIt) Invalid schema "'+c+'": '+u)}Object.keys(t.__schemas__).forEach(function(c){let u=t.__schemas__[c];if(u===null)return;let l={validate:null,link:null};if(t.__compiled__[c]=l,l3e(u)){d3e(u.validate)?l.validate=y3e(u.validate):Goe(u.validate)?l.validate=u.validate:s(c,u),Goe(u.normalize)?l.normalize=u.normalize:u.normalize?s(c,u):l.normalize=zoe();return}if(u3e(u)){o.push(c);return}s(c,u)}),o.forEach(function(c){t.__compiled__[t.__schemas__[c]]&&(t.__compiled__[c].validate=t.__compiled__[t.__schemas__[c]].validate,t.__compiled__[c].normalize=t.__compiled__[t.__schemas__[c]].normalize)}),t.__compiled__[""]={validate:null,normalize:zoe()};let a=Object.keys(t.__compiled__).filter(function(c){return c.length>0&&t.__compiled__[c]}).map(p3e).join("|");t.re.schema_test=RegExp("(^|(?!_)(?:[><\uFF5C]|"+e.src_ZPCc+"))("+a+")","i"),t.re.schema_search=RegExp("(^|(?!_)(?:[><\uFF5C]|"+e.src_ZPCc+"))("+a+")","ig"),t.re.schema_at_start=RegExp("^"+t.re.schema_search.source,"i"),t.re.pretest=RegExp("("+t.re.schema_test.source+")|("+t.re.host_fuzzy_test.source+")|@","i"),v3e(t)}function b3e(t,e){let r=t.__index__,n=t.__last_index__,o=t.__text_cache__.slice(r,n);this.schema=t.__schema__.toLowerCase(),this.index=r+e,this.lastIndex=n+e,this.raw=o,this.text=o,this.url=o}function wq(t,e){let r=new b3e(t,e);return t.__compiled__[r.schema].normalize(r,t),r}function mc(t,e){if(!(this instanceof mc))return new mc(t,e);e||f3e(t)&&(e=t,t={}),this.__opts__=Tq({},$oe,e),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=Tq({},m3e,t),this.__compiled__={},this.__tlds__=g3e,this.__tlds_replaced__=!1,this.re={},IN(this)}mc.prototype.add=function(e,r){return this.__schemas__[e]=r,IN(this),this};mc.prototype.set=function(e){return this.__opts__=Tq(this.__opts__,e),this};mc.prototype.test=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return!1;let r,n,o,s,a,c,u,l,d;if(this.re.schema_test.test(e)){for(u=this.re.schema_search,u.lastIndex=0;(r=u.exec(e))!==null;)if(s=this.testSchemaAt(e,r[2],u.lastIndex),s){this.__schema__=r[2],this.__index__=r.index+r[1].length,this.__last_index__=r.index+r[0].length+s;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(l=e.search(this.re.host_fuzzy_test),l>=0&&(this.__index__<0||l<this.__index__)&&(n=e.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(a=n.index+n[1].length,(this.__index__<0||a<this.__index__)&&(this.__schema__="",this.__index__=a,this.__last_index__=n.index+n[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(d=e.indexOf("@"),d>=0&&(o=e.match(this.re.email_fuzzy))!==null&&(a=o.index+o[1].length,c=o.index+o[0].length,(this.__index__<0||a<this.__index__||a===this.__index__&&c>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=a,this.__last_index__=c))),this.__index__>=0};mc.prototype.pretest=function(e){return this.re.pretest.test(e)};mc.prototype.testSchemaAt=function(e,r,n){return this.__compiled__[r.toLowerCase()]?this.__compiled__[r.toLowerCase()].validate(e,n,this):0};mc.prototype.match=function(e){let r=[],n=0;this.__index__>=0&&this.__text_cache__===e&&(r.push(wq(this,n)),n=this.__last_index__);let o=n?e.slice(n):e;for(;this.test(o);)r.push(wq(this,n)),o=o.slice(this.__last_index__),n+=this.__last_index__;return r.length?r:null};mc.prototype.matchAtStart=function(e){if(this.__text_cache__=e,this.__index__=-1,!e.length)return null;let r=this.re.schema_at_start.exec(e);if(!r)return null;let n=this.testSchemaAt(e,r[2],r[0].length);return n?(this.__schema__=r[2],this.__index__=r.index+r[1].length,this.__last_index__=r.index+r[0].length+n,wq(this,0)):null};mc.prototype.tlds=function(e,r){return e=Array.isArray(e)?e:[e],r?(this.__tlds__=this.__tlds__.concat(e).sort().filter(function(n,o,s){return n!==s[o-1]}).reverse(),IN(this),this):(this.__tlds__=e.slice(),this.__tlds_replaced__=!0,IN(this),this)};mc.prototype.normalize=function(e){e.schema||(e.url="http://"+e.url),e.schema==="mailto:"&&!/^mailto:/i.test(e.url)&&(e.url="mailto:"+e.url)};mc.prototype.onCompile=function(){};var Woe=mc;var Yoe="-",_3e=/^xn--/,x3e=/[^\0-\x7F]/,S3e=/[\x2E\u3002\uFF0E\uFF61]/g,I3e={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Rq=35,md=Math.floor,kq=String.fromCharCode;function hh(t){throw new RangeError(I3e[t])}function C3e(t,e){let r=[],n=t.length;for(;n--;)r[n]=e(t[n]);return r}function Qoe(t,e){let r=t.split("@"),n="";r.length>1&&(n=r[0]+"@",t=r[1]),t=t.replace(S3e,".");let o=t.split("."),s=C3e(o,e).join(".");return n+s}function Xoe(t){let e=[],r=0,n=t.length;for(;r<n;){let o=t.charCodeAt(r++);if(o>=55296&&o<=56319&&r<n){let s=t.charCodeAt(r++);(s&64512)==56320?e.push(((o&1023)<<10)+(s&1023)+65536):(e.push(o),r--)}else e.push(o)}return e}var E3e=t=>String.fromCodePoint(...t),T3e=function(t){return t>=48&&t<58?26+(t-48):t>=65&&t<91?t-65:t>=97&&t<123?t-97:36},Koe=function(t,e){return t+22+75*(t<26)-((e!=0)<<5)},Joe=function(t,e,r){let n=0;for(t=r?md(t/700):t>>1,t+=md(t/e);t>Rq*26>>1;n+=36)t=md(t/Rq);return md(n+(Rq+1)*t/(t+38))},Zoe=function(t){let e=[],r=t.length,n=0,o=128,s=72,a=t.lastIndexOf(Yoe);a<0&&(a=0);for(let c=0;c<a;++c)t.charCodeAt(c)>=128&&hh("not-basic"),e.push(t.charCodeAt(c));for(let c=a>0?a+1:0;c<r;){let u=n;for(let d=1,p=36;;p+=36){c>=r&&hh("invalid-input");let f=T3e(t.charCodeAt(c++));f>=36&&hh("invalid-input"),f>md((2147483647-n)/d)&&hh("overflow"),n+=f*d;let m=p<=s?1:p>=s+26?26:p-s;if(f<m)break;let h=36-m;d>md(2147483647/h)&&hh("overflow"),d*=h}let l=e.length+1;s=Joe(n-u,l,u==0),md(n/l)>2147483647-o&&hh("overflow"),o+=md(n/l),n%=l,e.splice(n++,0,o)}return String.fromCodePoint(...e)},ese=function(t){let e=[];t=Xoe(t);let r=t.length,n=128,o=0,s=72;for(let u of t)u<128&&e.push(kq(u));let a=e.length,c=a;for(a&&e.push(Yoe);c<r;){let u=2147483647;for(let d of t)d>=n&&d<u&&(u=d);let l=c+1;u-n>md((2147483647-o)/l)&&hh("overflow"),o+=(u-n)*l,n=u;for(let d of t)if(d<n&&++o>2147483647&&hh("overflow"),d===n){let p=o;for(let f=36;;f+=36){let m=f<=s?1:f>=s+26?26:f-s;if(p<m)break;let h=p-m,g=36-m;e.push(kq(Koe(m+h%g,0))),p=md(h/g)}e.push(kq(Koe(p,0))),s=Joe(o,l,c===a),o=0,++c}++o,++n}return e.join("")},w3e=function(t){return Qoe(t,function(e){return _3e.test(e)?Zoe(e.slice(4).toLowerCase()):e})},R3e=function(t){return Qoe(t,function(e){return x3e.test(e)?"xn--"+ese(e):e})},k3e={version:"2.3.1",ucs2:{decode:Xoe,encode:E3e},decode:Zoe,encode:ese,toASCII:R3e,toUnicode:w3e};var Pq=k3e;var tse={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"\u201C\u201D\u2018\u2019",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}};var rse={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"\u201C\u201D\u2018\u2019",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}};var nse={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"\u201C\u201D\u2018\u2019",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}};var P3e={default:tse,zero:rse,commonmark:nse},A3e=/^(vbscript|javascript|file|data):/,D3e=/^data:image\/(gif|png|jpeg|webp);/;function N3e(t){let e=t.trim().toLowerCase();return A3e.test(e)?D3e.test(e):!0}var ise=["http:","https:","mailto:"];function L3e(t){let e=hw(t,!0);if(e.hostname&&(!e.protocol||ise.indexOf(e.protocol)>=0))try{e.hostname=Pq.toASCII(e.hostname)}catch{}return lN(ax(e))}function O3e(t){let e=hw(t,!0);if(e.hostname&&(!e.protocol||ise.indexOf(e.protocol)>=0))try{e.hostname=Pq.toUnicode(e.hostname)}catch{}return mw(ax(e),mw.defaultChars+"%")}function Jc(t,e){if(!(this instanceof Jc))return new Jc(t,e);e||yN(t)||(e=t||{},t="default"),this.inline=new joe,this.block=new Foe,this.core=new woe,this.renderer=new xoe,this.linkify=new Woe,this.validateLink=N3e,this.normalizeLink=L3e,this.normalizeLinkText=O3e,this.utils=FB,this.helpers=ux({},HB),this.options={},this.configure(t),e&&this.set(e)}Jc.prototype.set=function(t){return ux(this.options,t),this};Jc.prototype.configure=function(t){let e=this;if(yN(t)){let r=t;if(t=P3e[r],!t)throw new Error('Wrong `markdown-it` preset "'+r+'", check name')}if(!t)throw new Error("Wrong `markdown-it` preset, can't be empty");return t.options&&e.set(t.options),t.components&&Object.keys(t.components).forEach(function(r){t.components[r].rules&&e[r].ruler.enableOnly(t.components[r].rules),t.components[r].rules2&&e[r].ruler2.enableOnly(t.components[r].rules2)}),this};Jc.prototype.enable=function(t,e){let r=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(o){r=r.concat(this[o].ruler.enable(t,!0))},this),r=r.concat(this.inline.ruler2.enable(t,!0));let n=t.filter(function(o){return r.indexOf(o)<0});if(n.length&&!e)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+n);return this};Jc.prototype.disable=function(t,e){let r=[];Array.isArray(t)||(t=[t]),["core","block","inline"].forEach(function(o){r=r.concat(this[o].ruler.disable(t,!0))},this),r=r.concat(this.inline.ruler2.disable(t,!0));let n=t.filter(function(o){return r.indexOf(o)<0});if(n.length&&!e)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+n);return this};Jc.prototype.use=function(t){let e=[this].concat(Array.prototype.slice.call(arguments,1));return t.apply(t,e),this};Jc.prototype.parse=function(t,e){if(typeof t!="string")throw new Error("Input data should be a String");let r=new this.core.State(t,this,e);return this.core.process(r),r.tokens};Jc.prototype.render=function(t,e){return e=e||{},this.renderer.render(this.parse(t,e),this.options,e)};Jc.prototype.parseInline=function(t,e){let r=new this.core.State(t,this,e);return r.inlineMode=!0,this.core.process(r),r.tokens};Jc.prototype.renderInline=function(t,e){return e=e||{},this.renderer.render(this.parseInline(t,e),this.options,e)};var Aq=Jc;var M3e=Object.freeze({abap:{lineComment:{start:"'"}},bat:{lineComment:{start:"REM"},aliases:["Batch","bat"],extensions:[".bat",".cmd"]},bibtex:{lineComment:{start:"%"},aliases:["BibTeX","bibtex"],extensions:[".bib"]},blade:{lineComment:{start:"#"}},c:{lineComment:{start:"//"},aliases:["C","c"],extensions:[".c",".i"]},clojure:{lineComment:{start:";"},aliases:["Clojure","clojure"],extensions:[".clj",".cljs",".cljc",".cljx",".clojure",".edn"]},coffeescript:{lineComment:{start:"//"},aliases:["CoffeeScript","coffeescript","coffee"],extensions:[".coffee",".cson",".iced"]},cpp:{lineComment:{start:"//"},aliases:["C++","Cpp","cpp"],extensions:[".cpp",".cc",".cxx",".c++",".hpp",".hh",".hxx",".h++",".h",".ii",".ino",".inl",".ipp",".ixx",".tpp",".txx",".hpp.in",".h.in"]},csharp:{lineComment:{start:"//"},aliases:["C#","csharp"],extensions:[".cs",".csx",".cake"]},css:{lineComment:{start:"/*",end:"*/"},aliases:["CSS","css"],extensions:[".css"]},dart:{lineComment:{start:"//"},aliases:["Dart"],extensions:[".dart"]},dockerfile:{lineComment:{start:"#"},aliases:["Docker","Dockerfile","Containerfile"],extensions:[".dockerfile",".containerfile"]},elixir:{lineComment:{start:"#"}},erb:{lineComment:{start:"<%#",end:"%>"}},erlang:{lineComment:{start:"%"}},fsharp:{lineComment:{start:"//"},aliases:["F#","FSharp","fsharp"],extensions:[".fs",".fsi",".fsx",".fsscript"]},go:{lineComment:{start:"//"},aliases:["Go"],extensions:[".go"]},groovy:{lineComment:{start:"//"},aliases:["Groovy","groovy"],extensions:[".groovy",".gvy",".gradle",".jenkinsfile",".nf"]},haml:{lineComment:{start:"-#"}},handlebars:{lineComment:{start:"{{!",end:"}}"},extensions:[".hbs",".handlebars"]},haskell:{lineComment:{start:"--"}},html:{lineComment:{start:"<!--",end:"-->"},aliases:["HTML","htm","html","xhtml"],extensions:[".html",".htm",".shtml",".xhtml",".xht",".mdoc",".jsp",".asp",".aspx",".jshtm",".volt",".ejs",".rhtml"]},ini:{lineComment:{start:";"}},java:{lineComment:{start:"//"},extensions:[".java",".class"]},javascript:{lineComment:{start:"//"},aliases:["JavaScript","javascript","js"],extensions:[".js",".es6",".mjs",".cjs",".pac"]},javascriptreact:{lineComment:{start:"//"},aliases:["JavaScript JSX","JavaScript React","jsx"],extensions:[".jsx"]},json:{extensions:[".json"],lineComment:{start:"//"}},jsonc:{lineComment:{start:"//"}},jsx:{lineComment:{start:"//"}},julia:{lineComment:{start:"#"},aliases:["Julia","julia"],extensions:[".jl"]},kotlin:{lineComment:{start:"//"}},latex:{lineComment:{start:"%"},aliases:["LaTeX","latex"],extensions:[".tex",".ltx",".ctx"]},less:{lineComment:{start:"//"},aliases:["Less","less"],extensions:[".less"]},lua:{lineComment:{start:"--"},aliases:["Lua","lua"],extensions:[".lua"]},makefile:{lineComment:{start:"#"},aliases:["Makefile","makefile"],extensions:[".mak",".mk"]},markdown:{lineComment:{start:"[]: #"},aliases:["Markdown","markdown"],extensions:[".md",".mkd",".mdwn",".mdown",".markdown",".markdn",".mdtxt",".mdtext",".workbook"]},"objective-c":{lineComment:{start:"//"},aliases:["Objective-C"],extensions:[".m"]},"objective-cpp":{lineComment:{start:"//"},aliases:["Objective-C++"],extensions:[".mm"]},perl:{lineComment:{start:"#"},aliases:["Perl","perl"],extensions:[".pl",".pm",".pod",".t",".PL",".psgi"]},php:{lineComment:{start:"//"},aliases:["PHP","php"],extensions:[".php",".php4",".php5",".phtml",".ctp"]},powershell:{lineComment:{start:"#"},aliases:["PowerShell","powershell","ps","ps1"],extensions:[".ps1",".psm1",".psd1",".pssc",".psrc"]},pug:{lineComment:{start:"//"}},python:{lineComment:{start:"#"},aliases:["Python","py"],extensions:[".py",".rpy",".pyw",".cpy",".gyp",".gypi",".pyi",".ipy",".pyt"]},ql:{lineComment:{start:"//"}},r:{lineComment:{start:"#"},aliases:["R","r"],extensions:[".r",".rhistory",".rprofile",".rt"]},razor:{lineComment:{start:"<!--",end:"-->"},aliases:["Razor","razor"],extensions:[".cshtml",".razor"]},ruby:{lineComment:{start:"#"},aliases:["Ruby","rb"],extensions:[".rb",".rbx",".rjs",".gemspec",".rake",".ru",".erb",".podspec",".rbi"]},rust:{lineComment:{start:"//"},aliases:["Rust","rust"],extensions:[".rs"]},sass:{lineComment:{start:"//"}},scala:{lineComment:{start:"//"}},scss:{lineComment:{start:"//"},aliases:["SCSS","scss"],extensions:[".scss"]},shellscript:{lineComment:{start:"#"},aliases:["Shell Script","shellscript","bash","fish","sh","zsh","ksh","csh"],extensions:[".sh",".bash",".bashrc",".bash_aliases",".bash_profile",".bash_login",".ebuild",".profile",".bash_logout",".xprofile",".xsession",".xsessionrc",".Xsession",".zsh",".zshrc",".zprofile",".zlogin",".zlogout",".zshenv",".zsh-theme",".fish",".ksh",".csh",".cshrc",".tcshrc",".yashrc",".yash_profile"]},slim:{lineComment:{start:"/"}},solidity:{lineComment:{start:"//"}},sql:{lineComment:{start:"--"},aliases:["SQL"],extensions:[".sql",".dsql"]},stylus:{lineComment:{start:"//"}},svelte:{lineComment:{start:"<!--",end:"-->"}},swift:{lineComment:{start:"//"},aliases:["Swift","swift"],extensions:[".swift"]},terraform:{lineComment:{start:"#"}},tex:{lineComment:{start:"%"},aliases:["TeX","tex"],extensions:[".sty",".cls",".bbx",".cbx"]},typescript:{lineComment:{start:"//"},aliases:["TypeScript","ts","typescript"],extensions:[".ts",".cts",".mts"]},typescriptreact:{lineComment:{start:"//"},aliases:["TypeScript JSX","TypeScript React","tsx"],extensions:[".tsx"]},vb:{lineComment:{start:"'"},aliases:["Visual Basic","vb"],extensions:[".vb",".brs",".vbs",".bas",".vba"]},verilog:{lineComment:{start:"//"}},"vue-html":{lineComment:{start:"<!--",end:"-->"}},vue:{lineComment:{start:"//"},extensions:[".vue"]},xml:{lineComment:{start:"<!--",end:"-->"},aliases:["XML","xml"],extensions:[".xml",".xsd",".ascx",".atom",".axml",".axaml",".bpmn",".cpt",".csl",".csproj",".csproj.user",".dita",".ditamap",".dtd",".ent",".mod",".dtml",".fsproj",".fxml",".iml",".isml",".jmx",".launch",".menu",".mxml",".nuspec",".opml",".owl",".proj",".props",".pt",".publishsettings",".pubxml",".pubxml.user",".rbxlx",".rbxmx",".rdf",".rng",".rss",".shproj",".storyboard",".svg",".targets",".tld",".tmx",".vbproj",".vbproj.user",".vcxproj",".vcxproj.filters",".wsdl",".wxi",".wxl",".wxs",".xaml",".xbl",".xib",".xlf",".xliff",".xpdl",".xul",".xoml"]},xsl:{lineComment:{start:"<!--",end:"-->"},aliases:["XSL","xsl"],extensions:[".xsl",".xslt"]},yaml:{lineComment:{start:"#"}}}),bw=new Map(Object.entries(M3e).map(([t,e])=>[t,{languageId:t,...e}]));function Is(t){let e=typeof t=="string"?t:t.languageId,r=bw.get(e.toLowerCase());return r||{languageId:e,lineComment:{start:"//"}}}function hd(t){let e=uc(t).toLowerCase();for(let r of bw.values())if(r.extensions?.includes(e))return r;return Is("plaintext")}function gi(t,e,r=!0){let n=e.matchAll(/^\s*(```+)/gm),o=Math.max(3,...Array.from(n,a=>a[1].length+1)),s="`".repeat(o);return`${s}${EN(t)}
${r?e.trim():e}
${s}`}function EN(t){switch(t.trim().toLowerCase()){case"typescriptreact":return"tsx";case"javascriptreact":return"jsx";default:return t}}function TN(t){let e=uc(t).toLowerCase(),r=Object.keys(bw).find(n=>bw.get(n)?.extensions?.includes(e))||e.replace(/^\./,"");return EN(r)}function Cs(t){let e=[],n=new Aq().parse(t,{});for(let o of ose(n))o.map&&o.type==="fence"&&e.push({startMarkup:o.markup,code:o.content.replace(/\n$/,""),language:o.info.trim(),startLine:o.map[0],endLine:o.map[1]});return e}function*ose(t){for(let e of t)e.children&&(yield*ose(e.children)),yield e}var wN=z(at()),Dq=z(require("path"));var ase=z(at()),cse=z(require("path"));var sse=z(Qt()),fx=z(at());var cf=class extends Q{constructor(r,n,o,s,a){super(r);this._contextService=n;this._telemetryService=o;this._logService=s;this._ignoreService=a}_handleFoulPrompt(){let r=new Error("BAD PROMPT");if(this._logService.defaultLogger.error(r),this._contextService.extensionMode!==$c.Production)throw r;this._telemetryService.sendMSFTTelemetryErrorEvent("prompt.invalidreference",{stack:r.stack})}};cf=O([x(1,ar),x(2,me),x(3,ue),x(4,De)],cf);var Oe=class extends cf{async render(){if(this.props.uri?await this._ignoreService.isCopilotIgnored(this.props.uri):!1)return this._handleFoulPrompt();let r=gi(this.props.languageId??"",this.props.code,this.props.shouldTrim??!0);return vscpp(fx.TextChunk,null,this.props.references&&vscpp("references",{value:this.props.references}),r)}},W0=class extends cf{async render(){if(this.props.uri?await this._ignoreService.isCopilotIgnored(this.props.uri):!1)return this._handleFoulPrompt();let r=gi(this.props.languageId??"",this.props.code,this.props.shouldTrim??!0);if(!this.props.uri)return vscpp(fx.TextChunk,null,r);let n=this.props.range?new hi(this.props.uri,this.props.range):this.props.uri;return vscpp(fx.TextChunk,null,vscpp("references",{value:[new fx.PromptReference(this.props.variableName?{variableName:this.props.variableName,value:n}:n,void 0,this.props.isSummarized?{status:{description:sse.t("Part of this file was not sent to the model due to context window limitations. Try attaching specific selections from your file instead."),kind:2}}:void 0)]}),r)}};var Qs=class extends cf{get insertLineBreakBefore(){return!1}async render(){if(await this._ignoreService.isCopilotIgnored(this.props.value))return this._handleFoulPrompt();let r;return this.props.mode===1?r=this.props.value.path:r=zc(this.props.value),vscpp(vscppf,null,r)}};var mx=class extends Q{constructor(r,n,o){super(r);this._ignoreService=n;this._tabsAndEditorsService=o}async render(r,n){let o=this._tabsAndEditorsService.activeTextEditor;if(!o)return;let s=o.visibleRanges[0],a=o.document;if(await this._ignoreService.isCopilotIgnored(a.uri))return vscpp("ignoredFiles",{value:[a.uri]});let u=[{uri:a.uri,version:a.version,ranges:[s]}],l=[new Ss.PromptReference({uri:a.uri,range:s})];return vscpp(vscppf,null,vscpp("usedContext",{value:u}),vscpp("references",{value:l}),vscpp(ase.UserMessage,{priority:this.props.priority},"Excerpt from active file ",cse.basename(a.uri.path),", lines ",s.start.line+1," to ",s.end.line+1,":",vscpp("br",null),vscpp(Oe,{code:a.getText(s),languageId:a.languageId,uri:a.uri}),vscpp("br",null),vscpp("br",null),s.isSingleLine&&vscpp(vscppf,null,"The cursor is on line: ",s.start.line)))}};mx=O([x(1,De),x(2,kt)],mx);var Nr=class extends Q{constructor(r,n,o,s){super(r);this.ignoreService=n;this._tabsAndEditorsService=o;this._tokenizerProvider=s}static{this.variableInfo={name:"selection",fullName:"Selection",icon:"selection",description:"The current selection in the active editor",defaultEnablement:!0}}async prepare(r){if(!this.props.document)return{isIgnored:!1,exceedsTokenBudget:!1};let n=await this.ignoreService.isCopilotIgnored(this.props.document.uri),o=!1,s=Nr.getCurrentSelection(this._tabsAndEditorsService);return s&&this._tokenizerProvider.acquireTokenizer(r.endpoint.family).tokenLength(s?.selectedText)*1.1>r.tokenBudget&&(o=!0),{isIgnored:n,exceedsTokenBudget:o}}render(r,n){let o=Nr.getCurrentSelection(this._tabsAndEditorsService);if(!o)return vscpp(mx,null);let s=[{uri:o.activeDocument.uri,version:o.activeDocument.version,ranges:[o.range]}],a=[new Ss.PromptReference(new hi(o.activeDocument.uri,o.range))],c=[o.activeDocument.uri];return r.isIgnored?vscpp("ignoredFiles",{value:c}):r.exceedsTokenBudget?vscpp(vscppf,null,vscpp(wN.AssistantMessage,{priority:this.props.priority,name:"selection-too-large"},"Your active selection (",o.fileName&&vscpp(vscppf,null,o.selectedText.split(`
`).length," lines from ",Dq.basename(o.fileName)),") exceeded my maximum context size and was dropped. Please reduce the selection to the most relevant part.")):vscpp(vscppf,null,vscpp("usedContext",{value:s}),vscpp(wN.UserMessage,{priority:this.props.priority},"Active selection:",vscpp("br",null),vscpp("br",null),vscpp("br",null),o.fileName&&vscpp(vscppf,null,"From the file: ",Dq.basename(o.fileName),vscpp("br",null)),vscpp(Oe,{code:o.selectedText,languageId:o.languageId,uri:o.activeDocument.uri,references:a}),vscpp("br",null),vscpp("br",null)))}static getCurrentSelection(r,n=!1){let o=r.activeTextEditor,s=o?.document;if(s){let a=o.selection;if(a&&(!a.isEmpty||a.isEmpty&&n)){let c=s.languageId,u=s.getText(a);return{languageId:c,selectedText:u,activeDocument:s,range:a,fileName:s.fileName}}}}};Nr=O([x(1,De),x(2,kt),x(3,dr)],Nr);var hx=class{constructor(){this.kind="current-selection";this.variableInfo=Nr.variableInfo}async resolveContext(e,r){let{messages:n,references:o,usedContext:s}=await Xi(e.get(te),r.endpoint,Nr,{});if(n.length>0&&o.length>0)return{kind:this.kind,userMessages:n.map(a=>a.content),usedContext:s,references:o}}static formatSelection(e){let r=e.fileName?`From the file: ${use.basename(e.fileName)}
`:"",{trimmedLines:n}=pw(e.selectedText.split(/\r?\n/g));return`

${r}${gi(e.languageId,Xt(n).join(`
`))}

`}},Nbt=tn.register(new hx);var oL=z(Qt()),Aw=z(at());var zt=class t{constructor(e,r){this.start=e;this.endExclusive=r;if(e>r)throw new sn(`Invalid range: ${this.toString()}`)}static addRange(e,r){let n=0;for(;n<r.length&&r[n].endExclusive<e.start;)n++;let o=n;for(;o<r.length&&r[o].start<=e.endExclusive;)o++;if(n===o)r.splice(n,0,e);else{let s=Math.min(e.start,r[n].start),a=Math.max(e.endExclusive,r[o-1].endExclusive);r.splice(n,o-n,new t(s,a))}}static tryCreate(e,r){if(!(e>r))return new t(e,r)}static ofLength(e){return new t(0,e)}static ofStartAndLength(e,r){return new t(e,e+r)}get isEmpty(){return this.start===this.endExclusive}delta(e){return new t(this.start+e,this.endExclusive+e)}deltaStart(e){return new t(this.start+e,this.endExclusive)}deltaEnd(e){return new t(this.start,this.endExclusive+e)}get length(){return this.endExclusive-this.start}toString(){return`[${this.start}, ${this.endExclusive})`}equals(e){return this.start===e.start&&this.endExclusive===e.endExclusive}containsRange(e){return this.start<=e.start&&e.endExclusive<=this.endExclusive}contains(e){return this.start<=e&&e<this.endExclusive}join(e){return new t(Math.min(this.start,e.start),Math.max(this.endExclusive,e.endExclusive))}intersect(e){let r=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);if(r<=n)return new t(r,n)}intersects(e){let r=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return r<n}intersectsOrTouches(e){let r=Math.max(this.start,e.start),n=Math.min(this.endExclusive,e.endExclusive);return r<=n}isBefore(e){return this.endExclusive<=e.start}isAfter(e){return this.start>=e.endExclusive}slice(e){return e.slice(this.start,this.endExclusive)}substring(e){return e.substring(this.start,this.endExclusive)}clip(e){if(this.isEmpty)throw new sn(`Invalid clipping range: ${this.toString()}`);return Math.max(this.start,Math.min(this.endExclusive-1,e))}clipCyclic(e){if(this.isEmpty)throw new sn(`Invalid clipping range: ${this.toString()}`);return e<this.start?this.endExclusive-(this.start-e)%this.length:e>=this.endExclusive?this.start+(e-this.start)%this.length:e}map(e){let r=[];for(let n=this.start;n<this.endExclusive;n++)r.push(e(n));return r}forEach(e){for(let r=this.start;r<this.endExclusive;r++)e(r)}};var Zc=class{get lines(){return this._lineStartOffsets.length}constructor(e){this._lineStartOffsets=[0];let r=0;for(;;){let n=e.indexOf(`
`,r);if(n===-1)break;this._lineStartOffsets.push(n+1),r=n+1}}lineLength(e){return this._lineStartOffsets[e]-this._lineStartOffsets[e-1]-1}offsetToPosition(e){let r=1;for(;r<this._lineStartOffsets.length&&!(this._lineStartOffsets[r]>e);r++);let n=e-this._lineStartOffsets[r-1];return new qr(r,n+1)}startOffsetOfLineContaining(e){let r=1;for(;r<this._lineStartOffsets.length&&!(this._lineStartOffsets[r]>e);r++);return this._lineStartOffsets[r-1]}positionToOffset(e){return e.lineNumber>=this._lineStartOffsets.length?this._lineStartOffsets[this._lineStartOffsets.length-1]+e.column-1:this._lineStartOffsets[e.lineNumber-1]+e.column-1}};var Wr=class t{constructor(e){this.edits=e;let r=-1;for(let n of e){if(!(n.replaceRange.start>=r))throw new Error(`Edits must be disjoint and sorted. Found ${n} after ${r}`);r=n.replaceRange.endExclusive}}static{this.empty=new t([])}static fromJson(e){return new t(e.map(yo.fromJson))}static from(e){let r=e.map(o=>new yo(zt.ofStartAndLength(o.rangeOffset,o.rangeLength),o.text));return r.reverse(),new t(r)}static single(e,r){return new t([new yo(e,r)])}static async fromDiff(e,r,n){let o=await n.computeDiff(e,r,{maxComputationTimeMs:5e3,computeMoves:!1,ignoreTrimWhitespace:!1}),s=new Zc(e),a=new Zc(r),c=[];for(let u of o.changes)for(let l of u.innerChanges??[]){let d=a.positionToOffset(l.modifiedRange.getStartPosition()),p=a.positionToOffset(l.modifiedRange.getEndPosition()),f=r.substring(d,p),m=s.positionToOffset(l.originalRange.getStartPosition()),h=s.positionToOffset(l.originalRange.getEndPosition()),g=new zt(m,h);c.push(new yo(g,f))}return new t(c)}normalize(){let e=[],r;for(let n of this.edits)n.newText.length===0&&n.replaceRange.length===0||(r&&r.replaceRange.endExclusive===n.replaceRange.start?r=new yo(r.replaceRange.join(n.replaceRange),r.newText+n.newText):(r&&e.push(r),r=n));return r&&e.push(r),new t(e)}toString(){return`[${this.edits.map(r=>r.toString()).join(", ")}]`}apply(e){let r=[],n=0;for(let o of this.edits)r.push(e.substring(n,o.replaceRange.start)),r.push(o.newText),n=o.replaceRange.endExclusive;return r.push(e.substring(n)),r.join("")}compose(e){return F3e(this,e)}inverse(e){let r=[],n=0;for(let o of this.edits)r.push(new yo(zt.ofStartAndLength(o.replaceRange.start+n,o.newText.length),e.substring(o.replaceRange.start,o.replaceRange.endExclusive))),n+=o.newText.length-o.replaceRange.length;return new t(r)}getNewTextRanges(){let e=[],r=0;for(let n of this.edits)e.push(zt.ofStartAndLength(n.replaceRange.start+r,n.newText.length)),r+=n.newText.length-n.replaceRange.length;return e}get isEmpty(){return this.edits.length===0}tryRebase(e){let r=[],n=0,o=0,s=0;for(;o<this.edits.length||n<e.edits.length;){let a=e.edits[n],c=this.edits[o];if(c)a?c.replaceRange.intersects(a.replaceRange)?o++:c.replaceRange.start<a.replaceRange.start?(r.push(new yo(c.replaceRange.delta(s),c.newText)),o++):(n++,s+=a.newText.length-a.replaceRange.length):(r.push(new yo(c.replaceRange.delta(s),c.newText)),o++);else break}return new t(r)}removeCommonSuffixPrefix(e){let r=[];for(let n of this.edits){let o=n.removeCommonSuffixPrefix(e);o.isEmpty||r.push(o)}return new t(r)}applyToOffset(e){let r=0;for(let n of this.edits)if(n.replaceRange.start<=e){if(e<n.replaceRange.endExclusive)return n.replaceRange.start+r;r+=n.newText.length-n.replaceRange.length}else break;return e+r}applyToOffsetRange(e){return new zt(this.applyToOffset(e.start),this.applyToOffset(e.endExclusive))}applyInverseToOffset(e){let r=0;for(let n of this.edits){let o=n.newText.length;if(n.replaceRange.start<=e-r){if(e-r<n.replaceRange.start+o)return n.replaceRange.start;r+=o-n.replaceRange.length}else break}return e-r}},yo=class t{constructor(e,r){this.replaceRange=e;this.newText=r}static fromJson(e){return new t(zt.ofStartAndLength(e.pos,e.len),e.txt)}toString(){return`${this.replaceRange} -> "${this.newText}"`}removeCommonSuffixPrefix(e){let r=e.substring(this.replaceRange.start,this.replaceRange.endExclusive),n=ZA(r,this.newText),o=Math.min(r.length-n,this.newText.length-n,Vre(r,this.newText)),s=new zt(this.replaceRange.start+n,this.replaceRange.endExclusive-o),a=this.newText.substring(n,this.newText.length-o);return new t(s,a)}get isEmpty(){return this.newText.length===0&&this.replaceRange.length===0}};function F3e(t,e){if(t=t.normalize(),e=e.normalize(),t.isEmpty)return e;if(e.isEmpty)return t;let r=[...t.edits],n=[],o=0;for(let s of e.edits){for(;;){let l=r[0];if(!l||l.replaceRange.start+o+l.newText.length>=s.replaceRange.start)break;r.shift(),n.push(l),o+=l.newText.length-l.replaceRange.length}let a=o,c,u;for(;;){let l=r[0];if(!l||l.replaceRange.start+o>s.replaceRange.endExclusive)break;c||(c=l),u=l,r.shift(),o+=l.newText.length-l.replaceRange.length}if(!c)n.push(new yo(s.replaceRange.delta(-o),s.newText));else{let l="",d=s.replaceRange.start-(c.replaceRange.start+a);d>0&&(l=c.newText.slice(0,d));let p=u.replaceRange.endExclusive+o-s.replaceRange.endExclusive;if(p>0){let h=new yo(zt.ofStartAndLength(u.replaceRange.endExclusive,0),u.newText.slice(-p));r.unshift(h),o-=h.newText.length-h.replaceRange.length}let f=l+s.newText,m=new zt(Math.min(c.replaceRange.start,s.replaceRange.start-a),s.replaceRange.endExclusive-o);n.push(new yo(m,f))}}for(;;){let s=r.shift();if(!s)break;n.push(s)}return new Wr(n).normalize()}var mt=ae("IParserService");function RN(t){return{startPosition:{row:t.start.line,column:t.start.character},endPosition:{row:t.end.line,column:t.end.character}}}function kN(t){return new Ge(t.startPosition.row,t.startPosition.column,t.endPosition.row,t.endPosition.column)}function Ji(t,e){return{startIndex:e.offsetAt(t.start),endIndex:e.offsetAt(t.end)}}function Xs(t,e){return new Ge(t.positionAt(e.startIndex),t.positionAt(e.endIndex))}var NN=z(at());var Ai=ae("ILanguageFeaturesService");function uf(t){return typeof t=="object"&&t!==null&&"targetUri"in t}var Zi={doesContain:(t,e)=>t.startIndex<=e.startIndex&&e.endIndex<=t.endIndex,ofSyntaxNode:t=>({startIndex:t.startIndex,endIndex:t.endIndex}),compare:(t,e)=>t.startIndex-e.startIndex||e.endIndex-t.endIndex,isEqual:(t,e)=>Zi.compare(t,e)===0,doIntersect:(t,e)=>{let r=Math.max(t.startIndex,e.startIndex),n=Math.min(t.endIndex,e.endIndex);return r<n},len:t=>t.endIndex-t.startIndex,intersectionSize:(t,e)=>{let r=Math.max(t.startIndex,e.startIndex),n=Math.min(t.endIndex,e.endIndex);return Math.max(n-r,0)},isTreeSitterOffsetRange(t){return typeof t.startIndex=="number"&&typeof t.endIndex=="number"}},pl={isEqual(t,e){return t.row===e.row&&t.column===e.column},isBefore(t,e){return t.row<e.row||t.row===e.row&&t.column<e.column},isAfter(t,e){return pl.isBefore(e,t)},isBeforeOrEqual(t,e){let r=pl.isBefore(t,e),n=pl.isEqual(t,e);return!!(r||n)},equals(t,e){return t.column===e.column&&t.row===e.row},isAfterOrEqual(t,e){return pl.isBeforeOrEqual(e,t)},ofPoint:t=>({row:t.row,column:t.column})},gh={doesContain:(t,e)=>pl.isBeforeOrEqual(t.startPosition,e.startPosition)&&pl.isAfterOrEqual(t.endPosition,e.endPosition),equals:(t,e)=>pl.equals(t.startPosition,e.startPosition)&&pl.equals(t.endPosition,e.endPosition),ofSyntaxNode:t=>({startPosition:t.startPosition,endPosition:t.endPosition})},PN={ofSyntaxNode:t=>({type:t.type,startIndex:t.startIndex,endIndex:t.endIndex})},fl={ofSyntaxNode:t=>({range:gh.ofSyntaxNode(t),startIndex:t.startIndex,text:t.text,endIndex:t.endIndex})},gd=class{constructor(e,r,n,o){this.startIndex=e;this.endIndex=r;this.kind=n;this.children=o;if(e>r)throw new sn("startIndex must be less than endIndex");let s=e;for(let a of o){if(a.startIndex<s)throw new sn("Invalid child startIndex");if(a.endIndex>r)throw new sn("Invalid child endIndex");s=Math.max(a.endIndex,s)}}toString(){let e=[];function r(n,o=""){e.push(`${o}${n.kind} [${n.startIndex}, ${n.endIndex}]`),n.children.forEach(s=>r(s,o+"    "))}return r(this),e.join(`
`)}};function pse(t,e){let r=t.getText().split(/\r|\n|\r\n/g),n=e||{tabSize:4},o={getLineCount:()=>r.length,getLineContent:s=>r[s-1],getOptions:()=>n};try{let s=B3e(o,t.languageId),[a]=fse(t,s,void 0);return a.adjust(t,mse(t.languageId)),a.toOverlayNode(t,!0)}catch{return new AN(1,t.lineCount,[]).toOverlayNode(t,!0)}}function fse(t,e,r){if(typeof r<"u"&&r>=e.length)throw new Error(`Invalid region index ${r}`);let n=typeof r>"u"?1:e.getStartLineNumber(r),o=typeof r>"u"?t.lineCount:e.getEndLineNumber(r),s=[],a=null;for(r=typeof r>"u"?0:r+1;r<e.length;){let c=e.getStartLineNumber(r),u=e.getEndLineNumber(r);if(c>o||u>o)break;let l=a;if([a,r]=fse(t,e,r),l&&a.startLineNumber<=l.endLineNumber)throw new sn("Invalid Folding Ranges: overlapping children");if(a.startLineNumber<n)throw new sn("Invalid Folding Ranges: child starts before parent");s.push(a)}return[new AN(n,o,s),r]}var AN=class{constructor(e,r,n){this.startLineNumber=e;this.endLineNumber=r;this.children=n;if(e>r)throw new sn("Invalid Folding Ranges: startLineNumber > endLineNumber")}adjust(e,r){r?this._adjustOffside():this._adjustRegular(e,e.lineCount)}_adjustOffside(){this.startLineNumber++;for(let e of this.children)e._adjustOffside()}_adjustRegular(e,r){if(this.endLineNumber<r){let n=e.lineAt(this.endLineNumber).text.trim();/^[\}\]\)];?$/.test(n)&&this.endLineNumber++}for(let n=this.children.length-1;n>=0;n--){let o=this.children[n],s=n+1<this.children.length?this.children[n+1].startLineNumber-1:r;o._adjustRegular(e,s)}}toOverlayNode(e,r){let n=[],o=r&&this.startLineNumber===1?1:this.startLineNumber+1;for(let s of this.children){for(let a=o;a<s.startLineNumber;a++){let c=lse(e,a);c&&n.push(c)}n.push(s.toOverlayNode(e,!1)),o=s.endLineNumber+1}for(let s=o;s<this.endLineNumber;s++){let a=lse(e,s);a&&n.push(a)}return U3e(e,this.startLineNumber,this.endLineNumber,n)}};function lse(t,e){let r=t.lineAt(e-1);if(r.isEmptyOrWhitespace)return null;let n=t.offsetAt(r.range.start),o=t.offsetAt(r.range.end);return new gd(n,o,"LINE",[])}function U3e(t,e,r,n){let o=t.offsetAt(new $n(e-1,0)),s=t.offsetAt(new $n(r-1,t.lineAt(r-1).text.length));return new gd(o,s,"FOLD",n)}function B3e(t,e){return q3e(t,mse(e))}function mse(t){return["clojure","coffeescript","fsharp","latex","markdown","pug","python","sql","yaml"].includes(t)}function q3e(t,e){let r=t.getOptions().tabSize,n=new Nq,o=[],s=t.getLineCount()+1;o.push({indent:-1,endAbove:s,line:s});for(let a=t.getLineCount();a>0;a--){let c=t.getLineContent(a),u=j3e(c,r),l=o[o.length-1];if(u===-1){e&&(l.endAbove=a);continue}if(l.indent>u){do o.pop(),l=o[o.length-1];while(l.indent>u);let d=l.endAbove-1;d-a>=1&&n.insertFirst(a,d,u)}l.indent===u?l.endAbove=a:o.push({indent:u,endAbove:a,line:a})}return n.toIndentRanges()}var H3e=65535,K0=16777215,dse=4278190080,Nq=class{constructor(){this._startIndexes=[],this._endIndexes=[],this._indentOccurrences=[],this._length=0}insertFirst(e,r,n){if(e>K0||r>K0)return;let o=this._length;this._startIndexes[o]=e,this._endIndexes[o]=r,this._length++,n<1e3&&(this._indentOccurrences[n]=(this._indentOccurrences[n]||0)+1)}toIndentRanges(){let e=new Uint32Array(this._length),r=new Uint32Array(this._length);for(let n=this._length-1,o=0;n>=0;n--,o++)e[o]=this._startIndexes[n],r[o]=this._endIndexes[n];return new Lq(e,r)}};function j3e(t,e){let r=0,n=0,o=t.length;for(;n<o;){let s=t.charCodeAt(n);if(s===32)r++;else if(s===9)r=r-r%e+e;else break;n++}return n===o?-1:r}var Lq=class{constructor(e,r){this._startIndexes=e,this._endIndexes=r,this._parentsComputed=!1}ensureParentIndices(){if(!this._parentsComputed){this._parentsComputed=!0;let e=[],r=(n,o)=>{let s=e[e.length-1];return this.getStartLineNumber(s)<=n&&this.getEndLineNumber(s)>=o};for(let n=0,o=this._startIndexes.length;n<o;n++){let s=this._startIndexes[n],a=this._endIndexes[n];if(s>K0||a>K0)throw new Error("startLineNumber or endLineNumber must not exceed "+K0);for(;e.length>0&&!r(s,a);)e.pop();let c=e.length>0?e[e.length-1]:-1;e.push(n),this._startIndexes[n]=s+((c&255)<<24),this._endIndexes[n]=a+((c&65280)<<16)}}}get length(){return this._startIndexes.length}getStartLineNumber(e){return this._startIndexes[e]&K0}getEndLineNumber(e){return this._endIndexes[e]&K0}getParentIndex(e){this.ensureParentIndices();let r=((this._startIndexes[e]&dse)>>>24)+((this._endIndexes[e]&dse)>>>16);return r===H3e?-1:r}contains(e,r){return this.getStartLineNumber(e)<=r&&this.getEndLineNumber(e)>=r}findIndex(e){let r=0,n=this._startIndexes.length;if(n===0)return-1;for(;r<n;){let o=Math.floor((r+n)/2);e<this.getStartLineNumber(o)?n=o:r=o+1}return r-1}findRange(e){let r=this.findIndex(e);if(r>=0){if(this.getEndLineNumber(r)>=e)return r;for(r=this.getParentIndex(r);r!==-1;){if(this.contains(r,e))return r;r=this.getParentIndex(r)}}return-1}};var DN=class extends Error{constructor(e){super(`Unrecognized language: ${e}`)}},hse={python:"python",javascript:"javascript",javascriptreact:"javascript",jsx:"javascript",typescript:"typescript",typescriptreact:"tsx",tsx:"tsx",go:"go",ruby:"ruby",csharp:"csharp",cpp:"cpp",java:"java",rust:"rust"};function lf(t){if(t in hse)return hse[t]}async function gse(t,e,r,n){let o=t.get(mt),s=t.get(ue),a=t.get(me),c=t.get(Ai),u=o.getTreeSitterAST(e);if(!u)return[];let l=Ji(r,e),d=await Js(s,a,e,n,()=>u.getCallExpressions(l),[]);async function p(v){let y=e.positionAt(v.startIndex);try{let b=await c.getImplementations(e.uri,y);return b.length?b:await c.getDefinitions(e.uri,y)}catch{return[]}}let f=await Js(s,a,e,n*3,()=>Promise.all(d.map(p)),[]),m=[];for(let v=0;v<f.length;v++){let y=d[v],b=f[v];for(let _ of b){let{uri:S,range:I}=uf(_)?{uri:_.targetUri,range:_.targetRange}:_,T=await t.get(Je).openTextDocument(S),A=o.getTreeSitterAST(T);if(A){let j=(await A.getFunctionDefinitions()).find(F=>F.identifier===y.identifier);if(j){let F=Ji(I,T);m.push({uri:S,range:I,version:T.version,identifier:y.identifier,startIndex:F.startIndex,endIndex:F.endIndex,text:j.text})}}}}if(m.length!==0)return m;let h=await Js(s,a,e,n,()=>u.getFunctionDefinitions(),[]),g=[];for(let v of h)for(let y of d)v.identifier===y.identifier&&g.push(v);return g.sort((v,y)=>v.startIndex-y.startIndex)}async function vse(t,e,r,n){let o=t.get(ue),s=t.get(me),a=t.get(mt),c=a.getTreeSitterAST(e);if(!c)return[];let u=t.get(Ai),l=Ji(r,e),d=await Js(o,s,e,n,()=>c.getClassReferences(l),[]),p=await Js(o,s,e,n*3,async()=>await Promise.all(d.map(async g=>{try{let v=e.positionAt(g.startIndex),y=await u.getImplementations(e.uri,v);return y.length?y:await u.getDefinitions(e.uri,v)}catch{return[]}})),[]),f=[];for(let g=0;g<p.length;g++){let v=d[g],y=p[g];for(let b of y){let{uri:_,range:S}=uf(b)?{uri:b.targetUri,range:b.targetRange}:b,I=await t.get(Je).openTextDocument(_),T=a.getTreeSitterAST(I);if(T){let A=(await T.getClassDeclarations()).find(B=>B.identifier===v.identifier);if(A){let B=Ji(S,I);f.push({uri:_,range:S,version:I.version,identifier:v.identifier,startIndex:B.startIndex,endIndex:B.endIndex,text:A.text})}}}}if(f.length!==0)return f;let m=await Js(o,s,e,n,()=>c.getClassDeclarations(),[]),h=[];for(let g of m)for(let v of d)g.identifier===v.identifier&&h.push(g);return h.sort((g,v)=>g.startIndex-v.startIndex)}async function yse(t,e,r,n){let o=t.get(ue),s=t.get(me),c=t.get(mt).getTreeSitterAST(e);if(!c)return[];let u=Ji(r,e),l=await Js(o,s,e,n,()=>c.getTypeReferences(u),[]),d=await Js(o,s,e,n,()=>c.getTypeDeclarations(),[]),p=[];for(let f of d)for(let m of l)f.identifier===m.identifier&&p.push(f);return p.sort((f,m)=>f.startIndex-m.startIndex)}function V3e(t,e){return e===0?t.then(r=>({type:"success",value:r})):new Promise((r,n)=>{let o=setTimeout(()=>r({type:"timeout"}),e);t.then(s=>{clearTimeout(o),r({type:"success",value:s})}).catch(s=>{clearTimeout(o),n(s)})})}async function bse(t,e,r){let n=t.get(mt),o=t.get(ue),s=t.get(me),a=n.getTreeSitterAST(e);if(!a)return[];let c=await Js(o,s,e,r,()=>a.getFunctionBodies(),[]);return c.sort((u,l)=>u.startIndex-l.startIndex),G3e(c)}function G3e(t){t.sort((r,n)=>r.startIndex-n.startIndex||n.endIndex-r.endIndex);let e=[];for(let r=0,n=t.length;r<n;){e.push(t[r]);let o=r+1;for(;o<t.length&&Zi.doesContain(t[r],t[o]);)++o;r=o}return e}async function Js(t,e,r,n,o,s){let a=t.getLogger("asyncCompute");try{let c=await V3e(_se(r,o,s),n);return c.type==="success"?c.value:(a.info(`Computing async parser based result took longer than ${n}ms`),s)}catch(c){return c instanceof DN||(a.exception(c,"Failed to compute async parser based result"),e.sendGHTelemetryException(c,"Failed to compute async parser based result")),s}}async function _se(t,e,r,n=0){let o=t.version,s=await e();return t.version!==o?n<3?_se(t,e,r,n+1):r:s}var wa=class t{static forDocument(e,r){return this.forUri(e,r.uri)}static forUri(e,r){return`${this.forLanguage(e)}: ${r.path}`}static forLanguage(e){return`${e.lineComment.start} FILEPATH`}static testLine(e,r){let n=t.forLanguage(e);return r.trimStart().startsWith(n)}};var Ra=class{static begin(e,r){return typeof r>"u"?`${e.lineComment.start} BEGIN:`:`${e.lineComment.start} BEGIN: ${r}`}static end(e,r){return typeof r>"u"?`${e.lineComment.start} END:`:`${e.lineComment.start} END: ${r}`}};function Oq(t){return/(^|\n)```[\s\S]+\n```/m.test(t)}function xse(t){return t.split("```",1)[0].match(/^.+/)?.[0]??""}async function Y0(t,e,r){let o=await t.getTreeSitterAST(e)?.getStructure();return o||pse(e,r)}var ml=class extends Wc{constructor(r,n){super();this.wholeRange=r;this.contextInfo=n}};(e=>{function t(r){return r instanceof e}e.is=t})(ml||={});var vd=class{constructor(e){this.charLimit=e;this._totalChars=0}get totalChars(){return this._totalChars}addLine(e){this._totalChars+=e.length+1}lineWouldFit(e){return this._totalChars+e.length+1<this.charLimit}},Es=class t{constructor(e,r,n,o){this.tracker=e;this.document=r;this.language=n;this.kindOrUniqueStr=o;this.lines=[];this.firstLineIndex=this.document.lineCount;this.lastLineIndex=-1;this.isComplete=!1;this.nonTrimWhitespaceCharCount=0;this._startMarker=Ra.begin(n,o),this._endMarker=Ra.end(n,o),this.lines=[],this.firstLineIndex=r.lineCount,this.lastLineIndex=-1}get startMarker(){return this._startMarker}get endMarker(){return this._endMarker}get lineCount(){return this.lines.length}get isVerySmallOrEmpty(){return this.nonTrimWhitespaceCharCount<10}get hasContent(){return this.lines.length===0||this.nonTrimWhitespaceCharCount===0?!1:this.lines.length>0}clone(){let e=new t(this.tracker,this.document,this.language,this.kindOrUniqueStr);return e._startMarker=this.startMarker,e._endMarker=this.endMarker,e.lines.push(...this.lines),e.firstLineIndex=this.firstLineIndex,e.lastLineIndex=this.lastLineIndex,e.nonTrimWhitespaceCharCount=this.nonTrimWhitespaceCharCount,e}clear(){this.lines.length=0,this.firstLineIndex=this.document.lineCount,this.lastLineIndex=-1,this.nonTrimWhitespaceCharCount=0}generatePrompt(e){if(!this.hasContent)return[];let r=[];return r.push("```"+this.language.languageId),r.push(wa.forDocument(this.language,this.document)),e&&r.push(`${this.startMarker}`),r.push(...this.lines),e&&r.push(`${this.endMarker}`),r.push("```"),r}prependLine(e){let n=this.document.lineAt(e).text;return this.tracker.lineWouldFit(n)?(this.firstLineIndex=Math.min(this.firstLineIndex,e),this.lastLineIndex=Math.max(this.lastLineIndex,e),this.lines.unshift(n),this.tracker.addLine(n),this.nonTrimWhitespaceCharCount+=n.trim().length,!0):!1}appendLine(e){let n=this.document.lineAt(e).text;return this.tracker.lineWouldFit(n)?(this.firstLineIndex=Math.min(this.firstLineIndex,e),this.lastLineIndex=Math.max(this.lastLineIndex,e),this.lines.push(n),this.tracker.addLine(n),this.nonTrimWhitespaceCharCount+=n.trim().length,!0):!1}trim(e){let r=e?Math.min(this.lastLineIndex,e.start.line):this.lastLineIndex;for(;this.firstLineIndex<r&&this.lines.length>0&&this.lines[0].trim().length===0;)this.firstLineIndex++,this.lines.shift();let n=e?Math.max(this.firstLineIndex,e.end.line):this.firstLineIndex;for(;n<this.lastLineIndex&&this.lines.length>0&&this.lines[this.lines.length-1].trim().length===0;)this.lastLineIndex--,this.lines.pop()}removeFirstNLines(e){if(e>=this.lineCount){let o=this.lines.slice(0),s=this.nonTrimWhitespaceCharCount;return this.clear(),{lines:o,nonTrimWhitespaceCharCount:s}}let r=this.lines.splice(0,e),n=0;for(let o of r)n+=o.trim().length;return this.firstLineIndex+=e,this.nonTrimWhitespaceCharCount-=n,{lines:r,nonTrimWhitespaceCharCount:n}}removeLastNLines(e){if(e>=this.lineCount){let o=this.lines.slice(0),s=this.nonTrimWhitespaceCharCount;return this.clear(),{lines:o,nonTrimWhitespaceCharCount:s}}let r=this.lines.splice(this.lines.length-e,e),n=0;for(let o of r)n+=o.trim().length;return this.lastLineIndex-=e,this.nonTrimWhitespaceCharCount-=n,{lines:r,nonTrimWhitespaceCharCount:n}}takeFromAbove(e,r){let{lines:n,nonTrimWhitespaceCharCount:o}=e.removeLastNLines(r);this.lines.unshift(...n),this.firstLineIndex-=n.length,this.nonTrimWhitespaceCharCount+=o}takeFromBelow(e,r){let{lines:n,nonTrimWhitespaceCharCount:o}=e.removeFirstNLines(r);this.lines.push(...n),this.lastLineIndex+=n.length,this.nonTrimWhitespaceCharCount+=o}mergeFromAbove(e){e.hasContent&&(this.lines.unshift(...e.lines),this.firstLineIndex=e.firstLineIndex,this.nonTrimWhitespaceCharCount+=e.nonTrimWhitespaceCharCount,e.clear())}mergeFromBelow(e){e.hasContent&&(this.lines.push(...e.lines),this.lastLineIndex=e.lastLineIndex,this.nonTrimWhitespaceCharCount+=e.nonTrimWhitespaceCharCount,e.clear())}toRange(){try{let e=this.lastLineIndex===-1?this.document.lineCount-1:this.lastLineIndex,r=new Ge(this.firstLineIndex,0,e,this.document.lineAt(e).text.length);if(this.document.validateRange(r)===r)return r}catch{return}}toString(){return`{${this.firstLineIndex} -> ${this.lastLineIndex}}`}};var vh=class extends NN.PromptElement{constructor(r,n,o,s){super(r);this._telemetryService=n;this._parserService=o;this._ignoreService=s}async prepare(r,n,o){if(await this._ignoreService.isCopilotIgnored(this.props.documentContext.document.uri))return{k:"ignored"};let s=this.props.nodeToDocument??await yh(this._parserService,this._telemetryService,this.props.documentContext),a=z3e(this.props.endpointInfo,this.props.documentContext,s.range);return{k:"found",nodeToDocument:s,codeExcerptToDocument:a.range,metadata:new ml(this.props.documentContext.wholeRange,a)}}render(r,n){if(r.k==="ignored")return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let o=r.codeExcerptToDocument.generatePrompt(!1).join(`
`);return vscpp(NN.UserMessage,null,vscpp("meta",{value:r.metadata}),"I have the following code in the selection:",o!==""?vscpp("br",null):"",r.codeExcerptToDocument.generatePrompt(!1).join(`
`))}};vh=O([x(1,me),x(2,mt),x(3,De)],vh);async function yh(t,e,r){let n=Ji(r.selection,r.document),o=t.getTreeSitterAST(r.document);if(o===void 0)return{range:r.wholeRange};let s=Date.now(),a=await o.getNodeToDocument(n),c=Date.now()-s,u=Ji(r.wholeRange,r.document);$3e(e,n,u,a,r.document.languageId,c);let l=Xs(r.document,a.nodeToDocument);return{identifier:a.nodeIdentifier,range:l}}function z3e(t,e,r){let n=new vd(t.modelMaxPromptTokens*4/3),o=new Es(n,e.document,e.language,"ed8c6549bwf9"),s=new Es(new vd(0),e.document,e.language,"abpxx6d04wxr"),a=new Es(new vd(0),e.document,e.language,"be15d9bcejpp");for(let c=r.start.line,u=r.end.line;c<=u&&!(c===u&&r.end.character===0||!o.appendLine(c));++c);return o.trim(e.selection),{language:e.language,above:s,range:o,below:a}}function $3e(t,e,r,n,o,s){t.sendMSFTTelemetryEvent("getNodeToDocument",{languageId:o,typeOfNodeToDocument:n.nodeToDocument.type,nodeToDocumentStart:n.nodeToDocument.startIndex.toString(),nodeToDocumentEnd:n.nodeToDocument.endIndex.toString(),selectionOffsetRangeStart:e.startIndex.toString(),selectionOffsetRangeEnd:e.endIndex.toString(),wholeRangeOffsetRangeStart:r.startIndex.toString(),wholeRangeOffsetRangeEnd:r.endIndex.toString()},{timeSpentMs:s})}var gx=class{constructor(e,r,n,o){this.originalStart=e,this.originalLength=r,this.modifiedStart=n,this.modifiedLength=o}getOriginalEnd(){return this.originalStart+this.originalLength}getModifiedEnd(){return this.modifiedStart+this.modifiedLength}},_w=class{constructor(e){this.lines=e}getElements(){let e=[];for(let r=0,n=this.lines.length;r<n;r++)e[r]=this.lines[r].trim();return e}getCharCount(){let e=0;for(let r of this.lines)e+=r.length;return e}},bh=class{static Assert(e,r){if(!e)throw new Error(r)}},_h=class{static Copy(e,r,n,o,s){for(let a=0;a<s;a++)n[o+a]=e[r+a]}static Copy2(e,r,n,o,s){for(let a=0;a<s;a++)n[o+a]=e[r+a]}};var LN=class{constructor(){this.m_changes=[],this.m_originalStart=1073741824,this.m_modifiedStart=1073741824,this.m_originalCount=0,this.m_modifiedCount=0}MarkNextChange(){(this.m_originalCount>0||this.m_modifiedCount>0)&&this.m_changes.push(new gx(this.m_originalStart,this.m_originalCount,this.m_modifiedStart,this.m_modifiedCount)),this.m_originalCount=0,this.m_modifiedCount=0,this.m_originalStart=1073741824,this.m_modifiedStart=1073741824}AddOriginalElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_originalCount++}AddModifiedElement(e,r){this.m_originalStart=Math.min(this.m_originalStart,e),this.m_modifiedStart=Math.min(this.m_modifiedStart,r),this.m_modifiedCount++}getChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes}getReverseChanges(){return(this.m_originalCount>0||this.m_modifiedCount>0)&&this.MarkNextChange(),this.m_changes.reverse(),this.m_changes}},ON=class t{constructor(e,r){let[n,o]=t._getElements(e),[s,a]=t._getElements(r);this._originalStringElements=n,this._originalElementsOrHash=o,this._modifiedStringElements=s,this._modifiedElementsOrHash=a,this.m_forwardHistory=[],this.m_reverseHistory=[]}static _getElements(e){let r=e.getElements(),n=new Int32Array(r.length);for(let o=0,s=r.length;o<s;o++)n[o]=this._stringHash(r[o],0);return[r,n]}static _numberHash(e,r){return(r<<5)-r+e|0}static _stringHash(e,r){r=this._numberHash(149417,r);for(let n=0,o=e.length;n<o;n++)r=this._numberHash(e.charCodeAt(n),r);return r}ElementsAreEqual(e,r){return this._originalElementsOrHash[e]!==this._modifiedElementsOrHash[r]?!1:this._originalStringElements[e]===this._modifiedStringElements[r]}ComputeDiff(){return this._ComputeDiff(0,this._originalElementsOrHash.length-1,0,this._modifiedElementsOrHash.length-1)}_ComputeDiff(e,r,n,o){return this.ComputeDiffRecursive(e,r,n,o)}ComputeDiffRecursive(e,r,n,o){for(;e<=r&&n<=o&&this.ElementsAreEqual(e,n);)e++,n++;for(;r>=e&&o>=n&&this.ElementsAreEqual(r,o);)r--,o--;if(e>r||n>o){let d;return n<=o?(bh.Assert(e===r+1,"originalStart should only be one more than originalEnd"),d=[new gx(e,0,n,o-n+1)]):e<=r?(bh.Assert(n===o+1,"modifiedStart should only be one more than modifiedEnd"),d=[new gx(e,r-e+1,n,0)]):(bh.Assert(e===r+1,"originalStart should only be one more than originalEnd"),bh.Assert(n===o+1,"modifiedStart should only be one more than modifiedEnd"),d=[]),d}let s=[0],a=[0],c=this.ComputeRecursionPoint(e,r,n,o,s,a),u=s[0],l=a[0];if(c!==null)return c;{let d=this.ComputeDiffRecursive(e,u,n,l),p=this.ComputeDiffRecursive(u+1,r,l+1,o);return this.ConcatenateChanges(d,p)}}WALKTRACE(e,r,n,o,s,a,c,u,l,d,p,f,m,h,g,v,y){let b=null,_=null,S=new LN,I=r,T=n,A=m[0]-v[0]-o,B=-1073741824,j=this.m_forwardHistory.length-1;do{let F=A+e;F===I||F<T&&l[F-1]<l[F+1]?(p=l[F+1],h=p-A-o,p<B&&S.MarkNextChange(),B=p,S.AddModifiedElement(p+1,h),A=F+1-e):(p=l[F-1]+1,h=p-A-o,p<B&&S.MarkNextChange(),B=p-1,S.AddOriginalElement(p,h+1),A=F-1-e),j>=0&&(l=this.m_forwardHistory[j],e=l[0],I=1,T=l.length-1)}while(--j>=-1);b=S.getReverseChanges(),S=new LN,I=a,T=c,A=m[0]-v[0]-u,B=1073741824,j=y?this.m_reverseHistory.length-1:this.m_reverseHistory.length-2;do{let F=A+s;F===I||F<T&&d[F-1]>=d[F+1]?(p=d[F+1]-1,h=p-A-u,p>B&&S.MarkNextChange(),B=p+1,S.AddOriginalElement(p+1,h+1),A=F+1-s):(p=d[F-1],h=p-A-u,p>B&&S.MarkNextChange(),B=p,S.AddModifiedElement(p+1,h+1),A=F-1-s),j>=0&&(d=this.m_reverseHistory[j],s=d[0],I=1,T=d.length-1)}while(--j>=-1);return _=S.getChanges(),this.ConcatenateChanges(b,_)}ComputeRecursionPoint(e,r,n,o,s,a){let c=0,u=0,l=0,d=0,p=0,f=0;e--,n--,s[0]=0,a[0]=0,this.m_forwardHistory=[],this.m_reverseHistory=[];let m=r-e+(o-n),h=m+1,g=new Int32Array(h),v=new Int32Array(h),y=o-n,b=r-e,_=e-n,S=r-o,T=(b-y)%2===0;g[y]=e,v[b]=r;for(let A=1;A<=m/2+1;A++){let B=0,j=0;l=this.ClipDiagonalBound(y-A,A,y,h),d=this.ClipDiagonalBound(y+A,A,y,h);for(let F=l;F<=d;F+=2){F===l||F<d&&g[F-1]<g[F+1]?c=g[F+1]:c=g[F-1]+1,u=c-(F-y)-_;let ne=c;for(;c<r&&u<o&&this.ElementsAreEqual(c+1,u+1);)c++,u++;if(g[F]=c,c+u>B+j&&(B=c,j=u),!T&&Math.abs(F-b)<=A-1&&c>=v[F])return s[0]=c,a[0]=u,ne<=v[F]&&1447>0&&A<=1448?this.WALKTRACE(y,l,d,_,b,p,f,S,g,v,c,r,s,u,o,a,T):null}p=this.ClipDiagonalBound(b-A,A,b,h),f=this.ClipDiagonalBound(b+A,A,b,h);for(let F=p;F<=f;F+=2){F===p||F<f&&v[F-1]>=v[F+1]?c=v[F+1]-1:c=v[F-1],u=c-(F-b)-S;let ne=c;for(;c>e&&u>n&&this.ElementsAreEqual(c,u);)c--,u--;if(v[F]=c,T&&Math.abs(F-y)<=A&&c<=g[F])return s[0]=c,a[0]=u,ne>=g[F]&&1447>0&&A<=1448?this.WALKTRACE(y,l,d,_,b,p,f,S,g,v,c,r,s,u,o,a,T):null}if(A<=1447){let F=new Int32Array(d-l+2);F[0]=y-l+1,_h.Copy2(g,l,F,1,d-l+1),this.m_forwardHistory.push(F),F=new Int32Array(f-p+2),F[0]=b-p+1,_h.Copy2(v,p,F,1,f-p+1),this.m_reverseHistory.push(F)}}return this.WALKTRACE(y,l,d,_,b,p,f,S,g,v,c,r,s,u,o,a,T)}ConcatenateChanges(e,r){let n=[];if(e.length===0||r.length===0)return r.length>0?r:e;if(this.ChangesOverlap(e[e.length-1],r[0],n)){let o=new Array(e.length+r.length-1);return _h.Copy(e,0,o,0,e.length-1),o[e.length-1]=n[0],_h.Copy(r,1,o,e.length,r.length-1),o}else{let o=new Array(e.length+r.length);return _h.Copy(e,0,o,0,e.length),_h.Copy(r,0,o,e.length,r.length),o}}ChangesOverlap(e,r,n){if(bh.Assert(e.originalStart<=r.originalStart,"Left change is not less than or equal to right change"),bh.Assert(e.modifiedStart<=r.modifiedStart,"Left change is not less than or equal to right change"),e.originalStart+e.originalLength>=r.originalStart||e.modifiedStart+e.modifiedLength>=r.modifiedStart){let o=e.originalStart,s=e.originalLength,a=e.modifiedStart,c=e.modifiedLength;return e.originalStart+e.originalLength>=r.originalStart&&(s=r.originalStart+r.originalLength-e.originalStart),e.modifiedStart+e.modifiedLength>=r.modifiedStart&&(c=r.modifiedStart+r.modifiedLength-e.modifiedStart),n[0]=new gx(o,s,a,c),!0}else return n[0]=null,!1}ClipDiagonalBound(e,r,n,o){if(e>=0&&e<o)return e;let s=n,a=o-n-1,c=r%2===0;if(e<0){let u=s%2===0;return c===u?0:1}else{let u=a%2===0;return c===u?o-1:o-2}}};var Mq=class{constructor(){this.spacesDiff=0;this.looksLikeAlignment=!1}};function W3e(t,e,r,n,o){o.spacesDiff=0,o.looksLikeAlignment=!1;let s;for(s=0;s<e&&s<n;s++){let f=t.charCodeAt(s),m=r.charCodeAt(s);if(f!==m)break}let a=0,c=0;for(let f=s;f<e;f++)t.charCodeAt(f)===32?a++:c++;let u=0,l=0;for(let f=s;f<n;f++)r.charCodeAt(f)===32?u++:l++;if(a>0&&c>0||u>0&&l>0)return;let d=Math.abs(c-l),p=Math.abs(a-u);if(d===0){o.spacesDiff=p,p>0&&0<=u-1&&u-1<t.length&&u<r.length&&r.charCodeAt(u)!==32&&t.charCodeAt(u-1)===32&&t.charCodeAt(t.length-1)===44&&(o.looksLikeAlignment=!0);return}if(p%d===0){o.spacesDiff=p/d;return}}function xh(t,e,r){let n=Math.min(t.length,1e4),o=0,s=0,a="",c=0,u=[2,4,6,8,3,5,7],l=8,d=[0,0,0,0,0,0,0,0,0],p=new Mq;for(let h=0;h<n;h++){let g=t[h],v=g.length,y=!1,b=0,_=0,S=0;for(let T=0,A=v;T<A;T++){let B=g.charCodeAt(T);if(B===9)S++;else if(B===32)_++;else{y=!0,b=T;break}}if(!y||(S>0?o++:_>1&&s++,W3e(a,c,g,b,p),p.looksLikeAlignment&&!(r&&e===p.spacesDiff)))continue;let I=p.spacesDiff;I<=l&&d[I]++,a=g,c=b}let f=r;o!==s&&(f=o<s);let m=e;if(f){let h=f?0:.1*n;u.forEach(g=>{let v=d[g];v>h&&(h=v,m=g)}),m===4&&d[4]>0&&d[2]>0&&d[2]>=d[4]/2&&(m=2)}return{insertSpaces:f,tabSize:m}}function K3e(t,e){let r=0,n=0,o=t.length;for(;n<o;){let s=t.charCodeAt(n);if(s===32)r++;else if(s===9)r=r-r%e+e;else break;n++}return n===o?~r:r}function MN(t,e){let r=K3e(t,e);return r<0?Math.floor(~r/e):Math.floor(r/e)}function Y3e(t,e){return t+e-t%e}function Q3e(t,e,r){let n=0;for(let s=0;s<t.length;s++)t.charAt(s)==="	"?n=Y3e(n,e):n++;let o="";if(!r){let s=Math.floor(n/e);n=n%e;for(let a=0;a<s;a++)o+="	"}for(let s=0;s<n;s++)o+=" ";return o}function Fq(t,e,r){let n=qre(t);return n===-1&&(n=t.length),Q3e(t.substring(0,n),e,r)+t.substring(n)}var eu=class{constructor(e,r,n,o="",s=`
`){this.firstLineIndex=e;this.endLineIndex=r;this.lines=n;this.prefix=o;this.suffix=s}toTextEdit(){let e=this.lines.length>0?this.prefix+this.lines.join(`
`)+this.suffix:"";return On.replace(new Ge(this.firstLineIndex,0,this.endLineIndex,0),e)}},yx;(r=>{function t(n){return n.length===0?[]:n.split(/\r\n|\r|\n/g)}r.fromString=t;function e(n){if(n.lineCount===0)return[];let o=[];for(let s=0;s<n.lineCount;s++)o.push(n.lineAt(s).text);return o}r.fromDocument=e})(yx||={});var xw=class t{constructor(e,r){this.text=e;this.languageId=r}static fromDocumentContext(e){return new t(e.document.getText(),e.language.languageId)}};function Bq(t,e,r,n,o,s){let a=yx.fromString(r);if(a.length===e.range.lines.length&&e.range.lines.every((p,f)=>p===a[f]))return[];let c=[],u=!1;for(let p of a){let f=FN(e,p);f===null?c.push(p):(f.type==="fakestart"||f.type==="fakend")&&(u=!0)}let l;if(n===4)l=new eu(e.range.lastLineIndex,e.range.lastLineIndex,a);else{let p=Z3e(e,a,o),f=s5e(t,e,c,o);if(!p)l=f;else if(!f)l=p;else{let m=Ise(p);Ise(f)<m?l=f:l=p}l||(l=J3e(t,e,n,o,u,c))}s&&(l=X3e(s,l,o));let d=[l];return s&&(d=e5e(s,d)),d.map(p=>p.toTextEdit())}function X3e(t,e,r){let n=t.text.split(/\r\n|\r|\n/g),o=n.slice(0,e.firstLineIndex),s=n.slice(e.endLineIndex),a=e.lines.slice(0),[,c]=Ese(o,a);c>0&&a.splice(0,c),c>0&&(a=Sh(a,{whichLine:"bottomMost",lines:o.slice(o.length-c)},r).slice(0));let[u]=Ese(a,s);return u>0&&a.splice(a.length-u,u),new eu(e.firstLineIndex,e.endLineIndex,a)}function J3e(t,e,r,n,o,s){let a=t.getLogger("editGeneration");return o?(a.info("(case 6) Appending to selected code"),Tse(e.range,s,n)):r===3?(a.info("(case 7) Appending to selected code"),Tse(e.range,s,n)):r===1?(a.info("(case 8) Prepending to selected code"),l5e(e.range,Sh(s,e.range.lines.filter(c=>c.trim()!=="").length>0?{whichLine:"topMost",lines:e.range.lines}:{whichLine:"bottomMost",lines:e.above.lines},n))):(a.info("(Default) Replacing selected code"),yd(e.range,s,n))}function Ise(t){let e=t.endLineIndex-t.firstLineIndex,r=t.lines.length;return e+r}function Z3e(t,e,r){let n=null,o=[];for(let s of e){let a=FN(t,s);if(a===null){o.push(s);continue}if(n){if(a.type==="end"&&a.endMarker===n)return yd(n,o,r);if(a.type==="end"&&n===t.above&&a.endMarker===t.range){let c=t.range.clone();return c.mergeFromAbove(t.above.clone()),yd(c,o,r)}if(a.type==="end"&&n===t.above&&a.endMarker===t.below){let c=t.range.clone();return c.mergeFromAbove(t.above.clone()),c.mergeFromBelow(t.below.clone()),yd(c,o,r)}}else a.type==="start"&&(n=a.startMarker,o=[])}if(o.length>0&&n)return yd(n,o,r)}function e5e(t,e){let r=[],n=t.text.split(/\r\n|\r|\n/g),o=t5e(n,c=>vx(c,t.languageId)),s=[];for(let c of e){if(c.endLineIndex<=o+1)return e;let u=!1,l=[],d=c.lines;for(let p of d)vx(p,t.languageId)?(s.push(qq(p)),u=!0):u&&p.length===0||(l.push(p),u=!1);if(!u&&l.length>0){if(c.firstLineIndex<o+1)return e;r.push(new eu(c.firstLineIndex,c.endLineIndex,l))}}if(s.length===0)return e;let a=o+1;return r.unshift(new eu(a,a,s)),r}function t5e(t,e){for(let r=t.length-1;r>=0;r--)if(e(t[r]))return r;return-1}function qq(t){return t.replace(/^\s+/g,"")}function vx(t,e){switch(e){case"java":return!!t.match(/^\s*import\s/);case"typescript":case"javascript":return!!t.match(/^\s*import[\s{*]|^\s*[var|const|let].*=\s*require\(/);case"php":return!!t.match(/^\s*use/);case"rust":return!!t.match(/^\s*use\s+[\w:{}, ]+\s*(as\s+\w+)?;/);case"python":return!!t.match(/^\s*from\s+[\w.]+\s+import\s+[\w, *]+$/)||!!t.match(/^\s*import\s+[\w, ]+$/);default:return!1}}var r5e=/^(\t+)/,Uq=new Map;function n5e(t){return Uq.has(t)||Uq.set(t,new RegExp(`^(( {${t}})+)`)),Uq.get(t)}function Hq(t,e,r){let n=e?n5e(r):r5e,o=t.match(n);return o?[o[0],o[0].length/(e?r:1)]:["",0]}function i5e(t){let{insertSpaces:e,tabSize:r}=xh(t,4,!1),n=Number.MAX_VALUE;for(let o of t){if(/^\s*$/.test(o))continue;let[,s]=Hq(o,e,r);n=Math.min(n,s)}return{insertSpaces:e,tabSize:r,minIndentLevel:n}}function Cse(t,e){if(e===0)return"";if(t===" ")switch(e){case 2:return"  ";case 4:return"    ";case 8:return"        ";case 12:return"            "}if(t==="	")switch(e){case 1:return"	";case 2:return"		";case 3:return"			"}return new Array(e).fill(t).join("")}function o5e(t,e){let r=t.lines,n;if(t.whichLine==="topMost")n=r.find(o=>o!=="");else for(let o=r.length-1;o>=0;--o)if(r[o]!==""){n=r[o];break}return n===void 0?0:Hq(n,e.insertSpaces,e.tabSize)[1]}function Sh(t,e,r){if(r===void 0)return t;let n=o5e(e,r),o=i5e(t),s=r.insertSpaces?Cse(" ",r.tabSize):"	";return t.map(a=>{if(a==="")return"";{let[c,u]=Hq(a,o.insertSpaces,o.tabSize),l=a.substring(c.length);return Cse(s,n+(u-o.minIndentLevel))+l}})}function FN(t,e){switch(e){case t.above.startMarker:return{type:"start",startMarker:t.above};case t.above.endMarker:return{type:"end",endMarker:t.above};case t.range.startMarker:return{type:"start",startMarker:t.range};case t.range.endMarker:return{type:"end",endMarker:t.range};case t.below.startMarker:return{type:"start",startMarker:t.below};case t.below.endMarker:return{type:"end",endMarker:t.below}}return e.trimStart().startsWith(Ra.begin(t.language))?{type:"fakestart"}:e.trimStart().startsWith(Ra.end(t.language))?{type:"fakend"}:null}function s5e(t,e,r,n){let o=(m,h,g)=>{let v=0;for(let S of m)for(let I=S.originalStart;I<S.originalStart+S.originalLength;I++){let T=h.lines[I];v+=T.length}let y=h.getCharCount(),b=g.getCharCount(),_=y-v;return{equalCharCount:_,originalCharCount:y,modifiedCharCount:b,originalCharRatio:y>0?_/y:0,modifiedCharRatio:b>0?_/b:0}},s=m=>{let h=new _w(m.lines),g=new _w(r),y=new ON(h,g).ComputeDiff();return o(y,h,g)},a=e.range.clone();a.mergeFromAbove(e.above.clone()),a.mergeFromBelow(e.below.clone());let c=s(a),u=s(e.range),l={diffToEntireScore:c,diffToRangeScore:u},d=t.getLogger("editGeneration");if(d.info(`Diff metrics: ${JSON.stringify(l,null,"	")}`),c.originalCharCount>30&&c.originalCharRatio>.7)return d.info("(case 1) Replacing entire code"),yd(a,r,n);if(u.originalCharCount>20&&u.originalCharRatio>.7)return d.info("(case 2) Replacing selected code"),yd(e.range,r,n);let p=Math.min(c.originalCharRatio,c.modifiedCharRatio),f=Math.min(u.originalCharRatio,u.modifiedCharRatio);if(p>.2&&p>f)return d.info("(case 3) Replacing entire code"),yd(a,r,n);if(f>.2)return d.info("(case 4) Replacing selected code"),yd(e.range,r,n);if(!e.range.hasContent)return d.info("(case 5) Replacing empty selected code"),yd(e.range,r,n,{whichLine:"bottomMost",lines:e.above.lines})}function yd(t,e,r,n){let s=Sh(e,n??{whichLine:"topMost",lines:t.lines},r).slice(0),a=t.lines.slice(0),c=t.firstLineIndex,u=t.lastLineIndex;if(a.length===1&&a[0]==="")return new eu(u,u,s);let l=a5e(a,s);if(c+=l,a.splice(0,l),s.splice(0,l),a.length===0)return new eu(u+1,u+1,s);let d=c5e(a,s);return u-=d,a.splice(a.length-d,d),s.splice(s.length-d,d),a.length===0?new eu(c,c,s):new eu(c,u+1,s)}function a5e(t,e){let r=Math.min(t.length,e.length);for(let n=0;n<r;n++)if(t[n]!==e[n])return n;return r}function c5e(t,e){let r=Math.min(t.length,e.length);for(let n=0;n<r;n++)if(t[t.length-1-n]!==e[e.length-1-n])return n;return r}function Ese(t,e){let r=t.filter(c=>!/^\s*$/.test(c)),n=e.filter(c=>!/^\s*$/.test(c)),o=u5e(r,n);if(o===0)return[0,0];let s=0;for(let c=0;c<o;c++)for(s++;/^\s*$/.test(t[t.length-s]);)s++;let a=0;for(let c=0;c<o;c++)for(a++;/^\s*$/.test(e[a]);)a++;return[s,a]}function u5e(t,e){for(let r=Math.min(t.length,e.length);r>0;r--){let n=t.length-r,o=!0;for(let s=0;s<r;s++)if(t[n+s]!==e[s]){o=!1;break}if(o)return r}return 0}function l5e(t,e){return new eu(t.firstLineIndex,t.firstLineIndex,e)}function Tse(t,e,r){let n=Sh(e,{whichLine:"bottomMost",lines:t.lines},r),o=t.lastLineIndex+1;return new eu(o,o,n)}async function*Zs(t,e,r){let n="",o=d5e(e);o.reverse();for await(let s of t){n+=s;let a,c=0,u="";for(;(a=n.indexOf(e,c))!==-1;)u+=n.slice(c,a)+r,c=a+e.length;c!==0&&(n=n.slice(c));for(let l of o)if(n.endsWith(l)){let d=n.length-l.length;u+=n.slice(0,d),n=n.slice(d);break}u.length>0&&(yield u)}n.length>0&&(yield n)}function d5e(t){let e=[];for(let r=0;r<=t.length;r++)e.push(t.substring(0,r));return e}var ka;(n=>{function t(){return o=>o}n.identity=t;function e(){return o=>Zo.EMPTY}n.discard=e;function r(...o){return s=>o.reduce((a,c)=>c(a),s)}n.chain=r})(ka||={});function wse(t,e){return(async()=>{for await(let r of t)e(r)})()}var xx=class{constructor(e,r,n,o,s=!0,a=Iw.noop){this.myDocument=e;this.initialSelection=r;this.adjustedSelection=n;this.editStrategy=o;this.collectImports=s;this.lineFilter=a;this.replyIndentationTracker=null}async processStream(e){let r=Zo.filter(e,this.lineFilter);this.collectImports&&(r=Vq(r,this.myDocument));let n=this.myDocument.firstSentLineIndex;for await(let o of this.findInitialAnchor(r))o instanceof BN?n=this.handleFirstReplyLine(o.anchor,o.line):n=this.handleSubsequentReplyLine(n,o.value);return this.myDocument.didReplaceEdits&&n<=this.adjustedSelection.end.line&&this.myDocument.deleteLines(n,this.adjustedSelection.end.line),new Sw(this.myDocument.didEdits,this.myDocument.additionalImports)}handleFirstReplyLine(e,r){if(e){this.replyIndentationTracker=new Sx(this.myDocument,e.lineIndex,r);let s=this.replyIndentationTracker.reindent(r,this.myDocument.indentStyle);return this.myDocument.getLine(e.lineIndex).sentInCodeBlock===2?this.myDocument.replaceLines(this.adjustedSelection.start.line,e.lineIndex,s):this.myDocument.replaceLine(e.lineIndex,s)}let n=this.adjustedSelection.start.line;this.replyIndentationTracker=new Sx(this.myDocument,n,r);let o=this.replyIndentationTracker.reindent(r,this.myDocument.indentStyle);if(this.initialSelection.isEmpty){let s=this.myDocument.getLine(n).content;if(/^\s*$/.test(s)||o.adjustedContent.startsWith(s))return this.myDocument.replaceLine(n,o,!0)}return this.editStrategy===1?this.myDocument.insertLineBefore(n,o):this.editStrategy===3||this.editStrategy===4?this.myDocument.insertLineAfter(n,o):this.myDocument.replaceLine(n,o)}handleSubsequentReplyLine(e,r){let n=this.replyIndentationTracker.reindent(r,this.myDocument.indentStyle);if(n.trimmedContent!==""||this.myDocument.didReplaceEdits){let s=this.matchReplyLine(n,e);if(s)return this.myDocument.replaceLines(e,s.lineIndex,n)}if(e>=this.myDocument.getLineCount())return this.myDocument.appendLineAtEndOfDocument(n);let o=this.myDocument.getLine(e);return!o.isSent||o.content===""||n.trimmedContent===""?this.myDocument.insertLineBefore(e,n):o.indentLevel<n.adjustedIndentLevel?this.myDocument.insertLineBefore(e,n):o.indentLevel===n.adjustedIndentLevel&&!this.myDocument.didReplaceEdits?this.myDocument.insertLineBefore(e,n):this.myDocument.replaceLine(e,n)}matchReplyLine(e,r){let n=e.trimmedContent.length<=3;for(let o=r;o<this.myDocument.getLineCount();o++){let s=this.myDocument.getLine(o);if(s.isSent){if(s.normalizedContent===e.adjustedContent)return new GN(o);if(s.trimmedContent.length>0&&s.indentLevel<e.adjustedIndentLevel||n&&s.trimmedContent.length>0)return null}}return null}findInitialAnchor(e){return new Zo(async r=>{let n=[],o=0,s=!1;for await(let a of e)if(s)r.emitOne(a);else if(n.push(a),o+=a.value.trim().length,o>10){let c=this.searchForEqualSentLines(n);s=!0,r.emitOne(new BN(n[0].value,c)),r.emitMany(n.slice(1))}})}searchForEqualSentLines(e){let r=e.map(n=>n.value.trim());for(let n=this.myDocument.firstSentLineIndex,o=this.myDocument.getLineCount()-e.length;n<=o;n++){if(!this.myDocument.getLine(n).isSent)continue;let s=!0;for(let a=0;a<r.length;a++){let c=this.myDocument.getLine(n+a);if(!c.isSent||c.trimmedContent!==r[a]){s=!1;break}}if(s)return new GN(n)}return null}},Ch=class{constructor(e,r,n=Iw.noop){this._myDocument=e;this._cursorPosition=r;this._lineFilter=n;this.replyIndentationTracker=null}async processStream(e){let r=Zo.filter(e,this._lineFilter);r=Vq(r,this._myDocument);let n=0;for await(let o of r)this.replyIndentationTracker?n=this.handleSubsequentReplyLine(n,o.value):n=this.handleFirstReplyLine(o.value);return new Sw(this._myDocument.didEdits,this._myDocument.additionalImports)}handleFirstReplyLine(e){let r=this._cursorPosition.line,n=this._myDocument.getLine(r).content,o=/^\s*$/.test(n)||e.trimStart().startsWith(n.trimStart()),s=o||this._myDocument.getLineCount()<=r+1?r:r+1;this.replyIndentationTracker=new Sx(this._myDocument,s,e);let a=this.replyIndentationTracker.reindent(e,this._myDocument.indentStyle);return o?this._myDocument.replaceLine(r,a,!0):this._myDocument.insertLineAfter(r,a)}handleSubsequentReplyLine(e,r){let n=this.replyIndentationTracker.reindent(r,this._myDocument.indentStyle);return this._myDocument.insertLineBefore(e,n)}},UN=class{constructor(e,r,n=Iw.noop){this._myDocument=e;this._selection=r;this._lineFilter=n;this.replyIndentationTracker=null}async processStream(e){let r=Zo.filter(e,this._lineFilter);r=Vq(r,this._myDocument);let n=0,o,s="";this._selection.end.line>this._selection.start.line&&this._selection.end.character===0?o=this._selection.end.line-this._selection.start.line:(o=this._selection.end.line-this._selection.start.line+1,s=this._myDocument.getLine(this._selection.end.line).content.substring(this._selection.end.character));for await(let a of r)if(this.replyIndentationTracker){let c=this.replyIndentationTracker.reindent(a.value,this._myDocument.indentStyle);o>0?(n=this._myDocument.replaceLine(n,c),o--):n=this._myDocument.insertLineAfter(n-1,c)}else{let c=this._selection.start.line;this.replyIndentationTracker=new Sx(this._myDocument,c,a.value);let u=this.replyIndentationTracker.reindent(a.value,this._myDocument.indentStyle);n=this._myDocument.replaceLine(c,u),o--}return this._myDocument.didEdits&&o>0&&this._myDocument.deleteLines(n,n+o-1),this._myDocument.didEdits&&s.length>0&&this._myDocument.replaceLine(n-1,this._myDocument.getLine(n-1).content+s),new Sw(this._myDocument.didEdits,this._myDocument.additionalImports)}},Sw=class{constructor(e,r){this.didEdits=e;this.additionalImports=r}},Sx=class{constructor(e,r,n){let o=0;for(let a=r;a>=0;a--){let c=e.getLine(a);if(c.content.length>0){o=c.indentLevel,a!==r&&(c.content.endsWith("{")||e.languageId==="python"&&c.content.endsWith(":"))&&(o+=1);break}}this._replyIndentStyle=_x.guessIndentStyleFromLine(n);let s=MN(n,this._replyIndentStyle?.tabSize??4);this.indentDelta=s-o}reindent(e,r){if(e==="")return new VN("",0,"",0);this._replyIndentStyle||(this._replyIndentStyle=_x.guessIndentStyleFromLine(e));let n=0,o=0,s=c=>(n=c,o=Math.max(n-this.indentDelta,0),o),a=_x.reindentLine(e,this._replyIndentStyle??{insertSpaces:!0,tabSize:4},r,s);return new VN(e,n,a,o)}},BN=class{constructor(e,r){this.line=e;this.anchor=r}},qN=class{constructor(e,r){this.lineIndex=e;this.sentInCodeBlock=r}},HN=class{constructor(e,r){this.startLineIndex=e;this.endLineIndex=r}},jN=class{constructor(e,r,n,o,s,a,c){this.outputStream=e;this.uri=r;this.languageId=a;this._originalLines=[];this.lines=[];this._didEdits=!1;this._didReplaceEdits=!1;this._additionalImports=[];this.indentStyle=_x.getDocumentIndentStyle(n,c),this._originalLines=n.split(/\r\n|\r|\n/g);for(let u=0;u<this._originalLines.length;u++)this.lines[u]=new Ih(this._originalLines[u],this.indentStyle);this.firstSentLineIndex=Number.MAX_SAFE_INTEGER;for(let u of o)this.lines[u.lineIndex].markSent(u.sentInCodeBlock),this.firstSentLineIndex=Math.min(this.firstSentLineIndex,u.lineIndex);this.firstSentLineIndex=Math.min(this.firstSentLineIndex,s.startLineIndex)}get didEdits(){return this._didEdits}get didReplaceEdits(){return this._didReplaceEdits}get additionalImports(){return this._additionalImports}getText(){return this.lines.map(e=>e.content).join(`
`)}getLineCount(){return this.lines.length}getLine(e){if(e<0||e>=this.lines.length)throw new Error("Invalid index");return this.lines[e]}addAdditionalImport(e){this._additionalImports.push(e)}replaceLine(e,r,n=!1){let o=typeof r=="string"?r:r.adjustedContent;return this.lines[e]=new Ih(o,this.indentStyle),this.outputStream.textEdit(this.uri,[new On(new Ge(e,0,e,1073741824),o)]),this._didEdits=!0,this._didReplaceEdits=this._didReplaceEdits||!n,e+1}replaceLines(e,r,n){if(e>r)throw new Error("Invalid range");return e===r?this.replaceLine(e,n):(this.lines.splice(e,r-e+1,new Ih(n.adjustedContent,this.indentStyle)),this.outputStream.textEdit(this.uri,[new On(new Ge(e,0,r,1073741824),n.adjustedContent)]),this._didEdits=!0,this._didReplaceEdits=!0,e+1)}appendLineAtEndOfDocument(e){return this.lines.push(new Ih(e.adjustedContent,this.indentStyle)),this.outputStream.textEdit(this.uri,[new On(new Ge(this.lines.length-1,1073741824,this.lines.length-1,1073741824),`
`+e.adjustedContent)]),this._didEdits=!0,this.lines.length}insertLineAfter(e,r){return this.lines.splice(e+1,0,new Ih(r.adjustedContent,this.indentStyle)),this.outputStream.textEdit(this.uri,[new On(new Ge(e,1073741824,e,1073741824),`
`+r.adjustedContent)]),this._didEdits=!0,e+2}insertLineBefore(e,r){return e===this.lines.length?this.insertLineAfter(e-1,r):(this.lines.splice(e,0,new Ih(r.adjustedContent,this.indentStyle)),this.outputStream.textEdit(this.uri,[new On(new Ge(e,0,e,0),r.adjustedContent+`
`)]),this._didEdits=!0,e+1)}deleteLines(e,r){return this.lines.splice(e,r-e+1),this.outputStream.textEdit(this.uri,[new On(new Ge(e,0,r+1,0),"")]),this._didEdits=!0,this._didReplaceEdits=!0,e+1}},VN=class{constructor(e,r,n,o){this.originalContent=e;this.originalIndentLevel=r;this.adjustedContent=n;this.adjustedIndentLevel=o;this.trimmedContent=this.originalContent.trim()}},GN=class{constructor(e){this.lineIndex=e}};var Ih=class{constructor(e,r){this.content=e;this._indentStyle=r;this._sentInCodeBlock=0;this._trimmedContent=null;this._normalizedContent=null;this._indentLevel=-1}get isSent(){return this._sentInCodeBlock!==0}get sentInCodeBlock(){return this._sentInCodeBlock}get trimmedContent(){return this._trimmedContent===null&&(this._trimmedContent=this.content.trim()),this._trimmedContent}get normalizedContent(){return this._normalizedContent===null&&(this._normalizedContent=Fq(this.content,this._indentStyle.tabSize,this._indentStyle.insertSpaces)),this._normalizedContent}get indentLevel(){return this._indentLevel===-1&&(this._indentLevel=MN(this.content,this._indentStyle.tabSize)),this._indentLevel}markSent(e){this._sentInCodeBlock=e}},_x=class t{static getDocumentIndentStyle(e,r){return r||xh(yx.fromString(e),4,!1)}static guessIndentStyleFromLine(e){let r=t._getLeadingWhitespace(e);if(!(r===""||r===" "))return xh([e],4,!1)}static reindentLine(e,r,n,o=s=>s){let s=MN(e,r.tabSize),a=o(s);for(;s>0;)e=this._outdent(e,r),s--;for(;s<a;)e="	"+e,s++;return Fq(e,n.tabSize,n.insertSpaces)}static _outdent(e,r){let n=0;for(;n<e.length;){let o=e.charCodeAt(n);if(o===9){n++;break}if(o!==32||n===r.tabSize)break;n++}return e.substring(n)}static _getLeadingWhitespace(e){for(let r=0;r<e.length;r++){let n=e.charCodeAt(r);if(n!==32&&n!==9)return e.substring(0,r)}return e}};var Iw=class{static combine(...e){return r=>e.every(n=>n?n(r):!0)}static{this.noop=()=>!0}static createCodeBlockFilter(){let e;(a=>(a[a.BeforeCodeBlock=0]="BeforeCodeBlock",a[a.InCodeBlock=1]="InCodeBlock",a[a.AfterCodeBlock=2]="AfterCodeBlock"))(e||={});let r=0;return n=>r===0?(/^```/.test(n.value)&&(r=1),!1):r===1?/^```/.test(n.value)?(r=2,!1):!0:!1}static createCodeMarkerRemovingFilter(e){let r=Ra.begin(e),n=Ra.end(e),o=!0,s=!1;return a=>o&&wa.testLine(e,a.value)?(o=!1,!1):!s&&/^\s*$/.test(a.value)||a.value.startsWith(r)||a.value.startsWith(n)?!1:(s=!0,!0)}},zN=class{constructor(e){this.value=e;this.__lineOfTextBrand=void 0}};var bx=class{constructor(e,r){this.value=e;this.kind=r}},vi=class t{static createCodeBlockClassifier(){return t.createFencedBlockClassifier("```")}static createAlwaysInsideCodeBlockClassifier(){return e=>Zo.map(e,r=>new bx(r,1))}static createFencedBlockClassifier(e){return r=>new Zo(async n=>{let o=new jq(r[Symbol.asyncIterator]()),s=0;for(;!o.endOfStream;)if(await o.peek(e.length)!==e)for(;!o.endOfStream;){let c=o.readImmediateExcept(`
`);if(c.length>0&&n.emitOne(new bx(c,s)),await o.peek(1)===`
`){o.readImmediate(1),n.emitOne(new bx(`
`,s));break}}else{let c="";for(;!o.endOfStream;){let u=o.readImmediateExcept(`
`);if(c+=u,await o.peek(1)===`
`){o.readImmediate(1),c+=`
`,s=s===1?0:1,n.emitOne(new bx(c,2));break}}}})}},jq=class{constructor(e){this._source=e;this._buffer="";this._atEnd=!1}get endOfStream(){return this._buffer.length===0&&this._atEnd}async extendBuffer(){if(this._atEnd)return;let{value:e,done:r}=await this._source.next();r?this._atEnd=!0:this._buffer+=e}async waitForLength(e){for(;this._buffer.length<e&&!this._atEnd;)await this.extendBuffer()}async peek(e){return await this.waitForLength(e),this._buffer.substring(0,e)}async read(e){await this.waitForLength(e);let r=this._buffer.substring(0,e);return this._buffer=this._buffer.substring(e),r}readImmediateExcept(e){let r=this._buffer.indexOf(e);return this.readImmediate(r===-1?this._buffer.length:r)}readImmediate(e){let r=this._buffer.substring(0,e);return this._buffer=this._buffer.substring(e),r}},$N=class{},WN=class t{constructor(e){this._source=e;this._buffer=[];this._atEnd=!1}static{this.EOS=new $N}get endOfStream(){return this._buffer.length===0&&this._atEnd}async extendBuffer(){if(this._atEnd)return;let{value:e,done:r}=await this._source.next();r?this._atEnd=!0:this._buffer.push(e)}async peek(){return this._buffer.length===0&&!this._atEnd&&await this.extendBuffer(),this._buffer.length===0?t.EOS:this._buffer[0]}async read(){return this._buffer.length===0&&!this._atEnd&&await this.extendBuffer(),this._buffer.length===0?t.EOS:this._buffer.shift()}async readWhile(e,r){do{let n=await this.peek();if(n instanceof $N||!e(n))break;await this.read(),await r(n)}while(!0)}async consumeToEnd(){for(;!this.endOfStream;)await this.read()}};function Rse(t){return new Zo(async e=>{let r="";for await(let n of t){r+=n;do{let o=r.indexOf(`
`);if(o===-1)break;let s=r.substring(0,o);r=r.substring(o+1),e.emitOne(new zN(s))}while(!0)}r.length>0&&e.emitOne(new zN(r))})}function Vq(t,e){let r=!1,n=!1;return t.filter(o=>vx(o.value,e.languageId)?(e.addAdditionalImport(qq(o.value)),r=!0,!1):o.value.trim().length===0&&r?n:(n=!0,!0))}var Cw=class extends Error{constructor(e){super(typeof e=="string"?e:e.message),this.errorDetails=typeof e=="string"?{message:e}:e}},Fn=class extends Wc{constructor(r){super();this.replyInterpreter=r}},Ix=class extends Wc{constructor(r){super();this.followUps=r}};var KN=class{async processResponse(e,r,n){for await(let o of e)r.markdown(o.delta.text);return{type:"conversational"}}};var Eh=class{constructor(e){this.textLength=e.length,this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0),this.lineLengthsByLineIdx=[];let r=0;for(let n=0;n<e.length;n++)e.charAt(n)===`
`?(this.lineStartOffsetByLineIdx.push(n+1),this.lineLengthsByLineIdx.push(r),r=0):r++;this.lineLengthsByLineIdx.push(r)}getLineCount(){return this.lineStartOffsetByLineIdx.length}getLineOffset(e){return this.lineStartOffsetByLineIdx[e]}getLineLength(e){return this.lineLengthsByLineIdx[e]}getOffset(e){return e=this.validatePosition(e),this.lineStartOffsetByLineIdx[e.line]+e.character}getPosition(e){e<0&&(e=0),e>this.textLength&&(e=this.textLength);let r=ed(this.lineStartOffsetByLineIdx,s=>s<=e),n=r,o=e-this.lineStartOffsetByLineIdx[r];return new $n(n,o)}toRange(e){return new Ge(this.getPosition(e.start),this.getPosition(e.endExclusive))}toOffsetRange(e){return new zt(this.getOffset(e.start),this.getOffset(e.end))}toOffsetEdit(e){let r=e.map(n=>new On(this.validateRange(n.range),n.newText));return new Wr(r.map(n=>new yo(this.toOffsetRange(n.range),n.newText)))}toTextEdits(e){return e.edits.map(r=>new On(this.toRange(r.replaceRange),r.newText))}validatePosition(e){let{line:r,character:n}=e;return r<0?(r=0,n=0):r>=this.lineLengthsByLineIdx.length?(r=this.lineLengthsByLineIdx.length-1,n=this.lineLengthsByLineIdx[r]):n<0?n=0:n>this.lineLengthsByLineIdx[r]&&(n=this.lineLengthsByLineIdx[r]),new $n(r,n)}validateRange(e){return new Ge(this.validatePosition(e.start),this.validatePosition(e.end))}},bd={Mute:ka.discard(),Emit:ka.identity()};var YN=class{constructor(e,r,n,o,s){this._outputStream=e;this._leadingMarkdownStreamPipe=r;this._earlyStopping=n;this._responseStream=new th;this._lastLength=0;this._leftFirstCodeBlock=!1;let a=o(this._responseStream.asyncIterable);this._streamingPromise=this._process(a,s)}async _process(e,r){let n=new th,o=this._leadingMarkdownStreamPipe(n.asyncIterable);wse(o,d=>this._outputStream.markdown(d));let s=new th,a=Rse(s.asyncIterable),c=r.processStream(a),u=e.filter(d=>d.kind!==2),l=new WN(u[Symbol.asyncIterator]());return await l.readWhile(d=>d.kind===0,d=>n.emitOne(d.value)),n.resolve(),await l.readWhile(d=>d.kind===1,d=>s.emitOne(d.value)),this._leftFirstCodeBlock=!0,await l.consumeToEnd(),s.resolve(),c}update(e){if(this._earlyStopping===1&&this._leftFirstCodeBlock)return{shouldFinish:!0};let r=e.slice(this._lastLength);return this._lastLength=e.length,this._responseStream.emitOne(r),{shouldFinish:!1}}async finish(){return this._responseStream.resolve(),await this._streamingPromise}};var X0=z(at());var p5e="vscode-notebook-cell";function $t(t){return t.scheme===p5e||t.scheme==="untitled"&&t.fragment.startsWith("notebook-chat-input")}var Zt=class extends Q{render(){return vscpp(vscppf,null,"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),`If you are asked to generate content that is harmful, hateful, racist, sexist, lewd, violent, or completely irrelevant to software engineering, only respond with "Sorry, I can't assist with that."`,vscpp("br",null),"Keep your answers short and impersonal.")}};var Rx=z(at());function Ase(t,e,r){let n=e.getText(),o=Ew.convertToLinkedTree(n,Dse(t,n)),s=e.offsetAt(r.start),a=e.offsetAt(r.end);return{adjusted:h5e(o,s,a),original:new zt(s,a)}}function Dse(t,e){let r=f5e(t.startIndex,e),n=m5e(t.endIndex,e),o=t.children.map(s=>Dse(s,e));return r===t.startIndex&&n===t.endIndex&&aU(o,t.children)?t:new gd(r,n,t.kind,o)}function f5e(t,e){for(;t<e.length;){let r=e.charCodeAt(t);if(r!==32&&r!==9&&r!==10&&r!==13)return t;t++}return t}function m5e(t,e){for(;t>0;){let r=e.charCodeAt(t-1);if(r!==32&&r!==9&&r!==10&&r!==13)return t;t--}return t}function h5e(t,e,r){return[e,r]=g5e(t,e,r),v5e(t,e,r)}function g5e(t,e,r){let n=t.text.substring(e,r);if(!/^\s*$/.test(n))return[e,r];let s=e,a=r,c=!0,u=!0;do{if(u&&a>=t.text.length&&(u=!1),u){let l=t.text.charCodeAt(a);if(l===13||l===10)u=!1;else{if(l!==32&&l!==9)return[a,a+1];a++}}if(c&&s===0&&(c=!1),c){let l=t.text.charCodeAt(s-1);if(l===13||l===10)c=!1;else{if(l!==32&&l!==9)return[s-1,s];s--}}}while(c||u);return[e,r]}function v5e(t,e,r){e>0&&e<r&&t.text.charCodeAt(e-1)!==10&&t.text.charCodeAt(e)===10&&e++,e=kse(t,e),r=Pse(t,r);let n=t.findLeaf2(e),o=t.findLeaf2(r),s=!1,a=u=>{u<e&&(e=kse(t,u),s=!0,n=t.findLeaf2(e))},c=u=>{u>r&&(r=Pse(t,u),s=!0,o=t.findLeaf2(r))};do{if(s=!1,n instanceof Tw){let u=n.isFirstGapInParent?n.parent.lastGap:null,l=n.hasSelectedContent(e,r),d=u&&u.hasSelectedContent(e,r),p=l||d;p&&a(n.firstNonWhitespaceIndex),p&&u&&c(u.lastNonWhitespaceIndex+1)}if(o instanceof Tw){let u=o.isLastGapInParent?o.parent.firstGap:null,l=o.hasSelectedContent(e,r),d=u&&u.hasSelectedContent(e,r),p=l||d;p&&o.lastNonWhitespaceIndex+1>r&&c(o.lastNonWhitespaceIndex+1),p&&u&&a(u.firstNonWhitespaceIndex)}n instanceof Ew&&t.hasContentInRange(new zt(e,r))&&n.startIndex<e&&a(n.startIndex),o instanceof Ew&&t.hasContentInRange(new zt(e,r))&&o.endIndex>r&&c(o.endIndex)}while(s);return new zt(e,r)}function kse(t,e){for(;e>0;){let r=t.text.charCodeAt(e-1);if(r!==32&&r!==9)break;e--}return e}function Pse(t,e){if((e>0?t.text.charCodeAt(e-1):0)===10)return e;for(;e<t.text.length;){let n=t.text.charCodeAt(e);if(n!==32&&n!==9)break;e++}return e}function Nse(t){return t.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t")}var Ew=class t{constructor(e,r,n,o,s,a,c){this._originalText=e;this.parent=r;this.startIndex=n;this.endIndex=o;this.kind=s;this.children=a;this.myIndex=c}static convertToLinkedTree(e,r){let n=new t(e,null,r.startIndex,r.endIndex,r.kind,[],0);return t._convertChildrenToLinkedTree(e,r,n),n}static _convertChildrenToLinkedTree(e,r,n){for(let o=0;o<r.children.length;o++){let s=r.children[o],a=new t(e,n,s.startIndex,s.endIndex,s.kind,[],o);n.children.push(a),t._convertChildrenToLinkedTree(e,s,a)}}get text(){return this._originalText.substring(this.startIndex,this.endIndex)}textAt(e){return e.substring(this._originalText)}hasContentInRange(e){let r=this.textAt(e);return!/^\s*$/s.test(r)}toString(){return`Node (${this.startIndex}-${this.endIndex}) ${Nse(this._originalText.substring(this.startIndex,this.endIndex))}`}gapBeforeChild(e){let r=e===0?this.startIndex:this.children[e-1].endIndex,n=e===this.children.length?this.endIndex:this.children[e].startIndex;return new Tw(this._originalText,this,r,n,e)}childAt(e){return this.children[e]??null}get firstGap(){return this.children.length===0?null:this.gapBeforeChild(0)}get lastGap(){return this.children.length===0?null:this.gapBeforeChild(this.children.length)}findLeaf(e){if(this.children.length===0)return[this,0];let r=ure(this.children.length,n=>{let o=this.children[n];return e>=o.startIndex&&e<=o.endIndex?0:e<o.startIndex?1:-1});return r<0?[this,r]:this.children[r].findLeaf(e)}findLeaf2(e){let[r,n]=this.findLeaf(e);return n<0?r.gapBeforeChild(~n):r}get nextLeaf(){let e=this;do{let r=e.nextSibling;if(r)return r.leftMostLeafChild;e=e.parent}while(e);return null}get leftMostLeafChild(){let e=this;for(;e.children.length>0;)e=e.children[0];return e}get prevSibling(){let e=this.parent,r=this.myIndex-1;return e&&r>=0?e.children[r]:null}get nextSibling(){let e=this.parent,r=this.myIndex+1;return e&&r<e.children.length?e.children[r]:null}},Tw=class{constructor(e,r,n,o,s){this._originalText=e;this.parent=r;this.startIndex=n;this.endIndex=o;this.gapIndex=s;if(this.startIndex>this.endIndex)throw new sn("Invalid gap")}get range(){return new zt(this.startIndex,this.endIndex)}get isFirstGapInParent(){return this.gapIndex===0}get isLastGapInParent(){return this.gapIndex===this.parent.children.length}toString(){return`NodeGap (${this.startIndex}-${this.endIndex}) ${Nse(this._originalText.substring(this.startIndex,this.endIndex))}`}get text(){return this._originalText.substring(this.startIndex,this.endIndex)}hasSelectedContent(e,r){let n=this.range.intersect(new zt(e,r)),o=n?this._originalText.substring(n.start,n.endExclusive):"";return!/^\s*$/s.test(o)}get firstNonWhitespaceIndex(){let e=this.startIndex;for(;e<this.endIndex;){let r=this._originalText.charCodeAt(e);if(r!==9&&r!==32&&r!==10)return e;e++}return this.endIndex}get lastNonWhitespaceIndex(){let e=this.endIndex-1;for(;e>=this.startIndex;){let r=this._originalText.charCodeAt(e);if(r!==9&&r!==32&&r!==10)return e;e--}return this.startIndex-1}get nextLeaf(){let e=this.parent.childAt(this.gapIndex);return e?e.leftMostLeafChild:this.parent.nextLeaf}};function Gq(t,e){let r=e(t);return{...r,range:[r.range.start,r.range.endExclusive],children:r.children?.map(n=>Gq(n,e))}}function Lse(t,e){let r=T_(e,a=>a.endExclusive>=t.start),n=ed(e,a=>a.start<=t.endExclusive)+1;if(r===n)return[t];let o=[],s=t.start;for(let a=r;a<n;a++){let c=e[a];c.start>s&&o.push(new zt(s,c.start)),s=c.endExclusive}return s<t.endExclusive&&o.push(new zt(s,t.endExclusive)),o}var hc=class{constructor(e,r,n){this.originalText=e;this.edits=r;this.languageId=n;this._positionOffsetTransformer=new Wi(()=>new Eh(this.text));this._originalPositionOffsetTransformer=new Wi(()=>new Eh(this.originalText));this._text=new Wi(()=>this.edits.apply(this.originalText))}get positionOffsetTransformer(){return this._positionOffsetTransformer.value}get originalPositionOffsetTransformer(){return this._originalPositionOffsetTransformer.value}get text(){return this._text.value}get lineCount(){return this.positionOffsetTransformer.getLineCount()}project(e){return this.edits.applyToOffset(e)}projectOffsetRange(e){return this.edits.applyToOffsetRange(e)}projectRange(e){let r=this.originalPositionOffsetTransformer.toOffsetRange(e),n=this.projectOffsetRange(r);return this.positionOffsetTransformer.toRange(n)}projectBack(e){return this.edits.applyInverseToOffset(e)}projectBackOffsetEdit(e){return e.tryRebase(this.edits.inverse(this.originalText))}projectBackTextEdit(e){let r=this.positionOffsetTransformer.toOffsetEdit(e),n=this.projectBackOffsetEdit(r);return this.originalPositionOffsetTransformer.toTextEdits(n)}};function Ose(t){return t*4}async function Mse(t,e,r,n,o,s){let a=await Y0(t,e,r),c=Ase(a,e,n),u=Tx(Ose(o),e,n,a,s);return{document:u,adjustedSelection:u.projectOffsetRange(c.adjusted),selection:u.projectOffsetRange(c.original)}}var Cx=class{constructor(e){this._parserService=e}summarizeDocument(e,r,n,o,s){return Rw(this._parserService,e,r,n,o,s)}};Cx=O([x(0,mt)],Cx);async function Rw(t,e,r,n,o,s){let a=await Y0(t,e,r);return Tx(Ose(o),e,n,a,s)}function Tx(t,e,r,n,o={}){let s=e.getText(),a=new zq(s,e.languageId),c=r?new zt(e.offsetAt(r.start),e.offsetAt(r.end)):void 0,u=$q.fromNode(n,a),l=Wq.fromNode(u,s),d=Kq.fromNode(l,!!o.tryPreserveTypeChecking);c&&d.visitAll(T=>T.node.range.intersectsOrTouches(c)?(T.node.children.length===0&&T.markAsSurviving(),!0):!1);let p=d.getTextFragment(),f=T=>c?T.range.endExclusive<c.start?c.start-T.range.endExclusive:T.range.start>c.endExclusive?3*(T.range.start-c.endExclusive):0:0,m=new w0(T=>c?T.children.length===0?T.range.intersectsOrTouches(c)?0:Number.MAX_SAFE_INTEGER:Math.min(...T.children.map(A=>m.get(A)))+1:0),h=new w0(T=>{let A=T.parent?h.get(T.parent):Number.MAX_SAFE_INTEGER,B=m.get(T);return Math.min(A,B)}),g=!!o.tryPreserveTypeChecking,v=T=>g&&T.node?.kind==="import_statement"?0:100*h.get(T)+T.depth+10*(f(T)/s.length),y=typeof o.costFnOverride=="object"?o.costFnOverride.createCostFn(a):o.costFnOverride;if(y!==void 0){let T=v;v=A=>{let B=T(A);return A.node?y(A.node,B):B}}let _=d.getDescendantsAndSelf().map(T=>({node:T,cost:v(T.node)}));_.sort(MA(T=>T.cost,FA));for(let{node:T}of _){T.markAsSurviving();let A=d.getTextFragment();if(A.length>t)break;p=A}let S=new hc(s,p.toTextEditFromOriginal(s.length),e.languageId),I=S;return I.getVisualization=()=>({$fileExtension:"ast.w",source:{value:S.originalText,decorations:Lse(zt.ofLength(S.originalText.length),S.edits.edits.map(T=>T.replaceRange)).map(T=>({range:[T.start,T.endExclusive],color:"lime"}))},root:Gq(d,T=>({label:(T.node.node?.kind||"unknown")+` (${_.find(A=>A.node===T)?.cost})`,range:T.node.range,children:T.childNodes,isMarked:T._surviving}))}),S}var zq=class{constructor(e,r){this.text=e;this.languageId=r}},$q=class t{constructor(e,r,n,o,s){this.parent=e;this.overlayNode=r;this.range=n;this.children=o;this.document=s}static fromNode(e,r,n=void 0){let o=new zt(e.startIndex,e.endIndex),s=[],a=new t(n,e,o,s,r);for(let c of e.children)s.push(t.fromNode(c,r,a));return a}get kind(){return this.overlayNode.kind}get text(){return this.range.substring(this.document.text)}},Wq=class t{constructor(e,r,n,o,s,a){this.node=e;this.range=r;this.children=n;this.depth=o;this.parent=s;this.document=a}static fromNode(e,r,n=0,o=null){let s=[],a=new t(e,e.range,s,n,o,r);if(e.children.length>0){let c=e.range.start;for(let l of e.children){let d=new zt(c,l.range.start);d.isEmpty||s.push(new t(void 0,d,[],n,a,r)),s.push(t.fromNode(l,r,n+1,a)),c=l.range.endExclusive}let u=new zt(c,e.range.endExclusive);u.isEmpty||s.push(new t(void 0,u,[],n,a,r))}return a}},Kq=class t{constructor(e,r,n,o){this.node=e;this.parent=r;this.childNodes=n;this._tryPreserveTypeChecking=o;this._surviving=!1;this._textFragment=null}static fromNode(e,r){return t.fromNodeParent(e,null,r)}static fromNodeParent(e,r,n){let o=[],s=new t(e,r,o,n);for(let a of e.children){let c=t.fromNodeParent(a,s,n);o.push(c)}return s}visitAll(e){if(e(this))for(let r of this.childNodes)r.visitAll(e)}markAsSurviving(){this._surviving||(this._surviving=!0,this.parent&&this.parent.markAsSurviving(),this.invalidate())}invalidate(){this._textFragment&&(this._textFragment=null,this.parent&&this.parent.invalidate())}getTextFragment(){return this._textFragment||(this._textFragment=this._computeSummarization()),this._textFragment}_computeSummarization(){if(this.childNodes.length===0&&(this._surviving||!this.node.node))return new Th(this.node.range,this.node.document);if(!this._surviving)return new Ex("");let e=[];for(let r of this.childNodes){let n=r.getTextFragment();if(n.length===0){e.length>0&&e[e.length-1].length===0||e.push(n);continue}y5e(e,n)}for(let r=0;r<=e.length-3;r++){let n=e[r],o=e[r+1],s=e[r+2];if(o.length===0&&n instanceof Th&&s instanceof Th){let a=n.trimEnd(),c=s.trimStart();a.endsWith("{")&&c.startsWith("}")&&(e[r]=a,e[r+1]=new Ex(this._tryPreserveTypeChecking?"/* ... */":"\u2026"),e[r+2]=c)}}return QN.from(e)}getDescendantsAndSelf(){let e=[];return this._getDescendantsAndSelf(e),e}_getDescendantsAndSelf(e){e.push(this);for(let r of this.childNodes)r._getDescendantsAndSelf(e)}},ww=class{toTextEditFromOriginal(e){let r=[],n=0,o="";function s(c){(n!==c||o.length>0)&&(r.push(new yo(new zt(n,c),o)),o="")}function a(c){if(c instanceof QN)for(let u of c.fragments)a(u);else c instanceof Ex?o+=c.text:c instanceof Th&&(s(c.range.start),n=c.range.endExclusive)}return a(this),s(e),new Wr(r)}},Ex=class extends ww{constructor(r){super();this.text=r}get length(){return this.text.length}},Th=class t extends ww{constructor(r,n){super();this.range=r;this.originalText=n}get length(){return this.range.length}get text(){return this.range.substring(this.originalText)}trimStart(){let r=this.text.trimStart();return r.length===this.length?this:new t(new zt(this.range.endExclusive-r.length,this.range.endExclusive),this.originalText)}trimEnd(){let r=this.text.trimEnd();return r.length===this.length?this:new t(new zt(this.range.start,this.range.start+r.length),this.originalText)}startsWith(r){return this.text.startsWith(r)}endsWith(r){return this.text.endsWith(r)}tryJoin(r){return this.range.endExclusive===r.range.start?new t(new zt(this.range.start,r.range.endExclusive),this.originalText):null}},QN=class t extends ww{constructor(r){super();this.fragments=r;this.length=this.fragments.reduce((r,n)=>r+n.length,0)}static from(r){return r.length===0?new Ex(""):r.length===1?r[0]:new t(r)}get text(){return this.fragments.map(r=>r.text).join("")}};function y5e(t,e){if(e.length===0)return;let r=t[t.length-1];if(r&&r instanceof Th&&e instanceof Th){let n=r.tryJoin(e);if(n){t[t.length-1]=n;return}}t.push(e)}var wx=class extends Q{constructor(r,n,o,s){super(r);this.workspaceService=n;this.ignoreService=o;this.instantiationService=s}async render(r,n){let o="uri"in this.props.variableValue?this.props.variableValue.uri:this.props.variableValue;if(await this.ignoreService.isCopilotIgnored(o))return vscpp("ignoredFiles",{value:[o]});let s="range"in this.props.variableValue?this.props.variableValue.range:void 0,a=await this.workspaceService.openTextDocument(o);if(s)return vscpp(vscppf,null,"# ",this.props.variableName.toUpperCase()," CONTEXT",vscpp("br",null),vscpp(W0,{languageId:a.languageId,uri:o,range:s,code:a.getText(s),variableName:this.props.variableName,isSummarized:!1}));let u=await this.instantiationService.createInstance(Cx).summarizeDocument(a,void 0,s,n.tokenBudget,{costFnOverride:b5e});return vscpp(vscppf,null,"# ",this.props.variableName.toUpperCase()," CONTEXT",vscpp("br",null),vscpp(W0,{languageId:a.languageId,uri:o,range:s,code:u.text,variableName:this.props.variableName,isSummarized:u.text.length<u.originalText.length}))}};wx=O([x(1,Je),x(2,De),x(3,te)],wx);var b5e={createCostFn(t){let e=new w0(r=>{if(t.languageId==="typescript"){let n=r.parent?e.get(r.parent):1,o=r.text.trim();if(o.startsWith("private "))return n*1.1;if(o.startsWith("export ")||o.startsWith("public "))return n*.9}return 1});return(r,n)=>{if(r.kind==="import_statement")return 1e3;let o=e.get(r);return n*o}}};var Ts=class extends Q{render(e,r){let n=XN(this.props.chatVariables);return vscpp(vscppf,null,...n.map(o=>Yq(o,this.props.priority)))}},ws=class extends Q{render(e,r){let n=this.props.chatVariables.substituteVariablesWithReferences(this.props.query);return vscpp(vscppf,null,n)}},Kr=class extends Q{render(e,r){let n=this.props.maintainOrder?this.props.chatVariables:this.props.chatVariables.reverse(),o=XN(n);return vscpp(vscppf,null,...o.map(s=>Yq(s,this.props.priority&&this.props.priority-1)),Yq(vscpp(ws,{chatVariables:n,query:this.props.query}),this.props.priority))}};function Yq(t,e){return vscpp(Rx.UserMessage,{priority:e},t)}function XN(t){let e=[];for(let{uniqueName:r,value:n}of t)n instanceof Ur||n instanceof hi?e.push(vscpp(wx,{variableName:r,variableValue:n})):typeof n=="string"&&e.push(vscpp(Rx.TextChunk,null,vscpp("references",{value:[new Rx.PromptReference({variableName:r})]}),"# ",r.toUpperCase()," CONTEXT",vscpp("br",null),n));return e}var JN=z(at());var kx=z(at()),_d=class extends Q{render(){return vscpp(vscppf,null,this.props.children)}};var Lt=class extends Q{render(e,r){let n=this.props.history.filter(s=>s.status==="success"||s.status==="in-progress");if(n.length===0)return;let o=[];for(let s of n)s.request.type==="user"&&o.push(vscpp(JN.UserMessage,null,s.request.message)),s.response?.type==="model"&&o.push(vscpp(JN.AssistantMessage,{name:s.response.name},s.response.message));return vscpp(kx.PrioritizedList,{priority:this.props.priority,descending:!1},o)}};var ZN=z(at());var Yr=class extends Q{render(e,r){let n=this.props.customInstructions.filter(o=>o.content.length>0);if(n.length!==0)return vscpp(vscppf,null,"When giving a reply, please also follow these user provided instructions. You can ignore an instruction if it contradicts the system messages.",vscpp("br",null),n.map(o=>_5e(o)))}};function _5e(t){return vscpp(ZN.TextChunk,null,vscpp("references",{value:[new ZN.PromptReference(t.reference)]}),t.content.join(`
`)," ",vscpp("br",null))}var gc=class t{constructor(e){this._push=e}static spy(e,r){return new t(n=>{r(n),e.push(n)})}markdown(e){this._push(new Qi(e))}anchor(e,r){this._push(new Une(e,r))}button(e){this._push(new ew(e))}filetree(e,r){this._push(new sh(e,r))}progress(e,r){typeof r>"u"?this._push(new ho(e)):this._push(new Bne(e,r))}reference(e,r){this._push(new qD(e,r))}reference2(e,r,n){this._push(new qne(e,r,n))}codeCitation(e,r,n){this._push(new Hne(e,r,n))}push(e){this._push(e)}textEdit(e,r){this._push(new Jp(e,r))}markdownWithVulnerabilities(e,r){this._push(new Vne(e,r))}detectedParticipant(e,r){this._push(new HD(e,r))}confirmation(e,r,n){this._push(new Gne(e,r,n))}warning(e){this._push(new jne(e))}};var eL=class{constructor(e){this._derivedDocument=e;this._workingCopyOriginalDocument=new Xq(this._derivedDocument.originalText)}get originalText(){return this._workingCopyOriginalDocument.text}get text(){return this._derivedDocument.text}get languageId(){return this._derivedDocument.languageId}get derivedDocumentTransformer(){return this._derivedDocument.positionOffsetTransformer}get originalDocumentTransformer(){return this._workingCopyOriginalDocument.transformer}get allReportedEdits(){return this._workingCopyOriginalDocument.appliedEdits}createDerivedDocumentChatResponseStream(e){return new gc(r=>{let n=this.applyAndTransformProgressItem(r);e.push(n)})}applyAndTransformProgressItem(e){if(!(e instanceof Jp))return e;let r=this._workingCopyOriginalDocument,n=this._derivedDocument,o=n.edits,a=Fse(n.positionOffsetTransformer,e.edits).tryRebase(o.inverse(r.text)),c=o.tryRebase(a),u=new Jp(e.uri,Use(r.transformer,a));return this._workingCopyOriginalDocument.applyOffsetEdits(a),this._derivedDocument=new hc(this._workingCopyOriginalDocument.text,c,this._derivedDocument.languageId),u}rebaseEdits(e){let r=this._workingCopyOriginalDocument,n=this._derivedDocument,o=n.edits,a=Fse(n.positionOffsetTransformer,e).tryRebase(o.inverse(r.text));return Use(r.transformer,a)}convertPostEditsOffsetToOriginalOffset(e){return this._derivedDocument.projectBack(e)}},Xq=class{constructor(e){this._text=e;this._transformer=null;this._appliedEdits=new Wr([])}get text(){return this._text}get transformer(){return this._transformer||(this._transformer=new Eh(this._text)),this._transformer}get appliedEdits(){return this._appliedEdits}applyOffsetEdits(e){let{edits:r}=e,n=this._text;for(let o=r.length-1;o>=0;o--){let s=r[o];n=n.substring(0,s.replaceRange.start)+s.newText+n.substring(s.replaceRange.endExclusive)}this._text=n,this._transformer=null,this._appliedEdits=this._appliedEdits.compose(e)}},tL=class{constructor(e){this._text=e;this._transformer=null}get text(){return this._text}get transformer(){return this._transformer||(this._transformer=new Eh(this._text)),this._transformer}};function Fse(t,e){return t.toOffsetEdit(e)}function Use(t,e){return t.toTextEdits(e)}var Px=class extends Q{constructor(r,n,o,s,a){super(r);this._ignoreService=n;this._parserService=o;this._experimentationService=s;this._configurationService=a}async render(r,n){let o=this.props.documentContext,s=o.document,a=s.languageId;if($t(s.uri))throw Gr("InlineChatGenerateCodePrompt should not be used with a notebook!");if(a==="markdown")throw Gr("InlineChatGenerateCodePrompt should not be used with a markdown document!");if(await this._ignoreService.isCopilotIgnored(s.uri))return vscpp("ignoredFiles",{value:[s.uri]});let{query:u,history:l,chatVariables:d,customInstructions:p}=this.props.promptContext,f=await this._configurationService.getExperimentBasedConfig(fe.ProjectLabelsInline,this._experimentationService),h=(await Pa(this._parserService,s,o.fileIndentInfo,s.validateRange(o.wholeRange),n.endpoint.modelMaxPromptTokens/3)).splitAroundOriginalSelectionEnd(),{codeAbove:g,hasContent:v,codeBelow:y}=h,b="$PLACEHOLDER$",_=`${g}${b}${y}`,S=h.createReplyInterpreter(ka.chain(I=>Zs(I,"`"+b+"`","selection"),I=>Zs(I,b,"selection")),1,n.endpoint.model==="gpt-4-0125-preview"?h.insertStreaming:h.insertOrReplaceStreaming,vi.createCodeBlockClassifier(),I=>I.value.trim()!==b);return vscpp(vscppf,null,vscpp("meta",{value:new Fn(S)}),vscpp(X0.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class expert in programming, and especially good at ",a,".",vscpp("br",null),"Source code is always contained in ``` blocks.",vscpp("br",null),"The user needs help to write some new code.",vscpp("br",null),v&&vscpp(vscppf,null,"The user includes existing code and marks with ",b," where the new code should go.",vscpp("br",null)),v&&vscpp(vscppf,null,'DO NOT include the text "',b,'" in your reply.',vscpp("br",null)),v&&vscpp(vscppf,null,"DO NOT repeat any code from the user in your reply.",vscpp("br",null)),!v&&vscpp(vscppf,null,"Your must generate a code block surrounded with ``` that will be used in a new file",vscpp("br",null)),vscpp(Zt,null)),f&&vscpp(Mo,{priority:600}),vscpp(Lt,{priority:700,history:l}),vscpp(X0.UserMessage,{priority:725},vscpp(Yr,{customInstructions:p})),vscpp(Ts,{priority:750,chatVariables:d}),v&&vscpp(X0.UserMessage,{priority:800},"I have the following code in a file called `",vscpp(Qs,{value:s.uri,mode:1}),"`:",vscpp(Oe,{uri:s.uri,languageId:a,code:_,shouldTrim:!1})),!v&&vscpp(X0.UserMessage,{priority:800},"I am in an empty file `",vscpp(Qs,{value:s.uri,mode:1}),"`."),vscpp(X0.UserMessage,{priority:900},vscpp(ws,{chatVariables:d,query:u}),vscpp("br",null),v&&vscpp(vscppf,null,"The code that would fit at ",b," with ``` is:")))}};Px=O([x(1,De),x(2,mt),x(3,Ut),x(4,ye)],Px);async function Pa(t,e,r,n,o){let s=await Mse(t,e,r,n,o);return new Jq(s.selection,s.adjustedSelection,s.document,e,r)}var Jq=class{constructor(e,r,n,o,s){this._selection=e;this._adjustedSelection=r;this._projectedDocument=n;this._document=o;this._formattingOptions=s}get uri(){return this._document.uri}get languageId(){return this._document.languageId}splitAroundAdjustedSelection(){return new rL(this._projectedDocument,this.uri,this._formattingOptions,this._adjustedSelection)}splitAroundOriginalSelectionEnd(){return new rL(this._projectedDocument,this.uri,this._formattingOptions,new zt(this._selection.endExclusive,this._selection.endExclusive))}},rL=class{constructor(e,r,n,o){this._projectedDocument=e;this._uri=r;this._formattingOptions=n;this._selection=this._projectedDocument.positionOffsetTransformer.toRange(o),this.codeAbove=this._projectedDocument.text.substring(0,o.start),this.codeSelected=this._projectedDocument.text.substring(o.start,o.endExclusive),this.codeBelow=this._projectedDocument.text.substring(o.endExclusive)}get hasCodeWithoutSelection(){return this.codeAbove.trim().length>0||this.codeBelow.trim().length>0}get hasContent(){return this.codeAbove.trim().length>0||this.codeSelected.trim().length>0||this.codeBelow.trim().length>0}get replaceSelectionStreaming(){return(e,r)=>new UN(r,this._selection,e)}get insertStreaming(){return(e,r)=>new Ch(r,this._selection.end,e)}get insertOrReplaceStreaming(){return(e,r)=>new xx(r,this._selection,this._selection,3,!0,e)}createReplyInterpreter(e,r,n,o,s){return new wh(this._uri,this._projectedDocument,this._formattingOptions,e,r,n,o,s)}},wh=class{constructor(e,r,n,o,s,a,c,u){this._uri=e;this._fileIndentInfo=n;this._leadingMarkdownStreaming=o;this._earlyStopping=s;this._streamingStrategyFactory=a;this._textPieceClassifier=c;this._lineFilter=u;this._lastText=void 0;this._initialDocumentSnapshot=new tL(r.originalText),this._workingCopySummarizedDoc=new eL(r)}async processResponse(e,r,n){let o=this._workingCopySummarizedDoc.createDerivedDocumentChatResponseStream(r),s=new jN(o,this._uri,this._workingCopySummarizedDoc.text,this._workingCopySummarizedDoc.text.split(`
`).map((l,d)=>new qN(d,4)),new HN(0,0),this._workingCopySummarizedDoc.languageId,this._fileIndentInfo),a=new YN(o,this._leadingMarkdownStreaming,this._earlyStopping,this._textPieceClassifier,this._streamingStrategyFactory(this._lineFilter,s));for await(let l of e){this._lastText=l.text;let{shouldFinish:d}=a.update(l.text);if(d)break}let{didEdits:c,additionalImports:u}=await a.finish();if(c){let l=this._generateAdditionalImportsEdits(u),d=this._workingCopySummarizedDoc.allReportedEdits.inverse(this._initialDocumentSnapshot.text),p=d.edits.reduce((h,g)=>h.join(g.replaceRange),d.edits[0].replaceRange),f=this._workingCopySummarizedDoc.originalDocumentTransformer.toRange(p),m={lastDocumentContent:this._workingCopySummarizedDoc.originalText,lastWholeRange:f};return r.textEdit(this._uri,l),{type:"inlineEdit",store:m}}if(u.length>0)return r.textEdit(this._uri,this._generateAdditionalImportsEdits(u)),{type:"inlineEdit"};if(!this._lastText)throw new Error("No text");return o.markdown(this._lastText),{type:"conversational"}}_generateAdditionalImportsEdits(e){if(e.length===0)return[];let r=this._workingCopySummarizedDoc.originalText.split(/\r\n|\r|\n/g),n=oU(r,s=>vx(s,this._workingCopySummarizedDoc.languageId));if(n===-1)return[new On(new Ge(0,0,0,0),e.join(`
`)+`

`)];let o=r[n].length;return[new On(new Ge(n,o,n,o),`
`+e.join(`
`))]}};var x5e=6e4,S5e=1500,hl=class{constructor(e,r,n,o,s){this.parserService=r;this.telemetryService=n;this.endpointProvider=o;this.instaService=s;this.id=hl.ID;this.description=oL.t("Add documentation comment for this symbol");this.locations=[1];this.commandInfo={};this.logger=e.getLogger("InlineDocIntent")}static{this.ID="doc"}get intentDetectionInput(){let e="generate_documentation_for_code";return{functionName:e,sampleQuestion:"Add jsdoc to this method",functionCallingBlurb:`If the active selection contains a symbol and the user's message is related to documenting code, adding docstrings, adding documentation, or adding comments, you should use the '${e}' function.`}}async asSlashCommand(e){if(e.document.lineCount>S5e||e.document.getText().length>x5e)return new Pw("Add documentation comment for this symbol");let r=await yh(this.parserService,this.telemetryService,e),n=r.identifier?oL.t("Add documentation comment for '{0}'",r.identifier):oL.t("Add documentation comment for this symbol");return new Pw(n,r)}async invoke(e){let r=e.documentContext;if(!r)throw new Error("Open a file to add documentation.");let n=e.slashCommand,o;n instanceof Pw?o=n.nodeToDocument:this.logger.warn("Unexpected: SlashCommand given to intent invocation is not a DocSlashCommand");let s=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo");return this.instaService.createInstance(kw,s,r,this,o)}};hl=O([x(0,ue),x(1,mt),x(2,me),x(3,Le),x(4,te)],hl);var Pw=class{constructor(e,r=void 0){this.description=e;this.nodeToDocument=r;this.name=hl.ID}},kw=class{constructor(e,r,n,o,s,a,c){this.endpoint=e;this.context=r;this.intent=n;this.nodeToDocument=o;this.parserService=s;this.telemetryService=a;this.instantiationService=c;this.location=1}async buildPrompt({query:e,history:r,chatVariables:n},o,s){let a=this.nodeToDocument??await yh(this.parserService,this.telemetryService,this.context);return await $e.create(this.instantiationService,this.endpoint,Zq,{userQuery:e,documentContext:this.context,nodeToDocument:a,endpointInfo:this.endpoint,history:r.at(-1)?.request.message,chatVariables:n}).render(o,s)}processResponseInline(e,r,n){let o=this.context.document,s=new hc(o.getText(),Wr.empty,o.languageId),a=this.nodeToDocument?.range??this.context.selection,c;if(o.languageId==="python"){let u=o.getText(a).split(`
`).filter(d=>d!=="").map(d=>d.trim()),l=new Set(u);c=new wh(this.context.document.uri,s,this.context.fileIndentInfo,bd.Mute,1,(d,p)=>new Ch(p,a.start,d),vi.createCodeBlockClassifier(),d=>!d.value.includes("FILEPATH")&&!l.has(d.value.trim()))}else c=new wh(this.context.document.uri,s,this.context.fileIndentInfo,bd.Mute,1,(u,l)=>new xx(l,a,a,1,!1,u),vi.createCodeBlockClassifier(),u=>!u.value.includes("FILEPATH"));return c.processResponse(e,r,n)}};kw=O([x(4,mt),x(5,me),x(6,te)],kw);var Zq=class extends Q{render(e,r){let n=EN(this.props.documentContext.language.languageId),o=this.props.chatVariables.substituteVariablesWithReferences(this.props.userQuery),s=`${this.getQueryPrefix()} ${o}`.trim();return vscpp(vscppf,null,vscpp(Aw.SystemMessage,null,"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You must follow user's requirements carefully.",vscpp("br",null),"You must follow Microsoft content policies.",vscpp("br",null),"You must avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, you should give a reminder that you are an AI programming assistant.",vscpp("br",null),"When user asks you to document something, you must answer in the form of a ",n," markdown code block.",vscpp("br",null)),vscpp(Ts,{chatVariables:this.props.chatVariables}),vscpp(vh,{documentContext:this.props.documentContext,nodeToDocument:this.props.nodeToDocument,endpointInfo:this.props.endpointInfo}),this.props.history&&this.props.history.length>0&&vscpp(Aw.UserMessage,null,this.props.history),vscpp(Aw.UserMessage,null,s))}getQueryPrefix(){let e=this.props.nodeToDocument?.identifier,r=e!==void 0&&e!=="",n=r?e:"the selection",o;switch(this.props.documentContext.language.languageId){case"typescript":case"typescriptreact":o=r?"a TSDoc comment":"TSDoc comment";break;case"javascript":case"javascriptreact":o=r?"a JSDoc comment":"JSDoc comment";break;case"python":o="docstring";break;default:o="documentation comment"}return`Please, given ${n}, generate ${o} only. Do not repeat given code, only reply with ${o} in a code block.`}};var Hse=z(Qt());var aL=z(at());var Hr=class extends Q{render(){return vscpp(vscppf,null,'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.")}};var I5e=["auto","en","fr","it","de","es","ru","zh-CN","zh-TW","ja","ko","cs","pt-br","tr","pl"],cr=class extends Q{constructor(r,n,o){super(r);this.configurationService=n;this.envService=o}render(){let r=this.configurationService.getConfig(fe.LocaleOverride);if(!I5e.find(o=>r===o))return;let n=r!=="auto"?r:this.envService.language;if(n!=="en")return vscpp(vscppf,null,"Respond in the following locale: ",n)}};cr=O([x(1,ye),x(2,Rt)],cr);var yi=class extends Q{render(){return vscpp(vscppf,null,"Your expertise is strictly limited to software development topics.",vscpp("br",null),"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, simply give a reminder that you are an AI programming assistant.",vscpp("br",null),"Keep your answers short and impersonal.")}};var Di=class extends Q{render(){return vscpp(vscppf,null,"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.")}};var sL=z(Qt()),qse=z(at());var Bse=z(at());var tu=class extends Q{constructor(r,n,o,s,a){super(r);this.ignoreService=n;this.extensionContext=o;this.tabsAndEditorsService=s;this.servicesAccessor=a}static{this.DEFAULT_TIMEOUT_MS=200}async prepare(){let r={implementations:[],activeDocument:void 0,isIgnored:!1},{document:n,range:o}=this.props;if(!n){let u=this.tabsAndEditorsService.activeTextEditor;if(!u)return r;n??=u.document,o??=u.selection}if(!o||o.isEmpty)return r;if(await this.ignoreService.isCopilotIgnored(n.uri))return{...r,isIgnored:!0};let s=this.extensionContext.extensionMode===$c.Test?0:this.props.timeoutMs===void 0?tu.DEFAULT_TIMEOUT_MS:this.props.timeoutMs,a=[{header:"Relevant function implementations",findImpls:gse},{header:"Relevant class declarations",findImpls:vse},{header:"Relevant type declarations",findImpls:yse}],c=[];for(let{header:u,findImpls:l}of a){let d=await l(this.servicesAccessor,n,o,s);c.push([u,d])}return{implementations:c,activeDocument:n,isIgnored:!1}}render(r,n){if(!r.implementations.length||!r.activeDocument)return;let o=r.activeDocument.uri;if(r.isIgnored)return vscpp("ignoredFiles",{value:[o]});let s=[],a=[],c=[];for(let[u,l]of r.implementations){let{references:d,usedContext:p,text:f,uris:m}=eH(r.activeDocument,l);if(f.length===0)continue;let h=vscpp(Bse.UserMessage,{priority:this.props.priority},u,":",vscpp("br",null),vscpp("br",null),f.map((g,v)=>vscpp(vscppf,null,vscpp(Oe,{code:g,languageId:r.activeDocument?.languageId,uri:m[v]}),vscpp("br",null))));s.push(h),a.push(...d),c.push(...p)}return vscpp(vscppf,null,vscpp("usedContext",{value:c}),vscpp("references",{value:a}),...s)}};tu=O([x(1,De),x(2,ar),x(3,kt),x(4,je)],tu);function eH(t,e){let r=[],n=new Map,o=new Set,s=[],a=[];for(let c of e){let u=c.uri??t.uri,l=c.range??Xs(t,c),d=`${u.toString()}-${l.start.line}-${l.start.character}-${l.end.line}-${l.end.character}`;if(o.has(d))continue;o.add(d),r.push(new Ss.PromptReference(new hi(u,l))),s.push(c.text),a.push(u);let[p,f]=n.get(u)??[c.version??t.version,[]];f.push(l),n.set(u,[p,f])}return{references:r,usedContext:[...n.entries()].map(([c,[u,l]])=>({uri:c,version:u,ranges:l})),text:s,uris:a}}var rs=class extends Q{constructor(r,n,o,s){super(r);this.accessor=n;this._languageFeaturesService=o;this._workspaceService=s}static getSymbolAtCursor(r,n){let{selection:o,document:s}=n;if(!o||!s){let u=r.get(kt).activeTextEditor;if(!u)return;({selection:o,document:s}=u)}if(!o.isEmpty)return;let a=s.getWordRangeAtPosition(o.active)??o;return{selectedText:s.getText(a),document:s,range:a}}static async getDefinitionAtRange(r,n,o,s){if(await r.get(De).isCopilotIgnored(n.uri))return;let c=r.get(mt).getTreeSitterAST(n);if(c===void 0)return;let u=Ji(o,n),l;s&&(l=await c.getNodeToExplain(u)),l??=await c.getNodeToDocument(u);let{startIndex:d,endIndex:p}="nodeToDocument"in l?l.nodeToDocument:l.nodeToExplain,f=Xs(n,{startIndex:d,endIndex:p});return{identifier:l.nodeIdentifier,text:n.getText(f),range:f,uri:n.uri,startIndex:d,endIndex:p}}static async getSelectedScope(r,n){let o=r.get(De);if(!n.document||await o.isCopilotIgnored(n.document.uri))return;let s=rs.getSymbolAtCursor(r,n),a,c=s?await rs.getDefinitionAtRange(r,s.document,s.range,!1):void 0;if(r.get(ye).getConfig(fe.ExplainScopeSelection)||s&&(c?.identifier!==s.selectedText||!s.selectedText)){let l=r.get(kt).activeTextEditor;if(!l)return;let d=await r.get(nh).selectEnclosingScope(l,{reason:sL.t("Select an enclosing range to explain"),includeBlocks:!0});if(d){let p=l.document,f=p.getText(d);if(!f)return;a={codeAtCursor:f,document:p,range:d,definitions:[],references:[]}}}return{symbolAtCursorState:a,definition:c,symbolAtCursor:s}}async prepare(r,n,o){let s=await rs.getSelectedScope(this.accessor,this.props).catch(()=>{});if(!s)return;let{symbolAtCursorState:a,definition:c,symbolAtCursor:u}=s;if(u){c?.identifier===u?.selectedText?a??={codeAtCursor:c.text,document:u.document,range:c.range,definitions:[],references:[]}:a??={codeAtCursor:u.document.lineAt(u.range.start).text,document:u.document,range:u.document.lineAt(u.range.start).range,definitions:[],references:[]},n.report(new ho(sL.t("Searching for relevant definitions...")));try{for(let l of await this._languageFeaturesService.getDefinitions(u.document.uri,u.range.start)){let{uri:d,range:p}=uf(l)?{uri:l.targetUri,range:l.targetRange}:l;if(p.isEqual(u.range))continue;let f=await this._workspaceService.openTextDocument(d),m=await rs.getDefinitionAtRange(this.accessor,f,p,!0);m&&a.definitions.push(m)}}catch{}n.report(new ho(sL.t("Searching for relevant references...")));try{let l=new Set;for(let d of await this._languageFeaturesService.getReferences(u.document.uri,u.range.start)){let{uri:p,range:f}=uf(d)?{uri:d.targetUri,range:d.targetRange}:d;if(f.isEqual(u.range))continue;let m=`${p.toString()}-${f.start.line}-${f.start.character}-${f.end.line}-${f.end.character}`;if(l.has(m))continue;l.add(m);let h=await this._workspaceService.openTextDocument(p),g=await rs.getDefinitionAtRange(this.accessor,h,f,!1);g&&a.references.push(g)}}catch{}return a}}render(r,n){if(!r)return;let o=[...r.definitions,...r.references];if(r.codeAtCursor){let{startIndex:c,endIndex:u}=Ji(r.range,r.document);o.push({version:r.document.version,uri:r.document.uri,range:r.range,text:r.codeAtCursor,startIndex:c,endIndex:u})}let{usedContext:s,references:a}=eH(r.document,o);return vscpp(vscppf,null,vscpp("usedContext",{value:s}),vscpp("references",{value:a}),vscpp(qse.UserMessage,null,"I have the following  code in the active editor:",vscpp("br",null),vscpp(Oe,{uri:r.document.uri,languageId:r.document.languageId,code:r.codeAtCursor}),vscpp("br",null),!!r.definitions.length&&vscpp(vscppf,null,"Here are some relevant definitions for the symbols in my code:",vscpp("br",null)),!!r.definitions.length&&vscpp(kx.PrioritizedList,{priority:this.props.priority,descending:!0},r.definitions.map(c=>vscpp(Oe,{uri:r.document.uri,languageId:r.document.languageId,code:c.text}))),!!r.references.length&&vscpp(vscppf,null,vscpp("br",null),"Here are some places where the the symbols in my code are referenced:",vscpp("br",null)),!!r.references.length&&vscpp(kx.PrioritizedList,{priority:this.props.priority-r.definitions.length,descending:!0},r.references.map(c=>vscpp(vscppf,null,!!c.uri&&vscpp(vscppf,null,"From the file ",KA(c.uri.toString()),":",vscpp("br",null)),vscpp(Oe,{uri:r.document.uri,languageId:r.document.languageId,code:c.text}),vscpp("br",null))))))}};rs=O([x(1,je),x(2,Ai),x(3,Je)],rs);var Ax=class extends Q{constructor(r,n){super(r);this.languageService=n}async prepare(){let r=!1,{document:n,selection:o}=this.props;return n?.uri&&o&&(r=this.languageService.getDiagnostics(n.uri).filter(u=>!!u.range.intersection(o)).filter(u=>u.severity<=$_.Warning).length>0),{explainingDiagnostic:r}}render(r,n){let{query:o,history:s,chatVariables:a,customInstructions:c}=this.props.promptContext,u=a.find(l=>l.originalName===Nr.variableInfo.name);return vscpp(vscppf,null,vscpp(aL.SystemMessage,{priority:1e3},"You are a world-class coding tutor. Your code explanations perfectly balance high-level concepts and granular details. Your approach ensures that students not only understand how to write code, but also grasp the underlying principles that guide effective programming.",vscpp("br",null),vscpp(Hr,null),vscpp(yi,null),vscpp(Di,null),vscpp(cr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Examine the provided code selection and any other context like user question, related errors, project details, class definitions, etc.",vscpp("br",null),"2. If you are unsure about the code, concepts, or the user's question, ask clarifying questions.",vscpp("br",null),"3. If the user provided a specific question or error, answer it based on the selected code and additional provided context. Otherwise focus on explaining the selected code.",vscpp("br",null),"4. Provide suggestions if you see opportunities to improve code readability, performance, etc.",vscpp("br",null),vscpp("br",null),"Focus on being clear, helpful, and thorough without assuming extensive prior knowledge.",vscpp("br",null),"Use developer-friendly terms and analogies in your explanations.",vscpp("br",null),"Identify 'gotchas' or less obvious parts of the code that might trip up someone new.",vscpp("br",null),"Provide clear and relevant examples aligned with any provided context."),vscpp(Lt,{priority:600,history:s}),vscpp(Mo,{priority:700}),vscpp(aL.UserMessage,{priority:750},vscpp(Yr,{customInstructions:c})),!u&&vscpp(Nr,{document:this.props.document,range:this.props.selection,priority:900}),vscpp(tu,{document:this.props.document,range:this.props.selection,priority:800}),!r.explainingDiagnostic&&vscpp(rs,{document:this.props.document,selection:this.props.selection,priority:800}),vscpp(Kr,{priority:900,chatVariables:a,query:o}))}};Ax=O([x(1,Ai)],Ax);var cL="Write an explanation for the active selection as paragraphs of text.",Dx=class extends Oo{constructor(r,n,o,s,a){super(r,n,o);this.tabsAndEditorsService=s;this.instantiationService=a}createRenderer(r,n,o,s){let a=this.tabsAndEditorsService.activeTextEditor;return $e.create(this.instantiationService,n,Ax,{promptContext:r,document:a?.document,selection:a?.selection})}};Dx=O([x(3,kt),x(4,te)],Dx);var tH=class extends Dx{async buildPrompt(e,r,n){return e.query===""&&(e={...e,query:cL}),super.buildPrompt(e,r,n)}processResponseInline(e,r,n){return new KN().processResponse(e,r,n)}},Nx=class{constructor(e,r){this.endpointProvider=e;this.instantiationService=r;this.id="explain";this.locations=[2,1];this.description=Hse.t("Explain how the code in your active editor works")}static{this.ID="explain"}get intentDetectionInput(){let e="explain_code_or_error";return{functionName:e,sampleQuestion:"Write an explanation for the code above as paragraphs of text.",functionCallingBlurb:`If the user's message asks for an explanation of code blocks or an error message, you should use the '${e}' function.`}}async invoke(e){let r=e.location,n=await Mn(this.endpointProvider,r);return r===1?this.instantiationService.createInstance(tH,this,r,n):this.instantiationService.createInstance(Dx,this,r,n)}async asSlashCommand(e){return{name:this.id,description:this.description}}};Nx=O([x(0,Le),x(1,te)],Nx);var Pae=z(Qt());var RL=z(at());var TL=z(Qt()),qw=z(at());var Bt=ae("IChatMLFetcher"),Lx=class{constructor(){this._stream=new th;this._seenAnnotationTypes=new Set}get stream(){return this._stream.asyncIterable}update(e,r){r.codeVulnAnnotations&&(!((e.match(/(^|\n)```/g)?.length??0)%2===1)||e.match(/(^|\n)```\w*\s*$/))&&(r.codeVulnAnnotations=void 0),r.codeVulnAnnotations&&(r.codeVulnAnnotations=r.codeVulnAnnotations.filter(n=>!this._seenAnnotationTypes.has(n.details.type)),r.codeVulnAnnotations.forEach(n=>this._seenAnnotationTypes.add(n.details.type))),this._stream.emitOne({text:e,delta:r})}resolve(){this._stream.resolve()}};function jse(t,e,r){return Math.min(Math.max(t,e),r)}function C5e(t){return t&&Array.isArray(t.text)&&(t.needsLeadingElipsis===void 0||typeof t.needsLeadingElipsis=="boolean")&&(t.needsTrailingElipsis===void 0||typeof t.needsTrailingElipsis=="boolean")}function E5e(t){return t&&typeof t.bodyIndent=="string"&&typeof t.fullRange=="object"&&t.body&&Array.isArray(t.body.content)&&(t.body.outline===void 0||C5e(t.body.outline))&&(t.suffix===void 0||typeof t.suffix=="string")&&(t.header===void 0||typeof t.header=="object"&&typeof t.header.original=="string"&&(t.header.outline===void 0||typeof t.header.outline=="string"))}var Ox=class t{constructor(e,r){this.lang=r;this._tokenizerProvider=e.get(dr),this._naiveChunker=new ld(this._tokenizerProvider),this._parserService=e.get(mt);let n=t.getFileChunkingOptions(r);this._inlineComment=n?.blockWrap??{start:"",end:""},this._elipsisPlaceholder=n?.elipsisPlaceholder??"...",this._lookForIndentInHeader=n?.lookForIndentInHeader??!0,this._numTokensInEllipsis=this._tokenizerProvider.acquireTokenizer("gpt4").tokenLength(this._elipsisPlaceholder)+1}static getFileChunkingOptions(e){return e!=="python"&&e!=="ruby"?{elipsisPlaceholder:"/*...*/",blockWrap:{start:"{",end:"}"},lookForIndentInHeader:!1}:{}}get _summaryPlaceHolder(){return this._inlineComment.start+this._elipsisPlaceholder+this._inlineComment.end}async parse(e,r,n){let o=await this.createChunkTree(e,r,n);return o?this.createSummaryFromSemanticChunkTree(o,!0):[]}async createChunkTree(e,r,n){let o=await this.provideQueryTree(e);if(!n.isCancellationRequested)return this.createChunkTreeFromQueryTree(o,r,n)}async createSummaryFromSemanticChunkTree(e,r=!1){let n=[];if(e.body.content.length!==0&&n.push(this._makeChunksFromStructure(e.bodyIndent,e.body.content,e.fullRange,!r,e.header?.original,e.suffix)),e.body.outline&&e.body.outline.text.length!==0){let o=e.header?.outline??e.header?.original;n.push(this._makeChunksFromStructure(e.bodyIndent,e.body.outline.text,e.fullRange,!0,o,e.suffix,e.body.outline.needsLeadingElipsis,e.body.outline.needsTrailingElipsis).then(s=>(r&&s.length===1&&(s[0]={...s[0],isFullFile:!0}),s)))}return(await Promise.all(n)).flat()}async createChunkTreeFromQueryTree(e,r,n){let o=bt.lift(r.limitToRange),s=this._parseBlocks(e.roots,"",r.maxTokenLength,r.maxHeaderLengthFactor,o??void 0),a=s.content.flat(),c=s.outline??[],u=this.createOutlineSummaryBody(r.maxTokenLength,aN(e.syntaxTreeRoot),c,"",o??void 0);return{bodyIndent:"",fullRange:fc(e.syntaxTreeRoot),body:{content:a,outline:u}}}provideQueryTree(e){let r=e.replace(/\r\n/g,`
`);return this._parserService.getSemanticChunkTree(this.lang,r)}chunkWholeText(e,r,n,o=0,s=r,a,c=""){if(e.trim().length===0)return{content:{text:[],isFull:!0}};let u;try{let l={range:r,text:e},d=s,p=l.text;if(a){let f=bt.lift(s),m=fw(a,e,f);l=m.newTextRange;let h=f.intersectRanges(a);if(!h)throw Error("Invalid Body Text Range");d=h,p=this._constructLimitedRange(m.trimmedRight,m.trimmedLeft,l.text,c)}u=this._naiveChunker.genericChunking({lineRangeText:[{range:l.range,text:p,sources:[{start:o,end:p.length,range:d}]}],maxTokenLength:n,numTokensInEllipsis:this._numTokensInEllipsis})}catch{return{content:{text:[],isFull:!1},outline:[]}}return{content:{text:u,isFull:!0}}}_parseBlocks(e,r,n,o,s){return this._parseSemanticStructure(e,r,n,o,(a,c,u,l)=>{let d=l+c.text;if(this._tokenizerProvider.acquireTokenizer("gpt4").tokenLength(d)<=u){let h=cd(/^\s*\n/g,d,c.range),g=cd(/(\n\s*$)/g,h.text,h.range);if(s){let v=fw(s,g.text,bt.lift(g.range)),y=this._constructLimitedRange(v.trimmedRight,v.trimmedLeft,v.newTextRange.text,l);return{content:{text:[{sources:[{start:0,end:y.length,range:v.newTextRange.range}],range:v.newTextRange.range,text:y}],isFull:!0}}}else return{content:{text:[{sources:[{start:l.length,end:g.text.length,range:g.range}],range:g.range,text:g.text}],isFull:!0}}}if(a.length===0)return this.chunkWholeText(d,c.range,u,s?0:l.length,void 0,s,l);let p=this._parseBlocks(a,l,u,o,s),f=p.content,m=p.outline;return{content:{text:f,isFull:!1},outline:m}},s)}_createOutlineBody(e,r){let n=e.text.split(`
`),o={lineNumber:e.range.startLineNumber,column:e.range.startColumn},s=[],a=o,c=p=>{let f=p.lineNumber-o.lineNumber,m=p.column;return o.lineNumber===p.lineNumber&&(m=p.column-o.column),{lineNumber:f,column:m}},u=p=>{let f=p.lineNumber-o.lineNumber,m=f>=n.length||p.column===n[f].length-1;return{newPosition:{lineNumber:p.lineNumber,column:p.column+1},isNewLine:m}},l=(p,f)=>{if(p.lineNumber>f.lineNumber||p.lineNumber===f.lineNumber&&p.column>f.column)return;let m=[],h=c(p),g=c(f),v=Xc(p,f),y=n[h.lineNumber].substring(h.column);if(h.lineNumber===g.lineNumber){let S=y.substring(0,g.column-h.column),I=u(f);a=I.newPosition,I.isNewLine&&(S+=`
`),m.push(S)}else{let S=n[g.lineNumber].substring(0,g.column),I=u(f);a=I.newPosition,I.isNewLine&&(S+=`
`),m.push(y+`
`);for(let T=h.lineNumber+1;T<g.lineNumber;T++)m.push(n[T]+`
`);m.push(S)}let b=m.join(""),_=cd(/^\s+\n/,b,v);_.text.length>0&&s.push({sources:[{start:0,end:_.text.length,range:_.range}],text:_.text,range:v})},d=p=>{s.push({sources:p.sources,text:p.summary+`

`,range:p.range})};return r.sort((p,f)=>p.range.startLineNumber-f.range.startLineNumber||p.range.endLineNumber-f.range.endLineNumber),r.forEach(p=>{l(a,{lineNumber:p.range.startLineNumber,column:p.range.startColumn}),d(p),a=u({lineNumber:p.range.endLineNumber,column:p.range.endColumn}).newPosition}),l(a,{lineNumber:e.range.endLineNumber,column:e.range.endColumn}),s}createOutlineSummaryBody(e,r,n,o,s){let a=r;if(a.range.startColumn>=o.length){let p={startLineNumber:a.range.startLineNumber,startColumn:a.range.startColumn-o.length,endLineNumber:a.range.endLineNumber,endColumn:a.range.endColumn},f=o+a.text;a={text:f,range:p,sources:[{start:0,end:f.length,range:p}]}}let c=!1,u=!1;if(s){if(n.length===1&&bt.lift(n[0].range).containsRange(s))return{text:[]};let p=fw(s,r.text,bt.lift(r.range));u=p.trimmedLeft,c=p.trimmedRight,a={text:p.newTextRange.text,range:p.newTextRange.range,sources:[{start:0,end:p.newTextRange.text.length,range:p.newTextRange.range}]}}let l=this._createOutlineBody(a,n.map(p=>({sources:p.sources,summary:eoe(p.summary),range:p.range,needsTrailingElipsis:c,needsLeadingElipsis:u}))),d;try{d=this._naiveChunker.genericChunking({lineRangeText:l,removeEmptyLines:!1,maxTokenLength:e,numTokensInEllipsis:this._numTokensInEllipsis})}catch{return console.error("caught error in naive chunker: {e}"),{text:[]}}return{text:d,needsLeadingElipsis:u,needsTrailingElipsis:c}}async _makeChunksFromStructure(e,r,n,o,s,a,c,u){return Xt(await Promise.all(r.map(async(l,d)=>{let p=E5e(l)?await this.createSummaryFromSemanticChunkTree(l):l,f=s&&s.length>0?s:"";(c||o&&d!==0)&&(f+=`${e}${this._elipsisPlaceholder}
`);let m="";if((u||o&&d!==r.length-1)&&(m+=`
${e}${this._elipsisPlaceholder}`),a&&a.length>0&&(m+=a),Array.isArray(p))return Xt(p.map(g=>{if(g.text.trim().length!==0)return{range:g.range,text:f+g.text+m,sources:g.sources.map(v=>({start:v.start+f.length,end:v.end+f.length,range:v.range}))}}));if(p.text.trim().length===0)return;let h={startColumn:(d===0?n:p.range).startColumn,startLineNumber:(d===0?n:p.range).startLineNumber,endColumn:n.endColumn,endLineNumber:n.endLineNumber};return{sources:p.sources.map(g=>({start:g.start+f.length,end:g.end+f.length,range:g.range})),range:h,text:f+p.text+m}}))).flat()}findNewIndent(e,r,n){let s=(this._lookForIndentInHeader?r.text.substring(0,n.startIndex-r.startIndex):n.text).match(new RegExp(`\\n+(\\s*)${e}${this._lookForIndentInHeader?"$":""}`));return s&&s.length>1?s[1]:""}_constructLimitedRange(e,r,n,o){return n.length===0?"":(r?`${o}${this._elipsisPlaceholder}
`:"")+n+(e?`
${o}${this._elipsisPlaceholder}`:"")}};var ru=class extends Ox{_parseSemanticStructure(e,r,n,o,s,a){let c=[],u=d=>{let p=d.info,f=p.mainBlock,m=p.detailBlocks.comments,h=p.detailBlocks.body,g=fc(h),v=this._getInnerLineRangeText(h),y=h.startIndex-f.startIndex+v.prefix.length,b=this.findNewIndent(r,f,h),_="";for(let Z of m)_+=r+Z.text+`
`;let S=r+f.text.substring(0,y),I=_+S,T=fc(f),A=Xc(dh((m.length>0?m[0]:f).range.startPosition,0,-r.length),{column:T.endColumn,lineNumber:T.endLineNumber});if(a&&!bt.lift(A).intersectRanges(a))return;let B=o*n,j=I.replace(/(\n*)(\n\s*)$/g,`
`),F=this._tokenizerProvider.acquireTokenizer("gpt4").tokenLength(j);if(F>B&&(j=S.replace(/(\n*)(\n\s*)$/g,`
`),F=this._tokenizerProvider.acquireTokenizer("gpt4").tokenLength(S),F>B)){j="",F=0;let Z=this.chunkWholeText(_+r+f.text,fc(f),n,_.length+r.length,void 0,a,r);return{bodyIndent:r,body:{content:Z.content.text},fullRange:A}}let ne=v.suffix+f.text.substring(h.endIndex-f.startIndex),Y=this._tokenizerProvider.acquireTokenizer("gpt4").tokenLength(j+`
`+ne),N=n-Y,w=s(d.children,v.body,N,r+b);A=Xc({column:A.startColumn,lineNumber:A.startLineNumber},dh(f.range.endPosition));let P=ud(H0,f.text.substring(0,h.startIndex-f.startIndex),{startColumn:T.startColumn,startLineNumber:T.startLineNumber,endLineNumber:g.startLineNumber,endColumn:g.startColumn}),q,U=_+r;return c.push({summary:U+P.text+" "+this._summaryPlaceHolder,range:A,sources:[{start:U.length,end:U.length+P.text.length,range:P.range}]}),w.outline!==void 0&&(q=this.createOutlineSummaryBody(N,v.body,w.outline,r+b,a)),{header:{original:j},bodyIndent:r+b,body:{content:w.content.text,outline:q},fullRange:A,suffix:ne}},l=Xt(e.map(d=>u(d)));return{outline:c,content:l}}_getInnerLineRangeText(e){let r=fc(e),n=e.text,o=cd(/^\s*\{\s*/,n,r),s=ud(/\s*\}\s*$/,o.text,o.range);return{prefix:n.slice(0,n.length-o.text.length),body:{sources:[{start:0,end:s.text.length,range:s.range}],text:s.text,range:s.range},suffix:o.text.slice(s.text.length)}}};var uL=class{constructor(e){this.accessor=e;this.naiveChunker=new ld(e.get(dr))}async parse(e,r,n){let o=this._getLineRangeText(e,r.limitToRange);return this.naiveChunker.genericChunking({lineRangeText:o,maxTokenLength:r.maxTokenLength,extraLineRangeSeparator:`

`})}_getLineRangeText(e,r){e=e.replace(/\r\n/g,`
`);let n=e.split(`
`),o=[],s={lineNumber:0,column:0},a=[],c=r?r.startLineNumber:0,u=r?r.startColumn:void 0,l=Math.min(r?r.endLineNumber+1:n.length,n.length),d=r?r.endColumn:void 0;for(let p=c;p<l;p++)if(p===0&&u?n[p]=n[p].substring(u):p===l-1&&d&&(n[p]=n[p].substring(0,d)),n[p].trim().length===0){if(o.length>0){let f=o.join(`
`),m=Xc(s,{lineNumber:p-1,column:n[p-1].length});a.push({sources:[{start:0,end:f.length,range:m}],text:f,range:m}),o.length=0}s={lineNumber:p+1,column:0};continue}else o.push(n[p]);if(o.length>0){let p=o.join(`
`),f=Xc(s,{lineNumber:n.length-1,column:n[n.length-1].length});a.push({sources:[{start:0,end:p.length,range:f}],text:p,range:f})}return a}};var lL=class extends Ox{_parseSemanticStructure(e,r,n,o,s,a){let c=[],u=d=>{let p=d.info,f=p.mainBlock,m=p.detailBlocks.decorator,h=p.detailBlocks.docstring,g=p.detailBlocks.body,v={start:0,end:0,range:null};if(h)v.end=h.endIndex-f.startIndex,v.range={startLineNumber:f.range.startPosition.row,startColumn:f.range.startPosition.column,endLineNumber:h.range.endPosition.row,endColumn:h.range.endPosition.column};else if(g)v.end=g.startIndex-f.startIndex,v.range={startLineNumber:f.range.startPosition.row,startColumn:f.range.startPosition.column,endLineNumber:g.range.startPosition.row,endColumn:g.range.startPosition.column};else{let w=ud(1,f.text,v.range);v.end=f.text.length,v.range=w.range}let y=this.findNewIndent(r,f,g),b=[],_="";m&&(_=r+m.text+`
`,b.push({start:r.length,end:m.text.length+r.length,range:fc(m)}));let S=ud(H0,f.text.substring(0,v.end),v.range);b.push({start:_.length+r.length,end:_.length+r.length+S.text.length,range:S.range});let I=_+r+S.text+`
`,T=Xc(dh(f.range.startPosition,0,-r.length),dh(f.range.endPosition));if(m&&(T=Xc(dh(m.range.startPosition,0,-r.length),{column:T.endColumn,lineNumber:T.endLineNumber})),a&&!bt.lift(T).intersectRanges(a))return;let A=o*n,B=I.replace(/\n+\s*$/g,`
`),j=this._tokenizerProvider.acquireTokenizer("gpt4").tokenLength(B);if(j>A&&(B=r+S.text.substring(0,g.startIndex-f.startIndex),j=this._tokenizerProvider.acquireTokenizer("gpt4").tokenLength(B),j>A)){B="",j=0;let w=cd(h?h.endIndex-g.startIndex:0,g.text,fc(g)),P=this.chunkWholeText(I+`
`+w.text,fc(f),n,I.length+1,w.range,a,r);return{fullRange:T,body:{content:P.content.text},bodyIndent:r}}T=Xc({column:T.startColumn,lineNumber:T.startLineNumber},dh(f.range.endPosition)),c.push({summary:(h?I+y:I.slice(0,-1)+" ")+this._summaryPlaceHolder,sources:b,range:T});let F=aN(g),ne=s(d.children,F,n-j,r+y),Y=r+f.text.substring(0,g.startIndex-f.startIndex).replace(/\n+\s*$/g,`
`);ne.content.isFull&&(B=Y);let N;return ne.outline!==void 0&&(N=this.createOutlineSummaryBody(n-j,F,ne.outline,r+y,a)),{header:{original:B,outline:Y},bodyIndent:r+y,body:{content:ne.content.text,outline:N},fullRange:T}},l=Xt(e.map(d=>u(d)));return{outline:c,content:l}}};var T5e=.6,Z0=ae("ChunkingService"),Vse=(t,e)=>({file:t,text:e.text,sources:e.sources.map(r=>({start:r.start,end:r.end,range:bt.lift(r.range)})),range:bt.lift(e.range),isFullFile:e.isFullFile}),Mx=class{constructor(e){this.accessor=e;this.semanticChunkers=new Map;this.tokenizerProvider=this.accessor.get(dr),this.naiveChunker=new ld(this.tokenizerProvider),this.logger=this.accessor.get(ue).getLogger("WorkspaceChunkSearch")}canSemanticallyChunk(e){return!!this.getSemanticChunker(e)}async chunkFileNaive(e,r,n,o){let s=o?.maxTokenLength??await Gse(this.accessor);if(n.isCancellationRequested)return[];let c=this.naiveChunker.genericWholeFileChunking(r,{maxTokenLength:s,rangeLimit:o?.limitToRange}).map(u=>Vse(e,u));return o?.validateChunkLengths&&this.validateChunkLengths(c,s),c.filter(u=>u.text)}async chunkFileSemantic(e,r,n,o){let s=o?.maxTokenLength??await Gse(this.accessor);if(n.isCancellationRequested)return[];let a=o?.maxHeaderLengthFactor??T5e,c=[];try{let u=await this.getSemanticChunker(e)?.parse(r,{maxTokenLength:s,maxHeaderLengthFactor:a,limitToRange:o?.limitToRange},n);if(n.isCancellationRequested)return[];c.push(...Array.from(u??[],l=>Vse(e,l)))}catch(u){this.logger.error("Error parsing semantic chunks for the following file: "+e.fsPath),this.logger.error(u),c=[]}return c.length?(o?.validateChunkLengths&&this.validateChunkLengths(c,s),c.filter(u=>u.text)):this.chunkFileNaive(e,r,n,{maxTokenLength:s,validateChunkLengths:o?.validateChunkLengths,limitToRange:o?.limitToRange})}validateChunkLengths(e,r){for(let n of e){let o=this.tokenizerProvider.acquireTokenizer("gpt4").tokenLength(n.text);o>r*1.2&&console.warn("Produced chunk that is over length limit",{file:n.file+"",range:n.range,chunkTokenLength:o,maxLength:r})}}getSemanticChunker(e){let r=hd(e),n=this.semanticChunkers.get(r.languageId);if(n)return n;let o;switch(r.languageId){case"typescript":o=new ru(this.accessor,"typescript");break;case"typescriptreact":o=new ru(this.accessor,"tsx");break;case"javascript":case"javascriptreact":o=new ru(this.accessor,"javascript");break;case"python":o=new lL(this.accessor,"python");break;case"java":o=new ru(this.accessor,"java");break;case"cpp":case"c":o=new ru(this.accessor,"cpp");break;case"csharp":o=new ru(this.accessor,"csharp");break;case"go":o=new ru(this.accessor,"go");break;case"markdown":o=new uL(this.accessor);break;case"ruby":o=new ru(this.accessor,"ruby");break;case"rust":o=new ru(this.accessor,"rust");break}return o&&this.semanticChunkers.set(r.languageId,o),o}};Mx=O([x(0,je)],Mx);async function Gse(t){return Fx(t,{valueFor4096:sN,maxMultiplier:4})}function Rh(t){return new Ge(t.startLineNumber,t.startColumn,t.endLineNumber,t.endColumn)}async function Fx(t,e){let n=(await t.get(Le).getChatEndpoint("gpt-3.5-turbo")).modelMaxPromptTokens/4096;return jse(Math.round(e.valueFor4096*n),e.valueFor4096,e.valueFor4096*e.maxMultiplier)}async function zse(t,e){let r=new Ws;try{let n=await t();return e(r.elapsed(),"success"),n}catch(n){throw e(r.elapsed(),zp(n)?"cancelled":"failed"),n}}async function xd(t,e,r,n){return zse(()=>(t.debug(`${e} started`),r()),(o,s)=>{t.debug(`${e} ${s}. Elapsed ${o}`),n?.(o,s)})}function Li(t,e){return function(r,n,o){let s=o.value,a=0;return o.value=async function(...c){let u=a++,l=t(this);return xd(l,`${n}#${u}`,()=>s.apply(this,c),e?.bind(this))},o}}function Dw(t){return function(e,r,n){let o=n.value;return n.value=function(...s){return zse(()=>o.apply(this,s),t.bind(this))},n}}var TH=z(Qt());var Ux=class extends Error{constructor(r,n){super(n);this.repo=r}},Nw=class extends Ux{constructor(){super(...arguments);this.name="ERROR_TYPE_MISSING_INACCESSIBLE_REPO_ORG"}},nH=class extends Ux{constructor(){super(...arguments);this.name="ERROR_TYPE_DOCS_EMBEDDINGS_UNAVAILABLE"}},iH=class extends Ux{constructor(){super(...arguments);this.name="ERROR_TYPE_NOT_INDEXED"}},oH=class extends Error{constructor(){super(...arguments);this.name="ERROR_TYPE_MAX_RETRIES_EXCEEDED"}},sH=class extends Error{constructor(){super(...arguments);this.name="ERROR_TYPE_NO_ACCESS_TO_ENDPOINT"}};function $se({error:t,message:e,repo:r}){switch(t){case"ERROR_TYPE_MISSING_INACCESSIBLE_REPO_ORG":return new Nw(r,e);case"ERROR_TYPE_DOCS_EMBEDDINGS_UNAVAILABLE":return new nH(r,e);case"ERROR_TYPE_NOT_INDEXED":return new iH(r,e);default:return new Ux(r,e)}}function aH({error:t,message:e}){switch(t){case"ERROR_TYPE_MAX_RETRIES_EXCEEDED":return new oH(e);case"ERROR_TYPE_NO_ACCESS_TO_ENDPOINT":return new sH(e);default:return new Error(e)}}var df=ae("ISimulationTestContext"),dL=class{constructor(){this.isInSimulationTests=!1}writeFile(e,r,n){throw new Error("Method not implemented.")}};var vH=z(pae());function gL(t,e){return typeof e=="string"?vH.default.isMatch(t.fsPath,e,{dot:!0,windows:process.platform==="win32"}):vH.default.isMatch(t.fsPath,e.pattern,{dot:!0,windows:process.platform==="win32"})}function fae(t,e){return e.exclude?.some(r=>gL(t,r))?!1:e.include?e.include.some(r=>gL(t,r)):!0}function mae(t,e){let r=typeof t=="string"?t:t.baseUri.toString()+t.pattern,n=typeof e=="string"?e:e.baseUri.toString()+e.pattern;return r=r.replace(/\{.*\}/g,""),n=n.replace(/\{.*\}/g,""),`{${r},${n}}`}var vL=ae("codeSearchClient"),yL=ae("docsSearchClient");var bae=z(vae()),_ae=require("util");var m6e=1e5,h6e=1*1024*1024,g6e=new Set(["jpg","jpeg","jpe","png","gif","bmp","tif","tiff","tga","ico","webp","svg","eps","heif","heic","pdf","raw","mp4","m4v","mkv","webm","mov","avi","wmv","flv","mp3","wav","m4a","flac","ogg","wma","weba","aac","7z","bz2","gz","gz","rar","tar","xz","zip","vsix","db","bin","dat","hex","map","wasm","pyc","pdb","sym","git"]),v6e=["node_modules","out","dist",".git",".yarn",".npm",".venv","foo.asar",".vscode-test"],y6e=[".DS_Store","Thumbs.db","package-lock.json","yarn.lock"],b6e=[cn.vscode,cn.vscodeUserData,"output",cn.inMemory,cn.internal,"git"];function _6e(t,e){if(b6e.includes(e.scheme))return!1;let r=t.get(Je);if(![cn.file,cn.untitled].includes(e.scheme)&&!r.getWorkspaceFolders().some(s=>e.scheme===s.scheme))return!1;let n=uc(e).replace(/\./,"").toLowerCase();return!(g6e.has(n)||y6e.includes(zc(e).toLowerCase())||e.fsPath.toLowerCase().split(/[/\\]/g).some(s=>v6e.includes(s)))}async function ey(t,e){let r=t.get(De);return _6e(t,e)&&!await r.isCopilotIgnored(e)}async function yae(t,e,r){let n=t.get(Je),o=t.get(Kc);if(await t.get(De).init(),r?.isCancellationRequested)return[];let a=new Nn;for(let c of n.getWorkspaceFolders()??[]){if(a.size>=e)break;let u=await o.findFilesWithDefaultExcludes(new nx(c,"**/*"),e-a.size,r);if(r.isCancellationRequested)return[];for(let l of u){if(a.size>=e||r.isCancellationRequested)break;await ey(t,l)&&a.set(l)}}return a.keys()}var _L=class{constructor(e,r){this._uri=e;this._chunkingService=r;this._isDisposed=!1;this._disposedCts=new ac}dispose(){this._isDisposed=!0,this._disposedCts.cancel(),this._disposedCts.dispose()}get uri(){return this._uri}async getBasicChunks(e){return this._basicChunks??=this.getText(this._disposedCts.token).then(r=>this._isDisposed?[]:this._chunkingService.chunkFileNaive(this._uri,r,this._disposedCts.token)),await Qp(this._basicChunks,e)??[]}async getSemanticChunks(e){return this._chunkingService.canSemanticallyChunk(this.uri)?(this._semanticChunks??=this.getText(this._disposedCts.token).then(r=>this._isDisposed?[]:this._chunkingService.chunkFileSemantic(this._uri,r,this._disposedCts.token)),await Qp(this._semanticChunks,e)??[]):this.getBasicChunks(e)}},xH=class extends _L{constructor(r,n,o){super(r,n);this._fs=o}async getText(r){return this._text??=this._fs.readFile(this.uri).then(async n=>this._isDisposed||n.byteLength>=h6e||await(0,bae.isBinaryFile)(Buffer.from(n))||this._isDisposed?"":new _ae.TextDecoder().decode(n),n=>""),await Qp(this._text,r)??""}},xL=class extends _L{constructor(r,n){super(r.uri,n);this._textDocument=r}async getText(r){return this._textDocument.getText()}},vl=ae("workspaceChunkIndex"),qx=class extends Ct{constructor(r,n,o,s,a){super();this._accessor=r;this._chunkingService=n;this._fileSystem=o;this._telemetryService=s;this._workspaceService=a;this._textDocumentFiles=new Nn;this._fsFiles=new Nn;this._onDidCreateFile=this._register(new Gt);this.onDidCreateFile=this._onDidCreateFile.event;this._onDidChangeFile=this._register(new Gt);this.onDidChangeFile=this._onDidChangeFile.event;this._onDidDeleteFile=this._register(new Gt);this.onDidDeleteFile=this._onDidDeleteFile.event;this._commonInit=new Wi(async()=>{this.registerListeners(),await this._workspaceService.ensureWorkspaceIsFullyLoaded();for(let r of this._workspaceService.textDocuments)await ey(this._accessor,r.uri)&&this._textDocumentFiles.set(r.uri,new xL(r,this._chunkingService))})}get fileSystemFileCount(){return this._fsFiles.size}dispose(){super.dispose(),Km(this._fsFiles.values()),this._fsFiles.clear(),Km(this._textDocumentFiles.values()),this._textDocumentFiles.clear()}get(r){return this._textDocumentFiles.get(r)||this._fsFiles.get(r)}*values(){let r=new Nn;for(let[n,o]of this._textDocumentFiles.entries())yield o,r.set(n);for(let[n,o]of this._fsFiles.entries())r.has(n)||(r.set(n),yield o)}registerListeners(){let r=async o=>{if(!await ey(this._accessor,o.uri))return;let s=this._textDocumentFiles.get(o.uri),a=this._fsFiles.get(o.uri);s?.dispose(),this._textDocumentFiles.set(o.uri,new xL(o,this._chunkingService)),!s&&!a?this._onDidCreateFile.fire(o.uri):this._onDidChangeFile.fire(o.uri)};this._register(this._workspaceService.onDidOpenTextDocument(r)),this._register(this._workspaceService.onDidChangeTextDocument(o=>r(o.document))),this._register(this._workspaceService.onDidCloseTextDocument(o=>{let s=this._textDocumentFiles.get(o.uri);if(!s)return;this._textDocumentFiles.delete(o.uri),s.dispose(),this._fsFiles.get(o.uri)?this._onDidChangeFile.fire(o.uri):this._onDidDeleteFile.fire(o.uri)}));let n=this._register(this._fileSystem.createFileSystemWatcher("**/*"));this._register(n.onDidChange(async o=>{if(!await ey(this._accessor,o))return;let s=this._fsFiles.has(o);this.createOrUpdateFsEntry(o),s?this._onDidChangeFile.fire(o):this._onDidCreateFile.fire(o)})),this._register(n.onDidCreate(async o=>{await ey(this._accessor,o)&&(this._fsFiles.has(o)||(this.createOrUpdateFsEntry(o),this._onDidCreateFile.fire(o)))})),this._register(n.onDidDelete(o=>{let s=this._fsFiles.get(o);s&&(s.dispose(),this._fsFiles.delete(o),this._onDidDeleteFile.fire(o))}))}async preLoadWorkspaceFiles(r,n){switch(this._preloadWorkspaceFilesState?.type){case"full":return;case"partial":case"pending":if(this._preloadWorkspaceFilesState.count>=r)return;break}let o=(async()=>{await this._commonInit.value;let s=Array.from(await yae(this._accessor,r,n));for(let a of s)this.createOrUpdateFsEntry(a);this._preloadWorkspaceFilesState?.type==="pending"&&this._preloadWorkspaceFilesState.p===o&&(n.isCancellationRequested?this._preloadWorkspaceFilesState=void 0:this._preloadWorkspaceFilesState=s.length<r?{type:"full"}:{type:"partial",count:r})})();return this._preloadWorkspaceFilesState={type:"pending",count:r,p:o},o}initialize(){return this._initialized??=(async()=>{switch(await this._commonInit.value,this._preloadWorkspaceFilesState?.type){case"full":break;case"partial":case"pending":default:{let r=Array.from(await yae(this._accessor,m6e,an.None));for(let n of r)this.createOrUpdateFsEntry(n)}}this._telemetryService.sendMSFTTelemetryEvent("workspaceChunkIndex.initialize",{},{totalFileCount:xs.reduce(this.values(),r=>r+1,0)})})(),this._initialized}createOrUpdateFsEntry(r){let n=this._fsFiles.get(r);n&&n.dispose();let o=new xH(r,this._chunkingService,this._fileSystem);this._fsFiles.set(r,o)}};qx=O([x(0,je),x(1,Z0),x(2,zr),x(3,me),x(4,Je)],qx);async function SL(t,e,r){let n=t.get(vl),o=t.get(Z0),s=new Nn;for(let c of e){let u=s.get(c.file);u?u.push(c):s.set(c.file,[c])}let a=await Promise.all(Array.from(s,async([c,u])=>{let l=n.get(c);if(l&&o.canSemanticallyChunk(c)){let d=await l.getSemanticChunks(r);if(r.isCancellationRequested)return[];let p=new Set;for(let f of u){let m=!1;for(let h of d)h.range.intersectRanges(f.range)&&(p.add(h),m=!0);m||p.add(f)}return Array.from(p)}else return u}));return Array.from(new Set(a.flat()))}var Hx=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Sae=new Set,SH=typeof process=="object"&&process?process:{},Iae=(t,e,r,n)=>{typeof SH.emitWarning=="function"?SH.emitWarning(t,e,r,n):console.error(`[${r}] ${e}: ${t}`)},IL=globalThis.AbortController,xae=globalThis.AbortSignal;if(typeof IL>"u"){xae=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(n,o){this._onabort.push(o)}},IL=class{constructor(){e()}signal=new xae;abort(n){if(!this.signal.aborted){this.signal.reason=n,this.signal.aborted=!0;for(let o of this.signal._onabort)o(n);this.signal.onabort?.(n)}}};let t=SH.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1",e=()=>{t&&(t=!1,Iae("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}var x6e=t=>!Sae.has(t),iTt=Symbol("type"),Ah=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),Cae=t=>Ah(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?jx:null:null,jx=class extends Array{constructor(e){super(e),this.fill(0)}},IH=class t{heap;length;static#t=!1;static create(e){let r=Cae(e);if(!r)return[];t.#t=!0;let n=new t(e,r);return t.#t=!1,n}constructor(e,r){if(!t.#t)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new r(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},CL=class t{#t;#i;#d;#r;#c;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#a;#m;#s;#n;#e;#p;#h;#l;#u;#v;#f;#_;#x;#y;#S;#T;#g;static unsafeExposeInternals(e){return{starts:e.#x,ttls:e.#y,sizes:e.#_,keyMap:e.#s,keyList:e.#n,valList:e.#e,next:e.#p,prev:e.#h,get head(){return e.#l},get tail(){return e.#u},free:e.#v,isBackgroundFetch:r=>e.#o(r),backgroundFetch:(r,n,o,s)=>e.#D(r,n,o,s),moveToTail:r=>e.#k(r),indexes:r=>e.#I(r),rindexes:r=>e.#C(r),isStale:r=>e.#b(r)}}get max(){return this.#t}get maxSize(){return this.#i}get calculatedSize(){return this.#m}get size(){return this.#a}get fetchMethod(){return this.#c}get dispose(){return this.#d}get disposeAfter(){return this.#r}constructor(e){let{max:r=0,ttl:n,ttlResolution:o=1,ttlAutopurge:s,updateAgeOnGet:a,updateAgeOnHas:c,allowStale:u,dispose:l,disposeAfter:d,noDisposeOnSet:p,noUpdateTTL:f,maxSize:m=0,maxEntrySize:h=0,sizeCalculation:g,fetchMethod:v,noDeleteOnFetchRejection:y,noDeleteOnStaleGet:b,allowStaleOnFetchRejection:_,allowStaleOnFetchAbort:S,ignoreFetchAbort:I}=e;if(r!==0&&!Ah(r))throw new TypeError("max option must be a nonnegative integer");let T=r?Cae(r):Array;if(!T)throw new Error("invalid max value: "+r);if(this.#t=r,this.#i=m,this.maxEntrySize=h||this.#i,this.sizeCalculation=g,this.sizeCalculation){if(!this.#i&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(v!==void 0&&typeof v!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.#c=v,this.#T=!!v,this.#s=new Map,this.#n=new Array(r).fill(void 0),this.#e=new Array(r).fill(void 0),this.#p=new T(r),this.#h=new T(r),this.#l=0,this.#u=0,this.#v=IH.create(r),this.#a=0,this.#m=0,typeof l=="function"&&(this.#d=l),typeof d=="function"?(this.#r=d,this.#f=[]):(this.#r=void 0,this.#f=void 0),this.#S=!!this.#d,this.#g=!!this.#r,this.noDisposeOnSet=!!p,this.noUpdateTTL=!!f,this.noDeleteOnFetchRejection=!!y,this.allowStaleOnFetchRejection=!!_,this.allowStaleOnFetchAbort=!!S,this.ignoreFetchAbort=!!I,this.maxEntrySize!==0){if(this.#i!==0&&!Ah(this.#i))throw new TypeError("maxSize must be a positive integer if specified");if(!Ah(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#U()}if(this.allowStale=!!u,this.noDeleteOnStaleGet=!!b,this.updateAgeOnGet=!!a,this.updateAgeOnHas=!!c,this.ttlResolution=Ah(o)||o===0?o:1,this.ttlAutopurge=!!s,this.ttl=n||0,this.ttl){if(!Ah(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#N()}if(this.#t===0&&this.ttl===0&&this.#i===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#t&&!this.#i){let A="LRU_CACHE_UNBOUNDED";x6e(A)&&(Sae.add(A),Iae("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",A,t))}}getRemainingTTL(e){return this.#s.has(e)?1/0:0}#N(){let e=new jx(this.#t),r=new jx(this.#t);this.#y=e,this.#x=r,this.#L=(s,a,c=Hx.now())=>{if(r[s]=a!==0?c:0,e[s]=a,a!==0&&this.ttlAutopurge){let u=setTimeout(()=>{this.#b(s)&&this.delete(this.#n[s])},a+1);u.unref&&u.unref()}},this.#w=s=>{r[s]=e[s]!==0?Hx.now():0},this.#E=(s,a)=>{if(e[a]){let c=e[a],u=r[a];if(!c||!u)return;s.ttl=c,s.start=u,s.now=n||o();let l=s.now-u;s.remainingTTL=c-l}};let n=0,o=()=>{let s=Hx.now();if(this.ttlResolution>0){n=s;let a=setTimeout(()=>n=0,this.ttlResolution);a.unref&&a.unref()}return s};this.getRemainingTTL=s=>{let a=this.#s.get(s);if(a===void 0)return 0;let c=e[a],u=r[a];if(!c||!u)return 1/0;let l=(n||o())-u;return c-l},this.#b=s=>{let a=r[s],c=e[s];return!!c&&!!a&&(n||o())-a>c}}#w=()=>{};#E=()=>{};#L=()=>{};#b=()=>!1;#U(){let e=new jx(this.#t);this.#m=0,this.#_=e,this.#R=r=>{this.#m-=e[r],e[r]=0},this.#O=(r,n,o,s)=>{if(this.#o(n))return 0;if(!Ah(o))if(s){if(typeof s!="function")throw new TypeError("sizeCalculation must be a function");if(o=s(n,r),!Ah(o))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return o},this.#P=(r,n,o)=>{if(e[r]=n,this.#i){let s=this.#i-e[r];for(;this.#m>s;)this.#A(!0)}this.#m+=e[r],o&&(o.entrySize=n,o.totalCalculatedSize=this.#m)}}#R=e=>{};#P=(e,r,n)=>{};#O=(e,r,n,o)=>{if(n||o)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#I({allowStale:e=this.allowStale}={}){if(this.#a)for(let r=this.#u;!(!this.#M(r)||((e||!this.#b(r))&&(yield r),r===this.#l));)r=this.#h[r]}*#C({allowStale:e=this.allowStale}={}){if(this.#a)for(let r=this.#l;!(!this.#M(r)||((e||!this.#b(r))&&(yield r),r===this.#u));)r=this.#p[r]}#M(e){return e!==void 0&&this.#s.get(this.#n[e])===e}*entries(){for(let e of this.#I())this.#e[e]!==void 0&&this.#n[e]!==void 0&&!this.#o(this.#e[e])&&(yield[this.#n[e],this.#e[e]])}*rentries(){for(let e of this.#C())this.#e[e]!==void 0&&this.#n[e]!==void 0&&!this.#o(this.#e[e])&&(yield[this.#n[e],this.#e[e]])}*keys(){for(let e of this.#I()){let r=this.#n[e];r!==void 0&&!this.#o(this.#e[e])&&(yield r)}}*rkeys(){for(let e of this.#C()){let r=this.#n[e];r!==void 0&&!this.#o(this.#e[e])&&(yield r)}}*values(){for(let e of this.#I())this.#e[e]!==void 0&&!this.#o(this.#e[e])&&(yield this.#e[e])}*rvalues(){for(let e of this.#C())this.#e[e]!==void 0&&!this.#o(this.#e[e])&&(yield this.#e[e])}[Symbol.iterator](){return this.entries()}[Symbol.toStringTag]="LRUCache";find(e,r={}){for(let n of this.#I()){let o=this.#e[n],s=this.#o(o)?o.__staleWhileFetching:o;if(s!==void 0&&e(s,this.#n[n],this))return this.get(this.#n[n],r)}}forEach(e,r=this){for(let n of this.#I()){let o=this.#e[n],s=this.#o(o)?o.__staleWhileFetching:o;s!==void 0&&e.call(r,s,this.#n[n],this)}}rforEach(e,r=this){for(let n of this.#C()){let o=this.#e[n],s=this.#o(o)?o.__staleWhileFetching:o;s!==void 0&&e.call(r,s,this.#n[n],this)}}purgeStale(){let e=!1;for(let r of this.#C({allowStale:!0}))this.#b(r)&&(this.delete(this.#n[r]),e=!0);return e}info(e){let r=this.#s.get(e);if(r===void 0)return;let n=this.#e[r],o=this.#o(n)?n.__staleWhileFetching:n;if(o===void 0)return;let s={value:o};if(this.#y&&this.#x){let a=this.#y[r],c=this.#x[r];if(a&&c){let u=a-(Hx.now()-c);s.ttl=u,s.start=Date.now()}}return this.#_&&(s.size=this.#_[r]),s}dump(){let e=[];for(let r of this.#I({allowStale:!0})){let n=this.#n[r],o=this.#e[r],s=this.#o(o)?o.__staleWhileFetching:o;if(s===void 0||n===void 0)continue;let a={value:s};if(this.#y&&this.#x){a.ttl=this.#y[r];let c=Hx.now()-this.#x[r];a.start=Math.floor(Date.now()-c)}this.#_&&(a.size=this.#_[r]),e.unshift([n,a])}return e}load(e){this.clear();for(let[r,n]of e){if(n.start){let o=Date.now()-n.start;n.start=Hx.now()-o}this.set(r,n.value,n)}}set(e,r,n={}){if(r===void 0)return this.delete(e),this;let{ttl:o=this.ttl,start:s,noDisposeOnSet:a=this.noDisposeOnSet,sizeCalculation:c=this.sizeCalculation,status:u}=n,{noUpdateTTL:l=this.noUpdateTTL}=n,d=this.#O(e,r,n.size||0,c);if(this.maxEntrySize&&d>this.maxEntrySize)return u&&(u.set="miss",u.maxEntrySizeExceeded=!0),this.delete(e),this;let p=this.#a===0?void 0:this.#s.get(e);if(p===void 0)p=this.#a===0?this.#u:this.#v.length!==0?this.#v.pop():this.#a===this.#t?this.#A(!1):this.#a,this.#n[p]=e,this.#e[p]=r,this.#s.set(e,p),this.#p[this.#u]=p,this.#h[p]=this.#u,this.#u=p,this.#a++,this.#P(p,d,u),u&&(u.set="add"),l=!1;else{this.#k(p);let f=this.#e[p];if(r!==f){if(this.#T&&this.#o(f)){f.__abortController.abort(new Error("replaced"));let{__staleWhileFetching:m}=f;m!==void 0&&!a&&(this.#S&&this.#d?.(m,e,"set"),this.#g&&this.#f?.push([m,e,"set"]))}else a||(this.#S&&this.#d?.(f,e,"set"),this.#g&&this.#f?.push([f,e,"set"]));if(this.#R(p),this.#P(p,d,u),this.#e[p]=r,u){u.set="replace";let m=f&&this.#o(f)?f.__staleWhileFetching:f;m!==void 0&&(u.oldValue=m)}}else u&&(u.set="update")}if(o!==0&&!this.#y&&this.#N(),this.#y&&(l||this.#L(p,o,s),u&&this.#E(u,p)),!a&&this.#g&&this.#f){let f=this.#f,m;for(;m=f?.shift();)this.#r?.(...m)}return this}pop(){try{for(;this.#a;){let e=this.#e[this.#l];if(this.#A(!0),this.#o(e)){if(e.__staleWhileFetching)return e.__staleWhileFetching}else if(e!==void 0)return e}}finally{if(this.#g&&this.#f){let e=this.#f,r;for(;r=e?.shift();)this.#r?.(...r)}}}#A(e){let r=this.#l,n=this.#n[r],o=this.#e[r];return this.#T&&this.#o(o)?o.__abortController.abort(new Error("evicted")):(this.#S||this.#g)&&(this.#S&&this.#d?.(o,n,"evict"),this.#g&&this.#f?.push([o,n,"evict"])),this.#R(r),e&&(this.#n[r]=void 0,this.#e[r]=void 0,this.#v.push(r)),this.#a===1?(this.#l=this.#u=0,this.#v.length=0):this.#l=this.#p[r],this.#s.delete(n),this.#a--,r}has(e,r={}){let{updateAgeOnHas:n=this.updateAgeOnHas,status:o}=r,s=this.#s.get(e);if(s!==void 0){let a=this.#e[s];if(this.#o(a)&&a.__staleWhileFetching===void 0)return!1;if(this.#b(s))o&&(o.has="stale",this.#E(o,s));else return n&&this.#w(s),o&&(o.has="hit",this.#E(o,s)),!0}else o&&(o.has="miss");return!1}peek(e,r={}){let{allowStale:n=this.allowStale}=r,o=this.#s.get(e);if(o===void 0||!n&&this.#b(o))return;let s=this.#e[o];return this.#o(s)?s.__staleWhileFetching:s}#D(e,r,n,o){let s=r===void 0?void 0:this.#e[r];if(this.#o(s))return s;let a=new IL,{signal:c}=n;c?.addEventListener("abort",()=>a.abort(c.reason),{signal:a.signal});let u={signal:a.signal,options:n,context:o},l=(g,v=!1)=>{let{aborted:y}=a.signal,b=n.ignoreFetchAbort&&g!==void 0;if(n.status&&(y&&!v?(n.status.fetchAborted=!0,n.status.fetchError=a.signal.reason,b&&(n.status.fetchAbortIgnored=!0)):n.status.fetchResolved=!0),y&&!b&&!v)return p(a.signal.reason);let _=m;return this.#e[r]===m&&(g===void 0?_.__staleWhileFetching?this.#e[r]=_.__staleWhileFetching:this.delete(e):(n.status&&(n.status.fetchUpdated=!0),this.set(e,g,u.options))),g},d=g=>(n.status&&(n.status.fetchRejected=!0,n.status.fetchError=g),p(g)),p=g=>{let{aborted:v}=a.signal,y=v&&n.allowStaleOnFetchAbort,b=y||n.allowStaleOnFetchRejection,_=b||n.noDeleteOnFetchRejection,S=m;if(this.#e[r]===m&&(!_||S.__staleWhileFetching===void 0?this.delete(e):y||(this.#e[r]=S.__staleWhileFetching)),b)return n.status&&S.__staleWhileFetching!==void 0&&(n.status.returnedStale=!0),S.__staleWhileFetching;if(S.__returned===S)throw g},f=(g,v)=>{let y=this.#c?.(e,s,u);y&&y instanceof Promise&&y.then(b=>g(b===void 0?void 0:b),v),a.signal.addEventListener("abort",()=>{(!n.ignoreFetchAbort||n.allowStaleOnFetchAbort)&&(g(void 0),n.allowStaleOnFetchAbort&&(g=b=>l(b,!0)))})};n.status&&(n.status.fetchDispatched=!0);let m=new Promise(f).then(l,d),h=Object.assign(m,{__abortController:a,__staleWhileFetching:s,__returned:void 0});return r===void 0?(this.set(e,h,{...u.options,status:void 0}),r=this.#s.get(e)):this.#e[r]=h,h}#o(e){if(!this.#T)return!1;let r=e;return!!r&&r instanceof Promise&&r.hasOwnProperty("__staleWhileFetching")&&r.__abortController instanceof IL}async fetch(e,r={}){let{allowStale:n=this.allowStale,updateAgeOnGet:o=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,ttl:a=this.ttl,noDisposeOnSet:c=this.noDisposeOnSet,size:u=0,sizeCalculation:l=this.sizeCalculation,noUpdateTTL:d=this.noUpdateTTL,noDeleteOnFetchRejection:p=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:f=this.allowStaleOnFetchRejection,ignoreFetchAbort:m=this.ignoreFetchAbort,allowStaleOnFetchAbort:h=this.allowStaleOnFetchAbort,context:g,forceRefresh:v=!1,status:y,signal:b}=r;if(!this.#T)return y&&(y.fetch="get"),this.get(e,{allowStale:n,updateAgeOnGet:o,noDeleteOnStaleGet:s,status:y});let _={allowStale:n,updateAgeOnGet:o,noDeleteOnStaleGet:s,ttl:a,noDisposeOnSet:c,size:u,sizeCalculation:l,noUpdateTTL:d,noDeleteOnFetchRejection:p,allowStaleOnFetchRejection:f,allowStaleOnFetchAbort:h,ignoreFetchAbort:m,status:y,signal:b},S=this.#s.get(e);if(S===void 0){y&&(y.fetch="miss");let I=this.#D(e,S,_,g);return I.__returned=I}else{let I=this.#e[S];if(this.#o(I)){let F=n&&I.__staleWhileFetching!==void 0;return y&&(y.fetch="inflight",F&&(y.returnedStale=!0)),F?I.__staleWhileFetching:I.__returned=I}let T=this.#b(S);if(!v&&!T)return y&&(y.fetch="hit"),this.#k(S),o&&this.#w(S),y&&this.#E(y,S),I;let A=this.#D(e,S,_,g),j=A.__staleWhileFetching!==void 0&&n;return y&&(y.fetch=T?"stale":"refresh",j&&T&&(y.returnedStale=!0)),j?A.__staleWhileFetching:A.__returned=A}}get(e,r={}){let{allowStale:n=this.allowStale,updateAgeOnGet:o=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,status:a}=r,c=this.#s.get(e);if(c!==void 0){let u=this.#e[c],l=this.#o(u);return a&&this.#E(a,c),this.#b(c)?(a&&(a.get="stale"),l?(a&&n&&u.__staleWhileFetching!==void 0&&(a.returnedStale=!0),n?u.__staleWhileFetching:void 0):(s||this.delete(e),a&&n&&(a.returnedStale=!0),n?u:void 0)):(a&&(a.get="hit"),l?u.__staleWhileFetching:(this.#k(c),o&&this.#w(c),u))}else a&&(a.get="miss")}#F(e,r){this.#h[r]=e,this.#p[e]=r}#k(e){e!==this.#u&&(e===this.#l?this.#l=this.#p[e]:this.#F(this.#h[e],this.#p[e]),this.#F(this.#u,e),this.#u=e)}delete(e){let r=!1;if(this.#a!==0){let n=this.#s.get(e);if(n!==void 0)if(r=!0,this.#a===1)this.clear();else{this.#R(n);let o=this.#e[n];if(this.#o(o)?o.__abortController.abort(new Error("deleted")):(this.#S||this.#g)&&(this.#S&&this.#d?.(o,e,"delete"),this.#g&&this.#f?.push([o,e,"delete"])),this.#s.delete(e),this.#n[n]=void 0,this.#e[n]=void 0,n===this.#u)this.#u=this.#h[n];else if(n===this.#l)this.#l=this.#p[n];else{let s=this.#h[n];this.#p[s]=this.#p[n];let a=this.#p[n];this.#h[a]=this.#h[n]}this.#a--,this.#v.push(n)}}if(this.#g&&this.#f?.length){let n=this.#f,o;for(;o=n?.shift();)this.#r?.(...o)}return r}clear(){for(let e of this.#C({allowStale:!0})){let r=this.#e[e];if(this.#o(r))r.__abortController.abort(new Error("deleted"));else{let n=this.#n[e];this.#S&&this.#d?.(r,n,"delete"),this.#g&&this.#f?.push([r,n,"delete"])}}if(this.#s.clear(),this.#e.fill(void 0),this.#n.fill(void 0),this.#y&&this.#x&&(this.#y.fill(0),this.#x.fill(0)),this.#_&&this.#_.fill(0),this.#l=0,this.#u=0,this.#v.length=0,this.#m=0,this.#a=0,this.#g&&this.#f){let e=this.#f,r;for(;r=e?.shift();)this.#r?.(...r)}}};var S6e="1.0.9",I6e=500,Fw=class extends Ct{constructor(r,n,o,s){super();this.path=r;this.version=n;this.options=o;this.fileSystem=s;this._cache=new CL(this.options),this._delayer=typeof o.autoWriteDelay=="number"?this._register(new iD(o.autoWriteDelay)):void 0}dispose(){super.dispose(),this._delayer=void 0}async initialize(){if(!this.path)return;let r;try{r=await this.fileSystem.readFile(this.path)}catch{return}try{let n=new TextDecoder().decode(r),o=JSON.parse(n);o.version===this.version&&this._cache.load(o.data)}catch(n){console.error(`Failed to load LRU cache at ${this.path}`,n)}}async get(r){return this._cache.get(await this.toKey(r))}async set(r,n){this._cache.set(await this.toKey(r),n),this._delayer?.trigger(()=>this.save()).catch(o=>{if(!(o instanceof fo))throw o})}async save(){if(!this.path)return;let r=JSON.stringify({version:this.version,data:this._cache.dump()});await this.fileSystem.writeFile(this.path,new TextEncoder().encode(r))}async toKey(r){let o=new TextEncoder().encode(r),s=await crypto.subtle.digest("SHA-256",o);return Array.from(new Uint8Array(s)).map(u=>u.toString(16).padStart(2,"0")).join("")}};Fw=O([x(3,zr)],Fw);var Dh=ae("IWorkspaceChunkEmbeddingsIndex"),mf=class extends Ct{constructor(r,n,o){super();this._accessor=r;this._configurationService=n;this._experimentationService=o;this.shouldSearchTimeout=!0;this._isDisposed=!1;this._workspaceIndex=r.get(vl),this._embeddingsComputer=r.get(Fo),this._embeddingsCache=new Wi(async()=>{let s=this._accessor.get(ar).storageUri,a=s?dt.joinPath(s,"workspaceEmbeddingsCache.json"):void 0,c=this._register(r.get(te).createInstance(Fw,a,S6e,{max:5e3,autoWriteDelay:5e3}));return await c.initialize(),c}),this._logger=r.get(ue).getLogger("WorkspaceChunkEmbeddingsIndex"),this.tryPreInit()}static{this._MAX_EMBEDDINGS_COMPUTATION_TIME=1e4}static{this._MAX_CHUNK_LENGTH=2e3}dispose(){this._isDisposed=!0,super.dispose()}get fileSystemFileCount(){return this._workspaceIndex.fileSystemFileCount}initialize(){return this._initializePromise??=this._workspaceIndex.initialize(),this._initializePromise}async triggerIndexing(r){let n=await this.getChunksToSearch(r);if(r.isCancellationRequested)return;let o=await this.getEmbeddings(n.map(s=>this.chunkToIndexString(s)),r);this._logger.debug(`Indexed ${o.length} chunks`)}async searchAllChunks(r,n,o){let s=await this.getChunksToSearch(o);return o.isCancellationRequested?[]:this.searchChunks(s,r,n,o)}async searchChunks(r,n,o,s){if(!r.length)return[];let a=[n,...r.map(p=>this.chunkToIndexString(p))],c=this.shouldSearchTimeout?await P0(this.getEmbeddings(a,s),mf._MAX_EMBEDDINGS_COMPUTATION_TIME):await this.getEmbeddings(a,s);if(s.isCancellationRequested)return[];if(!c)throw new Error("Timeout computing embeddings");if(c.length<1)throw new Error("Invalid response");let[u,...l]=c,d=l.map((p,f)=>[r[f],p]);return sie(u,d,o)}async getChunksToSearch(r){let n=(await Promise.all(Array.from(this._workspaceIndex.values(),o=>o.getSemanticChunks(r)))).flat();return r.isCancellationRequested?[]:n.filter(o=>o.text.length<mf._MAX_CHUNK_LENGTH)}chunkToIndexString(r){let n=this._accessor.get(Je),o=O0(n,r.file);return C6e(r,o)}async getEmbeddings(r,n){let o=await this._embeddingsCache.value;if(this._isDisposed)return[];let s=new Array(r.length),a=[];for(let[u,l]of r.entries()){let d=await o.get(l);d?s[u]=d:a.push({index:u,value:l})}if(a.length===0)return s;let c=await this.computeEmbeddingsWithRetry(a.map(u=>u.value),n);for(let u=0;u<a.length;u++){if(this._isDisposed)return[];let l=a[u],d=c[u];if(typeof d>"u")throw new Error("Error computing embedding");s[l.index]=d,await o.set(l.value,d)}return s}async computeEmbeddingsWithRetry(r,n){let s=0,a;for(;s<3;)try{if(this._embeddingEndpoint??=await this._accessor.get(Le).getEmbeddingsEndpoint("ada"),a=await this._embeddingsComputer.computeEmbeddings(this._embeddingEndpoint,r,{parallelism:2},n),!a)throw new Error("Failed to compute embeddings");return a}catch(c){if(s++,s===3)throw c;if(n.isCancellationRequested)throw new Error("Cancelled computing embeddings");this._logger.warn(`Error computing embeddings. Retrying in ${s} seconds. Error: ${c}`),await new Promise(u=>setTimeout(u,1e3*s))}throw new Error("Failed to compute embeddings")}async tryPreInit(){if(!await this._configurationService.getExperimentBasedConfig(fe.WorkspacePreInitEmbeddings,this._experimentationService))return!1;let n=new ac;try{await P0((async()=>{let s=new Ws;if(this._logger.info("Trying to preload workspace embeddings"),await this._workspaceIndex.preLoadWorkspaceFiles(I6e,n.token),n.token.isCancellationRequested){this._logger.info("Preload indexing cancelled");return}this._logger.info(`Preloaded ${this._workspaceIndex.fileSystemFileCount} files. Preload elapsed time: ${s.elapsed()}ms`),this._logger.info(`Preloading trying to pre-compute embeddings for ${Array.from(this._workspaceIndex.values()).length} files`);let a=await this.getChunksToSearch(n.token);if(n.token.isCancellationRequested){this._logger.info("Preload embedding compute cancelled");return}this._logger.info(`Preloaded completed for ${a.length} chunks. Total preload time: ${s.elapsed()}ms`)})(),1e4,()=>(this._logger.info("Preload timed out"),n.cancel()))}catch{}finally{n.dispose()}}};mf=O([x(0,je),x(1,ye),x(2,Ut)],mf);function C6e(t,e){return`File: \`${e}\`
${gi(TN(t.file),t.text)}`}var hf=class extends Ct{constructor(r,n,o,s,a,c,u,l,d,p,f){super();this._accessor=n;this._codeSearchClient=o;this._configurationService=s;this._embeddingsIndex=a;this._experimentationService=c;this._ignoreService=u;this._telemetryService=l;this._workspaceChunkIndex=d;this._workspaceService=p;this._gitService=f;this.id="codesearch";this.timeout=5e3;this._logger=r.getLogger("CodeSearchChunkSearch")}async searchFileChunks(r,n,o,s){if(s.isCancellationRequested)return{chunks:[]};if(await xd(this._logger,"initialize",()=>this.initialized()),s.isCancellationRequested)return{chunks:[]};let a,c=!1;try{let l=await this.getSimilarFilesFromCodeSearch(r,n,s);if(a=l?.chunks,c=l?.couldBeOutdated??!1,s.isCancellationRequested)return{chunks:[]};this._telemetryService.sendMSFTTelemetryEvent("codeSearchChunkSearch.search.success",{},{chunkCount:a?.length??0})}catch(l){throw this._telemetryService.sendMSFTTelemetryEvent("codeSearchChunkSearch.search.error",{errorMessage:l instanceof Error?l.message:l.toString()}),l}if(!a||s.isCancellationRequested)return{chunks:[]};let u=await xd(this._logger,"toSemanticChunks",()=>SL(this._accessor,a,s));return s.isCancellationRequested?{chunks:[]}:{chunks:o.include?u.filter(l=>fae(l.file,o.include)):u,couldBeOutdated:c}}async isAvailable(){let r;return r=this._configurationService.getConfig(fe.WorkspaceCodeSearchEnabled),r===void 0&&(r=await this._experimentationService.getTreatmentVariableAsync("vscode","copilotchat.useCodeSearch",!0)),r??!0}async getShouldUseRawChunks(){let r;return r=this._configurationService.getConfig(fe.WorkspaceCodeSearchReturnRawChunks),r===void 0&&(r=await this._experimentationService.getTreatmentVariableAsync("vscode","copilotchat.codeSearchRawChunks",!0)),r??!1}initialized(){return this._embeddingsIndex.initialize()}async getSimilarFilesFromCodeSearch(r,n,o){let s=this._workspaceService.getWorkspaceFolders(),a=this._accessor.safeGet(go)?.repositories;if(!a){if(s.length)throw new Error("No repo contexts available for workspace folders");return}let c=[],u=new Map;for(let m=0;m<a.length;m++){let h=a[m];if(!h)continue;let g=tx(h)?.toLowerCase();g&&(c.push(g),u.set(g,s[m]))}if(!c.length)throw new Error("No repos to search through");let l=await this.getShouldUseRawChunks();if(o.isCancellationRequested)return{chunks:[],couldBeOutdated:!1};let d;if(r.maySkipResolve?.())d=r.rawQuery;else{let m=await r.resolve(o);if(!m||o.isCancellationRequested)return{chunks:[],couldBeOutdated:!1};d=m.rephrasedQuery}let p=await this._codeSearchClient.search(d,{repo:c},{rawChunks:l,limit:n},o);if(o.isCancellationRequested)return;let f=await this.processResults(u,[p]);return{chunks:f.chunks.flat().sort((m,h)=>h.score-m.score),couldBeOutdated:f.couldBeOutdated}}async _isOutdatedResponse(r,n){return r.commitOID?this._gitService.getRepository(n)?.headCommitHash!==r.commitOID:!1}async processResults(r,n){let o=!1,s=[];for(let a of n){if(a.errors.length){let c=!0;for(let u of r.keys()){let l=a.errors.filter(d=>d.repo===u);if(l){this._logger.debug(`[${u}] Errors when searching codesearch: ${l.map(LA)}`);continue}c=!1}if(c)throw a.errors.length===1?a.errors[0]:new AggregateError(a.errors)}for(let c of a.results){let u=c.repoOwner.toLowerCase()+"/"+c.repoName.toLowerCase(),l=r.get(u);if(!l){this._logger.error("Could not find workspace folder for repo",u);continue}!o&&await this._isOutdatedResponse(c,l)&&(o=!0);let d=this._workspaceChunkIndex.get(dt.joinPath(l,c.path));d&&(await this._ignoreService.isCopilotIgnored(d.uri)||s.push({file:d.uri,score:c.score,text:c.contents,sources:[],range:new bt(c.range.start,0,c.range.end+1,0)}))}}return{chunks:s,couldBeOutdated:o}}};O([Li(r=>r._logger,function(r,n){this._telemetryService.sendMSFTTelemetryEvent("codeSearchChunkSearch.perf.searchFileChunks",{status:n},{execTime:r})})],hf.prototype,"searchFileChunks",1),O([Li(r=>r._logger)],hf.prototype,"getSimilarFilesFromCodeSearch",1),hf=O([x(0,ue),x(1,je),x(2,vL),x(3,ye),x(4,Dh),x(5,Ut),x(6,De),x(7,me),x(8,vl),x(9,Je),x(10,go)],hf);var gf=class extends Ct{constructor(r,n,o,s,a){super();this._experimentationService=o;this._telemetryService=s;this._embeddingsIndex=a;this.id="ada";this.timeout=5e3;this._state=0;this._disposeCts=this._register(new ac);this._logger=n.getLogger("EmbeddingsCacheChunkSearch"),r&&(this._embeddingsIndex.shouldSearchTimeout=!1)}static{this.defaultFileCap=200}async searchFileChunks(r,n,o,s){if(await this.initialize(),s.isCancellationRequested)return{chunks:[]};if(this._state!==1&&this._state!==2)return{chunks:[]};let a;if(r.maySkipResolve?.())a=r.rawQuery;else{let c=await r.resolve(s);if(!c||s.isCancellationRequested)return{chunks:[]};a=c.rephrasedQuery}return this._logger.debug("Fetching related workspace chunks in repository..."),{chunks:await this._embeddingsIndex.searchAllChunks(a,n,s)}}async isAvailable(){return await this.initialize(),this._state===1||this._state===2}async initialize(){this._init??=(async()=>{if(await this._embeddingsIndex.initialize(),this._disposeCts.token.isCancellationRequested)return;let r=await this._experimentationService.getTreatmentVariableAsync("vscode","workspace.embeddingsCacheFileCap")??gf.defaultFileCap;if(this._disposeCts.token.isCancellationRequested)return;if(this._embeddingsIndex.fileSystemFileCount>r){this._state=3;return}this._state=1,this.triggerIndexing()})(),await this._init}triggerIndexing(){this._indexingPromise??=(async()=>{this._logger.debug("Starting indexing");try{await this._embeddingsIndex.triggerIndexing(this._disposeCts.token),this._state=2,this._logger.debug("Workspace Chunk Embeddings Index initialized.")}catch(r){this._logger.warn(`Failed to index workspace: ${r}`),this._indexingPromise=void 0}})()}};O([Li(r=>r._logger,function(r,n){this._telemetryService.sendMSFTTelemetryEvent("embeddingsChunkSearch.perf.searchFileChunks",{status:n},{execTime:r})})],gf.prototype,"searchFileChunks",1),gf=O([x(1,ue),x(2,Ut),x(3,me),x(4,Dh)],gf);var Tae=z(require("path"));var Eae=require("worker_threads"),EH=class{constructor(e,r,n){this.logger=n;this.handlers=new Map;this.nextId=1;this.worker=new Eae.Worker(e,r),this.worker.on("message",({id:o,err:s,res:a})=>{let c=this.handlers.get(o);c&&(this.handlers.delete(o),s?c.reject(s):c.resolve(a))}),this.worker.on("error",o=>this.handleError(o)),this.worker.on("exit",o=>{o!==0&&this.handleError(new Error(`Worker thread exited with code ${o}.`))})}terminate(){this.worker.removeAllListeners(),this.worker.terminate(),this.handlers.clear()}handleError(e){this.logger?.exception(e);for(let r of this.handlers.values())r.reject(e);this.handlers.clear()}remoteCall(e,r){let n=this.nextId++,o,s,a=new Promise((c,u)=>{o=c,s=u});return this.handlers.set(n,{resolve:o,reject:s}),this.worker.postMessage({id:n,fn:e,args:r}),a}},Nh=class{constructor(e,r,n){this.worker=new EH(e,r,n);let o={get:(s,a)=>(typeof a=="string"&&!s[a]&&(s[a]=(...c)=>{if(!this.worker)throw new Error("Worker was terminated!");return this.worker.remoteCall(a,c)}),s[a])};this.proxy=new Proxy(Object.create(null),o)}terminate(){this.worker.terminate()}};function Uw(t,e){if(!t)return t;if(Array.isArray(t))return t.map(r=>Uw(r,e));if(typeof t=="object"){let r=e(t);if(r)return r;let n={};for(let o in t)n[o]=Uw(t[o],e);return n}return t}var E6e=Tae.default.join(__dirname,"tfidfWorker.js"),Lh=class extends Ct{constructor(r,n,o){super();this._telemetryService=n;this._workspaceIndex=o;this.id="tfidf";this.timeout=500;this._isDisposed=!1;this._tfIdfWorker=new Wi(()=>new Nh(E6e,{name:"TfIdf Worker"})),this._logger=r.getLogger("TfidfChunkSearch");let s=a=>{let c=this._workspaceIndex.get(a);c&&this.addOrUpdateTfidfEntries([c])};this._register(this._workspaceIndex.onDidCreateFile(s)),this._register(this._workspaceIndex.onDidChangeFile(s)),this._register(this._workspaceIndex.onDidDeleteFile(a=>{this._isDisposed||this._tfIdfWorker.value.proxy.delete(a)}))}dispose(){this._isDisposed=!0,super.dispose(),this._tfIdfWorker.rawValue?.terminate()}initialize(){return this._initializePromise??=this._initializeWorkspaceFiles(),this._initializePromise}async searchFileChunks(r,n,o,s){if(await Qp(this.initialize(),s),s.isCancellationRequested||this._isDisposed)return{chunks:[]};let a=await r.resolve(s);if(!a||s.isCancellationRequested||this._isDisposed)return{chunks:[]};let c=a.keywords.flatMap(l=>[l.keyword,...l.variations]),u=await xd(this._logger,"search",()=>Qp(this._tfIdfWorker.value.proxy.search([c.length?c.join(", "):a.rephrasedQuery],{maxResults:n,include:o.include,maxSpread:.75}),s),(l,d)=>{this._telemetryService.sendMSFTTelemetryEvent("tfIdfChunkSearch.perf.tfidfSearch",{status:s.isCancellationRequested?"cancelled":d},{execTime:l})});return{chunks:w6e(u)}}async isAvailable(){return await this.initialize(),!0}async _initializeWorkspaceFiles(){await xd(this._logger,"initialize workspaceIndex",()=>this._workspaceIndex.initialize()),!this._isDisposed&&await xd(this._logger,"initialize tfidf",()=>this.addOrUpdateTfidfEntries(this._workspaceIndex.values()),(r,n)=>{this._telemetryService.sendMSFTTelemetryEvent("tfidfChunkSearch.perf.initializeTfidf",{status:n},{execTime:r,fileSystemFileCount:this._workspaceIndex.fileSystemFileCount})})}async addOrUpdateTfidfEntries(r){if(this._isDisposed)return;let n=new B_(20),o;try{o=await Promise.all(Array.from(r,s=>n.queue(async()=>({uri:s.uri,content:await s.getText(an.None)}))))}finally{n.dispose()}this._isDisposed||this._tfIdfWorker.value.proxy.addOrUpdate(T6e(o))}};O([Li(r=>r._logger)],Lh.prototype,"initialize",1),O([Li(r=>r._logger,function(r,n){this._telemetryService.sendMSFTTelemetryEvent("tfIdfChunkSearch.perf.searchFileChunks",{status:n},{execTime:r})})],Lh.prototype,"searchFileChunks",1),Lh=O([x(0,ue),x(1,me),x(2,vl)],Lh);function T6e(t){return Uw(t,e=>{if(dt.isUri(e))return{$mid:"uri",...e};if(e instanceof bt)return{startLineNumber:e.startLineNumber,startColumn:e.startColumn,endLineNumber:e.endLineNumber,endColumn:e.endColumn}})}function w6e(t){return Uw(t,e=>{if(e.$mid==="range")return new bt(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn);if(e.$mid==="uri")return dt.revive(e)})}var ty=class extends Ct{constructor(r,n,o){super();this.instantiationService=n;this._telemetryService=o;this.id="tfidf";this.timeout=500;this._tfidf=this._register(n.createInstance(Lh)),this._logger=r.getLogger("TfIdfWithSemanticChunkSearch")}async searchFileChunks(r,n,o,s){this._logger.debug("Performing full workspace search for chunks...");let c=(await this._tfidf.searchFileChunks(r,n*2,o,s)).chunks;if(s.isCancellationRequested||!c.length)return{chunks:[]};let u=await xd(this._logger,"toSemanticChunks",()=>this.instantiationService.invokeFunction(l=>SL(l,c,s)));return s.isCancellationRequested||!u.length?{chunks:[]}:{chunks:u}}isAvailable(){return this._tfidf.isAvailable()}};O([Li(r=>r._logger,function(r,n){this._telemetryService.sendMSFTTelemetryEvent("tfIdfWithSemanticChunkSearch.perf.searchFileChunks",{status:n},{execTime:r})})],ty.prototype,"searchFileChunks",1),ty=O([x(0,ue),x(1,te),x(2,me)],ty);var Oh=ae("IWorkspaceChunkSearch"),vf=class{constructor(e,r,n,o,s,a){this._forcedChunkSearchStrategy=e;this._telemetryService=o;this._workspaceChunkEmbeddingsIndex=s;this._accessor=a;this._simulationTestContext=this._accessor.get(df),this._logger=n.getLogger("WorkspaceChunkSearch"),this._embeddingsCacheChunkSearch=r.createInstance(gf,this._simulationTestContext.isInSimulationTests),this._codeSearchChunkSearch=r.createInstance(hf),this._tfIdfWithSemanticChunkSearch=r.createInstance(ty)}dispose(){this._embeddingsCacheChunkSearch.dispose(),this._codeSearchChunkSearch.dispose(),this._tfIdfWithSemanticChunkSearch.dispose()}async triggerIndexing(){await Promise.allSettled([this._tfIdfWithSemanticChunkSearch.isAvailable(),this._embeddingsCacheChunkSearch.isAvailable()])}isUpToDateCodesearchResult(e){return e.strategy==="codesearch"&&e.chunks.length>0&&e.couldBeOutdated===!1}async shouldUseOnlyCodeSearchWhenUpToDate(){return await this._accessor.get(Ut).getTreatmentVariableAsync("vscode","copilotchat.useOnlyCodeSearchWhenUpToDate")??!1}async searchFileChunks(e,r,n,o,s,a){let c=new Ws,u=await this.getStrategies();if(s.isCancellationRequested)return[];let l=await this.shouldUseOnlyCodeSearchWhenUpToDate();l&&this._logger.debug("Using only CodeSearch results when local HEAD matches CodeSearch snippet commit hash");let d=u.map(I=>PU(async T=>{let A=await I.searchFileChunks(r,n,o,T);return{chunks:A.chunks.map(B=>({...B,strategy:I.id})),strategy:I.id,couldBeOutdated:A.couldBeOutdated}}));s.onCancellationRequested(()=>d.forEach(I=>I.cancel()));for(let I of d)I.then(T=>{for(let A=0;A<d.length;A++)T.strategy==="ada"||l&&this.isUpToDateCodesearchResult(T)?d[A].cancel():P0(d[A].catch(()=>{}),u[A].timeout,()=>{d[A].cancel(),this._logger.warn(`WorkspaceChunkSearch strategy ${u[A].id} timed out`)})},()=>{});let p=await Qp(Promise.allSettled(d),s);if(s.isCancellationRequested||!p)return[];let f=[],m;for(let I=0;I<p.length;I++){let T=p[I],A=u[I];if(T.status==="fulfilled"){(!m||T.value.strategy==="ada"||this.isUpToDateCodesearchResult(T.value))&&(m=T.value.strategy),f.push(T.value);continue}if(this._logger.debug(`Strategy, ${A.id}, failed with the following error: ${LA(T.reason)}`),T.status==="rejected"&&T.reason instanceof Nw&&A instanceof hf)try{if(this._accessor.get(Nt).permissiveGitHubSession)continue;if(await this._accessor.get(Nt).getPermissiveGitHubSession({forceNewSession:{detail:TH.t("To show you more relevant Copilot Chat results, we need permission to read the contents of your repository on GitHub."),learnMore:dt.parse("https://aka.ms/copilotRepoScope")}})){let j=await A.searchFileChunks(r,n,o,s);m=A.id,f.unshift({chunks:j.chunks.map(F=>({...F,strategy:A.id,couldBeOutdated:j.couldBeOutdated})),strategy:A.id})}}catch{}}this._logger.debug(`'${m}' was the top working workspace chunk search strategy`),this._accessor.get(me).sendMSFTTelemetryEvent("workspaceChunkSearchStrategy",{strategy:m??"none",allAttemptedStrategies:u.map(I=>I.id).join(","),allSuccessfulStrategies:p.filter(I=>I.status==="fulfilled").map(I=>I.value.strategy).join(",")},{execTime:c.elapsed()});let g=this._accessor.get(De),v=await Promise.all(f.map(async I=>({...I,chunks:Xt(await Promise.all(I.chunks.map(async T=>await g.isCopilotIgnored(T.file)?null:T)))})));if(this._simulationTestContext.isInSimulationTests&&!v.some(I=>I.chunks.length>0))throw new Error("No chunks returned");function y(I){return JSON.stringify(I.map(T=>({strategy:T.strategy,text:T.text})),null,2)}let b=async(I,T)=>{this._simulationTestContext.isInSimulationTests&&await this._accessor.get(df).writeFile(I+".txt",y(T),I)},_=v.flatMap(I=>I.chunks);b("workspace-chunk-search-pre-rerank",_);let S=await this.rerankChunks(e,r,v.flat(),n,s,a,l);return b("workspace-chunk-search-post-rerank",S),S}async rerankChunks(e,r,n,o,s,a,c=!1){let u=n.find(l=>l.strategy==="ada");if(u)return u.chunks.slice(0,o);if(c){let l=n.find(d=>this.isUpToDateCodesearchResult(d));if(l)return l.chunks.slice(0,o)}return a?.(TH.t("Filtering to most relevant information")),this._accessor.get(ye).getConfig(fe.WorkspaceRerankStrategy)==="model"?this.sortChunksUsingModel(e,r,n.flatMap(l=>l.chunks),o,s):this.rerankChunksUsingAda(r,n,o,s)}async rerankChunksUsingAda(e,r,n,o){try{let s=await e.resolve(o);if(!s||o.isCancellationRequested)return[];let a=r.flatMap(d=>d.chunks.map(p=>({...p,strategy:d.strategy}))).map((d,p)=>({...d,index:p})),c=await this._workspaceChunkEmbeddingsIndex.searchChunks(a,s.rephrasedQuery,n,o),u=this._accessor.get(me),l=c.filter(d=>d.index<n).length;return u.sendMSFTTelemetryEvent("workspaceChunkSearch.adaRerank",{allStrategies:r.filter(d=>d.chunks.length).map(d=>d.strategy).join(","),topChunkInitialIndices:c.map(d=>d.index).join(","),topChunkStrategies:c.map(d=>d.strategy).join(",")},{originalChunkCount:a.length,maxResultCount:n,originalTopInTopAfterRerank:l/n}),c}catch(s){return this._logger.warn("Failed to search chunk embeddings index: ",s),r.flatMap(a=>a.chunks).slice(0,n)}}async sortChunksUsingModel(e,r,n,o,s){let a=await r.resolve(s);if(!a||s.isCancellationRequested)return[];let c=this._accessor.get(Bt),u=[];for(let l=0;l<n.length;l+=o){let d=n.slice(l,l+o),p=[...u,...d];lre(p);let f=await c.fetchOne([{role:"system",content:`
The user will provide you with question and a numbered list of code snippets.
You are to sort the code snippets by most to least helpful in answering the question.
If a code snippet is not related to the question in possible any way, you may opt not to include it in the list.
Return an ordered list of snippet numbers.
Only return snippet numbers.
Do not explain.
				`.trim()},{role:"user",content:`
Question: ${a.rephrasedQuery}

${p.map((h,g)=>`# Snippet ${g}
 ${gi("",h.text)}`).join(`

`)}
					`.trim()}],async h=>{},s,2,e,{agent:tf},{temperature:.1,top_p:1,stop:["dontStopBelieving"]},{messageSource:"workspaceChunkRerank"});if(s.isCancellationRequested)return[];if(f.type!=="success"){console.warn("Model re-rank failed");continue}let m=new Set(Array.from(f.value.matchAll(/\d+/g),h=>parseInt(h[0])));u=Xt(Array.from(m).map(h=>p.at(h))).slice(0,o)}return u}async getStrategies(){let e=new Array;switch(this._forcedChunkSearchStrategy){case"codesearch":e.push(this._codeSearchChunkSearch);break;case"ada":e.push(this._embeddingsCacheChunkSearch);break;case"tfidf":e.push(this._tfIdfWithSemanticChunkSearch);break;default:await this._codeSearchChunkSearch.isAvailable()&&e.push(this._codeSearchChunkSearch),await this._embeddingsCacheChunkSearch.isAvailable()&&e.push(this._embeddingsCacheChunkSearch),e.push(this._tfIdfWithSemanticChunkSearch);break}return this._logger.debug(`Using ${e.map(r=>r.id).join(", ")} for chunk search`),e}};O([Li(e=>e._logger,function(e,r){this._accessor.get(me).sendMSFTTelemetryEvent("workspaceChunkSearch.perf.triggerIndexing",{status:r},{execTime:e})})],vf.prototype,"triggerIndexing",1),O([Li(e=>e._logger,function(e,r){this._telemetryService.sendMSFTTelemetryEvent("workspaceChunkSearch.perf.searchFileChunks",{status:r},{execTime:e})})],vf.prototype,"searchFileChunks",1),O([Li(e=>e._logger),Dw(function(e,r){this._accessor.get(me).sendMSFTTelemetryEvent("workspaceChunkSearch.perf.adaRerank",{status:r},{execTime:e})})],vf.prototype,"rerankChunksUsingAda",1),vf=O([x(1,te),x(2,ue),x(3,me),x(4,Dh),x(5,je)],vf);var EL=z(at());var wH=class extends Q{render(e,r){return vscpp(vscppf,null,this.props.history&&vscpp(Lt,{priority:500,history:this.props.history}),vscpp(EL.SystemMessage,{priority:1e3},"You are a coding assistant who help the user answer questions about code in their workspace by providing a list of relevant keywords they can search for to answer the question.",vscpp("br",null),"The user will provide you with potentially relevant information from the workspace. This information may be incomplete.",vscpp("br",null),"Respond in Markdown. First under a `# Question` header, output a rephrased version of the user's question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for.",vscpp("br",null),"Then under a `# Keywords` header, output a short markdown list of up to 8 relevant keywords that the user can search for to answer the question. You may include variations after each keyword.",vscpp("br",null),"DO NOT ask the user for additional information or clarification.",vscpp("br",null),"DO NOT answer the user's question directly.",vscpp("br",null),vscpp("br",null),"# Additional Rules",vscpp("br",null),vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Read the user's question to understand what they are asking about their workspace.",vscpp("br",null),"2. If the question contains pronouns such as 'it' or 'that', try to understand what the pronoun refers to by looking at the rest of the question and the conversation history.",vscpp("br",null),"3. If the question contains an ambiguous word such as 'this', try to understand what is refers to by looking at the rest of the question, the user's active selection, and the conversation history.",vscpp("br",null),"4. After a `# Question` header, output a precise version of question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for. Be sure to preserve the exact meaning of the question by only changing ambiguous pronouns and words like 'this'.",vscpp("br",null),"5. Then after a `# Keywords` header, output a short markdown list of up to 8 relevant keywords that user could try searching for to answer their question. These keywords could used as file name, symbol names, abbreviations, or comments in the relevant code. Put the keywords most relevant to the question first. Do not include overly generic keywords. Do not repeat keywords.",vscpp("br",null),"6. For each keyword in the markdown list of related keywords, if applicable add a comma separated list of variations after it. For example: for 'encode' possible variations include 'encoding', 'encoded', 'encoder', 'encoders'. Consider synonyms and plural forms. Do not repeat variations.",vscpp("br",null),vscpp("br",null),"Examples",vscpp("br",null),vscpp("br",null),"User: Where's the code for base64 encoding?",vscpp("br",null),vscpp("br",null),"Assistant:",vscpp("br",null),"# Question",vscpp("br",null),"Where's the code for base64 encoding?",vscpp("br",null),vscpp("br",null),"# Keywords",vscpp("br",null),"- base64 encoding, base64 encoder, base64 encode",vscpp("br",null),"- base64, base 64",vscpp("br",null),"- encode, encoded, encoder, encoders"),vscpp(Nr,{flexGrow:1,priority:600,document:this.props.document,range:this.props.selection}),this.props.fileTree&&vscpp(EL.UserMessage,{priority:700},this.props.fileTree),vscpp(Kr,{flexGrow:2,priority:1e3,chatVariables:this.props.chatVariables,query:this.props.query}))}};async function wae(t,{query:e,history:r,chatVariables:n},o,s){let a=t.get(kt).activeTextEditor;return $e.create(t.get(te),o,wH,{chatVariables:n,query:e,history:r,fileTree:s,document:a?.document,selection:a?.selection}).render()}var R6e=/^[\*\-]\s*(.+)/m;function Vx(t,e){let r=e.match(/#+\s*Question\n(?<question>.+?)#+\s*Keywords\n(?<keywords>.+)/si);if(!r?.groups)return{rephrasedQuestion:t.trim(),keywords:[]};let n=[];for(let o of r.groups.keywords.trim().split(`
`)){let s=o.match(R6e);if(s){let a=s[1].split(/,/g).map(c=>c.trim());a.length&&n.unshift({keyword:a[0],variations:a.slice(1)})}}return{rephrasedQuestion:r.groups.question.trim(),keywords:n}}function Rae(t){return t.reduce((r,n)=>r+n.value.length,0)+Math.max(0,t.length-1)}async function P6e(t,e=1/0,r){let n=kae(0,t,e),o=e-Rae(n);for(;;){let s=!1,a=[];for(let c of n)if(c.type==="text")a.push(c);else if(c.type==="dir"){a.push({type:"text",value:c.value});let u=await c.getChildren();if(r?.isCancellationRequested)return"";let l=kae(c.level+1,u,o-1);l.length&&(s=!0,o-=Rae(l)+1,a.push(...l))}if(n=a,!s)break}return n.map(s=>s.value).join(`
`)}function kae(t,e,r){let n="	".repeat(t),o=[],s=r;for(let a=0;a<e.length;++a){let c=e[a],u=n+c.name+(c.type===2?"/":"");if(u.length>s){let l=n+"...";for(;l.length>s&&o.length>0;)s+=o.pop().value.length+1;l.length<=s&&o.push({type:"text",value:l});break}c.type===2?o.push({type:"dir",level:t,value:u,getChildren:c.getChildren}):o.push({type:"text",value:u}),s-=u.length,a!==e.length-1&&(s-=1)}return o}async function RH(t,e,r,n){let o=t.get(zr),s=t.get(De);async function a(u){let l;try{l=await o.readDirectory(u)}catch(d){return console.error(d),[]}return n.isCancellationRequested?[]:(l.sort((d,p)=>d[0].localeCompare(p[0])),Promise.all(l.map(async d=>{let p=dt.joinPath(u,d[0]);return await ey(t,p)?d:null})).then(d=>d.filter(p=>p!==null).map(p=>p[1]===2?{type:2,name:p[0],getChildren:()=>a(dt.joinPath(u,p[0]))}:{type:1,name:p[0]})))}if(await s.init(),n.isCancellationRequested)return"";let c=await a(e);return n.isCancellationRequested?"":P6e(c,r,n)}async function Hw(t,e=500,r){let n=t.get(Je).getWorkspaceFolders().at(0);if(!n)return;let o=await RH(t,n,e,r);return D6e("I am working in a workspace that has the following structure:","",gi("",o))}var Gx=class extends Q{constructor(r,n,o,s,a,c){super(r);this.accessor=n;this.ignoreService=s;this.languageFeaturesService=a;this.workspaceService=c;this.timeout=15e3;this.logger=o.getLogger("<WorkspaceSymbols>")}async prepare(r,n,o){let s=await Fx(this.accessor,{valueFor4096:8,maxMultiplier:4});if(o.isCancellationRequested)return[];let a=await this.getSymbols(o);return!a.length||o.isCancellationRequested?[]:A6e(a.map(c=>`- ${c.name} \u2014 ${O0(this.workspaceService,c.location.uri)}`)).slice(0,s)}render(r,n){if(r.length)return vscpp(qw.TextChunk,{priority:this.props.priority},"Here are some potentially relevant symbols from the current workspace:",vscpp("br",null),r.join(`
`))}async getSymbols(r){let n=await this.props.query.resolve(r);if(!n||r.isCancellationRequested)return[];let o=await Promise.all(n.keywords.flatMap(a=>[a.keyword,...a.variations]).map(a=>P0(this.languageFeaturesService.getWorkspaceSymbols(a),this.timeout)));if(r.isCancellationRequested)return[];let s=await Promise.all(o.flat().map(async a=>(a?await this.ignoreService.isCopilotIgnored(a.location.uri):!1)?null:a));return Xt(s).filter(Boolean)}};O([Li(r=>r.logger)],Gx.prototype,"prepare",1),Gx=O([x(1,je),x(2,ue),x(3,De),x(4,Ai),x(5,Je)],Gx);var yf=class extends Q{constructor(r,n,o,s,a,c){super(r);this.accessor=n;this.telemetryService=s;this.workspaceChunkSearch=a;this.workspaceService=c;this.logger=o.getLogger("<WorkspaceChunks>")}async prepare(r,n,o=an.None){let s=await Fx(this.accessor,{valueFor4096:4,maxMultiplier:4});if(o.isCancellationRequested)return;let a=(await this.workspaceChunkSearch.searchFileChunks(r.endpoint,this.props.query,this.props.maxResults??s,{include:this.props.include},o,l=>n?.report(new ho(l)))).slice(0,s);if(o.isCancellationRequested||!a.length)return;let c=new Nn;for(let l of a){let d=c.get(l.file)??[];l.isFullFile?d=[l]:d.some(p=>p.isFullFile||p.range.containsRange(l.range))||(d=[...d.filter(p=>!l.range.containsRange(p.range)),l]),c.set(l.file,d)}let u=Array.from(c.values()).flatMap(l=>l.sort((d,p)=>bt.compareRangesUsingStarts(d.range,p.range)).map(d=>new Ss.PromptReference(d.isFullFile?d.file:new hi(d.file,Rh(d.range)))));return{chunks:a,references:u}}render(r,n){if(r)return vscpp(vscppf,null,vscpp("references",{value:r.references}),r.chunks.map((o,s)=>{let a=typeof this.props.priority<"u"?this.props.priority+(1-(s+1)/r.chunks.length):void 0;return{chunk:o,priority:a}}).reverse().map(({chunk:o,priority:s})=>{let a=O0(this.workspaceService,o.file);return vscpp(qw.TextChunk,{priority:s},"Here is a potentially relevant code excerpt ",o.isFullFile?`starting at line ${o.range.startLineNumber} `:"","in `",a,"`:",vscpp("br",null),gi(TN(o.file),o.text))}))}};O([Li(r=>r.logger),Dw(function(r,n){this.telemetryService.sendMSFTTelemetryEvent("workspaceContext.perf.prepareWorkspaceChunks",{status:n},{execTime:r})})],yf.prototype,"prepare",1),yf=O([x(1,je),x(2,ue),x(3,me),x(4,Oh),x(5,Je)],yf);function A6e(t){return[...new Set(t)]}function D6e(...t){return t.join(`
`)}var Bw=class extends Q{constructor(r,n,o){super(r);this.accessor=n;this.workspaceService=o}async prepare(r,n,o){let s=this.workspaceService.getWorkspaceFolders().at(0);return s?RH(this.accessor,s,500,o):void 0}render(r,n){if(r)return vscpp(vscppf,null,"I am working in a workspace that has the following structure:",vscpp("br",null),vscpp("br",null),gi("",r))}};Bw=O([x(1,je),x(2,Je)],Bw);var Mh=class extends Q{constructor(r,n,o,s,a,c){super(r);this.accessor=n;this.chatFetcher=s;this.telemetryService=a;this.tokenizerProvider=c;this.logger=o.getLogger("workspaceResolver")}async prepare(r,n,o){n?.report(new ho(TL.t("Deciding which workspace information to collect")));let s=this.props.promptContext.query;if(!s)return;let a=(async()=>{this.logger.debug("Determining workspace structure...");let c=await Hw(this.accessor,1e3,o);if(o.isCancellationRequested)return;this.logger.debug("Asking the model to update the user question and provide queries...");let{messages:u}=await wae(this.accessor,this.props.promptContext,r.endpoint,c);if(o.isCancellationRequested)return;let l=this.tokenizerProvider.acquireTokenizer(r.endpoint.family).tokenLength(s),p=await this.chatFetcher.fetchOne(u,async h=>{},o,2,r.endpoint,{agent:tf},{temperature:0,top_p:1,stop:["dontStopBelieving"],max_tokens:l+200},{messageSource:"workspaceIntent"});if(o.isCancellationRequested)return;let f;if(p.type!=="success")if(this.telemetryService.sendMSFTTelemetryEvent("workspaceResolver.error",{type:p.type,reason:p.reason,requestId:p.requestId}),p.type==="length")f=p.truncatedValue;else throw new Error(TL.t("Encountered an error while deciding what workspace information to collect: ({0}) {1}",p.type,p.reason));else f=p.value;let m=Vx(s,f);return this.telemetryService.sendMSFTTelemetryEvent("workspaceResolver.success",{type:p.type,requestId:p.requestId},{totalKeywordCount:m.keywords.flatMap(h=>[h.keyword,h.variations]).length}),this.logger.debug("Running all tools..."),n?.report(new ho(TL.t("Collecting workspace information"))),{rephrasedQuery:m.rephrasedQuestion,keywords:m.keywords}})();return{rawQuery:s,resolve:()=>a,maySkipResolve:()=>!/\b(it|that|this)\b/i.test(s)}}render(r,n){if(!r)return;let o=this.props.include??{workspaceStructure:!0,workspaceSymbols:!0,workspaceFiles:!0,workspaceChunks:!0};return vscpp(vscppf,null,o.workspaceStructure&&vscpp(Bw,{...this.props}),o.workspaceSymbols&&vscpp(Gx,{priority:this.props.priority,query:r}),o.workspaceChunks&&vscpp(yf,{priority:this.props.priority,query:r}))}};O([Dw(function(r,n){this.telemetryService.sendMSFTTelemetryEvent("workspaceContext.perf.prepare",{status:n},{execTime:r})})],Mh.prototype,"prepare",1),Mh=O([x(1,je),x(2,ue),x(3,Bt),x(4,me),x(5,dr)],Mh);var zx=class extends Q{render(e,r){return vscpp(qw.UserMessage,null,vscpp(Mh,{...this.props}))}};var wL=class extends Q{render(e,r){let{query:n,history:o,chatVariables:s}=this.props.promptContext;return vscpp(vscppf,null,vscpp(RL.SystemMessage,{priority:1e3},"You are a software engineer with expert knowledge of the codebase the user has open in their workspace.",vscpp("br",null),vscpp("br",null),vscpp(Hr,null),vscpp(Zt,null),vscpp(Di,null),vscpp(cr,null),"# Additional Rules",vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Read the provided relevant workspace information (code excerpts, file names, and symbols) to understand the user's workspace.",vscpp("br",null),"2. Consider how to answer the user's prompt based on the provided information and your specialized coding knowledge. Always assume that the user is asking about the code in their workspace instead of asking a general programming question. Prefer using variables, functions, types, and classes from the workspace over those from the standard library.",vscpp("br",null),"3. Generate a response that clearly and accurately answers the user's question. In your response, add fully qualified links for referenced symbols (example: [`namespace.VariableName`](path/to/file.ts)) and links for files (example: [path/to/file](path/to/file.ts)) so that the user can open them. If you do not have enough information to answer the question, respond with \"I'm sorry, I can't answer that question with what I currently know about your workspace\".",vscpp("br",null),vscpp("br",null),"DO NOT mention that you cannot read files in the workspace.",vscpp("br",null),"DO NOT ask the user to provide additional information about files in the workspace.",vscpp("br",null),"Remember that you MUST add links for all referenced symbols from the workspace and fully qualify the symbol name in the link, for example: [`namespace.functionName`](path/to/util.ts).",vscpp("br",null),"Remember that you MUST add links for all workspace files, for example: [path/to/file.js](path/to/file.js)",vscpp("br",null),vscpp("br",null),"# Examples",vscpp("br",null),"Question:",vscpp("br",null),"What file implements base64 encoding?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"Base64 encoding is implemented in [src/base64.ts](src/base64.ts) as [`encode`](src/base64.ts) function.",vscpp("br",null),vscpp("br",null),vscpp("br",null),"Question:",vscpp("br",null),"How can I join strings with newlines?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"You can use the [`joinLines`](src/utils/string.ts) function from [src/utils/string.ts](src/utils/string.ts) to join multiple strings with newlines.",vscpp("br",null),vscpp("br",null),vscpp("br",null),"Question:",vscpp("br",null),"How do I build this project?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"To build this TypeScript project, run the `build` script in the [package.json](package.json) file:",vscpp("br",null),vscpp("br",null),"```sh",vscpp("br",null),"npm run build",vscpp("br",null),"```",vscpp("br",null),vscpp("br",null),vscpp("br",null),"Question:",vscpp("br",null),"How do I read a file?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"To read a file, you can use a [`FileReader`](src/fs/fileReader.ts) class from [src/fs/fileReader.ts](src/fs/fileReader.ts).",vscpp("br",null)),vscpp(Lt,{flexGrow:1,priority:400,history:o}),vscpp(Nr,{flexGrow:1,document:this.props.document,range:this.props.selection,priority:600}),vscpp(RL.UserMessage,{flexGrow:1},vscpp(Mh,{priority:800,...this.props})),vscpp(Kr,{flexGrow:2,priority:900,chatVariables:s,query:n}))}};var Vw="workspace",jw=class extends Oo{constructor(r,n,o,s,a){super(r,n,o);this.instantiationService=s;this.tabsAndEditorsService=a}createRenderer(r,n,o,s){let a=this.tabsAndEditorsService.activeTextEditor;return $e.create(this.instantiationService,n,wL,{promptContext:r,document:a?.document,selection:a?.selection})}};jw=O([x(3,te),x(4,kt)],jw);var Fh=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id=Fh.ID;this.description=Pae.t("Ask a question about the files in your current workspace");this.locations=[2];this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:!0}}static{this.ID=Vw}get intentDetectionInput(){let e="workspace_questions";return{functionName:e,sampleQuestion:"How do I build this project?",functionCallingBlurb:`If the user's message is about files in the current project, repository, or workspace, you should use the '${e}' function.`}}async invoke(e){let r=e.location,n="gpt-3.5-turbo";r===2&&(n="gpt-4");let o=await this.endpointProvider.getChatEndpoint(n);return this.instantiationService.createInstance(jw,this,r,o)}};Fh=O([x(0,te),x(1,Le)],Fh);var ML=z(Qt());var Dae=z(at());var Aae=z(at());var Qr=class extends Q{constructor(r,n,o,s){super(r);this.accessor=n;this.ignoreService=o;this.tokenizerProvider=s}async prepare(r){let n=this.tokenizerProvider.acquireTokenizer(r.endpoint.family),o=[];for(let l of this.props.input)await this.ignoreService.isCopilotIgnored(l.document.uri)||o.push(l);let s=o.map(l=>{let{document:d,change:p,selection:f}=l,m;if(p?.hunks.length){let h=p.hunks[0];m=[h.range.start.line>0?Qr.enumeratedLines(d,0,h.range.start.line):"",...p.hunks.map((g,v,y)=>{let b=v+1<y.length?y[v+1].range.start.line:d.lineCount;return[Qr.enumeratedChangeLines(g.text,g.range.start.line),`
`,g.range.end.line<b?Qr.enumeratedLines(d,g.range.end.line,b):""]}).flat()].join("")}else if(f){let h=f.end.line+(f.end.character>0?1:0);m=Qr.enumeratedSelectedLines(d,0,d.lineCount,f.start.line,h)}else m=Qr.enumeratedLines(d,0,d.lineCount);return{input:l,hunks:[{range:new Ge(0,0,l.document.lineCount,0),text:m}],tokens:n.tokenLength(m)}}),a=s.reduce((l,{tokens:d})=>l+d,0),c=this.props.logService.getLogger("CurrentChange");if(c.info(`Full documents: ${a} tokens, ${r.tokenBudget} budget`),a<=r.tokenBudget)return{input:s.map(({input:l,hunks:d})=>({input:l,hunks:d}))};let u=s.slice().sort((l,d)=>d.tokens-l.tokens);for(let l of u){let{input:d,tokens:p}=l,{document:f,change:m,selection:h}=d;if(m?.hunks.length){let g=[],v=0;for(let y of m.hunks){let b=await rs.getDefinitionAtRange(this.accessor,f,y.range,!1);if(b){let _=b.range.end.line+(b.range.end.character>0?1:0),S=y.range.end.line+(y.range.end.character>0?1:0),I=[y.range.start.line>b.range.start.line?Qr.enumeratedLines(f,b.range.start.line,y.range.start.line):"",Qr.enumeratedChangeLines(y.text,y.range.start.line),`
`,_>S?Qr.enumeratedLines(f,S,_):""].join("");g.push({range:new Ge(Math.min(y.range.start.line,b.range.start.line),0,Math.max(_,S),0),text:I}),v+=n.tokenLength(I)}else{let _=Qr.enumeratedChangeLines(y.text,y.range.start.line),S=y.range.end.line+(y.range.end.character>0?1:0);g.push({range:new Ge(y.range.start.line,0,S,0),text:_}),v+=n.tokenLength(_)}}l.hunks=g,l.tokens=v,a+=l.tokens-p}else if(h){let g=await rs.getDefinitionAtRange(this.accessor,f,h,!1);if(g){let v=g.range.end.line+(g.range.end.character>0?1:0),y=h.end.line+(h.end.character>0?1:0),b=Qr.enumeratedSelectedLines(f,g.range.start.line,v,h.start.line,y),_=n.tokenLength(b);l.hunks=[{range:g.range,text:b}],l.tokens=_,a+=l.tokens-p}else{let v=h.end.line+(h.end.character>0?1:0),y=Qr.enumeratedSelectedLines(f,h.start.line,v,h.start.line,v);l.hunks=[{range:new Ge(h.start.line,0,v,0),text:y}],l.tokens=n.tokenLength(y),a+=l.tokens-p}}else l.hunks=[],l.tokens=0,a+=l.tokens-p;if(c.info(`Reduced ${d.relativeDocumentPath} to defintions: ${a} tokens, ${r.tokenBudget} budget`),a<=r.tokenBudget)return{input:s.map(({input:g,hunks:v})=>({input:g,hunks:v}))}}if(c.info(`Still too large: ${a} tokens, ${r.tokenBudget} budget, ${s.length} inputs`),s.length>1){let l=new Error("Split prompt.");throw l.code="split_input",l}return{input:s.map(({input:l,hunks:d})=>({input:l,hunks:d}))}}render(r,n){let o=r.input.filter(a=>a.hunks.length>0);if(!o.length)return;let s=o.map(({input:a,hunks:c})=>({uri:a.document.uri,version:a.document.version,ranges:c.map(u=>u.range)}));return vscpp(vscppf,null,vscpp("usedContext",{value:s}),vscpp(Aae.UserMessage,{priority:this.props.priority},o.map(a=>vscpp(vscppf,null,a.input.change?vscpp(vscppf,null,"Change at cursor:",vscpp("br",null),vscpp("br",null),"Changes are indicated by lines starting with + and -. Each line is annotated with the line number in the file.",vscpp("br",null)):vscpp(vscppf,null,"Current selection with the selected lines labeled as such:",vscpp("br",null)),vscpp("br",null),"From the file: ",a.input.relativeDocumentPath,vscpp("br",null),a.hunks.map(c=>vscpp(W0,{uri:a.input.document.uri,range:c.range,code:c.text,languageId:`${a.input.document.languageId}/${a.input.relativeDocumentPath}: FROM_LINE: ${c.range.start.line+1} - TO_LINE: ${c.range.end.line}`})),vscpp("br",null),vscpp("br",null)))))}static async getCurrentChanges(r,n){let o=r.getExtensionApi();return o?(await Promise.all(o.repositories.map(async a=>{let c=await(n==="index"?a.diffIndexWithHEAD():a.diffWithHEAD());return await Promise.all(c.map(async l=>{let d=await(n==="index"?a.diffIndexWithHEAD(l.uri.fsPath):a.diffWithHEAD(l.uri.fsPath));return{repository:a,uri:l.uri,hunks:Qr.parseDiff(d).map(p=>Qr.gitHunkToHunk(p))}}))}))).flat():[]}static async getCurrentChange(r,n,o){let a=r.get(es).getExtensionApi();if(!a)return;let c=a.getRepository(n.uri);if(!c)return;let u=await c.diffWithHEAD(n.uri.fsPath);if(!u)return;let d=Qr.parseDiff(u).find(p=>p.additions.some(f=>{let m=f.start-1,h=m+f.length-1;return o.line>=m&&o.line<=h}));if(d)return{repository:c,uri:n.uri,hunks:[Qr.gitHunkToHunk(d)]}}static async getChanges(r,n,o,s){let c=r.get(es).getExtensionApi();if(!c)return;let u=Qr.parseDiff(s),l=c.repositories.find(d=>d.rootUri.toString().toLowerCase()===n.toString().toLowerCase());if(l)return{repository:l,uri:o,hunks:u.map(d=>Qr.gitHunkToHunk(d))}}static gitHunkToHunk(r){return{range:new Ge(r.startAddedLine-1,0,r.startAddedLine-1+r.addedLines,0),text:r.diffText}}static parseDiff(r){let n=r.split(`
@@`);return n.length&&n[n.length-1].endsWith(`
`)&&(n[n.length-1]=n[n.length-1].slice(0,-1)),n.map(s=>{let a=s.match(/-(\d+)(?:,(\d+))? \+(\d+)(?:,(\d+))?/);if(a){let c=parseInt(a[1]),u=a[2]?parseInt(a[2]):1,l=parseInt(a[3]),d=a[4]?parseInt(a[4]):1,p=[],f=s.split(`
`).slice(1),m=0,h;for(let g of f){let v=g.charAt(0);v==="+"?(h===void 0&&(h=l+m),m++):(h!==void 0&&(p.push({start:h,length:l+m-h}),h=void 0),v===" "&&m++)}return h!==void 0&&(p.push({start:h,length:l+m-h}),h=void 0),c===0&&(c=1),l===0&&(l=1),{startDeletedLine:c,deletedLines:u,startAddedLine:l,addedLines:d,additions:p,diffText:f.join(`
`)}}return null}).filter(Boolean)}static enumeratedLines(r,n,o){return r.getText(new Ge(n,0,o,0)).split(`
`).map((c,u)=>`/* Line ${n+u+1} */${c}`).join(`
`)}static enumeratedSelectedLines(r,n,o,s,a){return r.getText(new Ge(n,0,o,0)).split(`
`).map((l,d)=>{let p=n+d;return`/* ${s<=p&&p<a?"Selected ":""}Line ${p+1} */${l}`}).join(`
`)}static enumeratedChangeLines(r,n){let o=0;return r.split(`
`).filter(a=>a[0]!=="-").map((a,c)=>{let u=a.substring(0,1),l=u==="-";return l&&o++,`${u}/* ${l?"Removed Line":`Line ${n+c-o+1}`} */${a.substring(1)}`}).join(`
`)}};Qr=O([x(1,je),x(2,De),x(3,dr)],Qr);var $x=class extends Q{render(e,r){return vscpp(vscppf,null,vscpp(Dae.SystemMessage,{priority:1001},"You are a world-class software engineer and the author and maintainer of the discussed code. Your feedback prefectly combines detailed feedback and explanation of context.",vscpp("br",null),vscpp(Hr,null),vscpp(Zt,null),vscpp(Di,null),vscpp(cr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Examine the provided code and any other context like user question, related errors, project details, class definitions, etc.",vscpp("br",null),"2. Provide feedback on the current ",this.props.input[0]?.change?vscpp(vscppf,null,"change"):vscpp(vscppf,null,"selection")," on where it can be improved or introduces a problem.",vscpp("br",null),"2a. Avoid commenting on correct code.",vscpp("br",null),"2b. Avoid commenting on commented out code.",vscpp("br",null),"2c. Keep scoping rules in mind.",vscpp("br",null),"3. Reply with an enumerated list of feedback with source line number, filepath, kind (bug, performance, consistency, documentation, other), severity (low, medium, high), and feedback text.",vscpp("br",null),"3a. E.g.: 1. Line 357 in src/flow.js, bug, high severity: `i` is not incremented.",vscpp("br",null),"3b. E.g.: 2. Line 361 in src/arrays.js, documentation, low severity: Function `binarySearch` is not documented.",vscpp("br",null),"3c. E.g.: 3. Line 376 in src/binary-search.js, documentation, medium severity: Function `binarySearch` assumes that the input array `arr` is sorted. This assumption should be documented or checked.",vscpp("br",null),"3d. E.g.: 4. Line 410 in src/search.js, documentation, medium severity: Returning `-1` when the target is not found is a common convention, but it should be documented.",vscpp("br",null),"3e. E.g.: 5. Line 220 in src/account.py, bug, high severity: The deposit method is not thread-safe. You should use a lock to ensure that the balance update is an atomic operation.",vscpp("br",null),'4. When there is no feedback to provide, reply with "No feedback to provide."',vscpp("br",null),vscpp("br",null),"Focus on being clear, helpful, and thorough.",vscpp("br",null),"Use developer-friendly terms and analogies in your explanations.",vscpp("br",null),"Provide clear and relevant examples when helpful."),vscpp(Mo,{flexGrow:1,priority:700}),vscpp(Qr,{input:this.props.input,logService:this.props.logService,priority:1e3,flexGrow:2}),this.props.input.map(n=>vscpp(tu,{document:n.document,range:n.selection,priority:800})),this.props.chatVariables&&this.props.query&&vscpp(Kr,{flexGrow:3,priority:900,chatVariables:this.props.chatVariables,query:this.props.query}))}};var vc=class{constructor(e,r,n,o){this.outputChannelProvider=e;this.configurationService=n;this.notebookLoggingService=o;this.requestCount=-1;this.logger=r.getPromptResponseLogger("chat")}logRequest(e){this.requestCount++,this.logInfo("REQUEST",`User:${this.headerSeparator()}${this.printMessageContent(e.message)}`)}logMessages(e){this.logInfo("PROMPT MESSAGES",e.map(r=>`${this.getDisplayName(r)}:${this.headerSeparator()}${this.printMessageContent(r.content)}`).join(`
`)),this.notebookLoggingService.logMessages(e)}logProgress(e,r){if(e instanceof Qi){let n=typeof e.value=="string"?e.value:e.value.value;n&&(r?this.logInfo("RESPONSE",`Assistant:	${n}`,!1):this.logInfo("",`${n.replaceAll(/\r?\n/g,`
`+this.bodySeparator())}`,!1))}this.notebookLoggingService.logProgress(e)}logResponse(e){this.logInfo("",""),e.errorDetails&&this.logInfo("ERROR DETAILS",JSON.stringify(e.errorDetails,void 0,4)),this.notebookLoggingService.logResult(e)}logFollowups(e){this.logInfo("FOLLOWUPS","Followups:	"+e.map((r,n)=>`${r.label??r.prompt}
${this.bodySeparator()}`).join(`
${this.bodySeparator()}`))}logThrownError(e){this.logInfo("THROWN ERROR",e.stack?e.stack:e.message)}logIntent(e,r){this.logInfo("INTENT",e!==void 0?`User intent determined to be '${e}' via the ${r?"user":"model"}`:"Intent could not be determined")}logInfo(e,r,n=!0){if(!this.configurationService.getConfig(fe.ConversationLoggingEnabled))return;let o=new Date().toISOString();e&&(r=`[${e} ${this.requestCount}]
${r}`,r=`${o} [info] ${r}`),vc.outputChannel===void 0&&(vc.outputChannel=this.outputChannelProvider()),n?(this.logger.info(r+`
`),vc.outputChannel.appendLine(r+`
`)):(this.logger.info(r),vc.outputChannel.append(r))}printMessageContent(e){return e.split(`
`).join(`
${this.bodySeparator()}`)}headerSeparator(){return"		"}bodySeparator(){return"			"}getDisplayName(e){let r=this.getDisplayRole(e.role),n=e.name;return n?`${r} (${n})`:r}getDisplayRole(e){switch(e){case"system":return"System";case"user":return"User";case"assistant":return"Assistant";case"function":return"Function"}}};vc=O([x(1,ue),x(2,ye),x(3,rh)],vc);var kL=class{constructor(e,r){this.originalText=e;this._combinedEditsSinceStart=Wr.empty;this._text=r.apply(this.originalText),this._textAfterTrackedEdits=this._text,this._originalEdits=r}handleEdits(e){let r=e.apply(this._text),n=this._combinedEditsSinceStart.compose(e);n=n.removeCommonSuffixPrefix(this._textAfterTrackedEdits),this._combinedEditsSinceStart=n,this._text=r}computeTrackedEditsSurvivalScore(){let e=0,r=0,n=0,o=0,s=this._originalEdits.getNewTextRanges(),a=N6e(s,this._combinedEditsSinceStart);for(let c=0;c<s.length;c++){let u=this._originalEdits.edits[c],l=this.originalText.substring(u.replaceRange.start,u.replaceRange.endExclusive),d=u.newText,p=a[c],f=this._text.substring(p.start,p.endExclusive),m=Gw(f,d),h=Gw(d,l),g=Gw(f,l);if(h!==1){let b=1-Math.max(g-h,0)/(1-h);n+=u.replaceRange.length*b,o+=u.replaceRange.length}let v=u.newText.length*m,y=u.newText.length;e+=v,r+=y}return{fourGram:r===0?1:e/r,noRevert:o===0?1:n/o}}};function Gw(t,e){if(t.length<4||e.length<4)return t===e?1:0;let n=new Map;for(let c=0;c<=t.length-4;c++){let u=t.substring(c,c+4),l=n.get(u)||0;n.set(u,l+1)}for(let c=0;c<=e.length-4;c++){let u=e.substring(c,c+4),l=n.get(u)||0;n.set(u,l-1)}let o=t.length-4+1+e.length-4+1,s=0;for(let c of n.values())s+=Math.abs(c);return(o-s)/o}function N6e(t,e){t=t.slice();let r=[],n=0;for(let o of e.edits){for(;;){let a=t[0];if(!a||a.endExclusive>=o.replaceRange.start)break;t.shift(),r.push(a.delta(n))}let s=[];for(;;){let a=t[0];if(!a||!a.intersectsOrTouches(o.replaceRange))break;t.shift(),s.push(a)}for(let a=s.length-1;a>=0;a--){let c=s[a],u=c.intersect(o.replaceRange).length;c=c.deltaEnd(-u+(a===0?o.newText.length:0));let l=c.start-o.replaceRange.start;l>0&&(c=c.delta(-l)),a!==0&&(c=c.delta(o.newText.length)),c=c.delta(-(o.newText.length-o.replaceRange.length)),t.unshift(c)}n+=o.newText.length-o.replaceRange.length}for(;;){let o=t[0];if(!o)break;t.shift(),r.push(o.delta(n))}return r}var Cd=class{constructor(e,r,n,o,s,a,c,u){this._document=e;this._originalDocumentText=r;this._edits=n;this._sendTelemetryEvent=s;this._gitService=c;this._telemetryService=u;this._editSurvivalTracker=new kL(this._originalDocumentText,this._edits);this._store=new Tt;this._store.add(a.onDidChangeTextDocument(l=>{if(l.document!==this._document)return;let d=Wr.from(l.contentChanges);this._editSurvivalTracker.handleEdits(d)})),this._editSurvivalTracker.handleEdits(o),this._initialBranchName=this._getCurrentBranchName(),this._reportAfter(30*1e3),this._reportAfter(120*1e3),this._reportAfter(300*1e3),this._reportAfter(600*1e3,()=>{this._store.dispose()})}_getCurrentBranchName(){return this._gitService.getRepository(this._document.uri)?.headBranchName}_reportAfter(e,r){let n=new oD(()=>{this._report(e),n.dispose(),r&&r()},e);this._store.add(n)}_report(e){let r=this._editSurvivalTracker.computeTrackedEditsSurvivalScore(),o=this._getCurrentBranchName()!==this._initialBranchName;this._sendTelemetryEvent({telemetryService:this._telemetryService,fourGram:r.fourGram,noRevert:r.noRevert,timeDelayMs:e,didBranchChange:o})}};Cd=O([x(5,Je),x(6,go),x(7,me)],Cd);function PL(t,e){return r=>{r.telemetryService.sendMSFTTelemetryEvent("inline.trackEditSurvival",t,{...e,survivalRateFourGram:r.fourGram,survivalRateNoRevert:r.noRevert,timeDelayMs:r.timeDelayMs,didBranchChange:r.didBranchChange?1:0})}}function zw(t,e){return{headerRequestId:t.headers.get("x-request-id")||"",completionId:e&&e.id?e.id:"",created:e&&e.created?e.created:0,serverExperiments:t.headers.get("X-Copilot-Experiment")||"",deploymentId:t.headers.get("azureml-model-deployment")||""}}function Nae(t){let e=t.headers.get("openai-processing-ms");return e?parseInt(e,10):0}function Lae(t){if(typeof t!="object"||t===null||!("details"in t))return!1;let{details:e}=t;return typeof e=="object"&&e!==null&&"type"in e&&"description"in e&&typeof e.type=="string"&&typeof e.description=="string"}function Oae(t){if(typeof t!="object"||t===null||!("citations"in t))return!1;let{citations:e}=t;return typeof e=="object"&&e!==null&&"url"in e&&"license"in e&&typeof e.url=="string"&&typeof e.license=="string"}function Mae(t){return typeof t=="object"&&!!t&&"title"in t&&"excerpt"in t&&"url"in t}var Wn=class t{static{this.keysExemptedFromSanitization=["VSCode.ABExp.Features","abexp.assignmentcontext"]}constructor(e,r,n){this.properties=e,this.measurements=r,this.issuedTime=n}static createAndMarkAsIssued(e,r){return new t(e||{},r||{},Date.now())}extendedBy(e,r){let n={...this.properties,...e},o={...this.measurements,...r},s=new t(n,o,this.issuedTime);return s.displayedTime=this.displayedTime,s}markAsDisplayed(){this.displayedTime===void 0&&(this.displayedTime=Date.now())}extendWithEditorAgnosticFields(e){this.properties.editor_version=e.getEditorInfo().format(),this.properties.editor_plugin_version=e.getEditorPluginInfo().format(),this.properties.client_machineid=e.machineId,this.properties.client_sessionid=e.sessionId,this.properties.copilot_version=`copilot/${e.getVersion()}`,this.properties.common_extname=e.getEditorPluginInfo().name,this.properties.common_extversion=e.getEditorPluginInfo().version,this.properties.common_vscodeversion=e.getEditorInfo().format()}extendWithConfigProperties(e,r,n){let o=e.dumpConfig();o["copilot.build"]=r.getBuild(),o["copilot.buildType"]=r.getBuildType(),n.trackingId&&(o["copilot.trackingId"]=n.trackingId),n.organizationsList&&(o.organizations_list=n.organizationsList),this.properties={...this.properties,...o}}extendWithRequestId(e){let r={completionId:e.completionId,created:e.created.toString(),headerRequestId:e.headerRequestId,serverExperiments:e.serverExperiments,deploymentId:e.deploymentId};this.properties={...this.properties,...r}}static{this.keysToRemoveFromStandardTelemetryHack=["gitRepoHost","gitRepoName","gitRepoOwner","gitRepoUrl","gitRepoPath","repo","request_option_nwo","userKind"]}static maybeRemoveRepoInfoFromPropertiesHack(e,r){if(e)return r;let n={};for(let o in r)t.keysToRemoveFromStandardTelemetryHack.includes(o)||(n[o]=r[o]);return n}sanitizeKeys(){this.properties=t.sanitizeKeys(this.properties),this.measurements=t.sanitizeKeys(this.measurements)}static sanitizeKeys(e){e=e||{};let r={};for(let n in e){let o=t.keysExemptedFromSanitization.includes(n)?n:n.replace(/\./g,"_");r[o]=e[n]}return r}updateTimeSinceIssuedAndDisplayed(){let e=Date.now()-this.issuedTime;if(this.measurements.timeSinceIssuedMs=e,this.displayedTime!==void 0){let r=Date.now()-this.displayedTime;this.measurements.timeSinceDisplayedMs=r}}makeReadyForSending(e,r,n){this.extendWithConfigProperties(e,r,n),this.extendWithEditorAgnosticFields(r),this.sanitizeKeys(),this.updateTimeSinceIssuedAndDisplayed();for(let o in this.properties)this.properties[o]===void 0&&delete this.properties[o];L6e(r,this.properties)}};function Fae(t){if(!t)return;let e={};for(let r in t){let n=t[r];n&&(n.value?e[r]=n.value:e[r]=n)}return e}function L6e(t,e){e.unique_id=Br(),e.common_extname=t.getEditorPluginInfo().name,e.common_extversion=t.getEditorPluginInfo().version,e.common_vscodeversion=t.getEditorInfo().format()}function Wx(){let t=Br(),e=Wn.createAndMarkAsIssued({messageId:t});return new kH(e)}var kH=class t{constructor(e){this.raw=e}get properties(){return this.raw.properties}get measurements(){return this.raw.measurements}markAsDisplayed(){this.raw.markAsDisplayed()}extendedBy(e,r){let n=this.raw.extendedBy(e,r);return new t(n)}};function AL(t,e,r,n,o,s,a){let c=t.turns[t.turns.length-1].contextParts.map(d=>d.kind).sort(),u={source:"user",turnIndex:(t.turns.length-1).toString(),conversationId:e,uiKind:r,inputSources:c.join(",")},l={promptTokenLen:o,messageCharLen:n.length};return s&&(u.suggestion=s),a=a.extendedBy(u,l),a}function DL(t,e,r,n,o,s,a){o!==void 0&&(a=a.extendedBy({offTopic:o.toString()})),a=a.extendedBy({headerRequestId:r}),PH(t,s,e,n,{},{},a)}function NL(t,e,r,n,o,s,a,c){let u=AH(o);PH(t,a,n,o,{source:"model",turnIndex:e.turns.length.toString(),conversationId:r,headerRequestId:s,uiKind:n,codeBlockLanguages:JSON.stringify({...u})},{messageCharLen:o.length,numCodeBlocks:u.length},c)}function LL(t,e,r,n,o,s,a,c){PH(t,a,n,o,{source:"offTopic",turnIndex:e.turns.length.toString(),conversationId:r,userMessageId:s,uiKind:n},{messageCharLen:o.length},c)}function PH(t,e,r,n,o,s,a){let c={...n?{messageText:n}:{},...o};e&&(o.languageId=e.languageId,s.documentLength=e.getText().length);let u=a.extendedBy(o,s),l=a.extendedBy(c),d=O6e(r);return t.sendGHTelemetryEvent(`${d}.message`,u.raw.properties,u.raw.measurements),t.sendRestrictedGHTelemetryEvent(`${d}.messageText`,l.raw.properties,l.raw.measurements),u.raw}function OL(t,e,r,n,o){return bf(t,o,{suggestion:e,messageId:r,suggestionId:n},{},"conversation.suggestionShown")}function bf(t,e,r,n,o,s){let a=s??Wn.createAndMarkAsIssued();e&&(r.languageId=e.languageId,n.documentLength=e.getText().length);let c=a.extendedBy(r,n);return t.sendGHTelemetryEvent(o,c.properties,c.measurements),c}function O6e(t){switch(t){case"conversationInline":return"inlineConversation";case"conversationPanel":default:return"conversation"}}function AH(t){let e=t.split(`
`),r=[],n=[];for(let o=0;o<e.length;o++){let s=e[o];s.startsWith("```")&&(n.length>0&&s==="```"?r.push(n.pop()):n.length===0&&n.push(s.substring(3)))}return r}var DH=z(require("path")),Kx=class{constructor(e,r){this.telemetryService=e.get(me),this.options=e.get(Sn),this.endpointProvider=e.get(Le),this.fetcher=e.get(Bt),this.logService=e.get(ue),this.instantiationService=e.get(te),this.ignoreService=e.get(De),this.chatLogger=r&&this.instantiationService.createInstance(vc,()=>r())}async generateComments(e,r,n){let o=Date.now(),s=this.logService.getLogger("FeedbackGenerator"),a=this.ignoreService,c=await Promise.all(e.map(_=>a.isCopilotIgnored(_.document.uri))),u=e.filter((_,S)=>!c[S]);if(u.length===0)return s.info("All input documents are ignored. Skipping feedback generation."),{type:"error",severity:"info",reason:ML.t("All input documents are ignored by configuration. Check your .copilotignore file.")};let l=await this.endpointProvider.getChatEndpoint("gpt-4"),d=[],p=[u];for(;p.length;){let _=p.shift();try{let I=await $e.create(this.instantiationService,l,$x,{input:_,logService:this.logService}).render();s.info(`Rendered batch of ${_.length} inputs.`),d.push(I)}catch(S){if(S.code==="split_input"){let I=Math.floor(_.length/2);p.unshift(_.slice(0,I),_.slice(I)),s.info(`Splitting in batches of ${p[0].length} and ${p[1].length} inputs due to token limit.`)}else throw S}}if(r.isCancellationRequested)return{type:"cancelled"};let f=u[0]?.selection?"selection":"change";if(d.length>10)return{type:"error",reason:f==="selection"?ML.t("There is too much text to review, try reviewing a smaller selection."):ML.t("There are too many changes to review, try reviewing a smaller set of changes.")};let h={promptCount:d.length,messageId:Br(),inputType:f,inputRanges:u.map(_=>({uri:_.document.uri,ranges:_.selection?[_.selection]:_.change?.hunks.map(S=>S.range)||[]}))},g=Date.now(),v=await Promise.all(d.map(async _=>{this.chatLogger?.logMessages(_.messages);let S=[],I=n?async B=>{let j=$w(h,u,B,!0);j.length>S.length&&(n.report(j.slice(S.length)),S=j)}:void 0,T=await this.fetcher.fetchOne(_.messages,I,r,3,l,void 0,{temperature:this.options.temperature,top_p:this.options.topP},{messageId:h.messageId,messageSource:"command.generateFeedbackPrompt"});T.type==="success"?this.chatLogger?.logProgress(new Qi(T.value),!0):this.chatLogger?.logResponse({errorDetails:{message:T.reason}});let A=T.type==="success"?$w(h,u,T.value,!1):[];return n&&A&&A.length>S.length&&(n.report(A.slice(S.length)),S=A),{fetchResult:T,comments:A}})),y=v.find(_=>_.fetchResult.type!=="success")?.fetchResult||v[0].fetchResult,b=v.map(_=>_.comments).flat();return this.telemetryService.sendMSFTTelemetryEvent("feedback.generateDiagnostics",{model:l.model,requestId:y.requestId,responseType:y.type,messageId:h.messageId,documentType:u[0]&&$t(u[0]?.document.uri)?"notebook":"text",languageId:u[0]?.document.languageId,inputType:h.inputType,commentTypes:[...new Set(b?.map(_=>Bae.has(_.kind)?_.kind:"unknown")).values()].sort().join(",")||void 0},{promptCount:d.length,numberOfDiagnostics:b?.length??-1,inputDocumentCount:h.inputRanges.length,inputLineCount:h.inputRanges.reduce((_,S)=>_+S.ranges.reduce((I,T)=>I+(T.end.line-T.start.line),0),0),timeToRequest:g-o,timeToComplete:Date.now()-o}),r.isCancellationRequested?{type:"cancelled"}:y.type==="success"?{type:"success",comments:b||[]}:{type:"error",reason:y.reason}}},Bae=new Set(["bug","performance","consistency","documentation","other"]),M6e=new Set(["bug","performance","consistency"]);function $w(t,e,r,n=!1){let o=[];for(let s of NH(r,n)){let{relativeDocumentPath:a,from:c,to:u,kind:l,severity:d,content:p}=s;if(!M6e.has(l))continue;let f=a&&e.find(S=>S.relativeDocumentPath===a);if(!f)continue;let m=f.document,h=f.selection,g=m.lineAt(c>=0?c:0),v=m.lineAt((u<=m.lineCount?u:m.lineCount)-1),y=v.text.trimEnd().length,b=new Ge(g.lineNumber,g.firstNonWhitespaceCharacterIndex,v.lineNumber,y);if(h&&!b.intersection(h))continue;let _={request:t,document:m,uri:m.uri,languageId:m.languageId,range:b,body:new mo(p),kind:l,severity:d,originalIndex:o.length,actionCount:0};o.push(_)}return o}function NH(t,e=!1){let r=/(?<num>\d+)\. Line (?<from>\d+)(-(?<to>\d+))?([^:]*)( in `?(?<relativeDocumentPath>[^,:`]+))`?(, (?<kind>\w+))?(, (?<severity>\w+) severity)?: (?<content>.+?)((?=\n\d+\.|\n\n)|(?<earlyEnd>$))/gs;return Xt(Array.from(t.matchAll(r),n=>{let o=n.groups;if(e&&typeof o.earlyEnd=="string")return;let s=parseInt(o.from)-1,a=o.to?parseInt(o.to):s+1,c=o.relativeDocumentPath?.replaceAll(DH.default.sep==="/"?"\\":"/",DH.default.sep),u=o.kind||"other",l=o.severity||"unknown",d=o.content.trim();return{relativeDocumentPath:c,from:s,to:a,linkOffset:n.index+o.num.length+2,linkLength:5+o.from.length+(o.to?o.to.length+1:0),kind:u,severity:l,content:d}}))}function Uh(t,e,r,n,o,s){let a=n.getLogger("FeedbackGenerator");a.debug("user feedback received");let c=Array.isArray(t)?t:[t],u=c[0];if(!u){a.warn("No review comment found for user feedback");return}let l={messageId:u.request.messageId,userAction:r},d=Bae.has(u.kind)?u.kind:"unknown",p={requestId:u.request.messageId,documentType:$t(u.uri)?"notebook":"text",languageId:u.languageId,inputType:u.request.inputType,commentType:d,userAction:r},f={commentIndex:u.originalIndex,actionCount:u.actionCount,inputDocumentCount:u.request.inputRanges.length,inputLineCount:u.request.inputRanges.reduce((m,h)=>m+h.ranges.reduce((g,v)=>g+(v.end.line-v.start.line),0),0),promptCount:u.request.promptCount,totalComments:e,comments:c.length,commentLength:c.reduce((m,h)=>m+(typeof h.body=="string"?h.body.length:h.body.value.length),0)};if(r==="helpful"||r==="unhelpful"?(o.sendMSFTTelemetryEvent("review.comment.vote",p,f),o.sendInternalMSFTTelemetryEvent("review.comment.vote",p),bf(o,void 0,l,{},"review.comment.vote")):(u.actionCount++,o.sendMSFTTelemetryEvent("review.comment.action",p,f),o.sendInternalMSFTTelemetryEvent("review.comment.action",p),bf(o,void 0,l,{},"review.comment.action")),r==="discardComment"){let{document:m,range:h}=u,g=m.offsetAt(h.start),v=m.offsetAt(h.end),y=m.getText(h);s.createInstance(Cd,m,m.getText(),Wr.single(zt.ofStartAndLength(g,v-g),y),Wr.empty,F6e(p,f))}}function F6e(t,e){return r=>{r.telemetryService.sendMSFTTelemetryEvent("review.discardCommentRangeSurvival",t,{...e,survivalRateFourGram:r.fourGram,survivalRateNoRevert:r.noRevert,timeDelayMs:r.timeDelayMs,didBranchChange:r.didBranchChange?1:0})}}var Ww=z(require("path")),ti=z(require("vscode"));var yc=z(require("vscode")),Hae=z(require("path"));var U6e=10,B6e=5*60*1e3,q6e=10*1e3,FL=[],qae;function LH(){return qae||(qae=yc.window.createOutputChannel("GitHub Copilot Chat Conversation","log"))}function jae(t){let e=new Tt;if(!t.get(ye).getConfig(fe.FeedbackOnChange))return e;let n=t.get(vo).getDiagnosticCollection(),o=new Kx(t,LH);return e.add(yc.workspace.onDidChangeTextDocument(async s=>{if(s.document.uri.scheme==="file"&&s.contentChanges.length&&s.document===yc.window.activeTextEditor?.document){let a=t.get(ue).getLogger("FeedbackCollection");try{a.info("Document changed, delaying diagnostics request");let c=s.document.version;if(await new Promise(m=>setTimeout(m,q6e)),c!==s.document.version){a.info("Skipping diagnostics request because the document has changed");return}let u=Date.now(),l=u-B6e;if(FL=FL.filter(m=>m>l),FL.length>=U6e){a.info("Max requests reached, skipping diagnostics request");return}FL.push(u),a.info("Requesting diagnostics");let d=yc.window.activeTextEditor?.selection,p=await Qr.getCurrentChange(t,s.document,d.start);if(!p)return a.info("No change found in the current document at the current position."),[];let f=await o.generateComments([{document:s.document,relativeDocumentPath:Hae.basename(s.document.uri.fsPath),change:p,selection:d}],new yc.CancellationTokenSource().token);if(f.type==="success"){let m=f.comments.map(h=>new yc.Diagnostic(h.range,typeof h.body=="string"?h.body:h.body.value,yc.DiagnosticSeverity.Information));n.set(s.document.uri,m)}}catch(c){a.info("Error generating diagnostics",c?.stack||c?.message||String(c))}}})),e.add(yc.workspace.onDidCloseTextDocument(s=>{n.set(s.uri,void 0)})),e}function H6e(t,e){let r=new ac,n=t.onCancellationRequested(()=>{r.cancel(),s()}),o=e.onCancellationRequested(()=>{r.cancel(),s()});function s(){n.dispose(),o.dispose()}return r.token}async function Yx(t,e,r){let n=ti.window.activeTextEditor,o=n?.selection;if(e==="selection"){if(!n)return;if(!o||o.isEmpty){let a=await t.get(nh).selectEnclosingScope(n,{reason:ti.l10n.t("Select an enclosing range to review"),includeBlocks:!0});if(!a)return;o=a}}let s=e==="selection"?ti.l10n.t("Reviewing selected code in {0}...",Ww.default.posix.basename(n.document.uri.path)):e==="index"?ti.l10n.t("Reviewing staged changes..."):e==="workingTree"?ti.l10n.t("Reviewing unstaged changes..."):ti.l10n.t("Reviewing changes...");return ti.window.withProgress({location:ti.ProgressLocation.Notification,title:s,cancellable:!0},async(a,c)=>{let u=t.get(vo),l=new Kx(t,LH);u.removeReviewComments(u.getReviewComments());let d=[];if(e==="index"||e==="workingTree"){let m=await Qr.getCurrentChanges(t.get(es),e);(await Promise.all(m.map(async g=>{try{return{document:await ti.workspace.openTextDocument(g.uri),relativeDocumentPath:Ww.default.relative(g.repository.rootUri.fsPath,g.uri.fsPath),change:g}}catch(v){try{if((await ti.workspace.fs.stat(g.uri)).type===ti.FileType.File)throw v;return}catch(y){if(y.code==="FileNotFound")return;throw v}}}))).map(g=>{g&&d.push(g)})}else if(e==="selection")d.push({document:n.document,relativeDocumentPath:Ww.default.basename(n.document.uri.fsPath),selection:n.selection});else for(let m of e.patches){let h=dt.parse(m.fileUri);d.push({document:await ti.workspace.openTextDocument(h),relativeDocumentPath:Ww.default.relative(e.repositoryRoot,h.fsPath),change:await Qr.getChanges(t,dt.file(e.repositoryRoot),h,m.patch)})}let p=r?H6e(r,c):c,f=await l.generateComments(d,p,{report:m=>u.addReviewComments(m)});if(f.type==="error"){let m=ti.l10n.t("Show Log");await ti.window.showInformationMessage(f.severity==="info"?ti.l10n.t("Reviewing your code did not provide any feedback."):ti.l10n.t("Code review generation failed."),{modal:!0,detail:f.reason},...f.severity==="info"?[]:[m])===m&&Kw.show()}else f.type==="success"&&f.comments.length===0&&await ti.window.showInformationMessage(ti.l10n.t("Reviewing your code did not provide any feedback."),{modal:!0});return f})}var un=z(require("vscode"));var Bh=class extends un.CodeAction{constructor(){super(...arguments);this.isAI=!0}},ry=class t{constructor(e){this.accessor=e}static{this.providedCodeActionKinds=[un.CodeActionKind.QuickFix]}static getSevereDiagnostics(e){let r=e.filter(n=>n.severity<=un.DiagnosticSeverity.Warning);return r.length===0?[]:r}static getDiagnosticsAsText(e){return e.map(r=>r.message).join(", ")}async provideCodeActions(e,r,n){if(!un.workspace.getConfiguration("github.copilot.editor").get("enableCodeActions")||await this.accessor.get(De).isCopilotIgnored(e.uri))return;let s=[],a=un.window.activeTextEditor;if(!a)return s;if(this.accessor.get(ye).getConfig(fe.ReviewContextMenu)&&!a.selection.isEmpty){let h=new Bh(un.l10n.t("Review using Copilot (Experimental)"),un.CodeActionKind.QuickFix);h.command={title:h.title,command:"github.copilot.interactiveEditor.review"},s.push(h)}let c=t.getSevereDiagnostics(n.diagnostics);if(c.length===0)return s;let u=c.map(h=>h.range).reduce((h,g)=>h.union(g)),l=new un.Selection(u.start,u.end),d=t.getDiagnosticsAsText(c),p=new Bh(un.l10n.t("Fix using Copilot"),un.CodeActionKind.QuickFix);p.diagnostics=c,p.command={title:p.title,command:"vscode.editorChat.start",arguments:[{autoSend:!0,message:`/fix ${d}`,position:u.start,initialSelection:l,initialRange:u}]};let f=new Bh(un.l10n.t("Explain using Copilot"),un.CodeActionKind.QuickFix);f.diagnostics=c;let m=`/explain ${d}`;return this.accessor.get(ye).getConfig(fe.ExplainIntentRefer)&&(m=`@${Vw} ${m}`),f.command={title:f.title,command:"github.copilot.chat.explain",arguments:[m]},s.push(p,f),s}},Yw=class{static{this.providedCodeActionKinds=[un.CodeActionKind.RefactorRewrite]}constructor(e){this.logger=e.get(ue).getLogger("RefactorsProvider"),this.telemetryService=e.get(me),this.parserService=e.get(mt),this.ignoreService=e.get(De)}async provideCodeActions(e,r,n){if(!un.workspace.getConfiguration("github.copilot.editor").get("enableCodeActions")||await this.ignoreService.isCopilotIgnored(e.uri))return;let s=this.provideGenerateUsingCopilotCodeAction(e,r),a=await this.provideDocumentUsingCopilotCodeAction(e,r),c=await this.provideTestUsingCopilotCodeAction(e,r);return Xt([a,s,c])}provideGenerateUsingCopilotCodeAction(e,r){let n;if(r.isEmpty){let s=e.lineAt(r.start.line).text;r.end.character===s.length&&/^\s*$/g.test(s)&&(n=un.l10n.t("Generate using Copilot"))}else{let s=e.getText(r);/^\s*$/g.test(s)||(n=un.l10n.t("Modify using Copilot"))}if(n===void 0)return;let o=new Bh(n,un.CodeActionKind.RefactorRewrite);return o.command={title:o.title,command:"vscode.editorChat.start",arguments:[{position:r.start,initialSelection:new un.Selection(r.start,r.end),initialRange:r}]},o}async provideDocumentUsingCopilotCodeAction(e,r){let n=e.offsetAt(r.start),o=e.offsetAt(r.end),s={startIndex:n,endIndex:o},a,c=this.parserService.getTreeSitterAST(e);if(c)try{a=await c.getDocumentableNodeIfOnIdentifier(s)}catch(p){this.logger.exception(p,"RefactorsProvider: getDocumentableNodeIfOnIdentifier failed"),this.telemetryService.sendGHTelemetryException(p,"RefactorsProvider: getDocumentableNodeIfOnIdentifier failed")}if(a===void 0)return;let u=un.l10n.t("Document using Copilot: {0}",a.identifier),l=new Bh(u,un.CodeActionKind.RefactorRewrite),d=a.nodeRange===void 0?void 0:new Ge(e.positionAt(a.nodeRange.startIndex),e.positionAt(a.nodeRange.endIndex));return l.command={title:u,command:"vscode.editorChat.start",arguments:[{autoSend:!0,message:"/doc",initialRange:d}]},l}async provideTestUsingCopilotCodeAction(e,r){let n=e.offsetAt(r.start),o=e.offsetAt(r.end),s={startIndex:n,endIndex:o},a,c=this.parserService.getTreeSitterAST(e);if(c)try{a=await c.getTestableNode(s)}catch(p){this.logger.exception(p,"RefactorsProvider: getTestableNode failed"),this.telemetryService.sendGHTelemetryException(p,"RefactorsProvider: getTestableNode failed")}if(a===void 0)return;let u=un.l10n.t("Test using Copilot: {0}",a.identifier),l=new Bh(u,un.CodeActionKind.RefactorRewrite),d=a.nodeRange===void 0?void 0:new Ge(e.positionAt(a.nodeRange.startIndex),e.positionAt(a.nodeRange.endIndex));return l.command={title:u,command:"vscode.editorChat.start",arguments:[{autoSend:!0,message:"/tests",initialRange:d}]},l}};var Vae=require("util"),qh=z(require("vscode"));var j6e="application/vnd.code.notebook.error",UL=class{constructor(e){this.accessor=e}async provideCellStatusBarItems(e,r){if(qh.workspace.getConfiguration("notebook").get("cellFailureDiagnostics"))return[];if(e.kind===qh.NotebookCellKind.Markup){let a=qh.workspace.getConfiguration("notebook.experimental").get("cellChat");if(!a)return[];let c=e.document.getText().trim();if(!a||c.length===0)return[];let u="Generate code from markdown content",l=c;return[{text:"$(sparkle)",alignment:qh.NotebookCellStatusBarAlignment.Left,priority:Number.MAX_SAFE_INTEGER-1,tooltip:u,command:{title:u,command:"notebook.cell.chat.start",arguments:[{index:e.index+1,input:l,autoSend:!0}]}}]}let o=e.outputs.flatMap(a=>a.items).find(a=>a.mime===j6e);if(!o)return[];let s;try{let a=new Vae.TextDecoder;if(s=JSON.parse(a.decode(o.data)),!s.name&&!s.message)return[];let c="Fix using Copilot",u=[s.name,s.message].filter(Boolean).join(": ").replace(/\s*\(\S+,\s*line\s*\d+\)/,"");return[{text:"$(sparkle)",alignment:qh.NotebookCellStatusBarAlignment.Left,priority:Number.MAX_SAFE_INTEGER-1,tooltip:c,command:{title:c,command:"vscode.editorChat.start",arguments:[{autoSend:!0,message:`/fix ${u}`}]}}]}catch(a){this.accessor.get(ue).defaultLogger.error(`Failed to parse error output ${a}`)}return[]}};var ece=z(Qt());var Xx=ae("ICustomInstructionsService"),Qx=class{constructor(e,r){this.configurationService=e;this.envService=r;this._openSettingsUri=Ur.from({scheme:this.envService.uriScheme,authority:"settings",path:`/${nd}.${fe.CustomUserInstructions.id}`})}_getUserSettingsInstructions(){return{name:"User Settings",content:this.configurationService.getConfig(fe.CustomUserInstructions),reference:this._openSettingsUri}}async fetchInstructions(){return[this._getUserSettingsInstructions()]}};Qx=O([x(0,ye),x(1,Rt)],Qx);var Jx=ae("IDiffService");var Hh=class extends Ct{constructor(r,n,o,s){super();this._initialText=r;this._document=n;this._workspaceService=o;this._diffService=s;this._additionalEdits=Wr.empty;this._documentText=this._document.getText();this._register(this._workspaceService.onDidChangeTextDocument(a=>{if(a.document.uri.toString()!==this._document.uri.toString())return;let c=Wr.from(a.contentChanges);this._additionalEdits=this._additionalEdits.compose(c)}))}async compute(){let r=await Wr.fromDiff(this._initialText,this._documentText,this._diffService);return{getEditsSinceInitial:()=>{if(this._store.isDisposed)throw new sn("EditComputer has been disposed");return r.compose(this._additionalEdits)}}}};Hh=O([x(2,Je),x(3,Jx)],Hh);var jh=class{constructor(e,r){this.initialText=e;this._diffService=r;this._document=new OH(e)}addEdits(e){let r=V6e(e,this._document);this._document.apply(r)}getText(){return this._document.getValue()}async getEdits(){let e=this.getText();return await Wr.fromDiff(this.initialText,e,this._diffService)}};jh=O([x(1,Jx)],jh);function V6e(t,e){return new Wr(t.map(r=>{let n=e.positionToOffset(r.range.start),o=e.positionToOffset(r.range.end);return new yo(new zt(n,o),r.newText)}))}var OH=class{constructor(e=""){this._converter=void 0;this._value="";this._value=e}getValue(){return this._value}apply(e){this._value=e.apply(this._value),this._converter=void 0}positionToOffset(e){return this._converter||(this._converter=new Zc(this._value)),this._converter.positionToOffset(new qr(e.line+1,e.character+1))}};var bo=ae("ILanguageDiagnosticService"),Zx=class{constructor(e){this._ignoreService=e}waitForNewDiagnostics(e,r,n=5e3){let o,s,a;return new Promise(c=>{o=r.onCancellationRequested(()=>c([])),a=setTimeout(()=>c(this.getDiagnostics(e)),n),s=this.onDidChangeDiagnostics(u=>{for(let l of u.uris)if(jT(l,e)){c(this.getDiagnostics(e));break}})}).finally(()=>{o.dispose(),s.dispose(),clearTimeout(a)})}};Zx=O([x(0,De)],Zx);function Gae(t){return t.map(e=>e.range).reduce((e,r)=>e.union(r))}function zae(t){return t.severity===$_.Error}function MH(t,e,r=[$_.Error,$_.Warning]){return t.find(n=>n.range.contains(e)&&r.includes(n.severity))}var Mi=new class{constructor(){this._descriptors=[]}registerIntent(t){this._descriptors.push(t)}getIntents(){return this._descriptors}};var Da=ae("IIntentService"),e1=class{constructor(e){this._instantiationService=e;this._intents=null}_getOrCreateIntents(){return this._intents||(this._intents=Mi.getIntents().map(e=>this._instantiationService.createInstance(e))),this._intents}get unknownIntent(){let r=this._getOrCreateIntents().find(n=>n.id==="unknown");if(!r)throw new Error("Unknown intent not found");return r}getIntents(e){return this._getOrCreateIntents().filter(n=>n.locations.includes(e))}getIntent(e,r){return this.getIntents(r).find(n=>n.id===e)}getIntentByFunctionName(e,r){return this.getIntents(r).find(n=>n.intentDetectionInput.functionName===e)}};e1=O([x(0,te)],e1);var Vh=ae("ICommandService"),t1=class{constructor(e){this.intentService=e}getCommands(e){return this.intentService.getIntents(e).filter(r=>!r.commandInfo||!r.commandInfo.hiddenFromUser).map(r=>({commandId:r.id,intent:r,details:r.description,locations:r.locations}))}getCommand(e,r){return this.getCommands(r).find(n=>n.commandId===e)}};t1=O([x(0,Da)],t1);var Qae=z(Qt());var n1=z(at());var r1=class extends Q{constructor(r,n,o,s,a){super(r);this._ignoreService=n;this._parserService=o;this._experimentationService=s;this._configurationService=a}async render(r,n){let o=this.props.documentContext,s=o.document,a=s.languageId;if($t(s.uri))throw Gr("InlineChatEditCodePrompt should not be used with a notebook!");if(a==="markdown")throw Gr("InlineChatEditCodePrompt should not be used with a markdown document!");if(await this._ignoreService.isCopilotIgnored(s.uri))return vscpp("ignoredFiles",{value:[s.uri]});let{query:u,history:l,chatVariables:d,customInstructions:p}=this.props.promptContext,f=await this._configurationService.getExperimentBasedConfig(fe.ProjectLabelsInline,this._experimentationService),h=(await Pa(this._parserService,s,o.fileIndentInfo,s.validateRange(o.wholeRange),n.endpoint.modelMaxPromptTokens/3)).splitAroundAdjustedSelection(),{codeAbove:g,codeSelected:v,codeBelow:y,hasCodeWithoutSelection:b}=h,_="$SELECTION_PLACEHOLDER$",S=`${g}${_}${y}`,I=h.createReplyInterpreter(ka.chain(T=>Zs(T,"`"+_+"`","selection"),T=>Zs(T,_,"selection")),1,h.replaceSelectionStreaming,vi.createCodeBlockClassifier(),T=>T.value.trim()!==_);return vscpp(vscppf,null,vscpp("meta",{value:new Fn(I)}),vscpp(n1.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class expert in programming, and especially good at ",a,".",vscpp("br",null),"Source code is always contained in ``` blocks.",vscpp("br",null),"The user needs help to modify some code.",vscpp("br",null),b&&vscpp(vscppf,null,"The user includes existing code and marks with ",_," where the selected code should go.",vscpp("br",null)),vscpp(Zt,null)),f&&vscpp(Mo,{priority:600}),vscpp(Lt,{priority:700,history:l}),vscpp(n1.UserMessage,{priority:725},vscpp(Yr,{customInstructions:p})),vscpp(Ts,{priority:750,chatVariables:d}),vscpp(n1.UserMessage,{priority:800},"I have the following code in a file called `",vscpp(Qs,{value:s.uri,mode:1}),"`:",b&&vscpp(vscppf,null,vscpp(Oe,{uri:s.uri,languageId:a,code:S,shouldTrim:!1}),vscpp("br",null)),b&&vscpp(vscppf,null,"The ",_," code is:",vscpp("br",null)),vscpp(Oe,{uri:s.uri,languageId:a,code:v,shouldTrim:!1})),vscpp(n1.UserMessage,{priority:900},vscpp(ws,{chatVariables:d,query:u}),vscpp("br",null),b&&vscpp(vscppf,null,"The modified ",_," code with ``` is:")))}};r1=O([x(1,De),x(2,mt),x(3,Ut),x(4,ye)],r1);var xf=z(at());var _f=z(at());var i1=class extends Q{constructor(r,n,o){super(r);this._ignoreService=n;this._parserService=o}async render(r,n){let o=this.props.documentContext,s=o.document,a=s.languageId;if($t(this.props.documentContext.document.uri))throw Gr("InlineChatGenerateMarkdownPrompt should not be used with a notebook!");if(a!=="markdown")throw Gr("InlineChatGenerateMarkdownPrompt should only be used with markdown documents!");if(await this._ignoreService.isCopilotIgnored(o.document.uri))return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let{query:u,history:l,chatVariables:d,customInstructions:p}=this.props.promptContext,m=(await Pa(this._parserService,o.document,o.fileIndentInfo,o.document.validateRange(o.wholeRange),n.endpoint.modelMaxPromptTokens/3)).splitAroundOriginalSelectionEnd(),{codeAbove:h,hasContent:g,codeBelow:v}=m,y="$PLACEHOLDER$",b=`${h}${y}${v}`,_=m.createReplyInterpreter(ka.chain(S=>Zs(S,"`"+y+"`","selection"),S=>Zs(S,y,"selection")),0,m.insertStreaming,vi.createFencedBlockClassifier(Rs.FenceSequence),S=>S.value.trim()!==y);return vscpp(vscppf,null,vscpp("meta",{value:new Fn(_)}),vscpp(_f.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class markdown editor, very well versed in programming.",vscpp("br",null),"The user needs help to write some new markdown.",vscpp("br",null),"The markdown is always delimited by ",Rs.FenceSequence,".",vscpp("br",null),g&&vscpp(vscppf,null,"The user includes existing markdown and marks with ",y," where the new code should go.",vscpp("br",null)),g&&vscpp(vscppf,null,'DO NOT include the text "',y,'" in your reply.',vscpp("br",null)),g&&vscpp(vscppf,null,"DO NOT repeat any markdown from the user in your reply.",vscpp("br",null)),!g&&vscpp(vscppf,null,"Your answer must begin and end with ",Rs.FenceSequence,vscpp("br",null)),vscpp(Zt,null)),vscpp(Lt,{priority:700,history:l}),vscpp(_f.UserMessage,{priority:725},vscpp(Yr,{customInstructions:p})),vscpp(Ts,{priority:750,chatVariables:d}),g&&vscpp(_f.UserMessage,{priority:800},"I have the following markdown in a file called `",vscpp(Qs,{value:s.uri,mode:1}),"`:",vscpp(Rs,{uri:s.uri,code:b})),!g&&vscpp(_f.UserMessage,{priority:800},"I am in an empty file `",vscpp(Qs,{value:s.uri,mode:1}),"`."),vscpp(_f.UserMessage,{priority:900},vscpp(ws,{chatVariables:d,query:u}),vscpp("br",null),g&&vscpp(vscppf,null,"Remember to start and end your answer with ",Rs.FenceSequence,". The markdown that would fit at ",y," is:")))}};i1=O([x(1,De),x(2,mt)],i1);var Rs=class t extends cf{static{this.FenceSequence="-+-+-+-+-+"}async render(e){if(this.props.uri?await this._ignoreService.isCopilotIgnored(this.props.uri):!1)return this._handleFoulPrompt();let n=t.FenceSequence,o=`${n}
${this.props.code}
${n}`;return vscpp(_f.TextChunk,null,o)}};var o1=class extends Q{constructor(r,n,o){super(r);this._ignoreService=n;this._parserService=o}async render(r,n){let o=this.props.documentContext,s=o.document,a=s.languageId;if($t(this.props.documentContext.document.uri))throw Gr("InlineChatEditMarkdownPrompt should not be used with a notebook!");if(a!=="markdown")throw Gr("InlineChatEditMarkdownPrompt should only be used with markdown documents!");if(await this._ignoreService.isCopilotIgnored(o.document.uri))return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let{query:u,history:l,chatVariables:d,customInstructions:p}=this.props.promptContext,m=(await Pa(this._parserService,o.document,o.fileIndentInfo,o.document.validateRange(o.wholeRange),n.endpoint.modelMaxPromptTokens/3)).splitAroundAdjustedSelection(),{codeAbove:h,codeSelected:g,codeBelow:v,hasCodeWithoutSelection:y}=m,b="$SELECTION_PLACEHOLDER$",_=`${h}${b}${v}`,S=m.createReplyInterpreter(ka.chain(I=>Zs(I,"`"+b+"`","selection"),I=>Zs(I,b,"selection")),0,m.replaceSelectionStreaming,vi.createFencedBlockClassifier(Rs.FenceSequence),I=>I.value.trim()!==b);return vscpp(vscppf,null,vscpp("meta",{value:new Fn(S)}),vscpp(xf.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class markdown editor, very well versed in programming.",vscpp("br",null),"The user needs help to modify some markdown content.",vscpp("br",null),"The markdown is always delimited by ",Rs.FenceSequence,".",vscpp("br",null),"Your answer must begin and end with ",Rs.FenceSequence,".",vscpp("br",null),vscpp(Zt,null)),vscpp(Lt,{priority:700,history:l}),vscpp(xf.UserMessage,{priority:725},vscpp(Yr,{customInstructions:p})),vscpp(Ts,{priority:750,chatVariables:d}),y&&vscpp(vscppf,null,vscpp(xf.UserMessage,{priority:750},"For context, I have the following markdown in a file called `",vscpp(Qs,{value:s.uri,mode:1}),"`:",vscpp(Rs,{uri:s.uri,code:_}),vscpp("br",null)),vscpp(xf.UserMessage,{priority:800},"I need your help with the following content:",vscpp("br",null),vscpp(Rs,{uri:s.uri,code:g})),vscpp(xf.UserMessage,{priority:900},vscpp(ws,{chatVariables:d,query:u}),vscpp("br",null),"The rewritten markdown content from my last message wrapped with ",Rs.FenceSequence," is:")),!y&&vscpp(vscppf,null,vscpp(xf.UserMessage,{priority:800},"I have the following markdown in a file called `",vscpp(Qs,{value:s.uri,mode:1}),"`:",vscpp(Rs,{uri:s.uri,code:g})),vscpp(xf.UserMessage,{priority:900},vscpp(ws,{chatVariables:d,query:u}),vscpp("br",null),"The rewritten markdown content wrapped with ",Rs.FenceSequence," is:")))}};o1=O([x(1,De),x(2,mt)],o1);var bc=z(at());var s1=ae("INotebookService");function Gh(t){return $t(t)?t.path.endsWith(".ipynb"):!1}function $ae(t,e){return t.notebookDocuments.find(n=>n.uri.fsPath===e.fsPath)?.notebookType}var FH={core:1e3,context:800,runtimeCore:600,history:500,other:100};var p1=z(at());var ns=z(at());function Wae(t,e,r,n,o,s){if(r.start.line!==r.end.line&&r.end.character===0){let p=t.lineAt(r.end.line-1);r=new Ge(r.start,new $n(r.end.line-1,p.text.length))}else if(e.end.character===0&&e.end.line!==e.start.line&&(r.start.line===e.start.line&&r.start.character===0&&r.end.line===e.end.line&&r.end.character===t.lineAt(r.end.line).text.length||r.isEqual(e))){let p=t.lineAt(r.end.line-1);r=new Ge(r.start,new $n(r.end.line-1,p.text.length))}let a=new Es(s,t,o,"ed8c6549bwf9"),c=new Es(s,t,o,"abpxx6d04wxr"),u=new Es(s,t,o,"be15d9bcejpp"),l=()=>(c.trim(),a.trim(e),u.trim(),{language:o,above:c,range:a,below:u});for(let p=r.end.line;p>=r.start.line;p--)if(!a.prependLine(p))return l();let d={aboveLineIndex:r.start.line-1,belowLineIndex:r.end.line+1,minimumLineIndex:Math.max(0,n.start.line),maximumLineIndex:Math.min(t.lineCount-1,n.end.line)};return UH(d,c,u),l()}function UH(t,e,r){let n=t.aboveLineIndex,o=!0,s=t.belowLineIndex,a=!0;for(let c=0;c<100&&(o||a);c++)!o||a&&c%4===3?s<=t.maximumLineIndex&&r.appendLine(s)?s++:a=!1:n>=t.minimumLineIndex&&e.prependLine(n)?n--:o=!1;e.isComplete=n<t.minimumLineIndex,r.isComplete=s>t.maximumLineIndex}function Kae(t,e,r,n){let o=0,s="",a=r.endOffset,c="";for(let u of e)if(u.endIndex<r.startOffset)s+=t.substring(o,u.startIndex),s+=n,o=u.endIndex;else if(u.startIndex>r.endOffset)c+=t.substring(a,u.startIndex),c+=n,a=u.endIndex;else continue;return s+=t.substring(o,r.startOffset),c+=t.substring(a,t.length),{outlineAbove:s,outlineBelow:c}}function BL(t,e,r,n,o){let s={...n,aboveCells:[],belowCells:[]},a,c,u;if(r.document.uri.scheme==="vscode-notebook-cell"){a=e.notebookDocuments.find(S=>S.uri.fsPath===r.document.uri.fsPath&&S.getCells().find(I=>I.document===r.document));let _=a?.getCells().findIndex(S=>S.document===r.document);if(_===void 0||_===-1)return s;c=_-1,u=_+1}else{if(t.activeNotebookEditor?.notebook.uri.path!==r.document.uri.path)return s;let _=t.activeNotebookEditor;a=_?.notebook;let S=_.selection.start;c=S-1,u=S}if(!a)return s;let{language:l,above:d,range:p,below:f}=n,m=d.lines.length+p.lines.length+f.lines.length,h=[],g=[],v=()=>(h.forEach(_=>_.trim()),g.forEach(_=>_.trim()),{language:l,above:d,range:p,below:f,aboveCells:h,belowCells:g}),y=!0,b=!0;for(let _=m;_<100&&(y||b);_++)if(y)if(c>=0){let I=a.cellAt(c).document,T=new Es(o,I,Is(I),"CELL:"+I.uri.fragment);for(let A=0;A<I.lineCount;A++)T.appendLine(A);h.unshift(T),c--}else y=!1;else if(u<a.cellCount){let I=a.cellAt(u).document,T=new Es(o,I,Is(I),"CELL:"+I.uri.fragment);for(let A=0;A<I.lineCount;A++)T.appendLine(A);g.push(T),u++}else b=!1;return v()}var Sf=class extends Q{render(){return vscpp(vscppf,null,"```",this.props.language.languageId,vscpp("br",null),this.props.document&&vscpp(vscppf,null,wa.forDocument(this.props.language,this.props.document),vscpp("br",null)),this.props.code&&vscpp(vscppf,null,this.props.code,vscpp("br",null)),"```")}};var ea=class extends Q{render(){if(!this.props.codeRegion.hasContent)return;let e=[];return this.props.useMarkers&&e.push(this.props.codeRegion.startMarker),e.push(...this.props.codeRegion.lines),this.props.useMarkers&&e.push(this.props.codeRegion.endMarker),vscpp(Sf,{language:this.props.codeRegion.language,document:this.props.codeRegion.document,code:e.join(`
`)})}};var qL=class extends Q{constructor(r,n,o){super(r);this.tabsAndEditorsService=n;this.workspaceService=o}async prepare(){let{document:r,wholeRange:n}=this.props.documentContext;return{wholeRange:r.validateRange(n)}}render(r,n){if(!$t(this.props.documentContext.document.uri))throw Gr("InlineChatNotebookSelection should be used only with a notebook!");let{wholeRange:o}=r,s=HL(n.endpoint.modelMaxPromptTokens/3,this.props.documentContext,o,this.tabsAndEditorsService,this.workspaceService),a=this.props.documentContext.document,c=new ml(o,s),u=[{uri:a.uri,version:a.version,ranges:Xt([s.range.toRange(),s.above.toRange(),s.below.toRange()])}];return vscpp(vscppf,null,vscpp("usedContext",{value:u}),vscpp("meta",{value:c}),vscpp(Qw,{documentContext:this.props.documentContext,above:s.above,range:s.range,below:s.below,aboveCells:s.aboveCells,belowCells:s.belowCells}))}};qL=O([x(1,kt),x(2,Je)],qL);var Qw=class extends Q{render(e,r){if(!$t(this.props.documentContext.document.uri))throw Gr("InlineChatNotebookSelectionRenderer should be used only with a notebook!");let n=Gh(this.props.documentContext.document.uri),{below:o,above:s,range:a,aboveCells:c,belowCells:u}=this.props,l=c||[],d=u||[],p=this.props.documentContext.language,f=this.props.includeDelimeters??!1;return vscpp(vscppf,null,n?vscpp(vscppf,null,(l.length>0||d.length>0)&&vscpp(c1,{documentContext:this.props.documentContext,aboveCells:l,belowCells:d}),p.languageId==="markdown"?vscpp(jH,{cellIndex:l.length,selected:a,above:s,below:o,includeDelimeters:f}):vscpp(VH,{cellIndex:l.length,selected:a,above:s,below:o,includeDelimeters:f})):vscpp(vscppf,null,vscpp(zh,{documentContext:this.props.documentContext}),vscpp(a1,{documentContext:this.props.documentContext,aboveCells:l,belowCells:d}),p.languageId==="markdown"?vscpp(qH,{cellIndex:l.length,selected:a,above:s,below:o,includeDelimeters:f}):vscpp(HH,{cellIndex:l.length,selected:a,above:s,below:o,includeDelimeters:f})))}},Yae=[{viewType:"polyglot-notebook",exampleCells:[{lan:"markdown",source:"Samples"},{lan:"csharp",source:"using Microsoft.Data.Analysis;"},{lan:"csharp",source:`DateTimeDataFrameColumn dateTimes = new DateTimeDataFrameColumn("DateTimes");
 Int32DataFrameColumn ints = new Int32DataFrameColumn("Ints", 6);
 StringDataFrameColumn strings = new StringDataFrameColumn("Strings", 6);`},{lan:"csharp",source:'dateTimes.Append(DateTime.Parse("2019/01/01"));'}]},{viewType:"sql-notebook",exampleCells:[{lan:"sql",source:"SELECT * FROM users;"}]},{viewType:"node-notebook",exampleCells:[{lan:"javascript",source:'console.log("Hello World");'},{lan:"javascript",source:"const {display} = require('node-kernel');"},{lan:"markdown",source:"# Plain text output"},{lan:"javascript",source:"display.text('Hello World');"}]},{viewType:"sas-notebook",exampleCells:[{lan:"sas",source:"proc print data=sashelp.class; run;"},{lan:"sas",source:`data race;
pr = probnorm(-15/sqrt(325));
run;

proc print data=race;
var pr;
run;
`}]},{viewType:"http-notebook",exampleCells:[{lan:"http",source:"GET https://httpbin.org/get"},{lan:"http",source:"POST https://httpbin.org/post"}]},{viewType:"powerbi-notebook",exampleCells:[{lan:"markdown",source:"# Get Groups"},{lan:"powerbi-api",source:"GET /groups"},{lan:"powerbi-api",source:`%dax /groups/ccce57d1-10af-1234-1234-665f8bbd8458/datasets/51ba6d4b-1234-1234-8635-a7d743a5ea89
EVALUATE INFO.TABLES()
This`}]},{viewType:"wolfram-language-notebook",exampleCells:[{lan:"wolfram",source:"Plot[Sin[x], {x, 0, 2 Pi}]"}]},{viewType:"github-issues",exampleCells:[{lan:"github-issues",source:`$vscode=repo:microsoft/vscode
$milestone=milestone:"May 2020"`},{lan:"github-issues",source:"$vscode $milestone is:closed author:@me -assignee:@me label:bug -label:verified"},{lan:"github-issues",source:"$vscode assignee:@me is:open label:freeze-slow-crash-leak"}]},{viewType:"rest-book",exampleCells:[{lan:"rest-book",source:"GET google.com"},{lan:"rest-book",source:`GET https://www.google.com
    ?query="fun"
    &page=2
    User-Agent: rest-book
    Content-Type: application/json`}]}],BH=class extends Q{render(){let e=this.props.viewType,r=Yae.find(o=>o.viewType===this.props.viewType);if(!r)return vscpp(vscppf,null);let{exampleCells:n}=r;return vscpp(ns.UserMessage,null,"Below you will find a set of example cells for a ",e," notebook.",vscpp("br",null),n.map((o,s)=>vscpp(vscppf,null,"CELL INDEX: ",s,":",vscpp("br",null),"```",o.lan,vscpp("br",null),o.source,vscpp("br",null),vscpp("br",null),"```")))}},zh=class extends Q{constructor(r,n,o){super(r);this.workspaceService=o}render(r,n){if(!$t(this.props.documentContext.document.uri))throw Gr("InlineChatCustomNotebookInfoRenderer should be used only with a notebook!");let o=$ae(this.workspaceService,this.props.documentContext.document.uri),s=Yae.find(c=>c.viewType===o),a=s?o:"custom";return vscpp(vscppf,null,vscpp(ns.UserMessage,null,"I am working on a ",a," notebook in VS Code.",vscpp("br",null),a," notebooks in VS Code are documents that contain a mix of rich Markdown, executable code snippets, ",vscpp("br",null),"and accompanying rich output. These are all separated into distinct cells and can be interleaved in any order ",vscpp("br",null),"A ",a," notebook contains multiple cells.",vscpp("br",null)),s&&vscpp(BH,{viewType:s.viewType}))}};zh=O([x(1,je),x(2,Je)],zh);var a1=class extends Q{render(e,r){if(!$t(this.props.documentContext.document.uri))throw Gr("InlineChatCustomNotebookCellsContextRenderer should be used only with a notebook!");let{aboveCells:n,belowCells:o,documentContext:s}=this.props,a=n||[],c=o||[],u=s.language;return vscpp(vscppf,null,(a.length>0||c.length>0)&&vscpp(ns.UserMessage,null,"The content of cells are listed below, each cell starts with CELL INDEX and a code block started with ```",u.languageId,vscpp("br",null),"Each cell is a block of code that can be executed independently.",vscpp("br",null),"Do not generate CELL INDEX in your answer, it is only used to help you understand the context.",vscpp("br",null),vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow the exmaples on how to avoid repeating code.",vscpp("br",null),a.length>0&&vscpp(u1,{cells:a,title:`Here are the cells in this custom notebook:
`}),c.length>0&&vscpp(u1,{cells:c,cellIndexDelta:a.length+1,title:`Here are the cells below the current cell that I am editing in this custom notebook:
`})))}},qH=class extends Q{render(){let e=this.props.includeDelimeters??(this.props.above.hasContent||this.props.below.hasContent);return vscpp(vscppf,null,vscpp(ns.UserMessage,null,"Now I create a new cell in this custom Notebook document at index ",this.props.cellIndex,".",vscpp("br",null),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),this.props.selected.hasContent?vscpp(vscppf,null,"I have the following content in the selection:",vscpp(ea,{codeRegion:this.props.selected,useMarkers:e})):vscpp(vscppf,null,"In this new cell, I am working with the following content:",vscpp(Sf,{language:this.props.selected.language,code:""}))),this.props.above.hasContent&&vscpp(ns.UserMessage,null,"In this new cell, I have the following markdown content above the selection:",vscpp(ea,{codeRegion:this.props.above,useMarkers:this.props.includeDelimeters})),this.props.below.hasContent&&vscpp(ns.UserMessage,null,"In this new cell, I have the following markdown content below the selection:",vscpp(ea,{codeRegion:this.props.below,useMarkers:this.props.includeDelimeters})))}},HH=class extends Q{render(){let e=this.props.includeDelimeters??(this.props.above.hasContent||this.props.below.hasContent);return vscpp(vscppf,null,vscpp(ns.UserMessage,null,"Now I create a new cell in this custom Notebook document at index ",this.props.cellIndex,".",vscpp("br",null),this.props.selected.hasContent?vscpp(vscppf,null,"I have the following code in the selection:",vscpp(ea,{codeRegion:this.props.selected,useMarkers:e})):vscpp(vscppf,null,"In this new cell, I am working with the following code:",vscpp(Sf,{language:this.props.selected.language,code:""}))),this.props.above.hasContent&&vscpp(ns.UserMessage,null,"In this new cell, I have the following code above the selection:",vscpp(ea,{codeRegion:this.props.above,useMarkers:this.props.includeDelimeters})),this.props.below.hasContent&&vscpp(ns.UserMessage,null,"In this new cell, I have the following code below the selection:",vscpp(ea,{codeRegion:this.props.below,useMarkers:this.props.includeDelimeters})))}},c1=class extends Q{render(e,r){if(!$t(this.props.documentContext.document.uri))throw Gr("InlineChatNotebookSelectionRenderer should be used only with a notebook!");let{aboveCells:n,belowCells:o}=this.props,s=this.props.documentContext.language;return vscpp(vscppf,null,(n.length>0||o.length>0)&&vscpp(ns.UserMessage,null,"I am working on a Jupyter notebook.",vscpp("br",null),"This Jupyter Notebook already contains multiple cells.",vscpp("br",null),"The content of cells are listed below, each cell starts with CELL INDEX and a code block started with ```",s.languageId,vscpp("br",null),"Each cell is a block of code that can be executed independently.",vscpp("br",null),"Since it is Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells as well.",vscpp("br",null),"For the same reason, if a variable is defined in a cell, it can be used in other cells as well.",vscpp("br",null),"We should not repeat the same import or variable definition in multiple cells, unless we want to overwrite the previous definition.",vscpp("br",null),"Do not generate CELL INDEX in your answer, it is only used to help you understand the context.",vscpp("br",null),vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow the exmaples on how to avoid repeating code.",vscpp("br",null),"## Examples starts here",vscpp("br",null),"Here are the cells in this Jupyter Notebook:",vscpp("br",null),"`CELL INDEX: 0",vscpp("br",null),"```python",vscpp("br",null),"import pandas as pd",vscpp("br",null),vscpp("br",null),"# create a dataframe with sample data",vscpp("br",null),"df = pd.DataFrame({'Name': ['Alice', 'Bob', 'Charlie'], 'Age': [25, 30, 35], 'Gender': ['F', 'M', 'M']})",vscpp("br",null),"print(df)",vscpp("br",null),"```",vscpp("br",null),"---------------------------------",vscpp("br",null),"USER:",vscpp("br",null),"Now I create a new cell in this Jupyter Notebook document at index 1.",vscpp("br",null),"In this new cell, I am working with the following code:",vscpp("br",null),"```python",vscpp("br",null),"```",vscpp("br",null),"---------------------------------",vscpp("br",null),"USER:",vscpp("br",null),"plot the data frame",vscpp("br",null),vscpp("br",null),"---------------------------------",vscpp("br",null),"ChatGPT Answer",vscpp("br",null),"---------------------------------",vscpp("br",null),"To plot the dataframe, we can use the `plot()` method of pandas dataframe. Here's the code:",vscpp("br",null),vscpp("br",null),"```python",vscpp("br",null),"df.plot(x='Name', y='Age', kind='bar')",vscpp("br",null),"```",vscpp("br",null),"## Example ends here",vscpp("br",null),n.length>0&&vscpp(u1,{cells:n,title:`Here are the cells in this Jupyter Notebook:
`}),o.length>0&&vscpp(u1,{cells:o,cellIndexDelta:n.length+1,title:`Here are the cells below the current cell that I am editing in this Jupyter Notebook:
`})))}},jH=class extends Q{render(){let e=this.props.includeDelimeters??(this.props.above.hasContent||this.props.below.hasContent);return vscpp(vscppf,null,vscpp(ns.UserMessage,null,"Now I create a new cell in this Jupyter Notebook document at index ",this.props.cellIndex,".",vscpp("br",null),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),this.props.selected.hasContent?vscpp(vscppf,null,"I have the following content in the selection:",vscpp(ea,{codeRegion:this.props.selected,useMarkers:e})):vscpp(vscppf,null,"In this new cell, I am working with the following content:",vscpp(Sf,{language:this.props.selected.language,code:""}))),this.props.above.hasContent&&vscpp(ns.UserMessage,null,"In this new cell, I have the following markdown content above the selection:",vscpp(ea,{codeRegion:this.props.above,useMarkers:this.props.includeDelimeters})),this.props.below.hasContent&&vscpp(ns.UserMessage,null,"In this new cell, I have the following markdown content below the selection:",vscpp(ea,{codeRegion:this.props.below,useMarkers:this.props.includeDelimeters})))}},VH=class extends Q{render(){let e=this.props.includeDelimeters??(this.props.above.hasContent||this.props.below.hasContent);return vscpp(vscppf,null,vscpp(ns.UserMessage,null,"Now I create a new cell in this Jupyter Notebook document at index ",this.props.cellIndex,".",vscpp("br",null),this.props.selected.hasContent?vscpp(vscppf,null,"I have the following code in the selection:",vscpp(ea,{codeRegion:this.props.selected,useMarkers:e})):vscpp(vscppf,null,"In this new cell, I am working with the following code:",vscpp(Sf,{language:this.props.selected.language,code:""}))),this.props.above.hasContent&&vscpp(ns.UserMessage,null,"In this new cell, I have the following code above the selection:",vscpp(ea,{codeRegion:this.props.above,useMarkers:this.props.includeDelimeters})),this.props.below.hasContent&&vscpp(ns.UserMessage,null,"In this new cell, I have the following code below the selection:",vscpp(ea,{codeRegion:this.props.below,useMarkers:this.props.includeDelimeters})))}},u1=class extends Q{render(){return vscpp(vscppf,null,this.props.title,vscpp("br",null),this.props.cells.map((e,r)=>vscpp(GH,{index:r+(this.props.cellIndexDelta??0),cell:e})))}},GH=class extends Q{render(){return vscpp(vscppf,null,"CELL INDEX: ",this.props.index,vscpp("br",null),"```",this.props.cell.language.languageId,vscpp("br",null),this.props.cell.lines.join(`
`),vscpp("br",null),"```")}};function HL(t,e,r,n,o){let s=t*4,a=new vd(s),c=Wae(e.document,e.selection,r,new Ge(0,0,e.document.lineCount,0),e.language,a);return BL(n,o,e,c,a)}var l1=class extends Q{constructor(r,n,o){super(r);this.tabsAndEditorsService=n;this.workspaceService=o}async prepare(){let{document:r,wholeRange:n}=this.props.documentContext;return{wholeRange:r.validateRange(n)}}render(r,n){if(!$t(this.props.documentContext.document.uri))throw Gr("InlineChatNotebookSelection should be used only with a notebook!");let{wholeRange:o}=r,s=HL(n.endpoint.modelMaxPromptTokens/3,this.props.documentContext,o,this.tabsAndEditorsService,this.workspaceService),a=this.props.documentContext.document,c=new ml(o,s),u=[{uri:a.uri,version:a.version,ranges:Xt([s.range.toRange(),s.above.toRange(),s.below.toRange()])}],l=Gh(this.props.documentContext.document.uri),{hasCodeWithoutSelection:d,codeWithoutSelection:p,codeSelected:f}=this.props,{aboveCells:m,belowCells:h}=s,g=m||[],v=h||[],y=this.props.documentContext.language,b=y.languageId==="markdown",_=d||f.length>0;return vscpp(vscppf,null,vscpp("usedContext",{value:u}),vscpp("meta",{value:c}),l?vscpp(vscppf,null,(g.length>0||v.length>0)&&vscpp(c1,{documentContext:this.props.documentContext,aboveCells:g,belowCells:v}),vscpp(p1.UserMessage,null,b?vscpp(vscppf,null,_&&vscpp(vscppf,null,"Now I edit a markdown cell in this Jupyter Notebook document at index ",g.length,".",vscpp("br",null)),!_&&vscpp(vscppf,null,"Now I create a new markdown cell in this Jupyter Notebook document at index ",g.length,".",vscpp("br",null)),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),d&&vscpp(vscppf,null,vscpp(Oe,{uri:a.uri,languageId:y.languageId,code:p,shouldTrim:!1}),vscpp("br",null)),d&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(Oe,{uri:a.uri,languageId:y.languageId,code:f,shouldTrim:!1})):vscpp(vscppf,null,_&&vscpp(vscppf,null,"Now I edit a cell in this Jupyter Notebook document at index ",g.length,".",vscpp("br",null)),!_&&vscpp(vscppf,null,"Now I create a new cell in this Jupyter Notebook document at index ",g.length,".",vscpp("br",null)),d&&vscpp(vscppf,null,vscpp(Oe,{uri:a.uri,languageId:y.languageId,code:p,shouldTrim:!1}),vscpp("br",null)),f.length>0&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(Oe,{uri:a.uri,languageId:y.languageId,code:f,shouldTrim:!1})))):vscpp(vscppf,null,vscpp(zh,{documentContext:this.props.documentContext}),vscpp(a1,{documentContext:this.props.documentContext,aboveCells:g,belowCells:v}),vscpp(p1.UserMessage,null,b?vscpp(vscppf,null,d&&vscpp(vscppf,null,"Now I edit a markdown cell in this custom Notebook document at index ",g.length,".",vscpp("br",null)),!d&&vscpp(vscppf,null,"Now I create a new markdown cell in this custom Notebook document at index ",g.length,".",vscpp("br",null)),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),d&&vscpp(vscppf,null,vscpp(Oe,{uri:a.uri,languageId:y.languageId,code:p,shouldTrim:!1}),vscpp("br",null)),d&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(Oe,{uri:a.uri,languageId:y.languageId,code:f,shouldTrim:!1})):vscpp(vscppf,null,d&&vscpp(vscppf,null,"Now I edit a cell in this custom Notebook document at index ",g.length,".",vscpp("br",null)),!d&&vscpp(vscppf,null,"Now I create a new cell in this custom Notebook document at index ",g.length,".",vscpp("br",null)),d&&vscpp(vscppf,null,vscpp(Oe,{uri:a.uri,languageId:y.languageId,code:p,shouldTrim:!1}),vscpp("br",null)),d&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(Oe,{uri:a.uri,languageId:y.languageId,code:f,shouldTrim:!1})))))}};l1=O([x(1,kt),x(2,Je)],l1);var d1=class extends Q{constructor(r,n,o,s,a,c){super(r);this.configurationService=n;this.notebookService=o;this.tabsAndEditorsService=s;this.experimentationService=a;this.workspaceService=c}async prepare(){let{document:r,wholeRange:n}=this.props.documentContext,o=await this.experimentationService.getTreatmentVariableAsync("vscode","copilotchat.notebookSummary",!1)||this.configurationService.getConfig(fe.NotebookSummaryExperimentEnabled),s;return o&&this.tabsAndEditorsService.activeNotebookEditor?.notebook&&this.tabsAndEditorsService.activeNotebookEditor?.notebook.uri.path===r.uri.path&&(s=this.notebookService.getCellExecutions(this.tabsAndEditorsService.activeNotebookEditor.notebook.uri)),{wholeRange:r.validateRange(n),executedCells:s}}render(r,n){if(!$t(this.props.documentContext.document.uri))throw Gr("InlineChatNotebookSelection should be used only with a notebook!");let{wholeRange:o}=r,s=HL(n.endpoint.modelMaxPromptTokens/3,this.props.documentContext,o,this.tabsAndEditorsService,this.workspaceService),a=this.props.documentContext.document,c=new ml(o,s),u=[{uri:a.uri,version:a.version,ranges:Xt([s.range.toRange(),s.above.toRange(),s.below.toRange()])}],l=Gh(this.props.documentContext.document.uri),{hasContent:d,code:p}=this.props,{aboveCells:f,belowCells:m}=s,h=f||[],g=m||[],v=this.props.documentContext.language,y=v.languageId==="markdown",b=r.executedCells||[];return vscpp(vscppf,null,vscpp("usedContext",{value:u}),vscpp("meta",{value:c}),l?vscpp(vscppf,null,b.length>0&&vscpp(zH,{documentContext:this.props.documentContext,executedCells:b}),b.length===0&&(h.length>0||g.length>0)&&vscpp(c1,{documentContext:this.props.documentContext,aboveCells:h,belowCells:g}),vscpp(p1.UserMessage,null,y?vscpp(vscppf,null,d&&vscpp(vscppf,null,"Now I edit a markdown cell in this Jupyter Notebook document at index ",h.length,".",vscpp("br",null)),!d&&vscpp(vscppf,null,"Now I create a new markdown cell in this Jupyter Notebook document at index ",h.length,".",vscpp("br",null)),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),d&&vscpp(vscppf,null,vscpp(Oe,{uri:a.uri,languageId:v.languageId,code:p,shouldTrim:!1}),vscpp("br",null))):vscpp(vscppf,null,d&&vscpp(vscppf,null,"Now I edit a cell in this Jupyter Notebook document at index ",h.length,".",vscpp("br",null)),!d&&vscpp(vscppf,null,"Now I create a new cell in this Jupyter Notebook document at index ",h.length,".",vscpp("br",null)),d&&vscpp(vscppf,null,vscpp(Oe,{uri:a.uri,languageId:v.languageId,code:p,shouldTrim:!1}),vscpp("br",null))))):vscpp(vscppf,null,vscpp(zh,{documentContext:this.props.documentContext}),vscpp(a1,{documentContext:this.props.documentContext,aboveCells:h,belowCells:g}),vscpp(p1.UserMessage,null,y?vscpp(vscppf,null,d&&vscpp(vscppf,null,"Now I edit a markdown cell in this custom Notebook document at index ",h.length,".",vscpp("br",null)),!d&&vscpp(vscppf,null,"Now I create a new markdown cell in this custom Notebook document at index ",h.length,".",vscpp("br",null)),"This is a markdown cell. Markdown cell is used to describe and document your workflow.",vscpp("br",null),d&&vscpp(vscppf,null,vscpp(Oe,{uri:a.uri,languageId:v.languageId,code:p,shouldTrim:!1}),vscpp("br",null))):vscpp(vscppf,null,d&&vscpp(vscppf,null,"Now I edit a cell in this custom Notebook document at index ",h.length,".",vscpp("br",null)),!d&&vscpp(vscppf,null,"Now I create a new cell in this custom Notebook document at index ",h.length,".",vscpp("br",null)),d&&vscpp(vscppf,null,vscpp(Oe,{uri:a.uri,languageId:v.languageId,code:p,shouldTrim:!1}),vscpp("br",null))))))}};d1=O([x(1,ye),x(2,s1),x(3,kt),x(4,Ut),x(5,Je)],d1);var zH=class extends Q{render(e,r){if(!$t(this.props.documentContext.document.uri))throw Gr("InlineChatJupyterNotebookCellSummaryContextRenderer should be used only with a notebook!");let n=this.props.documentContext.language,o=this.props.executedCells||[];return vscpp(vscppf,null,vscpp(p1.UserMessage,null,"I am working on a Jupyter notebook.",vscpp("br",null),"Users have executed the following cells in this notebook",vscpp("br",null),"Each cell contains a code block started with ```",n.languageId,vscpp("br",null),"Since it is Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells as well.",vscpp("br",null),"For the same reason, if a variable is defined in a cell, it can be used in other cells as well.",vscpp("br",null),"We should not repeat the same import or variable definition in multiple cells, unless we want to overwrite the previous definition.",vscpp("br",null),"Do not generate CELL INDEX in your answer, it is only used to help you understand the context.",vscpp("br",null),vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow the exmaples on how to avoid repeating code.",vscpp("br",null),"## Examples starts here",vscpp("br",null),"Here are the executed cells in this Jupyter Notebook:",vscpp("br",null),"```python",vscpp("br",null),"import pandas as pd",vscpp("br",null),vscpp("br",null),"df = pd.DataFrame({'Name': ['Alice', 'Bob', 'Charlie'], 'Age': [25, 30, 35], 'Gender': ['F', 'M', 'M']})",vscpp("br",null),"print(df)",vscpp("br",null),"```",vscpp("br",null),"---------------------------------",vscpp("br",null),"USER:",vscpp("br",null),"Now I create a new cell in this Jupyter Notebook document at index 1.",vscpp("br",null),"USER:",vscpp("br",null),"plot the data frame",vscpp("br",null),vscpp("br",null),"---------------------------------",vscpp("br",null),"ChatGPT Answer",vscpp("br",null),"---------------------------------",vscpp("br",null),"To plot the dataframe, we can use the `plot()` method of pandas dataframe. Here's the code:",vscpp("br",null),vscpp("br",null),"```python",vscpp("br",null),"df.plot(x='Name', y='Age', kind='bar')",vscpp("br",null),"```",vscpp("br",null),"## Example ends here",vscpp("br",null),o.map(s=>vscpp($H,{cell:s}))))}},$H=class extends Q{render(){return vscpp(vscppf,null,"```",this.props.cell.document.languageId,vscpp("br",null),this.props.cell.document.getText(),vscpp("br",null),"```")}};var f1=class extends Q{render(){let e=this.props.language;return vscpp(vscppf,null,"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),"The user has a ",e.languageId," file opened in a code editor.",vscpp("br",null),"The user includes some code snippets from the file.",vscpp("br",null),"Each code block starts with ``` and ",wa.forLanguage(e),".",vscpp("br",null),"Answer with a single ",e.languageId," code block.",vscpp("br",null),"If you modify existing code, you will use the ",Ra.begin(e)," and ",Ra.end(e)," markers.")}};var m1=class extends Q{constructor(r,n,o,s,a){super(r);this.tabsAndEditorsService=n;this.notebookService=o;this.experimentationService=s;this.configurationService=a}async prepare(){if(this.tabsAndEditorsService.activeNotebookEditor?.notebook.uri.path!==this.props.documentContext.document.uri.path)return{variables:[],packages:[]};let n=this.tabsAndEditorsService.activeNotebookEditor?.notebook;if(!n)return{variables:[],packages:[]};let o=await this.experimentationService.getTreatmentVariableAsync("vscode","copilotchat.notebookPackages",!1)||this.configurationService.getConfig(fe.NotebookPackagesExperimentEnabled),s=this.notebookService.getVariables(n.uri),a=o?Promise.resolve([]):this.notebookService.getPipPackages(n.uri),[c,u]=await Promise.all([s,a]);return{variables:c,packages:u}}render(r){let{priorities:n}=this.props;return vscpp(vscppf,null,r.variables.length!==0&&vscpp(vscppf,null,vscpp(bc.UserMessage,{priority:n.runtimeCore},"The following variables are present in this Jupyter Notebook:",r.variables.map(o=>vscpp(vscppf,null,vscpp(bc.TextChunk,null,"Name: ",o.variable.name,vscpp("br",null),o.variable.type&&vscpp(vscppf,null,"Type: ",o.variable.type),vscpp("br",null),"Value: ",o.variable.value,vscpp("br",null),o.indexedChildrenCount>0&&vscpp(vscppf,null,"Length: ",o.indexedChildrenCount),vscpp("br",null),o.variable.summary&&vscpp(vscppf,null,"Summary: ",o.variable.summary)))))),r.packages.length!==0&&vscpp(vscppf,null,vscpp(bc.UserMessage,{priority:n.other},"The following pip packages are available in this Jupyter Notebook:",r.packages.map(o=>vscpp(vscppf,null,vscpp(bc.TextChunk,null,o.name,"==",o.version),vscpp("br",null))))))}};m1=O([x(1,kt),x(2,s1),x(3,Ut),x(4,ye)],m1);var h1=class extends Q{constructor(r,n,o,s,a,c){super(r);this.experimentationService=o;this.configurationService=s;this.ignoreService=a;this.parserService=c}async prepare(r){let o=await this.experimentationService.getTreatmentVariableAsync("vscode","copilotchat.notebookPriorities",!1)||this.configurationService.getConfig(fe.NotebookPrioritiesExperimentEnabled)?FH:{},s=this.configurationService.getConfig(fe.NotebookAdditionalCodeGenerationRuleEnabled),{documentContext:a}=this.props,c=await this.ignoreService.isCopilotIgnored(a.document.uri),u=a.document.validateRange(a.wholeRange);return{summarizedDocument:await Pa(this.parserService,a.document,a.fileIndentInfo,u,r.endpoint.modelMaxPromptTokens/3),isIgnored:c,priorities:o,additionalCodeGenerationRule:s}}render(r,n){if(!$t(this.props.documentContext.document.uri))throw Gr("InlineChatNotebookBasePrompt should be used only with a notebook!");let{query:o,history:s,customInstructions:a}=this.props.promptContext,{language:c}=this.props.documentContext,u=c.languageId!=="markdown",l=Gh(this.props.documentContext.document.uri),d=r.summarizedDocument.splitAroundOriginalSelectionEnd(),{codeAbove:p,hasContent:f,codeBelow:m}=d,h=`${p}$PLACEHOLDER$${m}`,g=d.createReplyInterpreter(bd.Mute,u?1:0,n.endpoint.model==="gpt-4-0125-preview"?d.insertStreaming:d.insertOrReplaceStreaming,u?vi.createCodeBlockClassifier():vi.createAlwaysInsideCodeBlockClassifier(),b=>b.value.trim()!=="$PLACEHOLDER$"),v=r.priorities,y=r.additionalCodeGenerationRule??!1;return vscpp(vscppf,null,vscpp("meta",{value:new Fn(g)}),vscpp(bc.SystemMessage,{priority:v.core},vscpp(f1,{language:c}),vscpp("br",null),l&&vscpp(vscppf,null,"When dealing with Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells directly without importing it again. For the same reason, if a variable is defined in a cell, it can be used in other cells as well",vscpp("br",null),"When dealing with Jupyter Notebook, cells below the current cell can be executed before the current cell, you must use the variables defined in the cells below, unless you want to overwrite them.",vscpp("br",null),"When dealing with Jupyter Notebook, do not generate CELL INDEX in the code blocks in your answer, it is only used to help you understand the context.",vscpp("br",null),"If the Jupyter Notebook already contains variables, you should respect the name and value of the variables, and use them in your code when necessary.",vscpp("br",null)),f&&vscpp(vscppf,null,"The user includes existing code and marks with $PLACEHOLDER$ where the new code should go.",vscpp("br",null)),f&&vscpp(vscppf,null,'DO NOT include the text "$PLACEHOLDER$" in your reply.',vscpp("br",null)),f&&vscpp(vscppf,null,"DO NOT repeat any code from the user in your reply.",vscpp("br",null)),!f&&u&&vscpp(vscppf,null,"Your must generate a code block surrounded with ``` that will be used in a new file",vscpp("br",null)),!u&&vscpp(vscppf,null,"When generating content for markdown cell, provide the answer directly without any additional introductory text. Ensure that the response is structured in Markdown format to seamlessly integrate into the markdown file."),vscpp(Zt,null)),vscpp(Lt,{priority:v.history??700,history:s}),vscpp(bc.UserMessage,{priority:725},vscpp(Yr,{customInstructions:a})),vscpp(d1,{documentContext:this.props.documentContext,hasContent:f,code:h,priority:v.core}),vscpp(m1,{documentContext:this.props.documentContext,priorities:v,query:o}),vscpp(bc.UserMessage,{priority:v.core},y&&vscpp(vscppf,null,"Please generate code for: "),o,f&&u&&vscpp(vscppf,null,"The code that would fit at $PLACEHOLDER$ with ``` is:"),f&&!u&&vscpp(vscppf,null,"The code that would fit at $PLACEHOLDER$ without ``` is:")))}};h1=O([x(1,je),x(2,Ut),x(3,ye),x(4,De),x(5,mt)],h1);var g1=class extends Q{constructor(r,n,o,s,a,c){super(r);this.experimentationService=o;this.configurationService=s;this.ignoreService=a;this.parserService=c}async prepare(r){let o=await this.experimentationService.getTreatmentVariableAsync("vscode","copilotchat.notebookPriorities",!1)||this.configurationService.getConfig(fe.NotebookPrioritiesExperimentEnabled)?FH:{},s=this.configurationService.getConfig(fe.NotebookAdditionalCodeGenerationRuleEnabled),{documentContext:a}=this.props,c=await this.ignoreService.isCopilotIgnored(a.document.uri),u=a.document.validateRange(a.wholeRange);return{summarizedDocument:await Pa(this.parserService,a.document,a.fileIndentInfo,u,r.endpoint.modelMaxPromptTokens/3),isIgnored:c,priorities:o,additionalCodeGenerationRule:s}}render(r,n){if(!$t(this.props.documentContext.document.uri))throw Gr("InlineChatNotebookEditPrompt should be used only with a notebook!");if(r.isIgnored)return vscpp("ignoredFiles",{value:[this.props.documentContext.document.uri]});let{query:o,history:s,customInstructions:a}=this.props.promptContext,c=Gh(this.props.documentContext.document.uri),{language:u}=this.props.documentContext,l=u.languageId==="markdown",d=r.summarizedDocument.splitAroundAdjustedSelection(),{codeAbove:p,codeSelected:f,codeBelow:m,hasCodeWithoutSelection:h}=d,g=`${p}$SELECTION_PLACEHOLDER$${m}`,v=d.createReplyInterpreter(bd.Mute,1,d.replaceSelectionStreaming,vi.createCodeBlockClassifier(),_=>_.value.trim()!=="$SELECTION_PLACEHOLDER$"),y=r.priorities,b=r.additionalCodeGenerationRule??!1;return vscpp(vscppf,null,vscpp("meta",{value:new Fn(v)}),vscpp(bc.SystemMessage,{priority:y.core},vscpp(vscppf,null,"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"You are a world class expert in programming, and especially good at ",u.languageId,".",vscpp("br",null),"Source code is always contained in ``` blocks.",vscpp("br",null),"The user needs help to modify some code.",vscpp("br",null),h&&vscpp(vscppf,null,"The user includes existing code and marks with $SELECTION_PLACEHOLDER$ where the selected code should go.",vscpp("br",null))),c&&vscpp(vscppf,null,"When dealing with Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells directly without importing it again. For the same reason, if a variable is defined in a cell, it can be used in other cells as well",vscpp("br",null),"When dealing with Jupyter Notebook, cells below the current cell can be executed before the current cell, you must use the variables defined in the cells below, unless you want to overwrite them.",vscpp("br",null),"When dealing with Jupyter Notebook, do not generate CELL INDEX in the code blocks in your answer, it is only used to help you understand the context.",vscpp("br",null),"If the Jupyter Notebook already contains variables, you should respect the name and value of the variables, and use them in your code when necessary.",vscpp("br",null)),l&&vscpp(vscppf,null,"When generating content for markdown cell, provide the answer directly without any additional introductory text. Ensure that the response is structured in Markdown format to seamlessly integrate into the markdown file."),h&&vscpp(vscppf,null,"The user includes existing code and marks with $SELECTION_PLACEHOLDER$ where the selected code should go.",vscpp("br",null)),vscpp(Zt,null)),vscpp(l1,{documentContext:this.props.documentContext,hasCodeWithoutSelection:h,codeWithoutSelection:g,codeSelected:f,priority:y.core}),vscpp(Lt,{priority:y.history??700,history:s}),vscpp(bc.UserMessage,{priority:725},vscpp(Yr,{customInstructions:a})),vscpp(m1,{documentContext:this.props.documentContext,priority:y.core,priorities:y,query:o}),vscpp(bc.UserMessage,{priority:y.core},b&&vscpp(vscppf,null,"Please edit code for: "),o,vscpp("br",null),h&&l&&vscpp(vscppf,null,"The modified $SELECTION_PLACEHOLDER$ code without ``` is:"),h&&!l&&vscpp(vscppf,null,"The modified $SELECTION_PLACEHOLDER$ code with ``` is:")))}};g1=O([x(1,je),x(2,Ut),x(3,ye),x(4,De),x(5,mt)],g1);var Ed=class{constructor(e,r,n,o,s,a){this.intent=e;this.location=r;this.endpoint=n;this.documentContext=o;this.editStrategy=s;this.instantiationService=a;this.replyInterpreter=null}async buildPrompt(e,r,n){let o;$t(this.documentContext.document.uri)?o=this.editStrategy===4?h1:g1:this.documentContext.document.languageId==="markdown"?o=this.editStrategy===4?i1:o1:o=this.editStrategy===4?Px:r1;let s=$e.create(this.instantiationService,this.endpoint,o,{documentContext:this.documentContext,promptContext:e}),a=await s.render(r,n);return this.replyInterpreter=s.getMeta(Fn)?.replyInterpreter??null,a}processResponseInline(e,r,n){if(!this.replyInterpreter)throw new Error("Could not process response without a reply interpreter!");return this.replyInterpreter.processResponse(e,r,n)}};Ed=O([x(5,te)],Ed);var nu=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id=nu.ID;this.description=Qae.t("Make changes to existing code");this.locations=[1];this.commandInfo={hiddenFromUser:!0}}static{this.ID="edit"}get intentDetectionInput(){let e="edit_text";return{functionName:e,sampleQuestion:"Change this method to use async/await",modelDescription:"Make changes to existing code",functionCallingBlurb:`If the user's message appears related to refactoring or changing existing code, such as the code in the active selection, you should use the '${e}' function.`}}async invoke(e){let r=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),{location:n,documentContext:o}=e;if(!o)throw new Error("Open a file to add code.");return this.instantiationService.createInstance(Ed,this,n,r,o,2)}};nu=O([x(0,te),x(1,Le)],nu);var Xae=z(Qt());var iu=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id=iu.ID;this.description=Xae.t("Generate new code");this.locations=[1];this.commandInfo={hiddenFromUser:!0}}static{this.ID="generate"}get intentDetectionInput(){let e="generate_code_or_markdown";return{functionName:e,sampleQuestion:"Add a function that returns the sum of two numbers",modelDescription:"Generate new code",functionCallingBlurb:`If the user's message appears related to generating new code, you should use the '${e}' function.`}}async invoke(e){let r=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),{location:n,documentContext:o}=e;if(!o)throw new Error("Open a file to add code.");return this.instantiationService.createInstance(Ed,this,n,r,o,4)}};iu=O([x(0,te),x(1,Le)],iu);var jL=z(at());var ou=class extends Q{constructor(e,r){super(e),this.commandService=r.get(Vh)}async prepare(){let e=Object.entries(sx).reduce((r,[n,o])=>{let s=this.commandService.getCommand(n,this.props.location)?.intent?.description;r+=`
* ${s}`;for(let a of Object.values(o)){let c=this.commandService.getCommand(a,this.props.location)?.intent?.description;r+=`
* ${c}`}return r},"");return{modelName:G6e(this.props.endpoint.model),commandDescriptions:e}}render(e){return vscpp(vscppf,null,"You can answer general programming questions and perform the following tasks: ",e.commandDescriptions,vscpp("br",null),"You use the ",e.modelName," version of OpenAI's GPT models.")}};ou=O([x(1,je)],ou);function G6e(t){switch(t){case"code-llama":return"Code Llama";case"gpt-3.5-turbo":case"copilot-preview-gpt35-centralus":return"GPT 3.5 Turbo";case"gpt-4o-2024-05-13":return"GPT-4o";default:return"GPT-4 Turbo"}}var v1=class extends Q{constructor(r,n,o,s){super(r);this.envService=n;this.experimentationService=o;this._configurationService=s}async render(r,n){let{query:o,history:s,chatVariables:a,customInstructions:c}=this.props.promptContext,u=await this._configurationService.getExperimentBasedConfig(fe.ProjectLabelsChat,this.experimentationService),l=this.envService.OS,d=a.find(p=>p.originalName===Nr.variableInfo.name);return vscpp(vscppf,null,vscpp(jL.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),vscpp(Hr,null),vscpp(Zt,null),vscpp("br",null),vscpp(ou,{location:2,endpoint:this.props.endpoint}),vscpp("br",null),"First think step-by-step - describe your plan for what to build in pseudocode, written out in great detail.",vscpp("br",null),"Then output the code in a single code block.",vscpp("br",null),"Minimize any other prose.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The user is working on a ",l," machine. Please respond with system specific commands if applicable.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.",vscpp("br",null),vscpp(cr,null)),u&&vscpp(Mo,{flexGrow:1}),vscpp(Lt,{flexGrow:1,priority:700,history:s}),vscpp(jL.UserMessage,{flexGrow:1,priority:750},vscpp(Yr,{customInstructions:c})),!d&&vscpp(Nr,{flexGrow:1,document:this.props.documentContext?.document,range:this.props.documentContext?.selection,priority:800}),vscpp(Kr,{flexGrow:2,priority:900,chatVariables:a,query:o}))}};v1=O([x(1,Rt),x(2,Ut),x(3,ye)],v1);var $h=class extends Oo{constructor(r,n,o,s=v1,a,c){super(r,n,o);this.prompt=s;this.documentContext=a;this.instantiationService=c}createRenderer(r,n,o,s){return $e.create(this.instantiationService,n,this.prompt,{documentContext:this.documentContext,endpoint:n,promptContext:r})}};$h=O([x(5,te)],$h);var ta=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id=ta.ID;this.locations=[1,2];this.description="Intent of this command is unclear or is not related to information technologies";this.commandInfo={hiddenFromUser:!0};this.intentDetectionInput={sampleQuestion:"Add a dog to this comment."}}static{this.ID="unknown"}async invoke(e){let{location:r,documentContext:n}=e,o=await Mn(this.endpointProvider,r);if(r===1){if(!n)throw new Error("Open a file to add code.");return this.instantiationService.createInstance(Ed,this,r,o,n,2)}return this.instantiationService.createInstance($h,this,r,o,void 0,n)}};ta=O([x(0,te),x(1,Le)],ta);var Wh="_github.copilot.openRelativePath",y1="_github.copilot.openSymbolInFile",VL=[Wh,y1,"_github.copilot.openSymbolFromReferences"];function Td(t,e){return`command:${t}?${encodeURIComponent(JSON.stringify(e))}`}function GL(t,e,r){return`[${t}](${e} "${z6e(r)}")`}function z6e(t){return t.replace(/"/g,'\\"')}var b1=class{constructor(e,r){this.fileSystem=e;this.workspaceService=r}async linkify(e,r,n){let o=this.workspaceService.getWorkspaceFolders(),s=0,a=async(c,u,l)=>{if(/^[\w\-_]+:/.test(l)||!o.length||l.length<2)return c;for(let f of o){let m=Ur.joinPath(f,l);if(await this.exists(m))return s++,zL(l,m)}let d=KA(l),p=r.map(f=>"variableName"in f.anchor?qT(f.anchor.value)?f.anchor.value:f.anchor.value?.uri:qT(f.anchor)?f.anchor:f.anchor.uri).filter(f=>!!f).find(f=>zc(f)===d);return p?(s++,zL(l,p)):u};return e=await MT(e,/\[(`?)([^`\s]+)\1\]\((\2)\)/g,(c,u,l,d)=>a(c,l,d)),n?.isCancellationRequested?{text:e,addedLinkCount:0}:(e=await MT(e,/(?<!\[)(`([^`\s]+)`)(?!\])/g,a),{text:e,trustedCommands:[Wh],addedLinkCount:s})}async exists(e){try{return await this.fileSystem.stat(e),!0}catch{return!1}}};b1=O([x(0,zr),x(1,Je)],b1);function zL(t,e){return GL("`"+t+"`",Td(Wh,[WH(e)]),e.fsPath)}function WH(t){return{scheme:t.scheme,authority:t.authority,path:t.path,query:t.query,fragment:t.fragment}}var yl;(s=>{let t;(l=>(l[l.Default=0]="Default",l[l.CodeBlock=1]="CodeBlock",l[l.Accumulating=2]="Accumulating"))(t=s.Type||={});let e;(l=>(l[l.Word=0]="Word",l[l.InlineCode=1]="InlineCode",l[l.PotentialLink=2]="PotentialLink"))(e=s.AccumulationType||={}),s.Default={type:0};class n{constructor(c,u,l=""){this.fence=c;this.indent=u;this.contents=l;this.type=1}appendContents(c){return new n(this.fence,this.indent,this.contents+c)}}s.CodeBlock=n;class o{constructor(c,u=0){this.pendingText=c;this.accumulationType=u;this.type=2}}s.Accumulating=o})(yl||={});var $L=class{constructor(e,r=[]){this.references=e;this.linkifiers=r;this._state=yl.Default;this._appliedText="";this._totalAddedLinkCount=0}get totalAddedLinkCount(){return this._totalAddedLinkCount}async append(e,r){let n={text:"",trustedCommands:VL,addedLinkCount:0};for(let o of e.split(/(\s+)/))if(o.length)switch(this._state.type){case 0:{let s=o.match(/(^|\n)\s*(`{3,}|~{3,})/);if(s){let a=this._appliedText.match(/(\n|^)([ \t]*)$/);this._state=new yl.CodeBlock(s[2],a?.[2]??""),n=_1(n,this.doAppend(o))}else if(/\s/.test(o)){let a=await this.doLinkifyAndAppend(o,r);n=_1(n,a)}else if(/^\s*\[.+\]\(.+\)\s*/.test(o)){let a=await this.doLinkifyAndAppend(o,r);n=_1(n,a)}else/^[^\[]*`[^`]*$/.test(o)?this._state=new yl.Accumulating(o,1):/^\s*\[[^\]]+$/.test(o)?this._state=new yl.Accumulating(o,2):this._state=new yl.Accumulating(o);break}case 1:{if(new RegExp("(^|\\n)"+this._state.fence+"($|\\n)").test(o)||this._state.contents.length>2&&new RegExp("(^|\\n)\\s*"+this._state.fence+"($|\\n\\s*$)").test(this._appliedText+o)){let s=this._appliedText.match(/(\n|^)([ \t]*)[`~]*$/);if(s&&s[2].length<=this._state.indent.length){this._state=yl.Default,n=_1(n,this.doAppend(o));break}}this._state=this._state.appendContents(o),n=_1(n,this.doAppend(o));break}case 2:{let s=async a=>{let c=a.pendingText+o;this._state=yl.Default;let u=await this.doLinkifyAndAppend(c,r);n=_1(n,u)};if(this._state.accumulationType===2){if(/]/.test(o)){this._state=new yl.Accumulating(this._state.pendingText+o,0);break}else if(/\n/.test(o)){await s(this._state);break}}else if(this._state.accumulationType===1&&/`/.test(o)){await s(this._state);break}else if(this._state.accumulationType===0&&/\s/.test(o)){await s(this._state);break}this._state=new yl.Accumulating(this._state.pendingText+o,this._state.accumulationType);break}}return n}async flush(e){if(this._state.type===2){let r=this._state.pendingText;return this._state=yl.Default,this.doLinkifyAndAppend(r,e)}}doAppend(e){return this._appliedText=this._appliedText+e,{text:e,trustedCommands:VL,addedLinkCount:0}}async doLinkifyAndAppend(e,r){this.doAppend(e);let n=new Set(VL),o=0;for(let s of this.linkifiers){let a=await s.linkify(e,this.references,r);if(r?.isCancellationRequested)return{text:e,addedLinkCount:0};if(a){e=a.text,o+=a.addedLinkCount;for(let c of a.trustedCommands??[])n.add(c)}}return e=e.replace(/\[([^\[\]]+)]\(([^\s\)]+)\)/g,(s,a,c)=>/^\w+:/.test(c)?s:a),this._totalAddedLinkCount+=o,{text:e,trustedCommands:Array.from(n),addedLinkCount:o}}};function _1(t,e){return{text:t.text+e.text,trustedCommands:Array.from(new Set([...t.trustedCommands??[],...e.trustedCommands??[]])),addedLinkCount:t.addedLinkCount+e.addedLinkCount}}var x1=class{constructor(e,r){this.fileSystem=e;this.workspaceService=r}async linkify(e,r,n){let o=this.workspaceService.getWorkspaceFolders(),s=0;if(e=await MT(e,/\[`([^`\[\]]+?)`]\((\S+?\.\w+)\)/g,async(a,c,u)=>{for(let l of o){let d=Ur.joinPath(l,u);if(await this.exists(d))return s++,$6e(d,c)}return"`"+c+"`"}),!(!s||n.isCancellationRequested))return{text:e,trustedCommands:[y1],addedLinkCount:s}}async exists(e){try{return await this.fileSystem.stat(e),!0}catch{return!1}}};x1=O([x(0,zr),x(1,Je)],x1);function $6e(t,e){return GL("`"+e+"`",Td(y1,[WH(t),e]),t.fsPath)}var I1=ae("ILinkifyService"),S1=class{constructor(e,r){this.globalLinkifiers=new Set;this.registerGlobalLinkifier({create:()=>new b1(e,r)}),this.registerGlobalLinkifier({create:()=>new x1(e,r)})}registerGlobalLinkifier(e){if(this.globalLinkifiers.has(e))throw new Error("Linkifier already registered");return this.globalLinkifiers.add(e),{dispose:()=>this.globalLinkifiers.delete(e)}}createLinkifier(e,r){return new $L(e,[...r,...this.globalLinkifiers].map(n=>n.create()))}};S1=O([x(0,zr),x(1,Je)],S1);var If=class{constructor(e,r,n,o,s){this.sequencer=Promise.resolve();this._linkifier=s.createLinkifier(e,n),this._progress=r,this._token=o}get totalAddedLinkCount(){return this._linkifier.totalAddedLinkCount}markdown(e){return this.appendMarkdown(typeof e=="string"?new mo(e):e),this}anchor(e,r){return this.enqueue(()=>this._progress.anchor(e,r)),this}button(e){return this.enqueue(()=>this._progress.button(e)),this}filetree(e,r){return this.enqueue(()=>this._progress.filetree(e,r)),this}progress(e){return this.enqueue(()=>this._progress.progress(e)),this}warning(e){return this.enqueue(()=>this._progress.warning(e)),this}reference(e){return this.enqueue(()=>this._progress.reference(e)),this}reference2(e){return this.enqueue(()=>this._progress.reference(e)),this}codeCitation(e,r,n){return this.enqueue(()=>this._progress.codeCitation(e,r,n)),this}push(e){return e instanceof Qi?this.appendMarkdown(e.value):this.enqueue(()=>this._progress.push(e)),this}textEdit(e,r){return this.enqueue(()=>this._progress.textEdit(e,r)),this}markdownWithVulnerabilities(e,r){return this.enqueue(()=>this._progress.markdownWithVulnerabilities(e,r)),this}detectedParticipant(e,r){return this.enqueue(()=>this._progress.detectedParticipant(e,r)),this}confirmation(e,r,n){return this.enqueue(()=>this._progress.confirmation(e,r,n)),this}enqueue(e,r=!0){return r&&(this.sequencer=this.sequencer.then(()=>this.doFinalize())),this.sequencer=this.sequencer.then(e),this.sequencer}async appendMarkdown(e){this.enqueue(async()=>{await this.doApplyText(e.value)},!1)}async finalize(){await this.enqueue(()=>this.doFinalize(),!1)}async doFinalize(){let e=await this._linkifier.flush(this._token);this._token.isCancellationRequested||e&&this.outputMarkdown(e)}async doApplyText(e){if(!e)return;let r=await this._linkifier.append(e,this._token);this._token.isCancellationRequested||r&&this.outputMarkdown(r)}outputMarkdown(e){if(!e.text)return;let r=new mo(e.text);r.isTrusted={enabledCommands:e.trustedCommands??[]},this._progress.markdown(r)}};If=O([x(4,I1)],If);var W6e=3,K6e=3,Y6e=1;function C1(t,e){let r=0;for(let n of e)r+=Q6e(t,n);return r+=W6e,r}function Q6e(t,e){let r=K6e;for(let[n,o]of Object.entries(e))o&&(r+=t.tokenLength(o),n==="name"&&(r+=Y6e));return r}var E1=ae("IFeedbackReporter");var WL={top_p:1,temperature:.1};var _c=class t{constructor(e){this._source=e;this._variables=null}_getVariables(){if(!this._variables){this._variables=[];for(let e=0;e<this._source.length;e++){let r=this._source[e];if(r.value){let n=r.name,o=this.uniqueFileName(n,this._source.slice(0,e));this._variables.push({originalName:n,uniqueName:o,value:r.value,range:r.range})}}}return this._variables}reverse(){let e=this._source.slice(0);return e.reverse(),new t(e)}find(e){return this._getVariables().find(e)}*[Symbol.iterator](){yield*this._getVariables()}substituteVariablesWithReferences(e){let r=[];for(let n of this._getVariables())n.range&&r.push({start:n.range[0],end:n.range[1],newText:`[#${n.uniqueName}](#${n.uniqueName}-context)`});r.sort((n,o)=>o.end-n.end);for(let n of r)e=e.slice(0,n.start)+n.newText+e.slice(n.end);return e}hasVariables(){return this._getVariables().length>0}uniqueFileName(e,r){let n=r.filter(o=>o.name===e).length;return n===0?e:`${e}-${n}`}};var ny=z(at());var su=ae("ITestProvider");var wd=class{constructor(e,r,n,o,s,a,c,u,l,d,p){this.location=e;this.chatMLFetcher=n;this.endpointProvider=o;this.telemetryService=s;this.configurationService=a;this.testProvider=c;this.experimentationService=u;this.intentService=l;this.options=d;this.instantiationService=p;this.logger=r.getPromptResponseLogger("intent detection")}async detectIntent(e,r,n,o,s,a,c,u,l){let d=await this.configurationService.getExperimentBasedConfig(fe.IntentDetectionWithFunctionCalling,this.experimentationService),p=d?await this.endpointProvider.getChatEndpoint("gpt-4"):await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),f=$e.create(this.instantiationService,p,d?Xw:Rd,{preferredIntent:a,location:this.location,userQuestion:r,documentContext:e,history:l,chatVariables:u}),{messages:m}=await f.render(void 0,o);this.logger.logPrompt(m);let h=[],g=async(S,I,T)=>{if(T.copilotFunctionCalls)for(let A of T.copilotFunctionCalls)h.push({name:A.name,arguments:JSON.parse(A.arguments)})},v=d?this.getFunctions(e).map(S=>({name:S.functionName??S.name,description:S.description})):void 0,y=await this.chatMLFetcher.fetchMany(m,g,o,this.location,p,{agent:n},{temperature:this.options.temperature,top_p:this.options.topP,stop:[";"],n:1,functions:v},{messageSource:"chat.intentprompt"}),b=this.handleResult(y,s,r,h.map(S=>S.name),a);this.sendTelemetry(a,b?.id,e?.language.languageId,c);let _=f.getMeta(Jw);return this.sendInternalTelemetry(r,a,_?.filePath,_?.fileExcerpt,b?.id,e?.language.languageId,c,m.slice(1,-1)),b}async collectIntentDetectionContextInternal(e,r,n,o=[],s){let a=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),{messages:c}=await Xi(this.instantiationService,a,Nr,{document:s}),{messages:u}=await Xi(this.instantiationService,a,Lt,{history:o,priority:1e3}),{history:l,fileExcerpt:d,attachedContext:p,fileExcerptExceedsBudget:f}=this.prepareInternalTelemetryContext(c?.[0]?.content,u,n);this.telemetryService.sendInternalMSFTTelemetryEvent("intentDetectionContext",{chatLocation:ft.toString(this.location),userQuery:e,history:l.join(""),assignedIntent:r,fileExcerpt:d??(f?"<truncated>":"<none>"),attachedContext:p.join(";")},{})}getFunctions(e){let r=e!==void 0&&$t(e.document.uri);return Rd.getDetectableIntents(this.location,r,this.intentService,this.configurationService,this.testProvider).map(n=>({name:n.id,functionName:n.intentDetectionInput.functionName,description:n.intentDetectionInput.modelDescription||n.description}))}handleResult(e,r,n,o,s){if(this.logger.logResponse(e),e.type!=="success"){this.sendPromptIntentErrorTelemetry(r,e);return}let a=o?.length?o.map(d=>{let[p,f]=d.split(".");return(f??p).replaceAll("'","")}):e.value.map(d=>d.trimStart().split(`
`)[0].replace(/function id:|response:/i,"").trim());a=a.filter(d=>d!==ta.ID),!a.length&&s&&(a=[s]);let c=a.map(d=>this.intentService.getIntent(d,this.location)??this.intentService.getIntentByFunctionName(d,this.location)).filter(d=>d!==void 0),u=wd.pickMostFrequent(c);this.logger.info(`picked intent "${u?.id}" from ${JSON.stringify(e.value,null,"	")}`);let l=r.extendedBy({messageText:n,promptContext:a.join(),intent:u?.id||"unknown"});return this.telemetryService.sendRestrictedGHTelemetryEvent("conversation.promptIntent",l.raw.properties,l.raw.measurements),u}sendPromptIntentErrorTelemetry(e,r){let n=e.extendedBy({resultType:r.type,reason:r.reason});this.telemetryService.sendRestrictedGHTelemetryErrorEvent("conversation.promptIntentError",n.raw.properties,n.raw.measurements)}static pickMostFrequent(e){if(e.length===0)return;let r=new Map;for(let o of e){let s=r.get(o.id)??[0,o];s[0]+=1,r.set(o.id,s)}let[,n]=[...r.values()].reduce((o,s)=>o[0]>s[0]?o:s);return n}sendTelemetry(e,r,n,o){this.telemetryService.sendMSFTTelemetryEvent("intentDetection",{chatLocation:ft.toString(this.location),preferredIntent:e??"<none>",detectedIntent:r??"<none>",languageId:n??"<none>",isRerunWithoutIntentDetection:String(o)??"<none>"})}prepareInternalTelemetryContext(e,r,n){let o=5e3,s=[];if(n)for(let u of n){let l=Buffer.byteLength(u.uniqueName,"utf8");if(o-l<0)break;o-=l,s.push(u.uniqueName)}let a=!1;if(e){let u=Buffer.byteLength(e,"utf8");u>o?(a=!0,e=void 0):o-=u}else e=void 0;let c=[];for(let u=r.length-1;u>0;u-=1){let l=r[u],d=`${l.role.toUpperCase()}: ${l.content}

`,p=Buffer.byteLength(d,"utf8");if(o-p<0)break;c.push(d),o-=p}return{fileExcerpt:e,fileExcerptExceedsBudget:a,history:c,attachedContext:s}}sendInternalTelemetry(e,r,n,o,s,a,c,u){let{fileExcerpt:l,history:d}=this.prepareInternalTelemetryContext(o,u);this.telemetryService.sendInternalMSFTTelemetryEvent("intentDetection",{chatLocation:ft.toString(this.location),request:e,preferredIntent:r??"<none>",filePath:n??"<none>",fileExerpt:l??"<none>",detectedIntent:s??"<none>",languageId:a??"<none>",isRerunWithoutIntentDetection:String(c)??"<none>",history:d.join("")},{})}};wd=O([x(1,ue),x(2,Bt),x(3,Le),x(4,me),x(5,ye),x(6,su),x(7,Ut),x(8,Da),x(9,Sn),x(10,te)],wd);var Jw=class extends ny.PromptMetadata{constructor(r,n){super();this.fileExcerpt=r;this.filePath=n}},Rd=class extends Q{constructor(r,n,o,s,a){super(r);this._ignoreService=n;this._configurationService=o;this._testProvider=s;this._intentService=a}static getDetectableIntents(r,n,o,s,a){let c=o.getIntents(r),u=[];for(let l=0;l<c.length;l++){let d=c[l];d.id==="review"&&!s.getConfig(fe.ReviewIntent)||d.id==="fixTestFailure"&&(!a.isEnabled.get()||xs.isEmpty(a.getAllFailures()))||d.id==="tests"&&n||d.commandInfo?.defaultEnablement===!1||d.intentDetectionInput.disabled||u.push(d)}return u}async prepare(r,n,o){let{documentContext:s}=this.props,a=!1;return s!==void 0&&(a=await this._ignoreService.isCopilotIgnored(s.document.uri)),{isDocumentCopilotIgnored:a}}render(r){let{preferredIntent:n,location:o,userQuestion:s,documentContext:a}=this.props,c,u,l;try{if(a!==void 0&&!r.isDocumentCopilotIgnored){let{document:h,selection:g}=a;c=h.uri;let v=new Ge(new $n(Math.max(g.start.line-5,0),0),new $n(Math.min(g.end.line+5,h.lineCount),h.lineAt(g.end.line).text.length));u=h.getText(v),l=u.trim().length>0?vscpp(Oe,{uri:c,languageId:h.languageId,code:u,shouldTrim:!1}):void 0}}catch{}let d=new Jw(u,c?.path),p=a!==void 0&&$t(a.document.uri),f=Rd.getDetectableIntents(o,p,this._intentService,this._configurationService,this._testProvider),m=(n?this._intentService.getIntent(n,o)?.intentDetectionInput.functionName:void 0)??n;return vscpp(vscppf,null,vscpp("meta",{value:d}),vscpp(ny.SystemMessage,null,'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null)),vscpp(ny.UserMessage,null,"A software developer is using an AI chatbot in a code editor",c&&` in file ${c.path}`,".",vscpp("br",null),l===void 0?vscpp("br",null):vscpp(vscppf,null,"Current active file contains following excerpt:",vscpp("br",null),l,vscpp("br",null)),"The developer added the following request to the chat and your goal is to select a function to perform the request.",vscpp("br",null),m&&`The developer probably wants Function Id '${m}', pick different only if you're certain.`,vscpp("br",null),"Request: ",s,vscpp("br",null),vscpp("br",null),"Available functions:",vscpp("br",null),f.map(h=>vscpp(vscppf,null,"Function Id: ",h.id,vscpp("br",null),"Function Description: ",h.intentDetectionInput.modelDescription||h.description,vscpp("br",null),vscpp("br",null))),vscpp("br",null),"Here are some examples to make the instructions clearer:",vscpp("br",null),f.map(h=>vscpp(vscppf,null,"Request: ",h.intentDetectionInput.sampleQuestion,vscpp("br",null),"Response: ",h.id,vscpp("br",null),vscpp("br",null))),"Request: ",s,vscpp("br",null),"Response:"))}};Rd=O([x(1,De),x(2,ye),x(3,su),x(4,Da)],Rd);var Xw=class extends Rd{constructor(e,r,n,o,s){super(e,r,n,o,s)}render(e){let{preferredIntent:r,location:n,userQuestion:o,documentContext:s,history:a,chatVariables:c}=this.props,u=(r?this._intentService.getIntent(r,n)?.intentDetectionInput.functionName:void 0)??r,l,d,p;try{if(s!==void 0&&!e.isDocumentCopilotIgnored){let{document:v,selection:y}=s;l=v.uri;let b=new Ge(new $n(Math.max(y.start.line-5,0),0),new $n(Math.min(y.end.line+5,v.lineCount),v.lineAt(y.end.line).text.length));d=v.getText(b),p=d.trim().length>0?vscpp(Oe,{uri:l,languageId:v.languageId,code:d,shouldTrim:!1}):void 0}}catch{}let f=new Jw(d,l?.path),m=s!==void 0&&$t(s.document.uri),h=Rd.getDetectableIntents(n,m,this._intentService,this._configurationService,this._testProvider),g=!!(a?.length&&a.length>0);return vscpp(vscppf,null,vscpp("meta",{value:f}),vscpp(ny.SystemMessage,{priority:1e3},"You are an AI programming assistant in the Visual Studio Code editor.",vscpp("br",null),l&&vscpp(vscppf,null,"The user is currently looking at the file ",l.path,".",vscpp("br",null)),p&&vscpp(vscppf,null,"The current active file contains the following excerpt:",vscpp("br",null),p,vscpp("br",null)),"Your task is to choose the function from the following list that is most relevant to the user's message. This function will be executed to provide the user with a more specific and actionable response.",vscpp("br",null),vscpp("br",null),Xt(h.filter(v=>!!v.intentDetectionInput.functionCallingBlurb).map(v=>`Function name: ${v.intentDetectionInput.functionName??v.id}
${v.intentDetectionInput.functionCallingBlurb}
An example of a question that matches the '${v.intentDetectionInput.functionName??v.id}' function is: "${v.intentDetectionInput.sampleQuestion}".`)).join(`

`),vscpp("br",null),vscpp("br",null),n===2&&vscpp(vscppf,null,"If the user's question is not related to the functions described above, or if it is related to two or more functions described above, you should use the 'unknown' function.",vscpp("br",null)),u&&vscpp(vscppf,null,"The user probably wants the '",u,"' function, pick different only if you're certain.",vscpp("br",null)),"Your response should contain just the name of the function and no other text. You can only choose from the functions mentioned above."),g&&vscpp(Lt,{history:a,priority:800}),vscpp(Kr,{query:o,chatVariables:c,priority:900}))}};Xw=O([x(1,De),x(2,ye),x(3,su),x(4,Da)],Xw);async function Jae(t,e,r,n,o,s,a,c){let u,l="",d=!1;if(!n.command&&n.prompt.startsWith("/")&&n.prompt.startsWith("/")){let h=/\/(?<intentId>\w+)(?<restOfQuery>\s.*)?/s.exec(n.prompt)?.groups;n.command=h?.intentId??void 0,n.prompt=h?.restOfQuery?.trim()??""}if(n.command&&e.getCommand(n.command,1))u=e.getCommand(n.command,1)?.intent,l=n.prompt,d=!0;else{let m=n.enableCommandDetection,g=t.createInstance(wd,1).detectIntent(o,n.prompt,s?.agent,c,a,s?.preferredIntent,!m,new _c(n.references),void 0);m&&(u=await g,u?.id===nu.ID&&o.selection.isEmpty&&o.document.lineAt(o.selection.start.line).text.trim()===""&&(u=r.getIntent(iu.ID,1))),l=n.prompt}let p;if(u){let m=e.getCommand(u.id,1);m&&(m.intent?.asSlashCommand?p=await m.intent.asSlashCommand(o):p={name:m.commandId,description:m.details})}u??=r.unknownIntent;let f=await u.invoke({request:n,location:1,documentContext:o,slashCommand:p});return{queryWithoutCommand:l,intentInvocation:f,slashCommand:p,fromQuery:d}}async function Zae(t,e,r,n,o,s){let a;if(r.length>0){let l=`The current code is a result of a previous interaction with you. Here are my previous messages: 
- ${r.map(d=>d.prompt).join(`
- `)}`;a=[new Zp({message:l,type:"user"})]}else a=[];let c={history:a,query:t.queryWithoutCommand,chatVariables:new _c(e.references),customInstructions:n},u={report(l){o.push(l)}};return await t.intentInvocation.buildPrompt(c,u,s)}var KH=class{constructor(e,r,n,o,s){this.wholeRange=e;this.document=r;this.formattingOptions=n;this.preferredIntent=o;this.agent=s;this._requests=[];this.aiEditCollector=void 0;this.store=void 0;this.sessionId=Br(),this.conversation=void 0}addRequest(e){this._requests.push(e)}getRequests(){return this._requests}};var au=class{constructor(e,r,n,o,s,a,c,u,l,d,p,f,m,h){this.agent=e;this.rejectionMessage=r;this._telemetryService=o;this.tabAndEditorsService=s;this.languageDiagnosticsService=a;this.ignoreService=c;this.chatMLFetcher=u;this.tokenizerProvider=l;this.feedbackReporter=d;this.instantiationService=p;this.commandService=f;this.intentService=m;this.customInstructionsService=h;this.logger=n.getPromptResponseLogger("interactiveEditor"),this.logger.info(`CopilotInteractiveEditorSessionProvider created, with rejection message: ${this.rejectionMessage}`)}async prepareInteractiveEditorSession(e){if(await this.ignoreService.isCopilotIgnored(e.document.uri))throw new Error(ece.t("Inline chat is disabled for this file due to content exclusion policies."));let n;if(this.tabAndEditorsService.activeTextEditor?.document.uri.toString()===e.document.uri.toString()){let s=this.tabAndEditorsService.activeTextEditor.options;n={insertSpaces:s.insertSpaces,tabSize:s.tabSize}}let o;return e.selection.isEmpty&&e.document.lineAt(e.selection.start.line).text.trim()===""?o=iu.ID:!e.selection.isEmpty&&e.selection.start.line!==e.selection.end.line&&(o=nu.ID),new KH(e.selection,e.document,n,o,this.agent)}async provideInteractiveEditorResponse(e,r,n,o){this.logger.info(`CopilotInteractiveEditorSessionProvider query: ${r.prompt}`),r.attempt===0&&e.addRequest(r);let s=e.aiEditCollector=this.instantiationService.createInstance(jh,e.document.getText()),a=n;n=new gc(u=>{"edits"in u&&s.addEdits(u.edits),a.push(u)});let c=await this.fetchResponse(e,r,n,o);if(c)return e.store=c.reply.store,c}handleInteractiveEditorResponseFeedback(e,r,n){if(this.logger.debug("CopilotInteractiveEditorSessionProvider feedback received"),n===4&&e.conversation){this.feedbackReporter.reportInline(e.conversation,r.promptQuery,r.reply);return}let o={messageId:r.messageId},s,{selection:a,wholeRange:c,intent:u,query:l}=r.promptQuery,d=e.conversation?.getLatestTurn()?.requestId??"",p=e.sessionId,f=u?.id,m=e.document.languageId,h=r.reply.type,g=f==="fix"?tce(a,this.languageDiagnosticsService.getDiagnostics(e.document.uri)):void 0,v=$t(e.document.uri)?1:0,y={languageId:m,replyType:h,conversationId:p,requestId:d,command:f},b=r.telemetry?.editCount??0,_=r.telemetry?.editLineCount??0,S={selectionLineCount:a?Math.abs(a.end.line-a.start.line):-1,wholeRangeLineCount:c?Math.abs(c.end.line-c.start.line):-1,editCount:b>0?b:-1,editLineCount:_>0?_:-1,isNotebook:v,problemsCount:g?.fileDiagnosticsTelemetry.problemsCount??0,selectionProblemsCount:g?.selectionDiagnosticsTelemetry.problemsCount??0,diagnosticsCount:g?.fileDiagnosticsTelemetry.diagnosticsCount??0,selectionDiagnosticsCount:g?.selectionDiagnosticsTelemetry.diagnosticsCount??0},I=(T,A)=>{this._telemetryService.sendInternalMSFTTelemetryEvent(T,{language:m,intent:f,query:l,conversationId:p,requestId:d,replyType:h,problems:g?.fileDiagnosticsTelemetry.problems??"",selectionProblems:g?.selectionDiagnosticsTelemetry.problems??"",diagnosticCodes:g?.fileDiagnosticsTelemetry.diagnosticCodes??"",selectionDiagnosticCodes:g?.selectionDiagnosticsTelemetry.diagnosticCodes??""},{isNotebook:v,...A})};if(n===3&&e.aiEditCollector){let T=e.aiEditCollector,A=this.instantiationService.createInstance(Hh,e.aiEditCollector.getText(),e.document);(async()=>{try{let[B,j]=await Promise.all([T.getEdits(),A.compute()]),F=j.getEditsSinceInitial();this.instantiationService.createInstance(Cd,e.document,T.initialText,B,F,PL(y,S))}finally{A.dispose()}})()}if(e.aiEditCollector=void 0,n===1||n===0){let T=n===1?1:0;this._telemetryService.sendMSFTTelemetryEvent("inline.action.vote",y,{...S,vote:T}),I("interactiveSessionVote",{vote:T})}else if(n===2||n===3){let T=n===3?1:0;this._telemetryService.sendMSFTTelemetryEvent("inline.done",y,{...S,accepted:T}),I("interactiveSessionDone",{accepted:T})}switch(n){case 1:o.rating="positive",s="inlineConversation.messageRating";break;case 0:o.rating="negative",s="inlineConversation.messageRating";break;case 2:o.action="undo",s="inlineConversation.undo";break;case 3:o.action="accept",s="inlineConversation.accept";break;case 4:s="";break}s&&bf(this._telemetryService,e.document,o,{},s)}async fetchResponse(e,r,n,o){let s=new Zw(Date.now(),e,e.conversation===void 0,r,this._telemetryService,this.languageDiagnosticsService,this.tokenizerProvider),a;e.getRequests().length>1&&r.attempt===0&&e.store&&e.document.getText()===e.store.lastDocumentContent&&(a=e.store.lastWholeRange,this.logger.debug("Ignoring passed in whole range and using the whole range from the previous turn"));let c=e.document.getText(),u={document:e.document,fileIndentInfo:e.formattingOptions,language:Is(e.document),selection:r.selection,wholeRange:a??r.wholeRange};(e.getRequests().length>1||r.attempt>0)&&(e.preferredIntent=void 0);let l=await Jae(this.instantiationService,this.commandService,this.intentService,r,u,e,s.baseUserTelemetry,o),d=l.intentInvocation;l.slashCommand&&!l.fromQuery&&n.detectedParticipant("github.copilot.editor",l.slashCommand);let p={query:l.queryWithoutCommand,...u,intent:d.intent},f=await this.customInstructionsService.fetchInstructions(),{messages:m,references:h}=await Zae(l,r,e.getRequests().slice(0,-1),f,n,o);for(let N of h)n.reference(N.anchor);if(o.isCancellationRequested)return;let g=e.conversation;g||(g=e.conversation=new L0);let v=new Zp({message:m.map(N=>N.content).join(`
`),type:"user"});v.requestDebugInformation={uri:e.document.uri,intentId:l.intentInvocation.intent.id,languageId:e.document.languageId,initialDocumentText:c,userPrompt:r.prompt,userSelection:r.selection},v.chatMessages=m,v.requestId=s.telemetryMessageId,g.addTurn(v),this.logger.logPrompt(m);let y,b,_=d.linkification?.disable?void 0:this.instantiationService.createInstance(If,h,n,d.linkification?.additionaLinkifiers??[],o),S=_??n;if(m.length===0){let N=await d.processResponseInline(Zo.EMPTY,S,o);return _&&await _.finalize(),{promptQuery:p,reply:N,messageId:s.telemetryMessageId,telemetry:void 0}}let I=s.makeRequest(g,l.queryWithoutCommand,d,m);S=gc.spy(S,N=>{N instanceof Qi&&I.markEmittedMarkdown(N.value),N instanceof Jp&&I.markEmittedEdits(N.uri,N.edits)});let T=new Lx,A=d.processResponseInline(T.stream,S,o),B=!1;A.finally(()=>{B=!0});let j=async(N,w,P)=>(I.markReceivedToken(),T.update(N,P),B?N.length:void 0);try{y=await this.chatMLFetcher.fetchOne(m,j,o,1,d.endpoint,{agent:ow},{temperature:au.pickTemperature(r),top_p:WL.top_p},{messageId:I.telemetryMessageId,messageSource:d.intent.id!==ta.ID?`inline.${d.intent.id}`:"inline.user"},{intent:!0})}catch(N){throw this.logger.exception(N,"Fetching failed: "),this._telemetryService.sendGHTelemetryException(N,"Fetching failed: "),v.status="error",v.response={message:N.message,type:"server"},new Error("Failed to make request")}if(this.logger.logResponse(y),y.type!=="success")return this._handleFetchError(v,y,I);if(b=y.value,b.length===0){this.logger.info("Response is empty."),I.sendTelemetry(y.requestId,"unknown","Empty response");return}T.resolve();let F=await A;_&&await _.finalize(),v.status="success";let ne=b;v.response={message:ne,type:"model"},v.responseDebugInformation={parsedReply:F},I.sendTelemetry(y.requestId,"success",ne,F);let Y={...F,store:void 0};return this.logger.info(`Parsed response: ${JSON.stringify(Y,null,"	")}`),{promptQuery:p,reply:F,messageId:I.telemetryMessageId,telemetry:I}}_handleFetchError(e,r,n){let{turnStatus:o,message:s,messageType:a,throwError:c}=this._interpretFetchError(r);if(e.status=o,e.response={message:s,type:a},n.sendTelemetry(r.requestId,r.type,s),c)throw new Error(c)}_interpretFetchError(e){switch(e.type){case"rateLimited":return{turnStatus:"error",message:`Response failed ${e.type}: ${e.reason}`,messageType:"server",throwError:"Oops, your request failed due to a rate limit. Please try again later."};case"badRequest":return{turnStatus:"error",message:`Response failed ${e.type}: ${e.reason}`,messageType:"server",throwError:"Failed to make request"};case"failed":return this.logger.error(`Response failed: ${e.reason}`),{turnStatus:"error",message:e.reason,messageType:"server",throwError:"Failed to make request"};case"canceled":return this.logger.debug(`Response canceled: ${e.reason}`),{turnStatus:"error",message:"Cancelled",messageType:"user"};case"unknown":{let r=`Response is empty: ${e.reason}`;return this.logger.info(r),{turnStatus:"error",message:r,messageType:"server"}}case"filtered":{let r=`Response got filtered: ${e.reason}`;return this.logger.info(r),{turnStatus:"filtered",message:r,messageType:"server",throwError:VD(e.category,!1)}}case"offTopic":return this.logger.info(`Response marked as offtopic: ${e.reason}`),{turnStatus:"off-topic",message:this.rejectionMessage,messageType:"offtopic-detection"};case"length":{let r=`Response was too long: ${e.reason}`;return this.logger.info(r),{turnStatus:"error",message:r,messageType:"server"}}default:return this.logger.error("Unexpected response type"),this.logger.info(JSON.stringify(e)),{turnStatus:"error",message:`Unexpected response type: ${JSON.stringify(e)}`,messageType:"server"}}}static pickTemperature(e){return"attempt"in e&&typeof e.attempt=="number"?Math.min(WL.temperature*(e.attempt+1),2):WL.temperature}};au=O([x(2,ue),x(3,me),x(4,kt),x(5,bo),x(6,De),x(7,Bt),x(8,dr),x(9,E1),x(10,te),x(11,Vh),x(12,Da),x(13,Xx)],au);var Zw=class{constructor(e,r,n,o,s,a,c){this._startTime=e;this._session=r;this._firstTurn=n;this._request=o;this._telemetryService=s;this._languageDiagnosticsService=a;this._tokenizerProvider=c;this.baseUserTelemetry=Wx()}get telemetryMessageId(){return this.baseUserTelemetry.properties.messageId}makeRequest(e,r,n,o){return new eR(this._session,this._firstTurn,this._request,this._startTime,this.baseUserTelemetry,e,r,n,o,this._telemetryService,this._languageDiagnosticsService,this._tokenizerProvider.acquireTokenizer(n.endpoint.family))}};Zw=O([x(4,me),x(5,bo),x(6,dr)],Zw);var eR=class{constructor(e,r,n,o,s,a,c,u,l,d,p,f){this._session=e;this._firstTurn=r;this._request=n;this._startTime=o;this._conversation=a;this._queryWithoutCommand=c;this._intentInvocation=u;this._messages=l;this._telemetryService=d;this._languageDiagnosticsService=p;this._tokenizer=f;this._requestStartTime=Date.now();this._firstTokenTime=0;this._markdownCharCount=0;this._editCount=0;this._editLineCount=0;this._userTelemetry=AL(this._conversation,this._session.sessionId,"conversationInline",this._request.prompt,X6e(this._tokenizer,this._messages),this._intentInvocation.intent.id,s),this._diagnosticsTelemetryData=tce(this._request.selection,this._languageDiagnosticsService.getDiagnostics(this._session.document.uri)),this._sendInternalRequestTelemetryEvent()}get editCount(){return this._editCount}get editLineCount(){return this._editLineCount}get telemetryMessageId(){return this._userTelemetry.properties.messageId}get _isNotebookDocument(){return $t(this._session.document.uri)?1:0}_sendInternalRequestTelemetryEvent(){this._telemetryService.sendInternalMSFTTelemetryEvent("interactiveSessionRequest",{conversationId:this._session.sessionId,requestId:this.telemetryMessageId,chatLocation:"inline",intent:this._intentInvocation.intent.id,language:this._session.document.languageId,prompt:this._messages.map(e=>`${e.role.toUpperCase()}:
${e.content}`).join(`
---
`),model:this._intentInvocation.endpoint.model},{isNotebook:this._isNotebookDocument})}markReceivedToken(){this._firstTokenTime===0&&(this._firstTokenTime=Date.now())}markEmittedMarkdown(e){this._markdownCharCount+=e.value.length}markEmittedEdits(e,r){this._editCount+=r.length,this._editLineCount+=r.reduce((n,o)=>n+o.newText.split(`
`).length,0)}sendTelemetry(e,r,n,o){DL(this._telemetryService,"conversationInline",e,this._request.prompt,r==="offTopic",this._session.document,this._userTelemetry),r==="offTopic"&&LL(this._telemetryService,this._conversation,this._session.sessionId,"conversationInline",this._request.prompt,this.telemetryMessageId,this._session.document,this._userTelemetry),r==="success"&&o&&NL(this._telemetryService,this._conversation,this._session.sessionId,"conversationInline",n,this.telemetryMessageId,this._session.document,this._userTelemetry.extendedBy({replyType:o.type})),this._sendTelemetryEvent(r,n,o),this._sendInternalTelemetryEvent(r,n)}_sendTelemetryEvent(e,r,n){this._telemetryService.sendMSFTTelemetryEvent("inline.request",{command:this._intentInvocation.intent.id??"",contextTypes:"none",promptTypes:this._messages.map(o=>`${o.role}${o.name?`-${o.name}`:""}:${o.content.length}`).join(","),conversationId:this._session.sessionId,requestId:this.telemetryMessageId,languageId:this._session.document.languageId,responseType:e,replyType:n?.type,model:this._intentInvocation.endpoint.model,diagnosticsProvider:this._diagnosticsTelemetryData.diagnosticsProvider,diagnosticCodes:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.diagnosticCodes,selectionDiagnosticCodes:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.diagnosticCodes,outcomeAnnotations:n?.annotations?.map(o=>o.label).join(",")},{firstTurn:this._firstTurn?1:0,isNotebook:this._isNotebookDocument,withIntentDetection:this._request.enableCommandDetection===void 0?void 0:this._request.enableCommandDetection?1:0,messageTokenCount:this._tokenizer.tokenLength(this._queryWithoutCommand),promptTokenCount:C1(this._tokenizer,this._messages),responseTokenCount:e==="success"?this._tokenizer.tokenLength(r):-1,implicitCommand:this._request.prompt.trim().startsWith(`/${this._intentInvocation.intent.id}`)?0:1,attemptCount:this._request.attempt||0,selectionLineCount:this._request.selection?Math.abs(this._request.selection.end.line-this._request.selection.start.line)+1:-1,wholeRangeLineCount:this._request.wholeRange?Math.abs(this._request.wholeRange.end.line-this._request.wholeRange.start.line)+1:-1,editCount:this._editCount>0?this._editCount:-1,editLineCount:this._editLineCount>0?this._editLineCount:-1,markdownCharCount:this._markdownCharCount,problemsCount:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.problemsCount,selectionProblemsCount:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.problemsCount,diagnosticsCount:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.diagnosticsCount,selectionDiagnosticsCount:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.diagnosticsCount,timeToRequest:this._requestStartTime-this._startTime,timeToFirstToken:this._firstTokenTime?this._firstTokenTime-this._startTime:-1,timeToComplete:Date.now()-this._startTime})}_sendInternalTelemetryEvent(e,r){this._telemetryService.sendInternalMSFTTelemetryEvent("interactiveSessionResponse",{conversationId:this._session.sessionId,requestId:this.telemetryMessageId,chatLocation:"inline",intent:this._intentInvocation.intent.id??"",problems:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.problems,selectionProblems:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.problems,diagnosticCodes:this._diagnosticsTelemetryData.fileDiagnosticsTelemetry.diagnosticCodes,selectionDiagnosticCodes:this._diagnosticsTelemetryData.selectionDiagnosticsTelemetry.diagnosticCodes,diagnosticsProvider:this._diagnosticsTelemetryData.diagnosticsProvider,language:this._session.document.languageId,request:this._request.prompt,responseType:e,response:r},{isNotebook:this._isNotebookDocument})}};eR=O([x(9,me),x(10,bo)],eR);function X6e(t,e){let r=0;for(let n of e)r+=t.tokenLength(n.content);return r}function tce(t,e){let r=e.filter(l=>t.intersection(l.range)),n={problems:e.map(l=>l.message).join(", "),problemsCount:e.length,diagnosticCodes:"",diagnosticsCount:0},o={problems:r.map(l=>l.message).join(", "),problemsCount:r.length,diagnosticCodes:"",diagnosticsCount:0},s=new Map,a=new Map;e.forEach(l=>{let d=l.code,p=typeof d=="string"||typeof d=="number"?d.toString():d?d.value.toString():"",f=l.source?`${l.source}@${p}`:p;s.set(f,(s.get(f)||0)+1),t.intersection(l.range)&&a.set(f,(a.get(f)||0)+1)});let c=l=>{let d="";return l.forEach((p,f)=>{d+=`${f}:${p},`}),d};n.diagnosticCodes=c(s),n.diagnosticsCount=s.size,o.diagnosticCodes=c(a),o.diagnosticsCount=a.size;let u=e.length>0?e[0].source??"":"";return{fileDiagnosticsTelemetry:n,selectionDiagnosticsTelemetry:o,diagnosticsProvider:u}}function nce(t){let e=new Tt,r=async(v,y)=>{let b=`@${Vw} /explain `,_,S,I=!1;if(typeof v=="string"&&v)b=v;else{let T=t.get(kt),A=Nr.getCurrentSelection(T,!0);if(A){let j=gt.languages.getDiagnostics(A.activeDocument.uri),F=j.filter(Y=>!!Y.range.intersection(A.range));ry.getSevereDiagnostics(F).length&&(b+=ry.getDiagnosticsAsText(j),I=!0)}let B=Nr.getCurrentSelection(T);if(!I&&B&&(b+=cL,_=hx.formatSelection({languageId:B.languageId,selectedText:B.selectedText}),S=B.activeDocument.uri),!I&&A&&y)try{let j=await rs.getSelectedScope(t,{document:A.activeDocument,selection:A.range});if(j&&j.symbolAtCursorState&&j.symbolAtCursorState.codeAtCursor){b+=cL;let F=j.symbolAtCursorState.document.languageId??"";_=hx.formatSelection({languageId:F,selectedText:j.symbolAtCursorState.codeAtCursor}),S=A.activeDocument.uri}}catch(j){if(j instanceof fo)return}}S&&_&&!await t.get(De).isCopilotIgnored(S)&&(b+=_),gt.commands.executeCommand("workbench.action.chat.open",{query:b})},n=async v=>{let y=t.get(vo),b=y.findReviewComment(v);if(!b||!b.suggestion)return;let _=gt.window.activeTextEditor;if(!_||_.document!==b.document)return;let{edits:S}=await b.suggestion;_.edit(T=>{S.forEach(A=>{T.replace(A.range,A.newText)})});let I=y.getReviewComments().length;y.removeReviewComments([b]),Uh(b,I,"applySuggestion",t.get(ue),t.get(me),t.get(te))},o=async v=>{let y=t.get(vo),b=y.findReviewComment(v);if(!b)return;let _=y.getReviewComments().length,S=b.body instanceof gt.MarkdownString?b.body.value:b.body;y.collapseReviewComment(b),await gt.commands.executeCommand("vscode.editorChat.start",{initialRange:v.range,message:`/fix ${S}`,autoSend:!0}),Uh(b,_,"continueInInlineChat",t.get(ue),t.get(me),t.get(te))},s=async v=>{let y=t.get(vo),b=y.findReviewComment(v);if(!b)return;let _=y.getReviewComments().length,S=b.body instanceof gt.MarkdownString?b.body.value:b.body;await gt.commands.executeCommand("workbench.action.chat.open",{query:"Explain your comment.",isPartialQuery:!0,previousRequests:[{request:"Review my code.",response:`In file \`${rce.default.basename(b.uri.fsPath)}\` at line ${b.range.start.line+1}:

${S}`}]}),Uh(b,_,"continueInChat",t.get(ue),t.get(me),t.get(te))},a=async v=>{let y=t.get(vo),b=y.findReviewComment(v);if(b){let _=y.getReviewComments().length;y.removeReviewComments([b]),Uh(b,_,"discardComment",t.get(ue),t.get(me),t.get(te))}},c=async()=>{let v=t.get(vo),y=v.getReviewComments();y.length&&(v.removeReviewComments(y),Uh(y,y.length,"discardAllComments",t.get(ue),t.get(me),t.get(te)))},u=async v=>{let y=t.get(vo),b=y.findReviewComment(v);if(b){let _=y.getReviewComments().length;Uh(b,_,"helpful",t.get(ue),t.get(me),t.get(te))}},l=async v=>{let y=t.get(vo),b=y.findReviewComment(v);if(b){let _=y.getReviewComments().length;Uh(b,_,"unhelpful",t.get(ue),t.get(me),t.get(te))}},d=t.get(ar).extensionMode;typeof d=="number"&&d!==gt.ExtensionMode.Test&&t.get(vo).updateContextValues();let p=(v,y)=>{let b=t.get(vo),_;if(v){let I=b.findReviewComment(v);if(!I)return;let T=b.getReviewComments(),B=(T.indexOf(I)+y+T.length)%T.length;_=T[B]}else{let I=b.getReviewComments();_=I[y>0?0:I.length-1]}let S=_&&b.findCommentThread(_);S&&(y!==0&&S.reveal(),J6e(t,S))},f=()=>gt.commands.executeCommand("vscode.editorChat.start",{message:"/generate "}),m=()=>gt.commands.executeCommand("vscode.editorChat.start",{message:`/${hl.ID} `,autoSend:!0,initialRange:gt.window.activeTextEditor?.selection}),h=()=>gt.commands.executeCommand("vscode.editorChat.start",{message:"/tests ",autoSend:!0,initialRange:gt.window.activeTextEditor?.selection}),g=()=>{let v=gt.window.activeTextEditor;if(!v)return;let y=v.selection,b=gt.languages.getDiagnostics(v.document.uri).filter(_=>!!y.intersection(_.range)).map(_=>_.message).join(", ");return gt.commands.executeCommand("vscode.editorChat.start",{message:`/fix ${b}`,autoSend:!0,initialRange:gt.window.activeTextEditor?.selection})};return e.add(gt.commands.registerCommand("github.copilot.chat.explain",r)),e.add(gt.commands.registerCommand("github.copilot.chat.explain.palette",()=>r(void 0,!0))),e.add(gt.commands.registerCommand("github.copilot.interactiveEditor.review",()=>Yx(t,"selection"))),e.add(gt.commands.registerCommand("github.copilot.interactiveEditor.review.stagedChanges",()=>Yx(t,"index"))),e.add(gt.commands.registerCommand("github.copilot.interactiveEditor.review.changes",()=>Yx(t,"workingTree"))),e.add(gt.commands.registerCommand("github.copilot.interactiveEditor.review.apply",n)),e.add(gt.commands.registerCommand("github.copilot.interactiveEditor.review.continueInInlineChat",o)),e.add(gt.commands.registerCommand("github.copilot.interactiveEditor.review.continueInChat",s)),e.add(gt.commands.registerCommand("github.copilot.interactiveEditor.review.discard",a)),e.add(gt.commands.registerCommand("github.copilot.interactiveEditor.review.discardAll",c)),e.add(gt.commands.registerCommand("github.copilot.interactiveEditor.review.markHelpful",u)),e.add(gt.commands.registerCommand("github.copilot.interactiveEditor.review.markUnhelpful",l)),e.add(gt.commands.registerCommand("github.copilot.interactiveEditor.review.previous",v=>p(v,-1))),e.add(gt.commands.registerCommand("github.copilot.interactiveEditor.review.next",v=>p(v,1))),e.add(gt.commands.registerCommand("github.copilot.interactiveEditor.review.current",v=>p(v,0))),e.add(gt.commands.registerCommand("github.copilot.interactiveEditor.generate",f)),e.add(gt.commands.registerCommand("github.copilot.interactiveEditor.generateDocs",m)),e.add(gt.commands.registerCommand("github.copilot.interactiveEditor.generateTests",h)),e.add(gt.commands.registerCommand("github.copilot.interactiveEditor.fix",g)),e.add(gt.languages.registerCodeActionsProvider("*",new ry(t),{providedCodeActionKinds:ry.providedCodeActionKinds})),e.add(gt.languages.registerCodeActionsProvider("*",new Yw(t),{providedCodeActionKinds:Yw.providedCodeActionKinds})),e.add(gt.notebooks.registerNotebookCellStatusBarItemProvider("jupyter-notebook",new UL(t))),e}function J6e(t,e){let r=t.get(vo),n=r.findReviewComment(e);!n||n.suggestion||(n.suggestion=(async()=>{let o=n.body instanceof gt.MarkdownString?n.body.value:n.body,a=t.get(te).createInstance(au,"editorAgentName","options.rejectionMessage"),c=t.get(kt).activeTextEditor,u=c?.document;if(!c||!u)throw new Error("No file specified.");let l=new gt.Selection(n.range.start,n.range.end),d=await a.prepareInteractiveEditorSession({document:u,selection:l}),p=d.wholeRange??l,f="fix",m=o,h={location:gt.ChatLocation.Editor,location2:new gt.ChatRequestEditorData(c.document,l,p),command:f,prompt:m,selection:l,wholeRange:p,references:[],attempt:0,enableCommandDetection:!1},g="",v=[],y=new gc(_=>{_ instanceof gt.ChatResponseTextEditPart&&_.edits.length>0?v.push(..._.edits.map(S=>({range:S.range,newText:S.newText,oldText:u.getText(S.range)}))):_ instanceof gt.ChatResponseMarkdownPart&&(g+=_.value.value)});await a.provideInteractiveEditorResponse(d,h,y,an.None);let b={markdown:g,edits:v};return n.suggestion=b,r.updateReviewComment(n),e.contextValue=v.length?"hasSuggestion":"hasNoSuggestion",b})().catch(o=>(t.get(ue).defaultLogger.error("Error fetching suggestion",o),n.suggestion={markdown:`Error fetching suggestion: ${o?.message}`,edits:[]},r.updateReviewComment(n),n.suggestion)),r.updateReviewComment(n))}var QH=z(Qt());var cu=z(at());var KL=class extends Q{async prepare(){return{}}render(e,r){return vscpp(vscppf,null,vscpp(vscppf,null,vscpp(cu.SystemMessage,{priority:1e3},"You are an AI that creates a detailed content outline for a Jupyter notebook on a given topic.",vscpp("br",null),vscpp(Hr,null),vscpp(yi,null),vscpp(Di,null),vscpp(cr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"DO NOT include Introduction or Conclusion section in the outline!",vscpp("br",null),"Focus only on sections that will need code!",vscpp("br",null),["","Generate the outline as two parts:","- First part is markdown bullet list of section titles","- Second part is the JSON data that will validate against this JSON schema, wrap the response in code block. We assume that a code block begins with ```[optionally the language] and ends with ```","","The JSON schema is:","{",'  "$schema": "http://json-schema.org/draft-07/schema#",','  "type": "object",','  "properties": {','	"description": {','	  "type": "string"',"	},",'	"sections": {','	  "type": "array",','	  "items": {','		"type": "object",','		"properties": {','		  "title": {','			"type": "string"',"		  },",'		  "content": {','			"type": "string"',"		  }","		},",'		"required": ["title", "content"]',"	  }","	}","  },",'  "required": ["sections"]',"}"].join(`
`),["","Examples:","","Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.","","## Valid notebook creation question","","user: Creating Random Arrays with Numpy","","assistant: Here's an outline for a Jupyter notebook that creates Random Arrays with Numpy:","","* **Import Required Libraries**","* **Create Random Arrays**","* **Seed the Random Number Generator**","* **Generate Random Integers**","","```json","{",'  "description": "A Jupyter notebook that creates Random Arrays with Numpy.",','  "sections": [',"    {",'      "title": "Import Required Libraries",','      "content": "Import the necessary libraries, including NumPy."',"    },","    {",'      "title": "Create Random Arrays",','      "content": "Use NumPy to create random arrays of various shapes and sizes, including 1D, 2D, and 3D arrays."',"    },","    {",'      "title": "Seed the Random Number Generator",','      "content": "Use the seed() function to seed the random number generator for reproducibility."',"    },","	{",'	  "title": "Generate Random Integers",','	  "content": "Use the randint() function to generate random integers within a specified range."',"	}","  ]","}","```"].join(`
`))),this.props.chatVariables&&Object.keys(this.props.chatVariables).length>0?vscpp(Kr,{flexGrow:2,priority:900,chatVariables:this.props.chatVariables,query:`Create notebook: ${this.props.query}`}):vscpp(cu.UserMessage,{priority:900},"Create notebook: ",this.props.query))}},YL=class extends Q{async prepare(){return{}}render(e,r){return vscpp(vscppf,null,vscpp(vscppf,null,this.props.history&&vscpp(YH,{messages:this.props.history.chatMessages??[]}),vscpp(cu.SystemMessage,{priority:1e3},"You are an AI that writes Python code for a single section of a Jupyter notebook.",vscpp("br",null),vscpp(Hr,null),vscpp(yi,null),vscpp(cr,null),"When dealing with Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells directly without importing it again. For the same reason, if a variable is defined in a cell, it can be used in other cells as well",vscpp("br",null),"When dealing with Jupyter Notebook, cells below the current cell can be executed before the current cell, you must use the variables defined in the cells below, unless you want to overwrite them.",vscpp("br",null),"When dealing with Jupyter Notebook, do not generate CELL INDEX in the code blocks in your answer, it is only used to help you understand the context.",vscpp("br",null),"If the Jupyter Notebook already contains variables, you should respect the name and value of the variables, and use them in your code when necessary.",vscpp("br",null),"Your output should be valid Python code with inline comments.",vscpp("br",null),"You should return the code directly without any explantion.",vscpp("br",null),"You should not print message to explain the code or purpose of the code.",vscpp("br",null),"You should return the code directly, without wrapping it inside \\`\\`\\`.",vscpp("br",null),"Please make sure that the new code is syntactically valid Python code. It can be validated by running it in a Python interpreter.",vscpp("br",null),"For example, it should pass the validation through builtin module codeop \\`codeop.compile_command(statement)\\`.",vscpp("br",null)),vscpp(cu.UserMessage,{priority:900},"Overall topic of the notebook: ",this.props.description,vscpp("br",null),"Title of the notebook section: ",this.props.section.title,vscpp("br",null),"Description of the notebok section: ",this.props.section.content,vscpp("br",null),"Given this information, write all the code for this section and this section only.",vscpp("br",null),"The request to generate the outline of the notebook is already completed.",vscpp("br",null),"Here is the request details for the outline generation:",vscpp("br",null),vscpp("br",null),"Code in the notebook so far:",vscpp("br",null),vscpp("br",null),this.props.existingCode,vscpp("br",null),vscpp("br",null),"Please make sure the new code you generate works fine with the code above.",vscpp("br",null))))}},YH=class extends Q{render(e,r){let n=[];for(let o of this.props.messages)switch(o.role){case"user":n.push(vscpp(cu.UserMessage,{priority:800},o.content));break;case"assistant":n.push(vscpp(cu.AssistantMessage,{priority:800},o.content));break;case"system":n.push(vscpp(cu.SystemMessage,{priority:100},o.content));break;default:break}return vscpp(vscppf,null,n)}},QL=class extends Q{async prepare(){return{}}render(e,r){return vscpp(vscppf,null,vscpp(vscppf,null,vscpp(cu.SystemMessage,{priority:1e3},"You are an AI that improves Python code with respect to readability and performance for a single section of a Jupyter notebook.",vscpp("br",null),vscpp(Hr,null),vscpp(yi,null),vscpp(cr,null),"You MUST return Python code as your answer.",vscpp("br",null),"DO NOT explain in inline comments for your the improvements.",vscpp("br",null),"You should not print messages to explain the code or purpose of the code.",vscpp("br",null),"Make sure the new code you generate works fine with the code above.",vscpp("br",null),"Make sure if a module is already imported in the code above, it can be used in the new code directly without importing it again. For the same reason, if a variable is defined above, it can be used in new code as well. ",vscpp("br",null),"Make sure to return the code only - don't give an explanation of the improvements.",vscpp("br",null)),vscpp(cu.UserMessage,{priority:900},"Overall topic of the notebook: ",this.props.description,vscpp("br",null),"Title of the notebook section: ",this.props.section.title,vscpp("br",null),"Description of the notebook section: ",this.props.section.content,vscpp("br",null),"Code in the notebook so far:",vscpp("br",null),vscpp("br",null),this.props.existingCode,vscpp("br",null),vscpp("br",null),"Given this information, suggest improvements for the following code:",vscpp("br",null),vscpp("br",null),this.props.code,vscpp("br",null),vscpp("br",null))))}};var XL=class{constructor(){this.stagedTextToApply="";this.reporting=!0;this._appliedText="";this._resolvedContentDeferredPromise=new Yp;this._incodeblock=!1;this._presentCodeblockProgress=!1}async processResponse(e,r,n,o,s){for await(let{delta:a}of n){if(s.isCancellationRequested)return this._appliedText;this.applyDelta(a.text,e,o)}return this._appliedText}applyDeltaToTurn(e,r){r.response||(r.response={message:e,type:"model"}),this._appliedText+=e,r.response.message+=e}applyDeltaToProgress(e,r){r.markdown(e)}applyDelta(e,r,n){if(!this.reporting){this.applyDeltaToTurn(e,r);return}if(e=this.stagedTextToApply+e,this._incodeblock){let s=e.indexOf("```");if(s===-1){this.stagedTextToApply=e,this.applyDeltaToTurn("",r),this._presentCodeblockProgress||(this._presentCodeblockProgress=!0,n.progress(QH.t("Thinking ...")));return}else{this._incodeblock=!1,e=e.substring(0,s)+"```";try{this.applyDeltaToTurn(e,r)}catch{}finally{this.reporting=!1,this.stagedTextToApply="",this._resolvedContentDeferredPromise.complete(new Qi(""))}return}}let o=e.indexOf("```");if(o!==-1){this._incodeblock=!0;let s=e.indexOf("```",o+3);if(s!==-1){this._incodeblock=!1,this.applyDeltaToProgress(e.substring(0,o),n),this.applyDeltaToProgress(e.substring(s+3),n),this.applyDeltaToTurn(e,r),this.reporting=!1,this.stagedTextToApply="";return}else{let a=e.substring(0,o);this.applyDeltaToProgress(a,n),this.applyDeltaToTurn(e,r),this.stagedTextToApply="",this._presentCodeblockProgress||(this._presentCodeblockProgress=!0,n.progress(QH.t("Thinking ..."))),this._resolvedContentDeferredPromise.p.then(c=>n.push(c));return}}this.applyDeltaToProgress(e,n),this.applyDeltaToTurn(e,r),this.stagedTextToApply=""}};async function ice(t,e,r,n,o,s,a,c){let u={messageSource:"slash.newNotebook"},{messages:l}=await Xi(t.get(te),e,YL,{history:n,description:o,section:s,existingCode:a}),p=await t.get(Bt).fetchOne(l,void 0,c,2,e,void 0,{temperature:r.temperature,top_p:r.topP},u);if(p.type!=="success")return;let f=Cs(p.value);return f.length>0?f[0].code:p.value}async function oce(t,e,r,n,o,s,a,c){let u={messageSource:"slash.newNotebook"},{messages:l}=await Xi(t.get(te),e,QL,{description:n,section:o,existingCode:s,code:a}),p=await t.get(Bt).fetchOne(l,void 0,c,2,e,void 0,{temperature:r.temperature,top_p:r.topP},u);if(p.type==="success")return p.value}var JH=z(Qt());var eo=ae("ITerminalService");var R1=z(at());var sce=z(at());var T1=class extends Q{constructor(r,n){super(r);this._terminalService=n}static{this.variableInfo={name:"terminalLastCommand",description:"The active terminal's last run command",defaultEnablement:!0}}async prepare(){return this._terminalService.terminalLastCommand}render(r,n){if(!r)return;let o=[];r.commandLine&&(o.push("The following is the last command run in the terminal:"),o.push(r.commandLine)),r.cwd&&(o.push("It was run in the directory:"),o.push(typeof r.cwd=="object"?r.cwd.toString():r.cwd)),r.output&&(o.push("It has the following output:"),o.push(r.output));let s=o.join(`
`);return vscpp(vscppf,null,vscpp(sce.UserMessage,{priority:this.props.priority},"The active terminal's last run command:",vscpp("br",null),s))}};T1=O([x(1,eo)],T1);var XH=z(at());var w1=class extends Q{constructor(r,n){super(r);this._terminalService=n}static{this.variableInfo={name:"terminalSelection",description:"The active terminal's selection",defaultEnablement:!0}}async prepare(){return this._terminalService.terminalSelection}render(r,n){return r.trim().length===0?vscpp(vscppf,null,vscpp(XH.UserMessage,{priority:this.props.priority},"The active terminal has no selection.")):vscpp(vscppf,null,vscpp(XH.UserMessage,{priority:this.props.priority},"The active terminal's selection:",vscpp("br",null),r))}};w1=O([x(1,eo)],w1);var JL=class extends Q{render(e){let{query:r,history:n,chatVariables:o,customInstructions:s}=this.props.promptContext;return vscpp(vscppf,null,vscpp(R1.SystemMessage,{priority:1e3},"You are a programmer who specializes in using the command line. Your task is to help the Developer by giving a detailed answer to their query.",vscpp("br",null),vscpp(Hr,null),vscpp(Zt,null),vscpp(Di,null),vscpp(cr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),`Generate a response that clearly and accurately answers the user's question. In your response, follow the following:
- Provide any command suggestions using the active shell and operating system.
- Say "I'm not quite sure how to do that." when you aren't confident in your explanation`,vscpp("br",null)),vscpp(Lt,{flexGrow:1,priority:600,history:n}),vscpp(R1.UserMessage,{flexGrow:1,priority:750},vscpp(Yr,{customInstructions:s})),vscpp(R1.UserMessage,{flexGrow:1,priority:800},"The active terminal's shell type is:",vscpp("br",null),this.props.shellType),vscpp(R1.UserMessage,{flexGrow:1,priority:800},"The active operating system is:",vscpp("br",null),this.props.osName),vscpp(w1,{flexGrow:1,priority:800}),vscpp(T1,{flexGrow:1,priority:800}),vscpp(Kr,{flexGrow:2,priority:900,chatVariables:o,query:r}))}};var bl=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id=bl.ID;this.locations=[2];this.description=JH.t("Explain what just happened in the terminal");this.commandInfo={allowsEmptyArgs:!0,defaultEnablement:!0,sampleRequest:JH.t("What did the last command do?")}}static{this.ID="terminalExplain"}static{this.intentName="explain"}get intentDetectionInput(){let e="explain_terminal_state";return{functionName:e,sampleQuestion:"What did the last command do?",functionCallingBlurb:`If the user's message is about explaining what happened in the terminal, you should use the '${e}' function.`}}async invoke(e){let r=e.location,n=await Mn(this.endpointProvider,r);return this.instantiationService.createInstance(tR,this,n,r)}};bl=O([x(0,te),x(1,Le)],bl);var tR=class{constructor(e,r,n,o,s,a){this.intent=e;this.endpoint=r;this.location=n;this.instantiationService=o;this.envService=s;this.terminalService=a}async buildPrompt(e,r,n){let o=this.envService.OS,s=this.terminalService.terminalShellType;return await $e.create(this.instantiationService,this.endpoint,JL,{promptContext:e,osName:o,shellType:s}).render(r,n)}};tR=O([x(3,te),x(4,Rt),x(5,eo)],tR);var iy=z(Qt()),Xr=z(require("vscode"));function ace(t){let e=new Tt,r=t.get(su);return r.setEnablement(t.get(Ut)),e8e(e,t.get(me)),t8e(r,e),Z6e(e),e}function Z6e(t){async function e(r){let n=xs.first(r.entries());if(!n)return;await Xr.workspace.applyEdit(r,{isRefactoring:!0});let o=await Xr.workspace.openTextDocument(n[0]);await Xr.window.showTextDocument(o,{preview:!0,selection:n[1][0].range})}t.add(Xr.commands.registerCommand("github.copilot.tests.fixTestFailure.applyAndRerun",async(r,n,o)=>{await e(n),await q_(1e3),Xr.commands.executeCommand("testing.reRunFailTests");let s=await new Promise(d=>{let p=Xr.tests.onDidChangeTestResults(()=>{Xr.tests.testResults.length&&(d(Xr.tests.testResults[0]),p.dispose())})}),a=r8e(r,s.results);if(a===void 0||!a.taskStates.some(d=>d.state===Xr.TestResultState.Failed||d.state===Xr.TestResultState.Errored))return;let c=iy.t("Undo"),u=iy.t("Try Fixing Again"),l=await Xr.window.showInformationMessage(iy.t("Looks like the test still failed. What would you like to do?"),iy.t("Keep Changes"),c,u);if(l===u){let d=OA(a.taskStates,p=>p.messages.find(f=>!!f.location));d?Xr.commands.executeCommand("github.copilot.tests.fixTestFailure",{message:d,test:a,source:"retry"}):Xr.commands.executeCommand("vscode.editorChat.start",{message:"/fixTestFailure",autoSend:!0})}else l===c&&await e(o)}))}function e8e(t,e){t.add(Xr.commands.registerCommand("github.copilot.tests.fixTestFailure",async r=>{if(!r.test.uri)return;e.sendMSFTTelemetryEvent("intent.fixTestFailure.actioned",{source:r.source??"testResultsPanel"});let n=await Xr.workspace.openTextDocument(r.test.uri);await Xr.window.showTextDocument(n,{preserveFocus:!1,preview:!0,selection:r.test.range?new Xr.Range(r.test.range.start,r.test.range.start):void 0}),await Xr.commands.executeCommand("vscode.editorChat.start",{message:"/fixTestFailure",autoSend:!0})}))}function t8e(t,e){e.add(Xr.languages.registerCodeActionsProvider("*",{provideCodeActions(r,n,o,s){if(!Xr.workspace.getConfiguration("github.copilot.editor").get("enableCodeActions")||!t.isEnabled.get())return;let c=t.getFailureAtPosition(r.uri,n.start);if(!c)return;let u=new Xr.CodeAction(iy.t("Fix test failure"),Xr.CodeActionKind.QuickFix);return u.isAI=!0,u.command={title:iy.t("Fix test failure"),command:"github.copilot.tests.fixTestFailure",arguments:[{message:c.task.messages[0],test:c.snapshot,source:"sparkles"}]},[u]}}))}function r8e(t,e){let r=[];for(let n=t;n;n=n.parent)r.push(n.id);for(let n=r.length-1;n>=0;n--){let o=r[n],s=e.find(a=>a.id===o);if(!s)return;if(n===0)return s;e=s.children}}var jr=z(require("vscode"));function ZL(t,e){if(!e.length)return;let r;for(let n of t)if(n.children){let o=n.name===e[0]?{symbol:n,matchCount:1}:void 0;if(o){let c=ZL(n.children,e.slice(1));c&&(o={symbol:c.symbol,matchCount:o.matchCount+c.matchCount})}let s=ZL(n.children,e),a;o&&s?a=o.matchCount>=s.matchCount?o:s:a=o??s,a&&(!r||a.matchCount>r?.matchCount)&&(r=a)}else n.name===e[0]&&(r??={symbol:n,matchCount:1});return r}function cce(t,e){return(ZL(t,[e])??ZL(t,n8e(e)))?.symbol}function n8e(t){return Array.from(t.matchAll(/[#\w$][\w\d$]*/g),e=>e[0])}var e4="_github.copilot.openSymbolFromReferences";function uce(t){return BA(jr.commands.registerCommand(Wh,async e=>{t.sendMSFTTelemetryEvent("panel.action.filelink");let r=jr.workspace.workspaceFolders?.[0].uri;if(!r)return;let n=typeof e=="string"?jr.Uri.joinPath(r,e):jr.Uri.from(e);if(await o(n))await jr.commands.executeCommand("revealInExplorer",n);else return jr.commands.executeCommand("vscode.open",n);async function o(s){if(s.path.endsWith("/"))return!0;try{return(await jr.workspace.fs.stat(s)).type===jr.FileType.Directory}catch{return!1}}}),jr.commands.registerCommand(y1,async(e,r)=>{let n=jr.Uri.from(e),o=await jr.commands.executeCommand("vscode.executeDocumentSymbolProvider",n);if(o){let s=cce(o,r);if(t.sendMSFTTelemetryEvent("panel.action.symbollink",{},{hadMatch:s?1:0}),s){let a=s instanceof jr.SymbolInformation?s.location.range:s.selectionRange;return jr.commands.executeCommand("vscode.open",n,{selection:new jr.Range(a.start,a.start)})}}return jr.commands.executeCommand("vscode.open",n)}),jr.commands.registerCommand(e4,async(...e)=>{t.sendMSFTTelemetryEvent("panel.action.openSymbolFromReferencesLink");let r;if(typeof e[0]=="string"){let[n,o]=e;for(let s of o){let a=(await jr.commands.executeCommand("vscode.executeDefinitionProvider",jr.Uri.from(s.uri),s.pos)).at(0);if(a){r=i8e(a);break}}r||(r=new jr.Location(jr.Uri.from(o[0].uri),o[0].pos))}else{let[n,o]=e;r=new jr.Location(jr.Uri.from(n),o)}r&&await jr.commands.executeCommand("vscode.open",r.uri,{selection:new jr.Range(r.range.start,r.range.start)})}))}function i8e(t){return"uri"in t?t:new jr.Location(t.targetUri,t.targetRange)}var fce=z(Qt());var xc=z(require("vscode"));var t4=class t{constructor(e,r,n,o){this._uri=e,this._languageId=r,this._version=n,this._content=o,this._lineOffsets=void 0}get uri(){return this._uri}get languageId(){return this._languageId}get version(){return this._version}getText(e){if(e){let r=this.offsetAt(e.start),n=this.offsetAt(e.end);return this._content.substring(r,n)}return this._content}update(e,r){for(let n of e)if(t.isIncremental(n)){let o=dce(n.range),s=this.offsetAt(o.start),a=this.offsetAt(o.end);this._content=this._content.substring(0,s)+n.text+this._content.substring(a,this._content.length);let c=Math.max(o.start.line,0),u=Math.max(o.end.line,0),l=this._lineOffsets,d=lce(n.text,!1,s);if(u-c===d.length)for(let f=0,m=d.length;f<m;f++)l[f+c+1]=d[f];else d.length<1e4?l.splice(c+1,u-c,...d):this._lineOffsets=l=l.slice(0,c+1).concat(d,l.slice(u+1));let p=n.text.length-(a-s);if(p!==0)for(let f=c+1+d.length,m=l.length;f<m;f++)l[f]=l[f]+p}else if(t.isFull(n))this._content=n.text,this._lineOffsets=void 0;else throw new Error("Unknown change event received");this._version=r}getLineOffsets(){return this._lineOffsets===void 0&&(this._lineOffsets=lce(this._content,!0)),this._lineOffsets}positionAt(e){e=Math.max(Math.min(e,this._content.length),0);let r=this.getLineOffsets(),n=0,o=r.length;if(o===0)return{line:0,character:e};for(;n<o;){let a=Math.floor((n+o)/2);r[a]>e?o=a:n=a+1}let s=n-1;return{line:s,character:e-r[s]}}offsetAt(e){let r=this.getLineOffsets();if(e.line>=r.length)return this._content.length;if(e.line<0)return 0;let n=r[e.line],o=e.line+1<r.length?r[e.line+1]:this._content.length;return Math.max(Math.min(n+e.character,o),n)}get lineCount(){return this.getLineOffsets().length}static isIncremental(e){let r=e;return r!=null&&typeof r.text=="string"&&r.range!==void 0&&(r.rangeLength===void 0||typeof r.rangeLength=="number")}static isFull(e){let r=e;return r!=null&&typeof r.text=="string"&&r.range===void 0&&r.rangeLength===void 0}},r4;(function(t){function e(o,s,a,c){return new t4(o,s,a,c)}t.create=e;function r(o,s,a){if(o instanceof t4)return o.update(s,a),o;throw new Error("TextDocument.update: document must be created by TextDocument.create")}t.update=r;function n(o,s){let a=o.getText(),c=ZH(s.map(o8e),(d,p)=>{let f=d.range.start.line-p.range.start.line;return f===0?d.range.start.character-p.range.start.character:f}),u=0,l=[];for(let d of c){let p=o.offsetAt(d.range.start);if(p<u)throw new Error("Overlapping edit");p>u&&l.push(a.substring(u,p)),d.newText.length&&l.push(d.newText),u=o.offsetAt(d.range.end)}return l.push(a.substr(u)),l.join("")}t.applyEdits=n})(r4||(r4={}));function ZH(t,e){if(t.length<=1)return t;let r=t.length/2|0,n=t.slice(0,r),o=t.slice(r);ZH(n,e),ZH(o,e);let s=0,a=0,c=0;for(;s<n.length&&a<o.length;)e(n[s],o[a])<=0?t[c++]=n[s++]:t[c++]=o[a++];for(;s<n.length;)t[c++]=n[s++];for(;a<o.length;)t[c++]=o[a++];return t}function lce(t,e,r=0){let n=e?[r]:[];for(let o=0;o<t.length;o++){let s=t.charCodeAt(o);(s===13||s===10)&&(s===13&&o+1<t.length&&t.charCodeAt(o+1)===10&&o++,n.push(r+o+1))}return n}function dce(t){let e=t.start,r=t.end;return e.line>r.line||e.line===r.line&&e.character>r.character?{start:r,end:e}:t}function o8e(t){let e=dce(t.range);return e!==t.range?{newText:t.newText,range:e}:t}async function rR(t,e,r,n){let o=t.get(mt);return Xt(await Promise.all(e.map(s=>{if(qT(s.anchor))return ej(o,r,s.anchor,new xc.Range(0,0,Number.MAX_SAFE_INTEGER,0),n);if("range"in s.anchor)return ej(o,r,s.anchor.uri,s.anchor.range,n);if("value"in s.anchor&&dt.isUri(s.anchor.value))return ej(o,r,s.anchor.value,new xc.Range(0,0,Number.MAX_SAFE_INTEGER,0),n)})))}async function ej(t,e,r,n,o){let s=await s8e(r);if(!s||o.isCancellationRequested)return;let a=await a8e(t,s,n,o);if(o.isCancellationRequested)return;for(let l of a)if(l.identifier===e){let d=s.positionAt(l.startIndex);return new xc.Location(r,d)}let c=s.getText(n),u=s.offsetAt(n.start);for(let l of c.matchAll(new RegExp(k0(e),"g")))if(l.index){let d=s.positionAt(u+l.index);if("getWordRangeAtPosition"in s){let p=s.getText(s.getWordRangeAtPosition(d));if(e===p)return new xc.Location(r,d)}else{let p=s.getText(new xc.Range(d,s.positionAt(s.offsetAt(d)+e.length)));if(e===p)return new xc.Location(r,d)}}}async function s8e(t){let e=xc.workspace.textDocuments.find(r=>r.uri.toString()===t.toString());if(e)return e;try{let r=await xc.workspace.fs.readFile(t),n=hd(t).languageId,o=r4.create(t.toString(),n,0,new TextDecoder().decode(r));return new class{constructor(){this.languageId=n}getText(s){return o.getText(s)}offsetAt(s){return o.offsetAt(s)}positionAt(s){let a=o.positionAt(s);return new xc.Position(a.line,a.character)}}}catch{return}}async function a8e(t,e,r,n){let o=lf(e.languageId);if(!o)return[];let s=t.getTreeSitterASTForWASMLanguage(o,e.getText());return s?s.getSymbols({startIndex:e.offsetAt(r.start),endIndex:e.offsetAt(r.end)}):[]}var pce=/(?<!\[)`([^`]+)`(?!\])/g,k1=class{constructor(e){this.instantiationService=e;this.symbolCache=new Map}async linkify(e,r,n){if(!r.length)return;let o=new Map;for(let[u,l]of e.matchAll(pce)){if(o.has(l))continue;let d=this.symbolCache.get(l);if(d)o.set(l,d);else{let p=this.resolveWordMatches(r,l,n);this.symbolCache.set(l,p),o.set(l,p)}}let s=new Map(await Promise.all(Array.from(o.entries(),async([u,l])=>[u,await l]))),a=0,c=e.replace(pce,(u,l)=>{let d=s.get(l);return d?.length?(a++,this.createOpenSymbolCommand(l,d,u)):u});if(a)return{text:c,trustedCommands:[e4],addedLinkCount:a}}async resolveWordMatches(e,r,n){let o=await this.instantiationService.invokeFunction(s=>rR(s,e,r,n));if(n.isCancellationRequested)return[];if(!o.length){let s=r.split(/([#\w$][\w\d$]*)/g).map(c=>c.trim()).filter(c=>c.length),a;for(let c of s){if(!/[#\w$][\w\d$]*/.test(c))break;a=c}if(a&&a!==r&&(o=await this.instantiationService.invokeFunction(c=>rR(c,e,a,n)),n.isCancellationRequested))return[]}return o}createOpenSymbolCommand(e,r,n){let o=Td(e4,[e,r.map(s=>({uri:s.uri,pos:s.range.start}))]);return`[${n}](${o} "${(0,fce.t)("Go to definition")}")`}};k1=O([x(0,te)],k1);function rj(t){return/^[a-z][a-z0-9]*$/.test(t)?"lowercase":/^[a-z][a-zA-Z0-9]*$/.test(t)?"camelCase":/^[a-z]+(_[a-z0-9]+)*$/.test(t)?"snake_case":/^[a-z]+(-[a-z0-9]+)*$/.test(t)?"kebab-case":/^[A-Z][a-z0-9]*$/.test(t)?"Capitalized":/^[A-Z0-9]+(_[A-Z0-9]+)+$/.test(t)?"SCREAMING_SNAKE_CASE":/^[A-Z]+$/.test(t)?"Uppercase":/^[A-Z][a-zA-Z0-9]*$/.test(t)?"PascalCase":/^[A-Z][a-z0-9]*(_[a-z0-9]+)*$/.test(t)?"Capital_snake_case":"Unknown"}function tj(t){return t.map((e,r)=>r===0?e.toLowerCase():e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()).join("")}function c8e(t){return t.map(e=>e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()).join("")}function n4(t){return t.map(e=>e.toLowerCase()).join("_")}function u8e(t){return t.map(e=>e.toLowerCase()).join("-")}function mce(t,e){let r=rj(t);if(r===e)return t;{let n=l8e(t,r);switch(e){case"camelCase":return tj(n);case"PascalCase":return c8e(n);case"snake_case":return n4(n);case"SCREAMING_SNAKE_CASE":return n4(n).toUpperCase();case"Capital_snake_case":return n4(n).charAt(0).toUpperCase()+n4(n).substring(1);case"kebab-case":return u8e(n);case"Capitalized":return tj(n).charAt(0).toUpperCase()+tj(n).substring(1);case"Uppercase":return t.toUpperCase();case"lowercase":return t.toLowerCase();case"Unknown":return t}}}function l8e(t,e){switch(e){case"camelCase":case"PascalCase":return t.split(/(?=[A-Z])/);case"snake_case":case"SCREAMING_SNAKE_CASE":case"Capital_snake_case":case"kebab-case":return t.split(/[-_]/).map(r=>r.toLowerCase());case"Capitalized":case"Uppercase":case"lowercase":case"Unknown":return[t]}}var A1=z(at());var hce=z(at());var Kh=class extends hce.PromptElement{constructor(r,n,o,s,a,c,u,l,d){super(r);this._languageFeaturesService=o;this._workspaceService=s;this._vscodeExtensionCtxService=a;this._ignoreService=c;this._logService=u;this._parserService=l;this._telemetryService=d;this._logger=n.getLogger("DefinitionAtPosition")}static{this.DEFAULT_TIMEOUT_MS=200}async prepare(){if(await this._ignoreService.isCopilotIgnored(this.props.document.uri))return{k:"ignored"};let r=this._vscodeExtensionCtxService.extensionMode===$c.Test?0:this.props.timeoutMs===void 0?Kh.DEFAULT_TIMEOUT_MS:this.props.timeoutMs,n=await this.findDefinition(r);return this._logger.debug(`Found ${n.length} implementation(s)/definition(s)`),n.length>0&&this._logger.debug("Implementation(s)/definition(s) found:",JSON.stringify(n,null,"	")),{k:"found",definitions:n}}render(r,n){if(r.k==="ignored")return vscpp("ignoredFiles",{value:[this.props.document.uri]});let{document:o,position:s}=this.props,{definitions:a}=r;if(a.length===0){let c=o.lineAt(s.line);a.push({languageId:o.languageId,uri:o.uri,code:c.text,excerptRange:c.range})}return vscpp(vscppf,null,"Relevant definition",a.length>1?"s":"",": ",vscpp("br",null),vscpp("br",null),a.map(c=>{let d=`${`${Is(c.languageId).lineComment.start} FILEPATH: ${c.uri.path}`}
${c.code}`;return vscpp(Oe,{uri:c.uri,languageId:c.languageId,code:d})}))}async findDefinition(r){let{document:n,position:o}=this.props,s=async u=>{try{let l=await this._languageFeaturesService.getImplementations(n.uri,u);if(this._logger.debug(`Found ${l.length} implementations`,JSON.stringify(l,null,"	")),l.length>0)return l}catch{}try{let l=await this._languageFeaturesService.getDefinitions(n.uri,u);if(this._logger.debug(`Found ${l.length} definitions`,JSON.stringify(l,null,"	")),l.length>0)return l}catch{}return this._logger.debug("No definitions or implementations found"),[]},a=await Js(this._logService,this._telemetryService,n,r*3,()=>s(o),[]),c=Xt(await Promise.all(a.map(async u=>{let l=uf(u)?u.targetUri:n.uri;return await this._ignoreService.isCopilotIgnored(l)?void 0:u})));return Promise.all(c.map(async u=>{let{uri:l,range:d}=uf(u)?{uri:u.targetUri,range:u.targetRange}:u,p=await this._workspaceService.openTextDocument(l),f=lf(p.languageId),m,h;if(f===void 0){let g=p.lineAt(d.start.line);m=g.text,h=g.range}else h=(await yh(this._parserService,this._telemetryService,{document:p,language:Is(n.languageId),wholeRange:d,selection:new z_(d.start,d.end),fileIndentInfo:void 0})).range,m=p.getText(h);return{languageId:p.languageId,uri:p.uri,code:m,excerptRange:h}}))}};Kh=O([x(1,ue),x(2,Ai),x(3,Je),x(4,ar),x(5,De),x(6,ue),x(7,mt),x(8,me)],Kh);var P1=class extends A1.PromptElement{constructor(r,n,o){super(r);this.instaService=n;this.endpointProvider=o;let{document:s,range:a}=this.props;this._defAtPos=n.createInstance(new Be(Kh,[{document:s,position:a.start}]))}async prepare(r,n,o){let{document:s,range:a}=this.props,c=await this._defAtPos.prepare();if(!(c.k==="found"&&c.definitions.some(d=>d.excerptRange.contains(this.props.range)))){let d=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),p={document:s,fileIndentInfo:void 0,language:Is(s.languageId),wholeRange:a,selection:new z_(a.start,a.end)};this._defAroundCursor=this.instaService.createInstance(vh,{documentContext:p,endpointInfo:d})}return{defAtPositionState:c,defAroundCursorState:this._defAroundCursor?await this._defAroundCursor.prepare(r):void 0}}render(r,n){let{document:o,range:s}=this.props,a=o.getText(s),c=d8e(a),u=c?` keeping prefix '${c}'`:"",l=this._defAtPos.render(r.defAtPositionState,n),d=r.defAroundCursorState!==void 0&&this._defAroundCursor?.render(r.defAroundCursorState,n);return vscpp(vscppf,null,vscpp(A1.SystemMessage,null,"You are a distinguished software engineer.",vscpp("br",null),vscpp(Zt,null),vscpp("br",null),'You must reply with a JSON array of strings of at least four new names, e.g., `["first", "second", "third", "fourth"]`.',vscpp("br",null),"You must respect existing naming conventions",u,"."),d,vscpp(A1.UserMessage,null,l!==void 0&&vscpp(vscppf,null,l,vscpp("br",null)),"Think of the purpose of `",a,"` in the given code. Think of several names that reflect what `",a,"` is and what it does",u,". Follow existing naming conventions. Reply with a JSON array of strings of at least four new names for `",a,"`."))}};P1=O([x(1,te),x(2,Le)],P1);function d8e(t){return t.match(/^([\\.\\$\\_]+)/)?.[0]}var _l=class{constructor(e,r,n,o,s,a,c,u){this._instaService=e;this._chatMLFetcher=r;this._ignoreService=n;this._telemetryService=o;this._configurationService=s;this._logService=a;this._endpointProvider=c;this._simulationTestContext=u;this.supportsAutomaticTriggerKind=Promise.resolve(this.isEnabled(tw.Automatic)),this._promptLogger=this._logService.getPromptResponseLogger("RenameSuggestionsProvider")}isEnabled(e){return e===tw.Invoke?!0:this._configurationService.getConfig(fe.AutomaticRenameSuggestions)}async provideNewSymbolNames(e,r,n,o){let s="",a=new Ws,c=e.getText(r);if(!this.isEnabled(n))throw new Error("CopilotFeatureUnavailableOrDisabled");if(await this._ignoreService.isCopilotIgnored(e.uri))throw new Error("CopilotIgnoredDocument");let u=e.languageId,l,d;if(o.isCancellationRequested)s="afterEnablementCheck";else{let p=await this._endpointProvider.getChatEndpoint("gpt-3.5-turbo");if(l=this.delayBeforeFetchMs,o.isCancellationRequested)s="afterRunParametersFetch";else{let f=new Ws(!1);f.reset();let m=await this._computePrompt(e,r,p,o),h=f.elapsed();if(o.isCancellationRequested)s="afterPromptCompute";else{d=a.elapsed();let g;if(n===tw.Automatic&&(g=l?Math.max(0,l-d):void 0,g!==void 0&&g>0&&await new Promise(v=>setTimeout(v,g))),o.isCancellationRequested)s="afterDelay";else{this._promptLogger.logPrompt(m.messages),f.reset();let v=await this._chatMLFetcher.fetchOne(m.messages,void 0,o,3,p,{agent:"symbol-names"},void 0,{messageSource:"symbolNamesProvider"}),y=f.elapsed();switch(o.isCancellationRequested&&(s="afterFetchStarted"),this._promptLogger.logResponse(v),v.type){case"success":{let b=v.value,{replyFormat:_,symbolNames:S,redundantCharCount:I}=_l.parseResponse(b);return _==="unknown"&&this._sendInternalTelemetry({languageId:u,reply:b}),this._sendPublicTelemetry({triggerKind:n,languageId:u,cancellationReason:s,fetchResultType:v.type,promptConstructionTime:h,promptTokenCount:m.tokenCount,expectedDelayBeforeFetch:l,actualDelayBeforeFetch:g,timeElapsedBeforeDelay:d,successResponseCharCount:b.length,responseUnusedCharCount:I,fetchTime:y,replyFormat:_,symbolNamesCount:S.length}),_l.preprocessSymbolNames({currentSymbolName:c,newSymbolNames:S,languageId:u}).map(A=>new $ne(A,[Wne.AIGenerated]))}default:return this._sendPublicTelemetry({triggerKind:n,languageId:u,cancellationReason:s,fetchResultType:v.type,promptConstructionTime:h,promptTokenCount:m.tokenCount,expectedDelayBeforeFetch:l,actualDelayBeforeFetch:g,timeElapsedBeforeDelay:d,fetchTime:y}),null}}}}}return this._sendPublicTelemetry({triggerKind:n,languageId:u,cancellationReason:s,expectedDelayBeforeFetch:l,timeElapsedBeforeDelay:d}),null}get delayBeforeFetchMs(){return this._simulationTestContext.isInSimulationTests?0:250}_computePrompt(e,r,n,o){return $e.create(this._instaService,n,P1,{document:e,range:r}).render(void 0,o)}static preprocessSymbolNames({currentSymbolName:e,newSymbolNames:r,languageId:n}){let o=rj(e),s;switch(o){case"lowercase":n==="python"?s="snake_case":s="camelCase";break;case"Uppercase":case"camelCase":case"PascalCase":case"snake_case":case"SCREAMING_SNAKE_CASE":case"Capital_snake_case":case"kebab-case":case"Capitalized":case"Unknown":s=o;break;default:return o}return s==="Unknown"?r:r.map(a=>mce(a,s))}static parseResponse(e){let r=_l._parseReplyAsJSONStringArray(e);if(r!==void 0)return r;let n=_l._parseReplyAsList(e);return n!==void 0?n:{replyFormat:"unknown",symbolNames:[],redundantCharCount:e.length}}static _parseReplyAsJSONStringArray(e){let r=/\[.*?\]/gs,n=[...e.matchAll(r)];for(let o=0;o<n.length;o++){let s=n[o];try{let a=JSON.parse(s[0]);if(Array.isArray(a)){let c=a.filter(u=>typeof u=="string");if(c.length>0){let u=o===0?"jsonStringArray":"multiJsonStringArray",l=e.length-s[0].length;return{replyFormat:u,redundantCharCount:l,symbolNames:c.map(d=>d.trim())}}}}catch{}}}static _parseReplyAsList(e){let r=/(?:\d+[\.|\)]|[\*\-])\s*(.*)/g,n=e.matchAll(r),o=[];for(let a of n){let c=a[1].trim(),u=["'",'"',"`"];u.includes(c[0])&&(c=c.slice(1)),u.includes(c[c.length-1])&&(c=c.slice(0,-1)),c&&o.push(c)}return o.length===0?void 0:{replyFormat:"list",redundantCharCount:e.length-o.reduce((a,c)=>a+c.length,0),symbolNames:o}}_sendPublicTelemetry({triggerKind:e,languageId:r,cancellationReason:n,fetchResultType:o,timeElapsedBeforeDelay:s,promptConstructionTime:a,promptTokenCount:c,expectedDelayBeforeFetch:u,actualDelayBeforeFetch:l,successResponseCharCount:d,responseUnusedCharCount:p,fetchTime:f,replyFormat:m,symbolNamesCount:h}){this._telemetryService.sendMSFTTelemetryEvent("provideRenameSuggestions",{languageId:r,cancellationReason:n,fetchResultType:o,replyFormat:m,triggerKind:e===tw.Automatic?"automatic":"manual"},{promptConstructionTime:a,promptTokenCount:c,expectedDelayBeforeFetch:u,actualDelayBeforeFetch:l,timeElapsedBeforeFetch:s,fetchTime:f,successResponseCharCount:d,responseUnusedCharCount:p,symbolNamesCount:h})}_sendInternalTelemetry({languageId:e,reply:r}){this._telemetryService.sendMSFTTelemetryEvent("provideRenameSuggestionsIncorrectFormatResponse",{languageId:e,reply:r})}static _determinePrefix(e){return e.match(/^([\\.\\$\\_]+)/)?.[0]}};_l=O([x(0,te),x(1,Bt),x(2,De),x(3,me),x(4,ye),x(5,ue),x(6,Le),x(7,df)],_l);var oy=z(require("vscode"));var Qh=z(Qt());function i4(t,e=!1){let r=t.length,n=0,o="",s=0,a=16,c=0,u=0,l=0,d=0,p=0;function f(_,S){let I=0,T=0;for(;I<_||!S;){let A=t.charCodeAt(n);if(A>=48&&A<=57)T=T*16+A-48;else if(A>=65&&A<=70)T=T*16+A-65+10;else if(A>=97&&A<=102)T=T*16+A-97+10;else break;n++,I++}return I<_&&(T=-1),T}function m(_){n=_,o="",s=0,a=16,p=0}function h(){let _=n;if(t.charCodeAt(n)===48)n++;else for(n++;n<t.length&&D1(t.charCodeAt(n));)n++;if(n<t.length&&t.charCodeAt(n)===46)if(n++,n<t.length&&D1(t.charCodeAt(n)))for(n++;n<t.length&&D1(t.charCodeAt(n));)n++;else return p=3,t.substring(_,n);let S=n;if(n<t.length&&(t.charCodeAt(n)===69||t.charCodeAt(n)===101))if(n++,(n<t.length&&t.charCodeAt(n)===43||t.charCodeAt(n)===45)&&n++,n<t.length&&D1(t.charCodeAt(n))){for(n++;n<t.length&&D1(t.charCodeAt(n));)n++;S=n}else p=3;return t.substring(_,S)}function g(){let _="",S=n;for(;;){if(n>=r){_+=t.substring(S,n),p=2;break}let I=t.charCodeAt(n);if(I===34){_+=t.substring(S,n),n++;break}if(I===92){if(_+=t.substring(S,n),n++,n>=r){p=2;break}switch(t.charCodeAt(n++)){case 34:_+='"';break;case 92:_+="\\";break;case 47:_+="/";break;case 98:_+="\b";break;case 102:_+="\f";break;case 110:_+=`
`;break;case 114:_+="\r";break;case 116:_+="	";break;case 117:let A=f(4,!0);A>=0?_+=String.fromCharCode(A):p=4;break;default:p=5}S=n;continue}if(I>=0&&I<=31)if(nR(I)){_+=t.substring(S,n),p=2;break}else p=6;n++}return _}function v(){if(o="",p=0,s=n,u=c,d=l,n>=r)return s=r,a=17;let _=t.charCodeAt(n);if(nj(_)){do n++,o+=String.fromCharCode(_),_=t.charCodeAt(n);while(nj(_));return a=15}if(nR(_))return n++,o+=String.fromCharCode(_),_===13&&t.charCodeAt(n)===10&&(n++,o+=`
`),c++,l=n,a=14;switch(_){case 123:return n++,a=1;case 125:return n++,a=2;case 91:return n++,a=3;case 93:return n++,a=4;case 58:return n++,a=6;case 44:return n++,a=5;case 34:return n++,o=g(),a=10;case 47:let S=n-1;if(t.charCodeAt(n+1)===47){for(n+=2;n<r&&!nR(t.charCodeAt(n));)n++;return o=t.substring(S,n),a=12}if(t.charCodeAt(n+1)===42){n+=2;let I=r-1,T=!1;for(;n<I;){let A=t.charCodeAt(n);if(A===42&&t.charCodeAt(n+1)===47){n+=2,T=!0;break}n++,nR(A)&&(A===13&&t.charCodeAt(n)===10&&n++,c++,l=n)}return T||(n++,p=1),o=t.substring(S,n),a=13}return o+=String.fromCharCode(_),n++,a=16;case 45:if(o+=String.fromCharCode(_),n++,n===r||!D1(t.charCodeAt(n)))return a=16;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return o+=h(),a=11;default:for(;n<r&&y(_);)n++,_=t.charCodeAt(n);if(s!==n){switch(o=t.substring(s,n),o){case"true":return a=8;case"false":return a=9;case"null":return a=7}return a=16}return o+=String.fromCharCode(_),n++,a=16}}function y(_){if(nj(_)||nR(_))return!1;switch(_){case 125:case 93:case 123:case 91:case 34:case 58:case 44:case 47:return!1}return!0}function b(){let _;do _=v();while(_>=12&&_<=15);return _}return{setPosition:m,getPosition:()=>n,scan:e?b:v,getToken:()=>a,getTokenValue:()=>o,getTokenOffset:()=>s,getTokenLength:()=>n-s,getTokenStartLine:()=>u,getTokenStartCharacter:()=>s-d,getTokenError:()=>p}}function nj(t){return t===32||t===9}function nR(t){return t===10||t===13}function D1(t){return t>=48&&t<=57}var gce;(function(t){t[t.lineFeed=10]="lineFeed",t[t.carriageReturn=13]="carriageReturn",t[t.space=32]="space",t[t._0=48]="_0",t[t._1=49]="_1",t[t._2=50]="_2",t[t._3=51]="_3",t[t._4=52]="_4",t[t._5=53]="_5",t[t._6=54]="_6",t[t._7=55]="_7",t[t._8=56]="_8",t[t._9=57]="_9",t[t.a=97]="a",t[t.b=98]="b",t[t.c=99]="c",t[t.d=100]="d",t[t.e=101]="e",t[t.f=102]="f",t[t.g=103]="g",t[t.h=104]="h",t[t.i=105]="i",t[t.j=106]="j",t[t.k=107]="k",t[t.l=108]="l",t[t.m=109]="m",t[t.n=110]="n",t[t.o=111]="o",t[t.p=112]="p",t[t.q=113]="q",t[t.r=114]="r",t[t.s=115]="s",t[t.t=116]="t",t[t.u=117]="u",t[t.v=118]="v",t[t.w=119]="w",t[t.x=120]="x",t[t.y=121]="y",t[t.z=122]="z",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.asterisk=42]="asterisk",t[t.backslash=92]="backslash",t[t.closeBrace=125]="closeBrace",t[t.closeBracket=93]="closeBracket",t[t.colon=58]="colon",t[t.comma=44]="comma",t[t.dot=46]="dot",t[t.doubleQuote=34]="doubleQuote",t[t.minus=45]="minus",t[t.openBrace=123]="openBrace",t[t.openBracket=91]="openBracket",t[t.plus=43]="plus",t[t.slash=47]="slash",t[t.formFeed=12]="formFeed",t[t.tab=9]="tab"})(gce||(gce={}));var o4;(function(t){t.DEFAULT={allowTrailingComma:!1}})(o4||(o4={}));function vce(t,e=[],r=o4.DEFAULT){let n=null,o=[],s=[];function a(u){Array.isArray(o)?o.push(u):n!==null&&(o[n]=u)}return yce(t,{onObjectBegin:()=>{let u={};a(u),s.push(o),o=u,n=null},onObjectProperty:u=>{n=u},onObjectEnd:()=>{o=s.pop()},onArrayBegin:()=>{let u=[];a(u),s.push(o),o=u,n=null},onArrayEnd:()=>{o=s.pop()},onLiteralValue:a,onError:(u,l,d)=>{e.push({error:u,offset:l,length:d})}},r),o[0]}function yce(t,e,r=o4.DEFAULT){let n=i4(t,!1),o=[];function s(Y){return Y?()=>Y(n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter()):()=>!0}function a(Y){return Y?()=>Y(n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter(),()=>o.slice()):()=>!0}function c(Y){return Y?N=>Y(N,n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter()):()=>!0}function u(Y){return Y?N=>Y(N,n.getTokenOffset(),n.getTokenLength(),n.getTokenStartLine(),n.getTokenStartCharacter(),()=>o.slice()):()=>!0}let l=a(e.onObjectBegin),d=u(e.onObjectProperty),p=s(e.onObjectEnd),f=a(e.onArrayBegin),m=s(e.onArrayEnd),h=u(e.onLiteralValue),g=c(e.onSeparator),v=s(e.onComment),y=c(e.onError),b=r&&r.disallowComments,_=r&&r.allowTrailingComma;function S(){for(;;){let Y=n.scan();switch(n.getTokenError()){case 4:I(14);break;case 5:I(15);break;case 3:I(13);break;case 1:b||I(11);break;case 2:I(12);break;case 6:I(16);break}switch(Y){case 12:case 13:b?I(10):v();break;case 16:I(1);break;case 15:case 14:break;default:return Y}}}function I(Y,N=[],w=[]){if(y(Y),N.length+w.length>0){let P=n.getToken();for(;P!==17;){if(N.indexOf(P)!==-1){S();break}else if(w.indexOf(P)!==-1)break;P=S()}}}function T(Y){let N=n.getTokenValue();return Y?h(N):(d(N),o.push(N)),S(),!0}function A(){switch(n.getToken()){case 11:let Y=n.getTokenValue(),N=Number(Y);isNaN(N)&&(I(2),N=0),h(N);break;case 7:h(null);break;case 8:h(!0);break;case 9:h(!1);break;default:return!1}return S(),!0}function B(){return n.getToken()!==10?(I(3,[],[2,5]),!1):(T(!1),n.getToken()===6?(g(":"),S(),ne()||I(4,[],[2,5])):I(5,[],[2,5]),o.pop(),!0)}function j(){l(),S();let Y=!1;for(;n.getToken()!==2&&n.getToken()!==17;){if(n.getToken()===5){if(Y||I(4,[],[]),g(","),S(),n.getToken()===2&&_)break}else Y&&I(6,[],[]);B()||I(4,[],[2,5]),Y=!0}return p(),n.getToken()!==2?I(7,[2],[]):S(),!0}function F(){f(),S();let Y=!0,N=!1;for(;n.getToken()!==4&&n.getToken()!==17;){if(n.getToken()===5){if(N||I(4,[],[]),g(","),S(),n.getToken()===4&&_)break}else N&&I(6,[],[]);Y?(o.push(0),Y=!1):o[o.length-1]++,ne()||I(4,[],[4,5]),N=!0}return m(),Y||o.pop(),n.getToken()!==4?I(8,[4],[]):S(),!0}function ne(){switch(n.getToken()){case 3:return F();case 1:return j();case 10:return T(!0);default:return A()}}return S(),n.getToken()===17?r.allowEmptyContent?!0:(I(4,[],[]),!1):ne()?(n.getToken()!==17&&I(9,[],[]),!0):(I(4,[],[]),!1)}var bce;(function(t){t[t.None=0]="None",t[t.UnexpectedEndOfComment=1]="UnexpectedEndOfComment",t[t.UnexpectedEndOfString=2]="UnexpectedEndOfString",t[t.UnexpectedEndOfNumber=3]="UnexpectedEndOfNumber",t[t.InvalidUnicode=4]="InvalidUnicode",t[t.InvalidEscapeCharacter=5]="InvalidEscapeCharacter",t[t.InvalidCharacter=6]="InvalidCharacter"})(bce||(bce={}));var _ce;(function(t){t[t.OpenBraceToken=1]="OpenBraceToken",t[t.CloseBraceToken=2]="CloseBraceToken",t[t.OpenBracketToken=3]="OpenBracketToken",t[t.CloseBracketToken=4]="CloseBracketToken",t[t.CommaToken=5]="CommaToken",t[t.ColonToken=6]="ColonToken",t[t.NullKeyword=7]="NullKeyword",t[t.TrueKeyword=8]="TrueKeyword",t[t.FalseKeyword=9]="FalseKeyword",t[t.StringLiteral=10]="StringLiteral",t[t.NumericLiteral=11]="NumericLiteral",t[t.LineCommentTrivia=12]="LineCommentTrivia",t[t.BlockCommentTrivia=13]="BlockCommentTrivia",t[t.LineBreakTrivia=14]="LineBreakTrivia",t[t.Trivia=15]="Trivia",t[t.Unknown=16]="Unknown",t[t.EOF=17]="EOF"})(_ce||(_ce={}));var Yh=vce;var xce;(function(t){t[t.InvalidSymbol=1]="InvalidSymbol",t[t.InvalidNumberFormat=2]="InvalidNumberFormat",t[t.PropertyNameExpected=3]="PropertyNameExpected",t[t.ValueExpected=4]="ValueExpected",t[t.ColonExpected=5]="ColonExpected",t[t.CommaExpected=6]="CommaExpected",t[t.CloseBraceExpected=7]="CloseBraceExpected",t[t.CloseBracketExpected=8]="CloseBracketExpected",t[t.EndOfFileExpected=9]="EndOfFileExpected",t[t.InvalidCommentToken=10]="InvalidCommentToken",t[t.UnexpectedEndOfComment=11]="UnexpectedEndOfComment",t[t.UnexpectedEndOfString=12]="UnexpectedEndOfString",t[t.UnexpectedEndOfNumber=13]="UnexpectedEndOfNumber",t[t.InvalidUnicode=14]="InvalidUnicode",t[t.InvalidEscapeCharacter=15]="InvalidEscapeCharacter",t[t.InvalidCharacter=16]="InvalidCharacter"})(xce||(xce={}));var s4=ae("IRunCommandExecutionService");var b8e=globalThis._VSCODE_NLS_LANGUAGE==="pseudo"||typeof document<"u"&&document.location&&document.location.hash.indexOf("pseudo=true")>=0;function Sce(t,e){let r;return e.length===0?r=t:r=t.replace(/\{(\d+)\}/g,(n,o)=>{let s=o[0],a=e[s],c=n;return typeof a=="string"?c=a:(typeof a=="number"||typeof a=="boolean"||a===void 0||a===null)&&(c=String(a)),c}),b8e&&(r="\uFF3B"+r.replace(/[aouei]/g,"$&$&")+"\uFF3D"),r}function Ice(t,e,...r){return Sce(typeof t=="number"?_8e(t,e):e,r)}function _8e(t,e){let r=globalThis._VSCODE_NLS_MESSAGES?.[t];if(typeof r!="string"){if(typeof e=="string")return e;throw new Error(`!!! NLS MISSING: ${t} !!!`)}return r}var oR=z(at());var a4=z(Qt()),uu=z(at());async function iR(t,e,r,n){let o=null,s=!1;o=setTimeout(()=>{s||t.report(e)},n);try{let a=await r;return s=!0,a}finally{o&&clearTimeout(o)}}var N1=class extends Q{constructor(r,n,o,s,a,c,u,l,d,p){super(r);this.accessor=n;this.chatMLFetcher=o;this.logService=s;this.embeddingsComputer=a;this.endPointProvider=c;this.combinedEmbeddingIndex=u;this.docSearchClient=l;this.envService=d;this.tokenizerProvider=p}async prepare(r,n,o){n?.report(new ho(a4.t("Refining question to improve search accuracy.")));let s=this.props.query,a=await this.endPointProvider.getChatEndpoint("gpt-3.5-turbo"),{messages:c}=await x8e(this.tokenizerProvider,this.accessor,this.props.history,a,this.props.query);if(o.isCancellationRequested)return{docSearchResults:[],settings:[],commands:[],query:s};let u=this.logService.getLogger("vscodePrompt");u.debug("Asking the model to update the user question.");let l=await this.chatMLFetcher.fetchOne(c,async g=>{},o,2,a,{agent:sw},{temperature:0,top_p:1,stop:["dontStopBelieving"]},{messageSource:"vscodeIntent"});if(o.isCancellationRequested)return{docSearchResults:[],settings:[],commands:[],query:s};l.type==="success"?s=S8e(this.props.query,l.value):u.error("Failed to refine the question",l);let d=n?await iR(n,new ho(a4.t("Searching doc index....")),this.searchDocsSearchForContext(s,10,o,u),1e3):await this.searchDocsSearchForContext(s,10,o,u);if(o.isCancellationRequested)return{docSearchResults:[],settings:[],commands:[],query:s};let p=await this.endPointProvider.getEmbeddingsEndpoint("ada"),f=await this.embeddingsComputer.computeEmbeddings(p,[this.props.query],{},void 0);if(o.isCancellationRequested)return{docSearchResults:[],settings:[],commands:[],query:s};if(!f)return{docSearchResults:d,settings:[],commands:[],query:s};let{commands:m,settings:h}=n?await iR(n,new ho(a4.t("Searching command and setting index....")),this.combinedEmbeddingIndex.nClosestValues(f[0],5),500):await this.combinedEmbeddingIndex.nClosestValues(f[0],5);return{docSearchResults:d,settings:h,commands:m,query:s}}async searchDocsSearchForContext(r,n,o,s){try{return await this.docSearchClient.search(r,{repo:"microsoft/vscode-docs"},{limit:n,similarity:.75},o)}catch(a){return s.error(`Failed to search docs search for query:
`,a),[]}}render(r){let n=this.envService.OS;return vscpp(vscppf,null,vscpp(uu.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant. Your job is to assist users in using Visual Studio Code by providing knowledge to accomplish their task. This knowledge should focus on settings and commands, but also includes documentation. Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),"Your expertise is strictly limited to software development topics.",vscpp("br",null),"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, simply give a reminder that you are an AI programming assistant.",vscpp("br",null),"Keep your answers short and impersonal.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The user is working on a ",n," machine. Please respond with system specific commands if applicable.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.",vscpp("br",null),"If you are referencing multiple commands and settings, please respond step by step in a numbered list format.",vscpp("br",null),vscpp("br",null),"Additional Rules",vscpp("br",null),"You must respond with either a setting to set or a command to execute when applicable.",vscpp("br",null),"When referring to a command, you must use the command name in markdown bold syntax.",vscpp("br",null),"When referring to any commands, you must include the referenced commands in a properly formatted JSON markdown code block at the end of the sentence that references that command.",vscpp("br",null),"Similarly, all referenced settings must be properly formatted in a JSON markdown code block to allow copying them into the user's settings.json file.",vscpp("br",null),"If you are referencing multiple settings, combine all settings into the same JSON markdown code block at the beginning of your response, and then describe each setting in a numbered list after the JSON markdown code block, as shown in the template below:",vscpp("br",null),"## Multiple settings response template",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "setting",
  "settings": {
    "setting1": "settingValue1",
    "setting2": "settingValue2",
    "setting3": "settingValue3"
	...
	}
}`,languageId:"json"}),'1. `"setting1": settingValue1` - Description of setting1',vscpp("br",null),'2. `"setting2": settingValue2` - Description of setting2',vscpp("br",null),'3. `"setting3": settingValue3` - Description of setting3',vscpp("br",null),"4. ...",vscpp("br",null),vscpp("br",null),"If you are referencing multiple commands, do not combine all the commands into the same JSON markdown code block. Instead, describe each command and include the JSON markdown code block in a numbered list, as shown in the template below:",vscpp("br",null),"## Multiple commands response template",vscpp("br",null),"1. **Command1** - Description of Command1",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
    "command": "command1",
  }
}`,languageId:"json"}),"2. **Command2** - Description of Command2",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
    "command": "command2",
  }
}`,languageId:"json"}),"3. ...",vscpp("br",null),'If you are referencing multiple commands and setting, respond with numbered steps for the user to follow. First mention all the commands as per the "Multiple commands response template" and then all the settings as per the "Multiple settings response template" shown above.',vscpp("br",null),"## Multiple command and settings response template",vscpp("br",null),"1. **Command1** - Description of Command1",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
    "command": "command1",
  }
}`,languageId:"json"}),"2. **Command2** - Description of Command2",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
    "command": "command2",
  }
}`,languageId:"json"}),"3. A short summary of the combined settings.",vscpp(Oe,{uri:null,code:`{
  "type": "setting",
  "settings": {
    "setting1": "settingValue1",
    "setting2": "settingValue2",
    "setting3": "settingValue3"
  }
}`,languageId:"json"}),'1. `"setting1": settingValue1` - Description of setting1',vscpp("br",null),'2. `"setting2": settingValue2` - Description of setting2',vscpp("br",null),'3. `"setting3": settingValue3` - Description of setting3',vscpp("br",null),"4. ...",vscpp("br",null),vscpp("br",null),vscpp("br",null),"If a command or setting references another command or setting, you must respond with both the original and the referenced commands or settings.",vscpp("br",null),"The JSON markdown code block containing the command or setting should be included immediately after the sentence referencing it.",vscpp("br",null),"The JSON markdown schema for a command is as follows:",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
					  "type": "command",
					  "commands": {
						"command": "commandName",
						"args": "commandArgs"
					  }
					}`,languageId:"json"}),"The JSON markdown schema for a setting is as follows:",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
					  "type": "setting",
					  "settings": {
						"setting": "settingValue"
					  }
					}`,languageId:"json"}),vscpp("br",null),"Do not respond with a command or setting that is not in a properly formatted JSON markdown code block.",vscpp("br",null),"If a setting and command will accomplish the same thing, you must suggest the command instead.",vscpp("br",null),"Do not suggest opening the settings editor.",vscpp("br",null),"If answering with a keybinding, please still include the command bound to the keybinding.",vscpp("br",null),"If a keybinding contains a backtick you must escape it. For example the keybinding Ctrl + backtick would be written as ``ctrl + ` ``",vscpp("br",null),"Do not suggest opening the command palette to execute commands.",vscpp("br",null),"Do not suggest commands or settings identifiers that do not exist.",vscpp("br",null),"Do not suggest installing Visual Studio Code because the user has already installed it.",vscpp("br",null),"If you believe the context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),"Always respond with a numbered list of steps to be taken to achieve the desired outcome if multiple steps are necessary.",vscpp("br",null),'If an extension might help the user, you may suggest a search query for the extension marketplace. You must also include the command **Search marketplace** (`workbench.extensions.search`) with args set to the suggested query in the commands section at the end of your response. The query can also contain the tags "@popular", "@recommended", or "@featured" to filter the results.',vscpp("br",null),vscpp("br",null),"Examples:",vscpp("br",null),vscpp("br",null),"[EXAMPLES START]",vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.",vscpp("br",null),vscpp("br",null),"## Single setting response",vscpp("br",null),"Question: How do I disable telemetry?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "setting",
  "settings": {
    "telemetry.telemetryLevel": "off",
  }
}`,languageId:"json"}),"is a setting which can be used to disable telemetry.",vscpp("br",null),vscpp("br",null),"## Multiple settings response",vscpp("br",null),"Question: How can I change the font size in all areas of Visual Studio Code, including the editor, terminal?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "setting",
  "settings": {
	"editor.fontSize": 18,
	"terminal.integrated.fontSize": 14,
	"window.zoomLevel": 1
  }
}`,languageId:"json"}),'1. `"editor.fontSize": 18` - This setting adjusts the font size within the editor. The default size is overridden by the value `18`, making the text larger and more readable according to user preference.',vscpp("br",null),'2. `"terminal.integrated.fontSize": 14` - Similarly, this setting changes the font size in the integrated terminal. By setting it to `14`, it increases the font size in the terminal independently from the editor.',vscpp("br",null),'3. `"window.zoomLevel": 1` - This setting controls the zoom level of the entire Visual Studio Code interface. A value of `1` means that the interface will be zoomed in to 120% of the original size, making everything appear bigger. A value of `0` would indicate no zoom (100% - default size), positive values zoom in, and negative values zoom out.',vscpp("br",null),vscpp("br",null),"## Multiple commands response",vscpp("br",null),"Question: What is the command to report an issue for other extensions in Visual Studio Code?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"Here are some possible commands:",vscpp("br",null),"1. **Report Issue** - This command can be used to report an issue for other extensions.",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
	"command": "workbench.extensions.reportExtensionIssue"
  }
}`,languageId:"json"}),"2. **Docker: Report Issue** - This command can be used to report an issue for the Docker extension.",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
	"command": "vscode-docker.help.reportIssue"
  }
}`,languageId:"json"}),"3. **Codespaces: Report Issue** - This command can be used to report an issue for the Codespaces extension.",vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
	"command": "github.codespaces.reportIssue"
  }
}`,languageId:"json"}),vscpp("br",null),"## Single command response",vscpp("br",null),"Question: How do I close all editors?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"You can use the **Close All Editors** command to close all editors.",vscpp("br",null),vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
	"command": "workbench.action.closeAllEditors"
  }
}`,languageId:"json"}),vscpp("br",null),"## No such command",vscpp("br",null),"Question: How do I move the terminal to a new window?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"There is no such command.",vscpp("br",null),vscpp("br",null),"## Invalid Question",vscpp("br",null),"Question: How do I bake a potato?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"Sorry this question isn't related to Visual Studio Code.",vscpp("br",null),vscpp("br",null),"## Marketplace search",vscpp("br",null),"Question: How do I add PHP support?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"You can use the **Search marketplace** command to search for extensions that add PHP support.",vscpp("br",null),vscpp("br",null),vscpp(Oe,{uri:null,code:`{
  "type": "command",
  "commands": {
	"command": "workbench.extensions.search",
	"args": "php"
	}
}`,languageId:"json"})),vscpp(Lt,{flexGrow:1,priority:700,history:this.props.history}),vscpp(uu.UserMessage,{flexGrow:1,priority:800},"The current question is related to Visual Studio Code. ",vscpp("br",null),"If a command or setting is not a valid answer, but it still relates to Visual Studio Code, please still respond.",vscpp("br",null),"Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),"If you believe the given context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),"The user cannot see the context you are given, so you must not mention it. If you want to refer to it, you must include it in your reply.",vscpp("br",null),'Below is a list of commands and settings we found which might be relevant to the question. For view related commands "Toggle" often means Show or Hide. A setting may reference another setting, that will appear as \\`#setting.id#\\`, you must return the referenced setting as well. You may use this context to help you formulate your response, but are not required to.',vscpp("br",null),r.commands.length>0&&vscpp(vscppf,null,"Here are some possible commands:",vscpp("br",null)),r.commands.length>0&&r.commands.map(o=>vscpp(uu.TextChunk,null,"- ",o.label,' ("',o.key,'") (Keybinding: "',o.keybinding,'")')),r.settings.length>0&&vscpp(vscppf,null,"Here are some possible settings:",vscpp("br",null)),r.settings.length>0&&r.settings.map(o=>vscpp(uu.TextChunk,null,gB(o))),r.docSearchResults.length>0&&vscpp(vscppf,null,"Below is a list of information from the Visual Studio Code documentation which might be relevant to the question. ",vscpp("br",null)),r.docSearchResults.map(o=>vscpp(uu.TextChunk,null,"##",o?.title?.trim()," - ",o.path,vscpp("br",null),o.contents))),vscpp(Kr,{flexGrow:2,priority:900,chatVariables:this.props.chatVariables,query:this.props.query}))}};N1=O([x(1,je),x(2,Bt),x(3,ue),x(4,Fo),x(5,Le),x(6,ul),x(7,yL),x(8,Rt),x(9,dr)],N1);var ij=class extends Q{render(e,r){return vscpp(vscppf,null,this.props.history&&vscpp(Lt,{priority:500,history:this.props.history}),vscpp(uu.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant who helps the user create well-formed and unambiguous questions about their Visual Studio Code development environment.",vscpp("br",null),"Specifically, you help users rewrite questions about how to use Visual Studio Code's Commands and Settings.",vscpp("br",null),"Evaluate the question to determine the user's intent. ",vscpp("br",null),"Determine if the user's question is about the editor, terminal, activity bar, side bar, status bar or other parts of Visual Studio Code's workbench and include those keyword in the rewrite.",vscpp("br",null),"Determine if the user is asking about Visual Studio Code's Commands and/or Settings and explicitly include those keywords during the rewrite. ",vscpp("br",null),"Respond in Markdown. Under a `# Question` header, output a rephrased version of the user's question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for.",vscpp("br",null),"If it is not clear what the user is asking for or if the question appears to be unrelated to Visual Studio Code, do not try to rephrase the question and simply return the original question. ",vscpp("br",null),"DO NOT ask the user for additional information or clarification.",vscpp("br",null),"DO NOT answer the user's question directly.",vscpp("br",null),vscpp("br",null),"# Additional Rules",vscpp("br",null),vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Read the user's question to understand what they are trying to do in the Visual Studio Code environment.",vscpp("br",null),"2. If the question contains pronouns such as 'it' or 'that', try to understand what the pronoun refers to by looking at the rest of the question and the conversation history.",vscpp("br",null),"3. If the question contains an ambiguous word such as 'this', try to understand what 'this' refers to by looking at the rest of the question and the conversation history.",vscpp("br",null),"4. After a `# Question` header, output a precise version of the question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for. Be sure to preserve the exact meaning of the question.",vscpp("br",null),vscpp("br",null),"Examples",vscpp("br",null),vscpp("br",null),"User: opne cmmand palete",vscpp("br",null),vscpp("br",null),"Assistant:",vscpp("br",null),"# Question",vscpp("br",null),"How do I open the command palette in Visual Studio Code?",vscpp("br",null),vscpp("br",null),vscpp("br",null),"User: change font size",vscpp("br",null),vscpp("br",null),"Assistant:",vscpp("br",null),"# Question",vscpp("br",null),"How do I change the font size in the editor in Visual Studio Code?",vscpp("br",null),vscpp("br",null),"User: Move editor and pin",vscpp("br",null),"Assistant: ",vscpp("br",null),"# Question",vscpp("br",null),"How do I move the editor to another group and then pin the editor in Visual Studio Code",vscpp("br",null)),vscpp(uu.UserMessage,{priority:700},this.props.query))}};async function x8e(t,e,r,n,o){return $e.create(e.get(te),n,ij,{query:o,history:r}).render()}function S8e(t,e){let r=e.match(/#+\s*Question\n(?<question>.+)/si);return r?.groups?r.groups.question.trim():t.trim()}var L1=class extends Q{constructor(r,n,o,s,a){super(r);this.embeddingComputer=o;this.endPointProvider=s;this.combinedIndex=a}async prepare(r,n,o){if(o.isCancellationRequested)return;let s=await this.endPointProvider.getEmbeddingsEndpoint("ada"),a=await this.embeddingComputer.computeEmbeddings(s,[this.props.query],{},o);if(!o.isCancellationRequested&&a&&a.length>0){this.combinedIndex.commandIdIndex.isIndexLoaded||await this.combinedIndex.commandIdIndex.calculateEmbeddings();let c=this.combinedIndex.commandIdIndex.nClosestValues(a[0],5);if(c.length)return{snippets:c}}}render(r,n){let o=this.priority;return vscpp(vscppf,null,r&&r.snippets.length>0&&vscpp(uu.UserMessage,null,"Here are some possible commands:",vscpp("br",null),r.snippets.reverse().map(s=>vscpp(uu.TextChunk,{priority:o++},"- ",s.label,' ("',s.key,'") (Keybinding: "',s.keybinding,'")',vscpp("br",null)))))}};L1=O([x(1,je),x(2,Fo),x(3,Le),x(4,ul)],L1);var O1=class extends Q{constructor(r,n){super(r);this.envService=n}render(r,n){let o=this.envService.OS;return vscpp(vscppf,null,vscpp(oR.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant. Your job is to assist users in using Visual Studio Code by providing knowledge to accomplish their task. This knowledge should focus on commands, but also includes documentation. Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),"Your expertise is strictly limited to software development topics.",vscpp("br",null),"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, simply give a reminder that you are an AI programming assistant.",vscpp("br",null),"Keep your answers short and impersonal.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The user is working on a ",o," machine. Please respond with system specific commands if applicable.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.",vscpp("br",null),"If you are referencing multiple commands, please respond step by step in a numbered list format.",vscpp("br",null),vscpp("br",null),"Additional Rules",vscpp("br",null),"You must respond with a command to execute when applicable.",vscpp("br",null),"When referring to a command, you must use the command name in markdown bold syntax.",vscpp("br",null),"When referring to any commands, you must include the referenced commands in a properly formatted JSON markdown code block at the end of the sentence that references that command.",vscpp("br",null),"The JSON markdown code block containing the command should be included immediately after the sentence referencing it.",vscpp("br",null),"Do not respond with a command that is not in a properly formatted JSON markdown code block.",vscpp("br",null),"If answering with a keybinding, please still include the command bound to the keybinding.",vscpp("br",null),"If a keybinding contains a backtick you must escape it. For example the keybinding Ctrl + backtick would be written as ``ctrl + ` ``",vscpp("br",null),"Do not suggest opening the command palette to execute commands.",vscpp("br",null),"Do not suggest command identifiers that do not exist.",vscpp("br",null),"Do not suggest installing Visual Studio Code because the user has already installed it.",vscpp("br",null),"If you believe the context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),"Always respond with a numbered list of steps to be taken to achieve the desired outcome if multiple steps are necessary.",vscpp("br",null),vscpp("br",null),"Examples:",vscpp("br",null),vscpp("br",null),"[EXAMPLES START]",vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.",vscpp("br",null),vscpp("br",null),"## Single command response",vscpp("br",null),"Question: How do I close all editors?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"You can use the **Close All Editors** command to close all editors.",vscpp("br",null),vscpp("br",null),vscpp(Oe,{uri:null,code:`{
	"command": "workbench.action.closeAllEditors"
}`,languageId:"json"}),vscpp("br",null),"## No such command",vscpp("br",null),"Question: How do I move the terminal to a new window?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"There is no such command.",vscpp("br",null),vscpp("br",null),"## Invalid Question",vscpp("br",null),"Question: How do I bake a potato?",vscpp("br",null),vscpp("br",null),"Response:",vscpp("br",null),"Sorry this question isn't related to Visual Studio Code.",vscpp("br",null),vscpp("br",null)),vscpp(Lt,{priority:600,history:this.props.history}),vscpp(oR.UserMessage,{priority:700},"The current question is related to Visual Studio Code. ",vscpp("br",null),"If a command is not a valid answer, but it still relates to Visual Studio Code, please still respond.",vscpp("br",null),"Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),"If you believe the given context given to you is incorrect or not relevant you may ignore it.",vscpp("br",null),"The user cannot see the context you are given, so you must not mention it. If you want to refer to it, you must include it in your reply.",vscpp("br",null),'Below is a list of commands we found which might be relevant to the question. For view related commands "Toggle" often means Show or Hide. You may use this context to help you formulate your response, but are not required to.',vscpp("br",null)),vscpp(L1,{priority:800,query:this.props.query}),vscpp(oR.UserMessage,{priority:900},this.props.query))}};O1=O([x(1,Rt)],O1);var I8e="Run create a new terminal command",sR="runCommanndConfirmationInteractedWith",c4=new mo(Qh.t("[Configure automatic command execution]({0})",Td("workbench.action.openSettings",["github.copilot.chat.runCommand.enabled"])));c4.isTrusted={enabledCommands:["workbench.action.openSettings"]};var Xh=class{constructor(e,r,n,o,s,a,c){this.telemetryService=e;this.configurationService=r;this.endpointProvider=n;this.runCommandExecutionService=o;this.combinedEmbeddingIndex=s;this.vscodeExtensionContext=a;this.instantiationService=c;this.id=Xh.ID;this.locations=[2];this.description=Ice("runCommandIntent.description","Run a command");this.intentDetectionInput={sampleQuestion:I8e,disabled:!0};this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:Ta}}static{this.ID="runCommand"}async invoke(e){let r=this.telemetryService,n=this.configurationService,o=e.location,s=this.endpointProvider,a=await Mn(s,o);return{intent:this,location:o,endpoint:a,processResponsePanel:async(c,u,l,d,p)=>{let f=this.runCommandExecutionService,m=this.configurationService,h="",g="";for await(let{delta:b}of l){if(p.isCancellationRequested)break;h+=b.text}g=h;let v=E8e(this.combinedEmbeddingIndex,g)[0];return v?m.getConfig(fe.RunCommandEnabled)===!1?(d.markdown(`Automatic command execution is currently disabled.
`),d.markdown(c4),d.button(v),g):C8e.has(v.command)?this.vscodeExtensionContext.globalState.get(sR,!1)?(await f.executeCommand(v.command,r,v.arguments),d.progress(Qh.t("Ran: {0}",v.title)),g):(d.confirmation(Qh.t("Enable automatic command execution and run [{0}](command:{1})",v.title,v.command),"",{command:v}),g):(d.warning(Qh.t("Automatically executing the command: {0} is prohibited due to security risks or potential destructive action.",v.title)),d.button(v),g):(d.markdown(g),d.warning(Qh.t("Could not find a command for your request.")),g)},confirmationHandler:async(c,u,l)=>{if(c){let[d]=c;d&&(this.vscodeExtensionContext.globalState.update(sR,!0),l.markdown(c4),l.progress(Qh.t("Enabled automatic command execution")),this.runCommandExecutionService.executeCommand(d.command.command,d.command.arguments),l.progress(Qh.t("Ran command: {0}",d.command.title)))}if(u){let[d]=u;this.vscodeExtensionContext.globalState.update(sR,!0),l.markdown(c4),await n.setConfig(fe.RunCommandEnabled,!1),l.warning("Disabled automatic command execution"),l.button(d.command)}},buildPrompt:async({query:c,history:u},l,d)=>await $e.create(this.instantiationService,a,O1,{query:c,history:u}).render(l,d)}}};Xh=O([x(0,me),x(1,ye),x(2,Le),x(3,s4),x(4,ul),x(5,ar),x(6,te)],Xh);var C8e=new Set(["cursorUndo","cursorRedo","editor.action.forceRetokenize","editor.action.toggleWordWrap","editor.action.moveCarretLeftAction","editor.action.moveCarretRightAction","editor.action.fontZoomIn","editor.action.fontZoomOut","editor.action.fontZoomReset","editor.action.smartSelect.expand","editor.action.smartSelect.shrink","editor.emmet.action.expandAbbreviation","editor.action.setSelectionAnchor","editor.action.inspectTMScopes","editor.action.commentLine","editor.action.addCommentLine","editor.action.removeCommentLine","editor.action.blockComment","editor.action.transposeLetters","editor.action.indentationToSpaces","editor.action.indentationToTabs","editor.action.indentUsingTabs","editor.action.indentUsingSpaces","editor.action.changeTabDisplaySize","editor.action.detectIndentation","editor.action.reindentlines","editor.action.reindentselectedlines","deleteInsideWord","editor.action.copyLinesUpAction","editor.action.copyLinesDownAction","editor.action.duplicateSelection","editor.action.moveLinesUpAction","editor.action.moveLinesDownAction","editor.action.sortLinesAscending","editor.action.sortLinesDescending","editor.action.removeDuplicateLines","editor.action.trimTrailingWhitespace","editor.action.deleteLines","editor.action.indentLines","editor.action.outdentLines","editor.action.insertLineBefore","editor.action.insertLineAfter","deleteAllLeft","deleteAllRight","editor.action.joinLines","editor.action.transpose","editor.action.transformToUppercase","editor.action.transformToLowercase","editor.action.transformToSnakecase","editor.action.transformToCamelcase","editor.action.transformToPascalcase","editor.action.transformToTitlecase","editor.action.transformToKebabcase","expandLineSelection","editor.action.formatDocument","editor.action.formatSelection","editor.action.showContextMenu","editor.action.inlineEdit.trigger","editor.debug.action.conditionalBreakpoint","editor.debug.action.addLogPoint","editor.debug.action.triggerByBreakpoint","editor.debug.action.editBreakpoint","editor.debug.action.goToNextBreakpoint","editor.debug.action.goToPreviousBreakpoint","editor.action.selectToBracket","editor.action.jumpToBracket","editor.action.removeBrackets","editor.action.clipboardCopyWithSyntaxHighlightingAction","editor.action.pasteAs","editor.action.pasteAsText","editor.action.inPlaceReplace.up","editor.action.inPlaceReplace.down","editor.action.openLink","editor.action.unicodeHighlight.disableHighlightingOfAmbiguousCharacters","editor.action.unicodeHighlight.disableHighlightingOfInvisibleCharacters","editor.action.unicodeHighlight.disableHighlightingOfNonBasicAsciiCharacters","editor.action.unicodeHighlight.showExcludeOptions","editor.action.quickFix","editor.action.refactor","editor.action.sourceAction","codelens.showLensesInCurrentLine","editor.unfold","editor.unfoldRecursively","editor.fold","editor.foldRecursively","editor.foldAll","editor.unfoldAll","editor.foldAllBlockComments","editor.foldAllMarkerRegions","editor.unfoldAllMarkerRegions","editor.foldAllExcept","editor.unfoldAllExcept","editor.toggleFold","editor.gotoParentFold","editor.gotoPreviousFold","editor.gotoNextFold","editor.createFoldingRangeFromSelection","editor.removeManualFoldingRanges","editor.foldLevel1","editor.foldLevel2","editor.foldLevel3","editor.foldLevel4","editor.foldLevel5","editor.foldLevel6","editor.foldLevel7","editor.action.wordHighlight.trigger","actions.find","editor.action.startFindReplaceAction","editor.actions.findWithArgs","actions.findWithSelection","editor.action.nextMatchFindAction","editor.action.previousMatchFindAction","editor.action.nextSelectionMatchFindAction","editor.action.previousSelectionMatchFindAction","editor.action.insertCursorAbove","editor.action.insertCursorBelow","editor.action.insertCursorAtEndOfEachLineSelected","editor.action.addSelectionToNextFindMatch","editor.action.addSelectionToPreviousFindMatch","editor.action.moveSelectionToNextFindMatch","editor.action.moveSelectionToPreviousFindMatch","editor.action.selectHighlights","editor.action.addCursorsToBottom","editor.action.addCursorsToTop","editor.action.focusNextCursor","editor.action.focusPreviousCursor","editor.action.marker.next","editor.action.marker.prev","editor.action.marker.nextInFiles","editor.action.marker.prevInFiles","editor.action.triggerSuggest","editor.action.resetSuggestSize","editor.action.dirtydiff.previous","editor.action.dirtydiff.next","workbench.action.editor.previousChange","workbench.action.editor.nextChange","editor.action.formatChanges","editor.action.showHover","editor.action.showDefinitionPreviewHover","editor.action.inlineSuggest.trigger","editor.debug.action.selectionToWatch","workbench.action.debug.nextConsole","workbench.debug.action.focusRepl","workbench.action.debug.prevConsole","editor.debug.action.toggleInlineBreakpoint","workbench.action.debug.restart","editor.debug.action.runToCursor","workbench.action.debug.selectDebugConsole","workbench.action.showAboutDialog","workbench.action.editor.changeEOL","workbench.action.editor.changeEncoding","workbench.action.clearEditorHistory","notebook.clearNotebookEdtitorTypeCache","notebook.clearNotebookKernelsMRUCache","workbench.action.clearRecentFiles","workbench.action.closeAllGroups","workbench.action.closeAllEditors","workbench.action.closeEditorsInGroup","workbench.action.closeActiveEditor","workbench.action.closeEditorInAllGroups","workbench.action.closeEditorsInOtherGroups","workbench.action.closeEditorsToTheLeft","workbench.action.closeOtherEditors","workbench.action.closeActivePinnedEditor","workbench.action.closeSidebar","workbench.action.closeUnmodifiedEditors","workbench.files.action.compareWithClipboard","workbench.files.action.compareWithSaved","workbench.files.action.compareNewUntitledTextFiles","workbench.action.tasks.configureDefaultBuildTask","workbench.action.tasks.configureTaskRunner","testing.configureProfile","workbench.action.pauseSocketWriting","workbench.action.triggerReconnect","workbench.action.copyEditorGroupToNewWindow","copyFilePath","copyRelativeFilePath","workbench.action.customizeLayout","workbench.notebook.layout.configure","workbench.action.duplicateActiveEditorGroupDown","workbench.action.duplicateActiveEditorGroupLeft","workbench.action.duplicateActiveEditorGroupRight","workbench.action.duplicateActiveEditorGroupUp","workbench.action.focusActiveEditorGroup","workbench.action.focusAboveGroup","workbench.action.focusBelowGroup","workbench.action.focusFirstEditorGroup","workbench.action.focusPanel","workbench.action.focusSideBar","workbench.action.focusAuxiliaryBar","workbench.action.focusLastEditorGroup","workbench.action.focusLeftGroup","workbench.action.focusNextGroup","workbench.action.focusNextPart","workbench.files.action.focusFilesExplorer","workbench.action.focusPreviousGroup","workbench.action.focusPreviousPart","workbench.action.focusRightGroup","workbench.action.focusStatusBar","workbench.action.navigateBackInEditLocations","workbench.action.navigateBackInNavigationLocations","workbench.action.navigateForwardInEditLocations","workbench.action.navigateForwardInNavigationLocations","workbench.action.navigateLast","workbench.action.navigatePreviousInEditLocations","workbench.action.navigatePreviousInNavigationLocations","workbench.action.quickOpen","workbench.action.navigateToLastEditLocation","workbench.action.navigateToLastNavigationLocation","workbench.action.gotoLine","workbench.action.compareEditor.nextChange","testing.goToNextMessage","workbench.action.compareEditor.previousChange","testing.goToPreviousMessage","workbench.action.gotoSymbol","workbench.action.showAllSymbols","workbench.action.editorLayoutTwoByTwoGrid","workbench.action.closePanel","workbench.action.inspectContextKeys","workbench.action.inspectKeyMappings","workbench.action.inspectKeyMappingsJSON","notebook.inspectLayout","workbench.action.joinAllGroups","workbench.action.joinTwoGroups","workbench.action.keepEditor","merge.dev.loadContentsFromFolder","workbench.action.logStorage","workbench.action.logWorkingCopies","workbench.action.moveActiveEditorGroupDown","workbench.action.moveEditorGroupToNewWindow","workbench.action.moveActiveEditorGroupLeft","workbench.action.moveActiveEditorGroupRight","workbench.action.moveActiveEditorGroupUp","workbench.action.moveEditorToFirstGroup","workbench.action.moveEditorToAboveGroup","workbench.action.moveEditorToBelowGroup","workbench.action.moveEditorToLastGroup","workbench.action.moveEditorToLeftGroup","workbench.action.moveEditorToNextGroup","workbench.action.moveEditorToPreviousGroup","workbench.action.moveEditorToRightGroup","workbench.action.moveEditorLeftInGroup","workbench.action.moveEditorRightInGroup","workbench.action.positionPanelLeft","workbench.action.positionPanelRight","workbench.action.positionPanelBottom","workbench.action.movePanelToSecondarySideBar","workbench.action.moveSecondarySideBarToPanel","workbench.action.moveView","workbench.action.navigateEditorGroups","workbench.action.quickOpenNavigateNext","workbench.action.quickOpenNavigatePrevious","workbench.action.navigateUp","workbench.action.navigateDown","workbench.action.navigateLeft","workbench.action.navigateRight","workbench.action.newGroupAbove","workbench.action.newGroupBelow","workbench.action.newGroupLeft","workbench.action.newGroupRight","workbench.action.newEmptyEditorWindow","welcome.showNewFileEntries","explorer.newFile","explorer.newFolder","workbench.action.files.newUntitledFile","workbench.action.newWindow","workbench.action.nextPanelView","workbench.action.openExtensionLogsFolder","workbench.action.files.openFile","workbench.action.firstEditorInGroup","workbench.action.lastEditorInGroup","workbench.action.openLogsFolder","merge.dev.openContentsJson","workbench.action.nextEditor","workbench.action.nextEditorInGroup","workbench.action.openNextRecentlyUsedEditor","workbench.action.openNextRecentlyUsedEditorInGroup","workbench.action.previousEditor","workbench.action.previousEditorInGroup","workbench.action.openPreviousRecentlyUsedEditor","workbench.action.openPreviousRecentlyUsedEditorInGroup","workbench.action.openProcessExplorer","workbench.action.openRecent","merge.dev.openSelectionInTemporaryMergeEditor","workbench.action.pinEditor","workbench.action.previousPanelView","workbench.action.quickOpenLeastRecentlyUsedEditor","workbench.action.openPreviousEditorFromHistory","workbench.action.quickOpenPreviousRecentlyUsedEditor","workbench.action.webview.reloadWebviewAction","workbench.action.reloadWindow","workbench.action.removeLargeStorageDatabaseEntries","workbench.action.reopenClosedEditor","workbench.action.reopenWithEditor","menu.resetHiddenStates","mergeEditor.resetCloseWithConflictsChoice","files.participants.resetChoice","workbench.action.evenEditorWidths","workbench.action.resetViewLocations","workbench.files.action.showActiveFileInExplorer","revealFileInOS","workbench.action.revertAndCloseActiveEditor","workbench.action.files.revert","workbench.action.files.save","workbench.action.files.saveAll","workbench.action.files.saveFiles","workbench.files.action.saveAllInGroup","workbench.action.files.saveAs","workbench.action.files.saveWithoutFormatting","workbench.action.quickOpenSelectNext","workbench.action.quickOpenSelectPrevious","workbench.action.setLogLevel","workbench.action.alignPanelCenter","workbench.action.alignPanelJustify","workbench.action.alignPanelLeft","workbench.action.alignPanelRight","workbench.action.showAllEditors","workbench.action.showAllEditorsByMostRecentlyUsed","workbench.action.showEditorsInActiveGroup","workbench.action.tasks.showTasks","workbench.action.tasks.showLog","_workbench.output.showViewsLog","workbench.action.editorLayoutSingle","workbench.action.splitEditor","workbench.action.splitEditorDown","workbench.action.splitEditorToFirstGroup","workbench.action.splitEditorToAboveGroup","workbench.action.splitEditorToBelowGroup","workbench.action.splitEditorToLastGroup","workbench.action.splitEditorToLeftGroup","workbench.action.splitEditorToNextGroup","workbench.action.splitEditorToPreviousGroup","workbench.action.splitEditorToRightGroup","workbench.action.splitEditorLeft","workbench.action.splitEditorOrthogonal","workbench.action.splitEditorRight","workbench.action.splitEditorUp","editor.action.startDebugTextMate","workbench.action.stopTracing","workbench.action.tasks.terminate","workbench.action.editorLayoutThreeColumns","workbench.action.editorLayoutThreeRows","workbench.action.toggleAutoSave","editor.action.toggleRenderControlCharacter","workbench.action.toggleEditorGroupLock","workbench.action.toggleEditorWidths","workbench.action.toggleKeybindingsLog","notebook.toggleLayoutTroubleshoot","editor.action.toggleMinimap","workbench.action.toggleMultiCursorModifier","notebook.action.toggleNotebookStickyScroll","workbench.action.toggleSidebarPosition","workbench.action.toggleSidebarVisibility","editor.action.toggleRenderWhitespace","editor.action.toggleScreenReaderAccessibilityMode","workbench.action.toggleScreencastMode","workbench.action.toggleAuxiliaryBar","workbench.action.toggleStatusbarVisibility","editor.action.toggleTabFocusMode","testing.toggleTestingPeekHistory","workbench.action.toggleEditorGroupLayout","redo","editor.action.selectAll","undo","debug.addConfiguration","workbench.debug.viewlet.action.addDataBreakpointOnAddress","workbench.debug.viewlet.action.addFunctionBreakpointAction","workbench.action.browseColorThemesInMarketplace","workbench.action.closeWindow","workbench.action.selectTheme","workbench.action.tasks.configureDefaultTestTask","workbench.action.configureRuntimeArguments","remote.tunnel.copyAddressCommandPalette","workbench.action.selectIconTheme","workbench.action.focusActivityBar","workbench.action.focusBanner","workbench.action.generateColorTheme","workbench.action.activityBarLocation.hide","editor.action.measureExtHostLatency","workbench.action.activityBarLocation.bottom","workbench.action.activityBarLocation.top","workbench.action.nextSideBarView","workbench.action.tasks.openUserTasks","welcome.showAllWalkthroughs","workbench.action.previousSideBarView","workbench.action.selectProductIconTheme","workbench.action.reloadWindowWithExtensionsDisabled","workbench.debug.viewlet.action.removeAllBreakpoints","editor.inlayHints.Reset","resetGettingStartedProgress","workbench.action.zoomReset","workbench.action.restartExtensionHost","remote.tunnel.closeCommandPalette","workbench.action.switchWindow","workbench.debug.viewlet.action.toggleBreakpointsActivatedAction","workbench.action.toggleLightDarkThemes","breadcrumbs.toggle","editor.action.toggleColumnSelection","workbench.action.toggleDevTools","debug.action.toggleDisassemblyViewSourceCode","tree.toggleStickyScroll","workbench.action.uninstallCommandLine","workbench.action.openWalkthrough","workbench.action.zoomIn","editor.action.clipboardCopyAction","editor.action.clipboardCutAction","editor.action.clipboardPasteAction","notification.acceptPrimaryAction","_workbench.extensions.action.cleanUpExtensionsFolder","notifications.clearAll","workbench.action.clearCommandHistory","workbench.action.configureLanguageBasedSettings","workbench.extensions.action.configureWorkspaceFolderRecommendedExtensions","workbench.extensions.action.disableAll","workbench.extensions.action.disableAllWorkspace","notifications.focusToasts","workbench.debug.action.focusBreakpointsView","workbench.debug.action.focusCallStackView","workbench.panel.repl.view.focus","workbench.views.extensions.disabled.focus","workbench.views.extensions.enabled.focus","workbench.extensions.action.focusExtensionsView","workbench.explorer.fileView.focus","workbench.views.extensions.installed.focus","workbench.files.action.focusOpenEditorsView","outline.focus","workbench.panel.output.focus","workbench.panel.markers.view.focus","workbench.view.search.focus","workbench.scm.repositories.focus","workbench.scm.focus","terminal.focus","timeline.focus","workbench.debug.action.focusVariablesView","workbench.debug.action.focusWatchView","workbench.action.focusTitleBar","workbench.action.openAccessibilitySettings","workbench.action.openDefaultKeybindingsFile","workbench.action.openRawDefaultSettings","workbench.extensions.action.openExtensionsFolder","workbench.action.openGlobalKeybindings","workbench.action.openGlobalKeybindingsFile","workbench.action.openQuickChat","search.action.openInEditor","workbench.action.openSettings2","workbench.action.openGlobalSettings","workbench.action.openSettingsJson","workbench.action.openView","workbench.action.openWorkspaceSettings","workbench.action.openWorkspaceSettingsFile","workbench.profiles.actions.help","workbench.action.quickTextSearch","workbench.extensions.action.refreshExtension","editor.emmet.action.removeTag","workbench.action.openIssueReporter","workbench.action.reportPerformanceIssueUsingReporter","workbench.action.showCommands","workbench.extensions.action.listBuiltInExtensions","workbench.extensions.action.showDisabledExtensions","workbench.extensions.action.showEnabledExtensions","workbench.extensions.action.listWorkspaceUnsupportedExtensions","notifications.showList","workbench.profiles.actions.showProfileContents","workbench.action.remote.showMenu","workbench.action.showWindowLog","notifications.toggleDoNotDisturbMode","notifications.toggleDoNotDisturbModeBySource","editor.action.toggleStickyScroll","editor.action.accessibilityHelp","editor.action.accessibleView","extension.js-debug.addXHRBreakpoints","editor.emmet.action.balanceIn","editor.emmet.action.balanceOut","workbench.debug.panel.action.clearReplAction","workbench.action.clearLocalePreference","workbench.output.action.clearOutput","json.clearCache","search.action.clearHistory","workbench.files.action.collapseExplorerFolders","workbench.action.configureLocale","workbench.action.openSnippets","editor.emmet.action.decrementNumberByOneTenth","editor.emmet.action.decrementNumberByOne","editor.emmet.action.decrementNumberByTen","workbench.action.localHistory.deleteAll","extension.js-debug.disableSourceMapStepping","extension.js-debug.editXHRBreakpoints","editor.emmet.action.evaluateMathExpression","workbench.action.populateFileFromSnippet","references-view.findImplementations","workbench.action.localHistory.restoreViaPicker","workbench.action.findInFiles","search.action.focusSearchList","npm.focus","workbench.panel.chat.view.copilot.focus","~remote.forwardedPorts.focus","workbench.action.problems.focus","editor.emmet.action.matchTag","editor.emmet.action.nextEditPoint","editor.emmet.action.prevEditPoint","accessibility.announcement.help","signals.sounds.help","editor.emmet.action.incrementNumberByOneTenth","editor.emmet.action.incrementNumberByOne","editor.emmet.action.incrementNumberByTen","workbench.action.showInteractivePlayground","extension.js-debug.createDebuggerTerminal","vscode-testresolver.killServerAndTriggerHandledError","editor.emmet.action.mergeLines","ipynb.newUntitledIpynb","search.action.openNewEditor","vscode-testresolver.newWindow","git.openAllChanges","git.openChange","extension.js-debug.debugLink","workbench.action.openLogFile","search.action.openNewEditorToSide","search.action.openEditor","workbench.action.webview.openDeveloperTools","perf.event.profiling","perf.insta.printAsyncCycles","perf.insta.printTraces","github.publish","editor.emmet.action.reflectCSSValue","workbench.files.action.refreshFilesExplorer","extension.js-debug.removeAllCustomBreakpoints","extension.js-debug.callers.removeAll","extension.js-debug.callers.remove","extension.js-debug.removeXHRBreakpoint","workbench.action.replaceInFiles","editor.emmet.action.selectNextItem","editor.emmet.action.selectPrevItem","simpleBrowser.show","references-view.showCallHierarchy","workbench.action.showEmmetCommands","git.showOutput","references-view.showIncomingCalls","workbench.action.showLogs","editor.action.showOrFocusStandaloneColorPicker","references-view.showOutgoingCalls","workbench.action.showOutputChannels","workbench.action.showRuntimeExtensions","references-view.showSubtypes","references-view.showSupertypes","vscode-testresolver.showLog","references-view.showTypeHierarchy","vscode-testresolver.toggleConnectionSlowdown","json.sort","editor.emmet.action.splitJoinTag","git.diff.stageHunk","git.diff.stageSelection","extension.node-debug.startWithStopOnEntry","perfview.show","extension.node-debug.toggleAutoAttach","editor.emmet.action.toggleComment","extension.js-debug.addCustomBreakpoints","workbench.action.toggleLockedScrolling","workbench.action.toggleNotebookClipboardLog","workbench.action.togglePanel","extension.js-debug.toggleSkippingFile","workbench.action.editorLayoutTwoColumnsBottom","workbench.action.editorLayoutTwoColumns","workbench.action.editorLayoutTwoRows","workbench.action.editorLayoutTwoRowsRight","workbench.action.unpinEditor","editor.emmet.action.updateImageSize","editor.emmet.action.updateTag","workbench.action.openLicenseUrl","editor.emmet.action.wrapWithAbbreviation","workbench.action.zoomOut","inlineChat.copyRecordings","workbench.action.terminal.accessibleBufferGoToNextCommand","workbench.action.addRootFolder","search.action.cancel","workbench.action.terminal.changeColor","workbench.action.terminal.changeIcon","workbench.action.editor.changeLanguageMode","workbench.profiles.actions.cleanupProfiles","workbench.action.terminal.clear","workbench.action.chat.clearHistory","workbench.action.chat.clearInputHistory","workbench.action.terminal.clearPreviousSessionHistory","workbench.action.terminal.clearSelection","workbench.action.closeFolder","workbench.files.action.compareFileWith","workbench.action.terminal.openSettings","workbench.action.copyEditorToNewWindow","workbench.action.terminal.copyLastCommand","workbench.action.terminal.copyLastCommandAndLastCommandOutput","workbench.action.terminal.copyLastCommandOutput","workbench.profiles.actions.createTemporaryProfile","workbench.action.localHistory.create","workbench.action.terminal.new","workbench.action.terminal.newInActiveWorkspace","workbench.action.createTerminalEditor","workbench.action.createTerminalEditorSide","workbench.action.terminal.newWithCwd","workbench.action.decreaseViewSize","workbench.action.decreaseViewHeight","workbench.action.decreaseViewWidth","workbench.action.terminal.fontZoomOut","workbench.action.terminal.detachSession","workbench.debug.viewlet.action.disableAllBreakpoints","workbench.action.duplicateWorkspaceInNewWindow","workbench.debug.viewlet.action.enableAllBreakpoints","workbench.action.minimizeOtherEditorsHideSidebar","workbench.action.chat.export","workbench.action.terminal.findNext","workbench.action.terminal.findPrevious","breadcrumbs.focusAndSelect","breadcrumbs.focus","workbench.action.terminal.focusFind","workbench.action.terminal.focusHover","workbench.action.terminal.focusNext","workbench.action.terminal.focusNextPane","workbench.action.terminal.focusPrevious","workbench.action.terminal.focusPreviousPane","workbench.action.terminal.focus","workbench.action.terminal.focusTabs","workbench.action.terminal.goToRecentDirectory","hideCustomTitleBar","workbench.action.hideEditorActions","workbench.action.hideEditorTabs","workbench.action.terminal.hideFind","workbench.action.chat.import","workbench.action.increaseViewSize","workbench.action.increaseViewHeight","workbench.action.increaseViewWidth","workbench.action.terminal.fontZoomIn","workbench.action.chat.inlineVoiceChat","workbench.action.chat.insertCodeBlock","workbench.action.chat.insertIntoNewFile","editor.action.insertSnippet","workbench.action.terminal.join","workbench.action.terminal.killAll","workbench.action.terminal.killEditor","workbench.action.terminal.kill","workbench.action.lockEditorGroup","workbench.action.maximizeEditorHideSidebar","workbench.action.editorActionsTitleBar","workbench.action.moveEditorToNewWindow","workbench.action.terminal.moveToEditor","workbench.action.terminal.moveIntoNewWindow","workbench.action.chat.newChat","workbench.action.chat.nextCodeBlock","workbench.action.chat.nextFileTree","workbench.action.debug.configure","workbench.action.files.showOpenedFileInNewWindow","workbench.action.chat.openInEditor","workbench.action.chat.openInNewWindow","workbench.action.chat.openInSidebar","workbench.action.terminal.openDetectedLink","workbench.action.openChat","workbench.action.files.openFolder","workbench.action.terminal.openFileLink","workbench.action.terminal.openUrlLink","workbench.action.openWorkspace","workbench.action.files.openFileFolder","workbench.action.chat.previousCodeBlock","workbench.action.chat.previousFileTree","workbench.action.quickOpenLeastRecentlyUsedEditorInGroup","workbench.action.quickOpenPreviousRecentlyUsedEditorInGroup","workbench.action.chat.quickVoiceChat","workbench.action.terminal.recordSession","workbench.action.terminal.relaunch","workbench.action.removeRootFolder","workbench.action.terminal.renameWithArg","workbench.profiles.actions.renameProfile","workbench.action.terminal.rename","workbench.action.reopenTextEditor","workbench.action.files.resetActiveEditorReadonlyInSession","workbench.action.terminal.fontZoomReset","workbench.profiles.actions.resetWorkspaces","workbench.action.terminal.resizePaneDown","workbench.action.terminal.resizePaneLeft","workbench.action.terminal.resizePaneRight","workbench.action.terminal.resizePaneUp","workbench.action.terminal.restartPtyHost","workbench.action.saveWorkspaceAs","workbench.action.terminal.scrollDown","workbench.action.terminal.scrollDownPage","workbench.action.terminal.scrollToBottom","workbench.action.terminal.scrollToNextCommand","workbench.action.terminal.scrollToPreviousCommand","workbench.action.terminal.scrollToTop","workbench.action.terminal.scrollUp","workbench.action.terminal.scrollUpPage","workbench.action.terminal.selectAll","workbench.action.terminal.selectDefaultShell","workbench.action.terminal.selectToNextCommand","workbench.action.terminal.selectToNextLine","workbench.action.terminal.selectToPreviousCommand","workbench.action.terminal.selectToPreviousLine","workbench.action.toggleSeparatePinnedEditorTabs","workbench.action.files.setActiveEditorReadonlyInSession","workbench.action.files.setActiveEditorWriteableInSession","workbench.action.terminal.setDimensions","workbench.action.chat.history","workbench.action.terminal.showEnvironmentContributions","workbench.action.showEditorTab","workbench.action.terminal.showTextureAtlas","workbench.action.splitEditorInGroup","workbench.action.terminal.split","workbench.action.terminal.splitInActiveWorkspace","workbench.action.editorDictation.start","extension.bisect.start","inlineChat.start","workbench.action.terminal.chat.start","workbench.action.startTrackDisposables","workbench.action.chat.startVoiceChat","workbench.action.quickOpenTerm","workbench.action.terminal.switchTerminal","workbench.action.files.toggleActiveEditorReadonlyInSession","workbench.action.toggleCenteredLayout","workbench.action.toggleEditorVisibility","workbench.action.toggleEditorType","workbench.action.toggleFullScreen","workbench.action.toggleMaximizedPanel","workbench.action.terminal.sizeToContentWidth","workbench.action.toggleSplitEditorInGroup","workbench.action.terminal.toggleStickyScroll","workbench.action.toggleZenMode","workbench.action.troubleshootIssue.start","workbench.action.terminal.unsplit","workbench.action.terminal.searchWorkspace","workbench.action.terminal.toggleFindCaseSensitive","workbench.action.terminal.toggleFindRegex","workbench.action.terminal.toggleFindWholeWord","workbench.action.chat.voiceChatInChatView","workbench.action.terminal.writeDataToTerminal","merge-conflict.accept.all-both","merge-conflict.accept.all-current","merge-conflict.accept.all-incoming","merge-conflict.accept.both","merge-conflict.accept.current","merge-conflict.accept.incoming","merge-conflict.accept.selection","git.addRemote","git.stashApplyLatest","git.stashApply","git.checkoutDetached","git.checkout","git.cherryPick","git.clone","git.cloneRecursive","git.closeAllDiffEditors","git.closeAllUnmodifiedEditors","git.closeOtherRepositories","git.close","git.commit","git.commitAmend","git.commitSigned","git.commitAll","git.commitAllAmend","git.commitAllSigned","git.commitEmpty","git.commitStaged","git.commitStagedAmend","git.commitStagedSigned","merge-conflict.compare","jupyter.continueEditSessionInCodespace","issue.copyGithubHeadLink","issue.copyGithubPermalink","issue.copyMarkdownGithubPermalink","git.branchFrom","git.branch","jupyter.createnewinteractive","workbench.action.terminal.newWithProfile","workbench.profiles.actions.createProfile","git.createTag","git.deleteBranch","workbench.profiles.actions.deleteProfile","git.deleteRemoteTag","git.deleteTag","git.cleanAll","git.cleanAllTracked","git.cleanAllUntracked","git.clean","git.stashDropAll","git.stashDrop","github.copilot.interactiveEditor.explain.palette","workbench.profiles.actions.exportProfile","git.fetch","git.fetchPrune","git.fetchAll","jupyter.filterKernels","github.copilot.interactiveEditor.fix","github.copilot.interactiveEditor.generateDocs","github.copilot.interactiveEditor.generateTests","github.copilot.interactiveEditor.generate","git.init","git.merge","merge-conflict.next","git.openRepository","git.stashPopLatest","git.stashPop","merge-conflict.previous","git.publish","git.pull","git.pullRebase","git.pullFrom","git.push","git.pushWithTags","git.pushTags","git.pushTo","git.rebase","git.refresh","git.removeRemote","git.renameBranch","jupyter.resetLoggingLevel","workbench.profiles.actions.createFromCurrentProfile","jupyter.selectJupyterInterpreter","github.copilot.interactiveSession.feedback","workbench.panel.chatSidebar","workbench.view.explorer","workbench.view.extensions","workbench.view.extension.github-pull-requests","workbench.view.debug","workbench.view.search","workbench.view.scm","git.stageAll","git.stageAllMerge","git.stageAllTracked","git.stageAllUntracked","git.stage","git.stash","git.stashIncludeUntracked","git.stashStaged","workbench.profiles.actions.switchProfile","git.sync","git.syncRebase","workbench.panel.comments","workbench.debug.action.toggleRepl","workbench.action.output.toggleOutput","~remote.forwardedPortsContainer","workbench.actions.view.problems","workbench.action.terminal.toggleTerminal","workbench.editSessions.actions.signIn","git.undoCommit","git.unstageAll","git.unstage","git.viewChanges","github.copilot.debug.contentExclusions","git.viewStagedChanges","git.stashView"]);function E8e(t,e){let r=Cs(e);for(let n of r){if(n.language!=="json"&&n.language!=="")return[];let o;try{o=Yh(n.code)}catch{}if(!o||!o.hasOwnProperty("command"))return[];let s=t.getCommand(o.command);if(s)return[{command:s.key,title:s.label,arguments:o.args}]}return[]}function Cce(t){let e=new Tt,r=t.get(ar),n=r.extensionMode;return typeof n=="number"&&n!==oy.ExtensionMode.Test&&e.add(new oj(r,t)),e}var oj=class extends Tt{constructor(e,r){super();let n=r.get(ye);this.add(oy.workspace.onDidChangeConfiguration(o=>{if(o.affectsConfiguration("github.copilot.chat.runCommand.enabled")){let s=n.getConfig(fe.RunCommandEnabled);oy.commands.executeCommand("setContext","github.copilot.chat.runCommand.enabled",s),s&&e.globalState.update(sR,!1)}})),oy.commands.executeCommand("setContext","github.copilot.chat.runCommand.enabled",n.getConfig(fe.RunCommandEnabled))}};var wce=z(Qt());var Ece=z(Qt()),Tce=z(require("fs"));var aR=z(at());var M1=class extends Q{render(e,r){return vscpp(vscppf,null,this.props.history&&vscpp(Lt,{priority:600,history:this.props.history}),vscpp(aR.SystemMessage,{priority:1e3},"You are a coding assistant who helps the user find relevant code in their workspace by providing a list of relevant keywords they can search for.",vscpp("br",null),"The user will provide you with potentially relevant information from the workspace. This information may be incomplete.",vscpp("br",null),"Respond in Markdown. First under a `# Question` header, output a rephrased version of the user's question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for.",vscpp("br",null),"Then under a `# Keywords` header, output a short markdown list of up to 8 relevant keywords that the user can search for to answer the question. You may include variations after each keyword.",vscpp("br",null),"DO NOT ask the user for additional information or clarification.",vscpp("br",null),"DO NOT answer the user's question directly.",vscpp("br",null),vscpp("br",null),"# Additional Rules",vscpp("br",null),vscpp("br",null),"Think step by step:",vscpp("br",null),"1. Read the user's question to understand what they are asking about their workspace.",vscpp("br",null),"2. If the question contains pronouns such as 'it' or 'that', try to understand what the pronoun refers to by looking at the rest of the question and the conversation history.",vscpp("br",null),"3. If the question contains an ambiguous word such as 'this', try to understand what is refers to by looking at the rest of the question, the user's active selection, and the conversation history.",vscpp("br",null),"4. After a `# Question` header, output a precise version of question that resolves all pronouns and ambiguous words like 'this' to the specific nouns they stand for. Be sure to preserve the exact meaning of the question by only changing ambiguous pronouns and words like 'this'.",vscpp("br",null),"5. Then after a `# Keywords` header, output a short markdown list of up to 8 relevant keywords that user could try searching for to answer their question. These keywords could used as file name, symbol names, abbreviations, or comments in the relevant code. Put the keywords most relevant to the question first. Do not include overly generic keywords. Do not repeat keywords.",vscpp("br",null),"6. For each keyword in the markdown list of related keywords, if applicable add a comma separated list of variations after it. For example: for 'encode' possible variations include 'encoding', 'encoded', 'encoder', 'encoders'. Consider synonyms and plural forms. Do not repeat variations.",vscpp("br",null),vscpp("br",null),"Examples",vscpp("br",null),vscpp("br",null),"User: base64 encoding",vscpp("br",null),vscpp("br",null),"Assistant:",vscpp("br",null),"# Question",vscpp("br",null),"Where's the code for base64 encoding?",vscpp("br",null),vscpp("br",null),"# Keywords",vscpp("br",null),"- base64 encoding, base64 encoder, base64 encode",vscpp("br",null),"- base64, base 64",vscpp("br",null),"- encode, encoded, encoder, encoders"),this.props.fileTree&&vscpp(aR.UserMessage,{priority:700},this.props.fileTree),vscpp(aR.UserMessage,{priority:1e3},this.props.query))}};var u4=ae("IWorkspaceSemanticChunkService"),F1=class{constructor(e){this._accessor=e;this._workspaceChunkSearch=this._accessor.get(Oh),this._chatFetcher=this._accessor.get(Bt)}async searchFileChunks(e,r,n,o){let{messages:s}=await this.buildMetaPrompt(r,e,o);if(o.isCancellationRequested)return[];let a=await this._chatFetcher.fetchOne(s,async u=>{},o,2,r,{agent:tf},{temperature:.1,top_p:1,stop:["dontStopBelieving"]},{messageSource:"semanticSearchIntent"});if(a.type!=="success")throw new Error(Ece.t("Encountered an error while deciding what workspace information to collect: ({0}) {1}",a.type,a.reason));if(o.isCancellationRequested)return[];let c=Vx(e,a.value);return sj(this._workspaceChunkSearch,r,e,c,n,o,!1)}dispose(){}async buildMetaPrompt(e,r,n){let o=await Hw(this._accessor,1e3,n);return $e.create(this._accessor.get(te),e,M1,{query:r,fileTree:o}).render()}};F1=O([x(0,je)],F1);async function sj(t,e,r,n,o,s,a){let c={rawQuery:r,resolve:async()=>({rephrasedQuery:n.rephrasedQuestion,keywords:n.keywords})},u=(await t.searchFileChunks(e,c,o,{},s)).slice(0,o);return s.isCancellationRequested||!u.length?[]:await T8e(u,a)}async function T8e(t,e){let r=[],n=new Nn;for(let[o,s]of t.entries()){let a=n.get(s.file),c=a?a.rank:o,u=a?[...a.ranges,s.range]:[s.range];n.set(s.file,{ranges:u,rank:c})}for(let[o,s]of n.entries()){let a=s.ranges.filter((f,m)=>{for(let[h,g]of s.ranges.entries())if(m!==h&&f.containsRange(g))if(f.equalsRange(g)){if(m<h)return!1}else return!1;return!0}),c=[],u;a.sort((f,m)=>f.startLineNumber-m.startLineNumber);for(let f of a)u&&u.endLineNumber>=f.startLineNumber-1?u=new bt(u.startLineNumber,u.startColumn,f.endLineNumber,f.endColumn):(u&&c.push(u),u=f);u&&c.push(u);let d=(await Tce.promises.readFile(o.fsPath,"utf8")).split(`
`),p=[];for(let f of c){let m=f.startLineNumber,h=f.endLineNumber,g=d.slice(m,h);if(!R8e(g,5))continue;let{trimmedLines:v}=pw(w8e(g,1e3,15)),y;e?(v.length<g.length&&v.push("..."),y=gi(uc(o).replace(/\./g,""),v.join(`
`).replace(/^\n*|\n*$/g,""),!1)):y=v.join(`
`),p.push({range:f,code:y})}p.length>0&&r.push({result:{file:o,locations:p},rank:s.rank})}return r.sort((o,s)=>o.rank-s.rank).map(o=>o.result)}function w8e(t,e,r){let n=[],o=0;for(;o<t.length&&n.join(`
`).length<e&&n.length<r;)n.push(t[o]),o++;return n}function R8e(t,e){let r=0;for(let n of t)if(r+=n.trim().length,r>=e)return!0;return!1}var U1=class{constructor(e,r){this._endpointProvider=e;this._workspaceSemanticChunkService=r}provideAITextSearchResults(e,r,n,o){return(async()=>(this._endpoint=this._endpoint??await this._endpointProvider.getChatEndpoint("gpt-4"),(await this._workspaceSemanticChunkService.searchFileChunks(e,this._endpoint,10,o)).forEach(c=>{c.locations.forEach(u=>{n.report({uri:c.file,ranges:Rh(u.range),preview:{text:u.code,matches:new Ge(new $n(0,u.range.startColumn),new $n(u.range.endLineNumber-u.range.startLineNumber,u.range.endColumn))}})})}),{limitHit:!1,message:{text:wce.t("Results are from Copilot"),trusted:!0,type:1}}))()}};U1=O([x(0,Le),x(1,u4)],U1);var v4=z(require("vscode"));var cR;(e=>{function t(r,n){let{options:o,document:s,selection:a,visibleRanges:c}=r,u={insertSpaces:o.insertSpaces,tabSize:o.tabSize},l=Is(s);return n||(c.length===1?n=c[0]:c.length>1?n=c[0].union(c[c.length-1]):n=a),{document:s,fileIndentInfo:u,language:l,selection:a,wholeRange:n}}e.fromEditor=t})(cR||={});var Jh=z(at());var sy="---",In;(o=>(o.FILEPATH=sy+"FILEPATH",o.ORIGINAL=sy+"ORIGINAL",o.PATCHED=sy+"PATCHED",o.COMPLETE=sy+"COMPLETE"))(In||={});var B1=class extends Q{render(){return vscpp(vscppf,null,"When proposing a code change, provide one or more modifications in the following format:",vscpp("br",null),"Each modification consist of three sections headed by `",In.FILEPATH,"`, `",In.ORIGINAL,"` and `",In.PATCHED,"`.",vscpp("br",null),"After ",In.FILEPATH," add the path to the file that needs to be changed.",vscpp("br",null),"After ",In.ORIGINAL," add a code block containing a section of the program that requires replacement.",vscpp("br",null),"The original section consists of one or more consecutive lines including comments and empty lines exactly as they appear in the original source code.",vscpp("br",null),"Be careful that the section exactly matches the code in the original program so it can be found by a find tool. Do not abreviate any line or summarize the code with `...` ",vscpp("br",null),"After ",In.PATCHED," add a code block with the updated version of the original code, maintaining the same indentation and code style as in the original code.",vscpp("br",null),"After all modifications, add ",In.COMPLETE,".",vscpp("br",null))}},l4=class extends Q{render(){return vscpp(vscppf,null,"```csharp",vscpp("br",null),"// This is my class",vscpp("br",null),"class C { }",vscpp("br",null),vscpp("br",null),"new C().Field = 9;",vscpp("br",null),"```")}},d4=class extends Q{render(){return vscpp(vscppf,null,"The problem is that the class 'C' does not have a field or property named 'Field'. To fix this, you need to add a 'Field' property to the 'C' class.",vscpp("br",null),vscpp("br",null),Cf("someFolder/myFile.cs"),vscpp("br",null),In.ORIGINAL,vscpp("br",null),"```",vscpp("br",null),"// This is my class",vscpp("br",null),"class C { }",vscpp("br",null),"```",vscpp("br",null),In.PATCHED,vscpp("br",null),"```",vscpp("br",null),"// This is my class",vscpp("br",null),"class C {",vscpp("br",null),"public int Field { get; set; }",vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),Cf("someFolder/myFile.cs"),vscpp("br",null),In.ORIGINAL,vscpp("br",null),"```",vscpp("br",null),"new C().Field = 9;",vscpp("br",null),In.PATCHED,vscpp("br",null),"```",vscpp("br",null),"// set the field to 9",vscpp("br",null),"new C().Field = 9;",vscpp("br",null),"```",vscpp("br",null),In.COMPLETE,vscpp("br",null))}};function Cf(t){return`${In.FILEPATH} ${U_(t)}`}function Dce(t){return`${sy}${t}`}function p4(t){return!t.match(/\S/)}function P8e(t,e,r,n){let o=0;for(;o<e.length&&p4(e[o]);)o++;if(o===e.length){let d=xh(t,4,!1),p=t.length>0?f4(t[0],d.tabSize).level:0,f=Rce(r,p,d);return On.insert(new $n(n,0),f)}let s=e[o],a=aj(s),c,u=0,l=o;e:for(;u<t.length;){for(;u<t.length&&!kce(t[u],s,a);)u++;if(u===t.length)return c??{message:"Snippet first line not found",label:"invalid patch",severity:"error"};let d=u,p=-1;for(;u<t.length&&l<e.length;){let f=t[u];if(aj(f)===f.length){u++;continue}let h=e[l],g=aj(h);if(g===h.length){l++;continue}if(kce(f,h,g))p=u,u++,l++;else{u=d+1,l=o,h.indexOf("...")!==-1?c={message:"Snippet contains ellipses",label:"patch lazy",severity:"error"}:A8e(f)?c={message:"Snippet not matching a comment",label:"patch no comment",severity:"error"}:c={message:`Snippet line ${l} does not match line ${u}`,label:"invalid patch",severity:"error"};continue e}}for(;l<e.length&&p4(e[l]);)l++;if(l===e.length&&d!==-1&&p!==-1){let f=xh(t,4,!1),m=f4(t[d],f.tabSize).level,h=Rce(r,m,f);return On.replace(new Ge(d,0,p,t[p].length),h)}}return c??{message:"Not all lines of snippet found",label:"invalid patch",severity:"error"}}function Nce(t){return t===32||t===9}function A8e(t){return t.match(/^\s*(\/\/|\/\*|#)/)!==null}function Rce(t,e,r){let n,o=0;for(n=0;n<t.length&&p4(t[n]);n++);if(n===t.length)return"";for(o=t.length;o>n&&p4(t[o-1]);o--);let s=f4(t[n],r.tabSize).level,a=[];for(let c=n;c<o;c++){let u=t[c],{level:l,length:d}=f4(u,r.tabSize),p=Math.max(0,e+l-s),f=r.insertSpaces?" ".repeat(r.tabSize*p):"	".repeat(p);a.push(f+u.substring(d))}return a.join(`
`)}function aj(t){let e=0;for(;e<t.length&&Nce(t.charCodeAt(e));)e++;return e}function f4(t,e){let r=0,n=0,o=0,s=0,a=t.length;for(;o<a;){let c=t.charCodeAt(o);if(c===32)r++,r===e&&(n++,r=0,s=o+1);else if(c===9)n++,r=0,s=o+1;else break;o++}return{level:n,length:s}}function kce(t,e,r){let n=t.length-1,o=e.length-1;for(;n>=0&&o>=r&&t.charCodeAt(n)===e.charCodeAt(o);)n--,o--;if(o>=r)return!1;for(;n>=0&&Nce(t.charCodeAt(n));)n--;return n<0}function m4(){return{getFirstSentence(t){let e=[];for(let r of Ace(t)){if(r.length===0||r.startsWith(sy))break;e.push(r)}return e.join(`
`)},process(t,e,r,n=0){let o,s,a=[],c=[],u=[],l=[],d=[],p=[],f=new Set;e:for(let m of N8e(Ace(t)))switch(m.marker){case void 0:break;case In.FILEPATH:s=m.content.join(`
`).trim();break;case In.ORIGINAL:o=m.content;break;case In.PATCHED:{m.content&&o&&s&&(u.push({fileName:s,find:o,replace:m.content}),f.add(s));break}case In.COMPLETE:break e;default:c.push(m);break}if(u.length===0)return a.push({message:"No patch sections found",label:"no patch",severity:"error"}),{edits:l,otherSections:c,invalidPatches:d,otherPatches:p,annotations:a};if(r){let m=U_(r.fsPath);f.has(m)||a.push({message:`No patch for input document: ${m}, patches for ${[...f.keys()].join(", ")}`,label:"other file",severity:"warning"}),f.size>1&&a.push({message:`Multiple files modified: ${[...f.keys()].join(", ")}`,label:"multi file",severity:"warning"});let h=[];for(let g of u)g.fileName!==m?p.push(g):h.push(g);u=h}if(u.length!==0){let m=yx.fromString(e);for(let h of u){let g=P8e(m,Pce(h.find),Pce(h.replace),n);g instanceof On?D8e(l,g)||(a.push({message:"Overlapping edits",label:"overlapping edit",severity:"error"}),d.push(h)):(a.push(g),d.push(h))}}return{edits:l,otherSections:c,invalidPatches:d,otherPatches:p,annotations:a}}}}function D8e(t,e){for(let r=0;r<t.length;r++){let n=t[r];if(e.range.end.isBeforeOrEqual(n.range.start))return t.splice(r,0,e),!0;if(e.range.start.isBefore(n.range.end))return!1}return t.push(e),!0}function Pce(t){let e=[],r=!1;for(let n of t)if(n.startsWith("```")){if(r)return e;r=!0}else r&&e.push(n);return t}function*N8e(t){let e,r=[];for(let n of t){let o;if(n.startsWith(sy)){n.startsWith(In.FILEPATH)?o=In.FILEPATH:n.startsWith(In.ORIGINAL)?o=In.ORIGINAL:n.startsWith(In.PATCHED)?o=In.PATCHED:n.startsWith(In.COMPLETE)?o=In.COMPLETE:o=n,yield{marker:e,content:r},r=[n.substring(o.length)],e=o;continue}r.push(n)}e&&(yield{marker:e,content:r})}function*Ace(t){let e=0,r=t.indexOf(`
`);for(;r!==-1;)yield t.substring(e,r),e=r+1,r=t.indexOf(`
`,e);e<t.length&&(yield t.substring(e))}var h4=class extends Jh.PromptMetadata{constructor(r,n,o){super();this.projectedDocument=r;this.documentUri=n;this.adjustedSelection=o}},q1=class extends Q{constructor(r,n,o){super(r);this.ignoreService=n;this.parserService=o}async prepare(r){let{document:n,wholeRange:o,fileIndentInfo:s}=this.props.documentContext,a=await this.ignoreService.isCopilotIgnored(n.uri),c=r.endpoint.modelMaxPromptTokens/3*4,u;if(!a&&n.getText().length>c){let l=await Y0(this.parserService,n,s);u=Tx(c,n,o,l,{tryPreserveTypeChecking:!1})}else u=new hc(n.getText(),Wr.empty,n.languageId);return{projectedDocument:u,isIgnored:a}}render(r,n){let{language:o,document:s,selection:a}=this.props.documentContext,c=r.projectedDocument,u=c.projectRange(a),l=s.getText(a).trim(),d=[{uri:s.uri,version:s.version,ranges:[]}];return vscpp(vscppf,null,vscpp("usedContext",{value:d}),vscpp("meta",{value:new h4(r.projectedDocument,s.uri,u)}),vscpp(Jh.SystemMessage,{priority:1e3},"You are an AI programming assistant that is specialized in applying code changes to an existing document.",vscpp("br",null),"I have a code block that represents a suggestion for a code change and I have a ",o.languageId," file opened in a code editor.",vscpp("br",null),"I expect you to come up with code changes that apply the code block to the editor at a given selection. ",vscpp("br",null),"I want the changes to be applied in a way that is safe and does not break the existing code, is correctly indented and matching the code style.",vscpp("br",null),"For the response, always follow these instructions:",vscpp("br",null),"1. Analyse the code block, the content of the editor and the current selection to decide if the code block should replace existing code or is to be inserted.",vscpp("br",null),"2. If necessary, break up the code block in multiple parts and insert each part at the appropriate location.",vscpp("br",null),"3. If necessary, make changes to other parts in the editor so that the final result is valid, propertly formatted and indented.",vscpp("br",null),"4. Finally, provide the code modifications",vscpp("br",null),vscpp(B1,null),vscpp("br",null),vscpp(Zt,null),vscpp(cr,null)),vscpp(Jh.UserMessage,{priority:700},vscpp(_d,null,c.text.length>0?vscpp(vscppf,null,"I have the following code open in the editor, starting from line 1 to line ",c.lineCount,".",vscpp("br",null),Cf(s.fileName),vscpp("br",null),vscpp(Oe,{uri:s.uri,languageId:o.languageId,code:c.text,shouldTrim:!1}),vscpp("br",null)):vscpp(vscppf,null,"I am in an empty file:",Cf(s.fileName),vscpp("br",null))),vscpp(_d,null,a.isEmpty?vscpp(vscppf,null,"I have the selection at line ",u.start.line+1,", column ",u.start.character+1,vscpp("br",null)):vscpp(vscppf,null,"I have currently selected from line ",u.start.line+1,", column ",u.start.character+1," to line ",u.end.line+1," column ",u.end.character+1,".",vscpp("br",null),l.length>0?vscpp(vscppf,null,"The content of the selection is",vscpp(Oe,{uri:s.uri,languageId:o.languageId,code:l,shouldTrim:!1}),vscpp("br",null)):vscpp(vscppf,null,"The selection consists of whitespaces only."))),vscpp(vscppf,null,"This is the code block that represents a suggestion for a code change:",vscpp("br",null),vscpp(Oe,{uri:s.uri,languageId:o.languageId,code:this.props.codeBlock,shouldTrim:!1}),vscpp("br",null)),vscpp(Jh.TextChunk,null,"Please find out how the code block can be applied to the editor. Provide the code changes in the format as described above.",vscpp("br",null))))}};q1=O([x(1,De),x(2,mt)],q1);function Lce(t,e){let r=e.getMeta(h4);if(!r)throw new Error("CodeMapperPrompt: Metadata not found");let o=m4().process(t,r.projectedDocument.text,r.documentUri,r.adjustedSelection.start.line);return{edits:r.projectedDocument.projectBackTextEdit(o.edits),annotations:o.annotations}}var H1=class{constructor(e=!1,r,n,o,s,a,c,u,l){this.doReportTelemetry=e;this.endpointProvider=r;this.chatMLFetcher=n;this.conversationOptions=o;this.configurationService=s;this.experimentationService=a;this.logService=c;this.telemetryService=u;this.instantiationService=l;this.logger=c.getPromptResponseLogger("ai code mapper")}async mapCode(e,r,n,o){let s=await this.configurationService.getExperimentBasedConfig(fe.CodeMapperChatEndpoint,this.experimentationService)??"gpt-3.5-turbo",a=await this.endpointProvider.getChatEndpoint(s),c=$e.create(this.instantiationService,a,q1,{documentContext:r,codeBlock:e}),u=Date.now(),l=await c.render(void 0,o),d=await this.chatMLFetcher.fetchOne(l.messages,void 0,o,3,a,void 0,{temperature:this.conversationOptions.temperature,top_p:this.conversationOptions.topP},{messageSource:"command.aiCodemapper"});this.logger.logResponse(d);let p;return d.type==="success"?p=Lce(d.value,c):p={edits:[],annotations:[],errorMessage:d.reason},this.doReportTelemetry&&this.reportTelemetry(a,d,Date.now()-u,p,r),p}reportTelemetry(e,r,n,o,s){if(this.telemetryService.sendMSFTTelemetryEvent("codemapper.request",{model:e.model,requestId:r.requestId,responseType:r.type,outcomeAnnotations:o.annotations?.map(a=>a.label).join(",")},{timeToComplete:n,editCount:o.edits.length}),o.edits.length){let a=this.instantiationService.createInstance(jh,s.document.getText());a.addEdits(o.edits);let c=this.instantiationService.createInstance(Hh,a.getText(),s.document);(async()=>{try{let[u,l]=await Promise.all([a.getEdits(),c.compute()]),d=l.getEditsSinceInitial(),p={requestId:r.requestId,command:"codemapper"};this.instantiationService.createInstance(Cd,s.document,a.initialText,u,d,PL(p,void 0))}finally{c.dispose()}})()}}};H1=O([x(1,Le),x(2,Bt),x(3,Sn),x(4,ye),x(5,Ut),x(6,ue),x(7,me),x(8,te)],H1);var xl=z(require("vscode"));var g4=class{provideMappedEdits(e,r,n,o){if(n.documents.length===0)return null;let s=n.documents[0],a=e.uri.toString(),c=s.find(b=>b.uri.toString()===a);if(!c)return null;let u=c.ranges;if(u.length!==1||r.length!==1)return null;let l=u[0],d=r[0];if(!e.getText(new xl.Range(new xl.Position(l.start.line,0),new xl.Position(l.start.line,l.start.character))).match(/^\s*$/))return null;let f=xl.window.activeTextEditor,m;if(f&&f.options&&e.languageId===f.document.languageId){let b=f.options,_=typeof b.tabSize=="number"?b.tabSize:4,S=typeof b.insertSpaces=="boolean"?b.insertSpaces:!0;m={tabSize:_,insertSpaces:S}}let h=new xl.Range(new xl.Position(l.start.line,0),l.end),g=e.getText(h),v=Sh(d.split(`
`),{whichLine:"topMost",lines:g.split(`
`)},m).join(`
`),y=new xl.WorkspaceEdit;return y.replace(e.uri,h,v),y}};var j1=class{constructor(e){this.instantiationService=e;this.codeMapper=this.instantiationService.createInstance(H1,!0)}async provideMappedEdits(e,r,n,o){let s=v4.window.visibleTextEditors.find(a=>jT(a.document.uri,e.uri));if(s){let a=[];for(let l of n.documents)for(let d of l)jT(d.uri,e.uri)&&a.push(...d.ranges);let c=cR.fromEditor(s),u=await this.codeMapper.mapCode(r[0],c,a,o);if(u.edits.length){let l=new v4.WorkspaceEdit;return l.set(e.uri,u.edits),l}}return new g4().provideMappedEdits(e,r,n,o)}};j1=O([x(0,te)],j1);var V1=z(require("vscode"));var b4=z(at());var cj=class extends Q{render(){let e=this.props.issues?.map(r=>vscpp(vscppf,null,"------- Issue ",r.reference,":",vscpp("br",null),r.content,vscpp("br",null)));return e&&e.length>0?vscpp(vscppf,null,"You are an AI assistant for a software developer who is about to make a pull request to a GitHub repository to fix the following issues: ",vscpp("br",null),e):vscpp(vscppf,null,"You are an AI assistant for a software developer who is about to make a pull request to a GitHub repository.")}},uj=class extends Q{render(){return vscpp(vscppf,null,"Here are two good examples:",vscpp("br",null)," ",this.props.issues&&this.props.issues.length>0?vscpp(vscppf,null,"Example One:",vscpp("br",null),"+++Batch mark/unmark files as viewed",vscpp("br",null),"+++Previously, when marking/unmarking a folder as viewed, a request was sent for every single file. This PR ensures that only one request is sent when marking/unmarking a folder as viewed.",vscpp("br",null),"Fixes #4520+++",vscpp("br",null),"Example two:",vscpp("br",null),"+++Fallback to hybrid after 20 process ports",vscpp("br",null),"+++Additionally the \\`remote.autoForwardPortsSource\\` setting has been updated to remove the \\`markdownDescription\\` reference to a reload being required for changes to take effect.",vscpp("br",null),"Fixes microsoft/vscode-internalbacklog#4533+++",vscpp("br",null)):vscpp(vscppf,null,"Example One:",vscpp("br",null),"+++Batch mark/unmark files as viewed",vscpp("br",null),"+++Previously, when marking/unmarking a folder as viewed, a request was sent for every single file. This PR ensures that only one request is sent when marking/unmarking a folder as viewed.+++",vscpp("br",null),"Example two:",vscpp("br",null),"+++Fallback to hybrid after 20 process ports",vscpp("br",null),"+++Additionally the \\`remote.autoForwardPortsSource\\` setting has been updated to remove the \\`markdownDescription\\` reference to a reload being required for changes to take effect.+++",vscpp("br",null)),";")}},lj=class extends Q{render(){return vscpp(vscppf,null,vscpp(cj,{issues:this.props.issues}),"Pull requests have a short and concise title that describes the changes in the code and a slightly longer description.",vscpp("br",null),"To compose the description, read through each commit and patch and distill the essence of that commit into a concise description paragraph. Do not list commits, files or patches. Do not make up an issue reference if the pull request isn't fixing an issue.",vscpp("br",null),"If the pull request is fixing an issue, consider how the commits relate to the issue and include that in the description.",vscpp("br",null),"The title and description of a pull request should be markdown and start with +++ and end with +++.",vscpp("br",null),vscpp(uj,{issues:this.props.issues}))}},dj=class extends Q{render(){let e=this.props.commitMessages.map(n=>vscpp(vscppf,null,"* ",n,vscpp("br",null))),r=this.props.patches.map(n=>vscpp(vscppf,null,"```diff",vscpp("br",null),n,vscpp("br",null),"```",vscpp("br",null)));return vscpp(vscppf,null,"These are the commits that will be included in the pull request you are about to make:",vscpp("br",null),e,vscpp("br",null),"Below is a list of git patches that contain the file changes for all the files that will be included in the pull request:",vscpp("br",null),r,vscpp("br",null),"Based on the git patches and on the git commit messages above, the title and description of the pull request should be:",vscpp("br",null))}},y4=class extends Q{render(){return vscpp(vscppf,null,vscpp(b4.SystemMessage,null,vscpp(lj,{issues:this.props.issues}),vscpp(yi,null)),vscpp(b4.UserMessage,null,vscpp(dj,{commitMessages:this.props.commitMessages,patches:this.props.patches})))}};var _4=class t{constructor(e){this.accessor=e;this.disposables=new Tt;this.lastContext={commitMessages:[],patches:[]};this.internalLogger=e.get(ue).getPromptResponseLogger("GitHub pull request title and description generator"),this.logger=e.get(ue).getLogger("githubTitleAndDescriptionProvider"),this.logger.info("Initializing GitHub PR title and description provider provider."),this.options=e.get(Sn)}dispose(){this.disposables.dispose()}isRegenerate(e,r){if(e.length!==this.lastContext.commitMessages.length||r.length!==this.lastContext.patches.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==this.lastContext.commitMessages[n])return!1;for(let n=0;n<r.length;n++)if(r[n]!==this.lastContext.patches[n])return!1;return!0}async excludePatches(e){let r=this.accessor.get(De),n=[];for(let o of e)o.fileUri&&await r.isCopilotIgnored(dt.parse(o.fileUri))||o.previousFileUri&&o.previousFileUri!==o.fileUri&&await r.isCopilotIgnored(dt.parse(o.previousFileUri))||n.push(o.patch);return n}async provideTitleAndDescription(e,r){let n=e.commitMessages,o=eD(e.patches)?e.patches.map(p=>({patch:p})):e.patches,s=await this.excludePatches(o),a=e.issues,c=await this.accessor.get(Le).getChatEndpoint("gpt-3.5-turbo"),u=Math.floor(c.modelMaxPromptTokens*4/3),l=await this.createPRTitleAndDescriptionPrompt(n,s,a,u);this.internalLogger.logPrompt(l.messages);let d=await this.accessor.get(Bt).fetchOne(l.messages,void 0,r,3,c,void 0,{temperature:this.isRegenerate(n,s)?this.options.temperature+.1:this.options.temperature,top_p:this.options.topP},{messageSource:"extension.providePullRequestTitleAndDescription"});if(this.internalLogger.logResponse(d),this.lastContext={commitMessages:n,patches:s},d.type==="success")return t.parseFetchResult(d.value)}static parseFetchResult(e,r=!0){e=e.trim();let n=e,o=n.indexOf("+++");if(o===-1)return;let s=n.lastIndexOf("+++");n=n.substring(o+3,s>o+3?s:void 0).trim().replace(/\+\+\+?(\n)\+\+\+/,"+++");let a=n.split("+++").filter(d=>d.trim().length>0),c;if(a.length===1)c=a[0].split(`
`);else if(a.length>1){let d=a.slice(1).map(p=>p.split(`
`)).flat().filter(p=>p.trim().length>0);c=[a[0],...d]}else return;let u,l;if(c.length===1){if(u=c[0].trim(),r&&e.includes(`
`)&&e.split("+++").length===3)return this.parseFetchResult(e+"+++",!1)}else if(c.length>1){u=c[0].trim(),l="";let d=c.slice(1);for(let p of d)p.includes("commit message")||(l+=`${p.trim()}

`)}if(u)return u=u.replace(/Title\:\s/,"").trim(),u=u.replace(/^\"(?<title>.+)\"$/,(d,p)=>p),l&&(l=l.replace(/Description\:\s/,"").trim()),{title:u,description:l}}async createPRTitleAndDescriptionPrompt(e,r,n,o){let s=o-Math.floor(o*.2),a=r.join(`

`).length;if(a>s)for(r.sort((l,d)=>l.length-d.length);a>s&&r.length>0;){let l=r.pop();a-=l.length}let c=await this.accessor.get(Le).getChatEndpoint("gpt-3.5-turbo");return $e.create(this.accessor.get(te),c,y4,{commitMessages:e,issues:n,patches:r}).render(void 0,void 0)}};var x4=class{constructor(e){this.accessor=e}async provideReviewerComments(e,r){let n=await Yx(this.accessor,e,r),o=[];if(n?.type==="success")for(let a of n.comments)o.push(a.uri);let s=n?.type==="success";return{files:o,succeeded:s}}};var S4=class{constructor(e){this.accessor=e;this.disposables=new Tt;this.logger=e.get(ue).getLogger("githubTitleAndDescriptionProvider"),this.initializeGitHubPRExtensionApi()}dispose(){this.disposables.dispose()}getExtension(){return V1.extensions.getExtension("github.vscode-pull-request-github")}initializeGitHubPRExtensionApi(){let e=this.getExtension(),r=async()=>{if(e){let n=await e.activate();this.logger.info("Successfully activated the GitHub.vscode-pull-request-github extension."),this.gitHubExtensionApi=n,this.registerTitleAndDescriptionProvider(),this.registerReviewerCommentsProvider()}};if(e)r();else{this.logger.info("GitHub.vscode-pull-request-github extension is not yet activated.");let n=V1.extensions.onDidChange(()=>{e=this.getExtension(),e&&(r(),n.dispose())});this.disposables.add(n)}}async registerTitleAndDescriptionProvider(){if(this.gitHubExtensionApi)try{this.titleAndDescriptionProvider||(this.titleAndDescriptionProvider=this.disposables.add(new _4(this.accessor))),this.disposables.add(this.gitHubExtensionApi.registerTitleAndDescriptionProvider(V1.l10n.t("Generate with Copilot"),this.titleAndDescriptionProvider)),this.logger.info("Successfully registered GitHub PR title and description provider.")}catch{}}async registerReviewerCommentsProvider(){if(!this.gitHubExtensionApi)return;let e=this.accessor.get(ye);if(!(!e.getConfig(fe.ReviewContextMenu)&&!e.getConfig(fe.ReviewSCMViewlet)))try{this.reviewerCommentsProvider||(this.reviewerCommentsProvider=new x4(this.accessor)),this.disposables.add(this.gitHubExtensionApi.registerReviewerCommentsProvider(V1.l10n.t("Copilot"),this.reviewerCommentsProvider)),this.logger.info("Successfully registered GitHub PR reviewer comments provider.")}catch{}}};function I4(){return"https://aka.ms/microsoft/vscode-copilot-release"}var cy=z(require("path")),jce=require("util"),nt=require("vscode");var L8e=["dockerfile","license","makefile","readme","procfile","gemfile","rakefile","jenkinsfile","vagrantfile"];function Oce(t){return/\.[^/.]+$/.test(t)&&L8e.indexOf(t.toLowerCase())===-1}var Ef=z(Qt());var Uce=z(require("path"));var lu=ae("IGithubRepositoryService"),C4=ae("IOctoKitService"),Mce=1682102;var uR=z(Qt()),kd=z(at()),Fce=z(require("path"));var E4=ae("IProjectTemplatesIndex"),G1=class{constructor(e,r){this._isIndexLoaded=!1;let n=U0(e.getEditorInfo().version);this.embeddingsCache=r.createInstance(pc,1,"projectTemplateEmbeddings",n,"project-templates")}async updateIndex(){this._isIndexLoaded||(this._isIndexLoaded=!0,this._embeddings=await this.embeddingsCache.getCache())}async nClosestValues(e,r,n=0){if(await this.updateIndex(),!this._embeddings)return[];let o=Object.entries(this._embeddings).map(s=>{if(!s[1].embedding)return{key:`${s[0]}`,similarity:0};let a=ch(e,s[1].embedding);return{key:`${s[0]} `,similarity:a}});return o=o.filter(s=>s.similarity>n),o.sort((s,a)=>a.similarity-s.similarity),o.slice(0,r).map(s=>s.key)}};G1=O([x(0,Rt),x(1,te)],G1);function O8e(t){let e=t.split(`
`),r={};return e.forEach((n,o)=>{n.startsWith("# Intent")?r.intent=e[o+1]?.trim():n.startsWith("# Question")&&(r.question=e[o+1]?.trim())}),r}var z1=class extends Q{constructor(r,n,o,s,a,c,u){super(r);this.chatMLFetcher=n;this.instantiationService=o;this.embeddingsComputer=s;this.endPointProvider=a;this.projectTemplatesIndex=c;this.repositoryService=u}async prepare(r,n,o){if(!n)throw new Error("Progress is required");if(this.props.useTemplates){let u=await this.endPointProvider.getEmbeddingsEndpoint("ada"),l=await this.embeddingsComputer.computeEmbeddings(u,[this.props.promptContext.query],{},void 0);if(l){n.report(new ho(uR.t("Searching project template index...")));let d=await this.projectTemplatesIndex.nClosestValues(l[0],1,.8);if(d.length>0){let p=d[0]?.split(":"),f=p[0].trim(),m=p[1].trim(),h=p[2].trim()===""?".":p[2].trim();if(f&&m&&h){let g=await iR(n,new ho(uR.t("Fetching project contents...")),this.repositoryService.getRepositoryItems(f,m,h),500);if(g.length>0){let v;return h==="."?v=`httpx://github.com/${f}/${m}`:v=Fce.default.dirname(g[0].html_url),this._metadata=new ay(f,m,h,g),{url:v}}}}}}n?.report(new ho(uR.t("Determining user intent...")));let s=await this.endPointProvider.getChatEndpoint("gpt-3.5-turbo"),{messages:a}=await M8e(this.instantiationService,s,this.props.promptContext);if(o.isCancellationRequested)return{};let c=await this.chatMLFetcher.fetchOne(a,async u=>{},o,2,s,{agent:T4},{temperature:0,top_p:1,stop:["dontStopBelieving"]},{messageSource:"newIntent"});if(c.type==="success"){let u=O8e(c.value);return u.intent==="File"?{intent:u}:u.intent==="Project"?{intent:u}:{intent:{intent:"Project",question:this.props.promptContext.query}}}else throw new Error(uR.t("Encountered an error while determining user intent: ({0}) {1}",c.type,c.reason))}render(r){let{query:n,history:o,chatVariables:s,customInstructions:a}=this.props.promptContext;return vscpp(vscppf,null,vscpp(Lt,{priority:600,history:o.filter(c=>c.response?.name===T4&&c.request.type==="user")}),r.intent?.intent==="File"&&vscpp(vscppf,null,vscpp(kd.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant. Your job is to generate the contents of a new file based on the user's query.",vscpp("br",null),"If a code snippet or markdown is provided, consider it as part of the file content creation process.",vscpp("br",null),"The code should not contain bugs and should adhere to best practices.",vscpp("br",null),"Your response should be just two code blocks - the first one with the file contents and the second JSON code block with a file name.",vscpp("br",null),"Your response should not contain any other information or explanation.",vscpp("br",null),"# Response Template",vscpp("br",null),vscpp(Oe,{uri:null,code:`
    def greet(name):
      print(f"Hello, {name}!")
    greet("John Doe")
  `,languageId:"python"}),vscpp(Oe,{uri:null,code:`
    'fileName': 'suggestedFileName',
`,languageId:"json"}),vscpp("br",null),"Examples:",vscpp("br",null),"User: Generate the contents of the new file based on this query:",vscpp("br",null),"python hello world file",vscpp("br",null),"Assistant:",vscpp("br",null),vscpp(Oe,{uri:null,code:`
    def greet(name):
      print(f"Hello, {name}!")

    greet("John Doe")
  `,languageId:"python"}),vscpp(Oe,{uri:null,code:`
    {
    'fileName': 'sampleHelloWorld.py',
    }
`,languageId:"json"})),vscpp(Kr,{priority:900,chatVariables:s,query:r.intent.question})),r.intent?.intent==="Project"&&!this._metadata&&vscpp(vscppf,null,vscpp(kd.SystemMessage,{priority:1e3},"You are a VS Code assistant. Your job is to suggest a filetree directory structure for a project that a user wants to create.",vscpp("br",null),"If a step does not relate to filetree directory structures, do not respond. Please do not guess a response and instead just respond with a polite apology if you are unsure. ## Additional Rules ##",vscpp("br",null),'If the user does not specify "app" or "project" in their query, assume they are asking for a project.',vscpp("br",null),`You should always start your response to the user with "Sure, here's a proposed directory structure for a [project type] app:"`,vscpp("br",null),"You should generate a markdown file tree structure for the sample project and include it in your response if you are proposing a sample.",vscpp("br",null),"You should only list common files for the user's desired project type if you are proposing a sample.",vscpp("br",null),"You should always include a README.md file which describes the project if you are proposing a sample.",vscpp("br",null),"Do not include folders and files generated after compiling, building or running the project such as node_modules, dist, build, out.",vscpp("br",null),"Do not include image files such as png, jpg, ico, etc.",vscpp("br",null),"Do not include any descriptions or explanations in your response other than what is shown in the response templates.",vscpp("br",null),"If the user asks for a file content to be modified, respond with the same file tree structure and ask them to open the file to view the modifications.",vscpp("br",null),"Do not attempt to modify the file content your self and simply respond with the same file tree structure.",vscpp("br",null),vscpp(Hr,null),vscpp(yi,null),vscpp(Di,null),vscpp(cr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"## Response template ##",vscpp("br",null),"Sure, here's a proposed directory structure for a [project type] app:",vscpp("br",null),"\\`\\`\\`filetree",vscpp("br",null),"[project-name]",vscpp("br",null),"\u251C\u2500\u2500 src",vscpp("br",null),"\u2502   \u251C\u2500\u2500 app.ts",vscpp("br",null),"\u2502   \u2514\u2500\u2500 types",vscpp("br",null),"\u2502       \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u251C\u2500\u2500 package.json",vscpp("br",null),"\u251C\u2500\u2500 tsconfig.json",vscpp("br",null),"\u2514\u2500\u2500 README.md",vscpp("br",null),"\\`\\`\\`",vscpp("br",null),["","Examples for response templates above. Please follow these examples as closely as possible.","","## Valid setup question","","User: Create a TypeScript express app","Assistant:","","Sure, here's a proposed directory structure for a TypeScript Express app:","","```filetree","my-express-app","\u251C\u2500\u2500 src","\u2502   \u251C\u2500\u2500 app.ts","\u2502   \u251C\u2500\u2500 controllers","\u2502   \u2502   \u2514\u2500\u2500 index.ts","\u2502   \u251C\u2500\u2500 routes","\u2502   \u2502   \u2514\u2500\u2500 index.ts","\u2502   \u2514\u2500\u2500 types","\u2502       \u2514\u2500\u2500 index.ts","\u251C\u2500\u2500 package.json","\u251C\u2500\u2500 tsconfig.json","\u2514\u2500\u2500 README.md","```","","## Invalid setup question","","User: Create a horse project","Assistant: Sorry, I don't know how to set up a horse project."].join(`
`)),vscpp(kd.UserMessage,{priority:750},vscpp(Yr,{customInstructions:a})),vscpp(Kr,{priority:900,chatVariables:s,query:r.intent.question})),!r.intent&&this._metadata&&vscpp(vscppf,null,vscpp(kd.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant. The user has identified a project URL for a new project they want to create. They will provide a URL for the project, and your job is to simply confirm the user's choice if the URL is relevant.",vscpp("br",null),"If the URL is not relevant, you should ignore the URL and simply suggest a file tree directory structure for a project that the user wants to create. Do not attempt to clarify the URL to the user.",vscpp("br",null),"Please do not guess a response and instead just respond with a polite apology if you are unsure.",vscpp("br",null),vscpp(Hr,null),vscpp(yi,null),vscpp(Di,null),vscpp(cr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"## Response template when the user has provided a project URL but it is irrelevant. Notice how the response ignores the provided URL entirely and does not attempt to clarify this to the user. ##",vscpp("br",null),"Sure, here's a proposed directory structure for a [project type] app:",vscpp("br",null),"\\`\\`\\`filetree",vscpp("br",null),"[project-name]",vscpp("br",null),"\u251C\u2500\u2500 src",vscpp("br",null),"\u2502   \u251C\u2500\u2500 app.ts",vscpp("br",null),"\u2502   \u2514\u2500\u2500 types",vscpp("br",null),"\u2502       \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u251C\u2500\u2500 package.json",vscpp("br",null),"\u251C\u2500\u2500 tsconfig.json",vscpp("br",null),"\u2514\u2500\u2500 README.md",vscpp("br",null),"\\`\\`\\`",vscpp("br",null),["","Examples for response templates above. Please follow these examples as closely as possible.","","## Valid setup question with an irrelevant URL ##","","User: Create a TypeScript express app","URL: https://github.com/microsoft/vscode-extension-samples/tree/main/getting-started-sample","Assistant:","","Sure, here's a proposed directory structure for a TypeScript Express app:","","```filetree","my-express-app","\u251C\u2500\u2500 src","\u2502   \u251C\u2500\u2500 app.ts","\u2502   \u251C\u2500\u2500 controllers","\u2502   \u2502   \u2514\u2500\u2500 index.ts","\u2502   \u251C\u2500\u2500 routes","\u2502   \u2502   \u2514\u2500\u2500 index.ts","\u2502   \u2514\u2500\u2500 types","\u2502       \u2514\u2500\u2500 index.ts","\u251C\u2500\u2500 package.json","\u251C\u2500\u2500 tsconfig.json","\u2514\u2500\u2500 README.md","```","","## Invalid setup question ##","","User: Create a horse project","Assistant: Sorry, I don't know how to set up a horse project."].join(`
`),"## Response template when the user has provided a project URL that is relevant ##",vscpp("br",null),"# USING_URL ",vscpp("br",null),"Sure, here's a GitHub sample project to help you get started on [project type]: [Project Type Sample](url)",vscpp("br",null),["","Examples for response template with a relevant URL described above. Please follow this example as closely as possible.","","## Valid setup question with a relevant project URL. Notice how you should not propose a file directory structure in this case. ##","","User: Create a VSCode extension sample for contributing getting started walkthrough.","URL: https://github.com/microsoft/vscode-extension-samples/tree/main/getting-started-sample","Assistant:","","# USING_URL","Sure, here's a GitHub sample project to help you get started on creating a VSCode extension with a walkthrough contribution: [Walkthrough Sample](https://github.com/microsoft/vscode-extension-samples/tree/main/getting-started-sample)",""].join(`
`),vscpp("br",null),"## Additional Rules for Project Tree generation ##",vscpp("br",null),"You should only generate a file tree structure if the URL procvided by the user is not relevant.",vscpp("br",null),"You should generate a markdown file tree structure for the sample project and include it in your response if you are proposing a sample.",vscpp("br",null),"You should only list common files for the user's desired project type if you are proposing a sample.",vscpp("br",null),"You should always include a README.md file which describes the project if you are proposing a sample.",vscpp("br",null),"Do not include folders and files generated after compiling, building, or running the project such as node_modules, dist, build, out.",vscpp("br",null),"Do not include image files such as png, jpg, ico, etc.",vscpp("br",null),"Do not include any descriptions or explanations in your response other than what is shown in the response templates.",vscpp("br",null),"If the user asks for a file content to be modified, respond with the same file tree structure and ask them to open the file to view the modifications.",vscpp("br",null),"Do not attempt to modify the file content yourself and simply respond with the same file tree structure.",vscpp("br",null)),vscpp(kd.UserMessage,{priority:750},vscpp(Yr,{customInstructions:a})),vscpp(kd.UserMessage,{priority:900},r.url&&vscpp(vscppf,null,"Below is the URL you should consider for your response.",vscpp("br",null),"URL: ",r.url,vscpp("br",null))),vscpp(Kr,{priority:900,chatVariables:s,query:n}),this._metadata&&vscpp(vscppf,null,vscpp("meta",{value:this._metadata}))))}};z1=O([x(1,Bt),x(2,te),x(3,Fo),x(4,Le),x(5,E4),x(6,lu)],z1);var ay=class extends Wc{constructor(r,n,o,s){super();this.org=r;this.repo=n;this.path=o;this.githubRepoItems=s}};(e=>{function t(r){return r instanceof e}e.is=t})(ay||={});async function M8e(t,e,r){return $e.create(t,e,pj,{promptContext:r}).render()}var pj=class extends Q{render(e,r){let{query:n,history:o,chatVariables:s,customInstructions:a}=this.props.promptContext;return vscpp(vscppf,null,o&&vscpp(Lt,{priority:500,history:o}),vscpp(kd.SystemMessage,{priority:1e3},"You are a Visual Studio Code assistant focused on aiding users in crafting clear and specific specifications about project or file creation within Visual Studio Code. Your role involves:",vscpp("br",null),"- Helping users articulate their intent about creating projects for various platforms and programming languages.",vscpp("br",null),"- Assessing the user's intent to determine whether it pertains to project or file creation.",vscpp("br",null),"- Identifying the programming language the user is inquiring about, or inferring it based on the platform or project type mentioned.",vscpp("br",null),"- Rewriting the user's query to eliminate ambiguity and ensure clarity.",vscpp("br",null),"- Resolving any pronouns and vague terms to their specific referents.",vscpp("br",null),"- Responding with a rephrased question that accurately reflects the user's intent.",vscpp("br",null),`- Using the additional context to resolve ambiguities in the user's query, such as "it" or "that".`,vscpp("br",null),"- If the user does not specify an application logic or feature, you should assume that the user is new to programming and provide a basic project structure to help with a simple Hello World project.",vscpp("br",null),'- If the user does not specify "app," "project," or "file" in their query, assume they are asking for a project. - If it is not clear what the user is asking for or if the question appears to be unrelated to Visual Studio Code, do not try to rephrase the question and simply return the original question.',vscpp("br",null),"- DO NOT ask the user for additional information or clarification.",vscpp("br",null),"- DO NOT answer the user's question directly.",vscpp("br",null),vscpp("br",null),"Guidelines for rewriting questions:",vscpp("br",null),"- Understand the user's intent by carefully reading their question.",vscpp("br",null),"- Clarify pronouns ('it', 'that') by deducing their referents from the question or conversation context.",vscpp("br",null),"- Resolve ambiguous terms ('this') to their specific meanings based on the question or conversation context.",vscpp("br",null),"- Rephrase the question under a `# Question` header, ensuring all vague terms are clarified without altering the original intent.",vscpp("br",null),vscpp("br",null),"When responding:",vscpp("br",null),"- Use Markdown to format your response, starting with a `# Question` header followed by the rephrased question.",vscpp("br",null),"- If the user's intent is unclear or unrelated to Visual Studio Code, simply return the original question without modification.",vscpp("br",null),"- Avoid requesting additional information or directly answering the question.",vscpp("br",null),"- Use the template below to report the identified intent, rephrased question, and any application logic or feature that may be relevant.",vscpp("br",null),vscpp("br",null),"# Response Template",vscpp("br",null),"# Intent",vscpp("br",null),"Project or File",vscpp("br",null),"# Question",vscpp("br",null),"Rephrased question here.",vscpp("br",null),vscpp("br",null),"# Examples:",vscpp("br",null),"User: Python project.",vscpp("br",null),"Assistant:",vscpp("br",null),"# Intent",vscpp("br",null),"Project",vscpp("br",null),"# Question",vscpp("br",null),"Create a new Python sample project.",vscpp("br",null),vscpp("br",null),"User: Node.js server",vscpp("br",null),"Assistant:",vscpp("br",null),"# Intent",vscpp("br",null),"Project",vscpp("br",null),"# Question",vscpp("br",null),"Create a new Node.js development environment.",vscpp("br",null),vscpp("br",null),"User: TS web project",vscpp("br",null),"Assistant:",vscpp("br",null),"# Intent",vscpp("br",null),"Project",vscpp("br",null),"# Question",vscpp("br",null),'Create a new TypeScript project with a basic "Hello World" web application.',vscpp("br",null),vscpp("br",null),"User: VS Code extension custom sidebar",vscpp("br",null),"Assistant:",vscpp("br",null),"# Intent",vscpp("br",null),"Project",vscpp("br",null),"# Question",vscpp("br",null),"Create a Visual Studio Code extension sample that adds a custom sidebar.",vscpp("br",null),vscpp("br",null)),vscpp(kd.UserMessage,{flexGrow:1,priority:750},vscpp(Yr,{customInstructions:a})),vscpp(Kr,{flexGrow:2,priority:900,chatVariables:s,query:n}))}};var Pd=z(at());var w4=class extends Q{render(){return vscpp(vscppf,null,this.props.history&&vscpp(k4,{messages:this.props.history}),vscpp(Pd.SystemMessage,{priority:1e3},"You are a VS Code assistant. Your job is to generate the contents of a file in a project when given the user description, specification and tree structure of the project that a user wants to create. ",vscpp("br",null),vscpp(Hr,null),vscpp(yi,null),vscpp(cr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step and give me contents for just the file requested by the user. The code should not contain bugs.",vscpp("br",null),"If the user has asked for modifications to an existing file, please use the File path and File contents provided below if applicable.",vscpp("br",null),"If the file is supposed to be empty, please respond with a code comment saying that this file is intentionally left blank.",vscpp("br",null),"Do not include comments in json files.",vscpp("br",null),"Do not use code blocks or backticks.",vscpp("br",null),"Do not include product names such as Visual Studio in the comments.",vscpp("br",null)),this.props.relavantFiles&&this.props.relavantFiles.size>0&&vscpp(vscppf,null,vscpp(Pd.UserMessage,{priority:500},"Below, you will find a list of file paths and their contents previously used",vscpp("br",null),Array.from(this.props.relavantFiles).map(([e,r])=>`File path: ${e}
File contents: ${r}
`).join(`
`))),vscpp(Pd.UserMessage,{priority:900},"Generate the contents of the file: ",this.props.filePath," ",vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"\\`\\`\\`filetree' ",vscpp("br",null),this.props.fileTreeStr,vscpp("br",null),"\\`\\`\\`",vscpp("br",null),"The project should adhere to the following specification:",vscpp("br",null),this.props.projectSpecification,vscpp("br",null)))}},R4=class extends Q{render(){return vscpp(vscppf,null,this.props.history&&vscpp(k4,{messages:this.props.history}),vscpp(Pd.SystemMessage,{priority:1e3},"You are a VS Code assistant. Your job is to generate the project specification when given the user description and file tree structure of the project that a user wants to create. ",vscpp("br",null),vscpp(Hr,null),vscpp(yi,null),vscpp(cr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step and respond with a text description that lists and summarizes each file inside this project.",vscpp("br",null),"List the classes, types, interfaces, functions, and constants it exports and imports if it is a code file.",vscpp("br",null),"Consider filenames and file extensions when determining the programming languages used in the project. List any special configurations or settings required for configuration files such as package.json or tsconfig.json to help compile the project successfully",vscpp("br",null),"You should be as specific as possible when listing the public properties and methods for each exported class.",vscpp("br",null),"Do not use code blocks or backticks. Do not include any text before or after the file contents.",vscpp("br",null),"Do not include comments in json files.",vscpp("br",null),"Do not use code blocks or backticks.",vscpp("br",null),"Do not include product names such as Visual Studio in the comments.",vscpp("br",null),"Below you will find a set of examples of what you should respond with. Please follow these examples as closely as possible.",vscpp("br",null),vscpp("br",null),"## Valid question",vscpp("br",null),"User: I want to set up the following project: Create a TypeScript Express app",vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"\\`\\`\\`markdown ",vscpp("br",null),"my-express-app",vscpp("br",null),"\u251C\u2500\u2500 src",vscpp("br",null),"\u2502   \u251C\u2500\u2500 app.ts",vscpp("br",null),"\u2502   \u251C\u2500\u2500 controllers",vscpp("br",null),"\u2502   \u2502   \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u2502   \u251C\u2500\u2500 routes",vscpp("br",null),"\u2502   \u2502   \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u2502   \u2514\u2500\u2500 types",vscpp("br",null),"\u2502       \u2514\u2500\u2500 index.ts",vscpp("br",null),"\u251C\u2500\u2500 package.json",vscpp("br",null),"\u251C\u2500\u2500 tsconfig.json",vscpp("br",null),"\u2514\u2500\u2500 README.md",vscpp("br",null),"\\`\\`\\`",vscpp("br",null),"## Valid response",vscpp("br",null),"Assistant: The project has the following files:",vscpp("br",null),"\\`src/app.ts\\`: This file is the entry point of the application. It creates an instance of the express app and sets up middleware and routes.",vscpp("br",null),"\\`src/controllers/index.ts\\`: This file exports a class \\`IndexController\\` which has a method \\`getIndex\\` that handles the root route of the application.",vscpp("br",null),"\\`src/routes/index.ts\\`: This file exports a function \\`setRoutes\\` which sets up the routes for the application. It uses the \\`IndexController\\` to handle the root route.",vscpp("br",null),"\\`src/types/index.ts\\`: This file exports interfaces \\`Request\\` and \\`Response\\` which extend the interfaces from the \\`express\\` library.",vscpp("br",null),"\\`tsconfig.json\\`: This file is the configuration file for TypeScript. It specifies the compiler options and the files to include in the compilation.",vscpp("br",null),"\\`package.json\\`: This file is the configuration file for npm. It lists the dependencies and scripts for the project.",vscpp("br",null),"\\`README.md\\`: This file contains the documentation for the project.",vscpp("br",null)),vscpp(Pd.UserMessage,{priority:900},"I want to set up the following project: ",this.props.query,vscpp("br",null),"This is the project tree structure:",vscpp("br",null),"\\`\\`\\`markdown' ",vscpp("br",null),this.props.fileTreeStr,vscpp("br",null),"\\`\\`\\`",vscpp("br",null)))}},k4=class extends Q{render(e,r){let n=[];for(let o of this.props.messages)switch(o.role){case"user":n.push(vscpp(Pd.UserMessage,{priority:600},o.content));break;case"assistant":n.push(vscpp(Pd.AssistantMessage,{priority:800},o.content));break;default:break}return vscpp(vscppf,null,n)}};var P4=class{constructor(e,r){this.accessor=e;this.promptType=r;this.logger=e.get(ue).getPromptResponseLogger(this.constructor.name),this.options=e.get(Sn)}async generate(e,r){let n=await this.accessor.get(Le).getChatEndpoint("gpt-3.5-turbo"),s=await $e.create(this.accessor.get(te),n,this.promptType,e).render(),a=await this.accessor.get(Bt).fetchOne(s.messages,void 0,r,3,n,void 0,{temperature:this.options.temperature,top_p:this.options.topP},{messageSource:typeof this.promptType});return this.logger.logResponse(a),a.type==="success"?e.filePath?this.parseContents(e.filePath,a.value):a.value:""}},A4=class extends P4{constructor(e){super(e,R4)}parseContents(e,r){throw new Error("Method not implemented.")}},D4=class extends P4{constructor(e){super(e,w4)}parseContents(e,r){function n(o,s){try{let a=s.exec(o.trim());if(a&&a.length>2)return a[2]}catch(a){console.error(a)}return o}if(e.endsWith(".md")){let o=n(r,/^```([a-zA-Z]+)?\s*([\s\S]+?)\s*```$/),[s,...a]=o.split("#");return s.length?["",...a].join("#"):o}else return n(r,/```([^\n]+)?\s*\n([\s\S]+?)\s*```/g)}};var du=ae("INewWorkspacePreviewContentManager"),_j="github.copilot.createProject",xj="github.copilot.createFile",N4="github.copilot.openFile",$1=class{constructor(e){this.responseScopedData=new Map;this.prevFileContents=new Map;this.copilotContentManager=new fj(e),this.githubContentManager=new mj(e),this.fileContentManager=new hj(e)}set(e,r,n,o){this.responseScopedData.set(e,n),yj(n.baseUri)?this.githubContentManager.set(e,r,n,o):bj(n.baseUri)?this.fileContentManager.set(e,r,n,o):this.copilotContentManager.set(e,r,n,o)}get(e){this.prevResponseId!==e.authority&&(this.prevFileContents.clear(),this.prevResponseId=e.authority);let r;return yj(e)?r=this.githubContentManager.get(e.authority,e.path):bj(e)?r=this.fileContentManager.get(e.authority,e.path):r=this.copilotContentManager.get(e.authority,e.path),r?.content?.then(n=>{if(this.prevFileContents.has(e.path))return;let s=new TextDecoder().decode(n);this.prevFileContents.set(e.path,s)}),r}getFileTree(e){return this.responseScopedData.get(e)}getFileContentsFromPrevHistory(){return this.prevFileContents}};$1=O([x(0,je)],$1);var fj=class{constructor(e){this.accessor=e;this.promises=[];this.responseScopedData=new Map;this.generatePlanPrompt=new A4(this.accessor);this.generateFilePrompt=new D4(this.accessor)}set(e,r,n,o){let{userPrompt:s,projectStructure:a,chatMessages:c}=o,u={query:s,fileTreeStr:a,history:c},l=this.generatePlanPrompt.generate(u,an.None);this.promises.push(l);let d=this._getResponseScopedData(e),p={userPrompt:s,projectSpecification:l,projectStructure:a,fileTree:n,chatMessages:c};d.set(r,p)}get(e,r){let{projectName:n,path:o}=this._getProjectMetadata(r),a=this._getResponseScopedData(e).get(n);if(!a)return;let c=a.fileTree.value,u=Sj(c,o);if(u&&!u?.content){let l=u;l.content=this._getFileContent(a.userPrompt,a.projectStructure,a.projectSpecification,r,a.chatMessages).catch(()=>l.content=void 0)}return u}_prefetch(e,r,n,o,s){let a=Date.now();return o.children?{...o,type:2,children:o.children.map(c=>this._prefetch(e,r,n,c,s)),ctime:a}:{...o,type:1,content:void 0,ctime:a}}async _getFileContent(e,r,n,o,s){let a=this.accessor.get(du).getFileContentsFromPrevHistory(),c={query:e,fileTreeStr:r,filePath:o,projectSpecification:await n,history:s,relavantFiles:a.has(o)?new Map([[o,a.get(o)]]):void 0};return this.generateFilePrompt.generate(c,an.None).then(u=>Buffer.from(u))}_getResponseScopedData(e){let r=this.responseScopedData.get(e);return r||(r=new Map,this.responseScopedData.set(e,r)),r}_getProjectMetadata(e){let[,r,...n]=e.split("/");return{projectName:r,path:n}}},mj=class{constructor(e){this.responseScopedData=new Map;this.repositoryService=e.get(lu)}set(e,r,n,o){let s=o,a=this._getResponseScopedData(e),c={...s,fileTree:n};a.set(r,c)}get(e,r){let{projectName:n,path:o}=this._getProjectMetadata(r),a=this._getResponseScopedData(e).get(n);if(!a)return;let c=a.fileTree.value,u=Sj(c,o);if(u&&!u?.content&&!u?.children){let l=u,d=a.path==="."?Uce.relative(a.repo,r):r.slice(1);l.content=this.repositoryService.getRepositoryItemContent(a.org,a.repo,d).catch(()=>l.content=void 0)}return u}_getProjectMetadata(e){let[,r,...n]=e.split("/");return{projectName:r,path:n}}_getResponseScopedData(e){let r=this.responseScopedData.get(e);return r||(r=new Map,this.responseScopedData.set(e,r)),r}},hj=class{constructor(e){this.responseScopedData=new Map}set(e,r,n,o){let s=o,a=this._getResponseScopedData(e),c={content:s,fileTree:n};a.set(r,c)}get(e,r){let{projectName:n,path:o}=this._getFileMetadata(r),a=this._getResponseScopedData(e).get(n);if(!a)return;let c=a.fileTree.value,u=Sj(c,o);return u&&!u?.content&&!u?.children&&(u.content=Promise.resolve(new Uint8Array(new TextEncoder().encode(a.content)))),u}_getFileMetadata(e){let[,r,...n]=e.split("/");return{projectName:r,path:n}}_getResponseScopedData(e){let r=this.responseScopedData.get(e);return r||(r=new Map,this.responseScopedData.set(e,r)),r}};function Sj(t,e){let r;for(let n of e)r?r.children&&(r=r.children.find(o=>o.name===n)??r):r=t.find(o=>o.name===n);return r}var T4="new",W1=class{constructor(e){this.accessor=e;this.id="new";this.locations=[2];this.description=Ef.t("Scaffold code for a new file or project in a workspace");this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:!0}}static{this.ID="new"}get intentDetectionInput(){let e="create_new_workspace";return{functionName:e,sampleQuestion:"Create a RESTful API server using typescript",modelDescription:"Scaffolds a new file or project from scratch based on requirements from the user.",functionCallingBlurb:`If the user's message is related to generating files, folders, projects, workspaces, or VS Code extensions, you should use the '${e}' function.`}}async invoke(e){let r=e.location,n=this.accessor.get(Le),o=await Mn(n,r);return new gj(this.accessor,this,o,r)}};W1=O([x(0,je)],W1);function Bce(t,e){return{command:_j,arguments:[t,e],title:Ef.t("Create Workspace...")}}function F8e(t){return{command:xj,arguments:[t],title:Ef.t("Create File...")}}var gj=class{constructor(e,r,n,o){this.accessor=e;this.intent=r;this.endpoint=n;this.location=o;this.linkification={disable:!0}}async getShouldUseProjectTemplate(e){let r=e.get(ye).getConfig(fe.UseProjectTemplates);return r!==void 0?r:await e.get(Ut).getTreatmentVariableAsync("vscode","copilotchat.useProjectTemplates",!0)?!(await e.get(Nt).getCopilotToken()).isPublicSuggestionsEnabled():!1}async buildPrompt(e,r,n){let{query:o,history:s,chatVariables:a}=e,c=!a.hasVariables()&&s[s.length-1]?.request?.message!==o&&await this.getShouldUseProjectTemplate(this.accessor),u=$e.create(this.accessor.get(te),this.endpoint,z1,{promptContext:e,useTemplates:c}),l=await u.render(r,n),d=u.getMeta(ay);return d&&(this.githubContentMetadata=d),l}processResponsePanel(e,r,n,o,s){return new vj(this.accessor,this.githubContentMetadata).processResponse(e,r,n,o,s)}async commands(e){let r=this.accessor.get(ue).getPromptResponseLogger("new");if(!e.response?.message||!e.requestId)return[];let n=this.accessor.get(du).getFileTree(e.requestId);if(!n)return r.info("[workspaceIntent] Failed to fetch project items."),[];if(yj(n.baseUri))return[];if(bj(n.baseUri))return[F8e(n)];let o=this.accessor.get(Je).getWorkspaceFolders();return[Bce(n,o.length>0?o[0]:void 0)]}};function U8e(t){let e=(t.match(/│   /g)||[]).length;return e+=(t.match(/\|   /g)||[]).length,e+=(t.match(/    /g)||[]).length,e+=(t.match(/├── /g)||[]).length,e+=(t.match(/└── /g)||[]).length,e}var B8e=["node_modules","out","bin","debug","obj","lib",".dll",".pdb",".lib",".jpg",".png",".ico",".gif",".svg",".jpeg",".tiff",".bmp",".webp",".jpeg",".gitignore","LICENSE.txt","yarn.lock","package-lock.json"];function qce(t){let e=[];for(let r of t)q8e(r)||(r.children&&(r.children=qce(r.children)),e.push(r));return e}function q8e(t){return!!B8e.includes(t.name)}function H8e(t,e){let r=e.trim().split(`
`),n=[],o,s={name:"",children:[]};n[0]=s;for(let c of r){let u=U8e(c),l=c.lastIndexOf("\u2500\u2500 "),d=l>=0?c.substring(l+3):c,p={name:d};if(u===0){o=Hce(t,d),s.name=d;continue}else{for(;u>0&&n[u-1]===void 0;)u--;n[u-1].children===void 0?n[u-1].children=[p]:n[u-1].children?.push(p),n[u]=p}}if(o===void 0)throw new Error("Base URI is undefined");let a=qce(s.children);return s.children=a.sort((c,u)=>c.children&&!u.children?-1:1),{chatResponseTree:new sh([s],o),projectName:s.name}}function j8e(t,e,r){let n;r?n=t.map(l=>[e.path,l.path].join("/")):n=t.map(l=>l.path);let o=n[0].split("/")[0],s={name:o,children:[]},a={rootName:s};for(let l of n){let d=l.split("/"),p=o,f=s;for(let m=1;m<d.length;m++){let h=d[m];if(p+=`/${h}`,!a[p]){let g={name:h};f.children===void 0&&(f.children=[]),f.children.push(g),a[p]=g}f=a[p]}}let c;r?c=s.children?.[0].children??[]:c=s.children??[];let u=c?.sort((l,d)=>l.children&&!d.children?-1:1)??[];return new sh(u,e)}var Ij="vscode-copilot-workspace",L4="vscode-copilot-github-workspace",K1="vscode-copilot-file";function Hce(t,e,r=!1){return Ur.from({scheme:r?L4:Ij,authority:t??"",path:e?`/${e}`:void 0})}var vj=class{constructor(e,r){this.accessor=e;this.githubContentMetadata=r;this._appliedText="";this._p=Promise.resolve("")}async processResponse(e,r,n,o,s){let a=!1,c="",u=/```filetree\n/,l=r.filter(p=>p.role!=="system"),d=!1;for await(let{delta:p}of n){if(s.isCancellationRequested)break;let f=p.text;this._p=this._p.then(async()=>{let m=e.requestId??"";if(e.response||(e.response={message:this._appliedText,type:"model"}),!f)return this._appliedText;if(e.response.message+=f,this._appliedText+=f,this._appliedText.startsWith("#"))/(?:.*\n){1,}/.test(this._appliedText)&&o.markdown(f);else{let h=e.request.message,g=this._appliedText.match(/```filetree\n([\s\S]+?)\n```/);if(g&&(a||!d)){a=!1;let[v,y]=this._appliedText.split(g[0]);d||o.markdown(v),c=g[1];let{chatResponseTree:b,projectName:_}=H8e(m,c);o.progress(Ef.t("Generating workspace preview...")),o.push(b),o.markdown(y),this.accessor.get(du).set(m,_,b,{userPrompt:h,projectStructure:c,chatMessages:l})}else if(this._appliedText.match(u)&&!a&&!g){a=!0;let[v,y]=this._appliedText.split(u);c+=y,o.progress(Ef.t("Generating workspace preview..."))}else a?c+=f:!a&&!this._appliedText.match(/```/)&&(d=!0,o.markdown(f))}return this._appliedText})}if(await this._p,e.requestId&&this.githubContentMetadata&&this.githubContentMetadata.org&&this.githubContentMetadata.repo&&this.githubContentMetadata.path&&this.githubContentMetadata.githubRepoItems&&!this.accessor.get(du).getFileTree(e.requestId)){o.reference(Ur.parse(this.githubContentMetadata.githubRepoItems[0].html_url)),o.progress(Ef.t("Generating workspace preview..."));let p=this.githubContentMetadata.path===".",f=p?this.githubContentMetadata.repo:this.githubContentMetadata.path.split("/")[0],m=j8e(this.githubContentMetadata.githubRepoItems,Hce(e.requestId,f,!0),p);o.push(m);let h=this.accessor.get(Je).getWorkspaceFolders();o.button(Bce(m,h.length>0?h[0]:void 0)),this.accessor.get(du).set(e.requestId,f,m,this.githubContentMetadata);let g=encodeURIComponent(`["@workspace /${T4} ${e.request.message}"]`),v=new mo(Ef.t("Hint: You can [regenerate this project without using this sample](command:workbench.action.chat.open?{0}) or use this [setting](command:workbench.action.openSettings?%5B%22github.copilot.chat.useProjectTemplates%22%5D) to configure the behavior.",g));v.isTrusted={enabledCommands:["workbench.action.openSettings","workbench.action.chat.open"]},o.markdown(v)}else{if(!e.requestId)throw new Error("Request ID is undefined");let p=Cs(this._appliedText);if(p.length===2){let f;try{f=Yh(p[1].code)}catch(y){throw y}let m=Ur.from({scheme:K1,authority:e.requestId,path:`/${f.fileName}`}),h=new sh([{name:`${f.fileName}`}],m),g=Td(N4,[h]),v=new mo(`[${f.fileName}](${g})`);v.isTrusted={enabledCommands:[N4]},o.markdown(Ef.t("Sure, here is the file you requested:")),o.markdown(v),this.accessor.get(du).set(e.requestId,f.fileName,h,p[0].code)}}return this._appliedText}};function yj(t){return t.scheme===L4}function bj(t){return t.scheme===K1}var ks=require("vscode"),lR=class{constructor(e){this.contentManager=e;this._onDidChangeFile=new ks.EventEmitter;this.onDidChangeFile=this._onDidChangeFile.event}async stat(e){let r=this.contentManager.get(e);if(!r)throw ks.FileSystemError.FileNotFound(e);let n=await r.content?.then(o=>o?.length)??0;return{ctime:r.ctime??0,mtime:r.ctime??0,size:n,type:r.children?ks.FileType.Directory:ks.FileType.File}}readDirectory(e){let r=this.contentManager.get(e);if(!r)throw ks.FileSystemError.FileNotFound(e);return r.children?.map(n=>[n.name,n.children?ks.FileType.Directory:ks.FileType.File])??[]}async readFile(e){let r=this.contentManager.get(e);if(!r)throw ks.FileSystemError.FileNotFound(e);let n;try{n=await r.content}catch{}return n??new Uint8Array}watch(e,r){return{dispose(){}}}createDirectory(e){throw ks.FileSystemError.NoPermissions(e)}writeFile(e,r,n){throw ks.FileSystemError.NoPermissions(e)}delete(e,r){throw ks.FileSystemError.NoPermissions(e)}rename(e,r,n){throw ks.FileSystemError.NoPermissions(r)}copy(e,r,n){throw ks.FileSystemError.NoPermissions(r)}};var M4=require("vscode");var O4=class extends Ct{constructor(r){super();this.contentManager=r;this.onDidChangeEmitter=new M4.EventEmitter;this.onDidChange=this.onDidChangeEmitter.event;this._register(M4.workspace.onDidChangeTextDocument(n=>{n.document.uri.scheme===K1&&this.onDidChangeEmitter.fire(n.document.uri)}))}async provideTextDocumentContent(r,n){let o=this.contentManager.get(r);if(!o)return"";let s;try{s=await o.content}catch{}return new TextDecoder().decode(s)??""}};function Vce(t,e){return nt.Disposable.from(nt.workspace.registerFileSystemProvider(Ij,new lR(t.get(du)),{isReadonly:new nt.MarkdownString(nt.l10n.t(`This file preview was generated by Copilot and may contain surprises or mistakes.

Ask followup questions to refine it, then press Create Workspace.`))}),nt.workspace.registerFileSystemProvider(L4,new lR(t.get(du)),{isReadonly:!0}),nt.workspace.registerTextDocumentContentProvider(K1,new O4(t.get(du))),nt.commands.registerCommand(_j,async(r,n)=>{let o=(await nt.window.showOpenDialog({defaultUri:n,title:cy.basename(r.baseUri.path),canSelectFolders:!0,canSelectFiles:!1,canSelectMany:!1,openLabel:"Select as Parent Folder"}))?.[0];o&&await V8e(t.get(ue),n,o,r)}),nt.commands.registerCommand(N4,async r=>{let n=nt.Uri.joinPath(r.baseUri,r.value[0].name).toString(),o=await nt.workspace.openTextDocument(nt.Uri.parse(n));await nt.window.showTextDocument(o,{preview:!1})}),nt.commands.registerCommand(xj,async r=>{let n={defaultUri:nt.Uri.file(cy.join(nt.workspace.workspaceFolders?.[0].uri.path??"",r.value[0].name)),saveLabel:nt.l10n.t("Save File")},o=await nt.window.showSaveDialog(n);if(o){let s=nt.Uri.joinPath(r.baseUri,r.value[0].name).toString(),a=await nt.workspace.openTextDocument(nt.Uri.parse(s));await nt.workspace.fs.writeFile(o,Buffer.from(a.getText()))}}))}async function V8e(t,e,r,n){let o=n.baseUri.path,s=await G8e(r,o),a=[];nt.window.tabGroups.all.forEach(u=>{u.tabs.forEach(l=>{l.input instanceof nt.TabInputText&&l.input.uri.scheme==="vscode-copilot-workspace"&&a.push(l)})}),nt.window.tabGroups.close(a,!0);let c=nt.Uri.joinPath(r,s);try{if(await nt.window.withProgress({location:nt.ProgressLocation.Notification,cancellable:!0},async(m,h)=>{await nt.workspace.fs.createDirectory(c);let g=cy.basename(o);async function v(y,b,_){let S=y?y.slice(g.length+1):"..",I=nt.Uri.joinPath(c,S,b.name);if(b.children?.length||!Oce(b.name)){y!==""&&(m.report({message:nt.l10n.t("Creating folder {0}...",I.fsPath)}),await nt.workspace.fs.createDirectory(I));for(let T of b.children??[])await v(cy.posix.join(y,b.name),T,_)}else{m.report({message:nt.l10n.t("Creating file {0}...",I.fsPath)});let T=await nt.workspace.fs.readFile(nt.Uri.joinPath(_,y,b.name));await nt.workspace.fs.writeFile(I,Buffer.from(T))}}for(let y of n.value)await v("",y,n.baseUri);await $8e(c)}),e&&c.fsPath.startsWith(e.fsPath))return;let u=nt.l10n.t("Would you like to open the created workspace?"),l=nt.l10n.t("Open"),d=nt.l10n.t("Open in New Window"),p=[l,d],f=await nt.window.showInformationMessage(u,{modal:!0},...p);f===l?(nt.interactive.transferActiveChat(c),t.getLogger("newIntent").info("Opening folder: "+c.fsPath),nt.commands.executeCommand("vscode.openFolder",c)):f===d&&nt.commands.executeCommand("vscode.openFolder",c,!0)}catch(u){let l=`Failed to create workspace: ${s}`;t.getLogger("newIntent").error(`${l}
${u.message}`),nt.window.showErrorMessage(l),await nt.workspace.fs.delete(c,{recursive:!0})}}async function G8e(t,e){let r=0,n=!0,o=e;for(;n;)try{await nt.workspace.fs.stat(nt.Uri.joinPath(t,o)),o=e+"-"+ ++r}catch{n=!1}return o}async function z8e(t){try{return await nt.workspace.fs.stat(t),!0}catch{return!1}}async function $8e(t){let e=W8e();if(e)if(await z8e(e)){let r=await nt.workspace.fs.readFile(e).then(o=>new jce.TextDecoder().decode(o)),n=JSON.parse(r);n.push(t.toString()),await nt.workspace.fs.writeFile(e,Buffer.from(JSON.stringify(n,null,2)))}else await nt.workspace.fs.writeFile(e,Buffer.from(JSON.stringify([t.toString()],null,2)))}function W8e(){let t=nt.env.appName.indexOf("Insider")>0||nt.env.appName.indexOf("Code - OSS Dev")>=0?"Code - Insiders":"Code",e=nt.Uri.file(process.env.HOME||(process.env.USERPROFILE?process.env.USERPROFILE:""));switch(process.platform){case"darwin":return nt.Uri.joinPath(e,"Library","Application Support",t,"User","workspaceStorage","aiGeneratedWorkspaces.json");case"linux":return nt.Uri.joinPath(e,".config",t,"User","workspaceStorage","aiGeneratedWorkspaces.json");case"win32":return process.env.APPDATA?nt.Uri.joinPath(nt.Uri.file(process.env.APPDATA),t,"User","workspaceStorage","aiGeneratedWorkspaces.json"):void 0;default:return}}var Y1=ae("IDebugOutputService");async function F4(t,e){let r=t.get(kt),n=t.get(bo),o=t.get(Ai),s=t.get(Je),a=t.get(eo),c=t.get(Y1),u=t.get(go),l=s.getWorkspaceFolders().map(y=>y.fsPath+"/"),d=s.notebookDocuments.map(y=>y.uri.fsPath),f=(await Promise.all(e.map(y=>o.getWorkspaceSymbols(y)))).flat().map(y=>({name:y.name,kind:y.kind,containerName:y.containerName,filePath:y.location.uri.fsPath,start:y.location.range.start,end:y.location.range.end})),m=r.activeTextEditor?n.getDiagnostics(r.activeTextEditor.document.uri).map(y=>({start:y.range.start,end:y.range.end,message:y.message,severity:y.severity,relatedInformation:y.relatedInformation?.map(K8e)})):[],h=r.activeTextEditor?{selections:r.activeTextEditor?.selections.map(y=>({anchor:y.anchor,active:y.active,isReversed:y.isReversed}))??[],documentFilePath:r.activeTextEditor?.document.uri.fsPath??"",visibleRanges:r.activeTextEditor?.visibleRanges.map(y=>({start:y.start,end:y.end}))??[],languageId:r.activeTextEditor?.document.languageId??"javascript"}:void 0,g=a.terminalLastCommand?{commandLine:a.terminalLastCommand.commandLine,cwd:typeof a.terminalLastCommand.cwd=="object"?a.terminalLastCommand.cwd.toString():a.terminalLastCommand.cwd,exitCode:a.terminalLastCommand.exitCode,output:a.terminalLastCommand.output}:void 0;return{workspaceFoldersFilePaths:l,symbols:f,activeFileDiagnostics:m,activeTextEditor:h,debugConsoleOutput:c.consoleOutput,terminalBuffer:a.terminalBuffer,terminalLastCommand:g,terminalSelection:a.terminalSelection,terminalShellType:a.terminalShellType,repoContexts:u.repositories,notebookDocumentFilePaths:d,activeNotebookEditor:void 0}}function K8e(t){return{filePath:t.location.uri.fsPath,start:t.location.range.start,end:t.location.range.end,message:t.message}}var U4=ae("IConversationFeature"),Q1=class{constructor(e,r,n,o,s,a,c,u,l,d,p,f){this.accessor=e;this.instantionService=r;this.configurationService=o;this.conversationOptions=s;this.chatAgentService=a;this.telemetryService=c;this.authenticationService=u;this.embeddingIndex=l;this.devContainerConfigurationService=d;this.gitCommitMessageService=p;this.linkifyService=f;this._disposables=new Tt;this._activatedDisposables=new Tt;this.logger=n.getLogger("chat"),this._enabled=!1,this._activated=!1,this.registerCopilotTokenListener(),this._disposables.add(u.onDidAuthenticationChange(async()=>{let m=u.copilotToken;this.logger.debug("onDidChangeSessionsHandler",m),m?this.activated=!0:this.activated=!1}))}get enabled(){return this._enabled}set enabled(e){e&&!this.activated&&(this.activated=!0),this._enabled=e,Fe.commands.executeCommand("setContext","github.copilot.interactiveSession.disabled",!e)}get activated(){return this._activated}set activated(e){if(this._activated!==e)if(this._activated=e,!e)this._activatedDisposables.clear();else{let r=this.conversationOptions;this._activatedDisposables.add(this.registerProviders()),this._activatedDisposables.add(this.registerCommands(r)),this._activatedDisposables.add(this.registerRelatedInformationProviders()),this._activatedDisposables.add(this.registerParticipants(r))}}dispose(){this._activated=!1,this._activatedDisposables.dispose(),this._disposables?.dispose()}[Symbol.dispose](){this.dispose()}registerParticipants(e){return this.chatAgentService.register(e)}registerProviders(){let e=new Tt;try{"registerMappedEditsProvider"in Fe.chat&&e.add(Fe.chat.registerMappedEditsProvider("*",this.instantionService.createInstance(j1))),"registerNewSymbolNamesProvider"in Fe.languages&&e.add(Fe.languages.registerNewSymbolNamesProvider({language:"*"},this.instantionService.createInstance(_l))),e.add(Fe.workspace.registerAITextSearchProvider("file",this.instantionService.createInstance(U1)))}catch(r){this.logger.error("Registration of interactive providers failed:",r.toString())}return e}registerCommands(e){let r=new Tt;return[Fe.commands.registerCommand("github.copilot.interactiveSession.feedback",async()=>Fe.env.openExternal(Fe.Uri.parse(I4()))),Fe.commands.registerCommand("github.copilot.debug.workbenchState",async()=>{let n=await Fe.window.showInputBox({prompt:"Enter a comma-separated list of symbol queries. Can be left blank if not using WorkspaceSymbols"}),o=await Fe.window.showInputBox({prompt:"Enter a file name - .state.json will be appended as the extension",value:"workspaceState"});if(!o)return;let s=await F4(this.accessor,n?.split(",")??[]),a=Fe.workspace.workspaceFolders?.[0].uri;if(!a)return;let c=Fe.Uri.joinPath(a,`${o}.state.json`),u=JSON.stringify(s,null,2);u=u.replace(new RegExp(`${a.fsPath}/`,"g"),"./"),Fe.workspace.fs.writeFile(c,Buffer.from(u))}),Fe.commands.registerCommand("github.copilot.terminal.explainTerminalSelection",async()=>this.triggerTerminalChat({query:`/${bl.intentName} #terminalSelection`})),Fe.commands.registerCommand("github.copilot.terminal.explainTerminalSelectionContextMenu",()=>Fe.commands.executeCommand("github.copilot.terminal.explainTerminalSelection")),Fe.commands.registerCommand("github.copilot.terminal.explainTerminalLastCommand",async()=>this.triggerTerminalChat({query:`/${bl.intentName} #terminalLastCommand`})),Fe.commands.registerCommand("github.copilot.terminal.generateCommitMessage",async()=>{let n=Fe.workspace.workspaceFolders;if(!n?.length)return;let o=n.length===1?n[0].uri:await Fe.window.showWorkspaceFolderPick().then(c=>c?.uri);if(!o)return;let s=this.gitCommitMessageService.getRepository(o);if(!s)return;let a=await this.gitCommitMessageService.generateCommitMessage(s,an.None);if(a){let u=`git commit -m "${a.replace(/"/g,'\\"').replace(/\\/g,"\\\\").replace(/\$/g,"\\$")}"`;Fe.window.activeTerminal?.sendText(u,!1)}}),Fe.commands.registerCommand("github.copilot.git.generateCommitMessage",async(n,o,s)=>{let a=this.gitCommitMessageService.getRepository(n);if(!a)return;let c=await this.gitCommitMessageService.generateCommitMessage(a,s);c&&(a.inputBox.value=c)}),Fe.commands.registerCommand("github.copilot.devcontainer.generateDevContainerConfig",async(n,o=new Fe.CancellationTokenSource().token)=>this.devContainerConfigurationService.generateConfiguration(n,o)),jae(this.accessor),uce(this.telemetryService),this.linkifyService.registerGlobalLinkifier({create:()=>this.instantionService.createInstance(k1)}),nce(this.accessor),Cce(this.accessor),this.registerTerminalQuickFixProviders(),Y8e(this.accessor,e),Vce(this.accessor,e),J8e(this.accessor),Xie(this.accessor),ace(this.accessor),Q8e(),X8e()].forEach(n=>r.add(n)),r}async triggerTerminalChat(e){let r=this.configurationService.getConfig(fe.TerminalChatLocation),n;switch(r){case"quickChat":n="workbench.action.quickchat.toggle",e.query=`@${F0} `+e.query;break;case"terminal":n="workbench.action.terminal.chat.start";break;case"chatView":default:n="workbench.action.chat.open",e.query=`@${F0} `+e.query;break}await Fe.commands.executeCommand(n,e)}registerRelatedInformationProviders(){let e=new Tt;return[Fe.ai.registerRelatedInformationProvider(Fe.RelatedInformationType.CommandInformation,this.embeddingIndex.commandIdIndex),Fe.ai.registerRelatedInformationProvider(Fe.RelatedInformationType.SettingInformation,this.embeddingIndex.settingsIndex)].forEach(r=>e.add(r)),e}registerCopilotTokenListener(){this._disposables.add(this.authenticationService.onDidAuthenticationChange(()=>{let e=this.authenticationService.copilotToken?.isChatEnabled();this.logger.info(`copilot token chat_enabled: ${e}`),this.enabled=e??!1}))}registerTerminalQuickFixProviders(){let e=new Tt;return e.add(Fe.window.registerTerminalQuickFixProvider("copilot-chat.fixWithCopilot",{provideTerminalQuickFixes:(r,n)=>this.enabled?[{command:"github.copilot.terminal.explainTerminalLastCommand",title:Fe.l10n.t("Explain using Copilot")}]:[]})),e.add(Fe.window.registerTerminalQuickFixProvider("copilot-chat.generateCommitMessage",{provideTerminalQuickFixes:(r,n)=>this.enabled?[{command:"github.copilot.terminal.generateCommitMessage",title:Fe.l10n.t("Generate Commit Message")}]:[]})),e}};Q1=O([x(0,je),x(1,te),x(2,ue),x(3,ye),x(4,Sn),x(5,WD),x(6,me),x(7,Nt),x(8,ul),x(9,KD),x(10,XD),x(11,I1)],Q1);function Y8e(t,e){let r=t.get(ye);return Fe.commands.registerCommand("github.copilot.newNotebook",async n=>{let o=r.getConfig(fe.NotebookIterativeImproving);await Fe.window.withProgress({location:Fe.ProgressLocation.Notification},async s=>{let a=new Fe.NotebookData([]);a.metadata={custom:{cells:[],metadata:{orig_nbformat:4},nbformat:4,nbformat_minor:2}};let c=await Fe.workspace.openNotebookDocument("jupyter-notebook",a),u=await Fe.window.showNotebookDocument(c);s.report({message:Fe.l10n.t("Generating notebook...")});let l=n.outline.description,d=n.outline.sections,p=await t.get(Le).getChatEndpoint("gpt-4");for(let f of d){let m=u.notebook.getCells().filter(I=>I.kind===Fe.NotebookCellKind.Code).map(I=>I.document.getText()).join(`
`),h=new Fe.CancellationTokenSource;s.report({message:Fe.l10n.t('Generating section "{0}"...',f.title)});let g=await ice(t,p,e,n.turn,l,f,m,h.token);if(!g)return;g=g.trim();let v=/```([a-zA-Z]+)?\s*([\s\S]+?)\s*```$/.exec(g);if(v&&v.length>2&&(g=v[2]),o){s.report({message:Fe.l10n.t('Improving code for section "{0}"...',f.title)});let I=await oce(t,p,e,l,f,m,g,h.token);if(!I)return;g=I}let y=new Fe.NotebookCellData(Fe.NotebookCellKind.Markup,`# ${f.title}
${f.content}`,"markdown"),b=new Fe.NotebookCellData(Fe.NotebookCellKind.Code,g,"python"),_=Fe.NotebookEdit.insertCells(c.cellCount,[y,b]),S=new Fe.WorkspaceEdit;S.set(c.uri,[_]),await Fe.workspace.applyEdit(S),u.revealRange(new Fe.NotebookRange(c.cellCount-1,c.cellCount),Fe.NotebookEditorRevealType.Default),u.selection=new Fe.NotebookRange(c.cellCount-1,c.cellCount)}s.report({increment:100})})})}function Q8e(){return Fe.commands.registerCommand("github.copilot.executeSearch",async t=>{let e=t.filesToExclude.length>0||t.filesToInclude.length>0;Fe.commands.executeCommand("workbench.view.search.focus").then(()=>Fe.commands.executeCommand("workbench.action.search.toggleQueryDetails",{show:e})),Fe.commands.executeCommand("workbench.action.findInFiles",t)})}function X8e(){return Fe.commands.registerCommand("github.copilot.ghpr.applySuggestion",async(t,e)=>{let r=s=>!!(s&&"body"in s&&(s.body instanceof Fe.MarkdownString||typeof s.body=="string")),n=s=>"range"in s&&s.range instanceof Fe.Range;if(!r(t)||!n(e))return;let o=t.body instanceof Fe.MarkdownString?t.body.value:t.body;await Fe.commands.executeCommand("vscode.editorChat.start",{initialRange:e.range,message:o,autoSend:!0})})}function J8e(t){return new S4(t)}var yue=z(Qt());var X1=class{constructor(e,r,n,o,s,a,c){this.intent=e;this.location=r;this.endpoint=n;this.prompt=o;this.documentContext=s;this.features=a;this.instantiationService=c;this.replyInterpreter=null;this.followUps=void 0}async buildPrompt(e,r,n){let o=$e.create(this.instantiationService,this.endpoint,this.prompt,{documentContext:this.documentContext,promptContext:e,features:this.features}),s=await o.render(r,n);return this.replyInterpreter=o.getMeta(Fn)?.replyInterpreter??null,this.followUps=o.getMeta(Ix)?.followUps,s}processResponseInline(e,r,n){if(!this.replyInterpreter)throw new Error("Could not process response without a reply interpreter.");return this.replyInterpreter.processResponse(e,r,n)}};X1=O([x(6,te)],X1);var Tf=z(at());function Gce(t,e,r,n){let o=t.modelMaxPromptTokens*4/3,s=new vd(o),a=e.document,c=e.language,u=new Es(s,a,c,"ed8c6549bwf9"),l=new Es(s,a,c,"abpxx6d04wxr"),d=new Es(s,a,c,"be15d9bcejpp"),p=()=>(l.trim(),u.trim(),d.trim(),{contextInfo:{language:c,above:l,range:u,below:d},tracker:s});if(!Z8e(u,r,n))return p();let m={aboveLineIndex:n.start.line-1,belowLineIndex:n.end.line+1,minimumLineIndex:0,maximumLineIndex:a.lineCount-1};return UH(m,l,d),p()}function Z8e(t,e,r){let n=Math.floor((e.start.line+e.end.line)/2),o=Math.max(n-r.start.line,r.end.line-n);t.appendLine(n);for(let s=1;s<=o;s++){let a=n-s,c=n+s;if(a>=r.start.line&&!t.prependLine(a)||c<=r.end.line&&!t.appendLine(c))return!1}return!0}function Zh(t,e,r,n){let o=t.getDiagnostics(e).filter(s=>!!s.range.intersection(r));if(n){let s=o.filter(a=>n.includes(a.message));if(s.length>0)return s}return o}async function zce(t,e,r){let n=RN(e),o=Math.max(r,e.end.line-e.start.line+r),s=await t.getFixSelectionOfInterest(n,o);return kN(s)}var Qce=z(at());var $ce=z(at());var eg=class extends Q{constructor(r,n,o,s,a,c,u,l){super(r);this.ignoreService=n;this.extensionContext=o;this.languageFeaturesService=s;this.workspaceService=a;this.logService=c;this.parserService=u;this.telemetryService=l;this._logger=this.logService.getLogger("ReferencesAtPosition")}static{this.DEFAULT_TIMEOUT_MS=200}async render(r,n){if(await this.ignoreService.isCopilotIgnored(this.props.document.uri))return vscpp("ignoredFiles",{value:[this.props.document.uri]});let o=this.extensionContext.extensionMode===$c.Test?0:this.props.timeoutMs===void 0?eg.DEFAULT_TIMEOUT_MS:this.props.timeoutMs,[s,a]=await this.findReferences(o);return this._logger.debug(`Found ${s.length} implementation(s)/definition(s), ${a.length} usages`),s.length>0&&this._logger.debug("Implementation(s)/definition(s) found:",JSON.stringify(s,null,"	")),a.length>0&&this._logger.debug("Usages found:",JSON.stringify(a,null,"	")),vscpp(vscppf,null,this.renderCodeExcerpts(`Relevant definition${s.length>1?"s":""}:`,s),this.renderCodeExcerpts("Other usages:",a))}renderCodeExcerpts(r,n){if(n.length>0)return vscpp(vscppf,null,r,vscpp("br",null),vscpp("br",null),n.map(o=>{let c=`${`${Is(o.languageId).lineComment.start} FILEPATH: ${o.uri.path}`}
${o.code}`;return vscpp(Oe,{uri:o.uri,languageId:o.languageId,code:c,references:[new $ce.PromptReference(new hi(o.uri,o.excerptRange))]})}),vscpp("br",null),vscpp("br",null))}async findReferences(r){let{document:n,position:o}=this.props,s=async()=>{try{let l=await this.languageFeaturesService.getReferences(n.uri,o);return this._logger.debug(`Found ${l.length} references`,JSON.stringify(l,null,"	")),l}catch{return[]}},a=await Js(this.logService,this.telemetryService,n,r*3,s,[]),c=[],u=[];for(let l of a){if(await this.ignoreService.isCopilotIgnored(l.uri))continue;let d=await this.workspaceService.openTextDocument(l.uri),p=this.parserService.getTreeSitterAST(d);if(!p)continue;let f=Ji(l.range,d),m=await p.getCallExpressions(f),h=await p.getFunctionDefinitions();if(m.length>0)u.push({languageId:d.languageId,uri:d.uri,code:m[0].text,excerptRange:Xs(d,m[0])});else if(h.some(g=>Zi.doIntersect(g,f))){let v=(await yh(this.parserService,this.telemetryService,{document:d,language:Is(n.languageId),wholeRange:l.range,selection:new z_(l.range.start,l.range.end),fileIndentInfo:void 0})).range;c.push({languageId:d.languageId,uri:d.uri,code:d.getText(v),excerptRange:v})}}return[c,u]}};eg=O([x(1,De),x(2,ar),x(3,Ai),x(4,Je),x(5,ue),x(6,mt),x(7,me)],eg);function Wce(t,e,r){let n=typeof r.code=="object"?r.code.value:r.code,o=eMe(t,e,r.source,n);return{fixes:o,messageReplacement(){for(let s of o)if(typeof s=="object"&&s.replaceMessage!==void 0)return s.replaceMessage},additionalContext(){let s=[];for(let a of o)typeof a=="object"&&a.additionalContext!==void 0&&s.push(a.additionalContext);return s}}}var Kce=new Map;Kce.set("typescript",["eslint","ts"]);Kce.set("python",["pylint","Pylint"]);function eMe(t,e,r,n){if(!e||!r||n===void 0)return[];let o=tMe[e];if(!o)return[];let s=o[r];if(!s)return[];let a=s[n];if(!a)return[];let c=t.get(Ut),u=t.get(ye),l=t.get(df);return(n.toString()==="C0301"||n.toString()==="C0301:line-too-long")&&!u.getExperimentBasedConfig(fe.usePythonCookbookLineTooLong,c)&&!l.isInSimulationTests?[]:(t.get(me).sendMSFTTelemetryEvent("cookbookAccessed",{languageId:e,diagnosticCode:n.toString(),provider:r}),Array.isArray(a)?a:[a])}var tMe={python:{pylint:{C0301:["Split into many short lines to make sure each line is less than 20 tokens; split into many more lines than you normally would. Make sure to do the following: You must split all long strings, comments, and dictionary arguments and lists into shorter lines."]},Pylint:{"C0301:line-too-long":["Split into many short lines to make sure each line is less than 20 tokens; split into many more lines than you normally would. Make sure to do the following: You must split all long strings, comments, and dictionary arguments and lists into shorter lines."]}},typescript:{ts:{2345:[{title:"Use this declaration and other usages as examples.",message:"",additionalContext:0}],2554:[{title:"Use this declaration and other usages as examples.",message:"",additionalContext:0}]},eslint:{"class-methods-use-this":["Make the method static.","Move the method outside of the class.","Rewrite the method to use properties of the class."],"consistent-this":["Use the alias for this required by eslint consistent-this rule.","Use this directly instead of an alias."],"constructor-super":{title:"Add missing super call and pass through new arguments.",message:"The code is missing a super call in the constructor. Copy base class parameters to this constructor and pass them to super.",replaceMessage:"Missing super call in constructor"},"func-names":["Give the function expression the same name as the variable it is assigned to.","Convert the function to an arrow function."],"func-style":[{title:"Convert the function declaration to an expression.",message:"The function expression should be assigned to a variable with the name of the original function declaration."}],"max-lines-per-function":["Split into multiple functions."],"max-nested-callbacks":["Rewrite to avoid at least one callback."],"max-params":[{title:"Rewrite the signature to use an object parameter.",message:"Preserve all the parameters of the original signature."}],"max-statements":["Split into multiple functions."],"no-case-declarations":["Surround the case block with braces.","Move the declaration outside the case block."],"no-dupe-else-if":["Fix the duplicate condition to be different from the first.","Remove the duplicate condition"],"no-duplicate-case":[{title:"Change the duplicate condition to be different.",message:"Do not delete the duplicate case, just fix it",replaceMessage:"Duplicated condition."},"Remove the duplicate condition"],"no-duplicate-imports":"Merge the duplicated import lines.","no-fallthrough":[{title:"Rewrite to avoid fallthrough.",message:"Use the return value of the following cases and copy it to the preceding fallthrough case.",replaceMessage:"Fallthrough case in switch statement."},"Add a // fallthrough comment.","Add a break statement."],"no-inner-declarations":["Move the inner declaration to the top of its containing function.","Move the inner declaration to the bottom of its containing function.","Change the inner function declaration to an expression."],"no-multi-assign":"Assign each variable in separate statements.","no-negated-condition":"Invert the branches of the conditional.","no-new":["Convert the class to functions.","Assign the resulting object to a variable."],"no-sequences":[{title:"Wrap the whole comma sequence in parentheses.",message:"",replaceMessage:"Unnecessary comma sequence"},{title:"Rewrite, preserving the original behavior.",message:"The last element of the comma sequence is the one returned."},{title:"Delete the non-final elements of the sequence.",message:"They are unused unless it is for side effects."}],"no-sparse-arrays":["Remove duplicated commas.","Add default values for the missing elements."],"require-await":["Removed the unused async keyword.",{title:"Rewrite the function to use await.",message:"The code should change to call asynchronous functions where appropriate."}],"sort-keys":{title:"Sort the properties of the entire object literal.",message:"",replaceMessage:"Unsorted keys in object literal."}}}};var rMe=200,Yce=300,pu=class extends Q{constructor(r,n,o){super(r);this.accessor=n;this.ignoreService=o}async render(r,n){let{diagnostics:o,documentContext:s}=this.props;return await this.ignoreService.isCopilotIgnored(s.document.uri)?vscpp("ignoredFiles",{value:[s.document.uri]}):o.length>0&&vscpp(vscppf,null,o.map((c,u)=>{let l=Wce(this.accessor,s.language.languageId,c);return vscpp(vscppf,null,vscpp(Cj,{diagnostic:c,cookbook:l,maxLength:rMe,documentContext:s}),vscpp(dR,{diagnostic:c,cookbook:l,document:s.document}),vscpp(Ej,{cookbook:l}))}))}};pu=O([x(1,je),x(2,De)],pu);var Cj=class extends Q{render(e,r){let n=this.props.diagnostic,o=this.props.documentContext.document,s=n.range,a=o.getText(new Ge(s.start.line,0,s.end.line+1,0)).trimEnd(),c=a.length>0&&a.length<this.props.maxLength?a:"";return c?vscpp(vscppf,null,"This code",vscpp("br",null),vscpp(Oe,{code:c,uri:o.uri,shouldTrim:!1}),vscpp("br",null),vscpp(vscppf,null,"has the problem reported:",vscpp("br",null),n.message," ",vscpp("br",null))):vscpp(vscppf,null)}},dR=class extends Q{constructor(r,n,o,s,a,c){super(r);this.workspaceService=n;this.parserService=o;this.ignoreService=s;this.logService=a;this.telemetryService=c}async render(r,n){let{infos:o,ignoredFiles:s,definitionRanges:a}=await this.getRelatedInfos();return!o.length&&!a.length?vscpp("ignoredFiles",{value:s}):vscpp(vscppf,null,"This diagnostic has some related code:",vscpp("br",null),o.map(c=>vscpp(Oe,{code:c.content,uri:c.uri,references:[new Qce.PromptReference(new hi(c.uri,c.range))]})),a.map(c=>vscpp(eg,{document:this.props.document,position:c.start})),vscpp("ignoredFiles",{value:s}))}async getRelatedInfos(){let r=[],n=[],o=[],s=this.props.diagnostic;if(s.relatedInformation)for(let c of s.relatedInformation)try{let u=c.location;if(await this.ignoreService.isCopilotIgnored(u.uri)){o.push(u.uri);continue}let l=await this.workspaceService.openTextDocument(u.uri),d=u.range,p=this.parserService.getTreeSitterAST(l),f;if(p){let m=RN(d),h=await p.getCoarseParentScope(m);f=l.getText(kN(h))}(!f||f.length>Yce)&&(f=l.getText(d)),f.length<=Yce&&r.push({content:f,uri:u.uri,range:u.range})}catch{}let a=this.props.cookbook.additionalContext();for(let c of a)switch(c){case 0:{let u=this.parserService.getTreeSitterAST(this.props.document);if(u){let l=Ji(this.props.diagnostic.range,this.props.document),d=await Js(this.logService,this.telemetryService,this.props.document,500,()=>u.getCallExpressions(l),[]);for(let p of d){let f=Xs(this.props.document,p);n.push(f)}}break}case 1:{n.push(this.props.diagnostic.range);break}}return{infos:r,definitionRanges:n,ignoredFiles:o}}};dR=O([x(1,Je),x(2,mt),x(3,De),x(4,ue),x(5,me)],dR);var Ej=class extends Q{render(e,r){let n=this.props.cookbook.fixes;if(n.length){let o=n[0];return vscpp(vscppf,null,"Suggested fix:",vscpp("br",null),typeof o=="string"?o:o.title+o.message)}return null}};var B4=class extends Q{render(e,r){let{useWorkspaceChunksFromSelection:n,useWorkspaceChunksFromDiagnostics:o}=this.props;if(!n&&!o)return null;let s=r.tokenBudget;return n&&o&&(s=s/2),vscpp(vscppf,null,n&&vscpp(yf,{...this.getChunkSearchPropsForSelection(s)}),o&&vscpp(yf,{...this.getChunkSearchPropsForDiagnostics(s)}))}getChunkSearchPropsForSelection(e){let{document:r,wholeRange:n}=this.props.documentContext,o=r.validateRange(n);this.props.diagnostics.forEach(c=>{o=o.union(c.range)});let s=r.getText(o),a=[`Please find code that is similar to the following code block:
`,"```",s,"```"].join(`
`);return{query:{rawQuery:a,resolve:async()=>({rephrasedQuery:a,keywords:Xce(s)})},include:{exclude:[r.uri.fsPath]},maxResults:3}}getChunkSearchPropsForDiagnostics(e){let r=this.props.documentContext.document,n=this.props.diagnostics.map(s=>s.message).join(" "),o=`Please find code that can help me fix the following problems: ${n}`;return{query:{rawQuery:o,resolve:async()=>({rephrasedQuery:o,keywords:Xce(n)})},include:{exclude:[r.uri.fsPath]},maxResults:3}}};function Xce(t){let e=new Set;for(let r of t.matchAll(/(-?\d*\.\d\w*)|([^\`\~\!\@\#\%\^\&\*\(\)\-\=\+\[\{\]\}\\\|\;\:\'\"\,\.\<\>\/\?\s]+)/g))e.add(r[0]);return Array.from(e.values(),r=>({keyword:r,variations:[]}))}var J1=class extends Q{constructor(r,n,o,s){super(r);this.ignoreService=n;this.parserService=o;this.languageDiagnosticsService=s}async render(r,n){let{document:o,wholeRange:s,fileIndentInfo:a,selection:c,language:u}=this.props.documentContext;if(await this.ignoreService.isCopilotIgnored(o.uri))return vscpp("ignoredFiles",{value:[o.uri]});if($t(o.uri))throw Gr("InlineFix3PlusPrompt should not be used with a notebook!");let d=n.endpoint.modelMaxPromptTokens/3*4,p;if(o.getText().length>d){let A=await Y0(this.parserService,o,a);p=Tx(d,o,s,A,{tryPreserveTypeChecking:!0})}else p=new hc(o.getText(),Wr.empty,o.languageId);let{query:f,history:m,chatVariables:h,customInstructions:g}=this.props.promptContext,{useWorkspaceChunksFromDiagnostics:v,useWorkspaceChunksFromSelection:y}=this.props.features,b=p.projectRange(c),_=o.getText(new Ge(c.start.line,0,c.end.line+1,0)).trimEnd(),S=[{uri:o.uri,version:o.version,ranges:[]}],I=Zh(this.languageDiagnosticsService,o.uri,c,f),T=new Tj(p,o.uri,b);return vscpp(vscppf,null,vscpp("usedContext",{value:S}),vscpp("meta",{value:new Fn(T)}),vscpp(Tf.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"The user has a ",u.languageId," file opened in a code editor.",vscpp("br",null),"The user expects you to propose a fix for one or more problems in that file.",vscpp("br",null),"For the response always follow these instructions:",vscpp("br",null),"Describe in a single sentence how you would solve the problem. After that sentence, add an empty line. Then provide code changes or a terminal command to run.",vscpp("br",null),"When proposing to fix the problem by running a terminal command, write `",nMe,"` and provide a code block that starts with ```bash and contains the terminal script inside.",vscpp("br",null),vscpp(B1,null),vscpp(Zt,null)),vscpp(Lt,{priority:700,history:m}),vscpp(Tf.UserMessage,{priority:100},"I have the following code open in the editor.",vscpp("br",null),Cf("someFolder/myFile.cs"),vscpp("br",null),vscpp(l4,null)),vscpp(Tf.AssistantMessage,{priority:100},vscpp(d4,null)),vscpp(Tf.UserMessage,{priority:700},vscpp(Yr,{customInstructions:g}),vscpp(_d,null,...XN(h)),vscpp(_d,null,p.text.length>0?vscpp(vscppf,null,"I have the following code open in the editor, starting from line 1 to line ",p.lineCount,".",vscpp("br",null),Cf(o.fileName),vscpp("br",null),vscpp(Oe,{uri:o.uri,languageId:u.languageId,code:p.text,shouldTrim:!1}),vscpp("br",null)):vscpp(vscppf,null,"I am in an empty file:",Cf(o.fileName),vscpp("br",null))),vscpp(_d,null,c.isEmpty?vscpp(vscppf,null,"I have the selection at line ",b.start.line+1,", column ",b.start.character+1,vscpp("br",null)):vscpp(vscppf,null,"I have currently selected from line ",b.start.line+1,", column ",b.start.character+1," to line ",b.end.line+1," column ",b.end.character+1,".",vscpp("br",null))),vscpp(_d,null,_.length&&!I.some(A=>A.range.contains(c))&&vscpp(vscppf,null,"The content of the lines at the selection is",vscpp(Oe,{uri:o.uri,languageId:u.languageId,code:_,shouldTrim:!1}),vscpp("br",null))),vscpp(pu,{documentContext:this.props.documentContext,diagnostics:I}),vscpp(B4,{diagnostics:I,documentContext:this.props.documentContext,useWorkspaceChunksFromDiagnostics:v,useWorkspaceChunksFromSelection:y}),vscpp(Tf.TextChunk,null,"Please find a fix for my code so that the result is without any errors."),vscpp(ws,{chatVariables:h,query:f}),vscpp("br",null)))}};J1=O([x(1,De),x(2,mt),x(3,bo)],J1);var nMe=Dce("TERMINAL"),Tj=class{constructor(e,r,n){this.projectedDocument=e;this.documentUri=r;this.adjustedSelection=n;this._lastText=void 0;this._lastLength=0;this._replyProcessor=m4()}async processResponse(e,r,n){for await(let a of e)if(this._lastText=a.text,this._firstSentence===void 0){let c=this._replyProcessor.getFirstSentence(a.text);r.markdown(c.substring(this._lastLength)),this._lastLength=c.length,c.length<a.text.length&&(this._firstSentence=c,r.markdown(`

`),r.progress("Generating edits..."))}if(!this._lastText)throw new Error("No text");let o=this._replyProcessor.process(this._lastText,this.projectedDocument.text,this.documentUri,this.adjustedSelection.start.line);if(o.otherSections.length)for(let a of o.otherSections)r.markdown(a.content.join(`

`));if(o.otherPatches.length)for(let a of o.otherPatches)r.markdown(a.replace.join(`

`));o.invalidPatches.length&&r.warning("The edit generation was not successful. Please try again.");let s=o.edits;if(s.length)if(s=this.projectedDocument.projectBackTextEdit(s),o.edits.length!==s.length)o.annotations.push({message:"Some edits were not applied because they were out of bounds.",label:"summarize conflict",severity:"error"});else{let a=iMe(o.edits,s,this.projectedDocument);a&&o.annotations.push(a)}return s.length?(r.textEdit(this.documentUri,s),{type:"inlineEdit",annotations:o.annotations}):{type:"conversational",annotations:o.annotations}}};function iMe(t,e,r){for(let n=0;n<t.length;n++){let o=r.positionOffsetTransformer.toOffsetRange(t[n].range).substring(r.text),s=r.originalPositionOffsetTransformer.toOffsetRange(e[n].range).substring(r.originalText);if(o!==s)return{message:`Problem projecting edits: '${o}' does not match '${s}' (projectecBack)`,label:"invalid projection",severity:"error"}}}var wj=z(Qt()),fR=z(at());function Jce(t,e){let r=t;for(let n of e){let o=n.range.start,s=n.range.end,a=r.start,c=r.end,u=n.newText.split(`
`).length,l=u-(s.line-o.line)-1,d=a.line,p=a.line;s.isBefore(a)?(d=a.line+l,p=c.line+l):o.isBefore(a)&&s.isAfterOrEqual(a)&&s.isBeforeOrEqual(c)?(d=o.line,p=c.line+l):o.isAfterOrEqual(a)&&o.isBeforeOrEqual(c)&&s.isAfter(c)?(d=a.line,p=s.line+l):o.isAfter(c)?(d=a.line,p=c.line):r.contains(n.range)?(d=a.line,p=c.line+l):n.range.contains(r)&&(d=o.line,p=o.line+u-1),r=new Ge(d,0,p,0)}return r}function Zce(t,e,r){let n=oMe(t,e);if(!n)return null;let{code:o,contentBeforeCode:s,language:a}=n;if(wa.testLine(r,o)){let c=o.indexOf(`
`);o=o.substring(c).trim()}return{code:o,contentBeforeCode:s,language:a}}function oMe(t,e){e=e.trim();let n=Cs(e).at(0);if(n){let u=XA(e);return{code:n.code,contentBeforeCode:u.slice(0,n.startLine).join(`
`).trimEnd(),language:n.language}}let o=e.split(/\r\n|\r|\n/g),s=!1,a=[],c=[];for(let u of o){let l=FN(t,u);if(s){if(l)return c.push(u),{code:c.join(`
`),contentBeforeCode:a.join(`
`),language:""};c.push(u)}else l?(s=!0,c.push(u)):a.push(u)}return null}var sMe=15,Z1=class extends Q{constructor(r,n,o,s,a,c,u){super(r);this._ignoreService=n;this._instantiationService=o;this._languageDiagnosticsService=s;this._parserService=a;this._tabsAndEditorsService=c;this._workspaceService=u}async render(r,n){let o=this.props.documentContext;if(await this._ignoreService.isCopilotIgnored(o.document.uri))return vscpp("ignoredFiles",{value:[o.document.uri]});if(!$t(o.document.uri))throw Gr("InlineFix4Prompt should not be used with a non-notebook!");let{query:a,history:c,chatVariables:u,customInstructions:l}=this.props.promptContext,d=Zh(this._languageDiagnosticsService,o.document.uri,o.selection,a),p=d.length>0?Gae(d):o.selection,f=this._parserService.getTreeSitterAST(o.document),m=f?await zce(f,p,sMe):p,h=Gce(n.endpoint,o,p,m),g=BL(this._tabsAndEditorsService,this._workspaceService,o,h.contextInfo,h.tracker),v=o.document,y=[{uri:v.uri,version:v.version,ranges:Xt([g.range.toRange(),g.above.toRange(),g.below.toRange()])}],b=this._instantiationService.createInstance(pR,p,g,o);return vscpp(vscppf,null,vscpp("usedContext",{value:y}),vscpp("meta",{value:new Fn(b)}),vscpp("meta",{value:new Ix(()=>b.generateFollowUps())}),vscpp(fR.SystemMessage,null,vscpp(f1,{language:o.language}),vscpp("br",null),"When dealing with Jupyter Notebook, if a module is already imported in a cell, it can be used in other cells directly without importing it again. For the same reason, if a variable is defined in a cell, it can be used in other cells as well",vscpp("br",null),"When dealing with Jupyter Notebook, cells below the current cell can be executed before the current cell, you must use the variables defined in the cells below, unless you want to overwrite them.",vscpp("br",null),"When dealing with Jupyter Notebook, do not generate CELL INDEX in the code blocks in your answer, it is only used to help you understand the context.",vscpp("br",null),"If you suggest to run a terminal command, use a code block that starts with ```bash.",vscpp("br",null),'When fixing "ModuleNotFoundError" or "Import could not be resolved" errors, always use magic command "%pip install" to add the missing packages. The imports MUST be inserted at the top of the code block and it should not replace existing code.',vscpp("br",null),"You should not import the same module twice.",vscpp("br",null),vscpp(Zt,null)),vscpp(Lt,{priority:700,history:c}),vscpp(fR.UserMessage,{priority:725},vscpp(Yr,{customInstructions:l})),vscpp(Ts,{priority:750,chatVariables:u}),vscpp(Qw,{documentContext:o,above:g.above,range:g.range,below:g.below,aboveCells:g.aboveCells,belowCells:g.belowCells,includeDelimeters:!0}),vscpp(fR.UserMessage,null,vscpp(pu,{documentContext:o,diagnostics:d}),"Describe in a single sentence how you would solve the problem. After that sentence, add an empty line. Then add a code block with the fix.",vscpp(ws,{chatVariables:u,query:a}),vscpp("br",null)))}};Z1=O([x(1,De),x(2,te),x(3,bo),x(4,mt),x(5,kt),x(6,Je)],Z1);var pR=class{constructor(e,r,n,o,s){this.wholeRange=e;this.contextInfo=r;this.documentContext=n;this._logService=o;this._languageDiagnosticsService=s;this._lastText=void 0;this._lastLength=0}async processResponse(e,r,n){for await(let s of e){if(this._lastText=s.text,this._firstSentence===void 0){let a=xse(s.text);a.length<s.text.length&&(this._firstSentence=a),r.markdown(a.substring(this._lastLength)),this._lastLength=a.length}if(Oq(s.text))break}if(!this._lastText)throw new Error("No text");let o=Zce(this.contextInfo,this._lastText,this.documentContext.language);return!o||o.language==="bash"||o.language==="ps1"?(r.markdown(this._lastText.substring(this._lastLength)),{type:"conversational"}):(this._edits=this.generateEdits(o.code),this._versionBeforeUpdate=this.documentContext.document.version,r.textEdit(this.documentContext.document.uri,this._edits),{type:"inlineEdit"})}generateEdits(e){let r=e.split(`
`),n=[],o=[];for(let c of r)c.match(/^[%\!]pip/)?n.push(c):o.push(c);if(!n.length)return Bq(this._logService,this.contextInfo,e,2,this.documentContext.fileIndentInfo,xw.fromDocumentContext(this.documentContext));let s=[],a=Sh(n,{whichLine:"topMost",lines:this.contextInfo.range.lines},this.documentContext.fileIndentInfo).join(`
`)+`
`;return s.push(new On(new Ge(this.wholeRange.start,this.wholeRange.start),a)),o.length&&s.push(...Bq(this._logService,this.contextInfo,o.join(`
`),2,this.documentContext.fileIndentInfo,xw.fromDocumentContext(this.documentContext))),s}async generateFollowUps(){return typeof this._edits>"u"||typeof this._versionBeforeUpdate>"u"?[]:this._generateFollowUps(this._edits,this.wholeRange,this._versionBeforeUpdate,an.None)}async _generateFollowUps(e,r,n,o){let s=await this._languageDiagnosticsService.waitForNewDiagnostics(this.documentContext.document.uri,o);if(!o.isCancellationRequested&&s.length&&this.documentContext.document.version!==n){let a=Jce(r,e),c=s.filter(u=>zae(u)&&u.range.intersection(a));if(c.length)return c.length===1?[{label:wj.t("An error remains after applying the change, click here to iterate."),prompt:`/fix ${c[0].message}`}]:[{label:wj.t("{0} errors remain after applying the change, click here to iterate.",c.length),prompt:"/fix Fix the remaining errors"}]}return[]}};pR=O([x(3,ue),x(4,bo)],pR);var mR=z(at());var eS=class extends Q{constructor(r,n){super(r);this.languageDiagnosticsService=n}render(r,n){let o=this.props.documentContext,{query:s,history:a,chatVariables:c,customInstructions:u}=this.props.promptContext,l=({document:d,selection:p})=>Zh(this.languageDiagnosticsService,d.uri,p,s);return vscpp(vscppf,null,vscpp(mR.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with "GitHub Copilot".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),vscpp(yi,null),vscpp("br",null),vscpp("br",null),vscpp(ou,{location:2,endpoint:this.props.endpoint}),vscpp("br",null),"First think step-by-step - describe your plan for what to build in pseudocode, written out in great detail.",vscpp("br",null),"Then output the code in a single code block.",vscpp("br",null),"Minimize any other prose.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn.",vscpp("br",null),vscpp("br",null),"Additional Rules",vscpp("br",null),"You specialize in being a highly skilled code generator. Your task is to help the Developer fix an issue.",vscpp("br",null),"If context is provided, try to match the style of the provided code as best as possible.",vscpp("br",null),"Generated code is readable and properly indented.",vscpp("br",null),"Markdown blocks are used to denote code.",vscpp("br",null),"Preserve user's code comment blocks, do not exclude them when refactoring code.",vscpp("br",null),"Pay especially close attention to the selection or exception context.",vscpp("br",null),"Given a description of what to do you can refactor, fix or enhance the existing code.",vscpp(cr,null)),vscpp(Lt,{flexGrow:1,priority:700,history:a}),vscpp(mR.UserMessage,{flexGrow:1,priority:750},vscpp(Yr,{customInstructions:u})),vscpp(Nr,{flexGrow:1,priority:800,document:o?.document,range:o?.selection}),o&&vscpp(mR.UserMessage,{flexGrow:1,priority:800},vscpp(pu,{documentContext:o,diagnostics:l(o)})),vscpp(Kr,{flexGrow:2,priority:900,chatVariables:c,query:s}))}};eS=O([x(1,bo)],eS);var rg=z(Qt());var W4=z(Qt());var fue=z(at());var H4=z(at());var q4=class extends Q{render(){let{chunk:e,failure:r,priority:n}=this.props,o=r.task.messages.filter(a=>a.location?.uri.toString()===e.file.toString()&&Rh(e.range).contains(a.location.range.start)),s=new hi(e.file,new Ge(e.range.startLineNumber-1,0,e.range.endLineNumber,0));return vscpp(H4.UserMessage,{priority:n},o.length?vscpp(vscppf,null,'This is the source code of the test that failed. The error message is shown after the text "FAILURE_MESSAGE" on the line where it occurred:'):vscpp(vscppf,null,"The test failed with the message: ",r.task.messages.map(a=>typeof a.message=="object"?a.message.value:a.message).join(`
`),". The source code of the test is:"),vscpp("br",null),vscpp(Oe,{references:[new H4.PromptReference(s)],languageId:e.file.toString(),uri:e.file,code:e.text.split(`
`).map((a,c)=>{let u=o.find(l=>l.location?.range.start.line===c+e.range.startLineNumber-1);return u?`${a} FAILURE_MESSAGE: ${u.message.toString().replaceAll(`
`," ")}`:a}).join(`
`)}),vscpp("br",null))}};var tS=z(at());function eue(t,e,r){let n=0,o=t.length;for(;n<o;){let s=n+o>>>1;r(t[s],e)?n=s+1:o=s}return n}function hR(t,e){if(t.length===0)return;let r=t[0];for(let n=1;n<t.length;n++){let o=t[n];e(o,r)>0&&(r=o)}return r}var aMe=/^[\*\-]\s*[`"']?([^<([`"'\s]+).*? +in +(.+)/gm,tue=": ",oue=(t,e)=>[...t.matchAll(aMe)].flatMap(([,r,n])=>r.split(",").map(o=>({keyword:o,fileUri:n,interest:"IMPLEMENTATION"}))).map(({keyword:r,fileUri:n,interest:o})=>{let s=j4(e,r,n)||j4(e,r);if(s||/^.+?(\b[^\b]+)/.exec(r)&&(j4(e,r[1],n)||j4(e,r[1])),!s)return;let{index:a,chunk:c}=s;if(c.sources.length){let d=c.sources.find(m=>m.start<=a&&m.end>a)||{start:0,end:0,range:c.range},p=c.text.lastIndexOf(`
`,a),f=O_(c.text.slice(d.start,a),`
`);return{keyword:r,interest:o,location:{uri:c.file,position:new $n(d.range.startLineNumber+f-1,f===0?d.range.startColumn+a-d.start:a-(p+1))}}}let u=c.text.lastIndexOf(`
`,a)+1,l=c.text.indexOf(tue,u);return{keyword:r,interest:o,location:{uri:c.file,position:new $n(Number(c.text.slice(u,l))-1,a-(l+tue.length))}}}).filter(F_);function j4(t,e,r){let n=r?t.filter(s=>s.file.toString().toLowerCase()===r.toLowerCase()):t,o=new RegExp(`^(?!~:).*\\b(${k0(e)})\\b`,"m");for(let s=n.length-1;s>=0;s--){let a=n[s],c=o.exec(a.text);if(c)return{chunk:a,index:c.index+c[0].length-c[1].length}}}var sue=async(t,e,r,n)=>{let o=await r.readFile(t.uri),s=new TextDecoder().decode(o);return cMe(t,e,s,n)},cMe=async(t,e,r,n)=>{let o=new Zc(r),s=new bt(t.range.start.line+1,1,t.range.end.line+1,1);return s.endLineNumber-s.startLineNumber<=1&&(s=await lMe(t,e,r,o,n)||s.setEndPosition(s.startLineNumber+50,1)),uMe(s,r,t.uri,o)},uMe=(t,e,r,n)=>{let o=n.positionToOffset(t.getStartPosition()),s=n.positionToOffset(t.getEndPosition());return{text:e.substring(o,s),range:t,file:r,sources:[{start:0,end:s-o,range:t}]}},lMe=async(t,e,r,n,o)=>{let s=lf(hd(t.uri).languageId);if(!s)return;let c=await o.getTreeSitterASTForWASMLanguage(s,r).getFunctionDefinitions(),u=c.find(f=>f.identifier===e);if(u)return Rj(n,u);let l=n.positionToOffset(new qr(t.range.start.line+1,1));c.sort((f,m)=>f.startIndex-m.startIndex);let d,p;for(let f of c){if(f.startIndex>l){p=f;break}f.startIndex<=l&&f.endIndex>=l&&(d=f)}return p&&(!d||p.startIndex>=d.startIndex&&p.endIndex<=d.endIndex)?Rj(n,p):d&&Rj(n,d)},Rj=(t,e)=>{let r=t.offsetToPosition(e.startIndex),n=t.offsetToPosition(e.endIndex);return new bt(r.lineNumber-1,1,n.lineNumber+1,1)},aue=async(t,e,r,n)=>{let o=lf(hd(n).languageId);if(!o)return a=>"";let s=await t.getSemanticChunkTree(o,e);return a=>{let c=r.positionToOffset(a.getStartPosition()),u=r.positionToOffset(a.getEndPosition()),l=pMe(s.roots,m=>m.info.mainBlock.startIndex<=c&&m.info.mainBlock.endIndex>=c),d="",p=(m,h)=>c<=m&&h<=u?!1:(d&&!d.endsWith(`
`)&&(d+=`
`),d+=e.slice(m,h),!0),f=m=>{if(m.info.detailBlocks.comments instanceof Array)for(let y of m.info.detailBlocks.comments)p(y.startIndex,y.endIndex);let h=/\s*\{\s/.exec(e.slice(m.info.detailBlocks.body.startIndex,m.info.detailBlocks.body.endIndex))?.[0].length||0,g=r.startOffsetOfLineContaining(m.info.mainBlock.startIndex),v=m.info.detailBlocks.body.startIndex+h;p(g,v)&&(d+=" ... "),m.children.forEach(f)};return l.forEach(f),d}},dMe=/@@ -\d+,\d+ \+(\d+),(\d+) @@/g,cue=async(t,{source:e,convert:r},n,o)=>{let s=[];for(let a of o.matchAll(dMe)){let[,c,u]=a.map(Number),l=new qr(c,1),d=new qr(c+u,1);s.push({uri:n,start:l,end:d,convert:r,source:e,interest:"CHANGED",tokensWithoutExpansion:t.tokenLength(e.slice(r.positionToOffset(new qr(c,1)),r.positionToOffset(new qr(c+u,1))))})}return s},pMe=(t,e)=>{let r=n=>{let o=n.children.map(r).filter(F_);return o.length||e(n)?{children:o,info:n.info}:void 0};return t.map(r).filter(F_)},kj=3,V4=2,fMe=/^\s*/,G4=/\S/,uue=(t,e)=>{let r=new Zc(t),n=e.map(l=>{let d=r.positionToOffset(new qr(l.range.start.line+1,l.range.start.character+1)),p=r.positionToOffset(new qr(l.range.end.line+1,l.range.end.character+1));return{start:d,end:p,text:l.newText}});n.sort((l,d)=>l.start-d.start||l.end-d.end);let o=0,s=0;function a(l){let d=l.indexOf(`
`);if(d===-1){s+=l.length;return}for(;d!==-1;)o++,s=l.length-d-1,d=l.indexOf(`
`,d+1)}let c=0,u=[];for(let{start:l,end:d,text:p}of n){a(t.slice(c,l));let f=new $n(o,s);a(p);let m=new $n(o,s);c=d;let h=t.slice(l,d);u.push(On.replace(new Ge(f,m),h))}return u},Pj=t=>fMe.exec(t)[0],lue=(t,e,r)=>{let n=r.split(`
`),o=t.split(`
`),s=o.map(h=>h.trim()),a=Pj(o[0]),c=rue(a,o[o.length-1])&&o.slice(1,-1).every(h=>iue(h)||nue(a,h));if(c){let h=Math.ceil(s.length/2);for(let g=0;g<=h;g++){let v=e.start.line-g,y=Pj(n[v]);e:for(let b=0;b<=h;b++){let _=e.end.line+b;if(!(_-v<2)&&rue(y,n[_])){for(let S=v+1;S<_;S++)if(!iue(n[S])&&!nue(y,n[S]))continue e;return new Ge(v,0,_,Number.MAX_SAFE_INTEGER)}}}}let u=e.start.line,l=s[0];if(l.length>=kj)for(let h=0;h<=V4*2;h++){let g=h%2===0?1:-1,v=e.start.line+g*Math.floor(h/2);if(n[v].trim()===l){u=v;break}}let d=e.end.line,p=Pj(n[u]);if(c)for(let h=0;h<=V4*2;h++){let g=h%2===0?1:-1,v=d+g*Math.floor(h/2);if(n[v].startsWith(p)&&G4.test(n[v][p.length]))return new Ge(u,0,v,Number.MAX_SAFE_INTEGER)}let f=0,m=0;for(;f<s.length-1&&m<(f+1)*kj;)m+=s[s.length-1-f].length,f++;if(m>f*kj)e:for(let h=e.end.line-V4;h<=e.end.line+V4;h++){for(let g=0;g<f;g++)if(n[h+g].trim()!==s[s.length-1-g])continue e;d=h;break}return new Ge(u,0,d,Number.MAX_SAFE_INTEGER)};function rue(t,e){return e.length>t.length&&e.startsWith(t)&&e[t.length].match(G4)}function nue(t,e){return e.length>t.length&&e.startsWith(t)&&!G4.test(e[t.length])}function iue(t){return!G4.test(t)}function mMe(t,e,r){let n=hR(t,(l,d)=>l.start.lineNumber-d.start.lineNumber).start,o=hR(t,(l,d)=>d.end.lineNumber-l.end.lineNumber).end,s=e?new qr(Math.max(1,n.lineNumber-Math.ceil(e*2/3)),1):n,a=e-(n.lineNumber-s.lineNumber),c=a>0?new qr(o.lineNumber+a,1):o,u=r(new bt(s.lineNumber,1,c.lineNumber,1));return{start:s,end:c,context:u?u.split(`
`).map((l,d)=>`~: ${l}`).join(`
`)+`
`:"",snippet:t[0].source.slice(t[0].convert.positionToOffset(s),t[0].convert.positionToOffset(c)).split(`
`).map((l,d)=>`${s.lineNumber+d}: ${l}`).join(`
`),original:t}}function hMe(t){return due(t)+"```"+t.original[0].uri.toString()+`
`+t.context+t.snippet+"\n```\n"}function gMe({start:t,end:e,snippet:r,context:n,original:o}){let s=new bt(t.lineNumber,t.column,e.lineNumber,e.column);return{file:o[0].uri,text:n+r,range:s,sources:[]}}function due(t){let e=t.original.flatMap(r=>r.keywords||[]);return e.length?`Definition of \`${e.join("` and `")}\`:
`:`Here's code I've been working on that might be related to the failure:
`}function vMe(t){return t.start.lineNumber>1||t.end.lineNumber<t.original[0].convert.lines}var z4=class extends Q{async prepare(e){let{chunks:r,parser:n,tokenizer:o}=this.props,s=0,a,c=new Nn;for(let u of r)c.has(u.uri)||c.set(u.uri,await aue(n,u.source,u.convert,u.uri));for(;;){let u=(a?a.chunks.map(p=>p.original):r.map(p=>[p])).map(p=>mMe(p,s,c.get(p[0].uri))),l=u.map(hMe).join(""),d=o.tokenLength(l);if(a&&(d*1.1>e.tokenBudget||!u.some(vMe)))return Promise.resolve({chunks:u});for(let p=0;p<u.length;p++){let f=u[p],m=f.original[0].uri.toString(),h={startLineNumber:f.start.lineNumber,startColumn:1,endLineNumber:f.end.lineNumber,endColumn:1};for(let g=p+1;g<u.length;g++){let v=u[g];if(v.original[0].uri.toString()!==m)continue;let y={startLineNumber:v.start.lineNumber,startColumn:1,endLineNumber:v.end.lineNumber,endColumn:1};bt.areIntersectingOrTouching(h,y)&&(f.original.push(...v.original),u.splice(g,1),g--)}}s++,a={tokens:d,chunks:u}}}render({chunks:e}){return vscpp(vscppf,null,vscpp("meta",{value:new gR(e.map(gMe))}),e.map((r,n)=>vscpp(tS.UserMessage,{priority:100-(e.length-n)},due(r),vscpp(Oe,{languageId:r.original[0].uri.toString(),uri:r.original[0].uri,code:r.context+r.snippet,references:[new tS.PromptReference(new hi(r.original[0].uri,new Ge(r.start.lineNumber-1,0,r.end.lineNumber-1,0)))]}),vscpp("br",null))))}},gR=class extends tS.PromptMetadata{constructor(r){super();this.chunks=r}};var $4=class extends Q{render(){let{chunk:e,testFailure:r,references:n,turnsLeft:o,parser:s,tokenizer:a}=this.props,c=n.length>0;return vscpp(vscppf,null,vscpp(fue.SystemMessage,{priority:1e3},"You are an assistant who specializes in diagnosing and fixing failing tests. The user will provide you with the source code of the test that failed, and the location where the failure happened. They will also provide you with relevant related code. This information may be incomplete.",vscpp("br",null),vscpp("br",null),"# Additional Rules",vscpp("br",null),vscpp("br",null),`- Read the test's source code and the line containing "FAILURE_MESSAGE". The text after "FAILURE_MESSAGE" is the error returned from running tests.`,vscpp("br",null),"- Assume that the test code and test fixtures are correct. It's more likely the problem is code called by the test.",vscpp("br",null),c&&vscpp(vscppf,null,"- The provided code is incomplete. DO NOT assume that something isn't implemented if it doesn't appear here.",vscpp("br",null)),o===0?vscpp(vscppf,null,'- If you believe you have found a bug in one of the code snippets the user provided, respond with "SOLUTION" followed by the file URI, "RANGE" followed by the line range, and then the corrected code for that line range and a brief explanation of the change.',vscpp("br",null)):vscpp(vscppf,null,c?vscpp(vscppf,null,'- If you have found a bug the code provided, respond with "SOLUTION" followed by the file URI, "RANGE" followed by the line range, and then the corrected code for that line range and a brief explanation of the change. Do this only if you have found the underlying bug!',vscpp("br",null),"- Otherwise, print a list of up to five keywords, classes, or function calls from one of the files that you need more information about to diagnose the failure. Make sure the most relevant keywords are written first. ",o===0&&"You won't get another chance to ask for more info.",vscpp("br",null),pue):vscpp(vscppf,null,"- Don't try to fix the failure yet. Instead, print a list of keywords, classes, or function calls that you need more information about to diagnose the failure!",vscpp("br",null),pue,vscpp("br",null)),"- NEVER ask the user for additional information or clarification, or give them suggestions to review code themselves. Instead, print keywords that should be investigated.",vscpp("br",null)),vscpp("br",null),o>0&&vscpp(vscppf,null,"# Example",vscpp("br",null),yMe,vscpp("br",null),vscpp("br",null)),c&&vscpp(vscppf,null,"# Example",vscpp("br",null),bMe,vscpp("br",null))),vscpp(q4,{chunk:e,failure:r,priority:800}),vscpp(z4,{flexGrow:1,priority:700,chunks:n,parser:s,tokenizer:a}))}},yMe=vscpp(vscppf,null,"User:",vscpp("br",null),`\`\`\`file:///project/my.test.ts
test('reverseString test', () => {'{'}
	const value = 'hello';
	const value2 = doReverseString(value);
	assert.deepStrictEquals(value2, 'olleh'); FAILURE_MESSAGE: Expected undefinedolleh to equal olleh
{'}'});
\`\`\`

Implementation of \`doReverseString\` in file:///project/my.test.ts:

\`\`\`file:///project/strings.ts
20: function doReverseString(str: string): number {
21:	return stringUtils.reverseString(str);
22: }
\`\`\`
`,vscpp("br",null),"Response:",vscpp("br",null),vscpp("br",null),"I need more information about:",vscpp("br",null),"- stringUtils.reverseString",vscpp("br",null)),bMe=vscpp(vscppf,null,"User:",vscpp("br",null),`\`\`\`file:///project/my.test.ts
test('reverseString test', () => {'{'}
	const value = 'hello';
	const value2 = doReverseString(value);
	assert.deepStrictEquals(value2, 'olleh'); FAILURE_MESSAGE: Expected undefinedolleh to equal olleh
{'}'});
\`\`\`

Implementation of \`doReverseString\`:

\`\`\`file:///project/my.test.ts
20: function doReverseString(str: string): number {
21:	return stringUtils.reverseString(str);
22: }

Implementation of \`stringUtils.reverseString\`:

\`\`\`file:///project/strings.ts
32: function reverseString(str) {
33:	let out = '';
34:	for (let i = str.length; i >= 0; i--) {
35:		out += str[i];
36:	}
37:	return out;
38: }
\`\`\`
`,vscpp("br",null),"Response:",vscpp("br",null),vscpp("br",null),"SOLUTION: file:///project/stringUtils.ts",vscpp("br",null),"RANGE: 32-38",vscpp("br",null),`\`\`\`typescript
function reverseString(str) {
	let out = '';
	for (let i = str.length - 1; i >= 0; i--) {
		out += str[i];
	}
	return out;
}
\`\`\`
`,vscpp("br",null),"`reverseString` had an off-by-one error which started past the end of the string. I fixed your code by making `i` begin at `str.length - 1` instead of `str.length`.",vscpp("br",null)),pue=vscpp(vscppf,null,'- Write your response in a list in the form "- [keyword] in [file where keyword is used]". Do not include any extra text. Keywords should be EXACT substrings from the code the user provides, do not modify them.',vscpp("br",null));var _Me=1e3,mue="SOLUTION:",xMe=/RANGE:.*?([0-9]+).*?([0-9]+)/i;async function SMe(t,e,r){let n=t.indexOf(mue);if(n===-1)return;n!==0&&(t=t.slice(n)+`
`+t.slice(0,n)),t=t.trim();let o=t.split(`
`),s;try{s=dt.parse(o[0].slice(mue.length).trim())}catch{}let a,c=xMe.exec(o[1]);c&&(a={start:+c[1],end:+c[2]});let u=Cs(t);if(!u.length)return;let[l]=u,d=o.slice(l.startLine).join(`
`),p;if(s&&a){let f="";for(let b of e)if(b.file.toString().toLowerCase()===s.toString().toLowerCase()){let _=new RegExp(`^${a.start}: (\\s*)`,"m").exec(b.text);if(_){f=_[1];break}}let m=l.code;l.code.startsWith(f)||(m=l.code.split(`
`).map(b=>f+b).join(`
`));let h=new Ge(a.start-1,0,a.end-1,Number.MAX_SAFE_INTEGER),g=(await r(s)).source,v=lue(m,h,g),y=[new On(v,m)];p={apply:y,undo:uue(g,y)}}return{text:d,uri:s,code:l.code,explaination:o.slice(l.endLine).join(`
`).trim(),edits:p}}var IMe=new Set(["rust"]),Aj=class{constructor(e,r){this.testLocation=r;this.fileCache=new Nn;this.globallySeen=new Set;this._promise=new Yp;this.turnsUsed=0;this.tokensUsed=0;this.endpoint=e.endpoint,this.progress=e.progress,this.token=e.token,this.accessor=e.accessor,this.turnsBudget=e.turnsBudget,this.timeBudget=e.timeBudget,this.tokenBudget=e.tokenBudget,this.deadline=Date.now()+this.timeBudget;let n=e.accessor.get(ue);this.logger=n.getPromptResponseLogger("FailingTest"),this.genericLogger=n.getLogger("FailingTest"),this.gitRepo=e.accessor.safeGet(es)?.getExtensionApi()?.getRepository(this.testLocation.uri)||void 0}get promise(){return this._promise.p}get hasFoundSolution(){return this._promise.isResolved}get possibleExplanation(){return this._possibleExplanation}foundSolution(e){this._promise.complete(e)}gotPossibleExplanation(e,r){(!this._possibleExplanation||e.length>this._possibleExplanation.text.length)&&(this._possibleExplanation={text:e,references:r})}takeTurn(){return this.turnsUsed++,Date.now()+_Me>=this.deadline?0:Math.max(0,this.turnsBudget-this.turnsUsed)}throwIfCancelled(){if(this.token.isCancellationRequested||this.hasFoundSolution)throw new fo}async getSymbols(e){let r=this.accessor.get(De),n=this.accessor.get(dr).acquireTokenizer(this.endpoint.family),o=new Map,s=await this.getDefinitionLocations(e);this.throwIfCancelled();let a=new Set(s.flatMap(({links:u})=>u.map(l=>l.link.uri.fsPath))),c=new Set;if(this.gitRepo)try{c=await this.gitRepo.checkIgnore([...a])}catch{}for(let{keyword:u,links:l}of s)for(let{interest:d,link:p}of l){if(c.has(p.uri.fsPath)||await r.isCopilotIgnored(p.uri)||p.uri.toString()===this.testLocation.uri.toString()&&!IMe.has(hd(p.uri).languageId))continue;p.range.isEmpty&&(p.range=new Ge(p.range.start,p.range.end.with(p.range.start.line+5)));let f=new qr(p.range.start.line+1,1),m=p.range.isEmpty?new qr(f.lineNumber+10,1):new qr(p.range.end.line+1,p.range.end.character+1),h=[d,p.uri.toString(),p.range.start.line].join("\0");if(this.globallySeen.has(h))continue;let g=o.get(h);if(g){g.keywords.push(u);continue}try{let v=await this.readFile(p.uri);o.set(h,{keywords:[u],interest:d,uri:p.uri,start:f,end:m,tokensWithoutExpansion:n.tokenLength(v.source.slice(v.convert.positionToOffset(f),v.convert.positionToOffset(m))),...v}),this.progress.report(new qD(p))}catch{}}for(let u of o.keys())this.globallySeen.add(u);return[...o.values()]}async readFile(e){let r=this.fileCache.get(e);return r||(r=this.accessor.get(zr).readFile(e).then(n=>new TextDecoder().decode(n)).then(n=>({source:n,convert:new Zc(n)})),this.fileCache.set(e,r)),r}async getDefinitionLocations(e){let r=this.accessor.get(Ai);return Promise.all(e.map(async({keyword:n,interest:o,location:s})=>{let a=s.position.translate(0,n.length-1),c=s.uri,u=()=>r.getDefinitions(c,a).then(f=>f.length?f:r.getImplementations(c,a)).then(f=>f.length?{interest:"DEFINITION",link:f[0]}:void 0),l=()=>r.getImplementations(c,a).then(f=>f.length?f:r.getDefinitions(c,a)).then(f=>f.length?{interest:"IMPLEMENTATION",link:f[0]}:void 0),d=[];(o==="DEFINITION"||o==="BOTH")&&d.push(u()),(o==="IMPLEMENTATION"||o==="BOTH")&&d.push(l());let p=(await Promise.all(d)).filter(F_);return{keyword:n,links:p.map(f=>"targetUri"in f.link?{interest:f.interest,link:new hi(f.link.targetUri,f.link.targetRange)}:f)}}))}};var K4=class t{constructor(e,r,n){this.context=e;this.testFailure=r;this.testLocation=n}static create(e,r,n){let o=OA(r.task.messages,s=>s.location);return(!o||n.uri.toString()!==o.uri.toString())&&(o=n),new t(new Aj(e,n),r,n)}async tryGetInitialGitContext(){let e=this.context.accessor.get(dr).acquireTokenizer(this.context.endpoint.family),r=this.context.gitRepo;if(!r)return[];let n=[],o=await r.diffWithHEAD();return await Promise.all(o.map(async s=>{if(s.status===2||s.status===6)return;let[a,c]=await Promise.all([r.diffWithHEAD(s.uri.fsPath),this.context.readFile(s.uri)]);n.push(...await cue(e,c,s.uri,a))})),n}async climb(){let e=await sue(this.testLocation,this.testFailure.snapshot.label,this.context.accessor.get(zr),this.context.accessor.get(mt));if(!e)throw new Error("Could not find semantic information for the test location");let r=[];try{r=await this.tryGetInitialGitContext()}catch(s){this.context.genericLogger.warn("Could not get git context for test failure",s)}let n=await Promise.race([this.context.promise,this.climbInner(this.context,e,{symbols:[],activity:r,name:`"${this.testFailure.snapshot.label}"`,prefixTokens:0,tokens:0}).then(()=>({type:2,possibleSolution:this.context.possibleExplanation}),s=>{if(zp(s))return{type:1,possibleSolution:this.context.possibleExplanation};throw s})]);return this.context.accessor.get(me).sendMSFTTelemetryEvent("intent.fixTestFailure.outcome",{outcome:n.type===0?"solution":n.type===1?"cancelled":"nosolution",languageId:hd(this.testLocation.uri).languageId},{requestsMade:this.context.turnsUsed,tokenCount:this.context.tokensUsed}),n}async climbInner(e,r,n,o=!1){let{endpoint:s,progress:a,token:c,accessor:u}=this.context,l=u.get(me),d=u.get(Bt),p=n.name,f=e.takeTurn();o&&(f=0);let m=u.get(dr).acquireTokenizer(s.family),h=$e.create(u.get(te),s,$4,{testFailure:this.testFailure,chunk:r,tokenizer:m,parser:u.get(mt),references:[...n.activity,...n.symbols],turnsLeft:o?0:f}),g=await h.render();n.prefixTokens=g.tokenCount,n.tokens=n.prefixTokens+g.tokenCount,e.tokensUsed+=n.tokens,e.throwIfCancelled(),a.report(new ho(W4.t("Investigating the code around {0}",p))),e.logger.logPrompt(g.messages);let v=await d.fetchOne(g.messages,async S=>{},c,2,s,void 0,{temperature:.1,top_p:1,stop:["dontStopBelieving"]},{messageSource:"failingTestMeta"});if(e.throwIfCancelled(),e.logger.logResponse(v),v.type!=="success")throw l.sendMSFTTelemetryEvent("failingTestResolver.error",{type:v.type,reason:v.reason,requestId:v.requestId}),new Error(W4.t("Encountered an error while deciding what test information to collect: ({0}) {1}",v.type,v.reason));let y=[r,...h.getMeta(gR).chunks],b=await SMe(v.value,y,S=>this.context.readFile(S));if(b){e.foundSolution({type:0,references:g.references,solution:b});return}let _=oue(v.value,y);if(f>0){let S=await e.getSymbols(_);await this.chunkAndSendFollowups(e,r,S,n)}_.length||e.gotPossibleExplanation(v.value,g.references)}async chunkAndSendFollowups(e,r,n,o){let s=[],a=e.accessor.get(dr).acquireTokenizer(e.endpoint.family);for(let c of n){let u=s[s.length-1],l=c.tokensWithoutExpansion+a.tokenLength("```${tokenizer.tokenLength(symbol.chunk.file.toString())}");!u||l+u.tokens>e.tokenBudget?s.push({activity:o.activity,symbols:[...o.symbols,c],tokens:o.tokens+l,name:o.name,prefixTokens:o.prefixTokens}):(u.symbols.push(c),u.tokens+=l)}for(let c of s){let u=c.symbols.slice(o.symbols.length).flatMap(l=>l.keywords||[]);c.name=u.length>1?W4.t('"{0}" + {1} more symbols...',u[0],u.length-1):`"${u[0]}"`,await this.climbInner(e,r,c)}if(s.length===0)return this.climbInner(e,r,o,!0)}};var tg=class{constructor(e,r,n){this.instantiationService=e;this.testProvider=r;this.endpointProvider=n;this.id="fixTestFailure";this.locations=[1,2];this.description=rg.t("Propose a fix for the a test failure");this.commandInfo={defaultEnablement:!0,allowsEmptyArgs:!0}}static{this.ID="fixTestFailure"}get intentDetectionInput(){let e="fix_test_failure";return{disabled:!0,functionName:e,sampleQuestion:"This test failed, suggest how to fix it.",functionCallingBlurb:`If the user's message is related to generating code to fix test failures, you should use the '${e}' function.`}}async asSlashCommand(){if(this.testProvider.isEnabled.get()&&xs.first(this.testProvider.getAllFailures()))return{name:this.id,description:this.description}}async invoke(e){let r;(h=>(h[h.Any=0]="Any",h[h.SameDocument=1]="SameDocument",h[h.InViewRange=2]="InViewRange",h[h.InSelection=3]="InSelection"))(r||={});let n,o=0,s=e.documentContext?.document.uri.toString();for(let d of this.testProvider.getAllFailures())if(!n||!n.snapshot.uri||!n.snapshot.range)n=d;else if(d.snapshot.range&&d.snapshot.uri?.toString()===s&&(o<1&&(n=d,o=1),d.snapshot.range.intersection(e.documentContext.wholeRange)&&(n=d,o=2),d.snapshot.range.intersection(e.documentContext.selection))){n=d,o=3;break}if(!n)throw new Cw(rg.t("No test failures found."));let{range:a,uri:c}=n.snapshot;if(!c||!a)throw new Cw(rg.t("Tests have no associated editor location."));let u=e.location,l=await this.endpointProvider.getChatEndpoint("gpt-4");return this.instantiationService.createInstance(vR,this,l,u,n,{uri:c,range:a})}};tg=O([x(0,te),x(1,su),x(2,Le)],tg);var vR=class{constructor(e,r,n,o,s,a){this.intent=e;this.endpoint=r;this.location=n;this.testFailure=o;this.testLocation=s;this.instantiationService=a}async buildPrompt({history:e,query:r,chatVariables:n},o,s){let a=$e.create(this.instantiationService,this.endpoint,yR,{testFailure:this.testFailure,chatVariables:n,query:r,endpoint:this.endpoint,progress:o,chatLocation:this.location,location:this.testLocation,history:e}),c=await a.render(o,s),u=a.getMeta(Y4)?.value;u&&(this.lastSolutionForInterpreter={outcome:u,test:this.testFailure.snapshot});let l=a.getMeta(Q4)?.value;return{...c,references:l||c.references}}processResponseInline(e,r,n){let{outcome:o,test:s}=this.lastSolutionForInterpreter;return new Dj(s,o).processResponse(e,r,n)}};vR=O([x(5,te)],vR);var yR=class extends Q{constructor(r,n){super(r);this.accessor=n}async prepare(r,n,o=an.None){let{progress:s}=this.props,c=await K4.create({accessor:this.accessor,endpoint:this.props.endpoint,progress:s,token:o,tokenBudget:r.tokenBudget,timeBudget:1/0,turnsBudget:6},this.props.testFailure,this.props.location).climb();if(this.props.chatLocation===1)return{outcome:c};if(c.type===0)if(c.solution.edits){s.report(new Qi(new mo(c.solution.explaination))),s.report(new Jp(c.solution.uri,c.solution.edits.apply));let u=new ZT;u.set(c.solution.uri,c.solution.edits.apply);let l=new ZT;l.set(c.solution.uri,c.solution.edits.undo),s.report(new ew(vue(this.props.testFailure.snapshot,u,l)))}else s.report(new Qi(new mo(c.solution.text)));else c.possibleSolution?s.report(new Qi(new mo(c.possibleSolution.text))):c.type===1?(s.report(new Qi(hue())),s.report(new ew({command:"workbench.action.openSettings",title:rg.t("Go to Settings"),arguments:[{query:"github.copilot.config.testFixLimits"}]}))):s.report(new Qi(gue()));return{outcome:c}}render(r,n){return vscpp(vscppf,null,vscpp("meta",{value:new Y4(r.outcome)}),vscpp("meta",{value:new Q4(r.outcome.type===0?r.outcome.references:r.outcome.possibleSolution?.references||[])}))}};yR=O([x(1,je)],yR);var hue=()=>rg.t("Unfortunately I was unable to find a solution to this test failure in the time alloted. My time limit can be configured in your settings."),gue=()=>rg.t("Unfortunately I was unable to find a solution to this test failure. Please try providing more context."),Y4=class extends Wc{constructor(r){super();this.value=r}},Q4=class extends Wc{constructor(r){super();this.value=r}},Dj=class{constructor(e,r){this.test=e;this.solution=r}async processResponse(e,r,n){let o=this.solution||{type:1};if(o.type!==0){if(o.possibleSolution)return r.markdown(o.possibleSolution.text),{type:"conversational"};if(o.type===1)return r.markdown(hue()),{type:"conversational"};if(o.type===2)return r.markdown(gue()),{type:"conversational"}}let s=o.solution;if(!s.uri||!s.edits)return r.markdown(s.text),{type:"conversational"};let a=new ZT;a.set(s.uri,s.edits.apply);let c=new ZT;return c.set(s.uri,s.edits.undo),r.markdown(s.explaination),r.textEdit(s.uri,s.edits.apply),r.button(vue(this.test,a,c)),{type:"workspaceEdit"}}};function vue(t,e,r){return{title:rg.t("Apply and Rerun"),command:"github.copilot.tests.fixTestFailure.applyAndRerun",arguments:[t,e,r]}}var rS=class{constructor(e,r,n,o){this._intentService=e;this.instantiationService=r;this.endpointProvider=n;this.accessor=o;this.id="fix";this.locations=[1,2];this.description=yue.t("Propose a fix for the problems in the selected code");this.commandInfo=void 0}static{this.ID="fix"}get intentDetectionInput(){let e="fix_code_or_markdown";return{functionName:e,sampleQuestion:"There is a problem in this code. Rewrite the code to show it with the bug fixed.",functionCallingBlurb:`If the user's message appears related to fixing problems in the selected code, you should use the '${e}' function.`}}async invoke(e){if(this.shouldDelegateToTestFixer(this.accessor,e))return this._intentService.getIntent(tg.ID,e.location).invoke(e);let{location:r,documentContext:n,request:o}=e;if(!n)throw new Error("Open a file to fix an issue");let s=this.accessor.get(ye),a=this.accessor.get(Ut),c=await hB(r);if(r===2){let h=await this.endpointProvider.getChatEndpoint(c);return this.instantiationService.createInstance($h,this,r,h,eS,e.documentContext)}let u=o.attempt,l=await s.getExperimentBasedConfig(fe.FixInlineChatEndpoint,a);l||(l=c,u>0&&l==="gpt-3.5-turbo"&&(l="gpt-4"));let d=await this.endpointProvider.getChatEndpoint(l),p;$t(n.document.uri)&&n.document.languageId==="python"?p=Z1:p=J1;let f=u>1,m={useWorkspaceChunksFromSelection:f||await s.getExperimentBasedConfig(fe.FixUseWorkspaceChunksFromSelection,a),useWorkspaceChunksFromDiagnostics:!f&&await s.getExperimentBasedConfig(fe.FixUseWorkspaceChunksFromDiagnostics,a)};return this.instantiationService.createInstance(X1,this,r,d,p,n,m)}shouldDelegateToTestFixer(e,r){let n=e.safeGet(su);return!n?.isEnabled||r.documentContext?.selection.isEmpty===!1?!1:!!(r.location===1&&r.documentContext&&n.getFailureAtPosition(r.documentContext.document.uri,r.documentContext.selection.end)||n.lastResultsFrom&&Date.now()-n.lastResultsFrom<1e4&&!xs.isEmpty(n.getAllFailures()))}};rS=O([x(0,Da),x(1,te),x(2,Le),x(3,je)],rS);var X4=z(Qt());var nS=class{constructor(e,r){this.endpointProvider=e;this.instantiationService=r;this.id="newNotebook";this.description=X4.t("Create a new Jupyter Notebook");this.locations=[2];this.commandInfo={allowsEmptyArgs:!1,yieldsTo:[{command:"fix"},{command:"explain"},{command:"workspace"},{command:"tests"}],defaultEnablement:!0,sampleRequest:X4.t("How do I create a notebook to load data from a csv file?")}}static{this.ID="newNotebook"}get intentDetectionInput(){let e="create_new_jupyter_notebook";return{functionName:e,modelDescription:"Creates a new Jupyter Notebook for tasks such as data analysis, scientific computing, and machine learning.",sampleQuestion:"How do I create a notebook to load data from a csv file?",functionCallingBlurb:`If the user's message is related to creating a new Jupyter notebook for data analysis, scientific computing, and machine learning, you should use the '${e}' function.`}}async invoke(e){let r=e.location,n=await Mn(this.endpointProvider,r);return this.instantiationService.createInstance(bR,this,n,r)}};nS=O([x(0,Le),x(1,te)],nS);var bR=class{constructor(e,r,n,o){this.intent=e;this.endpoint=r;this.location=n;this.instantiationService=o;this.linkification={disable:!0}}async buildPrompt({history:e,query:r,chatVariables:n},o,s){return await $e.create(this.instantiationService,this.endpoint,KL,{query:r,history:e,chatVariables:n}).render(o,s)}processResponsePanel(e,r,n,o,s){return new XL().processResponse(e,r,n,o,s)}async commands(e){let r=(e.response?.message??"").replace(/\n/g,""),o=/```(?:json)?(.+)/g.exec(r);if(o)try{let s=o[1],a=s.indexOf("```"),c=a===-1?s:s.substring(0,a),u=JSON.parse(c);return Promise.resolve([{command:"github.copilot.newNotebook",arguments:[{turn:e,outline:u}],title:X4.t("Create Notebook")}])}catch{}return[]}};bR=O([x(3,te)],bR);var xR=z(Qt()),SR=z(require("path"));var bue="Review the currently selected code.",CMe=xR.t("local changes"),iS=class extends Oo{constructor(r,n,o,s,a,c,u,l,d){super(r,n,o);this.documentContext=s;this.instantiationService=a;this.workspaceService=c;this.tabsAndEditorsService=u;this.logService=l;this.gitExtensionService=d;this.linkification={additionaLinkifiers:[{create:()=>new Lj(this.documentContext.document.uri)}]}}async createRenderer({history:r,query:n,chatVariables:o},s,a,c){let u=[];if(n===CMe){let l=await Qr.getCurrentChanges(this.gitExtensionService,"workingTree");(await Promise.all(l.map(async p=>({document:await this.workspaceService.openTextDocument(p.uri),relativeDocumentPath:SR.default.relative(p.repository.rootUri.fsPath,p.uri.fsPath),change:p})))).map(p=>u.push(p))}else{let l=this.tabsAndEditorsService.activeTextEditor;l&&u.push({document:l.document,relativeDocumentPath:SR.default.basename(l.document.uri.fsPath),selection:l.selection})}return $e.create(this.instantiationService,s,$x,{query:n,history:r,chatVariables:o,input:u,logService:this.logService})}};iS=O([x(4,te),x(5,Je),x(6,kt),x(7,ue),x(8,es)],iS);var Nj=class extends iS{async buildPrompt(e,r,n){return e.query===""&&(e={...e,query:bue}),super.buildPrompt(e,r,n)}processResponseInline(e,r,n){return this.instantiationService.createInstance(_R,this.documentContext).processResponse(e,r,n)}},oS=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id="review";this.locations=[2,1];this.description=xR.t("Review the selected code in your active editor");this.intentDetectionInput={sampleQuestion:bue,disabled:!0}}static{this.ID="review"}async invoke(e){let r=e.documentContext,n=e.location,o=await this.endpointProvider.getChatEndpoint("gpt-4");return n===1?this.instantiationService.createInstance(Nj,this,n,o,r):this.instantiationService.createInstance(iS,this,n,o,r)}};oS=O([x(0,te),x(1,Le)],oS);var Lj=class{constructor(e){this.file=e}async linkify(e,r,n){let o=NH(e);if(!o.length)return;let s=0,a=0,c=[];for(let u of o)c.push(e.substring(a,u.linkOffset)),c.push(zL(e.substring(u.linkOffset,u.linkOffset+u.linkLength),this.file.with({fragment:String(u.from+1)}))),s++,a=u.linkOffset+u.linkLength;return c.push(e.substring(a)),{text:c.join(""),trustedCommands:[Wh],addedLinkCount:s}}},_R=class{constructor(e,r){this.documentContext=e;this.reviewService=r;this.updating=!1;this.text="";this.comments=[]}async processResponse(e,r,n){let o={promptCount:1,messageId:Br(),inputType:"selection",inputRanges:[{uri:this.documentContext.document.uri,ranges:[this.documentContext.selection]}]};for await(let a of e){if(this.text=a.text,!this.updating){this.updating=!0;let u=new mo(xR.t({message:`Reviewing your code...
`,comment:"{Locked='](command:workbench.panel.markers.view.focus)'}"}));u.isTrusted={enabledCommands:["workbench.panel.markers.view.focus"]},r.markdown(u)}let c=$w(o,[{document:this.documentContext.document,relativeDocumentPath:SR.default.basename(this.documentContext.document.uri.fsPath),selection:this.documentContext.selection}],this.text,!0);c.length>this.comments.length&&(this.reviewService.addReviewComments(c.slice(this.comments.length)),this.comments=c)}let s=$w(o,[{document:this.documentContext.document,relativeDocumentPath:SR.default.basename(this.documentContext.document.uri.fsPath),selection:this.documentContext.selection}],this.text,!1);return s.length>this.comments.length&&(this.reviewService.addReviewComments(s.slice(this.comments.length)),this.comments=s),r.markdown(xR.t("Reviewed your code and generated {0} suggestions.",s.length)),{type:"conversational"}}};_R=O([x(1,vo)],_R);var Oj=z(Qt());var _ue=z(Qt());var ng=class{constructor(e,r,n,o){this.stopStartMappings=e;this.processNonReportedDelta=r;this.experimentationService=n;this.configurationService=o;this.stagedDeltasToApply=[];this.currentStartStop=void 0;this._appliedText="";this.nonReportedDeltas=[];this._enableSnippyAnnotations=!1}async processResponse(e,r,n,o,s){return this._enableSnippyAnnotations=await this.configurationService.getExperimentBasedConfig(fe.ShowCodeMatches,this.experimentationService),this.doProcessResponse(n,o,s)}async doProcessResponse(e,r,n){for await(let{delta:o}of e){if(n.isCancellationRequested)break;this.applyDelta(o,r)}return this._appliedText}applyDeltaToProgress(e,r){let n=e.ipCitations;n?.length&&this._enableSnippyAnnotations&&n.forEach(s=>{let a=s.citations.license==="NOASSERTION"?_ue.t("unknown"):s.citations.license;r.codeCitation(dt.parse(s.citations.url),a,s.citations.snippet)});let o=e.codeVulnAnnotations?.map(s=>({title:s.details.type,description:s.details.description}));o?.length?r.markdownWithVulnerabilities(e.text??"",o):e.text&&r.markdown(e.text)}updateStagedDeltasUpToIndex(e,r){let n=[];for(let o=0;o<e+r;){let s=this.stagedDeltasToApply.shift();if(s){if(o+s.text.length<=e)n.push(s);else if(o<e||o<e+r){if(o<e){let c={...s};c.text=s.text.substring(0,e-o),n.push(c)}let a={...s};a.text=s.text.substring(e-o+r),a.text&&this.stagedDeltasToApply.unshift(a)}o+=s.text.length}else break}return n}checkForKeyWords(e,r,n){let o=this.stagedDeltasToApply.map(s=>s.text).join("")+r.text;for(let s of e){let a=o.indexOf(s);if(a===-1)continue;return this.stagedDeltasToApply.push(r),this.updateStagedDeltasUpToIndex(a,s.length).forEach(u=>n(u)),s}for(let s of e)for(let a=s.length-1;a>0;a--){let c=s.substring(0,a);if(o.endsWith(c)){this.stagedDeltasToApply=[...this.stagedDeltasToApply,r];return}}[...this.stagedDeltasToApply,r].forEach(s=>{n(s)}),this.stagedDeltasToApply=[]}postReportRecordProgress(e){this.nonReportedDeltas.push(e)}applyDelta(e,r){if(this._appliedText+=e.text,this.currentStartStop===void 0){let n=this.checkForKeyWords(this.stopStartMappings.map(o=>o.stop),e,o=>this.applyDeltaToProgress(o,r));n&&(this.currentStartStop=this.stopStartMappings.find(o=>o.stop===n));return}else{if(!this.currentStartStop.start)return;this.checkForKeyWords([this.currentStartStop.start],e,this.postReportRecordProgress.bind(this))&&(this.processNonReportedDelta&&this.processNonReportedDelta(this.nonReportedDeltas).forEach(s=>this.applyDeltaToProgress({text:s},r)),this.currentStartStop=void 0,this.stagedDeltasToApply.length>0&&this.applyDelta({text:""},r))}}};ng=O([x(2,Ut),x(3,ye)],ng);var Z4=z(at());var J4=class extends Q{render(e,r){let{query:n,history:o}=this.props.promptContext;return vscpp(vscppf,null,vscpp(Z4.SystemMessage,{priority:1e3},"You are a VS Code search expert who helps to write search queries for text in a workspace. Users want to search across a whole workspace. Your response will contain parameters to use in the search that targets what the user wants.",vscpp("br",null),vscpp(Hr,null),vscpp(yi,null),vscpp(Di,null),vscpp(cr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"The user's question is ALWAYS related to search or replace. When the user's question does not seem to be related to searching or replacing, you MUST assume that they're searching for or replacing what they are describing.",vscpp("br",null),`For example, if the user says "emojis", try appending "I'm looking for _____" to the beginning (e.g. I'm looking for emojis) to make more sense of it.`,vscpp("br",null),vscpp("br",null),"For all valid questions, you MUST respond with a JSON object with search parameters to use.",vscpp("br",null),'- Your answer MUST wrap the JSON object in "[ARGS START]" and "[ARGS END]". "[ARGS START]" must be on a new line.',vscpp("br",null),'- Your answer MUST have an explanation in full, human-readable sentences. This goes before the "[ARGS START]" line.',vscpp("br",null),vscpp("br",null),'If you put a regex in the "query" parameter, make sure to set "isRegex" to true.',vscpp("br",null),'If you put a regex in the "query" parameter, do not start and/or end with forward slashes to denote a regex literal.',vscpp("br",null),"You MUST NOT give an answer with an empty-string query parameter.",vscpp("br",null),vscpp("br",null),'The "replace" string will be used to replace the query-matched search results.',vscpp("br",null),vscpp("br",null),'If you want to target certain files, set "filesToInclude" to a glob pattern. DO NOT assume the "filesToInclude" and "filesToExclude" without being very sure that the user wants to target these files!',vscpp("br",null),vscpp("br",null),'If the query is case sensitive, set "isCaseSensitive" to true.',vscpp("br",null),vscpp("br",null),"By default, all string fields are the empty string, and all boolean fields are false. Only list the fields you want to change.",vscpp("br",null),vscpp("br",null),"You should write the JSON object of the search parameters in the following format:",vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": ...,',vscpp("br",null),'	"replace": ...,',vscpp("br",null),'	"filesToInclude": ...,',vscpp("br",null),'	"filesToExclude": ...,',vscpp("br",null),'	"isRegex": ...,',vscpp("br",null),'	"isCaseSensitive": ...,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"Examples:",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Search for 'foo' in all files under my 'src' directory.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"Populate the query field with 'foo' and specify the files to include as 'src/'.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "foo",',vscpp("br",null),'	"filesToInclude": "src" ,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Find all CamelCase words in all files under the 'src/extensions' directory.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"Perform a regex search for camelCase variables by checking for any word that has a lowercase letter followed by an uppercase letter, followed by any number of lowercase letters. You can use `\\b[a-z]+[A-Z][a-z]+\\b` to acheive this.",vscpp("br",null),"This must be case-sensitive since the capitalization of the letters in our regex matters.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "\\\\b[a-z]+[A-Z][a-z]+\\\\b",',vscpp("br",null),'	"filesToInclude": "src/extensions" ,',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),'	"isCaseSensitive": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Find all hex color codes in css files",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"Perform a search for 6-digit or 3-digit hex color codes using the regex `#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})\\b`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})\\\\b",',vscpp("br",null),'	"filesToInclude": "*.css" ,',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Find all HTTPS links in markdown.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"Search all URLs that have the HTTPS protocol in a markdown file. Make sure to include all valid URL characters in their respective places. This regex should achieve this: `https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_\\+.~#()?&//=]*)`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "https?:\\\\/\\\\/(www\\\\.)?[-a-zA-Z0-9@:%._\\\\+~#=]{2,256}\\\\.[a-z]{2,6}\\\\b([-a-zA-Z0-9@:%_\\\\+.~#()?&//=]*)",',vscpp("br",null),'	"filesToInclude": "*.md" ,',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Replace all YYYY-MM-DD dates with MM/DD/YYYY dates. Don't do this in typescript files.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"You will need to use the regex `(\\d{4})-(\\d{2})-(\\d{2})` to match the YYYY-MM-DD date format. Then, you will need to use the replace string `$2/$3/$1` to replace the date with the MM/DD/YYYY format.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "(\\\\d{4})-(\\\\d{2})-(\\\\d{2})",',vscpp("br",null),'	"replace: "$2/$3/$1",',vscpp("br",null),'	"filesToExclude": "*.ts",',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"Replace all camel case variable names with snake case variable names.",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"To replace all camel case variables with snake case, we will need to:",vscpp("br",null),"1. Find all sequences of lowercase letters succeeded by uppercase letters. Use `([a-z]+)([A-Z])` to capture these sequences.",vscpp("br",null),"2. Separate them with an underscore character. `$1_$2` does this.",vscpp("br",null),"3. Convert both characters to lowercase. Adjust the previous replace text to be `\\l$1_\\l$2`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "([a-z]+)([A-Z])",',vscpp("br",null),'	"replace: "\\\\l$1_\\\\l$2",',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),'	"isCaseSensitive": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"alphanumeric",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"To find all alphanumeric characters, you can use the regex `[a-zA-Z0-9]`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "[a-zA-Z0-9]",',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),'	"isCaseSensitive": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"link",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"To find all web links, use the regex `https?:\\/\\/\\S+`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "https?:\\\\/\\\\/\\\\S+",',vscpp("br",null),'	"isRegex": true,',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),'Search for actionbar files outside of my "extensions" directoy',vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),"To do this, use the query `actionbar` in all files except the ones in `extensions`.",vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "actionbar",',vscpp("br",null),'	"filesToExclude": "extensions",',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null),vscpp("br",null),"### Question:",vscpp("br",null),"typescript for loop",vscpp("br",null),vscpp("br",null),"### Answer:",vscpp("br",null),'To look for "for" loops in most languages, use the query `for\\s*\\(`.',vscpp("br",null),vscpp("br",null),"[ARGS START]",vscpp("br",null),"```json",vscpp("br",null),"{",vscpp("br",null),'	"query": "for\\s*\\(",',vscpp("br",null),'	"isRegex: true,',vscpp("br",null),'	"filesToInclude: "*.ts"',vscpp("br",null),"}",vscpp("br",null),"```",vscpp("br",null),"[ARGS END]",vscpp("br",null)),vscpp(Lt,{priority:600,history:o}),vscpp(Mo,{priority:700}),vscpp(Nr,{priority:800,document:this.props.document,range:this.props.selection}),vscpp(Z4.UserMessage,{priority:900},n))}};function EMe(t){if(!t)return[];let e=[],r={query:t.query??"",replace:t.replace??"",filesToInclude:t.filesToInclude??"",filesToExclude:t.filesToExclude??"",isRegex:t.isRegex??!1,isCaseSensitive:t.isRegex??!1};return e.push({command:"github.copilot.executeSearch",arguments:[r],title:Oj.t("Search")}),e}function xue(t){let e=Cs(t).at(0),r;if(e){let n;try{n=Yh(e.code)}catch{}n&&(r=n)}return r}function TMe(t){if(!t)return[];let e=[`| Parameter  | Value |
`,`| ------ | ----- |
`];for(let[r,n]of Object.entries(t)){if(n==="")continue;let o=n;(typeof n=="string"||n instanceof String)&&(o=n.replace(/\|/g,"\\|")),e.push(`| ${r} | \`${o}\` |
`)}return e.push(`
`),e}var wMe="Search for 'foo' in all files under my 'src' directory",IR=class extends Oo{constructor(r,n,o,s){super(r,n,o);this.instantiationService=s}createRenderer(r,n,o,s){return $e.create(this.instantiationService,n,J4,{promptContext:r})}processResponsePanel(r,n,o,s,a){return this.instantiationService.createInstance(ng,[{start:"[ARGS END]",stop:"[ARGS START]"}],u=>TMe(xue(u.join("")))).processResponse(r,n,o,s,a)}async commands(r){let n=xue(r.response?.message??"");return EMe(n)}};IR=O([x(3,te)],IR);var sS=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id="search";this.locations=[2];this.description=Oj.t("Generate query parameters for workspace search");this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:Ta}}static{this.ID="search"}get intentDetectionInput(){let e="vscode_search";return{disabled:!0,functionName:e,sampleQuestion:wMe,functionCallingBlurb:`If the user's message is related to generating search query parameters for running a file search, you should use the '${e}' function.`}}async invoke(e){let r=e.location,n=await Mn(this.endpointProvider,r);return this.instantiationService.createInstance(IR,this,r,n)}};sS=O([x(0,te),x(1,Le)],sS);var ER=z(Qt());var CR=class extends Oo{constructor(r,n,o,s,a){super(r,n,o);this.accessor=s;this.instantiationService=a}async createRenderer({query:r,history:n},o,s,a){let c=await Hw(this.accessor,1e3,a);return $e.create(this.instantiationService,o,M1,{query:r,history:n,fileTree:c})}processResponsePanel(r,n,o,s,a){return new Mj(this.accessor,this.endpoint).processResponse(r,n,o,s,a)}};CR=O([x(3,je),x(4,te)],CR);var ig=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id=ig.ID;this.locations=[2];this.description=ER.t("Find relevant code to your query");this.commandInfo={allowsEmptyArgs:!1,defaultEnablement:!1};this.intentDetectionInput={sampleQuestion:"Where is the toolbar code?",disabled:!0}}static{this.ID="semanticSearch"}async invoke(e){let r=e.location,n=await Mn(this.endpointProvider,r);return this.instantiationService.createInstance(CR,this,r,n)}};ig=O([x(0,te),x(1,Le)],ig);var Mj=class{constructor(e,r){this.accessor=e;this.endpoint=r}async processResponse(e,r,n,o,s){let a=r[r.length-1].content,c=0,u="";for await(let{delta:d}of n)c+=d.text.length,u+=d.text;o.progress(ER.t("Looking for relevant code"));let l=Vx(a,u);return RMe(this.accessor,this.endpoint,a,l,s).then(d=>kMe(this.accessor,d,o))}};async function RMe(t,e,r,n,o){let s=t.get(Oh),a=await Fx(t,{valueFor4096:8,maxMultiplier:4});return sj(s,e,r,n,a,o,!0)}function kMe(t,e,r){if(e.length===0){let s=ER.t(`No relevant code found. Please be more specific.
`);return r.markdown(s),s}r.markdown(ER.t(`Here is some relevant code:

`));let n=t.get(Je),o="";for(let s of e)o+=PMe(s,r,n);return o}function PMe(t,e,r){let n=[],s=`## ${O0(r,t.file)}

`;return e.markdown(s),n.push(s),t.locations.forEach(a=>{let c={uri:t.file,range:Rh(a.range)},u=a.range.startLineNumber,l=a.range.endLineNumber,d=u+1===l?`Line ${u+1}`:`Lines ${u+1}-${l}`;e.markdown("- "),e.anchor(c,d),e.markdown(`

`),n.push(d+`

`),e.markdown(a.code+`
`),n.push(a.code+`
`)}),n.join("")}var Iue=z(Qt());var uy=z(at());var eO=class extends Q{render(e){let{query:r,history:n,chatVariables:o,customInstructions:s}=this.props.promptContext;return vscpp(vscppf,null,vscpp(uy.SystemMessage,{priority:1e3},"You are a programmer who specializes in using the command line. Your task is to help the Developer craft a command to run on the command line.",vscpp("br",null),vscpp(Hr,null),vscpp(Zt,null),vscpp(Di,null),vscpp(cr,null),vscpp("br",null),"Additional Rules",vscpp("br",null),"Think step by step:",`
1. Read the provided relevant workspace information (file names, project files in the project root) to understand the user's workspace.`,`
2. Generate a response that clearly and accurately answers the user's question. In your response, follow the following:
    - Prefer single line commands.
    - Omit an explanation unless the suggestion is complex, if an explanation is included then be concise.
    - Provide the command suggestions using the active shell and operating system.
    - When there is text that needs to be replaced in the suggestion, prefix the text with '{', suffix the text with '}' and use underscores instead of whitespace. Only do this when the replacement text is NOT provided.
    - Say "I'm not quite sure how to do that." when you aren't confident in your explanation`,Sue(this.props.shellType)?"\n    - Prefer idiomatic PowerShell over aliases for other shells or system utilities. For example use `Stop-Process` or `Get-NetTCPConnection` instead of `kill` or `lsof` respectively.\n	- Only use unix utilities when there is no PowerShell equivalent.\n    - Prefer cross-platform PowerShell scripting that works on any operating system.":`
    - Only use a tool like python or perl when it is not possible with the shell.`,`
3. At the end of the response, list all text that needs to be replaced with associated descriptions in the form of a markdown list
`.trim(),vscpp("br",null)),vscpp(uy.SystemMessage,{priority:700},"Examples:",vscpp("br",null),AMe(this.props.shellType)),vscpp(Lt,{flexGrow:1,priority:600,history:n}),vscpp(uy.UserMessage,{flexGrow:1,priority:750},vscpp(Yr,{customInstructions:s})),vscpp(uy.UserMessage,{flexGrow:1,priority:800},"The active terminal's shell type is:",vscpp("br",null),this.props.shellType),vscpp(uy.UserMessage,{flexGrow:1,priority:800},"The active operating system is:",vscpp("br",null),this.props.osName),vscpp(Kr,{flexGrow:2,priority:900,chatVariables:o,query:r}))}};function AMe(t){let e=['User: How do I revert a specific commit?\nAssistant:\n```sh\ngit revert {commit_id}\n```\n\nUser: How do I commit in git?\nAssistant:\n```sh\ngit commit -m "{message}"\n```'];switch(Sue(t)||e.push("User: go to the foo dir\nAssistant:\n```sh\ncd foo\n```"),t){case"ps1":case"pwsh":case"powershell":{e.push("User: go to the foo dir\nAssistant:\n```pwsh\ncd .\\foo\\\n```\n\nUser: How do I delete a directory?\nAssistant:\n```pwsh\nRemove-Item {dir_name}\n```\n\nUser: create a file called foo\nAssistant:\n```pwsh\nNew-Item -ItemType File -Name foo\n```");break}case"bash":{e.push("User: Print all files starting with \"pre\"\n```bash\nfind . -type f -name 'pre*'\n```");break}default:{e.push("\nUser: How do I print all files recursively within a directory?\nAssistant:\n```sh\nls -lR\n```");break}}return e.join(`

`)}function Sue(t){return t==="ps1"||t==="pwsh"||t==="powershell"}var og=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.locations=[2];this.id=og.ID;this.description=Iue.t("Ask how to do something in the terminal");this.commandInfo=void 0}static{this.ID="terminal"}get intentDetectionInput(){let e="terminal_questions";return{functionName:e,sampleQuestion:"How do I list files in the terminal",functionCallingBlurb:`If the user's message is about how to do something in the terminal, you should use the '${e}' function.`}}async invoke(e){let r=e.location,n=await Mn(this.endpointProvider,r);return this.instantiationService.createInstance(TR,this,n,r)}};og=O([x(0,te),x(1,Le)],og);var TR=class{constructor(e,r,n,o,s,a){this.intent=e;this.endpoint=r;this.location=n;this.instantiationService=o;this.envService=s;this.terminalService=a}async buildPrompt(e,r,n){let o=this.envService.OS,s=this.terminalService.terminalShellType;return await $e.create(this.instantiationService,this.endpoint,eO,{promptContext:e,osName:o,shellType:s}).render(r,n)}async followUps(e){let r="Explain the suggested command",n=!1,o=e.response?.message;if(o){let a=Cs(o);if(a.length===0)return[];a.length===1?r=`Explain this command:

${s(a[0])}`:(n=!0,r=`Explain these commands:${a.map(c=>`

${s(c)}`).join("")}`)}return[{prompt:r,label:n?"Explain the suggested commands":"Explain the suggested command"}];function s(a){return`${a.startMarkup}${a.language}
${a.code.trim()}
${a.startMarkup}`}}};TR=O([x(3,te),x(4,Rt),x(5,eo)],TR);var Aue=z(Qt());var aS={location:"sameFolder",prefix:"test_",suffixes:[".test",".spec","_test","Test","_spec","_test","Tests",".Tests","Spec"]},cS={csharp:{suffixes:["Test"],location:"testFolder"},dart:{suffixes:["_test"],location:"testFolder"},go:{suffixes:["_test"],location:"sameFolder"},java:{suffixes:["Test"],location:"testFolder"},javascript:{suffixes:[".test",".spec"],location:"sameFolder"},javascriptreact:{suffixes:[".test",".spec"],location:"sameFolder"},kotlin:{suffixes:["Test"],location:"testFolder"},php:{suffixes:["Test"],location:"testFolder"},powershell:{suffixes:[".Tests"],location:"testFolder"},python:{prefix:"test_",location:"testFolder"},ruby:{suffixes:["_test","_spec"],location:"testFolder"},rust:{suffixes:[""],location:"testFolder"},swift:{suffixes:["Tests"],location:"testFolder"},typescript:{suffixes:[".test",".spec"],location:"sameFolder"},typescriptreact:{suffixes:[".test",".spec"],location:"sameFolder"}},DMe={cs:"csharp",dart:"dart",go:"go",java:"java",js:"javascriptreact",kt:"kotlin",php:"php",ps1:"powershell",py:"python",rb:"ruby",rs:"rust",swift:"swift",ts:"typescript",tsx:"typescriptreact"},NMe=function(){let t={};for(let[e,r]of Object.entries(DMe))t[e]=cS[r];return t}(),uS=class{constructor(e,r){this._search=e;this._tabs=r}_findTabMatchingPattern(e){return this._tabs.tabs.find(n=>n.uri&&n.uri.scheme!==cn.untitled&&gL(n.uri,e))?.uri}async findTestFileForSourceFile(e,r){if(e.isUntitled)return;let n=zc(e.uri),o=uc(e.uri),s=cS[e.languageId]??aS,a=[];if(s.prefix&&a.push(s.prefix+n),s.suffixes)for(let l of s.suffixes??[]){let d=n.replace(`${o}`,`${l}${o}`);a.push(d)}let c=a.length===1?`**/${a[0]}`:`**/{${a.join(",")}}`,u=this._findTabMatchingPattern(c);return u||(u=await this._search.findFilesWithDefaultExcludes(c,1,r)),u}async findAnyTestFileForSourceFile(e,r){let n=cS[e.languageId]??aS,o=[];if(n.prefix&&o.push(`${n.prefix}*`),n.suffixes){let c=uc(e.uri);for(let u of n.suffixes??[])o.push(`*${u}${c}`)}let s=o.length===1?`**/${o[0]}`:`**/{${o.join(",")}}`,a=this._findTabMatchingPattern(s);return a||(a=await this._search.findFilesWithDefaultExcludes(s,1,r)),a}async findFileForTestFile(e,r){let n=cS[e.languageId]??aS,o=zc(e.uri),s=[];n.suffixes&&s.splice(0,0,...n.suffixes),n.prefix&&s.splice(0,0,n.prefix);for(let a of s){let c=o.replace(a,"");if(c!==o){let u=`**/${c}`,l=this._findTabMatchingPattern(u);if(l||(l=await this._search.findFilesWithDefaultExcludes(u,1,r)),l)return l}}}};function lS(t){let e;dt.isUri(t)||(e=cS[t.languageId],t=t.uri);let r=zc(t),n=uc(t);return e??=NMe[n.replace(".","")],e?!(e.suffixes&&!e.suffixes.some(s=>r.endsWith(s+n))||e.prefix&&!r.startsWith(e.prefix)):!!(aS.suffixes.some(s=>r.endsWith(s+n))||r.startsWith(aS.prefix))}function Cue(t){let e=cS[t.languageId]??aS,r=zc(t.uri);if(e.prefix)return e.prefix+r;let n=uc(t.uri),o=e.suffixes&&e.suffixes.length>0?e.suffixes[0]:".test";return r.replace(`${n}`,`${o}${n}`)}function Eue(t){let e=Zre(t.uri,"..");if(t.languageId==="java"){let r=e.path;if(r.includes("/src/main/")){let n=r.replace("/src/main/","/src/test/");return e.with({path:n})}}return e}var kR=z(at()),wue=z(require("assert"));var wR=z(at());var dS=class extends Q{constructor(r,n,o){super(r);this.parserService=n;this.workspaceService=o}async render(r,n,o,s){let{kind:a,testExampleFile:c}=this.props,u;try{u=await this.workspaceService.openTextDocument(c)}catch{return}let l=await Rw(this.parserService,u,void 0,new Ge(0,0,0,0),n.tokenBudget),d=[new wR.PromptReference(c)];switch(a){case"candidateTestFile":return vscpp(wR.UserMessage,null,vscpp("references",{value:d}),"Excerpt of the existing test file:",vscpp("br",null),vscpp(Oe,{uri:c,code:l.text,languageId:l.languageId}),vscpp("br",null),"Because a test file exists: ",vscpp("br",null),"- Do not generate preambles, like imports, copyright headers etc.",vscpp("br",null),"- Do generate code that can be appended to the existing test file.");case"anyTestFile":return vscpp(wR.UserMessage,null,"This is a sample test file:",vscpp("br",null),vscpp(Oe,{uri:c,code:l.text,languageId:l.languageId}))}}};dS=O([x(1,mt),x(2,Je)],dS);var Tue=require("util");var tO=ae("ITestDepsResolver"),pS=class{constructor(e,r){this._searchService=e;this._fileSystemService=r;this._perLanguageTestDepsFinder=new Map;this._cachedResults=new Map,this._textDecoder=new Tue.TextDecoder}async getTestDeps(e){let r=this._cachedResults.get(e);if(r!==void 0)return r;let n=this.getTestDepsFinder(e);if(n===void 0)return[];let o=await n.findTestDeps();return this._cachedResults.set(e,o),o}getTestDepsFinder(e){let r=this._perLanguageTestDepsFinder.get(e);if(r===void 0)switch(e){case"javascript":case"javascriptreact":case"typescript":case"typescriptreact":{r=new Fj(this._searchService,this._fileSystemService,this._textDecoder);break}case"python":{r=new Uj(this._searchService,this._fileSystemService,this._textDecoder);break}case"java":{r=new Bj(this._searchService,this._fileSystemService,this._textDecoder);break}}return r!==void 0&&this._perLanguageTestDepsFinder.set(e,r),r}};pS=O([x(0,Kc),x(1,zr)],pS);var Fj=class{constructor(e,r,n){this._searchService=e;this._fileSystemService=r;this._textDecoder=n;this._jsTsTestDeps=new Set(["mocha","jest","chai","ava","jasmine","qunit","tape","cypress","puppeteer","enzyme","testing-library","sinon","supertest","happy-dom"])}async findTestDeps(){let e=await this._searchService.findFiles("**/package.json",{exclude:"**/node_modules/**",useDefaultExcludes:!0});return(await Promise.allSettled(e.map(async n=>{let o=await this._fileSystemService.readFile(n),s=JSON.parse(this._textDecoder.decode(o)),a=s.dependencies||{},c=s.devDependencies||{};return[a,c].flatMap(l=>Object.keys(l).filter(d=>this._jsTsTestDeps.has(d)))}))).flatMap(n=>n.status==="fulfilled"?n.value:[])}},Uj=class{constructor(e,r,n){this._searchService=e;this._fileSystemService=r;this._textDecoder=n;this._pyTestDeps=["pytest","nose","unittest","tox","doctest","hypothesis","mock","coverage","behave","robotframework"]}async findTestDeps(){let e=new Set,r=["pyproject.toml","setup.py","requirements.txt","tox.ini"],n=await this._searchService.findFiles(`**/{${r.join(",")}}`);return await Promise.all(n.map(async o=>{let s=await this._fileSystemService.readFile(o),a=this._textDecoder.decode(s);o.path.endsWith("pyproject.toml")?this._getPyProjectTomlDeps(a).forEach(u=>e.add(u)):o.path.endsWith("setup.py")?this._getSetupPyDeps(a).forEach(u=>e.add(u)):o.path.endsWith("requirements.txt")?this._getRequirementsTxtDeps(a).forEach(u=>e.add(u)):o.path.endsWith("tox.ini")&&e.add("tox")})),Array.from(e)}_getPyProjectTomlDeps(e){return this._pyTestDeps.filter(r=>e.includes(r))}_getSetupPyDeps(e){return this._pyTestDeps.filter(r=>e.includes(r))}_getRequirementsTxtDeps(e){return this._pyTestDeps.filter(r=>e.includes(r))}},Bj=class{constructor(e,r,n){this._searchService=e;this._fileSystemService=r;this._textDecoder=n;this._javaTestDeps=["junit","testng","mockito","assertj","hamcrest","powermock","spock","cucumber","arquillian","selenium","rest-assured","wiremock","pitest"]}async findTestDeps(){let e=new Set,r=["pom.xml","build.gradle","build.gradle.kts"],n=await this._searchService.findFiles(`**/{${r.join(",")}}`);return await Promise.all(n.map(async o=>{let s=await this._fileSystemService.readFile(o),a=this._textDecoder.decode(s);this._javaTestDeps.filter(c=>a.includes(c)).forEach(c=>e.add(c))})),Array.from(e)}};var fS=class{constructor(e,r,n,o,s,a,c,u,l,d){this.intent=e;this.endpoint=r;this.location=n;this.documentContext=o;this.instantiationService=s;this.workspaceService=a;this.ignoreService=c;this.searchService=u;this.tabsAndEditorsService=l;this._parserService=d}get existingTestFile(){return this._existingTestFile}async buildPrompt({query:e,history:r,chatVariables:n},o,s){(0,wue.default)(!lS(this.documentContext.document),"TestFromSourceInvocation should not be invoked from a test file");let a=await this.findTestFileForSourceFile(s);return a!==null&&a.kind==="candidateTestFile"&&(this._existingTestFile=a.testExampleFile),await $e.create(this.instantiationService,this.endpoint,RR,{history:r.at(-1)?.request.message,chatVariables:n,context:this.documentContext,endpoint:this.endpoint,userQuery:e,location:this.location,testExampleFile:a}).render(o,s)}async processResponseInline(e,r,n){let o=this.documentContext.document;if(this.existingTestFile===void 0){let s=Cue(o),a=Eue(o),c=Ur.joinPath(a,s).with({scheme:cn.untitled}),u=new Ge(0,0,0,0),l=new hc("",Wr.empty,o.languageId);return{...await new wh(c,l,this.documentContext.fileIndentInfo,bd.Emit,1,(f,m)=>new Ch(m,u.start,f),vi.createCodeBlockClassifier(),f=>!0).processResponse(e,r,n),type:"workspaceEdit"}}else{let s=this.existingTestFile,a=await this.workspaceService.openTextDocument(s),c=this._parserService.getTreeSitterAST(a),u=c?await c.findLastTest():null,l;if(u===null)l=new Ge(a.lineCount,0,a.lineCount,0);else{let g=a.positionAt(u.endIndex),v=g.line+1;l=new Ge(g.line,g.character,v,0)}let p=(await Pa(this._parserService,a,this.documentContext.fileIndentInfo,l,a.getText().length)).splitAroundOriginalSelectionEnd(),f="$PLACEHOLDER$";return{...await p.createReplyInterpreter(ka.chain(g=>Zs(g,"`"+f+"`","selection"),g=>Zs(g,f,"selection")),1,p.insertStreaming,vi.createCodeBlockClassifier(),g=>g.value.trim()!==f).processResponse(e,r,n),type:"workspaceEdit"}}}async findTestFileForSourceFile(e){let r=this.ignoreService,n=new uS(this.searchService,this.tabsAndEditorsService),o,s=await n.findTestFileForSourceFile(this.documentContext.document,e??an.None);if(e.isCancellationRequested)return null;if(s!==void 0)o="candidateTestFile";else{let a=await n.findAnyTestFileForSourceFile(this.documentContext.document,e??an.None);if(e.isCancellationRequested)return null;o="anyTestFile",s=a}return s===void 0||await r.isCopilotIgnored(s)?null:{kind:o,testExampleFile:s}}};fS=O([x(4,te),x(5,Je),x(6,De),x(7,Kc),x(8,kt),x(9,mt)],fS);var RR=class extends Q{constructor(r,n,o){super(r);this.parserService=n;this.testDepsResolver=o}async render(r,n){let{history:o,context:s,userQuery:a,location:c,testExampleFile:u,chatVariables:l}=this.props,d=this.parserService.getTreeSitterAST(s.document),p=s.selection,f,m;if(d!==void 0){let I=await d.getNodeToDocument(Ji(s.selection,s.document));p=Xs(s.document,I.nodeToDocument),f=I.nodeIdentifier,m=I.nodeToDocument.type}let h=["typescript","typescriptreact"].includes(s.document.languageId)&&m!==void 0&&["class_declaration","method_definition"].includes(m)?{costFnOverride:(I,T)=>I.kind==="constructor"||I.kind==="method_definition"?0:T}:void 0,g=await Rw(this.parserService,s.document,s.fileIndentInfo,p,n.tokenBudget/2,h),v=await this.testDepsResolver.getTestDeps(this.props.context.document.languageId),y=s.language.languageId,b=f?`\`${f}\``:"my code",_=l.substituteVariablesWithReferences(a),S=`Please, generate tests for ${b}. ${_}`.trim();return vscpp(vscppf,null,vscpp(kR.SystemMessage,{priority:1e3},"You are an AI programming assistant.",vscpp("br",null),vscpp(Hr,null),vscpp("br",null),vscpp(Zt,null),vscpp("br",null),c===1?vscpp(vscppf,null,"The user has a ",y," file opened in a code editor.",vscpp("br",null),"The user includes some code snippets from the file.",vscpp("br",null),"Answer with a single ",y," code block."):c===2?vscpp(vscppf,null,"First think step-by-step - describe your plan for what to build in pseudocode, written out in great detail.",vscpp("br",null),"Then output the code in a single code block.",vscpp("br",null),"Minimize any other prose.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn."):void 0,v.length>0&&vscpp(vscppf,null,vscpp("br",null),"The project has following testing dependencies: ",v.join(", "),".")),o!==void 0&&o.length>0&&vscpp(kR.UserMessage,{priority:700},o),vscpp(Ts,{priority:750,chatVariables:l}),u!==null&&vscpp(dS,{priority:750,...u}),vscpp(kR.UserMessage,{priority:900},"Here is the current file at `",s.document.uri.path,"`:",vscpp("br",null),vscpp("br",null),vscpp(Oe,{uri:s.document.uri,languageId:s.document.languageId,code:g.text}),vscpp("br",null),vscpp("br",null),S))}};RR=O([x(1,mt),x(2,tO)],RR);var PR=z(at());var Rue=z(at()),kue=require("util");var mS=class extends Q{constructor(r,n,o,s,a,c,u){super(r);this.accessor=n;this.searchService=o;this.tabsAndEditorsService=s;this.fileSystemService=a;this.ignoreService=c;this.workspaceService=u}async prepare(r,n,o){let{documentContext:s,endpointInfo:a}=this.props;if(!lS(s.document))return;let u=await new uS(this.searchService,this.tabsAndEditorsService).findFileForTestFile(s.document,o??an.None);if(u===void 0||await this.ignoreService.isCopilotIgnored(u))return;let l=a.modelMaxPromptTokens*4/3;function d(f,m,h=l){return`${wa.forUri(s.language,f)}

${m.substring(0,h)}`}let p;try{let f=await this.workspaceService.openTextDocument(u),m=f.getText(),h=await bse(this.accessor,f,100),{outlineAbove:g,outlineBelow:v}=Kae(m,h,{startOffset:m.length,endOffset:m.length},""),y=`${g}
${v}`;p=new mo(`
This is an excerpt of the file that this test is covering:

`),p.appendCodeblock(d(u,y),s.document.languageId)}catch{}if(!p){p=new mo(`
This is an excerpt of the file that this test is covering:

`);let m=await this.fileSystemService.readFile(u),h=new kue.TextDecoder().decode(m),g=d(u,h);p.appendCodeblock(g,s.document.languageId)}return{message:p,references:[new Ss.PromptReference(u)]}}render(r,n){if(r!==void 0)return vscpp(Rue.UserMessage,null,vscpp("references",{value:r.references}),r.message.value)}};mS=O([x(1,je),x(2,Kc),x(3,kt),x(4,zr),x(5,De),x(6,Je)],mS);var Pue=z(at());var hS=class extends Q{constructor(r,n,o){super(r);this.parserService=n;this.ignoreService=o}async render(r,n){let{documentContext:o}=this.props;if(await this.ignoreService.isCopilotIgnored(o.document.uri))return vscpp("ignoredFiles",{value:[o.document.uri]});let a=o.document.validateRange(o.wholeRange),c=await Pa(this.parserService,o.document,o.fileIndentInfo,a,n.endpoint.modelMaxPromptTokens/3),{uri:u,languageId:l}=c,d=c.splitAroundAdjustedSelection(),{codeAbove:p,codeSelected:f,codeBelow:m,hasCodeWithoutSelection:h}=d,g=`${p}$SELECTION_PLACEHOLDER$${m}`,v=d.createReplyInterpreter(bd.Mute,1,d.replaceSelectionStreaming,vi.createCodeBlockClassifier(),y=>y.value.trim()!=="$SELECTION_PLACEHOLDER$");return vscpp(Pue.UserMessage,null,vscpp("meta",{value:new Fn(v)}),"I have the following code in a file called `",vscpp(Qs,{value:u,mode:1}),"`:",h&&vscpp(vscppf,null,vscpp(Oe,{uri:u,languageId:l,code:g,shouldTrim:!1}),vscpp("br",null)),h&&vscpp(vscppf,null,"The $SELECTION_PLACEHOLDER$ code is:",vscpp("br",null)),vscpp(Oe,{uri:u,languageId:l,code:f,shouldTrim:!1}))}};hS=O([x(1,mt),x(2,De)],hS);var gS=class{constructor(e,r,n,o,s){this.intent=e;this.endpoint=r;this.location=n;this.context=o;this.instantiationService=s;this.replyInterpreter=null}async buildPrompt({query:e,history:r},n,o){let s=this.context,a=$e.create(this.instantiationService,this.endpoint,qj,{history:r.at(-1)?.request.message,context:s,endpoint:this.endpoint,userQuery:e}),c=await a.render(n,o);return this.replyInterpreter=a.getMeta(Fn)?.replyInterpreter??null,c}processResponseInline(e,r,n){return UT(this.replyInterpreter!==null,"TestFromTestInvocation should have received replyInterpreter from its prompt element"),this.replyInterpreter.processResponse(e,r,n)}async processResponsePanel(e,r,n,o,s){let a="";try{for await(let c of n){let u=c.delta.text;if(s.isCancellationRequested)break;o.markdown(u),a+=u}return a}catch(c){console.error(c)}return a}};gS=O([x(4,te)],gS);var qj=class extends Q{render(e,r){let{history:n,context:o,endpoint:s,userQuery:a}=this.props;if($t(o.document.uri))throw Gr("TestFromTestPrompt should not be used for notebooks");return vscpp(vscppf,null,vscpp(PR.SystemMessage,null,"You are an AI programming assistant.",vscpp("br",null),vscpp(Hr,null),vscpp("br",null),"The user has a ",o.language.languageId," file opened in a code editor.",vscpp("br",null),"The user includes some code snippets from the file.",vscpp("br",null),"Answer with a single ",o.language.languageId," code block.",vscpp("br",null),"Your expertise is strictly limited to software development topics.",vscpp("br",null),vscpp(Zt,null)),n!==void 0&&n.length>0&&vscpp(PR.UserMessage,null,n),vscpp(mS,{documentContext:o,endpointInfo:s}),vscpp(hS,{documentContext:o}),vscpp(PR.UserMessage,null,`Please, generate more tests, taking into account existing tests. ${a}`.trim()))}};var vS=class{constructor(e,r,n){this.instantiationService=e;this.endpointProvider=r;this.ignoreService=n;this.id="tests";this.locations=[2,1];this.description=Aue.t("Generate unit tests for the selected code");this.commandInfo=void 0}static{this.ID="tests"}get intentDetectionInput(){let e="generate_test_for_code";return{functionName:e,sampleQuestion:"Write a set of detailed unit test functions for the code above.",functionCallingBlurb:`If the user's message is related to generating tests, you should use the '${e}' function.`}}async invoke(e){let r=e.documentContext;if(!r)throw new Error("To generate tests, open a file and select code to test.");if(await this.ignoreService.isCopilotIgnored(r.document.uri))throw new Error("Copilot is disabled for this file.");let n=e.location,o=await Mn(this.endpointProvider,n);return lS(r.document)?this.instantiationService.createInstance(gS,this,o,n,r):this.instantiationService.createInstance(fS,this,o,n,r)}};vS=O([x(0,te),x(1,Le),x(2,De)],vS);var rO=z(Qt());var AR=z(Qt());function Due(t,e){let r=Cs(e);for(let n of r){if(n.language!=="json"&&n.language!=="")return[{command:void 0,showCodeBlock:!0,failedValidation:!1}];let o;try{o=Yh(n.code)}catch{}if(!o)return[];let s=o.hasOwnProperty("type")&&o.type==="setting",a=o.hasOwnProperty("type")&&o.type==="command";if(s){let c=[],u=o.settings;if(!u)return c;let l="",d=!1;for(let p of Object.keys(u))c.some(f=>f.command?.arguments&&f.command.arguments[0].includes(`@id:${p}`))||(l+=`@id:${p} `,t.hasSetting(p)||(d=!0));return l=l.trimEnd(),l&&c.push({command:{command:"workbench.action.openSettings",arguments:[l],title:AR.t("Show in Settings Editor")},showCodeBlock:!0,failedValidation:d,codeBlock:"```json\n"+JSON.stringify(u,null,2)+"\n```"}),c}else if(a){let c=o.commands.command;if(!c)return[{command:void 0,showCodeBlock:!0,failedValidation:!1}];let u=o.commands.args,l=[];if(c==="workbench.extensions.search"||c==="workbench.extensions.installExtension"){let d=(Array.isArray(u)?u:[u]).filter(p=>typeof p=="string");if(d.length===1){let p=["featured","popular","recentlyPublished","recommended","updates","builtin","enabled","disabled","installed","workspaceUnsupported"];d[0].includes(":")&&!d[0].startsWith("@")?d[0]=`@${d[0]}`:p.includes(d[0])&&(d[0]=`@${d[0]}`)}return l.push({command:{command:"workbench.extensions.search",arguments:d,title:AR.t("Search Extension Marketplace")},showCodeBlock:!1,failedValidation:!1}),l}else{let d=t.getCommand(c);if(!d)continue;return l.push({command:{command:"workbench.action.quickOpen",arguments:[`>${d.originalLabel??""}`],title:l.length>1?AR.t('Show "{0}"',d.originalLabel??""):AR.t("Show in Command Palette")},showCodeBlock:!1,failedValidation:!1}),l}}else return[{command:void 0,showCodeBlock:!0,failedValidation:!1}]}return[]}var DR=class extends Oo{constructor(r,n,o,s,a,c){super(r,n,o);this.instantiationService=s;this.combinedEmbeddingIndex=a;this.workbenchService=c;this.linkification={disable:!0}}async createRenderer({query:r,history:n,chatVariables:o},s,a,c){return $e.create(this.instantiationService,s,N1,{chatVariables:o,query:r,history:n})}processResponsePanel(r,n,o,s,a){return new Hj(this.combinedEmbeddingIndex,this.workbenchService).processResponse(r,n,o,s,a)}};DR=O([x(3,te),x(4,ul),x(5,rf)],DR);var Hj=class{constructor(e,r){this.combinedIndex=e;this.workbechService=r;this.stagedTextToApply="";this.appliedText="";this._incodeblock=!1}async processResponse(e,r,n,o,s){for await(let{delta:a}of n){if(s.isCancellationRequested)break;await this.applyDelta(a.text,o)}return this.appliedText}async processNonReporting(e,r){let n=Due(this.combinedIndex,e);for(let o of n)if(o.showCodeBlock&&r.markdown(o.codeBlock?o.codeBlock:e),o.command&&r.button(o.command),o.failedValidation){if((await this.workbechService.getAllCommands()).map(c=>c.command).includes(o.command.command))return;let a=o.showCodeBlock?rO.t("To apply this setting, an additional extension installation is needed."):rO.t("To execute this command, an additional extension installation is needed.");r.warning(a)}}async applyDelta(e,r){this.appliedText+=e,e=this.stagedTextToApply+e;let n=e.indexOf("```");if(this._incodeblock){let o=e.indexOf("```");o===-1?this.stagedTextToApply=e:(this._incodeblock=!1,e="\n```"+e.substring(0,o)+"```\n",await this.processNonReporting(e,r),this.stagedTextToApply="")}else if(n!==-1){this._incodeblock=!0;let o=e.indexOf("```",n+3);if(o!==-1)this._incodeblock=!1,r.markdown(e.substring(0,n)),await this.processNonReporting(e,r),r.markdown(e.substring(o+3));else{let s=e.substring(0,n);r.markdown(s)}}else r.markdown(e)}},sg=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id=sg.ID;this.locations=[2];this.description=rO.t("Ask questions about VS Code");this.commandInfo={allowsEmptyArgs:!1}}static{this.ID="vscode"}get intentDetectionInput(){let e="vscode_questions";return{functionName:e,sampleQuestion:"What is the command to open the integrated terminal?",modelDescription:"Looks up information about VS Code via commands, settings, and documentation to accomplish the given editor-specific task.",functionCallingBlurb:`If the user's message is related to commands or settings in Visual Studio Code, you should use the '${e}' function.`}}async invoke(e){let r=e.location,n=await Mn(this.endpointProvider,r);return this.instantiationService.createInstance(DR,this,r,n)}};sg=O([x(0,te),x(1,Le)],sg);Mi.registerIntent(new Be(hl));Mi.registerIntent(new Be(nu));Mi.registerIntent(new Be(sS));Mi.registerIntent(new Be(Fh));Mi.registerIntent(new Be(vS));Mi.registerIntent(new Be(rS));Mi.registerIntent(new Be(Nx));Mi.registerIntent(new Be(oS));Mi.registerIntent(new Be(og));Mi.registerIntent(new Be(bl));Mi.registerIntent(new Be(ta));Mi.registerIntent(new Be(iu));Mi.registerIntent(new Be(ig));Mi.registerIntent(new Be(nS));Mi.registerIntent(new Be(W1));Mi.registerIntent(new Be(Xh));Mi.registerIntent(new Be(sg));Mi.registerIntent(new Be(tg));var LMe=[];function yS(t){return{create(e){return e.get(te).createInstance(t)}}}var Nue=LMe;var eV={};mn(eV,{create:()=>MMe});var jj=z(Qt());var NR=class{constructor(e){this.kind="workspace";let r,n,o,s;e.getConfig(fe.WorkspaceUseFilesVariable)?(r="files",n=jj.t("Searches through the files in the workspace and pulls out relevant information for the query.")):(r="codebase",o="Codebase",s="folder",n=jj.t("Searches through the codebase and pulls out relevant information for the query.")),this.variableInfo={name:r,fullName:o,icon:s,description:n,defaultEnablement:Ta||void 0}}async resolveContext(e,r,n,o){if(!r.message)return;let{messages:s,references:a,usedContext:c}=await Xi(e.get(te),r.endpoint,zx,{promptContext:{chatVariables:new _c([]),query:this.turnQueryIntoWorkspaceQuery(r.message),history:r.history??[],customInstructions:[]},include:{workspaceChunks:!0}},o,n);if(s.length>0)return{kind:this.kind,userMessages:s.map(u=>u.content),usedContext:c,references:a}}turnQueryIntoWorkspaceQuery(e){let r=e;return r.startsWith("@")&&(r=r.replace(/@\w+\s*/,"")),r=r.replaceAll(/\#files/gi,"files"),r}};NR=O([x(0,ye)],NR);tn.register(NR);var OMe=require("path"),Vj=class{constructor(){this.kind="current-editor";this.variableInfo={name:"editor",description:"The visible source code in the active editor",defaultEnablement:!0}}async resolveContext(e,r){let n=e.get(kt).activeTextEditor,o=n?.visibleRanges[0];if(o){let s="";n.selection.isSingleLine&&(s=`The cursor is on line: ${n.selection.start.line}`);let a=[`Excerpt from active file ${OMe.basename(n.document.uri.path)}, lines ${o.start.line+1} to ${o.end.line+1}:`,gi(n.document.languageId,n.document.getText(o),!1),"",s].join(`
`),c=[{uri:n.document.uri,version:n.document.version,ranges:[o]}];return{kind:this.kind,userMessages:[a],usedContext:c,references:[new Ss.PromptReference({uri:n.document.uri,range:o})]}}}},NQt=tn.register(new Vj);var Gj=class{constructor(){this.kind="current-selection-implementations"}async resolveContext(e,r,n,o){let{references:s,messages:a,usedContext:c}=await Xi(e.get(te),r.endpoint,tu,{});return{kind:this.kind,references:s,userMessages:a.map(u=>u.content),usedContext:c}}},qQt=tn.register(new Gj);var zj=class{constructor(){this.kind="debug-console-output";this.variableInfo={name:"debugConsole",description:"The output in the debug console",defaultEnablement:!1}}async resolveContext(e){return{kind:this.kind,userMessages:[`Debug console output:
`+e.get(Y1).consoleOutput]}}},zQt=tn.register(new zj);var $j=class{constructor(){this.kind="diagnostics"}async resolveContext(e,r,n){let o=r.documentContext;if(!o)return;let s=Zh(e.get(bo),o.document.uri,o.selection,r.message),{messages:a,usedContext:c}=await Xi(e.get(te),r.endpoint,pu,{documentContext:o,diagnostics:s});return{kind:this.kind,userMessages:a.map(u=>u.content),usedContext:c}}},eXt=tn.register(new $j);var Wj=z(at());var iO="vscodeAPI",nO=class extends Q{constructor(r,n){super(r);this.accessor=n}static{this.variableInfo={name:iO,description:"Use VS Code API references to answer questions about VS Code extension development.",defaultEnablement:!0}}async prepare(r,n,o){let s=this.accessor.get(Fo),a=this.accessor.get(LR),c=await this.accessor.get(Le).getEmbeddingsEndpoint("ada");if(await a.updateIndex(),o.isCancellationRequested)return;let u=await s.computeEmbeddings(c,[this.props.query],{},o);if(!o.isCancellationRequested&&u&&u.length>0){let l=a.nClosestValues(u[0],5,.7);if(l.length)return{snippets:l}}}render(r,n){return vscpp(vscppf,null,r&&r.snippets.length>0&&vscpp(Wj.UserMessage,{priority:900},"Below are some potentially relevant code samples related to VS Code extension development. You may use information from these samples to help you answer the question if you believe it is relevant."),r&&r.snippets.map(o=>vscpp(Wj.UserMessage,{priority:900},o,vscpp("br",null))))}};nO=O([x(1,je)],nO);var bS=class{constructor(e,r){let n=U0(e.getEditorInfo().version);this.embeddingsCache=r.createInstance(pc,1,"api",n,"api")}async updateIndex(){this.apiChunks=await this.embeddingsCache.getCache()}nClosestValues(e,r,n=0){if(!this.apiChunks)return[];let o=this.apiChunks.map(s=>{if(!s.embedding)return{text:s.text,similarity:0};let a=ch(e,s.embedding);return{text:this.toContextString(s),similarity:a}});return o=o.filter(s=>s.similarity>n),o.sort((s,a)=>a.similarity-s.similarity),o.slice(0,r).map(s=>s.text)}toContextString(e){return e.type==="code"?`API Reference Code Snippet from vscode.d.ts:
${gi(e.lang,e.text)}`:e.type==="command"?`${e.text}`:e.type==="documentationCodeBlock"?`Example code from VS Code documentation:
${gi(e.lang,e.text)}`:""}};bS=O([x(0,Rt),x(1,te)],bS);var LR=ae("IApiEmbeddingsIndex"),Kj=class{constructor(){this.kind="extension-api";this.variableInfo={name:iO,icon:"references",fullName:"VS Code API",description:"Use VS Code API references to answer questions about VS Code extension development.",defaultEnablement:!0}}async resolveContext(e,r,n){if(!r.message)return;let o=r.message.replace(`#${iO}`,"").trim(),s=e.get(LR);if(await s.updateIndex(),n.isCancellationRequested)return;let a=e.get(Fo),u=await e.get(Le).getEmbeddingsEndpoint("ada"),l=await a.computeEmbeddings(u,[o],{},n);if(!n.isCancellationRequested&&l&&l.length>0){let d=s.nClosestValues(l[0],5,.7);if(d.length)return{kind:this.kind,userMessages:[`Below are some potentially relevant code samples related to VS Code extension development. You may use information from these samples to help you answer the question if you believe it is relevant.
`,...d]}}}},SXt=tn.register(new Kj);var Lue=z(require("path"));var Yj=class{constructor(){this.kind="git-metadata";this.variableInfo={name:"git",description:"Information about the current git repository",defaultEnablement:!1}}async resolveContext(e,r,n){let o=e.get(Je),a=e.get(go).repositories,c=o.getWorkspaceFolders();if(a.length===0||!c)return;if(c.length>1){let l=r.documentContext?.document.uri??e.get(kt).activeTextEditor?.document.uri;if(l){let d=o.getWorkspaceFolder(l);if(d){let p=c.findIndex(f=>f.toString()===d.toString());p!==-1&&(a=[a[p]],c=[c[p]])}}}let u=[];for(let l=0;l<a.length;l++){if(n.isCancellationRequested)return;let d=a[l],p=c[l];if(!d)continue;let f=[];f.push(`Workspace Folder: ${Lue.basename(p.path)}`),f.push("```"),d.headBranchName?(f.push(`Current Branch name: ${d.headBranchName}`),f.push(`Upstream: ${d.upstreamBranchName?d.upstreamBranchName:"none"}`)):f.push("Detached HEAD?: yes"),f.push(`Is currently rebasing?: ${d.isRebasing?"yes":"no"}`),f.push(`Remotes: ${(d.remotes??[]).join(", ")}`),f.push("```"),u.push(f.join(`
`))}return{kind:this.kind,userMessages:[`Metadata about the current git repository:
`+u.join(`
`)]}}},PXt=tn.register(new Yj);var Qj=class{constructor(){this.kind="terminal-buffer";this.variableInfo={name:"terminalBuffer",description:"The active terminal's buffer",defaultEnablement:!1}}async resolveContext(e){let r=e.get(eo).terminalBuffer;return{kind:this.kind,userMessages:[`The active terminal's buffer:
`+r]}}},OXt=tn.register(new Qj);var Xj=class{constructor(){this.kind="terminal-last-command";this.variableInfo={name:"terminalLastCommand",description:"The active terminal's last run command",defaultEnablement:!0}}async resolveContext(e){let r=e.get(eo).terminalLastCommand;if(!r)return;let n=[];r.commandLine&&(n.push("The following is the last command run in the terminal:"),n.push(r.commandLine)),r.cwd&&(n.push("It was run in the directory:"),n.push(typeof r.cwd=="object"?r.cwd.toString():r.cwd)),r.output&&(n.push("It has the following output:"),n.push(r.output));let o=n.join(`
`);return{kind:this.kind,userMessages:[`The active terminal's last run command:
`+o]}}},qXt=tn.register(new Xj);var Jj=class{constructor(){this.kind="terminal-selection";this.variableInfo={name:"terminalSelection",icon:"terminal",fullName:"Terminal Selection",description:"The active terminal's selection",defaultEnablement:!0}}async resolveContext(e){let r=e.get(eo).terminalSelection;return{kind:this.kind,userMessages:[`The active terminal's selection:
`+r]}}},zXt=tn.register(new Jj);var Zj=class{constructor(){this.kind="terminal-shell-type"}async resolveContext(e){let r=e.get(eo).terminalShellType;return{kind:this.kind,userMessages:[`The active terminal's shell type:
`+r]}}},QXt=tn.register(new Zj);function MMe(){}var tV={};mn(tV,{create:()=>FMe});function FMe(t){let e=new Tt;return e.add(tn.initialize(t.get(te))),e}var rV={};mn(rV,{create:()=>UMe});function UMe(t){let e=t.get(ue);t.get(Je).ensureWorkspaceIsFullyLoaded().catch(r=>e.defaultLogger.error(r))}var BMe=[...Nue,rV,eV,tV],Oue=BMe;var sV={};mn(sV,{create:()=>qMe});var ly=require("vscode");var Na=require("vscode");async function oO(t,e,r){let n=t?.repositories;if(!n)return r.debug("No git repositories found"),!1;let o=n.map(tx).filter(a=>a);return(await Promise.all(o.map(a=>{let[c,u]=a.split("/");return e.isAvailable(c,u)}))).every(a=>a)}var Fue="github.copilotChat.signIn",Uue="github.copilotChat.signInGHE",Bue="github.copilotChat.signInChoose";async function que(t,e){let r=t.get(go),n=t.get(lu),o=t.get(Nt),s=t.get(ue).getLogger("authSignInCommand");if(await oO(r,n,s)){await o.getAnyGitHubSession(e?{forceNewSession:!0}:{createIfNone:!0});return}await o.getPermissiveGitHubSession({forceNewSession:{learnMore:dt.parse("https://aka.ms/copilotRepoScope")}})}async function nV(t,e){let r=t.get(ye);if(r.getConfig(fe.AuthProvider)!=="github")try{await r.setConfig(fe.AuthProvider,"github")}catch(o){console.error(o)}await que(t,e)}async function iV(t,e){let r=t.get(ye);if(r.getConfig(fe.AuthProvider)!=="github-enterprise")try{await r.setConfig(fe.AuthProvider,"github-enterprise")}catch(a){console.error(a)}let o=Na.workspace.getConfiguration("github-enterprise");if(!o.get("uri")){let a=!1,c=await Na.window.showInputBox({prompt:"What is your GHE.com instance?",placeHolder:'i.e. "octocat" or "https://octocat.ghe.com"...',validateInput(l){if(a=!1,!!l){if(/^[a-zA-Z\-_]+$/.test(l))return a=!0,{message:`Will resolve to https://${l}.ghe.com`,severity:Na.InputBoxValidationSeverity.Info};if(!/^(https:\/\/)?([a-zA-Z0-9-]+\.)*[a-zA-Z0-9-]+\.ghe\.com\/?$/.test(l))return{message:'Please enter a valid GHE.com instance (i.e. "octocat" or "https://octocat.ghe.com")',severity:Na.InputBoxValidationSeverity.Error}}}});if(!c)return;let u=c;a?u=`https://${u}.ghe.com`:c.toLowerCase().startsWith("https://")||(u="https://"+c),await o.update("uri",u,Na.ConfigurationTarget.Global)}await que(t,e)}async function Hue(t,e){let r=await Na.window.showQuickPick([{label:Na.l10n.t("Sign in to GitHub.com"),providerId:"github"},{label:Na.l10n.t("Sign in to GHE.com"),providerId:"github-enterprise"}],{placeHolder:Na.l10n.t("Sign in to...")});r&&(r.providerId==="github"?await nV(t,e):await iV(t,e))}var sO=require("vscode");async function jue(t){let e=new oV(t);return await e.run(),e}var oV=class{constructor(e){this.accessor=e;this.authenticationService=this.accessor.get(Nt);this.logger=this.accessor.get(ue).getLogger("auth");this.ghRepoService=this.accessor.get(lu);this.gitService=this.accessor.safeGet(go);this.vscodeExtensionContext=this.accessor.get(ar);this.disposables=new Tt}async run(){await this.waitForChatEnabled(),!(!this.gitService||await oO(this.gitService,this.ghRepoService,this.logger)||(this.registerListeners(),await this.authenticationService.getPermissiveGitHubSession({silent:!0})))&&await this.showPrompt()}async waitForChatEnabled(){try{if((await this.authenticationService.getCopilotToken()).isChatEnabled())return}catch(e){this.logger.debug("Failed to get copilot token",e)}await al.toPromise(al.filter(this.authenticationService.onDidAuthenticationChange,()=>this.authenticationService.copilotToken?.isChatEnabled()??!1))}registerListeners(){this.disposables.add(this.authenticationService.onDidAuthenticationChange(async()=>{if(!this.authenticationService.permissiveGitHubSession)if(this.authenticationService.anyGitHubSession)await this.showPrompt();else{this.vscodeExtensionContext.globalState.update("copilot.shownPermissiveTokenModal",!1);return}}))}async showPrompt(){try{let e=this.vscodeExtensionContext.globalState.get("copilot.shownPermissiveTokenModal",!1),r={};e||(r.forceNewSession={detail:sO.l10n.t("To show you more relevant Copilot Chat results, we need permission to read the contents of your repository on GitHub."),learnMore:sO.Uri.parse("https://aka.ms/copilotRepoScope")},this.vscodeExtensionContext.globalState.update("copilot.shownPermissiveTokenModal",!0)),await this.authenticationService.getPermissiveGitHubSession(r)&&this.logger.debug("Got permissive GitHub token")}catch(e){this.logger.debug("Failed to get permissive GitHub token",e),await this.authenticationService.getPermissiveGitHubSession({})}}dispose(){this.disposables.dispose()}};function qMe(t){let e=t.get(je),r;return jue(e).then(n=>r=n),ly.Disposable.from(ly.commands.registerCommand(Fue,n=>nV(e,n)),ly.commands.registerCommand(Uue,n=>iV(e,n)),ly.commands.registerCommand(Bue,n=>Hue(e,n)),new ly.Disposable(()=>r?.dispose()))}var aV={};mn(aV,{create:()=>GMe});var fu=z(require("vscode"));var HMe="vscode-chat-code-block",jMe=[/^\n```(typescript|javascript|tsx|jsx)\S*\nany\n```\n$/i],OR=class{constructor(e,r){this.accessor=e;this.telemetryService=r}async provideDefinition(e,r,n){return this.goTo("vscode.experimental.executeDefinitionProvider_recursive",e,r,n)}async provideImplementation(e,r,n){return this.goTo("vscode.experimental.executeImplementationProvider_recursive",e,r,n)}async provideTypeDefinition(e,r,n){return this.goTo("vscode.experimental.executeTypeDefinitionProvider_recursive",e,r,n)}async provideHover(e,r,n){let o=await this.execHover(e.uri,r),s=this.filterOutGenericHovers(o);if(s?.length)return this.convertHover(s);if(n.isCancellationRequested)return;let a=await this.getReferencesContext(e,r,n);if(!(!a||n.isCancellationRequested)){for(let c of a.wordMatches){let u=await this.execHover(c.uri,c.range.start);if(n.isCancellationRequested)return;if(u?.length)return this.convertHover(u)}return this.convertHover(o)}}async execHover(e,r){return fu.commands.executeCommand("vscode.experimental.executeHoverProvider_recursive",e,r)}convertHover(e){return e.length?new fu.Hover(e.flatMap(r=>r.contents),e[0].range):void 0}filterOutGenericHovers(e){return e.filter(r=>r.contents.some(n=>{if(typeof n=="string")return n.length;if(!n.value.length)return!1;for(let o of jMe)if(o.test(n.value))return!1;return!0}))}async goTo(e,r,n,o){this.telemetryService.sendMSFTTelemetryEvent("codeBlock.action.goTo",{languageId:r.languageId,command:e});let s=await this.executeGoToInChatBlocks(e,r,n);if(s?.length)return s;if(!o.isCancellationRequested)return this.executeGoToInChatReferences(e,r,n,o)}async executeGoToInChatBlocks(e,r,n){return(await this.executeGoTo(e,r.uri,n))?.map(s=>"uri"in s?{targetRange:s.range,targetUri:s.uri}:s)}async executeGoTo(e,r,n){return fu.commands.executeCommand(e,r,n)}async executeGoToInChatReferences(e,r,n,o){let s=await this.getReferencesContext(r,n,o);if(!(!s||o.isCancellationRequested))for(let a of s.wordMatches){let c=await this.executeGoTo(e,a.uri,a.range.start);if(o.isCancellationRequested)return;if(c)return c.map(u=>"uri"in u?{targetRange:u.range,targetUri:u.uri,originSelectionRange:s.wordRange}:{targetSelectionRange:u.targetSelectionRange,targetRange:u.targetRange,targetUri:u.targetUri,originSelectionRange:s.wordRange})}}async getReferencesContext(e,r,n){let o=this.getReferences(e);if(!o?.length)return;let s=e.getWordRangeAtPosition(r);if(!s)return;let a=e.getText(s),c=await rR(this.accessor,o,a,n);return{wordRange:s,wordMatches:c}}getReferences(e){try{let r=decodeURIComponent(e.uri.fragment);return JSON.parse(r).references.map(o=>"range"in o?new Ss.PromptReference(new hi(Ur.from(o.uri),new Ge(o.range.startLineNumber-1,o.range.startColumn-1,o.range.endLineNumber-1,o.range.endColumn-1))):new Ss.PromptReference(Ur.from(o.uri)))}catch{return[]}}};OR=O([x(0,je),x(1,me)],OR);function Vue(t){let e=t.get(te).createInstance(OR),r={scheme:HMe,exclusive:!0};return fu.Disposable.from(fu.languages.registerDefinitionProvider(r,e),fu.languages.registerTypeDefinitionProvider(r,e),fu.languages.registerImplementationProvider(r,e),fu.languages.registerHoverProvider(r,e))}function GMe(t){return Vue(t)}var cV={};mn(cV,{create:()=>zMe});var Sc=require("vscode");var ag=ae("ChatVariableService"),_S=class{constructor(e){this._variableEnablements=e.getConfigMixedWithDefaults(fe.ConversationVariablesEnablements)}isVariableEnabled(e){return typeof this._variableEnablements[e.name]=="boolean"?this._variableEnablements[e.name]:typeof e.defaultEnablement=="boolean"?e.defaultEnablement:!!this._variableEnablements["*"]}getVariables(){let e=[];for(let r of tn.contextResolvers)r.variableInfo&&this.isVariableEnabled(r.variableInfo)&&e.push({name:r.variableInfo.name,fullName:r.variableInfo.fullName,icon:r.variableInfo.icon,kind:r.kind,description:r.variableInfo.description,resolve:r.resolveContext.bind(r)});return e}getVariable(e){return this.getVariables().find(r=>r.name===e)}};_S=O([x(0,ye)],_S);function zMe(t){let e=t.get(Le),r=t.get(ag),n=t.get(je),o=new Tt;for(let s of r.getVariables())o.add(Sc.chat.registerChatVariableResolver(`copilot.${s.name}`,s.name,s.description??"",void 0,s.name==="codebase",{async resolve(a,c,u){return[]},resolve2:async(a,c,u,l)=>{let d={endpoint:await e.getChatEndpoint("gpt-3.5-turbo"),message:c.prompt},p={report(m){u.push(m)}},f=await s.resolve(n,d,l,p);return f?(f.references?.forEach(m=>{"variableName"in m.anchor||u.reference(m.anchor)}),[{level:Sc.ChatVariableLevel.Full,value:f.userMessages.join(`

`),description:""}]):[]}},s.fullName,s.icon?new Sc.ThemeIcon(s.icon):void 0));return o.add($Me(t)),o}function $Me(t){return Sc.Disposable.from(Sc.commands.registerCommand("github.copilot.chat.attachSelection",()=>{Sc.commands.executeCommand("workbench.action.chat.attachSelection")}),Sc.commands.registerCommand("github.copilot.chat.attachFile",()=>{Sc.commands.executeCommand("workbench.action.chat.attachFile")}))}var mO=require("vscode");var ug=require("vscode");var dy=class{constructor(e,r){this._domainService=e;this._fetcherService=r}async getCurrentAuthedUserWithToken(e){return this._makeGHAPIRequest("user","GET",e)}async getTeamMembershipWithToken(e,r,n){return this._makeGHAPIRequest(`teams/${e}/memberships/${n}`,"GET",r)}async _makeGHAPIRequest(e,r,n,o){let s=await this._fetcherService.fetch(`${this._domainService.dotComAPIURL}/${e}`,{method:r,headers:{Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28",Authorization:`Bearer ${n}`},body:o?JSON.stringify(o):void 0});if(s.ok)try{return await s.json()}catch{return}}},xS=class extends dy{constructor(r,n,o){super(n,o);this._authService=r}async getCurrentAuthedUser(){let r=(await this._authService.getAnyGitHubSession())?.accessToken;if(r)return await this.getCurrentAuthedUserWithToken(r)}async getTeamMembership(r){let n=await this._authService.getAnyGitHubSession(),o=n?.accessToken,s=n?.account.label;if(!(!o||!s))return await this.getTeamMembershipWithToken(r,o,s)}};xS=O([x(0,Nt),x(1,yn),x(2,$r)],xS);var uV=z(Qt());var cO=ae("IUrlOpener"),aO=class{constructor(){this.openedUrls=[]}open(e){this.openedUrls.push(e)}};var uO=ae("INotificationSender");var WMe=["UNABLE_TO_VERIFY_LEAF_SIGNATURE","CERT_SIGNATURE_FAILURE"],IS=ae("IUserErrorNotifier"),SS=class{constructor(e,r,n){this.logService=e;this.notificationSender=r;this.urlOpener=n;this.notifiedErrorCodes=[]}async notifyUser(e){WMe.includes(e.code)&&!this.didNotifyBefore(e.code)&&(this.displayCertificateErrorNotification(e),this.notifiedErrorCodes.push(e.code))}displayCertificateErrorNotification(e){let r="https://aka.ms/copilot-ssc",n=uV.t("Your current Copilot license doesn't support proxy connections with self-signed certificates.");this.logService.getLogger("certificates").error(`${n} Please visit ${r} to learn more. Original cause: ${JSON.stringify(e)}`),this.showCertificateWarningMessage(n,r)}showCertificateWarningMessage(e,r){let n={title:uV.t("Learn more")};this.notificationSender.showWarningMessage(e,n).then(o=>{o?.title===n.title&&this.urlOpener.open(r)})}didNotifyBefore(e){return this.notifiedErrorCodes.indexOf(e)!==-1}};SS=O([x(0,ue),x(1,uO),x(2,cO)],SS);var CS=ae("ICopilotTokenNotifier"),lO=class{constructor(){this._onCopilotToken=new Gt;this.onCopilotToken=this._onCopilotToken.event}dispose(){this._onCopilotToken.dispose()}emit(e,r){this._onCopilotToken.fire({token:e,envelope:r})}};var pO=z(require("fs"));var dO=class extends dy{async getCurrentAuthedUserWithToken(e){return{avatar_url:"",login:"NullUser",name:"Null User"}}async getTeamMembershipWithToken(e,r,n){}async _makeGHAPIRequest(e,r,n,o){}};var wS=class{constructor(){this._copilotTokenRefreshEmitter=new Gt;this.onDidCopilotTokenRefresh=this._copilotTokenRefreshEmitter.event;this._githubTokenChangedEmitter=new Gt;this.onDidGitHubTokenChanged=this._githubTokenChangedEmitter.event}static{this._refreshRunningCountByTokenManager=new WeakMap}},MR=class extends wS{async fetchCopilotToken(e){let r=this.domainService.tokenURL;try{return await this.fetcherService.fetch(r,{headers:{Authorization:`token ${e}`,...this.envService.getEditorVersionHeaders()}})}catch(n){throw this.userErrorNotifier.notifyUser(n),n}}async authFromGitHubToken(e){let r=Gue(this.logService);this.telemetryService.sendGHTelemetryEvent("auth.new_login");let n=await this.fetchCopilotToken(e);if(!n)return r.info("Failed to get copilot token"),this.telemetryService.sendGHTelemetryErrorEvent("auth.request_failed"),{kind:"failure",reason:"FailedToGetToken"};let o=await n.json();if(!o)return r.info("Failed to get copilot token"),this.telemetryService.sendGHTelemetryErrorEvent("auth.request_read_failed"),{kind:"failure",reason:"FailedToGetToken"};if(n.status===401)return r.info("Failed to get copilot token due to 401 status"),this.telemetryService.sendGHTelemetryErrorEvent("auth.unknown_401"),{kind:"failure",reason:"HTTP401"};if(n.status===403&&o.message?.startsWith("API rate limit exceeded"))return r.info("Failed to get copilot token due to exceeding API rate limit"),this.telemetryService.sendGHTelemetryErrorEvent("auth.rate_limited"),{kind:"failure",reason:"RateLimited"};if(!n.ok||!o.token){r.info(`Invalid copilot token: missing token: ${n.status} ${n.statusText}`);let f=Wn.createAndMarkAsIssued({status:n.status.toString(),status_text:n.statusText});return this.telemetryService.sendGHTelemetryErrorEvent("auth.invalid_token",f.properties,f.measurements),{kind:"failure",reason:"NotAuthorized",...o.error_details}}let s=o.expires_at;o.expires_at=cg()+o.refresh_in+KMe;let c=(await this.baseOctokitservice.getCurrentAuthedUserWithToken(e))?.login??"unknown",u=await this.baseOctokitservice.getTeamMembershipWithToken(Mce,e,c),l={...o,username:c,isVscodeTeamMember:!!u},d=new ah(l);this.copilotTokenNotifier.emit(d,o);let p=Wn.createAndMarkAsIssued({},{adjusted_expires_at:o.expires_at,expires_at:s,current_time:cg()});return this.telemetryService.sendGHTelemetryEvent("auth.new_token",p.properties,p.measurements),{kind:"success",...l}}async _refreshToken(e){let r=cg(),n=wS._refreshRunningCountByTokenManager.get(this)??wS._refreshRunningCountByTokenManager.set(this,{value:0}).get(this);n.value>0||(n.value++,setTimeout(async()=>{let o,s="";try{n.value--,await this.getCopilotToken(!0),o="success",this._copilotTokenRefreshEmitter.fire()}catch(c){o="failure",s=c.toString()}let a=Wn.createAndMarkAsIssued({result:o},{time_taken:cg()-r,refresh_count:n.value});s&&(a.properties.reason=s),this.telemetryService.sendGHTelemetryEvent("auth.token_refresh",a.properties,a.measurements)},e*1e3))}};function Gue(t){return t.getLogger("auth")}var KMe=60;function cg(){return Math.floor(Date.now()/1e3)}var dV=class extends wS{constructor(r){super();this.completionsToken=r;this.wasReset=!1}getAnyGitHubSession(){return Promise.resolve({id:this.completionsToken,accessToken:this.completionsToken,scopes:Y_,account:{id:"user",label:"User"}})}getPermissiveGitHubSession(){return Promise.resolve({id:this.completionsToken,accessToken:this.completionsToken,scopes:M0,account:{id:"user",label:"User"}})}async getCopilotToken(){return new ah({token:this.completionsToken,expires_at:0,refresh_in:0,username:"fixedTokenManager",isVscodeTeamMember:!1})}resetCopilotToken(r){this.wasReset=!0}async checkCopilotToken(){return{status:"OK"}}async _refreshToken(r){}},TS=class extends MR{constructor(r,n,o,s,a,c,u,l,d){super();this.githubToken=r;this.configurationService=n;this.logService=o;this.telemetryService=s;this.copilotTokenNotifier=a;this.domainService=c;this.fetcherService=u;this.envService=l;this.userErrorNotifier=d;this.baseOctokitservice=new dO(this.domainService,this.fetcherService),this.copilotToken=void 0}getAnyGitHubSession(){return Promise.resolve({id:this.githubToken,accessToken:this.githubToken,scopes:Y_,account:{id:"user",label:"User"}})}getPermissiveGitHubSession(){return Promise.resolve({id:this.githubToken,accessToken:this.githubToken,scopes:M0,account:{id:"user",label:"User"}})}async getCopilotToken(r){if(!this.copilotToken||this.copilotToken.expires_at<cg()||r){let n=await this.authFromGitHubToken(this.githubToken);if(n.kind==="failure")throw Error(`Failed to get copilot token: ${n.reason.toString()} ${n.message??""}`);this.copilotToken={...n},this._refreshToken(n.refresh_in)}return new ah(this.copilotToken)}async checkCopilotToken(){if(!this.copilotToken||this.copilotToken.expires_at<cg()){let n=await this.authFromGitHubToken(this.githubToken);if(n.kind==="failure")return n;this.copilotToken={...n},this._refreshToken(n.refresh_in)}return{status:"OK"}}resetCopilotToken(r){r!==void 0&&this.telemetryService.sendGHTelemetryEvent("auth.reset_token_"+r),Gue(this.logService).debug(`Resetting copilot token on HTTP error ${r||"unknown"}`),this.copilotToken=void 0}};TS=O([x(1,ye),x(2,ue),x(3,me),x(4,CS),x(5,yn),x(6,$r),x(7,Rt),x(8,IS)],TS);var lV=`${process.env.HOME||process.env.USERPROFILE}/.copilot-testing-gh-token`,ES;function zue(t){if(!ES&&(process.env.GITHUB_PAT&&(ES=t.createInstance(dV,process.env.GITHUB_PAT)),process.env.GITHUB_OAUTH_TOKEN&&(ES=t.createInstance(TS,process.env.GITHUB_OAUTH_TOKEN)),pO.existsSync(lV))){let e=pO.readFileSync(lV).toString();ES=t.createInstance(TS,e.trim())}if(!ES)throw new Error(`Tests: either GITHUB_PAT must be set, or there must be a GitHub token from an app with access to Copilot in ${lV}. Run "npm run get_token" to get one.`);return ES}var ra=require("vscode");var $ue="You are not signed in to GitHub. Please sign in to use Copilot.";function fO(t){return t.getConfig(fe.AuthProvider)==="github-enterprise"?"github-enterprise":"github"}async function Wue(t,e,r,n={}){let o=await ra.authentication.getAccounts(t);if(!o.length)return await ra.authentication.getSession(t,e,n);let s=new Set(o.map(u=>u.label)),a=ra.workspace.getConfiguration();if(n.forceNewSession){let u=await ra.authentication.getSession(t,e,{...n,forceNewSession:n.forceNewSession,clearSessionPreference:!0});return s.size>1&&await a.update("github.copilot.preferredAccount",u.account.label,ra.ConfigurationTarget.Global),u}let c=a.get("github.copilot.preferredAccount")||void 0;if(!c&&s.size===1&&(c=o[0].label),c){let u=o.find(l=>l.label===c);if(u){let l=await r(u);if(l)return l}}if(n.createIfNone){let u=await ra.authentication.getSession(t,e,{forceNewSession:!0,clearSessionPreference:!0});return(s.size>1||s.size===1&&!s.has(u.account.label))&&await a.update("github.copilot.preferredAccount",u.account.label,ra.ConfigurationTarget.Global),u}}function pV(t,e){let r=fO(t);return Wue(r,Y_,async n=>{let o=await ra.authentication.getSession(r,M0,{silent:!0,account:n});if(o)return o;let s=await ra.authentication.getSession(r,Y_,{silent:!0,account:n});if(s)return s;let a=await ra.authentication.getSession(r,rie,{silent:!0,account:n});if(a)return a},e)}function Kue(t,e){let r=fO(t);return Wue(r,M0,async n=>await ra.authentication.getSession(r,M0,{silent:!0,account:n}),e)}var Yue=!1,FR=class extends Error{},UR=class extends Error{},BR=class extends Error{},qR=class extends Error{},HR=class extends Error{},RS=class extends MR{constructor(r,n,o,s,a,c,u,l){super();this.configurationService=r;this.logService=n;this.telemetryService=o;this.domainService=s;this.copilotTokenNotifier=a;this.fetcherService=c;this.envService=u;this.userErrorNotifier=l;this._cachedAnySession=null;this._cachedPermissiveSession=null;this.copilotToken=void 0,this.baseOctokitservice=new dy(this.domainService,this.fetcherService),this._disposable=ug.Disposable.from(ug.authentication.onDidChangeSessions(d=>{d.provider.id===fO(r)&&this._handleAuthChangeEvent()}),this.domainService.onDidChangeDomains(d=>{d.dotcomUrlChanged&&this.resetCopilotToken()}),ug.workspace.onDidChangeConfiguration(async d=>{(d.affectsConfiguration("github.copilot.preferredAccount")||d.affectsConfiguration("github.copilot.advanced"))&&this._handleAuthChangeEvent()}))}dispose(){this._disposable.dispose()}async getAnyGitHubSession(r){return this._cachedAnySession!==null&&!this.isInteractiveRequest(r)?this._cachedAnySession:(this._cachedAnySession=await pV(this.configurationService,r),this._cachedAnySession)}async getPermissiveGitHubSession(r){return this._cachedPermissiveSession!==null&&!this.isInteractiveRequest(r)?this._cachedPermissiveSession:(this._cachedPermissiveSession=await Kue(this.configurationService,r),this._cachedPermissiveSession)}async getCopilotToken(r){return(!this.copilotToken||this.copilotToken.expires_at<cg()||r)&&(this.copilotToken=await this.authShowWarnings(),this._refreshToken(this.copilotToken.refresh_in)),new ah(this.copilotToken)}resetCopilotToken(r){r!==void 0&&this.telemetryService.sendGHTelemetryEvent("auth.reset_token_"+r),this.logService.getLogger("auth").debug(`Resetting copilot token on HTTP error ${r||"unknown"}`),this.copilotToken=void 0}async _handleAuthChangeEvent(){this._cachedAnySession=null,this._cachedPermissiveSession=null;try{await this._resetOrRefreshCopilotToken()}catch{}this._githubTokenChangedEmitter.fire()}async _resetOrRefreshCopilotToken(){if(!await this.getAnyGitHubSession()){this.resetCopilotToken();return}await this.getCopilotToken(!0)}isInteractiveRequest(r){return r?.createIfNone||r?.forceNewSession}async auth(){let r=this.logService.getLogger("auth"),n=await pV(this.configurationService,{silent:!0});if(!n)return r.info("GitHub login failed"),this.telemetryService.sendGHTelemetryErrorEvent("auth.github_login_failed"),{kind:"failure",reason:"GitHubLoginFailed"};r.info(`Logged in as ${n.account.label}`);let o=await this.authFromGitHubToken(n.accessToken);return o.kind==="success"&&r.info(`Got Copilot token for ${n.account.label}`),o}async authShowWarnings(){let r=await this.auth();if(r.kind==="failure"&&r.reason==="NotAuthorized"){let n=r.message;if(n?.includes("No access to GitHub Copilot found"))throw new FR(n??"User not authorized");if(n?.includes("Your subscription has ended"))throw new UR(n);if(n?.includes("Contact Support."))throw new BR(n)}if(r.kind==="failure"){let n=r.message;if(n?.includes("Please contact your enterprise admin to enable your managed account for Copilot for Business"))throw new qR(n)}if(r.kind==="failure"&&r.reason==="HTTP401"){let n="Your GitHub token is invalid. Please sign out from your GitHub account using the VS Code accounts menu and try again.";throw Yue||(Yue=!0,ug.window.showWarningMessage(n)),Error(n)}if(r.kind==="failure"&&r.reason==="GitHubLoginFailed")throw Error("GitHubLoginFailed");if(r.kind==="failure"&&r.reason==="RateLimited")throw Error("Your account has exceeded GitHub's API rate limit. Please try again later.");if(r.kind==="failure")throw Error("Failed to get copilot token");if(r.kind==="success"&&r.chat_enabled===!1)throw new HR("Copilot Chat is disabled");return r}};RS=O([x(0,ye),x(1,ue),x(2,me),x(3,yn),x(4,CS),x(5,$r),x(6,Rt),x(7,IS)],RS);var lg={Activated:"github.copilot-chat.activated",Offline:"github.copilot.offline",IndividualDisabled:"github.copilot.interactiveSession.individual.disabled",IndividualExpired:"github.copilot.interactiveSession.individual.expired",ContactSupport:"github.copilot.interactiveSession.contactSupport",EnterpriseDisabled:"github.copilot.interactiveSession.enterprise.disabled",CopilotChatDisabled:"github.copilot.interactiveSession.chatDisabled"},kS=class extends Ct{constructor(r,n,o,s){super();this._authenticationService=r;this._telemetryService=n;this._fetcherService=o;this._logger=s.getLogger("ContextKeysContribution"),this._inspectContext().catch(console.error),this._register(r.onDidAuthenticationChange(async()=>await this._inspectContext())),this._register(mO.commands.registerCommand("github.copilot.offline",async()=>await this._inspectContext()))}async _inspectContext(){let r=Object.values(lg),n,o;try{await this._authenticationService.getCopilotToken(),o=lg.Activated}catch(s){n=s;let a=s.message||s,c=Wn.createAndMarkAsIssued({reason:a});this._telemetryService.sendGHTelemetryErrorEvent("activationFailed",c.properties,c.measurements);let u=a==="GitHubLoginFailed"?$ue:`GitHub Copilot could not connect to server. Extension activation failed: "${a}"`;this._logger.error(u)}this._fetcherService.isDNSLookupFailedError(n)?o=lg.Offline:n instanceof FR?o=lg.IndividualDisabled:n instanceof UR?o=lg.IndividualExpired:n instanceof qR?o=lg.EnterpriseDisabled:n instanceof BR?o=lg.ContactSupport:n instanceof HR&&(o=lg.CopilotChatDisabled),o&&mO.commands.executeCommand("setContext",o,!0);for(let s of r)s!==o&&mO.commands.executeCommand("setContext",s,!1)}};kS=O([x(0,Nt),x(1,me),x(2,$r),x(3,ue)],kS);var _o=z(require("vscode"));var gO=ae("IBlockedExtensionService"),hO=class{constructor(){this.blockedExtensions=new Map}reportBlockedExtension(e,r){this.blockedExtensions.has(e)&&clearTimeout(this.blockedExtensions.get(e));let n=setTimeout(()=>{this.blockedExtensions.delete(e)},r*1e3);this.blockedExtensions.set(e,n)}isExtensionBlocked(e){return this.blockedExtensions.has(e)}};var dg=z(at()),py=z(require("vscode"));var jR=class extends Q{render(){let e=[],r=[];for(let n of this.props.messages)n.role===py.LanguageModelChatMessageRole.System?e.push(n.content):n.role===py.LanguageModelChatMessageRole.Assistant?r.push(vscpp(dg.AssistantMessage,null,n.content)):n.role===py.LanguageModelChatMessageRole.User&&(py.LanguageModelChatMessageFunctionResultPart&&n.content2 instanceof py.LanguageModelChatMessageFunctionResultPart&&r.push(vscpp(dg.FunctionMessage,{name:n.content2.name},n.content2.content)),n.content&&r.push(vscpp(dg.UserMessage,{name:n.name},n.content)));return vscpp(vscppf,null,vscpp(dg.SystemMessage,null,this.props.noSafety?e:vscpp(vscppf,null,vscpp(Zt,null),vscpp(Di,null),vscpp("br",null),e.join(`
`))),r)}};var PS=class{constructor(e,r,n,o,s,a){this._instantiationService=r;this._authenticationService=n;this._endpointProvider=o;this._embeddingsComputer=s;this._vsCodeExtensionContext=a;this.id="languageModelAccess";this._store=new Tt;if(this._logger=e.getLogger("LanguageModelAccess"),this._vsCodeExtensionContext.extensionMode===$c.Test){this._logger.warn("LanguageModels and Embeddings are NOT AVAILABLE in test mode.");return}this.activationBlocker=Promise.all([this._registerLanguageModels(),this._registerEmbeddings()])}dispose(){this._store.dispose()}async _registerLanguageModels(){let e=new Map,r=async()=>{let o=await this._getAuthSession(),s=new Map,a=o?await this._endpointProvider.getAllChatEndpoints():[],c=new Set;this._logger.debug("UPDATING language models");for(let u of a){if(this._store.isDisposed)break;if(c.has(u.family))continue;c.add(u.family);let l=e.get(u.model);if(l){s.set(u.model,l);continue}let d=await $e.create(this._instantiationService,u,jR,{noSafety:!1,messages:[]}).countTokens(),p={vendor:"copilot",name:u.name,family:u.family,version:u.version,maxInputTokens:4096-d-Fne,maxOutputTokens:4096/2,auth:o&&{label:o.account.label}},f=this._instantiationService.createInstance(VR,u,p),m=_o.chat.registerChatResponseProvider(u.model,f,p);s.set(u.model,{endpoint:u,dispo:m}),this._logger.debug("ADDED language model",u.model)}for(let[u,l]of e)s.has(u)||(l.dispo.dispose(),this._logger.debug("REMOVED language model",u));e=s,this._store.isDisposed||(n=setTimeout(r,1e3*60*15))},n;await r(),this._store.add(this._authenticationService.onDidAuthenticationChange(()=>r())),this._store.add(sl(()=>{clearInterval(n);for(let o of e.values())o.dispo.dispose()}))}async _registerEmbeddings(){let e=this._store.add(new AT);await(async()=>{if(e.clear(),!await this._getAuthSession())return;let n=this._embeddingsComputer,o=await this._endpointProvider.getEmbeddingsEndpoint("ada");e.value=_o.lm.registerEmbeddingsProvider(`copilot.${o.model}`,new class{async provideEmbeddings(s,a){let c=await n.computeEmbeddings(o,s,{parallelism:2},a);if(!c)throw new Error("Failed to compute embeddings");return c.map(u=>({values:u.slice(0)}))}})})()}async _getAuthSession(){try{await this._authenticationService.getCopilotToken()}catch(r){this._logger.warn("LanguageModel/Embeddings are not available without auth token"),this._logger.error(r);return}let e=this._authenticationService.anyGitHubSession;if(!e){this._logger.error("Auth token not present when we expected it to be");return}return e}};PS=O([x(0,ue),x(1,te),x(2,Nt),x(3,Le),x(4,Fo),x(5,ar)],PS);var VR=class extends Ct{constructor(r,n,o,s,a,c,u,l){super();this._endpoint=r;this._metadata=n;this._expService=o;this._telemetryService=s;this._chatMLFetcher=a;this._tokenizerProvider=c;this._blockedExtensionService=u;this._instantiationService=l;this._onDidReceiveLanguageModelResponse2=this._register(new Gt);this.onDidReceiveLanguageModelResponse2=this._onDidReceiveLanguageModelResponse2.event;this._register(this._chatMLFetcher.onDidMakeChatMLRequest(({model:d,source:p,tokenCount:f})=>{d===this._endpoint.model&&this._onDidReceiveLanguageModelResponse2.fire({extensionId:p?.extensionId??q0,participant:p?.agent,tokenCount:f})}))}async _provideLanguageModelResponse(r,n,o,s,a){let c=_o.extensions.getExtension(o,!0);if(!c||typeof c.packageJSON.version!="string")throw new Error("Invalid extension information");let u=c.packageJSON.version,l=_o.l10n.t("The extension has been temporarily blocked due to making too many requests. Please try again later.");if(this._blockedExtensionService.isExtensionBlocked(o))throw _o.LanguageModelError.Blocked(l);let d=await this._expService.getTreatmentVariableAsync("vscode","copilotchat.languageModelControlList"),p=Que.extractCustomTokenLimit(d??"",o)??this._metadata.maxInputTokens,{messages:f,tokenCount:m}=await $e.create(this._instantiationService,this._endpoint,jR,{noSafety:!1,messages:r}).render();if(this._telemetryService.sendMSFTTelemetryEvent("languagemodelrequest",{extensionId:o,extensionVersion:u,model:this._endpoint.model},{tokenCount:m,tokenLimit:p}),m>p)throw new Error("Message exceeds token limit.");if(n.tools&&n.tools.length>128)throw new Error("Cannot have more than 128 tools per request.");let h=new Proxy(this._endpoint,{get:function(b,_,S){return _==="getExtraHeaders"?function(){return{...b.getExtraHeaders?.()??{},"x-onbehalf-extension-id":`${o}/${u}`}}:Reflect.get(b,_,S)}}),g=fV.Default.convert(n.modelOptions??{}),v={messageSource:`api.${o}`};g.functions=n.tools?.map(b=>({name:b.name,description:b.description,parameters:b.parametersSchema}));let y=await this._chatMLFetcher.fetchMany(f,s,a,3,h,{extensionId:o},g,v,{intent:!0});if(y.type!=="success")throw y.type==="extensionBlocked"?(this._blockedExtensionService.reportBlockedExtension(o,y.retryAfter),_o.LanguageModelError.Blocked(l)):new Error(y.reason);this._telemetryService.sendInternalMSFTTelemetryEvent("languagemodelrequest",{extensionId:o,extensionVersion:u,requestid:y.requestId,query:f[f.length-1].content,model:this._endpoint.model},{tokenCount:m,tokenLimit:p})}async provideLanguageModelResponse2(r,n,o,s,a){let c=async(u,l,d)=>{if(d.text&&s.report({index:l,part:new _o.LanguageModelChatResponseTextPart(d.text)}),d.copilotFunctionCalls)for(let p of d.copilotFunctionCalls)s.report({index:l,part:new _o.LanguageModelChatResponseFunctionUsePart(p.name,p.arguments)})};return this._provideLanguageModelResponse(r,n,o,c,a)}async provideLanguageModelResponse(r,n,o,s,a){let c=async(u,l,d)=>{s.report({index:l,part:d.text})};return this._provideLanguageModelResponse(r,{modelOptions:n},o,c,a)}async provideTokenCount(r){if(typeof r=="string")return this._tokenizerProvider.acquireTokenizer(this._endpoint.family).tokenLength(r);{let s={role:new Map([[_o.LanguageModelChatMessageRole.Assistant,"assistant"],[_o.LanguageModelChatMessageRole.User,"user"],[_o.LanguageModelChatMessageRole.System,"system"]]).get(r.role)??"user",content:r.content};return this._tokenizerProvider.acquireTokenizer(this._endpoint.family).countMessageTokens(s)}}};VR=O([x(2,Ut),x(3,me),x(4,Bt),x(5,dr),x(6,gO),x(7,te)],VR);var Que;(e=>{function t(r,n){let o=r.indexOf(n);if(o<0)return;let s=o+n.length,a=r.indexOf(",",s);a<0&&(a=r.length);let c=Number(r.substring(s,a));if(!isNaN(c))return c*1e3}e.extractCustomTokenLimit=t})(Que||={});function YMe(...t){return e=>t.some(r=>r(e))}var fV=class t{constructor(e){this._description=e}static{this._defaultDesc={stop:YMe(eD,FT),temperature:M_,max_tokens:M_,frequency_penalty:M_,presence_penalty:M_}}static{this.Default=new t({...this._defaultDesc})}convert(e){let r={};for(let n in this._description){let o=this._description[n],s=e[n];s!=null&&o(s)&&(r[n]=s)}return r}};var rle=require("crypto"),SO=z(require("path")),zR=z(require("util")),Qe=require("vscode");var vO=class{constructor(){this.logprobs=[];this.top_logprobs=[];this.text=[];this.newText=[];this.tokens=[];this.text_offset=[]}append(e){e.text&&(this.text.push(e.text),this.newText.push(e.text)),e.delta?.content&&(this.text.push(e.delta.content),this.newText.push(e.delta.content)),e.delta?.function_call&&(this.text.push(e.delta.function_call.arguments),this.newText.push(e.delta.function_call.arguments)),e.logprobs&&(this.tokens.push(e.logprobs.tokens??[]),this.text_offset.push(e.logprobs.text_offset??[]),this.logprobs.push(e.logprobs.token_logprobs??[]),this.top_logprobs.push(e.logprobs.top_logprobs??[]))}flush(){let e=this.newText.join("");return this.newText=[],e}};function XMe(t){let e=t.split(`
`),r=e.pop();return[e.filter(n=>n!==""),r]}var yO=class t{constructor(e,r,n,o,s,a){this.telemetryService=r;this.expectedNumChoices=n;this.response=o;this.body=s;this.cancellationToken=a;this.requestId=zw(this.response);this.stats=new mV(this.expectedNumChoices);this.solutions={};this.completedFunctionCallIdxs=new Map;this.functionCalls={};this.functionCallName=void 0;this.logger=e.getLogger("streamChoices"),this.responseLogger=e.getPromptResponseLogger2()}static async create(e,r,n,o,s){let a=await o.body();return a.setEncoding("utf8"),new t(e,r,n,o,a,s)}async*processSSE(e=async()=>{}){try{yield*this.processSSEInner(e)}finally{this.cancel(),this.logger.info(`request done: requestId: [${this.requestId.headerRequestId}] model deployment ID: [${this.requestId.deploymentId}]`),this.logger.debug(`request stats: ${this.stats}`)}}async*processSSEInner(e){let r="",n=!1;e:for await(let o of this.body){if(this.maybeCancel("after awaiting body chunk"))return;let[s,a]=XMe(r+o.toString());r=a;let c=!1;for(let u of s){let l=u.slice(5).trim();if(l==="[DONE]"){yield*this.finishSolutions();return}let d;try{d=JSON.parse(l)}catch{this.logger.error(`Error parsing JSON stream data for request id ${this.requestId.headerRequestId}:`,u),wf(this.telemetryService,`Error parsing JSON stream data for request id ${this.requestId.headerRequestId}:`,u);continue}if(d.copilot_confirmation&&JMe(d.copilot_confirmation)&&await e("",0,{text:"",copilotConfirmation:d.copilot_confirmation}),!d.choices){!d.copilot_references&&!d.copilot_confirmation&&(d.error!==void 0?(this.logger.error(`Error in response for request id ${this.requestId.headerRequestId}:`,d.error.message),wf(this.telemetryService,`Error in response for request id ${this.requestId.headerRequestId}:`,d.error.message)):(this.logger.error(`Unexpected response with no choices or error for request id ${this.requestId.headerRequestId}`),wf(this.telemetryService,`Unexpected response with no choices or error for request id ${this.requestId.headerRequestId}`))),d.copilot_errors&&await e("",0,{text:"",copilotErrors:d.copilot_errors});continue}if(this.requestId.created===0&&(this.requestId=zw(this.response,d),this.requestId.created===0&&d.choices?.length&&(this.logger.error(`Request id invalid, should have "completionId" and "created": ${JSON.stringify(this.requestId)}`,this.requestId),wf(this.telemetryService,`Request id invalid, should have "completionId" and "created": ${JSON.stringify(this.requestId)}`,this.requestId))),this.allSolutionsDone())break e;for(let p=0;p<d.choices.length;p++){let f=d.choices[p],m={...f};delete m.index,delete m.content_filter_results,delete m.content_filter_offsets,this.logger.debug("choice",m),this.responseLogger.logRawStreamChoice(f),this.stats.add(f.index),f.index in this.solutions||(this.solutions[f.index]=new vO);let h=this.solutions[f.index];if(h===null)continue;let g,v=async(b,_,S,I,T)=>(b&&(!Array.isArray(b)||!b.every(A=>Lae(A)))&&(b=void 0),_&&(!Array.isArray(_)||!_.every(Oae))&&(_=void 0),g=await e(h.text.join(""),f.index,{text:h.flush(),codeVulnAnnotations:b,ipCitations:_,copilotReferences:S,copilotFunctionCalls:I,copilotErrors:T}),g!==void 0&&(n=!0),this.maybeCancel("after awaiting finishedCb"));if(f.delta?.copilot_annotations?.CodeVulnerability||f.delta?.copilot_annotations?.IPCodeCitations){if(await v()||!n&&(h.append(f),await v(f.delta.copilot_annotations.CodeVulnerability,f.delta?.copilot_annotations?.IPCodeCitations)))continue}else if(f.delta?.role==="function"){if(f.delta.content)try{let b=JSON.parse(f.delta.content);if(Array.isArray(b)&&await v(void 0,void 0,b))continue}catch(b){this.logger.error(`Error parsing function references: ${JSON.stringify(b)}`)}}else if(f.delta?.function_call)c=!0,this.functionCallName??=f.delta.function_call.name,this.functionCalls[this.functionCallName]??=new vO,this.functionCalls[this.functionCallName].append(f);else if((f.finish_reason==="function_call"||f.finish_reason==="stop")&&this.functionCallName){let b=this.functionCalls[this.functionCallName],_={name:this.functionCallName,arguments:b.flush()};f.finish_reason==="function_call"&&this.completedFunctionCallIdxs.set(f.index,_);try{if(await v(void 0,void 0,void 0,[_]))continue}catch{}this.functionCalls[this.functionCallName]=null,this.functionCallName=void 0;continue}else if(h.append(f),await v())continue;if(f.finish_reason||g!==void 0){if(this.stats.markYielded(f.index),yield{solution:h,finishOffset:g,reason:f.finish_reason??"client-trimmed",filterReason:ZMe(f),requestId:this.requestId,index:f.index},this.maybeCancel("after yielding finished choice"))return;c||(this.solutions[f.index]=null)}}}}for(let[o,s]of Object.entries(this.solutions)){let a=Number(o);if(s!==null&&(this.stats.markYielded(a),yield{solution:s,finishOffset:void 0,reason:"Iteration Done",requestId:this.requestId,index:a},this.maybeCancel("after yielding after iteration done")))return}if(r.length>0&&!n)try{let o=JSON.parse(r);o.error!==void 0&&(this.logger.error(`Error in response: ${o.error.message}`,o.error),wf(this.telemetryService,`Error in response: ${o.error.message}`,o.error))}catch{this.logger.error(`Error parsing extraData for request id ${this.requestId.headerRequestId}: ${r}`),wf(this.telemetryService,`Error parsing extraData for request id ${this.requestId.headerRequestId}: ${r}`)}}async*finishSolutions(){for(let[e,r]of Object.entries(this.solutions)){let n=Number(e);if(r!==null){if(this.completedFunctionCallIdxs.has(n)){yield{solution:r,finishOffset:void 0,reason:"function_call",requestId:this.requestId,index:n};continue}if(this.stats.markYielded(n),yield{solution:r,finishOffset:void 0,reason:"DONE",requestId:this.requestId,index:n},this.maybeCancel("after yielding on DONE"))return}}}maybeCancel(e){return this.cancellationToken?.isCancellationRequested?(this.logger.debug("Cancelled: "+e),this.cancel(),!0):!1}cancel(){this.body.destroy()}allSolutionsDone(){let e=Object.values(this.solutions);return e.length===this.expectedNumChoices&&e.every(r=>r===null)}};function JMe(t){return typeof t.title=="string"&&typeof t.message=="string"&&!!t.confirmation}function Xue(t){let r={text:t.text.join(""),tokens:t.text};if(t.logprobs.length===0)return r;let n=t.logprobs.reduce((c,u)=>c.concat(u),[]),o=t.top_logprobs.reduce((c,u)=>c.concat(u),[]),s=t.text_offset.reduce((c,u)=>c.concat(u),[]),a=t.tokens.reduce((c,u)=>c.concat(u),[]);return{...r,logprobs:{token_logprobs:n,top_logprobs:o,text_offset:s,tokens:a}}}function ZMe(t){if(t.finish_reason!=="content_filter")return;if(!!t.delta?.copilot_annotations?.TextCopyright)return"snippy";if(t.content_filter_results){for(let r of Object.keys(t.content_filter_results))if(t.content_filter_results[r]?.filtered)return r}}var mV=class{constructor(e){this.choices=new Map;for(let r=0;r<e;r++)this.choices.set(r,new GR)}add(e){let r=this.choices.get(e)??new GR;r.increment(),this.choices.set(e,r)}markYielded(e){let r=this.choices.get(e)??new GR;r.markYielded(),this.choices.set(e,r)}toString(){return Array.from(this.choices.entries()).map(([e,r])=>`${e}: ${r.yieldedTokens} -> ${r.seenTokens}`).join(", ")}},GR=class{constructor(){this.yieldedTokens=-1;this.seenTokens=0}increment(){this.seenTokens++}markYielded(){this.yieldedTokens=this.seenTokens}};function wf(t,e,r){let n=[e,r],o=n.length>0?JSON.stringify(n):"no msg",s=Wn.createAndMarkAsIssued({context:"fetch",level:WT[3],message:o});t.sendRestrictedGHTelemetryErrorEvent("log",s.properties,s.measurements);let a=Wn.createAndMarkAsIssued({context:"fetch",level:WT[3],message:"[redacted]"});t.sendGHTelemetryErrorEvent("log",a.properties,a.measurements)}function hV(t,e,r){let n=r.extendedBy({messagesJson:JSON.stringify(e)});t.sendRestrictedGHTelemetryEvent("engine.messages",n.properties,n.measurements)}function eFe(t,e,r,n,o,s,a,c,u){return hV(t,[e],u),{message:e,choiceIndex:n,requestId:o,blockFinished:s,finishReason:a,filterReason:c,tokens:r.tokens,numTokens:r.tokens.length,telemetryData:u}}function Jue(t,e,r,n){let o=e.getLogger("streamMessages"),s=r.solution.text.join(""),a=!1;r.finishOffset!==void 0&&(o.debug(`message ${r.index}: early finish at offset ${r.finishOffset}`),s=s.substring(0,r.finishOffset),a=!0),o.info(`message ${r.index} returned. finish reason: [${r.reason}]`),o.debug(`message ${r.index} details: finishOffset: [${r.finishOffset}] completionId: [{${r.requestId.completionId}}] created: [{${r.requestId.created}}]`);let c=Xue(r.solution),u={role:"assistant",content:s};return eFe(t,u,c,r.index,r.requestId,a,r.reason,r.filterReason,n)}async function Zue(t,e){let n=(await t.get(Nt).getCopilotToken()).isInternal?t.get(ye).getConfig(fe.DebugOverrideChatMaxTokenNum):0,o=-3;if(n>0)return o+=n,o;if(e.capabilities?.limits?.max_prompt_tokens)return o+=e.capabilities.limits.max_prompt_tokens,o;switch(e.id){case"gpt-3.5-turbo":o+=7168;break;case"gpt-4-0125-preview":o+=3072;break;default:o+=3072}return o}async function tFe(t,e,r,n,o,s,a){let u=(await yO.create(e,t,n,r,a)).processSSE(o);return Zo.map(u,d=>{let p=d.reason??"client-trimmed",f=s.extendedBy({completionChoiceFinishReason:p});return t.sendGHTelemetryEvent("completion.finishReason",f.properties,f.measurements),Jue(t,e,d,s)})}var AS=class{constructor(e,r,n,o,s){this.domainService=e;this.disableSnippy=o;this.urlOverride=s;this._maxTokens=n,this.model=r.id,this.name=r.name,this.version=r.version,this.family=r.capabilities.family}get modelMaxPromptTokens(){return this._maxTokens}get url(){return this.urlOverride??this.domainService.capiChatURL}interceptBody(e){e&&this.disableSnippy&&(e.snippy={enabled:!1},Object.keys(e).forEach(r=>{r.startsWith("intent")&&delete e[r]}))}getExtraHeaders(){let e={};return this.disableSnippy&&(e["Editor-Plugin-Version"]="simulation-tests-plugin/2",e["Editor-Version"]="simulation-tests-editor/1.85"),e}async processResponseFromChatEndpoint(e,r,n,o,s,a,c){return tFe(e,r,n,o,s,a,c)}};var bO=ae("IPromptVariablesService");var fg=z(require("vscode"));var pg=ae("IConversationStore"),_O=class{constructor(){this.conversationMap=new Map}addConversation(e,r){this.conversationMap.set(e,r)}getConversation(e){return this.conversationMap.get(e)}};var NS=ae("IUserFeedbackService"),DS=class{constructor(e,r,n){this.telemetryService=e;this.conversationStore=r;this.feedbackReporter=n}handleUserAction(e,r){let n=fg.window.activeTextEditor?.document,o=fg.window.activeTextEditor?.selection,s=e.result,a=s.metadata?.responseId&&this.conversationStore.getConversation(s.metadata.responseId);switch(e.action.kind){case"copy":this.telemetryService.sendMSFTTelemetryEvent("panel.action.copy",{languageId:n?.languageId,requestId:s.metadata?.responseId,participant:r,command:s.metadata?.command},{codeBlockIndex:e.action.codeBlockIndex,copyType:e.action.copyKind,characterCount:e.action.copiedCharacters,lineCount:e.action.copiedText.split(`
`).length});break;case"insert":this.telemetryService.sendMSFTTelemetryEvent("panel.action.insert",{languageId:n?.languageId,requestId:s.metadata?.responseId,participant:r,command:s.metadata?.command},{codeBlockIndex:e.action.codeBlockIndex,characterCount:e.action.totalCharacters});break;case"runInTerminal":this.telemetryService.sendMSFTTelemetryEvent("panel.action.runinterminal",{languageId:n?.languageId,requestId:s.metadata?.responseId,blockLanguage:e.action.languageId,participant:r,command:s.metadata?.command},{codeBlockIndex:e.action.codeBlockIndex});break;case"followUp":this.telemetryService.sendMSFTTelemetryEvent("panel.action.followup",{languageId:n?.languageId,requestId:s.metadata?.responseId,participant:r,command:s.metadata?.command});break;case"bug":a&&this.feedbackReporter.reportChat(a.getLatestTurn());break}if(e.action.kind==="copy"||e.action.kind==="insert"){let c={};c={totalCharacters:e.action.totalCharacters},e.action.kind==="copy"&&(c={...c,copiedCharacters:e.action.copiedCharacters}),n&&o&&(c={...c,cursorLocation:n.offsetAt(o.active)}),bf(this.telemetryService,fg.window.activeTextEditor?.document,{codeBlockIndex:e.action.codeBlockIndex.toString(),messageId:s.metadata?.modelMessageId??"",headerRequestId:s.metadata?.responseId??""},c,e.action.kind==="copy"?"conversation.acceptedCopy":"conversation.acceptedInsert")}}handleFeedback(e,r){let n=fg.window.activeTextEditor?.document,o=e.result;this.telemetryService.sendMSFTTelemetryEvent("panel.action.vote",{languageId:n?.languageId,requestId:o.metadata?.responseId,participant:r,command:o.metadata?.command},{direction:e.kind===fg.ChatResultFeedbackKind.Helpful?1:2}),bf(this.telemetryService,n,{rating:e.kind===fg.ChatResultFeedbackKind.Helpful?"positive":"negative",messageId:o.metadata?.modelMessageId??"",headerRequestId:o.metadata?.responseId??""},{},"conversation.messageRating")}};DS=O([x(0,me),x(1,pg),x(2,E1)],DS);var LS=new Map,$R=class{constructor(e){this.label=e;this.iconPath=new Qe.ThemeIcon("lock")}},gV="github",xO="platform",ele={web:"bing-search",kb:"kb-search"},vV="kb:",tle="github.copilot.chat.selectKnowledgeBase",OS=class{constructor(e,r,n,o,s,a,c,u,l,d,p,f,m,h,g){this.logService=e;this.fetcherService=r;this.envService=n;this.promptVariablesService=o;this.workspaceService=s;this.tabsAndEditorsService=a;this.ignoreService=c;this.gitService=u;this.githubRepositoryService=l;this.chatMLFetcher=d;this.vscodeExtensionContext=p;this.authenticationService=f;this.configurationService=m;this.domainService=h;this.userFeedbackService=g;this.disposables=new Tt;this.knowledgeBases=null;this.organizationsMissingSSO=void 0;this.logger=this.logService.getLogger("RemoteAgents");this.disposables.add(new Qe.Disposable(()=>LS.forEach(v=>v.dispose()))),this.disposables.add(Qe.commands.registerCommand(tle,async()=>{let v=Qe.window.createQuickPick();v.placeholder=Qe.l10n.t("Select a knowledge base"),v.busy=!0,v.show(),v.items=await this.getKnowledgeBaseAutocompleteQuickPickItems(),v.busy=!1;let y=await new Promise((b,_)=>{v.canSelectMany=!1;let S=!1;v.onDidAccept(async()=>{if(v.selectedItems[0]instanceof $R){v.busy=!0;let I=await this.authenticationService.getPermissiveGitHubSession({forceNewSession:!0});if(!I){this.logger.error("Failed to get a new auth session for knowledge base selection"),b(void 0),v.hide();return}if(S=!0,this.organizationsMissingSSO=void 0,this.knowledgeBases?.clear(),v.items=await this.getKnowledgeBaseAutocompleteQuickPickItems(I.accessToken),v.items.length===1&&v.items[0]instanceof $R){this.logger.error("Failed to fetch new knowledge bases after fetching new auth session"),b(void 0),v.hide();return}v.busy=!1,v.show()}else b(v.selectedItems[0]),v.hide()}),v.onDidHide(()=>{S||b(void 0)})});return v.dispose(),y?.insertText})),this.refreshRemoteAgents(),this.disposables.add(this.authenticationService.onDidAuthenticationChange(()=>{this.refreshRemoteAgents()}))}dispose(){this.disposables.dispose()}async refreshRemoteAgents(){return this.refreshRemoteAgentsP||(this.refreshRemoteAgentsP=this._doRefreshRemoteAgents()),this.refreshRemoteAgentsP.finally(()=>this.refreshRemoteAgentsP=void 0)}async _doRefreshRemoteAgents(){let e=this.logService.getLogger("RemoteAgents"),r=new Set(LS.keys());try{let n=this.authenticationService.anyGitHubSession?.accessToken;if(!n){e.warn("Unable to fetch remote agents because user is not signed in.");return}(await this.authenticationService.getCopilotToken()).sku?.startsWith("copilot_enterprise")&&(r.delete(xO)||LS.set(xO,this.registerAgent(e,null)));let a=await(await this.fetcherService.fetch(this.domainService.remoteAgentsURL,{method:"GET",headers:{Authorization:zR.format("Bearer %s",n),...this.envService.getEditorVersionHeaders()}})).text(),c;try{if(c=JSON.parse(a).agents,!Array.isArray(c))throw new Error("Expected 'agents' to be an array")}catch(u){a.includes("access denied")||e.warn(`Invalid remote agent response: ${a} (${u})`);return}for(let u of c)r.delete(u.slug)||LS.set(u.slug,this.registerAgent(e,u))}catch(n){e.error("Failed to load remote slash commands",n)}for(let n of r)LS.get(n).dispose(),LS.delete(n)}checkAuthorized(e){let r=`copilot.agent.${e}.authorized`;return this.vscodeExtensionContext.globalState.get(r,!1)||this.vscodeExtensionContext.workspaceState.get(r,!1)}async setAuthorized(e,r=!1){await(r?this.vscodeExtensionContext.globalState:this.vscodeExtensionContext.workspaceState).update(`copilot.agent.${e}.authorized`,!0)}registerAgent(e,r){let n=new Tt,o=`github.copilot-dynamic.${r?.slug??xO}`,s=r?.slug??gV,a=r?.description??"Get answers grounded in web search, code search, and your enterprise's knowledge bases",c={name:s,description:a,publisherName:r?.owner_login??"GitHub",fullName:r?.name??"GitHub"},u=!1,l=n.add(Qe.chat.createDynamicChatParticipant(o,c,async(d,p,f,m)=>{let h=iFe(p),g=Br(),v=Br(),y={sessionId:h,modelMessageId:v,responseId:g,agentId:o,command:d.command};if(this.configurationService.getConfig(fe.RemoteAgentImplicitContextEnabled)&&d.acceptedConfirmationData)for(let b of d.acceptedConfirmationData){if(b?.url)return await this.setAuthorized(s,d.prompt.startsWith(Qe.l10n.t("Authorize for all workspaces"))),await Qe.commands.executeCommand("vscode.open",Ur.parse(b.url)),f.markdown(Qe.l10n.t("Please complete authorization in your browser and resend your question.")),{metadata:y};if(b?.hasAcknowledgedImplicitReferences)return await this.setAuthorized(s,d.prompt.startsWith(Qe.l10n.t("Allow for All Workspaces"))),f.markdown(Qe.l10n.t("Your preference has been saved.")),{metadata:y}}try{let b=new AS(this.domainService,{capabilities:{type:"chat",family:"remote"},id:"gpt-3.5-turbo",name:"Remote Agents",version:"1.0"},4096,void 0,r?`${this.domainService.remoteAgentsURL}/${r.slug}?chat`:`${this.domainService.remoteAgentsURL}/chat`),_=await this.promptVariablesService.resolveVariablesInPrompt(d.prompt,d.references),S=[],{copilot_skills:I,copilot_references:T}=await this.resolveCopilotSkills(s,d);T&&S.push(...T);let A=!1;try{let w=await this.prepareClientPlatformReferences([...d.references],s);A=w.hasIgnoredFiles,w.clientReferences&&S.push(...w.clientReferences);for(let P of w.vscodeReferences)f.reference(P)}catch(w){return w instanceof Error&&w.message.includes("File seems to be binary and cannot be opened as text")?(f.markdown(Qe.l10n.t("Sorry, binary files are not currently supported.")),{metadata:y}):{errorDetails:{message:w.message},metadata:y}}let B=new Map,j=rFe(d),F,ne,Y=!1,N=await this.chatMLFetcher.fetchMany([...nFe(o,p),{role:"user",content:d.acceptedConfirmationData?.length||d.rejectedConfirmationData?.length?"":_.message,...S.length?{copilot_references:S}:void 0,copilot_confirmations:j?.length?j:void 0}],async(w,P,q)=>{if(q.copilotReferences){let Z=(le,re)=>{let X="url"in le?le.url:"url"in le.data?le.data.url:void 0;if(X&&typeof X=="string"&&!B.has(X)){let Ve;if(Mae(le)){let ie=Ur.joinPath(this.vscodeExtensionContext.extensionUri,"assets","bing.svg");Ve={light:ie,dark:ie}}else new URL(X).hostname==="github.com"&&(Ve=new Qe.ThemeIcon("github"));F?F?.report(new Qe.ChatResponseReferencePart(Ur.parse(X),Ve)):f.reference(Ur.parse(X),Ve),B.set(X,re??le)}};for(let le of q.copilotReferences)Array.isArray(le.data.results)?le.data.results.forEach(re=>{Z(re,le)}):"url"in le.data&&typeof le.data.url=="string"&&Z(le)}let U=(Z,le)=>{ne?.deferred.complete(ne.resolvedMessage),F=Z;let re=new Yp;return ne={deferred:re,resolvedMessage:le},re.p};if(q.copilotFunctionCalls)for(let Z of q.copilotFunctionCalls)switch(Z.name){case"bing-search":{try{let le=JSON.parse(Z.arguments);f.progress(Qe.l10n.t('Searching Bing for "{0}"...',le.query),async re=>U(re,Qe.l10n.t('Bing search results for "{0}"',le.query)))}catch{}break}case"kb-search":{try{let le=JSON.parse(Z.arguments);f.progress(Qe.l10n.t('Searching knowledge base for "{0}"...',le.query),async re=>U(re,Qe.l10n.t('Knowledge base results for "{0}"',le.query)))}catch{}break}case"codesearch":{try{let le=JSON.parse(Z.arguments);f.progress(Qe.l10n.t('Searching {0} for "{1}"...',le.scopingQuery,le.query),async re=>U(re,Qe.l10n.t('Code search results for "{0}" in {1}',le.query,le.scopingQuery)))}catch{}break}}if(q.copilotErrors&&typeof f.warning=="function"){Y=!0;for(let Z of q.copilotErrors)F?F?.report(new Qe.ChatResponseWarningPart(Z.message)):f.warning(Z.message)}if(q.copilotConfirmation){Y=!0;let Z=q.copilotConfirmation;f.confirmation(Z.title,Z.message,Z.confirmation)}if(q.text){ne?.deferred.complete(ne.resolvedMessage);let Z=new Qe.MarkdownString(q.text);Z.supportHtml=!0,f.markdown(Z)}},m,2,b,void 0,{secretKey:this.authenticationService.anyGitHubSession?.accessToken,copilot_thread_id:h,...I?{copilot_skills:I}:void 0},{messageSource:`serverAgent.${r?.slug??xO}`});if(y.copilot_references=[...new Set(B.values()).values()],N.type==="success"&&A&&f.markdown(Qe.l10n.t(pD)),N.type!=="success"){if(e.warn(`Bad response from /agents/${s}: ${N.type} ${N.reason}`),N.reason.includes("400 no docs found"))return{errorDetails:{message:"No docs found"},metadata:y};if(N.type==="agent_unauthorized")if(this.configurationService.getConfig(fe.RemoteAgentImplicitContextEnabled)){let w=new URL(N.authorizationUrl);return f.confirmation(Qe.l10n.t("Authorize agent"),Qe.l10n.t("By default, **@{0}** will read your active file and selection. Please authorize usage of **@{0}** on {1} and resend your question.",s,w.hostname),{url:N.authorizationUrl},[Qe.l10n.t("Authorize"),Qe.l10n.t("Authorize for All Workspaces")]),{metadata:y}}else{f.markdown(Qe.l10n.t("Please authorize usage of this agent and resend your question."));let w=Ur.parse(N.authorizationUrl),P=new URL(N.authorizationUrl);f.button({command:"vscode.open",title:Qe.l10n.t("Authorize on {0}",P.hostname),arguments:[w]})}else{if(N.type==="agent_failed_dependency")return{errorDetails:{message:Qe.l10n.t("Sorry, an error occurred: {0}",N.reason)},metadata:y};if(N.type!=="unknown"||!Y)return{errorDetails:{message:N.reason},metadata:y}}}return this.configurationService.getConfig(fe.RemoteAgentImplicitContextEnabled)&&!this.checkAuthorized(s)&&!u&&(f.confirmation(Qe.l10n.t("Grant access to editor context"),Qe.l10n.t("**@{0}** would like to read your active file and selection.",s),{hasAcknowledgedImplicitReferences:!0},[Qe.l10n.t("Allow"),Qe.l10n.t("Allow for All Workspaces")]),u=!0),{metadata:y}}catch(b){return e.warn(`/agents/${s} failed: ${b}`),{metadata:y}}}));return l.iconPath=r?Ur.parse(r.avatar_url):new Qe.ThemeIcon("github"),s===gV&&(l.participantVariableProvider={triggerCharacters:["#"],provider:{provideCompletionItems:async(d,p)=>(await this.getPlatformAgentSkills()).map(m=>{let h=new Qe.ChatCompletionItem(`copilot.${m.name}`,"#"+m.name,[{value:m.insertText,level:Qe.ChatVariableLevel.Full,description:m.description}]);return h.command=m.command,h.detail=m.description,h.fullName=m.fullName,h.icon=m.icon,h})}}),n.add(l.onDidReceiveFeedback(d=>this.userFeedbackService.handleFeedback(d,o))),n}async prepareClientPlatformReferences(e,r){let n=[],o=[],s=!1,a=!1,c=async(p,f)=>{let m=SO.basename(p.uri.toString()),h=p.getText(f);return await this.ignoreService.isCopilotIgnored(p.uri)?(s=!0,h="content-exclusion"):m.startsWith(".")?h="hidden-file":Buffer.byteLength(h,"utf8")>1024**3&&(h="file-too-large"),h},u=async(p,f)=>{n.push({type:"client.file",data:{language:p.languageId,content:await c(p)},id:SO.basename(p.uri.path)}),o.push(f?{variableName:f,value:p.uri}:p.uri)},l=async(p,f,m=!1)=>{let h=p.selection.start.line,g=p.selection.isEmpty?new Qe.Range(new Qe.Position(h,0),new Qe.Position(h+1,0)):p.selection;n.push({type:"client.selection",data:{start:{line:g.start.line,col:g.start.character},end:{line:g.end.line,col:g.end.character},content:await c(p.document,g)},id:SO.basename(p.document.uri.path)}),m&&o.push(f?{variableName:f,value:new Qe.Location(p.document.uri,g)}:new Qe.Location(p.document.uri,g))};if(this.configurationService.getConfig(fe.RemoteAgentImplicitContextEnabled)&&this.checkAuthorized(r)){let{activeTextEditor:p}=this.tabsAndEditorsService;p&&(await u(p.document),await l(p),a=!0)}for(let p of e)if(p.value instanceof Ur){let f=await this.workspaceService.openTextDocument(p.value);await u(f,p.name)}else if(p.name==="selection"){let{activeTextEditor:f}=this.tabsAndEditorsService;if(!f)throw new Error(Qe.l10n.t({message:"Please open a text editor to use the `#selection` variable.",comment:"{Locked='`#selection`'}"}));a||await l(f,p.name,!0)}this.gitService.isInitialized||await this.gitService.initialize();let d=this.gitService.repositories;for(let p of d){let f=tx(p);if(f)try{let[m,h]=f?.split("/"),g=await this.githubRepositoryService.getRepositoryInfo(m,h);n.push({type:"github.repository",id:f,data:{type:"repository",name:h,ownerLogin:m,id:g.id}})}catch(m){m instanceof Error&&m.message.includes("Failed to fetch repository info")&&this.authenticationService.getPermissiveGitHubSession({silent:!0}),this.logger.warn("Failed to fetch info about current GitHub repository",m)}}return{clientReferences:n,vscodeReferences:o,hasIgnoredFiles:s}}async listEnabledSkills(e){if(!this.enabledSkillsPromise){let r=await this.fetcherService.fetch(this.domainService.listSkillsURL,{method:"GET",headers:{Authorization:zR.format("Bearer %s",e),...this.envService.getEditorVersionHeaders()}});this.enabledSkillsPromise=r.json().then(n=>n?.skills.reduce((o,s)=>o.add(s.slug),new Set))}return this.enabledSkillsPromise}async resolveCopilotSkills(e,r){if(e===gV){let n=new Set,o=new Set;for(let s of r.references)if(ele[s.name])n.add(ele[s.name]);else if(s.name.startsWith(vV)){n.add("kb-search"),await this.getKnowledgeBases();let a=this.knowledgeBases?.get(s.name.slice(vV.length));a&&o.add(a)}return{copilot_skills:[...n],copilot_references:[...o]}}return{copilot_skills:[]}}async getKnowledgeBases(e){if(this.knowledgeBases?.size)return{knowledgeBases:[...this.knowledgeBases.values()],organizationsMissingSSO:this.organizationsMissingSSO};let r=e??(await this.authenticationService.getPermissiveGitHubSession({createIfNone:!0}))?.accessToken;if(!r)return this.logger.debug("No auth token available to fetch knowledge bases"),{knowledgeBases:[],organizationsMissingSSO:void 0};let n=await this.listKnowledgeBases(r),o=await n.text();if(n.headers.get("X-GitHub-SSO")){let s=n.headers.get("X-GitHub-SSO")?.split("partial-results; organizations=")[1];if(s){let a=s.split(",");this.logger.debug(`Missing knowledge bases SSO for ${a.length} organizations: ${s}`);let c=await this.getOrganizationName(r,parseInt(a[0]));c?this.organizationsMissingSSO={name:c,numberOfOrganizations:a.length}:this.organizationsMissingSSO={name:void 0,numberOfOrganizations:a.length}}}try{let s=JSON.parse(o);this.knowledgeBases=new Map;let a=s.map(c=>({label:c.name,organization:c.owner.login,iconPath:new Qe.ThemeIcon("github"),insertText:c.name,name:c.name,description:c.description,type:"github.knowledge-base",id:(0,rle.randomUUID)(),data:{type:"knowledge-base",id:c.id}}));for(let c of a)this.knowledgeBases.set(c.name,c);return{knowledgeBases:[...this.knowledgeBases.values()],organizationsMissingSSO:this.organizationsMissingSSO}}catch(s){return this.logger.error(s),{knowledgeBases:[],organizationsMissingSSO:this.organizationsMissingSSO}}}async getOrganizationName(e,r){let n=await this.fetcherService.fetch(`https://api.github.com/user/${r}`,{method:"GET",headers:{Authorization:zR.format("Bearer %s",e),...this.envService.getEditorVersionHeaders()}});if(n.ok)return(await n.json()).name}async listKnowledgeBases(e){return this.fetcherService.fetch("https://api.github.com/user/knowledge-bases",{method:"GET",headers:{Authorization:zR.format("Bearer %s",e),...this.envService.getEditorVersionHeaders()}})}async getKnowledgeBaseAutocompleteQuickPickItems(e){let{knowledgeBases:r,organizationsMissingSSO:n}=await this.getKnowledgeBases(e),o=[];if(n){let a;n.name&&n.numberOfOrganizations>1?a=Qe.l10n.t("Single-sign on to see knowledge bases from {0} and {1} other organizations",n.name,n.numberOfOrganizations-1):n.name?a=Qe.l10n.t("Single-sign on to see knowledge bases from the {0} organization",n.name):n.numberOfOrganizations===1?a=Qe.l10n.t("Single-sign on to see knowledge bases from 1 additional organization"):a=Qe.l10n.t("Single-sign on to see knowledge bases from {0} additional organizations",n.numberOfOrganizations),o.push(new $R(a)),o.push({kind:Qe.QuickPickItemKind.Separator,label:""})}let s=new Map;for(let a of r){let c=a.organization;s.has(c)||s.set(c,[]),s.get(c)?.push(a)}for(let a of[...s.keys()].sort()){let c=s.get(a);c?.length&&(o.push({kind:Qe.QuickPickItemKind.Separator,label:a}),o.push(...c.sort((u,l)=>u.label.localeCompare(l.label))))}return o}async getPlatformAgentSkills(){let e=this.authenticationService.anyGitHubSession?.accessToken;if(!e)return[];let r=await this.listEnabledSkills(e);return[{name:"web",insertText:"#web",description:"Search Bing for real-time context",kind:"bing-search",command:void 0},{name:"kb",insertText:`#${vV}`,icon:new Qe.ThemeIcon("book"),fullName:"Knowledge Bases...",description:"Search your enterprises' knowledge bases",kind:"kb-search",command:{title:"",command:tle}}].filter(n=>r.has(n.kind))}};OS=O([x(0,ue),x(1,$r),x(2,Rt),x(3,bO),x(4,Je),x(5,kt),x(6,De),x(7,go),x(8,lu),x(9,Bt),x(10,ar),x(11,Nt),x(12,ye),x(13,yn),x(14,NS)],OS);function rFe(t){return[...t.acceptedConfirmationData?.map(r=>({state:"accepted",confirmation:r}))??[],...t.rejectedConfirmationData?.map(r=>({state:"dismissed",confirmation:r}))??[]]}function nFe(t,e){let r=[];for(let n of e.history)if(n.participant===t&&(n instanceof Qe.ChatRequestTurn&&r.push({role:"user",content:n.prompt}),n instanceof Qe.ChatResponseTurn)){let o=n.result.metadata?.copilot_references,s=n.response.map(a=>a instanceof Qe.ChatResponseMarkdownPart?a.value.value:"content"in a?a.content:null).filter(a=>!!a).join("");r.push({role:"assistant",content:s,...o?{copilot_references:o}:void 0})}return r}function iFe(t){let e;for(let r of t.history)if(r instanceof Qe.ChatResponseTurn){let n=r.result.metadata?.sessionId;if(typeof n=="string"){e=n;break}}return e??Br()}var Su=z(require("vscode")),tme=z(require("dns")),rme=z(require("util"));var nle=z(require("fs")),ile=z(require("os")),br=z(require("vscode"));var oFe="```",WR,MS=class extends Ct{constructor(r){super();this.configurationService=r;this.notebookDocIsOpen=!1;this.updateScheduler=this._register(new sD(()=>this.writeNotebook(),100)),this.logUri,this._register(br.workspace.onDidOpenNotebookDocument(n=>{n.uri.toString()===this.logUri?.toString()&&(this.notebookDocIsOpen=!0,this.updateScheduler.schedule())})),this._register(br.workspace.onDidCloseNotebookDocument(n=>{n.uri.toString()===this.logUri?.toString()&&(this.notebookDocIsOpen=!1)}))}get logUri(){if(!this.configurationService.getConfig(fe.ConversationLoggingEnabled)||!this.configurationService.getConfig(fe.NotebookLoggingEnabled)){this.mdLogPath=void 0,WR=void 0;return}if(!this.mdLogPath){let r=Math.random().toString(36).substring(2,10);this.mdLogPath=Ur.joinPath(Ur.file(ile.tmpdir()),`copilot-chat-log-${r}.ipynb`),WR=this.mdLogPath,nle.promises.writeFile(this.mdLogPath.fsPath,""),console.log("Logging .ipynb file to "+this.mdLogPath.fsPath)}return this.mdLogPath}logRequest(r,n){this.logUri&&(this.currentLogModel={request:r,endpoint:n,isDone:!1},this.updateScheduler.schedule())}logMessages(r){!this.currentLogModel||this.currentLogModel.isDone||(this.currentLogModel.messages=r,this.updateScheduler.schedule())}getNotebookData(){let r=this.currentLogModel?[new br.NotebookCellData(br.NotebookCellKind.Code,JSON.stringify(this.currentLogModel.request,void 0,4),"json"),new br.NotebookCellData(br.NotebookCellKind.Code,`// Endpoint:
`+JSON.stringify(this.currentLogModel.endpoint,void 0,4),"json")]:[],n=this.currentLogModel?.messages?.map(u=>{if(u.name||u.copilot_confirmations||u.copilot_references){let l=`Role: ${u.role}
`;return u.name&&(l+=`Name: ${u.name}
`),u.copilot_confirmations&&(l+=`Confirmations: ${u.copilot_confirmations}
`),u.copilot_references&&(l+=`References: ${u.copilot_references}
`),l+=`${u.content}
${oFe}

`,new br.NotebookCellData(br.NotebookCellKind.Code,l,"markdown")}else return new br.NotebookCellData(br.NotebookCellKind.Code,`${u.role}: ${u.content}`,"markdown")})??[],o=this.currentLogModel?.progressParts?.map(u=>u instanceof br.ChatResponseMarkdownPart?typeof u.value=="string"?u.value:u.value.value:JSON.stringify(u)+`
`)??[],s=new br.NotebookCellData(br.NotebookCellKind.Code,o.join(""),"markdown"),a=this.currentLogModel?.streamChoices?.map(u=>{let l={...u};return delete l.index,delete l.content_filter_offsets,delete l.content_filter_results,l.delta&&!l.delta.role&&delete l.delta.role,JSON.stringify(l)})??[],c=new br.NotebookCellData(br.NotebookCellKind.Code,a.join(`
`)??"","json");return new br.NotebookData([new br.NotebookCellData(br.NotebookCellKind.Markup,"## Request","markdown"),...r,new br.NotebookCellData(br.NotebookCellKind.Markup,"## Messages","markdown"),...n,new br.NotebookCellData(br.NotebookCellKind.Markup,"## Response","markdown"),s,new br.NotebookCellData(br.NotebookCellKind.Markup,"## Raw Stream","markdown"),c])}async writeNotebook(){if(this.logUri&&this.notebookDocIsOpen){let r=this.getNotebookData(),n=new br.WorkspaceEdit;n.set(this.logUri,[new br.NotebookEdit(new br.NotebookRange(0,1e6),r.cells)]),await br.workspace.applyEdit(n)||console.error("Failed to write log notebook")}}logProgress(r){!this.currentLogModel||this.currentLogModel.isDone||(this.currentLogModel.progressParts=this.currentLogModel.progressParts||[],this.currentLogModel.progressParts.push(r),this.updateScheduler.schedule())}logRawStreamChoice(r){!this.currentLogModel||this.currentLogModel.isDone||(this.currentLogModel.streamChoices=this.currentLogModel.streamChoices||[],this.currentLogModel.streamChoices.push(r),this.updateScheduler.schedule())}logResult(r){!this.currentLogModel||this.currentLogModel.isDone||(this.currentLogModel.result=r,this.currentLogModel.isDone=!0)}};MS=O([x(0,ye)],MS);var bV=require("stream");var mg=class{},sFe=30*1e3;function ole(t,e,r,n,o,s,a,c,u,l,d,p){let f=typeof s=="string"?{modelMaxPromptTokens:0,url:s,family:"",name:"",version:""}:s,m={Authorization:`Bearer ${a}`,"X-Request-Id":l,"X-GitHub-Api-Version":"2023-07-07","Openai-Organization":"github-copilot","Copilot-Integration-Id":e.isProduction()?"vscode-chat":"vscode-chat-dev","VScode-SessionId":e.sessionId,"VScode-MachineId":e.machineId,...e.getEditorVersionHeaders(),...f.getExtraHeaders?f.getExtraHeaders():{}};if(f.interceptBody&&f.interceptBody(d),u&&(m["OpenAI-Intent"]=u),!e.isProduction()&&f.url.includes(n.capiBaseURL)){if(!c)throw new Error("HMAC must be provided for non-production requests");m["Request-Hmac"]=c}let h={method:o,headers:m,json:d,timeout:sFe},g=t;if(p){let y=g.makeAbortController();p.onCancellationRequested(()=>{r.sendGHTelemetryEvent("networking.cancelRequest",{headerRequestId:l}),y.abort()}),h.signal=y.signal}return g.fetch(f.url,h).catch(y=>{if(y.code==="ECONNRESET"||y.code==="ETIMEDOUT"||y.code==="ERR_HTTP2_INVALID_SESSION"||y.code==="ERR_HTTP2_STREAM_CANCEL"||y.message==="ERR_HTTP2_GOAWAY_SESSION")return r.sendGHTelemetryEvent("networking.disconnectAll"),g.disconnectAll().then(()=>g.fetch(f.url,h));throw g.isAbortError(y)?new fo:y})}function FS(t,e,r,n,o,s,a,c,u,l,d){return ole(t,e,r,n,"POST",o,s,a,c,u,l,d)}function yV(t,e,r,n,o,s,a,c,u,l,d){return ole(t,e,r,n,"GET",o,s,a,c,u,l,d)}var sle=ae("headerContributors"),IO=class{constructor(){this.contributors=[]}add(e){this.contributors.push(e)}remove(e){let r=this.contributors.indexOf(e);r!==-1&&this.contributors.splice(r,1)}contributeHeaders(e){for(let r of this.contributors)r.contributeHeaderValues(e)}size(){return this.contributors.length}};var US=class t extends mg{constructor(r,n){super();this._net=r;this._envService=n}static create(r){let n=aFe();return n?new t(n,r):null}async fetch(r,n){let o=n.headers||{};o["User-Agent"]=`GitHubCopilotChat/${this._envService.getVersion()}`;let s=n.body;if(n.json){if(n.body)throw new Error("Illegal arguments! Cannot pass in both 'body' and 'json'!");o["Content-Type"]="application/json",s=JSON.stringify(n.json)}let a=n.method||"GET";if(a!=="GET"&&a!=="POST")throw new Error("Illegal arguments! 'method' must be either 'GET' or 'POST'!");let c=n.signal??new AbortController().signal;if(c&&!(c instanceof AbortSignal))throw new Error("Illegal arguments! 'signal' must be an instance of AbortSignal!");return this._fetch(r,a,o,s,c)}async _fetch(r,n,o,s,a){let c=await this._net.fetch(r,{method:n,headers:o,body:s,signal:a});return new uh(c.status,c.statusText,c.headers,()=>c.text(),()=>c.json(),async()=>{if(!c.body)return bV.Readable.from([]);let u=c.body[Symbol.asyncIterator]();return bV.Readable.from(u)})}async disconnectAll(){}makeAbortController(){return new AbortController}isAbortError(r){return r&&r.name==="AbortError"}isDNSLookupFailedError(r){return r?.message==="net::ERR_INTERNET_DISCONNECTED"}isFetcherError(r){return r&&r.message&&r.message.startsWith("net::")}getUserMessageForFetcherError(r){return`Please check your firewall rules and network connection then try again. Error Code: ${r.message}.`}};function aFe(){try{return require("electron").net}catch{}}var cFe=z(require("http")),uFe=z(require("https"));var BS=class extends mg{constructor(r){super();this._envService=r}fetch(r,n){let o=n.headers||{};o["User-Agent"]=`GitHubCopilotChat/${this._envService.getVersion()}`;let s=n.body;if(n.json){if(n.body)throw new Error("Illegal arguments! Cannot pass in both 'body' and 'json'!");o["Content-Type"]="application/json",s=JSON.stringify(n.json)}let a=n.method||"GET";if(a!=="GET"&&a!=="POST")throw new Error("Illegal arguments! 'method' must be either 'GET' or 'POST'!");let c=n.signal??new AbortController().signal;if(c&&!(c instanceof AbortSignal))throw new Error("Illegal arguments! 'signal' must be an instance of AbortSignal!");return this._fetch(r,a,o,s,c)}_fetch(r,n,o,s,a){return new Promise((c,u)=>{let d=(r.startsWith("https:")?uFe:cFe).request(r,{method:n,headers:o},p=>{if(a.aborted){p.destroy(),d.destroy(),u(_V(a));return}let f=new xV(d,p,a);c(new uh(p.statusCode||0,p.statusMessage||"",f.headers,async()=>f.text(),async()=>f.json(),async()=>f.body()))});d.setTimeout(60*1e3),d.on("error",u),s&&d.write(s),d.end()})}async disconnectAll(){}makeAbortController(){return new AbortController}isAbortError(r){return lFe(r)}isDNSLookupFailedError(r){return r&&r.code==="ENOTFOUND"}isFetcherError(r){return r&&["EADDRINUSE","ECONNREFUSED","ECONNRESET","ENOTFOUND","EPIPE","ETIMEDOUT"].includes(r.code)}getUserMessageForFetcherError(r){return`Please check your firewall rules and network connection then try again. Error Code: ${r.code}.`}};function _V(t){return t.reason}function lFe(t){return t&&t.name==="AbortError"}var xV=class{constructor(e,r,n){this.req=e;this.res=r;this.signal=n;this.headers=new class{get(o){let s=r.headers[o];return Array.isArray(s)?s[0]:s??null}[Symbol.iterator](){let o=Object.keys(r.headers),s=0;return{next:()=>{if(s>=o.length)return{done:!0,value:void 0};let a=o[s++];return{done:!1,value:[a,this.get(a)]}}}}}}text(){return new Promise((e,r)=>{let n=[];this.res.on("data",o=>n.push(o)),this.res.on("end",()=>e(Buffer.concat(n).toString())),this.res.on("error",r),this.signal.addEventListener("abort",()=>{this.res.destroy(),this.req.destroy(),r(_V(this.signal))})})}async json(){let e=await this.text();return JSON.parse(e)}async body(){return this.signal.addEventListener("abort",()=>{this.res.emit("error",_V(this.signal)),this.res.destroy(),this.req.destroy()}),this.res}};var WS=z(xde(),1),Bnr={ALPN_HTTP2:WS.default.ALPN_HTTP2,ALPN_HTTP2C:WS.default.ALPN_HTTP2C,ALPN_HTTP1_1:WS.default.ALPN_HTTP1_1,ALPN_HTTP1_0:WS.default.ALPN_HTTP1_0},{fetch:qnr,context:Sde,reset:Hnr,noCache:jnr,h1:Vnr,keepAlive:Gnr,h1NoCache:znr,keepAliveNoCache:$nr,cacheStats:Wnr,clearCache:Knr,offPush:Ynr,onPush:Qnr,createUrl:Xnr,timeoutSignal:Jnr,Body:Znr,Headers:eir,Request:tir,Response:rir,AbortController:Ide,AbortError:Cde,AbortSignal:nir,FetchBaseError:iir,FetchError:eG,ALPN_HTTP2:oir,ALPN_HTTP2C:sir,ALPN_HTTP1_1:air,ALPN_HTTP1_0:cir}=WS.default;var Kfe=z(require("tls"));var $fe=z(require("fs"));var GO=ae("IWindowsCaCertsLoader");var E3=ae("IRootCertificateReader"),lI=class{constructor(e,r){this.instantiationService=r;this.logger=e.getLogger("certificates"),this.delegate=new az(new cz(this.createPlatformRootCertificateReader()))}async getAllRootCAs(){try{return await this.delegate.getAllRootCAs()}catch(e){return this.logger.warn(`Failed to read root certificates: ${e}`),[]}}createPlatformRootCertificateReader(){let e;switch(process.platform){case"linux":e=uz;break;case"darwin":e=lz;break;case"win32":e=gk;break;default:e=dz;break}return this.instantiationService.createInstance(e)}};lI=O([x(0,ue),x(1,te)],lI);var az=class{constructor(e){this.delegate=e}async getAllRootCAs(){return this.certificates||(this.certificates=await this.delegate.getAllRootCAs()),this.certificates}},cz=class{constructor(e){this.delegate=e}async getAllRootCAs(){let e=await this.delegate.getAllRootCAs(),r=process.env.NODE_EXTRA_CA_CERTS;if(!r)return e;let n=await Wfe(r);return e.concat(n)}},uz=class{async getAllRootCAs(){let e=[];for(let r of["/etc/ssl/certs/ca-certificates.crt","/etc/ssl/certs/ca-bundle.crt"]){let n=await Wfe(r);e=e.concat(n)}return e}},lz=class{async getAllRootCAs(){let e=zfe();return e.all(e.der2.pem).filter(r=>r!==void 0)}},gk=class{constructor(e){this.windowsCaCertsLoader=e}async getAllRootCAs(){return await this.windowsCaCertsLoader.loadCaCerts()||[]}};gk=O([x(0,GO)],gk);var dz=class{async getAllRootCAs(){throw new Error("No certificate reader available for unsupported platform")}};async function Wfe(t){try{let n=(await $fe.promises.readFile(t,{encoding:"utf8"})).split(/(?=-----BEGIN CERTIFICATE-----)/g).filter(s=>s.length>0),o=new Set(n);return Array.from(o)}catch(e){if(e?.code!=="ENOENT")throw e}return[]}var T3=class{constructor(e){this._certificateReader=e.get(E3)}async enhanceProxySettings(e){let r=await this.getCertificates();return{...e,ca:r}}async getCertificates(){let e=await this._certificateReader.getAllRootCAs();if(e.length!==0)return e}async applyToRequestOptions(e){let r=await this._certificateReader.getAllRootCAs(),n={_vscodeAdditionalCaCerts:r};e.secureContext=Kfe.createSecureContext(n),e.ca=r,e.cert=r,r.map(o=>{e.secureContext.context.addCACert(o)})}};var Yfe=z(require("http"));var w3=ae("IKerberosLoader");var HHe=407,R3=ae("IProxySocketFactory"),Mf=class extends Error{constructor(r,n,o){super(r);this.cause=n;this.responseStatus=o}};function Qfe(t){return new pz(t,new fz(t))}var pz=class{constructor(e,r,n=process.platform){this.accessor=e;this.delegate=r;this.platform=n;this.successfullyAuthorized=new w_(20);this.logger=e.get(ue).getLogger("proxy-socket-factory")}async createSocket(e,r){this.successfullyAuthorized.get(this.getProxyCacheKey(r))&&(this.logger.debug("Proxy authorization already successful once, skipping 407 rountrip"),await this.reauthorize(e,r));try{return await this.delegate.createSocket(e,r)}catch(n){if(n instanceof Mf&&n.responseStatus===HHe){this.logger.debug("Proxy authorization required, trying to authorize first time");let o=await this.authorizeAndCreateSocket(e,r);if(o)return this.logger.debug("Proxy authorization successful, caching result"),this.successfullyAuthorized.set(this.getProxyCacheKey(r),!0),o}throw n}}async reauthorize(e,r){let n=await this.authorize(r);n&&(this.logger.debug("Proxy re-authorization successful, received token"),e.headers["Proxy-Authorization"]="Negotiate "+n)}async authorizeAndCreateSocket(e,r){let n=await this.authorize(r);if(this.logger.debug("Proxy authorization successful, received token"),n)return this.logger.debug("Trying to create socket with proxy authorization"),e.headers["Proxy-Authorization"]="Negotiate "+n,await this.delegate.createSocket(e,r)}async authorize(e){this.logger.debug("Loading kerberos module");let r=await jHe(this.accessor);if(!r){this.logger.debug("Could not load kerberos module");return}let n=this.computeSpn(e);this.logger.debug("Initializing kerberos client using spn",n);let o=await r.initializeClient(n);this.logger.debug("Perform client side kerberos step");let s=await o.step("");return this.logger.debug("Received kerberos server response"),s}computeSpn(e){let o=this.accessor.get(ye).getConfig(fe.KerberosServicePrincipal)??e.kerberosServicePrincipal;if(o)return this.logger.debug("Using configured kerberos spn",o),o;let s=this.platform==="win32"?`HTTP/${e.host}`:`HTTP@${e.host}`;return this.logger.debug("Using default kerberos spn",s),s}getProxyCacheKey(e){return e.host+":"+e.port}},fz=class{constructor(e){this.logger=e.get(ue).getLogger("proxy-socket-factory")}async createSocket(e,r){let n=this.createConnectRequestOptions(e,r);return new Promise((o,s)=>{this.logger.debug("Attempting to establish connection to proxy");let a=Yfe.request(n);a.useChunkedEncodingByDefault=!1,a.once("connect",(c,u,l)=>{this.logger.debug("Socket Connect returned status code",c.statusCode),a.removeAllListeners(),u.removeAllListeners(),c.statusCode!==200?(u.destroy(),s(new Mf("tunneling socket could not be established",void 0,c.statusCode))):l.length>0?(u.destroy(),s(new Mf("got illegal response body from proxy"))):(this.logger.debug("Successfully established tunneling connection to proxy"),o(u))}),a.once("error",c=>{if(!c.message&&c instanceof AggregateError){let u=c.stack;c=new AggregateError(c.errors,`Aggregate error:${c.errors.map(l=>`
- ${l.message}`).join("")}`),c.stack=u}this.logger.debug("Proxy socket connection error",c.message),a.removeAllListeners(),s(new Mf("tunneling socket could not be established",c))}),a.on("timeout",()=>{this.logger.debug("Proxy socket connection timeout"),s(new Mf(`tunneling socket could not be established, proxy socket connection timeout while connecting to ${n.host}:${n.port}`))}),a.end()})}createConnectRequestOptions(e,r){let n={...r,method:"CONNECT",path:e.host+":"+e.port,agent:!1,headers:{host:e.host+":"+e.port,"Proxy-Connection":"keep-alive"},timeout:e.timeout};return e.localAddress&&(n.localAddress=e.localAddress),this.configureProxyAuthorization(n,e),n}configureProxyAuthorization(e,r){e.headers["Proxy-Authorization"]=[],e.proxyAuth&&e.headers["Proxy-Authorization"].push("Basic "+Buffer.from(e.proxyAuth).toString("base64")),r.headers&&r.headers["Proxy-Authorization"]&&e.headers["Proxy-Authorization"].push(r.headers["Proxy-Authorization"])}};async function jHe(t){try{return t.get(w3).loadKerberos()}catch{return}}var k3=class extends mg{constructor(r){super();this.accessor=r;this.createSocketFactory=(r,n)=>async o=>{o.rejectUnauthorized=n,o.timeout=r.connectionTimeoutInMs,await this.certificateConfigurator.applyToRequestOptions(o);let s=await this.certificateConfigurator.enhanceProxySettings(r);try{return await this.proxySocketFactory.createSocket(o,s)}catch(a){throw a instanceof Mf&&a.cause?new Error(`${a.message}, cause=${a.cause.message}`):new Error(a.message)}};this.fetchApi=this.createFetchApi(r),this.certificateConfigurator=new T3(r),this.proxySocketFactory=r.get(R3)}set proxySettings(r){this._proxySettings=r,this.fetchApi=this.createFetchApi(this.accessor)}get proxySettings(){return this._proxySettings}set rejectUnauthorized(r){this._rejectUnauthorized=r,this.fetchApi=this.createFetchApi(this.accessor)}get rejectUnauthorized(){return this._rejectUnauthorized}createFetchApi(r){let n=r.get(Rt);return Sde({userAgent:`GitHubCopilotChat/${n.getVersion()}`,socketFactory:this._proxySettings?this.createSocketFactory(this._proxySettings,this.rejectUnauthorized):void 0,rejectUnauthorized:this.rejectUnauthorized})}async fetch(r,n){let o={...n,body:n.body?n.body:n.json,signal:n.signal};await this.certificateConfigurator.applyToRequestOptions(o);let s=await this.certificateConfigurator.getCertificates();this.fetchApi.setCA(s);let a=await this.fetchApi.fetch(r,o);return new uh(a.status,a.statusText,a.headers,()=>a.text(),()=>a.json(),async()=>a.body)}disconnectAll(){return this.fetchApi.reset()}makeAbortController(){return new Ide}isAbortError(r){return r instanceof Cde}isDNSLookupFailedError(r){return r instanceof eG&&r.code==="ENOTFOUND"}isFetcherError(r){return r instanceof eG}getUserMessageForFetcherError(r){return`Please check your firewall rules and network connection then try again. Error Code: ${r.code}.`}};var Jfe=require("net"),Zfe=require("url"),dI=require("vscode");function VHe(t){return t.HTTPS_PROXY||t.https_proxy||t.HTTP_PROXY||t.http_proxy||null}function eme(t,e){let r=dI.workspace.onDidChangeConfiguration(n=>{let o=n.affectsConfiguration("http.proxy");(n.affectsConfiguration("http.proxyStrictSSL")||n.affectsConfiguration("http.proxyAuthorization")||n.affectsConfiguration("http.proxyKerberosServicePrincipal")||o)&&Xfe(t,e,o)});return Xfe(t,e),r}var Xfe=(t,e,r)=>{let o=dI.workspace.getConfiguration("http").get("proxy")||VHe(e);if(o){let s={},a=dI.workspace.getConfiguration("http").get("proxyAuthorization"),c=dI.workspace.getConfiguration("http").get("proxyStrictSSL",!0);a&&(s["Proxy-Authorization"]=a);let u=o,l=o.split(":");if(l.length>2){if(o.includes("[")){let y=o.indexOf("["),b=o.indexOf("]");u=o.substring(y+1,b)}}else u=l[0];let d=(0,Jfe.isIP)(u);d===4?o=`https://${o}`:d===6&&(o.includes("[")?o.startsWith("https://")||(o=`https://${o}`):o=`https://[${o}]`);let{hostname:p,port:f,username:m,password:h}=GHe(o),g=m&&h&&`${decodeURIComponent(m)}:${decodeURIComponent(h)}`;t.proxySettings={host:p,port:parseInt(f),proxyAuth:g,headers:s};let v=dI.workspace.getConfiguration("http").get("proxyKerberosServicePrincipal");v&&(t.proxySettings.kerberosServicePrincipal=v),t.rejectUnauthorized=c}else r&&!o&&(t.proxySettings=void 0)};function GHe(t){try{return new Zfe.URL(t)}catch{throw new Error(`Invalid proxy URL: '${t}'`)}}var pI=class extends k3{constructor(r){super(r);this._store=new Tt;this._store.add(eme(this,process.env))}dispose(){this._store.dispose()}};var fI=class{constructor(e,r,n,o,s){this._context=e;this.envService=r;this.configurationService=n;this.domainService=o;this.accessor=s;this._context.subscriptions.push(Su.commands.registerCommand("github.copilot.debug.showNotebookLog",async()=>{if(!WR)return;let a=await Su.workspace.openNotebookDocument(WR);await Su.window.showNotebookDocument(a)})),this._context.subscriptions.push(Su.commands.registerCommand("github.copilot.debug.collectDiagnostics",async()=>{let a=await Su.workspace.openTextDocument({language:"markdown"}),c=await Su.window.showTextDocument(a);await Rl(c,`## GitHub Copilot Chat

- Extension Version: ${this.envService.getVersion()} (${this.envService.getBuildType()})
- VS Code: ${this.envService.getEditorInfo().format()}
- OS: ${this.envService.OS}${Su.env.remoteName?`
- Remote Name: ${Su.env.remoteName}`:""}

## Network

User Settings:
\`\`\`json
  "github.copilot.advanced": {
    "debug.useElectronFetcher": ${this.configurationService.getConfig(fe.DebugUseElectronFetcher)},
    "debug.useNodeFetcher": ${this.configurationService.getConfig(fe.DebugUseNodeFetcher)}
  }
\`\`\`
`);let u=this.domainService.capiBaseURL,l=[this.domainService.dotComAPIURL,`${u.endsWith("/")?u:`${u}/`}_ping`],d=10,p=US.create(this.envService),f=!!p&&this.configurationService.getConfig(fe.DebugUseElectronFetcher),m=!f&&this.configurationService.getConfig(fe.DebugUseNodeFetcher),h={Electron:{fetcher:p,current:f},Node:{fetcher:new BS(this.envService),current:m},Helix:{fetcher:new pI(this.accessor),current:!f&&!m}};for(let g of l){let v=new URL(g).host;await Rl(c,`
Connecting to ${g}:
- DNS Lookup: `);try{let y=rme.promisify(tme.lookup),b=await Promise.race([y(v),q_(d*1e3)]);b?await Rl(c,`${b.address}
`):await Rl(c,`timed out after ${d} seconds
`)}catch(y){await Rl(c,`Error: ${y?.message}
`)}for(let[y,b]of Object.entries(h))if(await Rl(c,`- ${y} Fetcher${b.current?" (configured)":""}: `),b.fetcher)try{let _=await Promise.race([b.fetcher.fetch(g,{}),q_(d*1e3)]);_?await Rl(c,`HTTP ${_.status}
`):await Rl(c,`timed out after ${d} seconds
`)}catch(_){await Rl(c,`Error: ${_?.message}
`)}else await Rl(c,`Unavailable
`)}await Rl(c,`
## Documentation

In corporate networks: [Troubleshooting firewall settings for GitHub Copilot](https://docs.github.com/en/copilot/troubleshooting-github-copilot/troubleshooting-firewall-settings-for-github-copilot).`)}))}};fI=O([x(0,ar),x(1,Rt),x(2,ye),x(3,yn),x(4,je)],fI);async function Rl(t,e){await t.edit(r=>{r.insert(t.document.lineAt(t.document.lineCount-1).range.end,e)})}var mz=z(require("vscode"));var mI=class{constructor(e,r,n){r.subscriptions.push(mz.lm.registerTool("copilot_codebase",e.createInstance(yk)));let o=["selection","terminalLastCommand","editor","terminalSelection"];n.getVariables().forEach(s=>{o.includes(s.name)&&r.subscriptions.push(mz.lm.registerTool("copilot_"+s.name,e.createInstance(vk,s)))})}};mI=O([x(0,te),x(1,ar),x(2,ag)],mI);var vk=class{constructor(e,r,n){this.variable=e;this.endpointProvider=r;this.accessor=n}async invoke(e,r){let n=await Mn(this.endpointProvider,2),o=await this.variable.resolve(this.accessor,{endpoint:n},r,{report:()=>{}});return o?o.userMessages.join(`

`):""}};vk=O([x(1,Le),x(2,je)],vk);var yk=class{constructor(e,r){this.endpointProvider=e;this.accessor=r}async invoke(e,r){let n=await Mn(this.endpointProvider,2),{messages:o}=await Xi(this.accessor.get(te),n,zx,{promptContext:{chatVariables:new _c([]),query:e.query,history:[],customInstructions:[]},include:{workspaceChunks:!0}},void 0,r);return o.map(s=>s.content).join(`

`)}};yk=O([x(0,Le),x(1,je)],yk);var zHe=[...Oue,sV,aV,cV,yS(PS),yS(OS),yS(fI),yS(kS),yS(mI)],nme=zHe;var _0=require("vscode");var ime=z(require("vscode"));var P3=class extends Ct{constructor(){super()}async executeCommand(e,r,...n){try{ime.commands.executeCommand(e,...n),r.sendMSFTTelemetryEvent("automaticCommandExecutedSucceeded",{command:e,args:n?.join(",")})}catch(o){r.sendMSFTTelemetryEvent("automaticCommandExecutedFailed",{command:e,args:n?.join(","),e:o})}}};var Hd=z(require("vscode"));function ome(t){return typeof t=="string"?t:JSON.stringify(t)}var A3=class extends mD{constructor(){super();this._onDidChangeConfiguration=new Gt;this.onDidChangeConfiguration=this._onDidChangeConfiguration.event;this.config=Hd.workspace.getConfiguration(nd),Hd.workspace.onDidChangeConfiguration(r=>{r.affectsConfiguration(nd)&&(this.config=Hd.workspace.getConfiguration(nd)),this._onDidChangeConfiguration.fire(r)})}getConfig(r){let n=this._getConfiguredValue(r);return n!==void 0?n:r.defaultValue}getNonExtensionConfig(r){return Hd.workspace.getConfiguration().get(r)}_getTargetFromInspect(r){let n;return r?r.workspaceFolderValue!==void 0?n=Hd.ConfigurationTarget.WorkspaceFolder:r.workspaceValue!==void 0?n=Hd.ConfigurationTarget.Workspace:n=Hd.ConfigurationTarget.Global:n=Hd.ConfigurationTarget.Global,n}_setAdvancedConfig(r,n){let o=this.config.get(r.firstPart);return o?o[r.secondPart]=n:o={[r.secondPart]:n},this.config.update(r.firstPart,o,this._getTargetFromInspect(this.config.inspect(r.firstPart)))}_setRegularConfig(r,n){return this.config.update(r.id,n,this._getTargetFromInspect(this.config.inspect(r.id)))}setConfig(r,n){return r.firstPart==="advanced"?this._setAdvancedConfig(r,n):this._setRegularConfig(r,n)}async getExperimentBasedConfig(r,n){let o=this._getConfiguredValue(r);if(o!==void 0)return o;let s=await n.getTreatmentVariableAsync("vscode",`copilotchat.config.${r.id}`,!0);return s!==void 0?s:r.defaultValue}_getConfiguredValue(r){if(this.config[r.firstPart]&&this.config[r.firstPart][r.secondPart]!==void 0)return this.config[r.firstPart][r.secondPart];let n=this.config.get(r.id);if(n!==void 0)return n}dumpConfig(){let r={};try{let n=Ea.contributes.configuration?.properties??{};for(let o in n){let a=o.replace(`${nd}.`,"").split(".").reduce((c,u)=>c[u],this.config);typeof a=="object"&&a!==null?Object.keys(a).filter(c=>c!=="secret_key").forEach(c=>r[`${o}.${c}`]=ome(a[c])):r[o]=ome(a)}}catch(n){console.error(`Failed to retrieve configuration properties ${n}`)}return r}};var vz=require("vscode"),sme=[];function ame(){return sme.join(`
`)}function $He(t,e){t.push(WHe(e)),t.length>40&&t.shift()}var hz=class{constructor(e){this.session=e}onWillStartSession(){}onWillReceiveMessage(e){}onDidSendMessage(e){if(vz.debug.activeDebugSession!==this.session)return;let r=this.extractOutput(e);r&&$He(sme,r)}extractOutput(e){if(e.event==="output"&&(e.body.category==="stdout"||e.body.category==="stderr"))return e.body.output}onWillStopSession(){}onError(e){}onExit(e,r){}};function WHe(t){let e=/(:?\x1b\[|\x9B)[=?>!]?[\d;:]*["$#'* ]?[a-zA-Z@^`{}|~]/g;return t&&(t=t.replace(e,"")),t}function cme(){return[vz.debug.registerDebugAdapterTrackerFactory("*",new gz)]}var gz=class{createDebugAdapterTracker(e){return new hz(e)}};var D3=class extends Ct{constructor(){super();for(let e of cme())this._register(e)}get consoleOutput(){return ame()}};var N3=ae("IDialogService");var ume=z(require("vscode")),L3=class{showQuickPick(e,r,n){return ume.window.showQuickPick(e,r,n)}};var lme=z(require("path"));var xo=class t{static fromRange(e){return new t(e.startLineNumber,e.endLineNumber)}static fromRangeInclusive(e){return new t(e.startLineNumber,e.endLineNumber+1)}static subtract(e,r){return r?e.startLineNumber<r.startLineNumber&&r.endLineNumberExclusive<e.endLineNumberExclusive?[new t(e.startLineNumber,r.startLineNumber),new t(r.endLineNumberExclusive,e.endLineNumberExclusive)]:r.startLineNumber<=e.startLineNumber&&e.endLineNumberExclusive<=r.endLineNumberExclusive?[]:r.endLineNumberExclusive<e.endLineNumberExclusive?[new t(Math.max(r.endLineNumberExclusive,e.startLineNumber),e.endLineNumberExclusive)]:[new t(e.startLineNumber,Math.min(r.startLineNumber,e.endLineNumberExclusive))]:[e]}static joinMany(e){if(e.length===0)return[];let r=new O3(e[0].slice());for(let n=1;n<e.length;n++)r=r.getUnion(new O3(e[n].slice()));return r.ranges}static join(e){if(e.length===0)throw new sn("lineRanges cannot be empty");let r=e[0].startLineNumber,n=e[0].endLineNumberExclusive;for(let o=1;o<e.length;o++)r=Math.min(r,e[o].startLineNumber),n=Math.max(n,e[o].endLineNumberExclusive);return new t(r,n)}static ofLength(e,r){return new t(e,e+r)}static deserialize(e){return new t(e[0],e[1])}constructor(e,r){if(e>r)throw new sn(`startLineNumber ${e} cannot be after endLineNumberExclusive ${r}`);this.startLineNumber=e,this.endLineNumberExclusive=r}contains(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}get isEmpty(){return this.startLineNumber===this.endLineNumberExclusive}delta(e){return new t(this.startLineNumber+e,this.endLineNumberExclusive+e)}deltaLength(e){return new t(this.startLineNumber,this.endLineNumberExclusive+e)}get length(){return this.endLineNumberExclusive-this.startLineNumber}join(e){return new t(Math.min(this.startLineNumber,e.startLineNumber),Math.max(this.endLineNumberExclusive,e.endLineNumberExclusive))}toString(){return`[${this.startLineNumber},${this.endLineNumberExclusive})`}intersect(e){let r=Math.max(this.startLineNumber,e.startLineNumber),n=Math.min(this.endLineNumberExclusive,e.endLineNumberExclusive);if(r<=n)return new t(r,n)}intersectsStrict(e){return this.startLineNumber<e.endLineNumberExclusive&&e.startLineNumber<this.endLineNumberExclusive}overlapOrTouch(e){return this.startLineNumber<=e.endLineNumberExclusive&&e.startLineNumber<=this.endLineNumberExclusive}equals(e){return this.startLineNumber===e.startLineNumber&&this.endLineNumberExclusive===e.endLineNumberExclusive}toInclusiveRange(){return this.isEmpty?null:new bt(this.startLineNumber,1,this.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER)}toExclusiveRange(){return new bt(this.startLineNumber,1,this.endLineNumberExclusive,1)}mapToLineArray(e){let r=[];for(let n=this.startLineNumber;n<this.endLineNumberExclusive;n++)r.push(e(n));return r}forEach(e){for(let r=this.startLineNumber;r<this.endLineNumberExclusive;r++)e(r)}serialize(){return[this.startLineNumber,this.endLineNumberExclusive]}includes(e){return this.startLineNumber<=e&&e<this.endLineNumberExclusive}toOffsetRange(){return new zt(this.startLineNumber-1,this.endLineNumberExclusive-1)}},O3=class t{constructor(e=[]){this._normalizedRanges=e}get ranges(){return this._normalizedRanges}addRange(e){if(e.length===0)return;let r=T_(this._normalizedRanges,o=>o.endLineNumberExclusive>=e.startLineNumber),n=ed(this._normalizedRanges,o=>o.startLineNumber<=e.endLineNumberExclusive)+1;if(r===n)this._normalizedRanges.splice(r,0,e);else if(r===n-1){let o=this._normalizedRanges[r];this._normalizedRanges[r]=o.join(e)}else{let o=this._normalizedRanges[r].join(this._normalizedRanges[n-1]).join(e);this._normalizedRanges.splice(r,n-r,o)}}contains(e){let r=sU(this._normalizedRanges,n=>n.startLineNumber<=e);return!!r&&r.endLineNumberExclusive>e}intersects(e){let r=sU(this._normalizedRanges,n=>n.startLineNumber<e.endLineNumberExclusive);return!!r&&r.endLineNumberExclusive>e.startLineNumber}getUnion(e){if(this._normalizedRanges.length===0)return e;if(e._normalizedRanges.length===0)return this;let r=[],n=0,o=0,s=null;for(;n<this._normalizedRanges.length||o<e._normalizedRanges.length;){let a=null;if(n<this._normalizedRanges.length&&o<e._normalizedRanges.length){let c=this._normalizedRanges[n],u=e._normalizedRanges[o];c.startLineNumber<u.startLineNumber?(a=c,n++):(a=u,o++)}else n<this._normalizedRanges.length?(a=this._normalizedRanges[n],n++):(a=e._normalizedRanges[o],o++);s===null?s=a:s.endLineNumberExclusive>=a.startLineNumber?s=new xo(s.startLineNumber,Math.max(s.endLineNumberExclusive,a.endLineNumberExclusive)):(r.push(s),s=a)}return s!==null&&r.push(s),new t(r)}subtractFrom(e){let r=T_(this._normalizedRanges,a=>a.endLineNumberExclusive>=e.startLineNumber),n=ed(this._normalizedRanges,a=>a.startLineNumber<=e.endLineNumberExclusive)+1;if(r===n)return new t([e]);let o=[],s=e.startLineNumber;for(let a=r;a<n;a++){let c=this._normalizedRanges[a];c.startLineNumber>s&&o.push(new xo(s,c.startLineNumber)),s=c.endLineNumberExclusive}return s<e.endLineNumberExclusive&&o.push(new xo(s,e.endLineNumberExclusive)),new t(o)}toString(){return this._normalizedRanges.map(e=>e.toString()).join(", ")}getIntersection(e){let r=[],n=0,o=0;for(;n<this._normalizedRanges.length&&o<e._normalizedRanges.length;){let s=this._normalizedRanges[n],a=e._normalizedRanges[o],c=s.intersect(a);c&&!c.isEmpty&&r.push(c),s.endLineNumberExclusive<a.endLineNumberExclusive?n++:o++}return new t(r)}getWithDelta(e){return new t(this._normalizedRanges.map(r=>r.delta(e)))}};var M3=class t{constructor(e,r){this.lineRangeMapping=e,this.changes=r}flip(){return new t(this.lineRangeMapping.flip(),this.changes.map(e=>e.flip()))}};function yz(t){if(!t()){debugger;t(),Wm(new sn("Assertion Failed"))}}var F3=class t{constructor(e,r){this.lineCount=e;this.columnCount=r}static{this.zero=new t(0,0)}static lengthDiffNonNegative(e,r){return r.isLessThan(e)?t.zero:e.lineCount===r.lineCount?new t(0,r.columnCount-e.columnCount):new t(r.lineCount-e.lineCount,r.columnCount)}static betweenPositions(e,r){return e.lineNumber===r.lineNumber?new t(0,r.column-e.column):new t(r.lineNumber-e.lineNumber,r.column-1)}static ofRange(e){return t.betweenPositions(e.getStartPosition(),e.getEndPosition())}static ofText(e){let r=0,n=0;for(let o of e)o===`
`?(r++,n=0):n++;return new t(r,n)}isZero(){return this.lineCount===0&&this.columnCount===0}isLessThan(e){return this.lineCount!==e.lineCount?this.lineCount<e.lineCount:this.columnCount<e.columnCount}isGreaterThan(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>e.columnCount}isGreaterThanOrEqualTo(e){return this.lineCount!==e.lineCount?this.lineCount>e.lineCount:this.columnCount>=e.columnCount}equals(e){return this.lineCount===e.lineCount&&this.columnCount===e.columnCount}compare(e){return this.lineCount!==e.lineCount?this.lineCount-e.lineCount:this.columnCount-e.columnCount}add(e){return e.lineCount===0?new t(this.lineCount,this.columnCount+e.columnCount):new t(this.lineCount+e.lineCount,e.columnCount)}createRange(e){return this.lineCount===0?new bt(e.lineNumber,e.column,e.lineNumber,e.column+this.columnCount):new bt(e.lineNumber,e.column,e.lineNumber+this.lineCount,this.columnCount+1)}toRange(){return new bt(1,1,this.lineCount+1,this.columnCount+1)}addToPosition(e){return this.lineCount===0?new qr(e.lineNumber,e.column+this.columnCount):new qr(e.lineNumber+this.lineCount,this.columnCount+1)}toString(){return`${this.lineCount},${this.columnCount}`}};var U3=class{constructor(e,r){this.range=e;this.text=r}get isEmpty(){return this.range.isEmpty()&&this.text.length===0}static equals(e,r){return e.range.equalsRange(r.range)&&e.text===r.text}toSingleEditOperation(){return{range:this.range,text:this.text}}};var bk=class t{static inverse(e,r,n){let o=[],s=1,a=1;for(let u of e){let l=new t(new xo(s,u.original.startLineNumber),new xo(a,u.modified.startLineNumber));l.modified.isEmpty||o.push(l),s=u.original.endLineNumberExclusive,a=u.modified.endLineNumberExclusive}let c=new t(new xo(s,r+1),new xo(a,n+1));return c.modified.isEmpty||o.push(c),o}static clip(e,r,n){let o=[];for(let s of e){let a=s.original.intersect(r),c=s.modified.intersect(n);a&&!a.isEmpty&&c&&!c.isEmpty&&o.push(new t(a,c))}return o}constructor(e,r){this.original=e,this.modified=r}toString(){return`{${this.original.toString()}->${this.modified.toString()}}`}flip(){return new t(this.modified,this.original)}join(e){return new t(this.original.join(e.original),this.modified.join(e.modified))}get changedLineCount(){return Math.max(this.original.length,this.modified.length)}toRangeMapping(){let e=this.original.toInclusiveRange(),r=this.modified.toInclusiveRange();if(e&&r)return new wy(e,r);if(this.original.startLineNumber===1||this.modified.startLineNumber===1){if(!(this.modified.startLineNumber===1&&this.original.startLineNumber===1))throw new sn("not a valid diff");return new wy(new bt(this.original.startLineNumber,1,this.original.endLineNumberExclusive,1),new bt(this.modified.startLineNumber,1,this.modified.endLineNumberExclusive,1))}else return new wy(new bt(this.original.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.original.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER),new bt(this.modified.startLineNumber-1,Number.MAX_SAFE_INTEGER,this.modified.endLineNumberExclusive-1,Number.MAX_SAFE_INTEGER))}},B3=class t extends bk{static fromRangeMappings(e){let r=xo.join(e.map(o=>xo.fromRangeInclusive(o.originalRange))),n=xo.join(e.map(o=>xo.fromRangeInclusive(o.modifiedRange)));return new t(r,n,e)}constructor(e,r,n){super(e,r),this.innerChanges=n}flip(){return new t(this.modified,this.original,this.innerChanges?.map(e=>e.flip()))}withInnerChangesFromLineRanges(){return new t(this.original,this.modified,[this.toRangeMapping()])}},wy=class t{constructor(e,r){this.originalRange=e,this.modifiedRange=r}toString(){return`{${this.originalRange.toString()}->${this.modifiedRange.toString()}}`}flip(){return new t(this.modifiedRange,this.originalRange)}toTextEdit(e){let r=e.getValueOfRange(this.modifiedRange);return new U3(this.originalRange,r)}};var KHe=lme.join(__dirname,"diffWorker.js"),q3=class{constructor(e=KHe){this._worker=new Wi(()=>new Nh(e,{name:"Diff worker"}))}dispose(){this._worker.rawValue?.terminate()}async computeDiff(e,r,n){let o=await this._worker.value.proxy.computeDiff(e,r,n);return{identical:o.identical,quitEarly:o.quitEarly,changes:a(o.changes),moves:o.moves.map(c=>new M3(new bk(new xo(c[0],c[1]),new xo(c[2],c[3])),a(c[4])))};function a(c){return c.map(u=>new B3(new xo(u[0],u[1]),new xo(u[2],u[3]),u[4]?.map(l=>new wy(new bt(l[0],l[1],l[2],l[3]),new bt(l[4],l[5],l[6],l[7])))))}}};async function Ff(t){if(!t)return;let e=await crypto.subtle.importKey("raw",new TextEncoder().encode(t),{name:"HMAC",hash:"SHA-256"},!1,["sign"]),r=Math.floor(Date.now()/1e3).toString(),o=new TextEncoder().encode(r),s=await crypto.subtle.sign("HMAC",e,o),c=Array.from(new Uint8Array(s)).map(u=>u.toString(16).padStart(2,"0")).join("");return`${r}.${c}`}var hI=class{constructor(e,r,n,o,s,a){this._authService=e;this._tokenizerProvider=r;this._telemetryService=n;this._domainService=o;this._envService=s;this._fetcherService=a}async computeEmbeddings(e,r,n,o){let s=e.maxBatchSize,a=e.modelMaxPromptTokens-1;return this.fetchResponseWithBatches(e,r,o,a,s,n?.parallelism)}async fetchResponseWithBatches(e,r,n,o,s,a=1){for(let d of r)if(this._tokenizerProvider.acquireTokenizer(e.family).tokenLength(d)>o)return;let c=[],u=[],l=new B_(a);try{for(let d=0;d<r.length;d+=s){let p=r.slice(d,d+s);u.push(l.queue(async()=>{if(n?.isCancellationRequested)return;let f=await this.rawEmbeddingsFetchWithTelemetry(e,Br(),p,n);if(f.type==="failed")throw new Error("Embeddings request failed "+f.reason);return f}))}c=(await Promise.all(u)).flatMap(d=>d?.embeddings??[])}catch{return[]}finally{l.dispose()}if(!n?.isCancellationRequested)return c.length===0?void 0:c}async rawEmbeddingsFetchWithTelemetry(e,r,n,o){let s=Date.now(),a=await this.rawEmbeddingsFetch(e,r,n,o);return a.type==="failed"?(this._telemetryService.sendMSFTTelemetryErrorEvent("embedding.error",{type:a.type,reason:a.reason}),a):(this._telemetryService.sendMSFTTelemetryEvent("embedding.success",{},{batchSize:n.length,inputTokenCount:n.reduce((c,u)=>c+this._tokenizerProvider.acquireTokenizer(e.family).tokenLength(u),0),timeToComplete:Date.now()-s}),a)}async rawEmbeddingsFetch(e,r,n,o){try{let s=await this._authService.getCopilotToken(),a={input:n,model:e.model};e.interceptBody?.(a);let c=await FS(this._fetcherService,this._envService,this._telemetryService,this._domainService,e,s.token,await Ff(process.env.HMAC_SECRET),"copilot-panel",r,a,o),u=c.status===200?await c.json():await c.text();return c.status===200&&u.data?{type:"success",embeddings:u.data.map(l=>l.embedding)}:{type:"failed",reason:u.error}}catch(s){let a=s?.message??"Unknown error";return a.match(/Unexpected.*JSON/i)&&(a="timeout"),{type:"failed",reason:a}}}};hI=O([x(0,Nt),x(1,dr),x(2,me),x(3,yn),x(4,Rt),x(5,$r)],hI);var dme="github-enterprise.uri",gI=class extends Ct{constructor(r,n){super();this._configurationService=r;this._tokenStore=n;this._onDidChangeDomains=this._register(new Gt);this.onDidChangeDomains=this._onDidChangeDomains.event;this._telemetryBaseUrl="https://copilot-telemetry.githubusercontent.com";this._register(this._configurationService.onDidChangeConfiguration(s=>this._onDidConfigChangeHandler(s))),this._dotcomAPIUrl=this._getDotComAPIUrl();let o=this._configurationService.getConfig(fe.DebugOverrideCAPIUrl);o.endsWith("/")&&(o=o.slice(0,-1)),this._capiBaseUrl=o,this._capiBaseUrl==="https://api.githubcopilot.com"&&(this._processCopilotToken(this._tokenStore.copilotToken),this._register(this._tokenStore.onDidStoreUpdate(()=>this._processCopilotToken(this._tokenStore.copilotToken))))}_onDidConfigChangeHandler(r){if(r.affectsConfiguration(`${nd}.advanced`)||r.affectsConfiguration(dme)){let n=this._getDotComAPIUrl();this._dotcomAPIUrl!==n&&(this._dotcomAPIUrl=n,this._onDidChangeDomains.fire({capiUrlChanged:!1,telemeryUrlChanged:!1,dotcomUrlChanged:!0}))}}_getDotComAPIUrl(){let r=this._configurationService.getNonExtensionConfig(dme),n=this._configurationService.getConfig(fe.AuthProvider)==="github-enterprise";if(r&&n){let o=dt.parse(r);return`${o.scheme}://api.${o.authority}`}return"https://api.github.com"}_processCopilotToken(r){let n=this._capiBaseUrl,o=this._telemetryBaseUrl;r?(this._capiBaseUrl=r.endpoints.api,this._telemetryBaseUrl=r.endpoints.telemetry):(this._capiBaseUrl="https://api.githubcopilot.com",this._telemetryBaseUrl="https://copilot-telemetry.githubusercontent.com"),(n!==this._capiBaseUrl||o!==this._telemetryBaseUrl)&&this._onDidChangeDomains.fire({capiUrlChanged:n!==this._capiBaseUrl,telemeryUrlChanged:o!==this._telemetryBaseUrl,dotcomUrlChanged:!1})}get capiBaseURL(){return this._capiBaseUrl}get capiChatURL(){return`${this._capiBaseUrl}/chat/completions`}get capiEmbeddingsURL(){return`${this._capiBaseUrl}/embeddings`}get capiModelsURL(){return`${this._capiBaseUrl}/models`}get telemetryURL(){return`${this._telemetryBaseUrl}/telemetry`}get remoteAgentsURL(){return`${this._capiBaseUrl}/agents`}get listSkillsURL(){return`${this._capiBaseUrl}/skills`}get searchSkillURL(){return`${this._capiBaseUrl}/search`}get contentExclusionURL(){return`${this._dotcomAPIUrl}/copilot_internal/content_exclusion`}get tokenURL(){return this._dotcomAPIUrl+"/copilot_internal/v2/token"}get dotComAPIURL(){return this._dotcomAPIUrl}};gI=O([x(0,ye),x(1,id)],gI);var Ry=z(require("vscode"));var H3=class{get sessionId(){return Ry.env.sessionId}get machineId(){return Ry.env.machineId}get OS(){switch(wre){case 3:return"Windows";case 1:return"Mac";case 2:return"Linux";default:return"Linux"}}get language(){return Ry.env.language}get uriScheme(){return Ry.env.uriScheme}isProduction(){return dD}isPreRelease(){return Ta}getBuildType(){return Ea.buildType}getVersion(){return Ea.version}getBuild(){return Ea.build}getName(){return Ea.name}getEditorInfo(){return new zT("vscode",Ry.version)}getEditorPluginInfo(){return new zT("copilot-chat",Ea.version)}getEditorVersionHeaders(){return{"Editor-Version":this.getEditorInfo().format(),"Editor-Plugin-Version":this.getEditorPluginInfo().format()}}};var j3=class extends ex{constructor(){super()}async readFile(e){return super.readFile(e)}};var kg=z(require("vscode"));var vI=class{constructor(e){this._onDidChange=new kg.EventEmitter;this.onDidChange=this._onDidChange.event;this._extensionEnablement=void 0;this._disposables=[];this._logger=e.getLogger("gitExtensionService"),this._logger.info("Initializing Git extension service."),this._disposables.push(...this._initializeExtensionApi())}getExtensionApi(){return this._api}get extensionAvaiable(){return this._extensionEnablement===void 0?!!kg.extensions.getExtension("vscode.git"):this._extensionEnablement}_initializeExtensionApi(){let e=[],r=kg.extensions.getExtension("vscode.git"),n=async()=>{let o;try{o=await r.activate(),this._logger.info("Successfully activated the vscode.git extension.")}catch(a){this._logger.error("Failed to activate the vscode.git extension.",a);return}let s=a=>{this._logger.info(`Enablement state of the vscode.git extension: ${a}.`),this._extensionEnablement=a,a?(this._api=o.getAPI(1),this._onDidChange.fire({enabled:!0}),this._logger.info("Successfully registered Git commit message provider.")):(this._api=void 0,this._onDidChange.fire({enabled:!1}))};e.push(o.onDidChangeEnablement(s)),s(o.enabled)};if(r)n();else{this._logger.info("vscode.git extension is not yet activated.");let o=kg.extensions.onDidChange(()=>{!r&&kg.extensions.getExtension("vscode.git")&&(r=kg.extensions.getExtension("vscode.git"),n(),o.dispose())})}return e}};vI=O([x(0,ue)],vI);var bz=z(require("vscode"));var Iu=class extends Ct{constructor(r){super();this.gitExtensionService=r;this._onDidOpenRepository=new Gt;this.onDidOpenRepository=this._onDidOpenRepository.event;this._onDidCloseRepository=new Gt;this.onDidCloseRepository=this._onDidCloseRepository.event;this._onDidFinishInitialRepositoryDiscovery=new Gt;this.onDidFinishInitialization=this._onDidFinishInitialRepositoryDiscovery.event;this._isInitialized=!1;this._register(this._onDidOpenRepository),this._register(this._onDidCloseRepository),this._register(this._onDidFinishInitialRepositoryDiscovery);let n=this.gitExtensionService.getExtensionApi();n?this.registerGitAPIListeners(n):this._register(this.gitExtensionService.onDidChange(o=>{if(o.enabled){let s=this.gitExtensionService.getExtensionApi();s&&this.registerGitAPIListeners(s)}else this._onDidFinishInitialRepositoryDiscovery.fire()}))}registerGitAPIListeners(r){this._register(r.onDidOpenRepository(n=>{let o=Iu.repoToRepoContext(n);o&&this._onDidOpenRepository.fire(o)})),this._register(r.onDidCloseRepository(n=>{let o=Iu.repoToRepoContext(n);o&&this._onDidCloseRepository.fire(o)})),r.state==="initialized"&&(this._onDidFinishInitialRepositoryDiscovery.fire(),this._isInitialized=!0),this._register(r.onDidChangeState(n=>{n==="initialized"&&(this._onDidFinishInitialRepositoryDiscovery.fire(),this._isInitialized=!0)}))}get isInitialized(){return this._isInitialized}async openRepository(r){let n=this.gitExtensionService.getExtensionApi();if(!n)return;let o=await n.openRepository(r);return Iu.repoToRepoContext(o)}getRepository(r){let n=this.gitExtensionService.getExtensionApi();if(n)return Iu.repoToRepoContext(n.getRepository(r))}async initialize(){if(this._isInitialized)return;let r=bz.workspace.workspaceFolders;if(!r)return;let n=this.gitExtensionService.getExtensionApi();if(n)for(let o of r)await n.openRepository(o.uri).catch(()=>{})}static repoToRepoContext(r){if(r)return{rootUri:r.rootUri,headBranchName:r.state.HEAD?.name,headCommitHash:r.state.HEAD?.commit,upstreamBranchName:r.state.HEAD?.upstream?.name,upstreamRemote:r.state.HEAD?.upstream?.remote,isRebasing:r.state.rebaseCommit!==null,remotes:r.state.remotes.map(n=>n.name),remoteFetchUrls:r.state.remotes.map(n=>n.fetchUrl)}}get repositories(){if(!bz.workspace.workspaceFolders)return[];let n=this.gitExtensionService.getExtensionApi();return n?Xt(n.repositories.map(o=>Iu.repoToRepoContext(o))):[]}};Iu=O([x(0,es)],Iu);var yI=class{constructor(e){this.accessor=e;this.githubRepositoryInfoCache=new Map;this.fetcherService=e.get($r)}async _doGetRepositoryInfo(e,r){let n=this.accessor.get(Nt).anyGitHubSession?.accessToken,o={Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28"};return n&&(o.Authorization=`Bearer ${n}`),this.fetcherService.fetch(`https://api.github.com/repos/${e}/${r}`,{method:"GET",headers:o})}async getRepositoryInfo(e,r){let n=this.githubRepositoryInfoCache.get(`${e}/${r}`);if(n)return n;let o=await this._doGetRepositoryInfo(e,r);if(o.ok){let s=await o.json();return this.githubRepositoryInfoCache.set(`${e}/${r}`,s),s}throw new Error(`Failed to fetch repository info for ${e}/${r}`)}async isAvailable(e,r){try{return(await this._doGetRepositoryInfo(e,r)).ok}catch{return!1}}async getRepositoryItems(e,r,n){let o=[];try{let s=this.accessor.get(Nt).permissiveGitHubSession?.accessToken,a=n.split("/").map(u=>encodeURIComponent(u)).join("/"),c=await this.fetcherService.fetch(`https://api.github.com/repos/${e}/${r}/contents/${a}`,{method:"GET",headers:{Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28",Authorization:`Bearer ${s}`}});if(c.ok){let u=await c.json();if(Array.isArray(u))for(let l of u)"name"in l&&"path"in l&&"type"in l&&"html_url"in l&&(o.push({name:l.name,path:l.path,type:l.type,html_url:l.html_url}),l.type==="dir"&&o.push(...await this.getRepositoryItems(e,r,l.path)))}else return console.error(`Failed to fetch contents from ${e}:${r}:${n}`),[]}catch{return console.error(`Failed to fetch contents from ${e}:${r}:${n}`),[]}return o}async getRepositoryItemContent(e,r,n){try{let o=this.accessor.get(Nt).permissiveGitHubSession?.accessToken,s=n.split("/").map(c=>encodeURIComponent(c)).join("/"),a=await this.fetcherService.fetch(`https://api.github.com/repos/${e}/${r}/contents/${s}`,{method:"GET",headers:{Accept:"application/vnd.github+json","X-GitHub-Api-Version":"2022-11-28",Authorization:`Bearer ${o}`}});if(a.ok){let c=await a.json();if("content"in c){let u=Buffer.from(c.content,"base64");return new Uint8Array(u)}throw new Error("Unexpected data from GitHub")}}catch{console.error(`Failed to contents from ${e}:${r}:${n}`)}}};yI=O([x(0,je)],yI);var _z=z(require("vscode"));var V3=class extends Zx{constructor(){super(...arguments);this.onDidChangeDiagnostics=_z.languages.onDidChangeDiagnostics}getDiagnostics(r){return _z.languages.getDiagnostics(r)}};var Pg=z(require("vscode")),G3=class{constructor(){}async getDefinitions(e,r){return await Pg.commands.executeCommand("vscode.executeDefinitionProvider",e,r)}async getImplementations(e,r){return await Pg.commands.executeCommand("vscode.executeImplementationProvider",e,r)}async getReferences(e,r){return await Pg.commands.executeCommand("vscode.executeReferenceProvider",e,r)}async getWorkspaceSymbols(e){return await Pg.commands.executeCommand("vscode.executeWorkspaceSymbolProvider",e)}async getDocumentSymbols(e){return await Pg.commands.executeCommand("vscode.executeDocumentSymbolProvider",e)}getDiagnostics(e){return Pg.languages.getDiagnostics(e)}};var bI=class{constructor(e,r,n,o){this._logger=e.getLogger("FetcherService"),this._fetcher=this._getFetcher(o,n,r)}_getFetcher(e,r,n){if(r.getConfig(fe.DebugUseElectronFetcher)){let a=US.create(n);if(a)return this._logger.info("Using the Electron fetcher."),a;this._logger.info("Can't use the Electron fetcher in this environment.")}return r.getConfig(fe.DebugUseNodeFetcher)?(this._logger.info("Using the Node fetcher."),new BS(n)):(this._logger.info("Using the Helix fetcher."),new pI(e))}fetch(e,r){return this._fetcher.fetch(e,r)}disconnectAll(){return this._fetcher.disconnectAll()}makeAbortController(){return this._fetcher.makeAbortController()}isAbortError(e){return this._fetcher.isAbortError(e)}isDNSLookupFailedError(e){return this._fetcher.isDNSLookupFailedError(e)}isFetcherError(e){return this._fetcher.isFetcherError(e)}getUserMessageForFetcherError(e){return this._fetcher.getUserMessageForFetcherError(e)}};bI=O([x(0,ue),x(1,Rt),x(2,ye),x(3,je)],bI);var xz=z(require("vscode")),z3=class{async loadKerberos(){try{return require(`${xz.env.appRoot}/node_modules.asar/kerberos`)}catch{}try{return require(`${xz.env.appRoot}/node_modules/kerberos`)}catch{}}};var pme=z(require("os")),Sz=z(require("vscode")),$3=class{async loadCaCerts(){let e=await this.loadBuiltInWinCAModule(),r=new Set,n=new e.Crypt32;try{let o;for(;o=n.next();)r.add(YHe(o))}finally{n.done()}return Array.from(r)}async loadBuiltInWinCAModule(){try{return require(`${Sz.env.appRoot}/node_modules.asar/@vscode/windows-ca-certs`)}catch{}try{return require(`${Sz.env.appRoot}/node_modules/@vscode/windows-ca-certs`)}catch{}}};function YHe(t){let e=["-----BEGIN CERTIFICATE-----"],r=t.toString("base64");for(let n=0;n<r.length;n+=64)e.push(r.substr(n,64));return e.push("-----END CERTIFICATE-----",""),e.join(pme.EOL)}var _I=require("vscode");var fme=require("vscode");var W3=class{constructor(){this._onDidChangeNotebookCellExecutionStateEmitter=new Gt;this.onDidChangeNotebookCellExecutionState=this._onDidChangeNotebookCellExecutionStateEmitter.event;this._disposables=[];this._cellExecution=new WeakMap;this._disposables.push(fme.workspace.onDidChangeNotebookDocument(e=>{for(let r of e.cellChanges)r.executionSummary&&(r.executionSummary.success===void 0?this._cellExecution.has(r.cell)||(this._cellExecution.set(r.cell,!0),this._onDidChangeNotebookCellExecutionStateEmitter.fire({cell:r.cell,state:2})):(this._cellExecution.delete(r.cell),this._onDidChangeNotebookCellExecutionStateEmitter.fire({cell:r.cell,state:1})))}))}dispose(){this._disposables.forEach(e=>e.dispose())}};var K3=class{constructor(){this._cellExecution=new Map;this._executionService=new W3;this._disposables=[];this._registerExecutionListener()}_hasJupyterExtension(){return _I.extensions.getExtension("ms-toolsai.jupyter")?.isActive}async getVariables(e){if(!this._hasJupyterExtension())try{let r=await _I.commands.executeCommand("vscode.executeNotebookVariableProvider",e);return r&&Array.isArray(r)?r.map(this._convertResult):[]}catch{return[]}try{let r=await _I.commands.executeCommand("jupyter.listVariables",e);return r&&Array.isArray(r)?r.map(this._convertResult):[]}catch{return[]}}_convertResult(e){return"variable"in e?e:{variable:e,hasNamedChildren:!1,indexedChildrenCount:0}}async getPipPackages(e){if(!this._hasJupyterExtension())return[];try{return await _I.commands.executeCommand("jupyter.listPipPackages",e)}catch{return[]}}setVariables(e,r){}_registerExecutionListener(){this._disposables.push(this._executionService.onDidChangeNotebookCellExecutionState(e=>{let r=e.cell,o=r.notebook.uri.toString(),s=this._cellExecution.get(o);s||(s=[],this._cellExecution.set(o,s));let a=s.findIndex(c=>c.cell===r);a!==-1&&s.splice(a,1),s.push({cell:r,executionCount:r.executionSummary?.executionOrder})}))}getCellExecutions(e){return this._cellExecution.get(e.toString())?.map(r=>r.cell)||[]}dispose(){this._disposables.forEach(e=>e.dispose())}};var mme=require("vscode"),Y3=class{async showWarningMessage(e,...r){return{title:await mme.window.showWarningMessage(e,...r.map(o=>o.title))}}};var X3=z(require("vscode")),Q3=class{async open(e){await X3.commands.executeCommand("vscode.open",X3.Uri.parse(e))}};var Bme=z(require("path"));var Mz={};mn(Mz,{_dispose:()=>ZHe,_extractDoc:()=>Tje,_findLastTest:()=>xje,_getCallExpressions:()=>aje,_getClassDeclarations:()=>uje,_getClassReferences:()=>pje,_getCoarseParentScope:()=>vje,_getDocumentableNodeIfOnIdentifier:()=>bje,_getFineScopes:()=>Sje,_getFixSelectionOfInterest:()=>yje,_getFunctionBodies:()=>gje,_getFunctionDefinitions:()=>cje,_getFunctionPositions:()=>hje,_getNodeMatchingSelection:()=>e5,_getNodeToDocument:()=>Ije,_getNodeToExplain:()=>Cje,_getSemanticChunkTree:()=>mje,_getStructure:()=>Rje,_getSymbols:()=>fje,_getTestableNode:()=>_je,_getTypeDeclarations:()=>lje,_getTypeReferences:()=>dje,_parse:()=>Fi});var xk=z(require("path"));var Iz=class{constructor(e=10){this.values=new Map;this.lruKeys=[];if(e<1)throw new Error("Cache size must be at least 1");this.size=e}removeKeyFromLRU(e){let r=this.lruKeys.indexOf(e);r!==-1&&this.lruKeys.splice(r,1)}touchKeyInLRU(e){this.removeKeyFromLRU(e),this.lruKeys.push(e)}clear(){this.values.clear(),this.lruKeys=[]}deleteKey(e){this.removeKeyFromLRU(e);let r=this.values.get(e);return r!==void 0&&this.values.delete(e),r}get(e){if(this.values.has(e)){let r=this.values.get(e);return this.touchKeyInLRU(e),r}}keys(){return this.lruKeys.slice()}getValues(){return this.values.values()}put(e,r){let n;if(!this.values.has(e)&&this.lruKeys.length===this.size){let o=this.lruKeys.shift(),s=this.deleteKey(o);n=[o,s]}return this.values.set(e,r),this.touchKeyInLRU(e),n}},J3=class{constructor(e){this.actual=new Iz(e)}dispose(){this.clear()}clear(){let e=this.actual.getValues();for(let r of e)r.dispose();this.actual.clear()}deleteKey(e){let r=this.actual.deleteKey(e);r&&r.dispose()}get(e){return this.actual.get(e)}keys(){return this.actual.keys()}getValues(){return this.actual.getValues()}put(e,r){let n=this.actual.put(e,r);n&&n[1].dispose()}};var Z3=class{constructor(e,r){this.syntaxTreeRoot=r;this.roots=[];this.formTree(e)}formTree(e){e.sort((s,a)=>s.mainBlock.startIndex-a.mainBlock.startIndex||s.mainBlock.endIndex-a.mainBlock.endIndex);let r=[],n=()=>r[r.length-1],o=(s,a)=>s.mainBlock.startIndex===a.mainBlock.startIndex&&s.mainBlock.endIndex===a.mainBlock.endIndex;for(let s of e){let a={info:s,children:[]},c=n();if(!c){this.roots.push(a),r.push(a);continue}if(!o(c.info,s)){for(;c&&!Zi.doesContain(c.info.mainBlock,s.mainBlock);)r.pop(),c=n();c?c.children.push(a):this.roots.push(a),r.push(a)}}}};var ir=(()=>{function t(e,...r){return e.length===1?e[0]:e.reduce((n,o,s)=>`${n}${o}${r[s]||""}`,"")}return{typescript:t,javascript:t,python:t,go:t,ruby:t,csharp:t,cpp:t,java:t,rust:t}})();function Tc(t,e){return Object.fromEntries(t.map(r=>[r,e]))}var QHe={javascript:[],typescript:[],tsx:[],python:[],csharp:[],go:[],java:[],ruby:[],cpp:[],rust:[]};function Cu(t){for(let e in t){let r=t[e];QHe[e].push(...r)}return t}var hme=Cu({...Tc(["javascript","typescript","tsx"],[`[
			(call_expression
				function: (identifier) @identifier)
			(call_expression
				function: (member_expression
					(property_identifier) @identifier))
		] @call_expression`]),python:[`[
			(call
				function: (identifier) @identifier)
			(call
				function: (attribute
					attribute: (identifier) @identifier))
		] @call_expression`],csharp:[`[
			(invocation_expression
				function: (identifier) @identifier)
			(invocation_expression
				function: (member_access_expression
					name: (identifier) @identifier))
		] @call_expression`],go:[`[
			(call_expression
				((selector_expression
					(field_identifier) @identifier)))
			(call_expression
				(identifier) @identifier)
		] @call_expression`],java:[`[
			(method_invocation
				name: (identifier) @identifier)
		] @call_expression`],ruby:[`[
			(call (identifier) @identifier
				(#not-match? @identifier "new|send|public_send|method"))
			(call
				receiver: (identifier)
				method: (identifier) @method
				(#match? @method "^(send|public_send|method)")
				arguments: (argument_list
					(simple_symbol) @symbol))
		] @call_expression`],cpp:[`[
			(function_declarator
				(identifier) @identifier)
			(function_declarator
				(field_identifier) @identifier)
			(call_expression (identifier) @identifier)
			(call_expression
				(field_expression
					field: (field_identifier) @identifier))
			(call_expression
				(call_expression
					(primitive_type)
					(argument_list
						(pointer_expression
						(identifier) @identifier))))
		] @call_expression`],rust:[`[
			(call_expression (identifier) @identifier)
			(call_expression (field_expression (identifier) (field_identifier) @identifier))
			(call_expression (scoped_identifier (identifier) (identifier) @identifier (#not-match? @identifier "new")))
		] @call_expression`]}),gme=Cu({...Tc(["javascript","typescript","tsx"],["(class_declaration) @class_declaration"]),java:["(class_declaration) @class_declaration"],csharp:["(class_declaration) @class_declaration"],python:["(class_definition) @class_declaration"],cpp:["(class_specifier) @class_declaration"],ruby:["(class) @class_declaration"],go:[`(type_declaration
			(type_spec
				(type_identifier) @type_identifier)) @class_declaration`],rust:["(impl_item (type_identifier) @type_identifier) @class_declaration"]}),vme=Cu({typescript:[`[
			(interface_declaration)
			(type_alias_declaration)
		] @type_declaration`],csharp:[`(interface_declaration
			(identifier) @type_identifier) @type_declaration`],cpp:[`[
			(struct_specifier
				(type_identifier) @type_identifier)
			(union_specifier
				(type_identifier) @type_identifier)
			(enum_specifier
				(type_identifier) @type_identifier)
		] @type_declaration`],java:[`(interface_declaration
			(identifier) @type_identifier) @type_declaration`],go:[`(type_declaration
			(type_spec
				(type_identifier) @type_identifier)) @type_declaration`],ruby:["((constant) @type_identifier) @type_declaration"],python:[`(class_definition
			(identifier) @type_identifier) @type_declaration`]}),yme=Cu({typescript:["(type_identifier) @type_identifier"],go:["(type_identifier) @type_identifier"],ruby:["(constant) @type_identifier"],csharp:[`[
			(base_list
				(identifier) @type_identifier)
			(variable_declaration
				(identifier) @type_identifier)
		]`],cpp:["(type_identifier) @type_identifier"],java:["(type_identifier) @type_identifier"],python:[`[
			(type (identifier) @type_identifier)
			(argument_list
				(identifier) @type_identifier)
		]`]}),bme=Cu({...Tc(["javascript","typescript","tsx"],[`(new_expression
			constructor: (identifier) @new_expression)`]),python:[`(call
			function: (identifier) @new_expression)`],csharp:[`(object_creation_expression
			(identifier) @new_expression)`],java:[`(object_creation_expression
			(type_identifier) @new_expression)`],cpp:[`[
			(declaration
				(type_identifier) @new_expression)
			(class_specifier
				(type_identifier) @new_expression)
		]`],go:["(composite_literal (type_identifier) @new_expression)"],ruby:[`((call
			receiver: ((constant) @new_expression)
			method: (identifier) @method)
				(#eq? @method "new"))`],rust:[`(call_expression
			(scoped_identifier
				(identifier) @new_expression
				(identifier) @identifier
				(#eq? @identifier "new")))`]}),_me=Cu({python:[`[
			(function_definition
				name: (identifier) @identifier
				body: (block
						(expression_statement (string))? @docstring) @body)
			(assignment
				left: (identifier) @identifier
				right: (lambda) @body)
		] @function`,'(ERROR ("def" (identifier) (parameters))) @function'],...Tc(["javascript","typescript","tsx"],[`[
			(function_expression
				name: (identifier)? @identifier
				body: (statement_block) @body)
			(function_declaration
				name: (identifier)? @identifier
				body: (statement_block) @body)
			(generator_function
				name: (identifier)? @identifier
				body: (statement_block) @body)
			(generator_function_declaration
				name: (identifier)? @identifier
				body: (statement_block) @body)
			(method_definition
				name: (property_identifier)? @identifier
				body: (statement_block) @body)
			(arrow_function
				body: (statement_block) @body)
		] @function`]),go:[`[
			(function_declaration
				name: (identifier) @identifier
				body: (block) @body)
			(method_declaration
				name: (field_identifier) @identifier
				body: (block) @body)
		] @function`],ruby:[`[
			(method
				name: (_) @identifier
				parameters: (method_parameters)? @params
				[(_)+ "end"] @body)
			(singleton_method
				name: (_) @identifier
				parameters: (method_parameters)? @params
				[(_)+ "end"] @body)
		] @function`],csharp:[`[
			(constructor_declaration
				(identifier) @identifier
				(block) @body)
			(destructor_declaration
				(identifier) @identifier
				(block) @body)
			(operator_declaration
				(block) @body)
			(method_declaration
				(identifier) @identifier
				(block) @body)
			(local_function_statement
				(identifier) @identifier
				(block) @body)
		] @function`],cpp:[`[
			(function_definition
				(_
					(identifier) @identifier)
					(compound_statement) @body)
			(function_definition
				(function_declarator
					(qualified_identifier
						(identifier) @identifier))
					(compound_statement) @body)
		] @function`],java:[`[
			(constructor_declaration
				name: (identifier) @identifier
				body: (constructor_body) @body)
			(method_declaration
				name: (_) @identifier
				body: (block) @body)
			(lambda_expression
				body: (block) @body)
		] @function`],rust:[`[
			(function_item (identifier) @identifier)
			(let_declaration (identifier) @identifier)
		] @function`]}),xme=Cu({javascript:[ir.javascript`((comment) @comment
			(#match? @comment "^\\\\/\\\\*\\\\*")) @docComment`],...Tc(["typescript","tsx"],[ir.typescript`((comment) @comment
			(#match? @comment "^\\\\/\\\\*\\\\*")) @docComment`]),java:[ir.java`((block_comment) @block_comment
			(#match? @block_comment "^\\\\/\\\\*\\\\*")) @docComment`],cpp:[ir.cpp`((comment) @comment
			(#match? @comment "^\\\\/\\\\*\\\\*")) @docComment`],csharp:[ir.csharp`(
			((comment) @c
				(#match? @c "^\\\\/\\\\/\\\\/"))+
		) @docComment`],rust:[ir.rust`((line_comment) @comment
			(#match? @comment "^\/\/\/|^\/\/!"))+ @docComment`],go:[ir.go`((comment)+) @docComment`],ruby:[ir.ruby`((comment)+) @docComment`],python:[`(expression_statement
			(string) @docComment)`]}),Sme=Cu({javascript:[ir.javascript`[
			(function_declaration
				(identifier) @function.identifier
			) @function

			(generator_function_declaration
				name: (identifier) @generator_function.identifier
			) @generator_function

			(class_declaration
				name: (identifier) @class.identifier ;; note: (type_identifier) in typescript
				body: (class_body
							(method_definition
								name: (property_identifier) @method.identifier
							) @method
						)
			) @class
		]`],...Tc(["typescript","tsx"],[ir.typescript`[
				(function_declaration
					(identifier) @function.identifier
				) @function

				(generator_function_declaration
					name: (identifier) @generator_function.identifier
				) @generator_function

				(class_declaration
					name: (type_identifier) @class.identifier
					body: (class_body
								(method_definition
									name: (property_identifier) @method.identifier
								) @method
							)
				) @class
			]`]),python:[ir.python`[
				(function_definition
					name: (identifier) @function.identifier
				) @function
			]`],go:[ir.go`[
				(function_declaration
					name: (identifier) @function.identifier
				) @function

				(method_declaration
					name: (field_identifier) @method.identifier
				) @method
			]`],ruby:[ir.ruby`[
				(method
					name: (identifier) @method.identifier
				) @method

				(singleton_method
					name: (_) @singleton_method.identifier
				) @singleton_method
			]`],csharp:[ir.csharp`[
				(constructor_declaration
					(identifier) @constructor.identifier
				) @constructor

				(destructor_declaration
					(identifier) @destructor.identifier
				) @destructor

				(method_declaration
					(identifier) @method.identifier
				) @method

				(local_function_statement
					(identifier) @local_function.identifier
				) @local_function
			]`],cpp:[ir.cpp`[
				(function_definition
					(_
						(identifier) @identifier)
				) @function
			]`],java:[ir.java`(class_declaration
			body: (_
						[
							(constructor_declaration
								(modifiers)? @constructor.modifiers
								(#not-eq? @constructor.modifiers "private")
								name: (identifier) @constructor.identifier
							) @constructor

							(method_declaration
								(modifiers)? @method.modifiers
								(#not-eq? @method.modifiers "private")
								name: (identifier) @method.identifier
							) @method
						]
					)
		) @class`],rust:[ir.rust`[
				(function_item
					(identifier) @function.identifier
				) @function
			]`]}),Ime=Cu({javascript:[ir.javascript`[
			(identifier) @symbol
			(property_identifier) @symbol
			(private_property_identifier) @symbol
		]`],...Tc(["typescript","tsx"],[ir.typescript`[
			(identifier) @symbol
			(type_identifier) @symbol
			(property_identifier) @symbol
			(private_property_identifier) @symbol
		]`]),cpp:[ir.cpp`[
			(identifier) @symbol
			(type_identifier) @symbol
		]`],csharp:[ir.csharp`[
			(identifier) @symbol
		]`],go:[ir.go`[
			(identifier) @symbol
		]`],java:[ir.java`[
			(identifier) @symbol
		]`],python:[ir.python`[
			(identifier) @symbol
		]`],ruby:[ir.ruby`[
			(identifier) @symbol
		]`],rust:[ir.rust`[
			(identifier) @symbol
		]`]}),Cme=Cu({...Tc(["typescript","tsx"],[ir.typescript`
			[
				(comment) @comment ;; split into multiple comment kinds?

				(declaration) @declaration

				;; class declaration related
				(public_field_definition) @public_field_definition
				(method_definition) @method_definition
				(class_declaration (_ (method_signature) @method_signature))
				(abstract_method_signature) @abstract_method_signature

				;; enum declaration related
				(enum_assignment) @enum_assignment

				;; interface declaration related
				(interface_declaration (_ (method_signature) @method_signature))
				(interface_declaration (_ (property_signature) @property_signature))

				;; statements

				(import_statement) @import_statement
				(export_statement) @export_statement

				(expression_statement) @expression_statement

				(for_in_statement) @for_in_statement
				;; exclude any children found in the for loop condition
				(for_statement condition: (_) @for_statement.exclude_captures ) @for_statement
				(break_statement) @break_statement
				(continue_statement) @continue_statement
				(do_statement) @do_statement
				(if_statement) @if_statement
				(if_statement
					consequence: [
						(expression_statement)
						(if_statement)
					] @if_statement.exclude_captures)
				(else_clause
					[
						(expression_statement)
						(if_statement) ; for if-else chains
					] @else_clause.exclude_captures)
				(switch_statement) @switch_statement
				(switch_case) @switch_case
				(try_statement) @try_statement
				(throw_statement) @throw_statement
				(debugger_statement) @debugger_statement
				(return_statement) @return_statement
			]
		`]),python:[ir.python`
			[
				(comment) @comment

				;; simple statements
				(assert_statement) @assert_statement
				(break_statement) @break_statement
				(continue_statement) @continue_statement
				(delete_statement) @delete_statement
				(exec_statement) @exec_statement
				(expression_statement) @expression_statement
				(future_import_statement) @future_import_statement
				(global_statement) @global_statement
				(import_from_statement) @import_from_statement
				(import_statement) @import_statement
				(nonlocal_statement) @nonlocal_statement
				(pass_statement) @pass_statement
				(print_statement) @print_statement
				(raise_statement) @raise_statement
				(return_statement) @return_statement
				(type_alias_statement) @type_alias_statement


				;; compound statements

				(class_definition) @class_definition
				(decorated_definition) @decorated_definition
				(for_statement) @for_statement
				(function_definition) @function_definition
				(if_statement) @if_statement
				(try_statement) @try_statement
				(while_statement) @while_statement
				(with_statement) @with_statement


				;; expressions

				(expression_list) @expression_list
				(expression_statement) @expression_statement
			]
		`],javascript:[ir.javascript`
			[
				(comment) @comment ;; split into multiple comment kinds?

				(declaration) @declaration

				;; class declaration related

				(field_definition) @field_definition
				(method_definition) @method_definition

				;; statements

				(import_statement) @import_statement
				(export_statement) @export_statement

				(expression_statement) @expression_statement

				(for_in_statement) @for_in_statement
				;; exclude any children found in the for loop condition
				(for_statement condition: (_) @for_statement.exclude_captures ) @for_statement
				(break_statement) @break_statement
				(continue_statement) @continue_statement
				(do_statement) @do_statement
				(if_statement) @if_statement
				(switch_statement) @switch_statement
				(switch_case) @switch_case
				(try_statement) @try_statement
				(throw_statement) @throw_statement
				(debugger_statement) @debugger_statement
				(return_statement) @return_statement
			]`],go:[ir.go`
		[
			(_statement) @statement
			(function_declaration) @function_declaration
			(import_declaration) @import_declaration
			(method_declaration) @method_declaration
			(package_clause) @package_clause

			(if_statement
				initializer: (_) @for_statement.exclude_captures) @for_statement

			(expression_case) @expression_case ;; e.g., case 0:
		]
		`],ruby:[ir.ruby`
			[
				(comment) @comment

				(assignment) @assignment

				(if) @if

				(call) @call

				(case) @case

				(when) @when

				(while) @while

				(for) @for

				(method) @method

				(class) @class

				(module) @module

				(begin) @begin
			]
		`],csharp:[ir.csharp`
			[
				(comment) @comment

				(class_declaration) @class_declaration
				(constructor_declaration) @constructor_declaration
				(method_declaration) @method_declaration
				(delegate_declaration) @delegate_declaration
				(enum_declaration) @enum_declaration
				(extern_alias_directive) @extern_alias_directive
				(file_scoped_namespace_declaration) @file_scoped_namespace_declaration
				(global_attribute) @global_attribute
				(global_statement) @global_statement
				(interface_declaration) @interface_declaration
				(namespace_declaration) @namespace_declaration
				(record_declaration) @record_declaration
				(struct_declaration) @struct_declaration
				(using_directive) @using_directive

				(local_declaration_statement) @local_declaration_statement
				(expression_statement) @expression_statement
				(for_statement) @for_statement
				(foreach_statement) @foreach_statement
				(continue_statement) @continue_statement
				(break_statement) @break_statement
				(throw_statement) @throw_statement
				(return_statement) @return_statement
				(try_statement) @try_statement
			]
		`],cpp:[ir.cpp`
			[
				(declaration) @declaration

				(expression_statement) @expression_statement

				(comment) @comment

				(preproc_include) @preproc_include

				(namespace_definition) @namespace_definition

				(enum_specifier) @enum_specifier

				(struct_specifier) @struct_specifier

				(template_declaration) @template_declaration

				(function_definition) @function_definition

				(return_statement) @return_statement

				(class_specifier) @class_specifier

				(try_statement) @try_statement

				(throw_statement) @throw_statement

				(for_statement) @for_statement
				(for_statement
					initializer:(_) @for_statement.exclude_captures) @for_statement

				(for_range_loop) @for_range_loop
			]
		`],java:[ir.java`
		[
			(statement) @statement ;; @ulugbekna: this includes (declaration); but somehow it can't capture inner classes

			(line_comment) @line_comment
			(block_comment) @block_comment

			(for_statement
				init: (_) @for_statement.exclude_captures)

			(block) @block.exclude_captures

			(field_declaration) @field_declaration
		]
		`],rust:[]}),Eme={...Tc(["typescript","tsx"],["program","interface_declaration","class_declaration","function_declaration","function_expression","type_alias_declaration","method_definition"]),javascript:["program","class_declaration","function_declaration","function_expression","method_definition"],java:["program","class_declaration","interface_declaration","method_declaration"],cpp:["translation_unit","class_specifier","function_definition"],csharp:["compilation_unit","class_declaration","interface_declaration","method_declaration"],python:["module","class_definition","function_definition"],go:["source_file","type_declaration","function_declaration","method_declaration"],ruby:["program","method","class","method"],rust:["source_file","function_item","impl_item","let_declaration"]},Tme=Cu({typescript:[jd("typescript")],tsx:[jd("tsx")],javascript:[jd("javascript")],java:[jd("java")],cpp:[jd("cpp")],csharp:[jd("csharp")],python:[jd("python")],go:[jd("go")],ruby:[jd("ruby")],rust:[jd("rust")]}),wme={...Tc(["typescript","tsx","javascript"],["for_in_statement","for_statement","if_statement","while_statement","do_statement","try_statement","switch_statement"]),java:["for_statement","enhanced_for_statement","if_statement","while_statement","do_statement","try_statement","switch_expression"],cpp:["for_statement","for_range_loop","if_statement","while_statement","do_statement","try_statement","switch_statement"],csharp:["for_statement","for_each_statement","if_statement","while_statement","do_statement","try_statement","switch_expression"],python:["for_statement","if_statement","while_statement","try_statement"],go:["for_statement","if_statement","type_switch_statement"],ruby:["while","for","if","case"],rust:["for_statement","if_statement","while_statement","loop_statement","match_expression"]},XHe={...Tc(["typescript","tsx"],["lexical_declaration","expression_statement","public_field_definition"]),javascript:["call_expression","expression_statement","variable_declaration","public_field_definition"],java:["expression_statement","local_variable_declaration","field_declaration"],cpp:["field_declaration","expression_statement","declaration"],csharp:["field_declaration","expression_statement"],python:["expression_statement"],go:["short_var_declaration","call_expression"],ruby:["call","assignment"],rust:["expression_statement","let_declaration","use_declaration","assignment_expression","macro_definition","extern_crate_declaration"]},JHe={...Tc(["typescript","tsx"],["class_declaration","function_declaration","generator_function_declaration","interface_declaration","internal_module","method_definition","abstract_class_declaration"]),javascript:["class_declaration","function_declaration","generator_function_declaration","method_definition"],java:["class_declaration","constructor_declaration","enum_declaration","interface_declaration","method_declaration","module_declaration"],cpp:["class_specifier","function_definition","namespace_definition","struct_specifier"],csharp:["class_declaration","constructor_declaration","destructor_declaration","enum_declaration","interface_declaration","method_declaration","namespace_declaration","struct_declaration"],python:["function_definition","class_definition"],go:["function_declaration","method_declaration"],ruby:["class","method","module"],rust:["function_item","impl_item","mod_item","struct_item","trait_item","union_item"]},Rme=Cu({typescript:[Vd("typescript")],tsx:[Vd("tsx")],javascript:[Vd("javascript")],java:[Vd("java")],cpp:[Vd("cpp")],csharp:[Vd("csharp")],python:[Vd("python")],go:[Vd("go")],rust:[Vd("rust")],ruby:[Vd("ruby")]});function jd(t){return Eme[t].map(e=>`(${e}) @scope`).join(`
`)}function Vd(t){return`[
		${JHe[t].map(r=>`(${r})`).join(`
`)}
	] @definition`}function _k(t,e){return Eme[t].includes(e.type)||wme[t].includes(e.type)}function kme(t,e){return wme[t].includes(e.type)}function Cz(t,e){return XHe[t].includes(e.type)}var Pme={...Tc(["typescript","tsx"],[ir.typescript`[
			(call_expression
				function: (identifier) @fn
				(#any-of? @fn "test" "it")
			) @test
		]`]),javascript:[ir.javascript`[
			(call_expression
				function: (identifier) @fn
				(#any-of? @fn "test" "it")
			) @test
		]`],python:[ir.python`[
			(function_definition
				name: (identifier) @fn
				(#match? @fn "^test_")
			) @test
		]`],java:[ir.java`[
			(method_declaration
				name: (identifier) @fn
				(#match? @fn "^test")
			) @test
		]`],go:[ir.go`[
			(function_declaration
				name: (identifier) @fn
				(#match? @fn "^Test")
			) @test
		]`],ruby:[],csharp:[],cpp:[],rust:[]};var Ez=Ame(),Tz=class{constructor(){this.loadedLanguagesCache=new Map}loadLanguage(e){return this.loadedLanguagesCache.has(e)||this.loadedLanguagesCache.set(e,this._doLoadLanguage(e)),this.loadedLanguagesCache.get(e)}_doLoadLanguage(e){let n=`tree-sitter-${e==="csharp"?"c-sharp":e}.wasm`,o=xk.basename(__dirname)==="dist"?xk.resolve(__dirname,n):xk.resolve(__dirname,"../../../../dist",n);return Ez.Language.load(o)}},wz=class t{static{this.CACHE_SIZE_PER_LANGUAGE=5}constructor(){this.caches=new Map,this.languageLoader=new Tz,this._parser=null}get parser(){return this._parser||(this._parser=new Ez),this._parser}async parse(e,r){await Ez.init();let n=this.getParseTreeCache(e),o=n.get(r);if(o)return o.createReference();let s=await this.languageLoader.loadLanguage(e);this.parser.setLanguage(s);let a=this.parser.parse(r),c=new kz(a);return n.put(r,c),c.createReference()}dispose(){this._parser&&(this.parser.delete(),this._parser=null);for(let e of this.caches.values())e.dispose()}getParseTreeCache(e){let r=this.caches.get(e);return r||(r=new J3(t.CACHE_SIZE_PER_LANGUAGE),this.caches.set(e,r)),r}},Rz=class{constructor(e){this._tree=e;this._refCount=1}get tree(){if(this._refCount===0)throw new Error("Cannot access disposed RefCountedParseTree");return this._tree}ref(){if(this._refCount===0)throw new Error("Cannot ref disposed RefCountedParseTree");this._refCount++}deref(){if(this._refCount===0)throw new Error("Cannot deref disposed RefCountedParseTree");this._refCount--,this._refCount===0&&this._tree.delete()}},kz=class{constructor(e){this._tree=new Rz(e)}dispose(){this._tree.deref()}createReference(){return new Pz(this._tree)}},Pz=class{constructor(e){this._parseTree=e;this._parseTree.ref()}get tree(){return this._parseTree.tree}dispose(){this._parseTree.deref()}},Lme=new wz;function ZHe(){Lme.dispose()}function Fi(t,e){return Lme.parse(t,e)}var Az=class{constructor(e){this.language=e;this.map=new Map}getQuery(e){return this.map.has(e)||this.map.set(e,this.language.query(e)),this.map.get(e)}},Dz=class t{constructor(){this.map=new Map}static{this.INSTANCE=new t}getQuery(e,r){return this.map.has(e)||this.map.set(e,new Az(e)),this.map.get(e).getQuery(r)}};function wc(t,e){let r=[];for(let n of t){let o=Dz.INSTANCE.getQuery(e.tree.getLanguage(),n);r.push(...o.matches(e))}return r}function eje(t,e){let r=Tme[t];return wc(r,e)}function Lz(t,e){let r=_me[t];return wc(r,e)}function tje(t,e){let r=hme[t];return r?wc(r,e):[]}function rje(t,e){let r=gme[t];return r?wc(r,e):[]}function nje(t,e){let r=vme[t];return r?wc(r,e):[]}function ije(t,e){let r=yme[t];return r?wc(r,e):[]}function oje(t,e){let r=bme[t];return r?wc(r,e):[]}function sje(t,e){let r=Rme[t];return wc(r,e)}async function aje(t,e,r){let n=await Fi(t,e);try{return tje(t,n.tree.rootNode).reduce((a,c)=>{let u=c.captures.find(l=>l.name==="call_expression").node;if(Zi.doIntersect(r,u)){let l,d;t==="ruby"&&(d=c.captures.find(p=>p.name==="symbol")?.node,l=d?.text?.slice(1)),d??=c.captures.find(p=>p.name==="identifier")?.node,l??=d?.text,a.push({identifier:l??"",text:u.text,startIndex:(d??u).startIndex,endIndex:(d??u).endIndex})}return a},[])}finally{n.dispose()}}async function cje(t,e){let r=await Fi(t,e);try{return Lz(t,r.tree.rootNode).map(s=>{let a=s.captures.find(u=>u.name==="function").node;return{identifier:s.captures.find(u=>u.name==="identifier")?.node.text??"",text:a.text,startIndex:a.startIndex,endIndex:a.endIndex}})}finally{r.dispose()}}async function uje(t,e){let r=await Fi(t,e);try{return rje(t,r.tree.rootNode).map(s=>{let a=s.captures.find(u=>u.name==="class_declaration").node;return{identifier:a?.children.find(u=>u.type==="type_identifier"||u.type==="identifier"||u.type==="constant")?.text??"",text:a.text,startIndex:a.startIndex,endIndex:a.endIndex}})}finally{r.dispose()}}async function lje(t,e){let r=await Fi(t,e);try{return nje(t,r.tree.rootNode).map(s=>{let a=s.captures.find(u=>u.name==="type_declaration").node,c=s.captures.find(u=>u.name==="type_identifier")?.node.text;return c||(c=a?.children.find(u=>u.type==="type_identifier")?.text),{identifier:c??"",text:a.text,startIndex:a.startIndex,endIndex:a.endIndex}})}finally{r.dispose()}}async function dje(t,e,r){let n=await Fi(t,e);try{return ije(t,n.tree.rootNode).reduce((a,c)=>{let u=c.captures.find(l=>l.name==="type_identifier").node;return Zi.doIntersect(r,u)&&a.push({identifier:u.text,text:u.text,startIndex:u.startIndex,endIndex:u.endIndex}),a},[])}finally{n.dispose()}}async function pje(t,e,r){let n=await Fi(t,e);try{return oje(t,n.tree.rootNode).reduce((a,c)=>{let u=c.captures.find(l=>l.name==="new_expression").node;return Zi.doIntersect(r,u)&&a.push({identifier:u.text,text:u.text,startIndex:u.startIndex,endIndex:u.endIndex}),a},[])}finally{n.dispose()}}async function fje(t,e,r){let n=await Fi(t,e);try{let o=Ime[t];return wc(o,n.tree.rootNode).reduce((c,u)=>{let l=u.captures.find(d=>d.name==="symbol").node;return Zi.doIntersect(r,l)&&c.push({identifier:l.text,text:l.text,startIndex:l.startIndex,endIndex:l.endIndex}),c},[])}finally{n.dispose()}}async function mje(t,e){let r=await Fi(t,e);try{let n=sje(t,r.tree.rootNode);return kje(t,n,r.tree.rootNode)}finally{r.dispose()}}async function hje(t,e){let r=await Fi(t,e);try{return Lz(t,r.tree.rootNode).map(s=>{let a=s.captures.find(c=>c.name==="function").node;return{startIndex:a.startIndex,endIndex:a.endIndex}})}finally{r.dispose()}}async function gje(t,e){let r=await Fi(t,e);try{return Lz(t,r.tree.rootNode).map(s=>{let a=s.captures.find(c=>c.name==="body").node;return{startIndex:a.startIndex,endIndex:a.endIndex}})}finally{r.dispose()}}async function vje(t,e,r){let n=await Fi(t,e);try{let o=eje(t,n.tree.rootNode),s;for(let a of o){let c=a.captures[0].node,u=gh.ofSyntaxNode(c);if(gh.doesContain(u,r)&&(s=c),pl.isBefore(r.endPosition,u.startPosition))break}if(s)return gh.ofSyntaxNode(s);throw new Error("No parent node found")}finally{n.dispose()}}async function yje(t,e,r,n){let o=await Fi(t,e);try{let s=o.tree.rootNode.descendantForPosition(r.startPosition,r.endPosition),a={startPosition:s.startPosition,endPosition:s.endPosition},c=Mme(t,s,n,r,!0);return gh.equals(a,c)?Ome(t,s):c}finally{o.dispose()}}function Ome(t,e){let r=e.parent,n={startPosition:e.startPosition,endPosition:e.endPosition};if(_k(t,e)||!r)return n;let{filteredRanges:o,indexOfInterest:s}=Fme(t,r.children,n,!1);if(s-1>=0&&s+1<=o.length-1){let a=o[s-1],c=o[s+1];return{startPosition:a.startPosition,endPosition:c.endPosition}}return Ome(t,r)}function Mme(t,e,r,n,o){let s=e.children;if(e.endPosition.row-e.startPosition.row+1<=r){let c=_k(t,e)?{startPosition:e.startPosition,endPosition:e.endPosition}:Nme(t,s,r,n,o),u=e.parent;return u?Mme(t,u,r,c,!1):c}return Nme(t,s,r,n,o)}function Dme(t,e){return e.endPosition.row-t.startPosition.row+1}function Nme(t,e,r,n,o){if(e.length===0)return n;let{filteredRanges:s,indexOfInterest:a}=Fme(t,e,n,o),c=0,u=s.length-1,l=s[c],d=s[u];for(;Dme(l,d)>r&&c!==u;)a-c<u-a?(u--,d=s[u]):(c++,l=s[c]);return Dme(l,d)<=r?{startPosition:l.startPosition,endPosition:d.endPosition}:n}function Fme(t,e,r,n){let o,s;if(n?(o=e.filter(a=>_k(t,a)||Cz(t,a)),s=eue(o,r,(a,c)=>pl.isBefore(a.startPosition,c.startPosition)),o.splice(s,0,r)):(o=e.filter(a=>gh.doesContain(a,r)||_k(t,a)||Cz(t,a)),s=o.findIndex(a=>gh.doesContain(a,r))),s===-1)throw new Error("Valid index not found");return{filteredRanges:o,indexOfInterest:s}}function e5(t,e,r,n=Oz){let o=[t.rootNode],s=[];for(;;){let a=o.map(c=>[c,Zi.intersectionSize(c,e)]).filter(([c,u])=>u>0).sort(([c,u],[l,d])=>d-u);if(a.length===0)return s.length===0?void 0:hR(s,([c,u],[l,d])=>u-d)[0];{let c=a.map(([u,l])=>{let d=Zi.len(u),p=Math.abs(Zi.len(e)-l),m=(l-p)/d;return[u,m]});s.push(...c.filter(([u,l])=>n(u,r))),o=[],o.push(...c.flatMap(([u,l])=>u.children))}}}async function bje(t,e,r){let n=await Fi(t,e);try{let o=n.tree.rootNode.descendantForIndex(r.startIndex,r.endIndex);if(o.type.match(/identifier/)&&(o.parent===null||Oz(o.parent,t))){let s=o.parent,a=s===null?void 0:{startIndex:s.startIndex,endIndex:s.endIndex};return{identifier:o.text,nodeRange:a}}}finally{n.dispose()}}async function _je(t,e,r){let n=await Fi(t,e);try{let o=Sme[t],c=wc(o,n.tree.rootNode).flatMap(({captures:u})=>u).filter(({name:u})=>u.endsWith("identifier")).find(({node:u})=>Zi.doesContain(u,r));return c?{identifier:c.node.text}:void 0}catch{return}finally{n.dispose()}}async function xje(t,e){let r=await Fi(t,e);try{let o=wc(Pme[t],r.tree.rootNode).flatMap(a=>a.captures).sort((a,c)=>a.node.endIndex-c.node.endIndex).filter(a=>a.name==="test");if(o.length===0)return null;let s=o[o.length-1].node;return{startIndex:s.startIndex,endIndex:s.endIndex}}finally{r.dispose()}}async function Sje(t,e,r){let n=[],a=(await Fi(t,e)).tree.rootNode.descendantForIndex(r.startIndex,r.endIndex);for(;a!==null;)kme(t,a)&&n.push({startIndex:a.startIndex,endIndex:a.endIndex}),a=a.parent;return n}async function Ije(t,e,r){let n=await Fi(t,e);try{let s=r.startIndex===r.endIndex?void 0:e5(n.tree,r,t);if(s)return{nodeIdentifier:Nz(s,t),nodeToDocument:PN.ofSyntaxNode(s),nodeSelectionBy:"matchingSelection"};let c=n.tree.rootNode.descendantForIndex(r.startIndex,r.endIndex),u=0;for(;!Oz(c,t)&&c.parent!==null;)c=c.parent,++u;return{nodeIdentifier:Nz(c,t),nodeToDocument:PN.ofSyntaxNode(c),nodeSelectionBy:"expanding"}}finally{n.dispose()}}async function Cje(t,e,r){let n=await Fi(t,e);try{let o=r.startIndex===r.endIndex;if(o)return;let s=o?void 0:e5(n.tree,r,t),a=o?void 0:e5(n.tree,r,t,Eje);if(a&&s)return{nodeIdentifier:Nz(s,t),nodeToExplain:PN.ofSyntaxNode(a)}}finally{n.dispose()}}function Nz(t,e){switch(e){case"python":case"csharp":return t.children.find(r=>r.type.match(/identifier/))?.text;case"go":{let r=t.children.find(o=>o.type.match(/identifier/));return r?r.text:t.children.find(o=>o.type.match(/spec/))?.children.find(o=>o.type.match(/identifier/))?.text}case"javascript":case"javascriptreact":case"typescript":case"typescriptreact":case"cpp":{let r=t.children.find(o=>o.type.match(/declarator/));return r?r.children.find(o=>o.type.match(/identifier/))?.text:t.children.find(o=>o.type.match(/identifier/))?.text}case"java":return t.children.find(n=>n.type==="identifier")?.text;case"ruby":return t.children.find(r=>r.type.match(/constant|identifier/))?.text;default:return t.children.find(r=>r.type.match(/identifier/))?.text}}function Eje(t,e){return t.type.match(/definition/)}function Oz(t,e){switch(e){case"typescript":case"tsx":case"javascript":return t.type.match(/definition|declaration|declarator|export_statement/);case"go":return t.type.match(/definition|declaration|declarator|var_spec/);case"cpp":return t.type.match(/definition|declaration|class_specifier/);case"ruby":return t.type.match(/module|class|method|assignment/);default:return t.type.match(/definition|declaration|declarator/)}}async function Tje(t,e){if(!new Set(["javascript","typescript","java","cpp","csharp","go","ruby"]).has(t))return;let n=await Fi(t,e);try{let o=xme[t],s=wc(o,n.tree.rootNode).flatMap(c=>c.captures.filter(u=>u.name==="docComment")),a=wje(s);if(a.length>1&&(a=a.filter(c=>c.includes(`
`)||!c.match(/(implementation code|code implementation|implementation details|\.\.\.)/i))),a.length===1)return a[0]}finally{n.dispose()}}function wje(t){let e=[];for(let r=0;r<t.length;++r){let n=[t[r].node.text];for(;r+1<t.length&&t[r].node.endPosition.row+1===t[r+1].node.startPosition.row;)++r,n.push(t[r].node.text);e.push(n.join(`
`))}return e}async function Rje(t,e){let r=Cme[t];if(r.length===0)return;let n=await Fi(t,e);try{let o=wc(r,n.tree.rootNode).flatMap(u=>u.captures).sort((u,l)=>Zi.compare(u.node,l.node)),s=[];for(let u of o)u.name.endsWith(".exclude_captures")&&s.push(Zi.ofSyntaxNode(u.node));let a=new gd(0,e.length,"root",[]),c=[a];for(let u=0;u<o.length;++u){let d=o[u].node;if(s.some(m=>Zi.isEqual(m,d)))continue;let p;do p=c.pop();while(p&&!Zi.doesContain(p,d));if(new Set(["export_statement","ambient_declaration"]).has(p.kind))p.kind=d.type,c.push(p);else{let m=d.type;(t==="typescript"||t==="tsx"||t==="javascript")&&m==="method_definition"&&d.namedChildren.some(_=>_.type==="property_identifier"&&_.text==="constructor")&&(m="constructor");let h=d.startIndex,g=d.previousSibling;if(g!==null){let S=e.substring(g.endIndex,d.startIndex).indexOf(`
`);S===-1?h=g.endIndex:h=g.endIndex+S+1}let v=d.endIndex,y=d.nextSibling;if(t==="typescript"&&y!==null&&(y.type===";"||y.type===",")&&(y=y.nextSibling),y!==null){let S=e.substring(d.endIndex,y.startIndex).indexOf(`
`);S!==-1&&(v=d.endIndex+S+1)}let b=new gd(h,v,m,[]);p.children.push(b),c.push(p,b)}}return a}catch(o){console.error(o instanceof Error?o:new Error(o))}finally{n.dispose()}}function kje(t,e,r){let n;switch(t){case"python":n=Nje(e);break;case"ruby":n=Dje(e);break;default:{n=Pje(e,t);break}}return new Z3(n,fl.ofSyntaxNode(r))}function Pje(t,e){let r=new Map;return t.forEach(n=>{let s=n.captures.find(c=>c.name==="definition")?.node,a=s?.childForFieldName("body");if(s&&a){let c;switch(e){case"typescript":case"javascript":{let{definition:l,comments:d}=Lje(s);s=l,c=d;break}case"java":case"rust":c=Oje(s);break;default:{c=Sk(s);break}}r.get(s.id)||r.set(s.id,{mainBlock:fl.ofSyntaxNode(s),detailBlocks:{comments:c.map(l=>fl.ofSyntaxNode(l)),body:fl.ofSyntaxNode(a)}})}}),Array.from(r.values())}function Aje(t){if(!(t.length<2))for(let e=1;e<t.length;e++){let r=t[e];if(!r.type.includes("parameters"))return r}}function Dje(t){let e=new Map;return t.forEach(r=>{let o=r.captures.find(s=>s.name==="definition")?.node;if(o){let s=o.namedChildren,a=Aje(s);if(a){let c=s[s.length-1],u=o.text.substring(a.startIndex-o.startIndex,c.endIndex-o.startIndex),l=Sk(o);e.get(o.id)||e.set(o.id,{mainBlock:fl.ofSyntaxNode(o),detailBlocks:{comments:l.map(p=>fl.ofSyntaxNode(p)),body:{range:{startPosition:{row:a.startPosition.row,column:a.startPosition.column},endPosition:{row:c.endPosition.row,column:c.endPosition.column}},startIndex:a.startIndex,text:u,endIndex:c.endIndex}}})}}}),Array.from(e.values())}function Nje(t){let e=new Map;return t.forEach(r=>{let o=r.captures.find(a=>a.name==="definition")?.node,s=o?.childForFieldName("body");if(o&&s){let a=Fje(s),c=Mje(o);e.set(o.id,{mainBlock:fl.ofSyntaxNode(o),detailBlocks:{docstring:a?fl.ofSyntaxNode(a):void 0,decorator:c?fl.ofSyntaxNode(c):void 0,body:fl.ofSyntaxNode(s)}});return}}),Array.from(e.values())}function Sk(t,e=["comment"]){let r=[],n=t.previousNamedSibling;for(;n&&e.some(o=>o===n?.type);)r.push(n),n=n.previousNamedSibling;return r.reverse()}function Lje(t){let e=t.parent;return e?.type==="export_statement"?{definition:e,comments:Sk(e)}:{definition:t,comments:Sk(t)}}function Oje(t){return Sk(t,["block_comment","line_comment"])}function Mje(t){let e=t.previousNamedSibling;return e?.type==="decorator"?e:void 0}function Fje(t){let e=t.firstChild;if(!e||e.type!=="expression_statement")return;let r=e.firstChild;return r?.type==="string"?r:void 0}var Uje=Bme.join(__dirname,"worker2.js"),xI=class{constructor(e,r){this._parser=new Fz(Mz,Uje,e,r.getLogger("parser proxy"))}dispose(){this._parser.proxy._dispose(),this._parser.dispose()}getTreeSitterAST(e){let r=lf(e.languageId);if(r)return this.getTreeSitterASTForWASMLanguage(r,e.getText())}getTreeSitterASTForWASMLanguage(e,r){let n=this._parser.proxy;return{getFunctionPositions:()=>n._getFunctionPositions(e,r),getFunctionBodies:()=>n._getFunctionBodies(e,r),getCoarseParentScope:o=>n._getCoarseParentScope(e,r,o),getFixSelectionOfInterest:(o,s)=>n._getFixSelectionOfInterest(e,r,o,s),getCallExpressions:o=>n._getCallExpressions(e,r,o),getFunctionDefinitions:()=>n._getFunctionDefinitions(e,r),getClassReferences:o=>n._getClassReferences(e,r,o),getClassDeclarations:()=>n._getClassDeclarations(e,r),getTypeDeclarations:()=>n._getTypeDeclarations(e,r),getTypeReferences:o=>n._getTypeReferences(e,r,o),getSymbols:o=>n._getSymbols(e,r,o),getDocumentableNodeIfOnIdentifier:o=>n._getDocumentableNodeIfOnIdentifier(e,r,o),getTestableNode:o=>n._getTestableNode(e,r,o),getNodeToExplain:o=>n._getNodeToExplain(e,r,o),getNodeToDocument:o=>n._getNodeToDocument(e,r,o),getFineScopes:o=>n._getFineScopes(e,r,o),getStructure:()=>n._getStructure(e,r),findLastTest:()=>n._findLastTest(e,r)}}extractDoc(e,r){return this._parser.proxy._extractDoc(e,r)}getSemanticChunkTree(e,r){return this._parser.proxy._getSemanticChunkTree(e,r)}getStructure(e,r){return this._parser.proxy._getStructure(e,r)}};xI=O([x(1,ue)],xI);var Fz=class{constructor(e,r,n,o){this._workerPath=r;this._useWorker=n;this._local=new Proxy(e,{get:(s,a,c)=>{let u=s[a];return typeof u!="function"?u:async(...l)=>{let d=await u.apply(s,Ume(l));return Ume(d)}}}),this._worker=new Wi(()=>new Nh(this._workerPath,{name:"Parser worker"},o))}get proxy(){return this._useWorker?this._worker.value.proxy:this._local}dispose(){this._worker.hasValue&&this._worker.value.terminate()}};function Ume(t){return typeof t>"u"?t:JSON.parse(JSON.stringify(t))}var t5=require("vscode");var n5=ae("IRemoteRepositoriesService"),r5=class{async loadWorkspaceContents(e){return await(await this.getApi()).loadWorkspaceContents?.(e)??!1}getApi(){return this.getRemoteExtension().activate()}getRemoteExtension(){if(this._remoteHub!==void 0)return this._remoteHub;if(this._remoteHub=t5.extensions.getExtension("ms-vscode.remote-repositories")??t5.extensions.getExtension("GitHub.remoteHub")??t5.extensions.getExtension("GitHub.remoteHub-insiders"),this._remoteHub===void 0)throw new Error("No Remote repository extension found.");return this._remoteHub}};function qme(t){let r=[`(repo:${(Array.isArray(t.repo)?t.repo:[t.repo]).join(" OR repo:")})`];return t.lang&&r.push(`(lang:${t.lang.join(" OR lang:")})`),t.notLang&&r.push(`NOT (lang:${t.notLang.join(" OR lang:")})`),t.path&&r.push(`(path:${t.path.join(" OR path:")})`),t.notPath&&r.push(`NOT (path:${t.notPath.join(" OR path:")})`),r.join(" ")}var i5=class extends Error{constructor(r,n){super(n);this.status=r}},Bje=6,qje=.766,ky=class{constructor(e,r,n,o,s,a){this._domainService=e;this._telemetryService=r;this._authenticationService=n;this._fetcherService=o;this._envService=s;this._logger=a.getLogger("CodeOrDocsSearchClient")}async search(e,r,n={},o){let s;if(Array.isArray(r.repo)&&!r.repo.length)throw new Error("No repos specified");try{s=await this.postCodeOrDocsSearchRequestWithRetry(e,r,n,o)}catch(c){throw this._telemetryService.sendGHTelemetryException(c,`${this.slug} search failed`),c}let a=s.errors?.map($se)??[];if(!Array.isArray(r.repo)){if(a.length)throw a.length>1?new AggregateError(a):a[0];return s.results}return{results:s.results,errors:a}}async postCodeOrDocsSearchRequestWithRetry(e,r,n,o){let s=(await this._authenticationService.getPermissiveGitHubSession({silent:!0}))?.accessToken??(await this._authenticationService.getAnyGitHubSession({silent:!0}))?.accessToken;if(o?.isCancellationRequested)return{results:[]};let a=`${this._domainService.searchSkillURL}/${this.slug}`,c=5,u=0,l=new Set,d;for(;u<c;){if(o?.isCancellationRequested)return{results:[]};try{try{return await this.postCodeOrDocsSearchRequest(a,s,e,r,n,o)}catch(p){if(p instanceof i5)throw p;d=p;break}}catch(p){u++;let f=u*1e3;l.add(`Error fetching ${this.slug} search. ${p.message??p}`),this._logger.warn(`[repo:${r.repo}] Error fetching ${this.slug} search. Error: ${p.message??p}. Retrying in ${u} seconds. Query: ${e}`),await new Promise(m=>setTimeout(m,f))}}if(o?.isCancellationRequested)return{results:[]};throw u>=c&&(this._logger.warn(`[repo:${r.repo}] Max Retry Error thrown while querying '${e}'`),d=aH({error:"ERROR_TYPE_MAX_RETRIES_EXCEEDED",message:`${this.slug} search timed out after ${c} retries. ${Array.from(l).join(`
`)}`})),d}async postCodeOrDocsSearchRequest(e,r,n,o,s,a){let c=s.limit??Bje,u=s.similarity??qje,l=s.rawChunks??!1,d={url:e,family:"Code Or Doc Search",name:"Code Or Doc Search",version:"2023-12-12-preview",modelMaxPromptTokens:0,getExtraHeaders(){let h={Accept:"application/json","X-GitHub-Api-Version":"2023-12-12-preview"};return l&&(h["X-Experiment-blackbird_snippet_mode"]="raw"),h}},p=await FS(this._fetcherService,this._envService,this._telemetryService,this._domainService,d,r??"",await Ff(process.env.HMAC_SECRET),void 0,Br(),{query:n,scopingQuery:qme(o),similarity:u,limit:c},a),f=await p.text();if(p.status===404||p.status===400&&f.includes("unknown integration"))throw this._logger.debug(`${this.slug} search endpoint not available for this user.`),aH({error:"ERROR_TYPE_NO_ACCESS_TO_ENDPOINT",message:`${this.slug}: ${f}`});let m;try{m=JSON.parse(f)}catch{throw new i5(p.status,f)}return m}};O([Li(e=>e._logger)],ky.prototype,"search",1),ky=O([x(0,yn),x(1,me),x(2,Nt),x(3,$r),x(4,Rt),x(5,ue)],ky);var o5=class extends ky{constructor(){super(...arguments);this.slug="code"}},s5=class extends ky{constructor(){super(...arguments);this.slug="docs"}};var _i=z(require("vscode"));var SI=require("vscode");var II=class{constructor(e,r,n){this._configurationService=e;this._contextService=r;this._disposables=new Tt;this._commentController=_i.comments.createCommentController("github-copilot-review","GitHub Copilot Review");this._comments=[];this._logger=n.getLogger("ReviewService"),this._disposables.add(_i.workspace.onDidChangeConfiguration(o=>{o.affectsConfiguration("github.copilot.advanced")&&(_i.commands.executeCommand("setContext","github.copilot.advanced.review.contextmenu.enabled",this._configurationService.getConfig(fe.ReviewContextMenu)),_i.commands.executeCommand("setContext","github.copilot.advanced.review.scmviewlet.enabled",this._configurationService.getConfig(fe.ReviewSCMViewlet))),(o.affectsConfiguration("github.copilot.advanced")||o.affectsConfiguration("github.copilot.advanced.review.intent"))&&_i.commands.executeCommand("setContext","github.copilot.advanced.review.intent.enabled",this.isIntentEnabled())})),this.updateContextValues()}updateContextValues(){_i.commands.executeCommand("setContext","github.copilot.advanced.review.contextmenu.enabled",this._configurationService.getConfig(fe.ReviewContextMenu)),_i.commands.executeCommand("setContext","github.copilot.advanced.review.scmviewlet.enabled",this._configurationService.getConfig(fe.ReviewSCMViewlet)),_i.commands.executeCommand("setContext","github.copilot.advanced.review.intent.enabled",this.isIntentEnabled())}isIntentEnabled(){let e=this._configurationService.getConfig(fe.ReviewIntent);return e!==fe.ReviewIntent.defaultValue?e:_i.workspace.getConfiguration("github.copilot.advanced.review").get("intent",fe.ReviewIntent.defaultValue)}getDiagnosticCollection(){return this._diagnosticCollection||this._disposables.add(this._diagnosticCollection=_i.languages.createDiagnosticCollection("github.copilot.review"))}getReviewComments(){return this._comments.map(({comment:e})=>e)}addReviewComments(e){for(let r of e){let n=this._commentController.createCommentThread(r.uri,r.range,this.createUIComments(r));n.contextValue="hasNoSuggestion",n.canReply=!1,this._comments.find(o=>o.comment.uri.toString()===r.uri.toString())||(n.collapsibleState=_i.CommentThreadCollapsibleState.Expanded),this._comments.push({comment:r,thread:n}),this.updateThreadLabels(),this._comments.length===1&&(_i.commands.executeCommand("github.copilot.interactiveEditor.review.next"),this._monitorActiveThread=setInterval(()=>{let o=this._commentController.activeCommentThread,s=o&&this._comments.find(a=>a.thread.label===o.label)?.thread;s!==this._activeThread&&(this._activeThread=s,s&&_i.commands.executeCommand("github.copilot.interactiveEditor.review.current",s))},500))}}updateReviewComment(e){let r=this.findCommentThread(e);r&&(r.comments=this.createUIComments(e))}createUIComments(e){let r="",n=e.suggestion?"edits"in e.suggestion?e.suggestion.edits.length?`

***
${SI.l10n.t("Suggested change:")}${e.suggestion.edits.map(s=>`
\`\`\`diff
${Hme(s.newText,"+ ")}
${Hme(s.oldText,"- ")}
\`\`\``).join("")}
***`:`

${SI.l10n.t("No change found to suggest.")}`:`

${SI.l10n.t("Looking up change to suggest...")}`:"";return[{body:typeof e.body=="string"?`${e.body}${n}${r}`:new _i.MarkdownString(`${e.body.value}${n}${r}`),mode:_i.CommentMode.Preview,author:{name:SI.l10n.t("GitHub Copilot"),iconPath:dt.joinPath(this._contextService.extensionUri,"assets","Copilot-chat-avatar.png")}}]}collapseReviewComment(e){let r=this._comments.find(s=>s.comment===e);if(!r)return;let n=r.thread;n.dispose();let o=this._commentController.createCommentThread(e.uri,e.range,n.comments);o.contextValue=n.contextValue,o.canReply=!1,o.label=n.label,r.thread=o}removeReviewComments(e){for(let r of e){let n=this._comments.findIndex(o=>o.comment===r);n!==-1&&(this._comments[n].thread.dispose(),this._comments.splice(n,1))}this.updateThreadLabels(),this._comments.length===0&&this._monitorActiveThread&&(clearInterval(this._monitorActiveThread),this._monitorActiveThread=void 0)}updateThreadLabels(){this._comments.forEach((e,r)=>{e.thread.label=SI.l10n.t("Code Review Comment ({0} of {1})",r+1,this._comments.length)})}findReviewComment(e){return this._comments.find(n=>n.thread===e||n.thread.comments[0]===e)?.comment}findCommentThread(e){return this._comments.find(n=>n.comment===e)?.thread}dispose(){this._disposables.dispose()}};II=O([x(0,ye),x(1,ar),x(2,ue)],II);function Hme(t,e){return t.split(`
`).map(r=>`${e}${r}`).join(`
`)}var Ik=require("vscode");var jme=Object.create(null);function E(t,e){if(FT(e)){let r=jme[e];if(r===void 0)throw new Error(`${t} references an unknown codicon: ${e}`);e=r}return jme[t]=e,{id:t}}var Vme={add:E("add",6e4),plus:E("plus",6e4),gistNew:E("gist-new",6e4),repoCreate:E("repo-create",6e4),lightbulb:E("lightbulb",60001),lightBulb:E("light-bulb",60001),repo:E("repo",60002),repoDelete:E("repo-delete",60002),gistFork:E("gist-fork",60003),repoForked:E("repo-forked",60003),gitPullRequest:E("git-pull-request",60004),gitPullRequestAbandoned:E("git-pull-request-abandoned",60004),recordKeys:E("record-keys",60005),keyboard:E("keyboard",60005),tag:E("tag",60006),gitPullRequestLabel:E("git-pull-request-label",60006),tagAdd:E("tag-add",60006),tagRemove:E("tag-remove",60006),person:E("person",60007),personFollow:E("person-follow",60007),personOutline:E("person-outline",60007),personFilled:E("person-filled",60007),gitBranch:E("git-branch",60008),gitBranchCreate:E("git-branch-create",60008),gitBranchDelete:E("git-branch-delete",60008),sourceControl:E("source-control",60008),mirror:E("mirror",60009),mirrorPublic:E("mirror-public",60009),star:E("star",60010),starAdd:E("star-add",60010),starDelete:E("star-delete",60010),starEmpty:E("star-empty",60010),comment:E("comment",60011),commentAdd:E("comment-add",60011),alert:E("alert",60012),warning:E("warning",60012),search:E("search",60013),searchSave:E("search-save",60013),logOut:E("log-out",60014),signOut:E("sign-out",60014),logIn:E("log-in",60015),signIn:E("sign-in",60015),eye:E("eye",60016),eyeUnwatch:E("eye-unwatch",60016),eyeWatch:E("eye-watch",60016),circleFilled:E("circle-filled",60017),primitiveDot:E("primitive-dot",60017),closeDirty:E("close-dirty",60017),debugBreakpoint:E("debug-breakpoint",60017),debugBreakpointDisabled:E("debug-breakpoint-disabled",60017),debugHint:E("debug-hint",60017),terminalDecorationSuccess:E("terminal-decoration-success",60017),primitiveSquare:E("primitive-square",60018),edit:E("edit",60019),pencil:E("pencil",60019),info:E("info",60020),issueOpened:E("issue-opened",60020),gistPrivate:E("gist-private",60021),gitForkPrivate:E("git-fork-private",60021),lock:E("lock",60021),mirrorPrivate:E("mirror-private",60021),close:E("close",60022),removeClose:E("remove-close",60022),x:E("x",60022),repoSync:E("repo-sync",60023),sync:E("sync",60023),clone:E("clone",60024),desktopDownload:E("desktop-download",60024),beaker:E("beaker",60025),microscope:E("microscope",60025),vm:E("vm",60026),deviceDesktop:E("device-desktop",60026),file:E("file",60027),fileText:E("file-text",60027),more:E("more",60028),ellipsis:E("ellipsis",60028),kebabHorizontal:E("kebab-horizontal",60028),mailReply:E("mail-reply",60029),reply:E("reply",60029),organization:E("organization",60030),organizationFilled:E("organization-filled",60030),organizationOutline:E("organization-outline",60030),newFile:E("new-file",60031),fileAdd:E("file-add",60031),newFolder:E("new-folder",60032),fileDirectoryCreate:E("file-directory-create",60032),trash:E("trash",60033),trashcan:E("trashcan",60033),history:E("history",60034),clock:E("clock",60034),folder:E("folder",60035),fileDirectory:E("file-directory",60035),symbolFolder:E("symbol-folder",60035),logoGithub:E("logo-github",60036),markGithub:E("mark-github",60036),github:E("github",60036),terminal:E("terminal",60037),console:E("console",60037),repl:E("repl",60037),zap:E("zap",60038),symbolEvent:E("symbol-event",60038),error:E("error",60039),stop:E("stop",60039),variable:E("variable",60040),symbolVariable:E("symbol-variable",60040),array:E("array",60042),symbolArray:E("symbol-array",60042),symbolModule:E("symbol-module",60043),symbolPackage:E("symbol-package",60043),symbolNamespace:E("symbol-namespace",60043),symbolObject:E("symbol-object",60043),symbolMethod:E("symbol-method",60044),symbolFunction:E("symbol-function",60044),symbolConstructor:E("symbol-constructor",60044),symbolBoolean:E("symbol-boolean",60047),symbolNull:E("symbol-null",60047),symbolNumeric:E("symbol-numeric",60048),symbolNumber:E("symbol-number",60048),symbolStructure:E("symbol-structure",60049),symbolStruct:E("symbol-struct",60049),symbolParameter:E("symbol-parameter",60050),symbolTypeParameter:E("symbol-type-parameter",60050),symbolKey:E("symbol-key",60051),symbolText:E("symbol-text",60051),symbolReference:E("symbol-reference",60052),goToFile:E("go-to-file",60052),symbolEnum:E("symbol-enum",60053),symbolValue:E("symbol-value",60053),symbolRuler:E("symbol-ruler",60054),symbolUnit:E("symbol-unit",60054),activateBreakpoints:E("activate-breakpoints",60055),archive:E("archive",60056),arrowBoth:E("arrow-both",60057),arrowDown:E("arrow-down",60058),arrowLeft:E("arrow-left",60059),arrowRight:E("arrow-right",60060),arrowSmallDown:E("arrow-small-down",60061),arrowSmallLeft:E("arrow-small-left",60062),arrowSmallRight:E("arrow-small-right",60063),arrowSmallUp:E("arrow-small-up",60064),arrowUp:E("arrow-up",60065),bell:E("bell",60066),bold:E("bold",60067),book:E("book",60068),bookmark:E("bookmark",60069),debugBreakpointConditionalUnverified:E("debug-breakpoint-conditional-unverified",60070),debugBreakpointConditional:E("debug-breakpoint-conditional",60071),debugBreakpointConditionalDisabled:E("debug-breakpoint-conditional-disabled",60071),debugBreakpointDataUnverified:E("debug-breakpoint-data-unverified",60072),debugBreakpointData:E("debug-breakpoint-data",60073),debugBreakpointDataDisabled:E("debug-breakpoint-data-disabled",60073),debugBreakpointLogUnverified:E("debug-breakpoint-log-unverified",60074),debugBreakpointLog:E("debug-breakpoint-log",60075),debugBreakpointLogDisabled:E("debug-breakpoint-log-disabled",60075),briefcase:E("briefcase",60076),broadcast:E("broadcast",60077),browser:E("browser",60078),bug:E("bug",60079),calendar:E("calendar",60080),caseSensitive:E("case-sensitive",60081),check:E("check",60082),checklist:E("checklist",60083),chevronDown:E("chevron-down",60084),chevronLeft:E("chevron-left",60085),chevronRight:E("chevron-right",60086),chevronUp:E("chevron-up",60087),chromeClose:E("chrome-close",60088),chromeMaximize:E("chrome-maximize",60089),chromeMinimize:E("chrome-minimize",60090),chromeRestore:E("chrome-restore",60091),circleOutline:E("circle-outline",60092),circle:E("circle",60092),debugBreakpointUnverified:E("debug-breakpoint-unverified",60092),terminalDecorationIncomplete:E("terminal-decoration-incomplete",60092),circleSlash:E("circle-slash",60093),circuitBoard:E("circuit-board",60094),clearAll:E("clear-all",60095),clippy:E("clippy",60096),closeAll:E("close-all",60097),cloudDownload:E("cloud-download",60098),cloudUpload:E("cloud-upload",60099),code:E("code",60100),collapseAll:E("collapse-all",60101),colorMode:E("color-mode",60102),commentDiscussion:E("comment-discussion",60103),creditCard:E("credit-card",60105),dash:E("dash",60108),dashboard:E("dashboard",60109),database:E("database",60110),debugContinue:E("debug-continue",60111),debugDisconnect:E("debug-disconnect",60112),debugPause:E("debug-pause",60113),debugRestart:E("debug-restart",60114),debugStart:E("debug-start",60115),debugStepInto:E("debug-step-into",60116),debugStepOut:E("debug-step-out",60117),debugStepOver:E("debug-step-over",60118),debugStop:E("debug-stop",60119),debug:E("debug",60120),deviceCameraVideo:E("device-camera-video",60121),deviceCamera:E("device-camera",60122),deviceMobile:E("device-mobile",60123),diffAdded:E("diff-added",60124),diffIgnored:E("diff-ignored",60125),diffModified:E("diff-modified",60126),diffRemoved:E("diff-removed",60127),diffRenamed:E("diff-renamed",60128),diff:E("diff",60129),diffSidebyside:E("diff-sidebyside",60129),discard:E("discard",60130),editorLayout:E("editor-layout",60131),emptyWindow:E("empty-window",60132),exclude:E("exclude",60133),extensions:E("extensions",60134),eyeClosed:E("eye-closed",60135),fileBinary:E("file-binary",60136),fileCode:E("file-code",60137),fileMedia:E("file-media",60138),filePdf:E("file-pdf",60139),fileSubmodule:E("file-submodule",60140),fileSymlinkDirectory:E("file-symlink-directory",60141),fileSymlinkFile:E("file-symlink-file",60142),fileZip:E("file-zip",60143),files:E("files",60144),filter:E("filter",60145),flame:E("flame",60146),foldDown:E("fold-down",60147),foldUp:E("fold-up",60148),fold:E("fold",60149),folderActive:E("folder-active",60150),folderOpened:E("folder-opened",60151),gear:E("gear",60152),gift:E("gift",60153),gistSecret:E("gist-secret",60154),gist:E("gist",60155),gitCommit:E("git-commit",60156),gitCompare:E("git-compare",60157),compareChanges:E("compare-changes",60157),gitMerge:E("git-merge",60158),githubAction:E("github-action",60159),githubAlt:E("github-alt",60160),globe:E("globe",60161),grabber:E("grabber",60162),graph:E("graph",60163),gripper:E("gripper",60164),heart:E("heart",60165),home:E("home",60166),horizontalRule:E("horizontal-rule",60167),hubot:E("hubot",60168),inbox:E("inbox",60169),issueReopened:E("issue-reopened",60171),issues:E("issues",60172),italic:E("italic",60173),jersey:E("jersey",60174),json:E("json",60175),kebabVertical:E("kebab-vertical",60176),key:E("key",60177),law:E("law",60178),lightbulbAutofix:E("lightbulb-autofix",60179),linkExternal:E("link-external",60180),link:E("link",60181),listOrdered:E("list-ordered",60182),listUnordered:E("list-unordered",60183),liveShare:E("live-share",60184),loading:E("loading",60185),location:E("location",60186),mailRead:E("mail-read",60187),mail:E("mail",60188),markdown:E("markdown",60189),megaphone:E("megaphone",60190),mention:E("mention",60191),milestone:E("milestone",60192),gitPullRequestMilestone:E("git-pull-request-milestone",60192),mortarBoard:E("mortar-board",60193),move:E("move",60194),multipleWindows:E("multiple-windows",60195),mute:E("mute",60196),noNewline:E("no-newline",60197),note:E("note",60198),octoface:E("octoface",60199),openPreview:E("open-preview",60200),package:E("package",60201),paintcan:E("paintcan",60202),pin:E("pin",60203),play:E("play",60204),run:E("run",60204),plug:E("plug",60205),preserveCase:E("preserve-case",60206),preview:E("preview",60207),project:E("project",60208),pulse:E("pulse",60209),question:E("question",60210),quote:E("quote",60211),radioTower:E("radio-tower",60212),reactions:E("reactions",60213),references:E("references",60214),refresh:E("refresh",60215),regex:E("regex",60216),remoteExplorer:E("remote-explorer",60217),remote:E("remote",60218),remove:E("remove",60219),replaceAll:E("replace-all",60220),replace:E("replace",60221),repoClone:E("repo-clone",60222),repoForcePush:E("repo-force-push",60223),repoPull:E("repo-pull",60224),repoPush:E("repo-push",60225),report:E("report",60226),requestChanges:E("request-changes",60227),rocket:E("rocket",60228),rootFolderOpened:E("root-folder-opened",60229),rootFolder:E("root-folder",60230),rss:E("rss",60231),ruby:E("ruby",60232),saveAll:E("save-all",60233),saveAs:E("save-as",60234),save:E("save",60235),screenFull:E("screen-full",60236),screenNormal:E("screen-normal",60237),searchStop:E("search-stop",60238),server:E("server",60240),settingsGear:E("settings-gear",60241),settings:E("settings",60242),shield:E("shield",60243),smiley:E("smiley",60244),sortPrecedence:E("sort-precedence",60245),splitHorizontal:E("split-horizontal",60246),splitVertical:E("split-vertical",60247),squirrel:E("squirrel",60248),starFull:E("star-full",60249),starHalf:E("star-half",60250),symbolClass:E("symbol-class",60251),symbolColor:E("symbol-color",60252),symbolConstant:E("symbol-constant",60253),symbolEnumMember:E("symbol-enum-member",60254),symbolField:E("symbol-field",60255),symbolFile:E("symbol-file",60256),symbolInterface:E("symbol-interface",60257),symbolKeyword:E("symbol-keyword",60258),symbolMisc:E("symbol-misc",60259),symbolOperator:E("symbol-operator",60260),symbolProperty:E("symbol-property",60261),wrench:E("wrench",60261),wrenchSubaction:E("wrench-subaction",60261),symbolSnippet:E("symbol-snippet",60262),tasklist:E("tasklist",60263),telescope:E("telescope",60264),textSize:E("text-size",60265),threeBars:E("three-bars",60266),thumbsdown:E("thumbsdown",60267),thumbsup:E("thumbsup",60268),tools:E("tools",60269),triangleDown:E("triangle-down",60270),triangleLeft:E("triangle-left",60271),triangleRight:E("triangle-right",60272),triangleUp:E("triangle-up",60273),twitter:E("twitter",60274),unfold:E("unfold",60275),unlock:E("unlock",60276),unmute:E("unmute",60277),unverified:E("unverified",60278),verified:E("verified",60279),versions:E("versions",60280),vmActive:E("vm-active",60281),vmOutline:E("vm-outline",60282),vmRunning:E("vm-running",60283),watch:E("watch",60284),whitespace:E("whitespace",60285),wholeWord:E("whole-word",60286),window:E("window",60287),wordWrap:E("word-wrap",60288),zoomIn:E("zoom-in",60289),zoomOut:E("zoom-out",60290),listFilter:E("list-filter",60291),listFlat:E("list-flat",60292),listSelection:E("list-selection",60293),selection:E("selection",60293),listTree:E("list-tree",60294),debugBreakpointFunctionUnverified:E("debug-breakpoint-function-unverified",60295),debugBreakpointFunction:E("debug-breakpoint-function",60296),debugBreakpointFunctionDisabled:E("debug-breakpoint-function-disabled",60296),debugStackframeActive:E("debug-stackframe-active",60297),circleSmallFilled:E("circle-small-filled",60298),debugStackframeDot:E("debug-stackframe-dot",60298),terminalDecorationMark:E("terminal-decoration-mark",60298),debugStackframe:E("debug-stackframe",60299),debugStackframeFocused:E("debug-stackframe-focused",60299),debugBreakpointUnsupported:E("debug-breakpoint-unsupported",60300),symbolString:E("symbol-string",60301),debugReverseContinue:E("debug-reverse-continue",60302),debugStepBack:E("debug-step-back",60303),debugRestartFrame:E("debug-restart-frame",60304),debugAlt:E("debug-alt",60305),callIncoming:E("call-incoming",60306),callOutgoing:E("call-outgoing",60307),menu:E("menu",60308),expandAll:E("expand-all",60309),feedback:E("feedback",60310),gitPullRequestReviewer:E("git-pull-request-reviewer",60310),groupByRefType:E("group-by-ref-type",60311),ungroupByRefType:E("ungroup-by-ref-type",60312),account:E("account",60313),gitPullRequestAssignee:E("git-pull-request-assignee",60313),bellDot:E("bell-dot",60314),debugConsole:E("debug-console",60315),library:E("library",60316),output:E("output",60317),runAll:E("run-all",60318),syncIgnored:E("sync-ignored",60319),pinned:E("pinned",60320),githubInverted:E("github-inverted",60321),serverProcess:E("server-process",60322),serverEnvironment:E("server-environment",60323),pass:E("pass",60324),issueClosed:E("issue-closed",60324),stopCircle:E("stop-circle",60325),playCircle:E("play-circle",60326),record:E("record",60327),debugAltSmall:E("debug-alt-small",60328),vmConnect:E("vm-connect",60329),cloud:E("cloud",60330),merge:E("merge",60331),export:E("export",60332),graphLeft:E("graph-left",60333),magnet:E("magnet",60334),notebook:E("notebook",60335),redo:E("redo",60336),checkAll:E("check-all",60337),pinnedDirty:E("pinned-dirty",60338),passFilled:E("pass-filled",60339),circleLargeFilled:E("circle-large-filled",60340),circleLarge:E("circle-large",60341),circleLargeOutline:E("circle-large-outline",60341),combine:E("combine",60342),gather:E("gather",60342),table:E("table",60343),variableGroup:E("variable-group",60344),typeHierarchy:E("type-hierarchy",60345),typeHierarchySub:E("type-hierarchy-sub",60346),typeHierarchySuper:E("type-hierarchy-super",60347),gitPullRequestCreate:E("git-pull-request-create",60348),runAbove:E("run-above",60349),runBelow:E("run-below",60350),notebookTemplate:E("notebook-template",60351),debugRerun:E("debug-rerun",60352),workspaceTrusted:E("workspace-trusted",60353),workspaceUntrusted:E("workspace-untrusted",60354),workspaceUnknown:E("workspace-unknown",60355),terminalCmd:E("terminal-cmd",60356),terminalDebian:E("terminal-debian",60357),terminalLinux:E("terminal-linux",60358),terminalPowershell:E("terminal-powershell",60359),terminalTmux:E("terminal-tmux",60360),terminalUbuntu:E("terminal-ubuntu",60361),terminalBash:E("terminal-bash",60362),arrowSwap:E("arrow-swap",60363),copy:E("copy",60364),personAdd:E("person-add",60365),filterFilled:E("filter-filled",60366),wand:E("wand",60367),debugLineByLine:E("debug-line-by-line",60368),inspect:E("inspect",60369),layers:E("layers",60370),layersDot:E("layers-dot",60371),layersActive:E("layers-active",60372),compass:E("compass",60373),compassDot:E("compass-dot",60374),compassActive:E("compass-active",60375),azure:E("azure",60376),issueDraft:E("issue-draft",60377),gitPullRequestClosed:E("git-pull-request-closed",60378),gitPullRequestDraft:E("git-pull-request-draft",60379),debugAll:E("debug-all",60380),debugCoverage:E("debug-coverage",60381),runErrors:E("run-errors",60382),folderLibrary:E("folder-library",60383),debugContinueSmall:E("debug-continue-small",60384),beakerStop:E("beaker-stop",60385),graphLine:E("graph-line",60386),graphScatter:E("graph-scatter",60387),pieChart:E("pie-chart",60388),bracket:E("bracket",60175),bracketDot:E("bracket-dot",60389),bracketError:E("bracket-error",60390),lockSmall:E("lock-small",60391),azureDevops:E("azure-devops",60392),verifiedFilled:E("verified-filled",60393),newline:E("newline",60394),layout:E("layout",60395),layoutActivitybarLeft:E("layout-activitybar-left",60396),layoutActivitybarRight:E("layout-activitybar-right",60397),layoutPanelLeft:E("layout-panel-left",60398),layoutPanelCenter:E("layout-panel-center",60399),layoutPanelJustify:E("layout-panel-justify",60400),layoutPanelRight:E("layout-panel-right",60401),layoutPanel:E("layout-panel",60402),layoutSidebarLeft:E("layout-sidebar-left",60403),layoutSidebarRight:E("layout-sidebar-right",60404),layoutStatusbar:E("layout-statusbar",60405),layoutMenubar:E("layout-menubar",60406),layoutCentered:E("layout-centered",60407),target:E("target",60408),indent:E("indent",60409),recordSmall:E("record-small",60410),errorSmall:E("error-small",60411),terminalDecorationError:E("terminal-decoration-error",60411),arrowCircleDown:E("arrow-circle-down",60412),arrowCircleLeft:E("arrow-circle-left",60413),arrowCircleRight:E("arrow-circle-right",60414),arrowCircleUp:E("arrow-circle-up",60415),layoutSidebarRightOff:E("layout-sidebar-right-off",60416),layoutPanelOff:E("layout-panel-off",60417),layoutSidebarLeftOff:E("layout-sidebar-left-off",60418),blank:E("blank",60419),heartFilled:E("heart-filled",60420),map:E("map",60421),mapHorizontal:E("map-horizontal",60421),foldHorizontal:E("fold-horizontal",60421),mapFilled:E("map-filled",60422),mapHorizontalFilled:E("map-horizontal-filled",60422),foldHorizontalFilled:E("fold-horizontal-filled",60422),circleSmall:E("circle-small",60423),bellSlash:E("bell-slash",60424),bellSlashDot:E("bell-slash-dot",60425),commentUnresolved:E("comment-unresolved",60426),gitPullRequestGoToChanges:E("git-pull-request-go-to-changes",60427),gitPullRequestNewChanges:E("git-pull-request-new-changes",60428),searchFuzzy:E("search-fuzzy",60429),commentDraft:E("comment-draft",60430),send:E("send",60431),sparkle:E("sparkle",60432),insert:E("insert",60433),mic:E("mic",60434),thumbsdownFilled:E("thumbsdown-filled",60435),thumbsupFilled:E("thumbsup-filled",60436),coffee:E("coffee",60437),snake:E("snake",60438),game:E("game",60439),vr:E("vr",60440),chip:E("chip",60441),piano:E("piano",60442),music:E("music",60443),micFilled:E("mic-filled",60444),repoFetch:E("repo-fetch",60445),copilot:E("copilot",60446),lightbulbSparkle:E("lightbulb-sparkle",60447),robot:E("robot",60448),sparkleFilled:E("sparkle-filled",60449),diffSingle:E("diff-single",60450),diffMultiple:E("diff-multiple",60451),surroundWith:E("surround-with",60452),share:E("share",60453),gitStash:E("git-stash",60454),gitStashApply:E("git-stash-apply",60455),gitStashPop:E("git-stash-pop",60456),vscode:E("vscode",60457),vscodeInsiders:E("vscode-insiders",60458),codeOss:E("code-oss",60459),runCoverage:E("run-coverage",60460),runAllCoverage:E("run-all-coverage",60461),coverage:E("coverage",60462),githubProject:E("github-project",60463),mapVertical:E("map-vertical",60464),foldVertical:E("fold-vertical",60464),mapVerticalFilled:E("map-vertical-filled",60465),foldVerticalFilled:E("fold-vertical-filled",60465),goToSearch:E("go-to-search",60466),percentage:E("percentage",60467),sortPercentage:E("sort-percentage",60467),attach:E("attach",60468)};var Hje={dialogError:E("dialog-error","error"),dialogWarning:E("dialog-warning","warning"),dialogInfo:E("dialog-info","info"),dialogClose:E("dialog-close","close"),treeItemExpanded:E("tree-item-expanded","chevron-down"),treeFilterOnTypeOn:E("tree-filter-on-type-on","list-filter"),treeFilterOnTypeOff:E("tree-filter-on-type-off","list-selection"),treeFilterClear:E("tree-filter-clear","close"),treeItemLoading:E("tree-item-loading","loading"),menuSelection:E("menu-selection","check"),menuSubmenu:E("menu-submenu","chevron-right"),menuBarMore:E("menubar-more","more"),scrollbarButtonLeft:E("scrollbar-button-left","triangle-left"),scrollbarButtonRight:E("scrollbar-button-right","triangle-right"),scrollbarButtonUp:E("scrollbar-button-up","triangle-up"),scrollbarButtonDown:E("scrollbar-button-down","triangle-down"),toolBarMore:E("toolbar-more","more"),quickInputBack:E("quick-input-back","arrow-left"),dropDownButton:E("drop-down-button",60084),symbolCustomColor:E("symbol-customcolor",60252),exportIcon:E("export",60332),workspaceUnspecified:E("workspace-unspecified",60355),newLine:E("newline",60394),thumbsDownFilled:E("thumbsdown-filled",60435),thumbsUpFilled:E("thumbsup-filled",60436),gitFetch:E("git-fetch",60445),lightbulbSparkleAutofix:E("lightbulb-sparkle-autofix",60447),debugBreakpointPending:E("debug-breakpoint-pending",60377)},hn={...Vme,...Hje};var CI=class{constructor(e){this.accessor=e}async findEnclosingBlocks(e,r){let n=this.accessor.get(mt).getTreeSitterAST(e);if(n===void 0)return;let o=Ji(r,e);return(await n.getFineScopes(o))?.map(a=>{let c=Xs(e,a);return{kind:"code",name:e.lineAt(c.start).text.trim(),range:c}})}findEnclosingSymbols(e,r){for(let n of e)if(n.range.contains(r)){let o=this.findEnclosingSymbols(n.children,r);return o?[n,...o]:[n]}}async selectEnclosingScope(e,r){let n=await this.accessor.get(Ai).getDocumentSymbols(e.document.uri);if(!n||n.length>0&&!n[0].hasOwnProperty("children"))return;let o=e.selection;if(!o.isEmpty)return;let s=this.findEnclosingSymbols(n,e.selection.active);if(r?.includeBlocks&&s?.push(...await this.findEnclosingBlocks(e.document,e.selection)??[]),s||(s=n),s?.length===1){let a=s[0];e.selection=new Ik.Selection(a.range.start,a.range.end)}else if(s&&s.length>1||!s&&n.length>1){let a=s.sort((u,l)=>l.range.start.line-u.range.start.line).map(u=>({label:`$(${u.kind==="code"?"code":Gme.toIcon(u.kind).id}) ${u.name}`,description:`:${u.range.start.line+1}-${u.range.end.line+1}`,symbol:u}));if(!await this.accessor.get(N3).showQuickPick(a,{placeHolder:r?.reason??Ik.l10n.t("Select an enclosing range"),onDidSelectItem(u){let l=u.symbol;l&&(e.selection=new Ik.Selection(l.range.start,l.range.end),e.revealRange(l.range))}}))throw e.selection=o,new fo}return e.selection}};CI=O([x(0,je)],CI);var Gme;(r=>{let t=new Map;t.set(0,hn.symbolFile),t.set(1,hn.symbolModule),t.set(2,hn.symbolNamespace),t.set(3,hn.symbolPackage),t.set(4,hn.symbolClass),t.set(5,hn.symbolMethod),t.set(6,hn.symbolProperty),t.set(7,hn.symbolField),t.set(8,hn.symbolConstructor),t.set(9,hn.symbolEnum),t.set(10,hn.symbolInterface),t.set(11,hn.symbolFunction),t.set(12,hn.symbolVariable),t.set(13,hn.symbolConstant),t.set(14,hn.symbolString),t.set(15,hn.symbolNumber),t.set(16,hn.symbolBoolean),t.set(17,hn.symbolArray),t.set(18,hn.symbolObject),t.set(19,hn.symbolKey),t.set(20,hn.symbolNull),t.set(21,hn.symbolEnumMember),t.set(22,hn.symbolStruct),t.set(23,hn.symbolEvent),t.set(24,hn.symbolOperator),t.set(25,hn.symbolTypeParameter);function e(n){let o=t.get(n);return o||(console.info("No codicon found for SymbolKind "+n),o=hn.symbolProperty),o}r.toIcon=e})(Gme||={});var Py=class extends rx{constructor(r,n){super();this._ignoreService=r;this._logger=n.getLogger("SearchService")}async findFilesWithDefaultExcludes(r,n,o){let s=await this._ignoreService.asMinimatchPattern(),a=await this._findFilesWithDefaultExcludesAndExcludes(r,s,n,o);return!this._ignoreService.isRegexExclusionsEnabled||!a?a:Array.isArray(a)?await DU(this._ignoreService,a):await this._ignoreService.isCopilotIgnored(a)?void 0:a}async findFiles(r,n,o){let s=await this._ignoreService.asMinimatchPattern();n?.exclude?n={...n,exclude:s?mae(n.exclude,s):n.exclude}:n={...n,exclude:s};let a=await super.findFiles(r,n,o);return this._ignoreService.isRegexExclusionsEnabled?await DU(this._ignoreService,a):a}async findTextInFiles(r,n,o,s){let a={report:async c=>{await this._ignoreService.isCopilotIgnored(c.uri)||o.report(c)}};return super.findTextInFiles(r,n,a,s)}};O([Li(r=>r._logger)],Py.prototype,"findFiles",1),Py=O([x(0,De),x(1,ue)],Py);var cs=z(require("vscode"));var a5=class{constructor(){this._store=new Tt;this._tabGroupsUseInfo=new Map;this._tabClock=0;this.onDidChangeActiveTextEditor=cs.window.onDidChangeActiveTextEditor;this.onDidChangeTabs=cs.window.tabGroups.onDidChangeTabs;let e=()=>this._tabGroupsUseInfo.set(cs.window.tabGroups.activeTabGroup,this._tabClock++);e(),this._store.add(cs.window.tabGroups.onDidChangeTabGroups(r=>{r.closed.forEach(n=>this._tabGroupsUseInfo.delete(n)),e()}))}dispose(){this._store.dispose()}get activeTextEditor(){let e=cs.window.activeTextEditor;if(e&&e.document.uri.scheme!=="output")return e;let r=new Nn;cs.window.visibleTextEditors.forEach(o=>r.set(o.document.uri,o));let n=[...this._tabGroupsUseInfo];n.sort((o,s)=>s[1]-o[1]);for(let[o]of n)if(o.activeTab){let s=this._asTabInfo(o.activeTab);if(s.uri&&r.has(s.uri))return r.get(s.uri)}}get activeNotebookEditor(){return cs.window.activeNotebookEditor}get tabs(){return cs.window.tabGroups.all.flatMap(e=>e.tabs).map(this._asTabInfo,this)}_asTabInfo(e){let r;return e.input instanceof cs.TabInputText||e.input instanceof cs.TabInputNotebook?r=e.input.uri:(e.input instanceof cs.TabInputTextDiff||e.input instanceof cs.TabInputNotebookDiff)&&(r=e.input.modified),{tab:e,uri:r}}};var c5=class{dispose(){}sendInternalMSFTTelemetryEvent(e,r,n){}sendMSFTTelemetryEvent(e,r,n){}sendMSFTTelemetryErrorEvent(e,r,n){}sendGHTelemetryEvent(e,r,n){}sendGHTelemetryErrorEvent(e,r,n){}sendGHTelemetryException(e,r){}sendTelemetryEvent(e,r,n,o){}sendTelemetryErrorEvent(e,r,n,o){}setSharedProperty(e,r){}postEvent(e,r){}sendRestrictedGHTelemetryEvent(e,r,n){}sendRestrictedGHTelemetryErrorEvent(e,r,n){}};var LTe=z(NTe()),fM=z(require("os")),ov=class{constructor(e,r,n,o){this.namespace=n;this.client=rot(e,r,o),OTe(e,r,this.client)}separateData(e){if(e.properties!==void 0||e.measurements!==void 0)return e.properties=e.properties||{},e.measurements=e.measurements||{},e;let r={},n={};for(let[o,s]of Object.entries(e))typeof s=="number"?n[o]=s:r[o]=s;return{properties:r,measurements:n}}sendEventData(e,r){let{properties:n,measurements:o}=this.separateData(r||{});this.client.trackEvent({name:this.qualifyEventName(e),properties:n,measurements:o})}sendErrorData(e,r){let{properties:n,measurements:o}=this.separateData(r||{});this.client.trackException({exception:e,properties:n,measurements:o})}flush(){return new Promise(e=>{this.client.flush({callback:()=>{e(void 0)}})})}qualifyEventName(e){return e.includes(this.namespace)?e:`${this.namespace}/${e}`}};function rot(t,e,r){let n=new LTe.TelemetryClient(r);return n.config.enableAutoCollectRequests=!1,n.config.enableAutoCollectPerformance=!1,n.config.enableAutoCollectExceptions=!1,n.config.enableAutoCollectConsole=!1,n.config.enableAutoCollectDependencies=!1,n.config.noDiagnosticChannel=!0,OTe(t,e,n),n}function OTe(t,e,r){r.commonProperties=not(r.commonProperties,e),r.context.tags[r.context.keys.cloudRoleInstance]="REDACTED",r.config.endpointUrl=t.telemetryURL}function not(t,e){return t=t||{},t.common_os=fM.platform(),t.common_platformversion=fM.release(),t.common_vscodemachineid=e.machineId,t.common_vscodesessionid=e.sessionId,t.common_uikind="desktop",t.common_remotename="none",t.common_isnewappinstall="",t}var MTe="7d7048df-6dd0-4048-bb23-b716c1461f8f",FTe="3fdd7f28-937a-48c8-9a21-ba337db23bd1";var X2=z(ewe());function Cot(t){return t?X2.TargetPopulation.Insiders:X2.TargetPopulation.Public}async function twe(t,e,r){let n=t.extension.id,o=t.extension.packageJSON.version,s=Cot(r);return(0,X2.getExperimentationService)(n,o,s,e,t.globalState)}var vb=require("vscode");function rwe(t){return t.replace(/([\s|(]|file:\/\/)(\/[^\s]+)/g,"$1[redacted]").replace(/([\s|(]|file:\/\/)([a-zA-Z]:[(\\|/){1,2}][^\s]+)/gi,"$1[redacted]").replace(/([\s|(]|file:\/\/)(\\[^\s]+)/gi,"$1[redacted]")}var EM=class{constructor(e,r,n,o,s,a,c,u){this._configService=e;this._envService=r;this._telemetryConfig=n;this._restrictedTelemetryEnabled=!1;this._disposables=[];this._nonRestrictedTelemetryLogger=vb.env.createTelemetryLogger(new ov(o,this._envService,s,a),{ignoreBuiltInCommonProperties:!0,ignoreUnhandledErrors:!0}),this._disposables.push(u.onDidStoreUpdate(()=>{u.copilotToken?.getTokenValue("rt")==="1"?(this._restrictedTelemetryEnabled=!0,this._restrictedTelemetryLogger=vb.env.createTelemetryLogger(new ov(o,this._envService,s,c),{ignoreBuiltInCommonProperties:!0,ignoreUnhandledErrors:!0})):(this._restrictedTelemetryEnabled=!1,this._restrictedTelemetryLogger&&this._restrictedTelemetryLogger.dispose(),this._restrictedTelemetryLogger=void 0)})),this._disposables.push(o.onDidChangeDomains(()=>{this._nonRestrictedTelemetryLogger.dispose(),this._nonRestrictedTelemetryLogger=vb.env.createTelemetryLogger(new ov(o,this._envService,s,a),{ignoreBuiltInCommonProperties:!0,ignoreUnhandledErrors:!0}),this._restrictedTelemetryLogger&&(this._restrictedTelemetryLogger.dispose(),this._restrictedTelemetryLogger=vb.env.createTelemetryLogger(new ov(o,this._envService,s,c),{ignoreBuiltInCommonProperties:!0,ignoreUnhandledErrors:!0}))}))}sendTelemetryEvent(e,r,n){this._nonRestrictedTelemetryLogger.logUsage(e,this.markAsIssuedAndMakeReadyForSending(r,n))}sendTelemetryErrorEvent(e,r,n){this._nonRestrictedTelemetryLogger.logError(e,this.markAsIssuedAndMakeReadyForSending(r,n))}sendRestrictedTelemetryEvent(e,r,n){this._restrictedTelemetryEnabled&&this._restrictedTelemetryLogger&&this._restrictedTelemetryLogger?.logUsage(e,this.markAsIssuedAndMakeReadyForSending(r,n))}sendRestrictedTelemetryErrorEvent(e,r,n){this._restrictedTelemetryEnabled&&this._restrictedTelemetryLogger&&this._restrictedTelemetryLogger?.logError(e,this.markAsIssuedAndMakeReadyForSending(r,n))}sendExceptionTelemetry(e,r){let n=e instanceof Error?e:new Error("Non-error thrown: "+e),o=Wn.createAndMarkAsIssued({origin:rwe(r),reason:this._restrictedTelemetryEnabled?"Exception logged to restricted telemetry":"Exception, not logged due to opt-out"});if(o.makeReadyForSending(this._configService,this._envService,this._telemetryConfig),this.sendTelemetryEvent("exception",o.properties,o.measurements),!this._restrictedTelemetryEnabled||!this._restrictedTelemetryLogger)return;let s=Wn.createAndMarkAsIssued({origin:r});s.makeReadyForSending(this._configService,this._envService,this._telemetryConfig),this._restrictedTelemetryLogger.logError(n,s)}markAsIssuedAndMakeReadyForSending(e,r){let n=Wn.createAndMarkAsIssued(Fae(e),r);n.makeReadyForSending(this._configService,this._envService,this._telemetryConfig);let o={};for(let s in n.properties)o[s]=new vb.TelemetryTrustedValue(n.properties[s]);return{properties:o,measurements:n.measurements}}dispose(){this._nonRestrictedTelemetryLogger.dispose(),this._disposables.forEach(e=>e.dispose()),this._restrictedTelemetryLogger&&this._restrictedTelemetryLogger.dispose()}};var Bte=z(jAe()),L7=class{constructor(e,r,n){this._vscodeTeamMember=!1;this._isInternal=!1;n.onDidStoreUpdate(()=>{let o=n.copilotToken;if(this._username=o?.username,this._vscodeTeamMember=!!o?.isVscodeTeamMember,this._tid=o?.getTokenValue("tid"),this._sku=o?.getTokenValue("sku"),this._isInternal=!!o?.isInternal,!o||!o.organizationList.length||!o.isChatEnabled()){this._internalTelemetryReporter=void 0;return}o.isInternal&&(this._internalTelemetryReporter=new Bte.default(e))}),this._externalTelemetryReporter=new Bte.default(r)}dispose(){this._externalTelemetryReporter.dispose(),this._internalTelemetryReporter?.dispose()}postEvent(e,r){let n={};for(let[o,s]of r)n[o]=s;this._isInternal&&this.sendInternalTelemetryEvent(e,n),this.sendTelemetryEvent(e,n)}sendInternalTelemetryEvent(e,r,n){this._internalTelemetryReporter&&(r={...r,"common.tid":this._tid,"common.userName":this._username??"undefined"},n={...n,"common.isVscodeTeamMember":this._vscodeTeamMember?1:0},this._internalTelemetryReporter.sendRawTelemetryEvent(e,r,n))}sendTelemetryEvent(e,r,n){r={...r,"common.tid":this._tid??"","common.sku":this._sku??"undefined"},this._isInternal&&(n={...n,"common.internal":1}),this._externalTelemetryReporter.sendTelemetryEvent(e,r,n)}sendTelemetryErrorEvent(e,r,n){r={...r,"common.tid":this._tid??"","common.sku":this._sku??"undefined"},this._isInternal&&(n={...n,"common.internal":1}),this._externalTelemetryReporter.sendTelemetryErrorEvent(e,r,n)}};var fT=class{constructor(e,r,n,o,s,a,c,u,l,d){this._sharedProperties={};this._disposables=[];this._microsoftTelemetryService=new L7(r,n,c),this._ghTelemetryService=new EM(a,u,l,d,e,o,s,c),this._disposables.push(this._microsoftTelemetryService,this._ghTelemetryService),this._disposables.push(c.onDidStoreUpdate(()=>{let p=c.copilotToken;p&&this.sendMSFTTelemetryEvent("token",void 0,{chatEnabled:p.isChatEnabled()?1:0,snippyEnabled:p.isPublicSuggestionsEnabled()?1:0,telemetryEnabled:p.isTelemetryEnabled()?1:0})}))}dispose(){this._disposables.forEach(e=>e.dispose())}sendMSFTTelemetryEvent(e,r,n){this.sendTelemetryEvent(e,{github:!1,microsoft:!0},r,n)}sendMSFTTelemetryErrorEvent(e,r,n){this.sendTelemetryErrorEvent(e,{github:!1,microsoft:!0},r,n)}sendGHTelemetryEvent(e,r,n){this.sendTelemetryEvent(e,{github:!0,microsoft:!1},r,n)}sendGHTelemetryErrorEvent(e,r,n){this.sendTelemetryErrorEvent(e,{github:!0,microsoft:!1},r,n)}sendGHTelemetryException(e,r){this._ghTelemetryService.sendExceptionTelemetry(e,r)}sendRestrictedGHTelemetryEvent(e,r,n){r={...r,...this._sharedProperties},this._ghTelemetryService.sendRestrictedTelemetryEvent(e,r,n)}sendRestrictedGHTelemetryErrorEvent(e,r,n){r={...r,...this._sharedProperties},this._ghTelemetryService.sendRestrictedTelemetryErrorEvent(e,r,n)}sendInternalMSFTTelemetryEvent(e,r,n){r={...r,...this._sharedProperties},this._microsoftTelemetryService.sendInternalTelemetryEvent(e,r,n)}sendTelemetryEvent(e,r,n,o){n={...n,...this._sharedProperties},r.github&&this._ghTelemetryService.sendTelemetryEvent(e,n,o),r.microsoft&&this._microsoftTelemetryService.sendTelemetryEvent(e,n,o)}sendTelemetryErrorEvent(e,r,n,o){n={...n,...this._sharedProperties},r.github&&this._ghTelemetryService.sendTelemetryErrorEvent(e,n,o),r.microsoft&&this._microsoftTelemetryService.sendTelemetryErrorEvent(e,n,o)}setSharedProperty(e,r){this._sharedProperties[e]=r}postEvent(e,r){for(let[n,o]of Object.entries(this._sharedProperties))r.set(n,o);this._microsoftTelemetryService.postEvent(e,r)}};fT=O([x(5,ye),x(6,id),x(7,Rt),x(8,bD),x(9,yn)],fT);var GAe=require("path"),zAe=require("process"),h0=require("vscode"),O7=new Map,Hte=new Map;function $Ae(){let t=h0.window.activeTerminal;return t===void 0?"":O7.get(t)?.join(`
`)||""}function WAe(){let t=h0.window.activeTerminal;if(t!==void 0)return Hte.get(t)?.at(-1)}function KAe(){try{return h0.window.activeTerminal?.selection??""}catch{return""}}var qte;function YAe(){let t=h0.window.activeTerminal;if(t&&"shellPath"in t.creationOptions){let e=t.creationOptions.shellPath;if(e){let r,n=(0,GAe.basename)(e);if(n==="bash.exe")r="Git Bash";else{let o=n.replace(/\..+/,"");switch(o){case"pwsh":case"powershell":r="powershell";break;case"":break;default:r=o}}if(r)return qte=r,r}}return qte||(zAe.platform==="win32"?"powershell":"bash")}function VAe(t,e){t.push(e),t.length>40&&t.shift()}function Tct(t){let e=/(:?\x1b\[|\x9B)[=?>!]?[\d;:]*["$#'* ]?[a-zA-Z@^`{}|~]/g;return t&&(t=t.replace(e,"")),t}function QAe(){return[h0.window.onDidWriteTerminalData(t=>{let e=O7.get(t.terminal);e||(e=[],O7.set(t.terminal,e)),VAe(e,Tct(t.data))}),h0.window.onDidExecuteTerminalCommand(t=>{let e=Hte.get(t.terminal);e||(e=[],Hte.set(t.terminal,e)),VAe(e,t)}),h0.window.onDidCloseTerminal(t=>{O7.delete(t)})]}var M7=class extends Ct{constructor(){super();for(let e of QAe())this._register(e)}get terminalBuffer(){return $Ae()}get terminalLastCommand(){return WAe()}get terminalSelection(){return KAe()}get terminalShellType(){return YAe()}};var Xo=z(require("vscode"));var S_=class{constructor(e,r,n){this.owner=e;this.debugNameSource=r;this.referenceFn=n}getDebugName(e){return wct(e,this)}},XAe=new Map,jte=new WeakMap;function wct(t,e){let r=jte.get(t);if(r)return r;let n=Rct(t,e);if(n){let o=XAe.get(n)??0;o++,XAe.set(n,o);let s=o===1?n:`${n}#${o}`;return jte.set(t,s),s}}function Rct(t,e){let r=jte.get(t);if(r)return r;let n=e.owner?Pct(e.owner)+".":"",o,s=e.debugNameSource;if(s!==void 0)if(typeof s=="function"){if(o=s(),o!==void 0)return n+o}else return n+s;let a=e.referenceFn;if(a!==void 0&&(o=F7(a),o!==void 0))return n+o;if(e.owner!==void 0){let c=kct(e.owner,t);if(c!==void 0)return n+c}}function kct(t,e){for(let r in t)if(t[r]===e)return r}var JAe=new Map,ZAe=new WeakMap;function Pct(t){let e=ZAe.get(t);if(e)return e;let r=Act(t),n=JAe.get(r)??0;n++,JAe.set(r,n);let o=n===1?r:`${r}#${n}`;return ZAe.set(t,o),o}function Act(t){let e=t.constructor;return e?e.name:"Object"}function F7(t){let e=t.toString(),n=/\/\*\*\s*@description\s*([^*]*)\*\//.exec(e);return(n?n[1]:void 0)?.trim()}var Dct;function g0(){return Dct}function B7(t){return new U7(new S_(void 0,void 0,t),t,void 0,void 0)}var U7=class{constructor(e,r,n,o){this._debugNameData=e;this._runFn=r;this.createChangeSummary=n;this._handleChange=o;this.state=2;this.updateCount=0;this.disposed=!1;this.dependencies=new Set;this.dependenciesToBeRemoved=new Set;this.changeSummary=this.createChangeSummary?.(),g0()?.handleAutorunCreated(this),this._runIfNeeded(),C0(this)}get debugName(){return this._debugNameData.getDebugName(this)??"(anonymous)"}dispose(){this.disposed=!0;for(let e of this.dependencies)e.removeObserver(this);this.dependencies.clear(),E0(this)}_runIfNeeded(){if(this.state===3)return;let e=this.dependenciesToBeRemoved;this.dependenciesToBeRemoved=this.dependencies,this.dependencies=e,this.state=3;let r=this.disposed;try{if(!r){g0()?.handleAutorunTriggered(this);let n=this.changeSummary;this.changeSummary=this.createChangeSummary?.(),this._runFn(this,n)}}finally{r||g0()?.handleAutorunFinished(this);for(let n of this.dependenciesToBeRemoved)n.removeObserver(this);this.dependenciesToBeRemoved.clear()}}toString(){return`Autorun<${this.debugName}>`}beginUpdate(){this.state===3&&(this.state=1),this.updateCount++}endUpdate(){if(this.updateCount===1)do{if(this.state===1){this.state=3;for(let e of this.dependencies)if(e.reportChanges(),this.state===2)break}this._runIfNeeded()}while(this.state!==3);this.updateCount--,yz(()=>this.updateCount>=0)}handlePossibleChange(e){this.state===3&&this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(this.state=1)}handleChange(e,r){this.dependencies.has(e)&&!this.dependenciesToBeRemoved.has(e)&&(!this._handleChange||this._handleChange({changedObservable:e,change:r,didChange:o=>o===e},this.changeSummary))&&(this.state=2)}readObservable(e){if(this.disposed)return e.get();e.addObserver(this);let r=e.get();return this.dependencies.add(e),this.dependenciesToBeRemoved.delete(e),r}};(e=>e.Observer=U7)(B7||={});var eDe=(t,e)=>t===e;var Nct;var Lct;var Oct;var Vte=class{get TChange(){return null}reportChanges(){this.get()}read(e){return e?e.readObservable(this):this.get()}map(e,r){let n=r===void 0?void 0:e,o=r===void 0?e:r;return Oct({owner:n,debugName:()=>{let s=F7(o);if(s!==void 0)return s;let c=/^\s*\(?\s*([a-zA-Z_$][a-zA-Z_$0-9]*)\s*\)?\s*=>\s*\1(?:\??)\.([a-zA-Z_$][a-zA-Z_$0-9]*)\s*$/.exec(o.toString());if(c)return`${this.debugName}.${c[2]}`;if(!n)return`${this.debugName} (mapped)`},debugReferenceFn:o},s=>o(this.read(s),s))}recomputeInitiallyAndOnChange(e,r){return e.add(Nct(this,r)),this}keepObserved(e){return e.add(Lct(this)),this}get debugValue(){return this.get()}},Gte=class extends Vte{constructor(){super(...arguments);this.observers=new Set}addObserver(r){let n=this.observers.size;this.observers.add(r),n===0&&this.onFirstObserverAdded()}removeObserver(r){this.observers.delete(r)&&this.observers.size===0&&this.onLastObserverRemoved()}onFirstObserverAdded(){}onLastObserverRemoved(){}};var zte=class{constructor(e,r){this._fn=e;this._getDebugName=r;this.updatingObservers=[];g0()?.handleBeginTransaction(this)}getDebugName(){return this._getDebugName?this._getDebugName():F7(this._fn)}updateObserver(e,r){this.updatingObservers.push({observer:e,observable:r}),e.beginUpdate(r)}finish(){let e=this.updatingObservers;for(let r=0;r<e.length;r++){let{observer:n,observable:o}=e[r];n.endUpdate(o)}this.updatingObservers=null,g0()?.handleEndTransaction()}};function tDe(t,e){let r;return typeof t=="string"?r=new S_(void 0,t,void 0):r=new S_(t,void 0,void 0),new $te(r,e,eDe)}var $te=class extends Gte{constructor(r,n,o){super();this._debugNameData=r;this._equalityComparator=o;this._value=n}get debugName(){return this._debugNameData.getDebugName(this)??"ObservableValue"}get(){return this._value}set(r,n,o){if(o===void 0&&this._equalityComparator(this._value,r))return;let s;n||(n=s=new zte(()=>{},()=>`Setting ${this.debugName}`));try{let a=this._value;this._setValue(r),g0()?.handleObservableChanged(this,{oldValue:a,newValue:r,change:o,didChange:!0,hadValue:!0});for(let c of this.observers)n.updateObserver(c,this),c.handleChange(this,o)}finally{s&&s.finish()}}toString(){return`${this.debugName}: ${this._value}`}_setValue(r){this._value=r}};var q7=class extends Ct{constructor(){super();this.resultsDocs=new Nn;this.isEnabled=tDe("TestProvider.isEnabled",!1);this._register(B7(r=>{Xo.commands.executeCommand("setContext","github.copilot.chat.fixTestFailures.enabled",this.isEnabled.read(r))})),this._register(Xo.tests.onDidChangeTestResults(()=>this.setHasFailureContextKey())),this.setHasFailureContextKey()}setHasFailureContextKey(){Xo.commands.executeCommand("setContext","github.copilot.chat.fixTestFailures.hasFailure",!!xs.first(this.getAllFailures()))}get lastResultsFrom(){return Xo.tests.testResults[0]?.completedAt}async setEnablement(r){let n=await r.getTreatmentVariableAsync("vscode","copilotchat.fixTestFailures"),o=Xo.env.appName.includes("Insiders")||Xo.env.appName.includes("OSS"),s=n||o;this.isEnabled.set(s,void 0)}getAllFailures(){let r=Xo.tests.testResults[0];return r?this.dfsFailures(r.results):xs.empty()}getFailureAtPosition(r,n){let o=Xo.tests.testResults[0];if(this.resultsDocsAreForTestRun!==o&&this.makeResultsDocs(o),!o)return;let s=this.resultsDocs.get(r)||[],a=are(s,c=>!c.range?.start.isAfter(n));if(a){for(let c of a.taskStates)if(c.state===Xo.TestResultState.Failed||c.state===Xo.TestResultState.Errored)return{snapshot:a,task:c}}}*dfsFailures(r){for(let n of r){yield*this.dfsFailures(n.children);for(let o of n.taskStates)(o.state===Xo.TestResultState.Failed||o.state===Xo.TestResultState.Errored)&&(yield{snapshot:n,task:o})}}makeResultsDocs(r){if(this.resultsDocs.clear(),this.resultsDocsAreForTestRun=r,!r)return;let n=[r.results];for(;n.length;)for(let s of n.pop()){if(n.push(s.children),!s.uri)continue;let a=this.resultsDocs.get(s.uri);a?a.push(s):this.resultsDocs.set(s.uri,[s])}let o=new Xo.Range(0,0,0,0);for(let s of this.resultsDocs.values())s.sort((a,c)=>(a.range||o).start.compareTo((c.range||o).start)||Mct(a.taskStates,c.taskStates))}},Mct=(t,e)=>{let r=0,n=0;for(let o of t)r=Math.max(r,o.state);for(let o of e)n=Math.max(n,o.state);return r-n};var RA=z(require("vscode")),H7=class{getAllExtensions(){return RA.extensions.all}async getAllCommands(){return RA.commands.executeCommand("_getAllCommands")}async getAllSettings(){return RA.commands.executeCommand("_getAllSettings")}};var v0=require("vscode");function rDe(t){return t.scheme==="vscode-vfs"&&t.authority.startsWith("github")}var mT=class extends zD{constructor(r){super();this._accessor=r;this.onDidOpenTextDocument=v0.workspace.onDidOpenTextDocument;this.onDidChangeTextDocument=v0.workspace.onDidChangeTextDocument;this.onDidCloseTextDocument=v0.workspace.onDidCloseTextDocument;this._logger=this._accessor.get(ue).getLogger("ExtensionTextDocumentManager")}get textDocuments(){return v0.workspace.textDocuments}async openTextDocument(r){return await v0.workspace.openTextDocument(r)}get notebookDocuments(){return v0.workspace.notebookDocuments}getWorkspaceFolders(){return v0.workspace.workspaceFolders?.map(r=>r.uri)??[]}ensureWorkspaceIsFullyLoaded(){return this._fullyLoadedPromise??=(async()=>{let r=this._accessor.get(n5);for(let n of this.getWorkspaceFolders())if(rDe(n)){this._logger.debug(`Preloading virtual workspace contents for ${n}`);try{let o=await r.loadWorkspaceContents(n);this._logger.info(`loading virtual workspace contents resulted in ${o} for: ${n}`)}catch(o){this._logger.error(`Error loading virtual workspace contents for ${n}: ${o}`)}}})(),this._fullyLoadedPromise}};mT=O([x(0,je)],mT);var Vt=z(require("vscode"));var il=z(Qt());function nDe(t){let e=(o,s,a)=>{let c="",u=a?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ";if(s===1?c=`${u}${o.name}
`:s>1&&(c=`|   ${"    ".repeat(s-2)}${u}${o.name}
`),o.children){let l=o.children.length-1;o.children.forEach((d,p)=>{c+=e(d,s+1,p===l)})}return c},r=`${t.baseUri.path.replace("/","")}
`,n=t.value.length-1;return t.value.forEach((o,s)=>{r+=e(o,1,s===n)}),`\`\`\`filetree
${r}\`\`\`
`}var iDe=z(at());var j7=class extends Q{render(e,r){let{query:n}=this.props.promptContext;return vscpp(vscppf,null,vscpp(iDe.SystemMessage,{priority:1e3},"You are an AI pair programmer helping a developer to clarify their prompt for another AI code assistant, integrated into Visual Studio Code. You are not answering the developer's prompts, but collaborate with them to better understand their intent, context and goal. Stay focussed, succinct and to the point.",vscpp("br",null),vscpp("br",null),vscpp(Hr,null),vscpp(Zt,null),vscpp("br",null),vscpp(ou,{location:2,endpoint:this.props.endpoint}),vscpp("br",null),"## First, think step-by-step:",vscpp("br",null),"1. Analyze the prompt and the optionally provided active code selection for what the developer might be asking. Keep your capabilities in mind.",vscpp("br",null),"2. As first part of your response, rephrase the prompt back to the developer with any explicit and implicit assumptions, included and missing context, and your capabilities. Paragraph with with maximum 50 words.",vscpp("br",null),"3. Finally, last paragraph with maximum 50 words: Request specifics about the missing context of their prompt. Include constructive feedback for how to add context (add specifics, using the knowledge base excerpt below).",vscpp("br",null),vscpp("br",null),"## Knowledge base: How to add context",vscpp("br",null),"- Selecting code will explicitly include it as context.",vscpp("br",null),"- Use the attachement button in the chat input to add specific files.",vscpp("br",null),"- Start the prompt with `@workspace` to refer to the entire codebase.",vscpp("br",null),"- Use commands for specific tasks, like `/fix` for debugging and fixing code issues, `/explain` to explain code, and `/tests` for writing tests.",vscpp("br",null),"- Mention context variables to the prompt: `#terminalLastCommand` for terminal output.",vscpp("br",null),vscpp("br",null),"## Rules",vscpp("br",null),"- Minimize any other prose.",vscpp("br",null),vscpp("br",null),"Take a deep breath. Do each step one by one.",vscpp(cr,null)),vscpp(Nr,{flexGrow:1,document:this.props.documentContext?.document,range:this.props.documentContext?.selection,priority:800}),vscpp(Kr,{flexGrow:2,priority:900,chatVariables:new _c([]),query:n}))}};var hT=class extends Oo{constructor(r,n,o,s,a){super(r,n,o);this.documentContext=s;this.instantiationService=a}async followUps(r){let n=[],o="is my context";if(r.chatMessages){let s=r.chatMessages.filter(a=>a.role==="user");s.length>0&&(o=s[s.length-1].content)}return n.push({prompt:`@workspace ${o}`,label:"Find related @workspace code"}),n.push({prompt:`#selected ${o}`,label:"Use my #selected code"}),Promise.resolve(n)}createRenderer(r,n,o,s){return $e.create(this.instantiationService,n,j7,{documentContext:this.documentContext,promptContext:r,endpoint:n})}};hT=O([x(4,te)],hT);var y0=class{constructor(e,r){this.instantiationService=e;this.endpointProvider=r;this.id=y0.ID;this.locations=[2];this.description="Clarify unclear prompt for the user.";this.commandInfo={hiddenFromUser:!0};this.intentDetectionInput={sampleQuestion:"How can I ask this question better?"}}static{this.ID="clarify"}async invoke(e){let{location:r,documentContext:n}=e,o=await this.endpointProvider.getChatEndpoint("gpt-4");return this.instantiationService.createInstance(hT,this,r,o,n)}};y0=O([x(0,te),x(1,Le)],y0);var kA=z(at());var gT=class{constructor(e,r,n,o,s,a){this.telemetryService=r;this.options=n;this.endpointProvider=o;this.instantiationService=s;this.chatMLFetcher=a;this.logger=e.getPromptResponseLogger("prompt review")}async evaluate(e,r,n,o){let s=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),a=$e.create(this.instantiationService,s,Wte,{userQuestion:r,documentContext:e}),{messages:c}=await a.render(void 0,o);this.logger.logPrompt(c);let u=await this.chatMLFetcher.fetchMany(c,void 0,o,2,s,{agent:n},{temperature:this.options.temperature,top_p:this.options.topP,stop:["\n```"],n:2},{messageSource:"chat.promptEval.meta"}),l=this.handleResult(u,r);return this.telemetryService.sendMSFTTelemetryEvent("promptEval",{},{requestContext:l?.requestContext,requirementsClarification:l?.requirementsClarification,taskDecomposition:l?.taskDecomposition}),this.telemetryService.sendInternalMSFTTelemetryEvent("promptEval",{request:r,response:u.type==="success"?u.value.join(`
`):void 0},{requestContext:l?.requestContext,requirementsClarification:l?.requirementsClarification,taskDecomposition:l?.taskDecomposition}),l}handleResult(e,r){if(this.logger.logResponse(e),e.type!=="success")return;let n=e.value.map(s=>{let a={requestContext:/requestContext:\s*(\d+)\s*/,requirementsClarification:/requirementsClarification:\s*(\d+)\s*/,taskDecomposition:/taskDecomposition:\s*(\d+)\s*/},c={requestContext:void 0,requirementsClarification:void 0,taskDecomposition:void 0};for(let u in c){let l=a[u].exec(s);l&&l.length===2&&(c[u]=parseInt(l[1],10)||void 0)}return c}).filter(s=>s!==void 0),o={requestContext:void 0,requirementsClarification:void 0,taskDecomposition:void 0};for(let s in o){let a=n.map(c=>c[s]||void 0).filter(c=>c!==void 0);this.logger.info(`Evaluated ${s} as ${a}`),o[s]=a.reduce((c,u)=>c+u,0)/a.length}return o}};gT=O([x(0,ue),x(1,me),x(2,Sn),x(3,Le),x(4,te),x(5,Bt)],gT);var Wte=class extends Q{render(){let{userQuestion:e,documentContext:r}=this.props;return vscpp(vscppf,null,vscpp(kA.SystemMessage,{priority:1e3},"You are a helpful developer support expert in reviewing the prompts that a developer is sending to an AI coding assistant. Your ratings will be used to follow up with the developer on clarifying their prompt. For context, the developer queries this AI coding assistant inside Visual Studio Code for general questions, coding, debugging, and other software development tasks. The AI coding assistant will not get any more details when it needs to generate a response to the prompt. The AI coding assistant has the same software development knowledge that you have access to, which might be affected by knowledge cutoffs and niche domains.",vscpp("br",null),vscpp("br",null),"Rate how important different follow-ups are to clarify the given prompt, enabling the AI pair programmer to give more precise and useful responses. Rate each 1 (LEAST important) to 5 (MOST important):",vscpp("br",null),vscpp("br",null),"- **Request Context**: If the prompt references code, symbols, data, files, terminal output, or other parts of the development environment that are not in the prompt, follow-up would ask to attach those references to the prompt. Less critical for general coding questions, but most critical when the prompt references context that is missing.",vscpp("br",null),"- **Requirements Clarification**: If the prompt is too vague or general, follow-up questions help narrow down the specific information, preferences, and constraints. Less critical for general coding questions, more critical when the prompt involves specific coding requirements.",vscpp("br",null),"- **Task Decomposition**: If the prompt involves a complex task, follow-up breaks it down into smaller, more manageable steps so the developer can provide feedback and work through them one by one. Doesn't apply to general questions but is most important for multi-step coding tasks.",vscpp("br",null),vscpp("br",null),"Summarize your rating with a markdown codeblock:",vscpp("br",null),vscpp(Oe,{uri:null,languageId:"markdown",code:`- requestContext: int
- requirementsClarification: int
- taskDecomposition: int`}),vscpp("br",null),vscpp("br",null),"You will be provided with the prompt and context, then asked to rate the follow-up."),vscpp(kA.UserMessage,{priority:900},"# Developer Prompt",vscpp("br",null),e),r&&vscpp(Nr,{document:r?.document,range:r?.selection}),vscpp(kA.UserMessage,{priority:1e3},"Rating:",vscpp("br",null),"```md",vscpp("br",null)))}};var vT={errorDetails:{message:il.t("Cancelled")}},yT=class{constructor(e,r,n,o,s,a,c,u,l,d,p,f,m,h,g,v,y,b){this.conversationLogger=e;this._instantiationService=n;this.options=o;this._telemetryService=s;this._configurationService=a;this._experimentationService=c;this._commandService=u;this._notebookLoggingService=l;this._intentService=d;this._conversationStore=p;this._tabsAndEditorsService=f;this._logService=h;this._ignoreService=g;this._chatMLFetcher=v;this._tokenizerProvider=y;this._customInstructionsService=b;this.conversation=new L0,this.intentDetector=m.createInstance(wd,2),this.promptEval=this._instantiationService.createInstance(gT),this.conversation=new L0,this.initHistory(r)}initHistory(e){let r;for(let n of e)if(n instanceof zne)r=new Zp({message:n.prompt,type:"user"});else{let o=n.response.map(a=>a instanceof Qi?a.value.value:a instanceof sh?nDe(a):"content"in a?a.content:null).filter(a=>!!a).join("");if(r){let a=n.command||iie(n.participant),c=this._commandService.getCommand(a,2);r.response={message:o,type:"model",name:c?.commandId||ta.ID},n.result.errorDetails?n.result.errorDetails?.responseIsFiltered?r.status="filtered":n.result.errorDetails.message==="Cancelled"?r.status="cancelled":r.status="error":r.status="success",this.conversation.addTurn(r),r=void 0}let s=n.result;typeof s.metadata?.sessionId=="string"&&(this._sessionId=s.metadata.sessionId)}this._sessionId||(this._sessionId=Br())}async handleRequest(e,r,n,o){try{let s=this,a=!0,c=m=>{s.conversationLogger?.logProgress(m,a),a=!1},u=gc.spy(r,m=>{c(m)}),l=this.newTurn(e),d=Wx();d.markAsDisplayed(),l.userMessageId=d.properties.messageId;let p=await this._provideResponseWithProgress(l,e,u,n,d,o),f=await l.intentInvocation?.commands?.(l);return f&&f.forEach(m=>r.button(m)),this.conversationLogger?.logResponse(p),this._telemetryService.sendInternalMSFTTelemetryEvent("interactiveSessionResponse",{chatLocation:"panel",intent:l.intentInvocation?.intent.id??"",request:e.prompt,response:l.response?.message??"",sessionId:this._sessionId},{turnNumber:this.conversation.turns.length}),this._conversationStore.addConversation(l.requestId,this.conversation),{...p,metadata:{modelMessageId:l.modelMessageId??"",responseId:l.requestId,sessionId:this._sessionId,agentId:o.agentId,command:e.command}}}catch(s){throw this.conversationLogger?.logThrownError(s),s}}newTurn(e){let r={message:e.prompt,type:"user"},n=new Zp(r,this._sessionId);return this.conversation.addTurn(n),n}async _provideResponseWithProgress(e,r,n,o,s,a){let c=()=>{if(o.isCancellationRequested)return e.status="cancelled",!0};if(c())return vT;try{let u=this._tabsAndEditorsService.activeTextEditor,l=e.request.message;this.conversationLogger?.logRequest(e.request);let d={command:a.intentId?this._commandService.getCommand(a.intentId,2):void 0,restOfQuery:l};if(d.command?.intent&&!(d.command.intent.commandInfo?.allowsEmptyArgs??!0)&&!d.restOfQuery){let Y=RB(d.command.intent.id),N="";return Y&&(N=`@${Y.agent} `,Y.command&&(N+=` /${Y.command}`),N+=` ${d.command.details}`),e.response={message:il.t(`Please specify a question when using this command.

Usage: {0}`,N),type:"meta"},e.status="error",{errorDetails:{message:e.response.message,responseIsFiltered:!1}}}let p=d?.command?.intent,f;p&&(e.request={message:d.restOfQuery||p.intentDetectionInput.sampleQuestion,type:"user"},this.conversationLogger?.logIntent(p.id,!0));let m=u?cR.fromEditor(u):void 0;if(!p&&!r.command&&!r.references.length&&this.conversation.turns.length===1&&await this._configurationService.getExperimentBasedConfig(fe.ConversationPromptEval,this._experimentationService)){let N=this.promptEval.evaluate(m,l,a.agentName,o),w={requestContext:await this._configurationService.getExperimentBasedConfig(fe.ConversationPromptEvalRequestContext,this._experimentationService)};if(w.requestContext!==void 0){let P=await N;if(c())return vT;P?.requestContext&&P.requestContext>=w.requestContext&&(p=this._intentService.getIntent(y0.ID,2))}}let h=r.references??r.variables,g=new _c(h),v=this.conversation.turns.slice(0,-1);if(!p&&r.enableCommandDetection&&this._configurationService.getConfig(fe.ConversationIntentDetection)){if(p=f=await this.intentDetector.detectIntent(void 0,l,a.agentName,o,s,void 0,void 0,g,v),this.conversationLogger?.logIntent(p?.id,!1),c())return vT;if(f){let Y=RB(f.id);Y&&n.push(new HD(`github.copilot.${Y.agent}`,Y.command?{name:Y.command,description:f.description}:void 0))}}else p&&this.intentDetector.collectIntentDetectionContextInternal(l,p.id,g,v,u?.document);p??=this._intentService.unknownIntent;let y=await p.invoke({location:2,documentContext:m,request:r});if(c())return vT;e.intentInvocation=y,r=await this.sanitizeVariables(r,e);let b=y.endpoint;if(this._notebookLoggingService.logRequest(r,b),(r.acceptedConfirmationData?.length||r.rejectedConfirmationData?.length)&&y.confirmationHandler)return await y.confirmationHandler(r.acceptedConfirmationData,r.rejectedConfirmationData,n),{};let _,S,I=!1,T,A;try{let Y={query:e.request.message,history:v,chatVariables:g,customInstructions:await this._customInstructionsService.fetchInstructions()},N={report(q){n.push(q)}};({messages:_,tokenCount:S,hasIgnoredFiles:I,references:T,omittedReferences:A}=await y.buildPrompt(Y,N,o));let[w,P]=[T,A].map(q=>q.reduce((U,Z)=>("variableName"in Z.anchor&&U.add(Z.anchor.variableName),U),new Set));for(let q of T){let U=q.options??("variableName"in q.anchor&&P.has(q.anchor.variableName)?{status:{kind:2,description:il.t("Part of this attachment was not sent to the model due to context window limitations.")}}:void 0);n.reference2(q.anchor,void 0,U)}for(let q of A)"variableName"in q.anchor&&!w.has(q.anchor.variableName)&&n.reference2(q.anchor,void 0,{status:{kind:3,description:il.t("This attachment was not sent to the model due to context window limitations.")}});e.addReferences(T)}catch(Y){if(zp(Y))return vT;throw Y}if(c())return vT;if(_.length===0)return{};let B=this.conversation.getLatestTurn()?.contextParts.map(Y=>Y.kind)??[];if(this._telemetryService.sendInternalMSFTTelemetryEvent("interactiveSessionMessage",{intent:p?.id??"none",detectedIntent:f?.id??"none",contextTypes:B.join(","),query:d.restOfQuery},{}),e.chatMessages=_,this.fixMessageNames(p,_),this.conversationLogger?.logMessages(_),s=AL(this.conversation,this._sessionId,"conversationPanel",l,S,p?.id,s),o.isCancellationRequested)return e.status="cancelled",{errorDetails:{message:il.t("Cancelled")}};let j=this._instantiationService,F=new class{processResponse(Y,N,w,P,q){return typeof y.processResponsePanel=="function"?y.processResponsePanel(Y,N,w,P,q):j.createInstance(ng,[{stop:"[COMMANDS START]"}],void 0).processResponse(Y,N,w,P,q)}},ne=await this.fetchConversationResponse(e,b,l,_,a.agentName,o,n,F,y.linkification,s,{messageId:s.properties.messageId,messageSource:p?.id&&p.id!==ta.ID?`chat.${p.id}`:"chat.user"});return I&&n.markdown(il.t(pD)),ne}catch(u){this._logService.defaultLogger.exception(u),this._telemetryService.sendGHTelemetryException(u,"Error"),this.conversationLogger?.logThrownError(u);let l=u.message;return e.status="error",e.response={message:l,type:"meta"},{errorDetails:{message:l}}}}async sanitizeVariables(e,r){let n=e.references.map(async s=>{let a=!1;return s.value instanceof Ur&&(a=await this._ignoreService.isCopilotIgnored(s.value)),a&&s.range&&(r.request.message=r.request.message.slice(0,s.range[0])+r.request.message.slice(s.range[1])),a?null:s}),o=Xt(await Promise.all(n));return{...e,references:o}}fixMessageNames(e,r){let n=this._configurationService.getConfig(fe.UseMessageNames);r.forEach(o=>{n?o.role!=="system"&&o.name===e?.id&&(o.name=void 0):o.name=void 0})}async fetchConversationResponse(e,r,n,o,s,a,c,u,l,d,p){let f=Wx();e.requestId=d.properties.messageId,e.modelMessageId=f.properties.messageId;let m=Date.now(),h=0,g=new Lx,v=l?.disable?c:this._instantiationService.createInstance(If,e.references,c,l?.additionaLinkifiers??[],a),y=u.processResponse(e,o,g.stream,v,a),b=!1;y.finally(()=>{b=!0});let _=await this._chatMLFetcher.fetchOne(o,async(ne,Y,N)=>(h===0&&(h=Date.now()),g.update(ne,N),b?ne.length:void 0),a,2,r,{agent:s},{temperature:this.options.temperature,top_p:this.options.topP},p,{intent:!0});g.resolve();let S=await y,I=0;v instanceof If&&(await v.finalize(),I=v.totalAddedLinkCount);let T=S?AH(S):[],A=d.raw.displayedTime??m,B=["programming-related tasks","programming related questions","software development topics","related to programming","expertise is limited","sorry, i can't assist with that"],j=0;_.type==="success"&&!S.trim().includes(`
`)&&B.some(ne=>S.toLowerCase().includes(ne))&&(j=1);let F=this._tokenizerProvider.acquireTokenizer(r.family);switch(this._telemetryService.sendMSFTTelemetryEvent("panel.request",{command:e.intentInvocation?.intent.id??"none",contextTypes:e.contextParts.map(ne=>ne.kind).join(",")??"none",promptTypes:o.map(ne=>`${ne.role}${ne.name?`-${ne.name}`:""}:${ne.content.length}`).join(","),conversationId:this._sessionId,requestId:e.requestId,responseId:_.requestId,responseType:_.type,codeBlocks:T.join(","),model:r.model},{turn:this.conversation.turns.length,textBlocks:T.length?-1:S.split(/\n{2,}/).length??0,links:I,maybeOffTopic:j,messageTokenCount:F.tokenLength(e.request.message),promptTokenCount:C1(this._tokenizerProvider.acquireTokenizer(r.family),o),userPromptCount:o.filter(ne=>ne.role==="user").length,responseTokenCount:F.tokenLength(S)??0,timeToRequest:m-A,timeToFirstToken:h?h-A:-1,timeToComplete:Date.now()-A}),DL(this._telemetryService,"conversationPanel",_.requestId,n,_.type==="offTopic",this._tabsAndEditorsService.activeTextEditor?.document,d),_.type){case"success":return await this.processSuccessfulFetchResult(e,S,_.requestId,f);case"offTopic":return this.processOffTopicFetchResult(c,e,n,d);case"canceled":return e.status="cancelled",e.response={message:"Cancelled",type:"user"},{errorDetails:e.response};case"rateLimited":return e.status="error",{errorDetails:{message:il.t("Sorry, your request was rate-limited. Please wait and try sending again later."),responseIsFiltered:!0}};case"badRequest":case"failed":return e.status="error",e.response={message:_.reason,type:"server"},{errorDetails:e.response};case"filtered":return e.status="filtered",{errorDetails:{message:VD(_.category),responseIsFiltered:!0}};case"agent_unauthorized":return e.status="error",{};case"agent_failed_dependency":return e.status="error",{errorDetails:{message:_.reason}};case"length":return e.status="error",{errorDetails:{message:il.t("Sorry, the response hit the length limit. Please rephrase your prompt.")}};case"unknown":return e.status="error",{errorDetails:{message:il.t("Sorry, no response was returned."),responseIsFiltered:!1}};case"extensionBlocked":return e.status="error",{errorDetails:{message:il.t("Sorry, something went wrong."),responseIsFiltered:!1}}}}async processSuccessfulFetchResult(e,r,n,o){return r.length>0?(e.status="success",e.response={message:r,type:"model"},o.markAsDisplayed(),NL(this._telemetryService,this.conversation,this._sessionId,"conversationPanel",r,n,this._tabsAndEditorsService.activeTextEditor?.document,o),{}):(e.status="error",e.response={message:il.t("The model unexpectedly did not return a response, which may indicate a service issue. Please report a bug."),type:"meta"},{errorDetails:e.response})}processOffTopicFetchResult(e,r,n,o){let s=Wx();return e.markdown(this.options.rejectionMessage),r.response={message:this.options.rejectionMessage,type:"offtopic-detection"},r.status="off-topic",s.markAsDisplayed(),LL(this._telemetryService,this.conversation,this._sessionId,"conversationPanel",n,o.properties.messageId,this._tabsAndEditorsService.activeTextEditor?.document,s),{}}};yT=O([x(2,te),x(3,Sn),x(4,me),x(5,ye),x(6,Ut),x(7,Vh),x(8,rh),x(9,Da),x(10,pg),x(11,kt),x(12,te),x(13,ue),x(14,De),x(15,Bt),x(16,dr),x(17,Xx)],yT);var G7=z(at());var V7=class extends Q{render(){return vscpp(vscppf,null,vscpp(G7.SystemMessage,{priority:1e3},vscpp("br",null),"You are an AI programming assistant.",vscpp("br",null),'When asked for your name, you must respond with \\"GitHub Copilot\\".',vscpp("br",null),"Follow the user's requirements carefully & to the letter.",vscpp("br",null),"Your expertise is strictly limited to software development topics.",vscpp("br",null),"Follow Microsoft content policies.",vscpp("br",null),"Avoid content that violates copyrights.",vscpp("br",null),"For questions not related to software development, simply give a reminder that you are an AI programming assistant.",vscpp("br",null),"Keep your answers short and impersonal.",vscpp("br",null),vscpp("br",null),vscpp("br",null),vscpp(ou,{location:this.props.location,endpoint:this.props.endpoint}),vscpp("br",null),"First think step-by-step - describe your plan for what to build in pseudocode, written out in great detail.",vscpp("br",null),"Then output the code in a single code block.",vscpp("br",null),"Minimize any other prose.",vscpp("br",null),"Use Markdown formatting in your answers.",vscpp("br",null),"Make sure to include the programming language name at the start of the Markdown code blocks.",vscpp("br",null),"Avoid wrapping the whole response in triple backticks.",vscpp("br",null),"The user works in an IDE called Visual Studio Code which has a concept for editors with open files, integrated unit test support, an output pane that shows the output of running the code as well as an integrated terminal.",vscpp("br",null),"The active document is the source code the user is looking at right now.",vscpp("br",null),"You can only give one reply for each conversation turn."),vscpp(Lt,{priority:800,history:this.props.history}),vscpp(G7.UserMessage,{priority:900},"Write a short one-sentence question that the user can ask that naturally follows from the previous few questions and answers. It should not ask a question which is already answered in the conversation. It should be a question that you are capable of answering. Reply with only the text of the question and nothing else.",vscpp("br",null),vscpp(cr,null)))}};var bT=class{constructor(e,r,n,o,s,a,c,u){this.conversationLogger=e;this.options=r;this.endpointProvider=o;this.chatMLFetcher=s;this.accessor=a;this.telemetryService=c;this.tabsAndEditorsService=u;this.logger=n.getLogger("ConversationFollowUp")}async computeFollowups(e,r){let n=e.getLatestTurn();if(!n)return[];let o={messageId:n.requestId},c=(n.status==="success"?await this.followUp(e,2,r,o):[]).map(p=>this.conversationToReplyFollowup(p,o));r.isCancellationRequested||this.conversationLogger?.logFollowups(c);let u=n,l=[],d=u?.intentInvocation;return d?.followUps&&(l=await d.followUps(u)),l.concat(c)}async followUp(e,r,n,o){let s=o?{...o}:{};s.requestId=Br(),s.messageSource="chat.followup";let a=await this.endpointProvider.getChatEndpoint("gpt-3.5-turbo"),{messages:c}=await Xi(this.accessor.get(te),a,V7,{history:e.turns,endpoint:a,location:r}),u=await this.chatMLFetcher.fetchOne(c,void 0,n,r,a,void 0,{temperature:this.options.temperature,top_p:this.options.topP},s);if(u.type==="success"){let l=[];return u.value&&l.push(u.value.trim()),l}else return this.logger.error(`Failed to fetch followups because of response type (${u.type}) and reason (${u.reason})`,u),[]}conversationToReplyFollowup(e,r){let n=r??{};return n.suggestionId=Br(),n.suggestionType="Follow-up from model",OL(this.telemetryService,n.suggestionType,n.messageId,n.suggestionId,this.tabsAndEditorsService.activeTextEditor?.document),{prompt:e}}};bT=O([x(1,Sn),x(2,ue),x(3,Le),x(4,Bt),x(5,je),x(6,me),x(7,kt)],bT);var Do=z(require("vscode"));var _T=class{constructor(e,r,n){this.configurationService=e;this.telemetryService=r;this.authenticationService=n;this.hasShownWelcomeMessage=!1}async provideWelcomeMessage(e,r){let n=(await this.authenticationService.getCopilotToken()).isInternal,o=this.authenticationService.anyGitHubSession?.account?.label,s=I4(),a=this.configurationService.getConfig(fe.WelcomeMessage),c="workbench.action.openSettings",u=new Do.MarkdownString(Do.l10n.t("{0} has identified you as an internal user. Internal users have additional telemetry collected for product improvement purposes. If you work on a project that contains customer content, it is required you disable this telemetry as it does contain PII. [Disable Telemetry]({1}).",["Copilot",`command:${c}?%5B%22telemetry.telemetryLevel%22%5D`]));u.isTrusted={enabledCommands:[c]};let l=Do.l10n.t({message:"I'm powered by AI, so surprises and mistakes are possible. Make sure to verify any generated code or suggestions, and [share feedback]({0}) so that we can learn and improve. Check out the [{1} documentation]({2}) to learn more.",args:[s,"Copilot","https://code.visualstudio.com/docs/copilot/getting-started-chat"],comment:["{Locked=']({'}","the [text](url) is a markdown link syntax. Do not add any additional spaces between ] and ("]}),d=o?" **@"+o+"**":"";if(a==="never"||this.hasShownWelcomeMessage&&a==="first")return[Do.l10n.t("Hi{0}, how can I help you?",d)];this.hasShownWelcomeMessage=!0;let p="workbench.action.quickchat.launchInlineChat",f=Do.window.activeNotebookEditor||Do.window.activeTextEditor?Do.l10n.t("You can also [start an inline chat session]({0}).",`command:${p}`):"",m=new Do.MarkdownString(Do.l10n.t("Welcome,{0}, I'm your {1} and I'm here to help you get things done faster. {2}",d,"Copilot",f));m.isTrusted={enabledCommands:[p]};let h=[m,l];return n&&h.push(u),h}provideSampleQuestions(e,r){let n=Do.window.activeNotebookEditor||Do.window.activeTextEditor?Fct():oDe([["","help",Do.l10n.t("What can you do?")]]);return this.suggestionsToTelemetry([...n],"welcome"),n}suggestionsToTelemetry(e,r){e.map(n=>{OL(this.telemetryService,`@${n.participant} /${n.command} ${n.prompt}`,r,"",Do.window.activeTextEditor?.document)})}};_T=O([x(0,ye),x(1,me),x(2,Nt)],_T);function Fct(){let t=X_("workspace");return oDe([[t,"fix",Do.l10n.t("the problems in my code")],[t,"tests",Do.l10n.t("add unit tests for my code")],[t,"explain",Do.l10n.t("how the selected code works")]])}function oDe(t){return t.map(([e,r,n])=>({prompt:"",participant:e,command:r,label:`/${r} ${n}`}))}var xT=class{constructor(e){this.instantiationService=e}register(){let e=this.instantiationService.createInstance(Vc);return e.register(),e}};xT=O([x(0,te)],xT);var Vc=class{constructor(e,r,n,o,s,a,c,u,l){this.options=e;this.extensionContext=r;this.octoKitService=n;this.authenticationService=o;this.languageDiagnosticsService=s;this.instantiationService=a;this.userFeedbackService=c;this.configurationService=u;this.conversationStore=l;this._disposables=new Tt;this._inlineChatSessions=new w_(10,1);this._logger=a.createInstance(vc,()=>{let d=Vt.window.createOutputChannel("GitHub Copilot Chat Conversation","log");return r.subscriptions.push(d),d})}dispose(){this._disposables.dispose()}register(){this._disposables.add(this.registerDefaultAgent()),this._disposables.add(this.registerEditorDefaultAgent()),this._disposables.add(this.registerNotebookDefaultAgent()),this._disposables.add(this.registerWorkspaceAgent()),this._disposables.add(this.registerVSCodeAgent()),this._disposables.add(this.registerTerminalAgent()),this._disposables.add(this.registerTerminalPanelAgent())}createAgent(e,r,n){n=n||X_(e);let o=Vt.chat.createChatParticipant(n,this.getChatParticipantHandler(n,e,r));return o.onDidReceiveFeedback(s=>{if(Vc.isInlineChatResult(s.result))return this.handleInlineChatUserAction(s.result,void 0,s);this.userFeedbackService.handleFeedback(s,n)}),o.onDidPerformAction(s=>{if(Vc.isInlineChatResult(s.result))return this.handleInlineChatUserAction(s.result,s,void 0);this.userFeedbackService.handleUserAction(s,n)}),o.supportIssueReporting=this.configurationService.getConfig(fe.DebugReportFeedback),o.followupProvider={provideFollowups:async(s,a,c)=>{let u=s.metadata?.responseId&&this.conversationStore.getConversation(s.metadata.responseId);return u?await this.instantiationService.createInstance(bT,this._logger).computeFollowups(u,c):[]}},o}registerWorkspaceAgent(){let e=this.createAgent(tf,"workspace");return e.iconPath=new Vt.ThemeIcon("code"),e.isSecondary=!0,e}registerVSCodeAgent(){let e=this.createAgent(sw,"vscode"),r=Vt.env.appName.includes("Insiders")||Vt.env.appName.includes("OSS");return e.iconPath=dt.joinPath(this.extensionContext.extensionUri,"assets",r?"vscode-chat-avatar-insiders.svg":"vscode-chat-avatar-stable.svg"),e.supportsSlowReferences=!0,e}registerTerminalAgent(){let e=this.createAgent(F0,"terminal");return e.iconPath=new Vt.ThemeIcon("terminal"),e.supportsSlowReferences=!0,e.followupProvider=void 0,e}registerTerminalPanelAgent(){let e=this.createAgent(F0,"terminal","github.copilot.terminalPanel");return e.iconPath=new Vt.ThemeIcon("terminal"),e.supportsSlowReferences=!0,e}async initDefaultAgentRequestorProps(e){let r=async()=>{let n=await this.octoKitService.getCurrentAuthedUser();return n?(e.requester={name:n.login,icon:dt.parse(n?.avatar_url??`https://avatars.githubusercontent.com/${n.login}`)},!0):!1};if(!await r()){let n=this.authenticationService.onDidAuthenticationChange(async()=>{await r()&&n.dispose()})}}registerDefaultAgent(){let e=this.createAgent(fB,"unknown");e.iconPath=new Vt.ThemeIcon("copilot"),e.supportsSlowReferences=!0,this.initDefaultAgentRequestorProps(e),e.helpTextPrefix=Vt.l10n.t("You can ask me general programming questions, or chat with the following participants which have specialized expertise and can perform actions:");let r=Vt.l10n.t({message:`To have a great conversation, ask me questions as if I was a real programmer:

* **Show me the code** you want to talk about by having the files open and selecting the most important lines.
* **Make refinements** by asking me follow-up questions, adding clarifications, providing errors, etc.
* **Review my suggested code** and tell me about issues or improvements, so I can iterate on it.

You can also ask me questions about your editor selection by [starting an inline chat session](command:inlineChat.start).

Learn more about [GitHub Copilot](https://docs.github.com/copilot/using-github-copilot/getting-started-with-github-copilot?tool=vscode&utm_source=editor&utm_medium=chat-panel&utm_campaign=2024q3-em-MSFT-getstarted) in [Visual Studio Code](https://code.visualstudio.com/docs/copilot/overview).`,comment:"{Locked='](command:inlineChat.start)'}"}),n=new Vt.MarkdownString(r);return n.isTrusted={enabledCommands:["inlineChat.start"]},e.helpTextPostfix=n,e.helpTextVariablesPrefix=Vt.l10n.t("You can also help me understand your question by using the following variables to give me extra context:"),e.welcomeMessageProvider=this.instantiationService.createInstance(_T),e}registerEditorDefaultAgent(){let e=this.createAgent(ow,"unknown");return e.iconPath=new Vt.ThemeIcon("copilot"),e.welcomeMessageProvider={provideWelcomeMessage:()=>[],provideSampleQuestions:(r,n)=>{if(Vt.window.activeTextEditor){let{document:o,selection:s}=Vt.window.activeTextEditor,a=MH(this.languageDiagnosticsService.getDiagnostics(o.uri),s);if(a)return[{prompt:`/fix ${a.message}`}]}}},e}registerNotebookDefaultAgent(){let e=this.createAgent("notebook","unknown");return e.iconPath=new Vt.ThemeIcon("copilot"),e.welcomeMessageProvider={provideWelcomeMessage:()=>[],provideSampleQuestions:(r,n)=>{if(Vt.window.activeTextEditor){let{document:o,selection:s}=Vt.window.activeTextEditor,a=MH(this.languageDiagnosticsService.getDiagnostics(o.uri),s);if(a)return[{prompt:`/fix ${a.message}`}]}}},e}getChatParticipantHandler(e,r,n){return async(o,s,a,c)=>{if(o.location2 instanceof Vt.ChatRequestEditorData)return this.handleInlineChatRequest(e,o,s,a,c);if(o.location2 instanceof Vt.ChatRequestNotebookData)return this.handleNotebookChatRequest(e,o,s,a,c);let u=this.instantiationService.createInstance(yT,this._logger,s.history),l=sx[n],d=o.command&&l?l[o.command]:n;return await u.handleRequest(o,a,c,{agentName:r,agentId:e,intentId:d})}}static{this.metadataKey="inlineChatSession"}static isInlineChatResult(e){return!!this.retrieveSessionId(e)}static retrieveSessionId(e){return e?.metadata?.[Vc.metadataKey]}static asChatResultWithSessionId(e){return{metadata:{[Vc.metadataKey]:e}}}async handleInlineChatRequest(e,r,n,o,s){UT(r.location2 instanceof Vt.ChatRequestEditorData),this._inlineChatProvider??=this.instantiationService.createInstance(au,e,this.options.rejectionMessage);let{document:a,selection:c,wholeRange:u}=r.location2;return this.handleCommonInlineChatRequest(e,n,o,a,c,u,r,s)}async handleCommonInlineChatRequest(e,r,n,o,s,a,c,u){this._inlineChatProvider??=this.instantiationService.createInstance(au,e,this.options.rejectionMessage);let l;for(let g=r.history.length-1;g>=0;g--){let v=r.history[g];if(v instanceof Vt.ChatResponseTurn){l=v.result;break}}let d=Vc.retrieveSessionId(l)??Br(),p=this._inlineChatSessions.get(d);p||(p={session:await this._inlineChatProvider.prepareInteractiveEditorSession({document:o,selection:s}),responses:[]},this._inlineChatSessions.set(d,p));let f={...c,selection:s,wholeRange:a},m=new gc(g=>{if(g instanceof Vt.ChatResponseTextEditPart){let v=Vt.workspace.textDocuments.find(y=>y.uri.toString()===g.uri.toString());if(v){let y=g.edits.filter(b=>v.getText(b.range)!==b.newText);g=new Vt.ChatResponseTextEditPart(g.uri,y)}}n.push(g)}),h=await this._inlineChatProvider.provideInteractiveEditorResponse(p.session,f,m,u);return h?(p.responses.push(h),Vc.asChatResultWithSessionId(d)):{}}async handleInlineChatUserAction(e,r,n){let o=Vc.retrieveSessionId(e);if(!o)return;let s=this._inlineChatSessions.get(o);if(!s||s.responses.length===0)return;let a;r?.action.kind==="editor"?a=r.action.accepted?3:2:r?.action.kind==="bug"?a=4:n?.kind===Vt.ChatResultFeedbackKind.Helpful?a=1:n?.kind===Vt.ChatResultFeedbackKind.Unhelpful&&(a=0),a!==void 0&&this._inlineChatProvider?.handleInteractiveEditorResponseFeedback(s.session,s.responses.at(-1),a)}async handleNotebookChatRequest(e,r,n,o,s){UT(r.location2 instanceof Vt.ChatRequestNotebookData),this._inlineChatProvider??=this.instantiationService.createInstance(au,e,this.options.rejectionMessage);let a=r.location2.cell,c=new Vt.Selection(0,0,0,0),u=new Vt.Range(0,0,0,0);return this.handleCommonInlineChatRequest(e,n,o,a,c,u,r,s)}};Vc=O([x(0,Sn),x(1,ar),x(2,C4),x(3,Nt),x(4,bo),x(5,te),x(6,NS),x(7,ye),x(8,pg)],Vc);var sDe=require("path"),z7=z(require("vscode"));var Kte="---------------------------------",ST=class{constructor(e,r,n){this._configurationService=e;this._authenticationService=r;this._accessor=n}async reportInline(e,r,n){if(!await this._canReport())return;let o=e.getLatestTurn();if(!o)return;let s=r.intent?this._embedCodeblock("INTENT",r.intent.id):"",a=this._embedCodeblock("CONTEXT",JSON.stringify({document:r.document.uri.toString(),fileIndentInfo:r.fileIndentInfo,language:r.language,wholeRange:r.wholeRange,selection:r.selection},null,"	")),c="",u=o.chatMessages;if(u&&u.length>0){let m=u.map(h=>this._embedCodeblock(h.role.toUpperCase(),h.content)).join(`
`);c=`	${Kte}
${this._headerSeparator()}PROMPT MESSAGES:
${m}`}else c=this._embedCodeblock(o.request.type.toUpperCase(),o.request.message);let l=this._embedCodeblock("ASSISTANT",o.response?.message||""),d=this._embedCodeblock("Parsed response",JSON.stringify(n,null,"	")),f=`
<details><summary>Prompt Details</summary>
<p>

${`${s}
${a}
${c}
${l}
${d}
`}

</p>
</details>
`;if(o.requestDebugInformation){let m=(0,sDe.basename)(o.requestDebugInformation.uri.path),h=o.requestDebugInformation.userSelection,g=`
<details><summary>STest</summary>
<p>
STest code:

\`\`\`ts
${Uct(o.requestDebugInformation.languageId,o.requestDebugInformation.intentId,o.requestDebugInformation.userPrompt,m,o.requestDebugInformation.initialDocumentText,h)}
\`\`\`
</p>
</details>
		`;f=f+`
${g}`}await this._reportIssue("Feedback for inline chat",f)}async reportChat(e){if(!await this._canReport())return;let r="",n=e.chatMessages;if(n&&n.length>0){let d=n.map(p=>this._embedCodeblock(p.role.toUpperCase(),p.content)).join(`
`);r=`	${Kte}
${this._headerSeparator()}PROMPT MESSAGES:
${d}`}else r=this._embedCodeblock(e.request.type.toUpperCase(),e.request.message);let o=e.intentInvocation?.intent?this._embedCodeblock("INTENT",`[${e.intentInvocation.intent.id}] ${e.intentInvocation.intent.description}`):"",s=this._embedCodeblock("ASSISTANT",e.response?.message||""),a=await F4(this._accessor,[]),c=this._embedCodeblock("WORKSPACE STATE",JSON.stringify(a,null,2)),l=`
<details><summary>Prompt Details</summary>
<p>

${`${o}
${r}
${s}
${c}
`}

</p>
</details>`;await this._reportIssue("Feedback for sidebar chat",l)}async _canReport(){return!(!this._configurationService.getConfig(fe.DebugReportFeedback)||!(await this._authenticationService.getCopilotToken())?.isInternal)}_embedCodeblock(e,r){let n=this._bodySeparator()+r.split(`
`).join(`
${this._bodySeparator()}`);return`	${Kte}
${this._headerSeparator()}${e}:
${n}`}_headerSeparator(){return"	"}_bodySeparator(){return"		"}async _reportIssue(e,r){await z7.commands.executeCommand("workbench.action.openIssueReporter",{extensionId:q0,issueTitle:e,data:r,issueBody:"",uri:z7.Uri.parse("https://github.com/microsoft/vscode-copilot")})}};ST=O([x(0,ye),x(1,Nt),x(2,je)],ST);function Uct(t,e,r,n,o,s){let a=[s.start.line,s.start.character,s.end.line,s.end.character];function c(u){return JSON.stringify(u)}return`
stest({ description: 'Issue #XXXXX', language: ${c(t)}, model }, (accessor) => {
	return simulateInlineChat(accessor, {
		files: [toFile({
			fileName: ${c(`${e}/issue-XXXXX/${n}`)},
			fileContent: ${c(o)}
		})],
		queries: [
			{
				file: ${c(n)},
				selection: ${JSON.stringify(a)},
				query: ${c(r)},
				diagnostics: 'tsc',
				expectedIntent: ${c(e)},
				validate: async (outcome, workspace) => {
					assertInlineEdit(outcome);
					await assertNoDiagnostics(accessor, outcome, workspace, KnownDiagnosticProviders.tscIgnoreImportErrors);
				}
			}
		]
	});
});`}var Bct=[{max_token_sequence_length:1,last_tokens_to_consider:10},{max_token_sequence_length:10,last_tokens_to_consider:30},{max_token_sequence_length:20,last_tokens_to_consider:45},{max_token_sequence_length:30,last_tokens_to_consider:60}];function cDe(t,e="client"){if(e==="proxy")return!1;let r=t.slice();return r.reverse(),aDe(r)||aDe(r.filter(n=>n.trim().length>0))}function aDe(t){let e=qct(t);for(let r of Bct){if(t.length<r.last_tokens_to_consider)continue;if(r.last_tokens_to_consider-1-e[r.last_tokens_to_consider-1]<=r.max_token_sequence_length)return!0}return!1}function qct(t){let e=Array(t.length).fill(0);e[0]=-1;let r=-1;for(let n=1;n<t.length;n++){for(;r>=0&&t[r+1]!==t[n];)r=e[r];t[r+1]===t[n]&&r++,e[n]=r}return e}function uDe(t){if(t!==void 0&&t!==0&&t.hostname==="github.com")return t.owner+"/"+t.repo}async function lDe(t,e,r,n,o,s,a){let c=t.get(ue).getLogger("chat fetch"),u=t.get(ue).getPromptResponseLogger("chat fetch"),l=jct(t,r);if(s?.isCancellationRequested)return{type:"canceled",reason:"before fetch request"};u.info(`url ${e.url}`),u.info(`modelMaxPromptTokens ${e.modelMaxPromptTokens}`),u.info(`modelMaxResponseTokens ${l.max_tokens??2048}`),u.info(`chat model ${r.model}`);let d=r.secretKey??(await t.get(Nt).getCopilotToken()).token;if(!d)return c.error(`Failed to send request to ${e.url} due to missing key`),wf(t.get(me),`Failed to send request to ${e.url} due to missing key`),{type:"failed",failKind:"tokenExpiredOrInvalid",reason:"key is missing"};let p=await Gct(t,e,r.ourRequestId,l,d,r.location,s,a);if(s?.isCancellationRequested){let v=await p.body();try{v.destroy()}catch(y){c.exception(y,"Error destroying stream"),t.get(me).sendGHTelemetryException(y,"Error destroying stream")}return{type:"canceled",reason:"after fetch request"}}if(p.status!==200){let v=Hct(e,t,r.location,r.ourRequestId);return c.info("Request ID for failed request: ",r.ourRequestId),Vct(t,v,p)}let f=t.get(me),m=t.get(ue),h=r.postOptions?.n??1;return{type:"success",chatCompletions:await e.processResponseFromChatEndpoint(f,m,p,h,o,n,s),getProcessingTime:()=>Nae(p)}}function Hct(t,e,r,n){return Wn.createAndMarkAsIssued({endpoint:"completions",engineName:"chat",uiKind:ft.toString(r),headerRequestId:n})}function jct(t,e){let r={messages:e.messages,model:e.model};e.postOptions&&Object.assign(r,e.postOptions);let n=uDe(e.repoInfo);return n!==void 0&&(r.nwo=n),e.intent&&(r.intent=e.intent,e.intent_model&&(r.intent_model=e.intent_model),e.intent_tokenizer&&(r.intent_tokenizer=e.intent_tokenizer),e.intent_threshold&&(r.intent_threshold=e.intent_threshold)),r}async function Vct(t,e,r){let n=t.get(ue).getLogger("chat fetch"),o=t.get(me);e.properties.error=`Response status was ${r.status}`,e.properties.status=String(r.status),o.sendGHTelemetryEvent("request.shownWarning",e.properties,e.measurements);let s=await r.text();if(r.status===401&&s.includes("authorize_url"))try{let a=JSON.parse(s);return{type:"failed",failKind:"unauthorized",reason:r.statusText||r.statusText,data:a}}catch{}if(r.status===401||r.status===403)return t.get(Nt).resetCopilotToken(r.status),{type:"failed",failKind:"tokenExpiredOrInvalid",reason:`token expired or invalid: ${r.status}`};if(r.status===499)return n.info("Cancelled by server"),{type:"failed",failKind:"serverCanceled",reason:"canceled by server"};if(r.status===466)return n.info(s),{type:"failed",failKind:"clientNotSupported",reason:`client not supported: ${s}`};if(r.status===400&&s.includes("off_topic"))return{type:"failed",failKind:"offTopic",reason:"filtered as off_topic by intent classifier: message was not programming related"};if(r.status===424)return{type:"failed",failKind:"failedDependency",reason:s};if(r.status===429){if(s.includes("extension_blocked"))try{let a=JSON.parse(s);if(a.error&&(a=a.error),a.code==="extension_blocked"&&a.type==="rate_limit_error")return{type:"failed",failKind:"extensionBlocked",reason:a.reason??a.code,data:{...a.message,retryAfter:r.headers.get("retry-after")}}}catch{}return{type:"failed",failKind:"rateLimited",reason:s}}return r.status>=500&&r.status<600?{type:"failed",failKind:"serverError",reason:`${r.status} ${s}`}:r.status===422?{type:"failed",failKind:"contentFilter",reason:"Filtered by Responsible AI Service"}:(n.error("Unhandled status from server:",r.status,s),wf(t.get(me),"Unhandled status from server: "+r.status,s),{type:"failed",failKind:"unknown",reason:`unhandled status from server: ${r.status} ${s}`})}async function Gct(t,e,r,n,o,s,a,c){let u=t.get(ue).getLogger("chat fetch"),l=t.get(me),d=Wn.createAndMarkAsIssued({endpoint:"completions",engineName:"chat",uiKind:ft.toString(s),...c},{maxTokenWindow:e.modelMaxPromptTokens});for(let[m,h]of Object.entries(n))m!=="messages"&&(d.properties[`request.option.${m}`]=JSON.stringify(h)??"undefined");d.properties.headerRequestId=r,l.sendGHTelemetryEvent("request.sent",d.properties,d.measurements);let p=Date.now(),f=zct(s);return FS(t.get($r),t.get(Rt),t.get(me),t.get(yn),e,o,await Ff(process.env.HMAC_SECRET),f,r,n,a).then(m=>{let h=zw(m,void 0);d.extendWithRequestId(h);let g=Date.now()-p;return d.measurements.totalTimeMs=g,u.info(`request.response: [${e.url}], took ${g} ms`),u.debug("request.response properties",d.properties),u.debug("request.response measurements",d.measurements),u.debug(`messages: ${JSON.stringify(n.messages)}`),l.sendGHTelemetryEvent("request.response",d.properties,d.measurements),m}).catch(m=>{if(t.get($r).isAbortError(m))throw m;let g=d.extendedBy({error:"Network exception"});l.sendGHTelemetryEvent("request.shownWarning",g.properties,g.measurements),d.properties.code=String(m.code??""),d.properties.errno=String(m.errno??""),d.properties.message=String(m.message??""),d.properties.type=String(m.type??"");let v=Date.now()-p;throw d.measurements.totalTimeMs=v,u.debug(`request.response: [${e.url}] took ${v} ms`),u.debug("request.error properties",d.properties),u.debug("request.error measurements",d.measurements),l.sendGHTelemetryEvent("request.error",d.properties,d.measurements),m}).finally(()=>{hV(l,n.messages,d)})}function zct(t){switch(t){case 2:return"conversation-panel";case 1:return"conversation-inline"}}var Yte=class{constructor(){this._onDidMakeChatMLRequest=new Gt;this.onDidMakeChatMLRequest=this._onDidMakeChatMLRequest.event}async fetchOne(e,r,n,o,s,a,c,u,l){let d=await this.fetchMany(e,r,n,o,s,a,{...c,n:1},u,l);return d.type==="success"?{...d,value:d.value[0]}:d}},b0=class extends Yte{constructor(r){super();this.accessor=r;this.logger=r.get(ue).getPromptResponseLogger("ChatMLFetcher")}async fetchMany(r,n,o,s,a,c,u,l,d){let p=l?.requestId??l?.messageId??Br(),f=C1(this.accessor.get(dr).acquireTokenizer(a.family),r.map(b=>({role:b.role,content:b.content,...b.name?{name:b.name}:void 0}))),m=Math.min(a.modelMaxPromptTokens-f+2048,4096);u={max_tokens:m,...u};let h=b0.preparePostOptions(u),g=a.model;d&&(d.intent_model=await this.getOffTopicModelName(),d.intent_tokenizer=await this.getOffTopicModelTokenizer(),d.intent_threshold=await this.getOffTopicModelThreshold());let v={messages:r,model:g,repoInfo:void 0,ourRequestId:p,location:s,postOptions:h,secretKey:u.secretKey,...d},y=Wn.createAndMarkAsIssued({...l,uiKind:ft.toString(s)});try{let b,_=$ct(v);if(!_.isValid)b={type:"failed",failKind:"validationFailed",reason:`Prompt failed validation with the reason: ${_.reason}. Please file an issue.`};else{b=await lDe(this.accessor,a,v,y,n||(async()=>{}),o,l);let T=c?.extensionId??q0,A=c?.agent&&T===q0&&nie.includes(c.agent)?X_(c.agent):c?.agent;this._onDidMakeChatMLRequest.fire({messages:r,model:a.model,source:{extensionId:T,agent:A},tokenCount:f})}let S=Date.now()-y.issuedTime,I;switch(b.type){case"success":return await this.processSuccessfulResponse(b,v.ourRequestId,m,f,S,y,a);case"canceled":return this.accessor.get(me).sendMSFTTelemetryEvent("response.cancelled",{source:l?.messageSource??"unknown",requestId:v.ourRequestId,model:a.model},{totalTokenMax:a.modelMaxPromptTokens??-1,promptTokenCount:f,tokenCountMax:m,timeToFirstToken:S,timeToCancelled:y?Date.now()-y.issuedTime:-1}),this.processCanceledResponse(b,v.ourRequestId);case"failed":return I=this.processFailedResponse(b,v.ourRequestId),this._sendResponseErrorTelemetry(I,l,v,a,f,m,S),I}}catch(b){let _=Date.now()-y.issuedTime,S=this.processError(b,v.ourRequestId);return this._sendResponseErrorTelemetry(S,l,v,a,f,m,_),S}}_sendResponseErrorTelemetry(r,n,o,s,a,c,u){this.accessor.get(me).sendMSFTTelemetryEvent("response.error",{type:r.type,reason:r.reason,source:n?.messageSource??"unknown",requestId:o.ourRequestId,model:s.model},{totalTokenMax:s.modelMaxPromptTokens??-1,promptTokenCount:a,tokenCountMax:c,timeToFirstToken:u})}static preparePostOptions(r){return{...r,stream:!0}}async processSuccessfulResponse(r,n,o,s,a,c,u){let l=[];for await(let m of r.chatCompletions)this.accessor.get(me).sendMSFTTelemetryEvent("response.success",{reason:m.finishReason,filterReason:m.filterReason,source:c?.properties.messageSource??"unknown",model:u?.model,requestId:n},{totalTokenMax:u?.modelMaxPromptTokens??-1,tokenCountMax:o,promptTokenCount:s,tokenCount:m.numTokens,timeToFirstToken:a,timeToComplete:c?Date.now()-c.issuedTime:-1}),this.isRepetitive(m,c?.properties)||l.push(m);this.logger.debug(`Received choices: ${JSON.stringify(l,null,2)}`);let d=new Set(["stop","client-trimmed","function_call"]),p=l.filter(m=>d.has(m.finishReason));if(p.length>=1)return{type:"success",value:p.map(m=>m.message.content),requestId:n};let f=l[0];switch(f?.finishReason){case"content_filter":return{type:"filtered",category:f.filterReason??"snippy",reason:"Response got filtered.",requestId:n};case"length":return{type:"length",reason:"Response too long.",requestId:n,truncatedValue:f.message.content}}return{type:"unknown",reason:"Response contained no choices.",requestId:n}}async getOffTopicModelName(){let r=this.accessor.get(ye).getConfig(fe.DebugOverrideChatOffTopicModel);return r||""}async getOffTopicModelTokenizer(){let r=this.accessor.get(ye).getConfig(fe.DebugOverrideChatOffTopicModelTokenizer);return r||""}async getOffTopicModelThreshold(){let r=this.accessor.get(ye).getConfig(fe.DebugOverrideChatOffTopicModelThreshold);return r!==0?r:0}isRepetitive(r,n){let o=cDe(r.tokens);if(o){let s=Wn.createAndMarkAsIssued();s.extendWithRequestId(r.requestId);let a=s.extendedBy(n);this.accessor.get(me).sendRestrictedGHTelemetryEvent("conversation.repetition.detected",a.properties,a.measurements),this.logger.info("Filtered out repetitive conversation result")}return o}processCanceledResponse(r,n){return this.logger.debug("Cancelled after awaiting fetchConversation"),{type:"canceled",reason:r.reason,requestId:n}}processFailedResponse(r,n){if(r.failKind==="rateLimited")return{type:"rateLimited",reason:r.reason,requestId:n};if(r.failKind==="offTopic")return{type:"offTopic",reason:r.reason,requestId:n};if(r.failKind==="tokenExpiredOrInvalid"||r.failKind==="clientNotSupported"||r.reason.includes("Bad request: "))return{type:"badRequest",reason:r.reason,requestId:n};if(r.failKind==="serverError")return{type:"failed",reason:r.reason,requestId:n};if(r.failKind==="contentFilter")return{type:"filtered",reason:r.reason,category:"prompt",requestId:n};if(r.failKind==="unauthorized")return{type:"agent_unauthorized",reason:r.reason,authorizationUrl:r.data.authorize_url,requestId:n};if(r.failKind==="failedDependency")return{type:"agent_failed_dependency",reason:r.reason,requestId:n};if(r.failKind==="extensionBlocked"){let o=typeof r.data?.retryAfter=="number"?r.data.retryAfter:300;return{type:"extensionBlocked",reason:r.reason,requestId:n,retryAfter:o,learnMoreLink:r.data?.learnMoreLink??""}}return{type:"failed",reason:r.reason,requestId:n}}processError(r,n){let o=this.accessor.get($r);return o.isAbortError(r)?{type:"canceled",reason:"network request aborted",requestId:n}:zp(r)?{type:"canceled",reason:"Got a cancellation error",requestId:n}:(this.accessor.get(ue).defaultLogger.exception(r,"Error on conversation request"),this.accessor.get(me).sendGHTelemetryException(r,"Error on conversation request"),o.isDNSLookupFailedError(r)?{type:"failed",reason:"It appears you're not connected to the internet, please check your network connection and try again.",requestId:n}:o.isFetcherError(r)?{type:"failed",reason:o.getUserMessageForFetcherError(r),requestId:n}:{type:"failed",reason:"Error on conversation request. Check the log for more details.",requestId:n})}};b0=O([x(0,je)],b0);function $ct(t){return t.messages.length===0?{isValid:!1,reason:"No messages provided"}:t?.postOptions?.max_tokens&&t?.postOptions?.max_tokens<1?{isValid:!1,reason:"Invalid response token parameter"}:t.messages[t.messages.length-1].role!=="user"?{isValid:!1,reason:"Last message must be from user"}:{isValid:!0,reason:""}}var $7=class{constructor(e,r){this._modelInfo=e;this._domainService=r;this.name=this._modelInfo.name;this.version=this._modelInfo.version;this.model=this._modelInfo.id;this.family=this._modelInfo.capabilities.family;this.maxBatchSize=this._modelInfo.capabilities.limits?.max_inputs??256,this.modelMaxPromptTokens=8192}get url(){return this._domainService.capiEmbeddingsURL}};var W7=class{constructor(){this._inFlightPromises=new Map}getOrCreate(e,r){let n=this._inFlightPromises.get(e);if(n)return n;let o=r().finally(()=>this._inFlightPromises.delete(e));return this._inFlightPromises.set(e,o),o}};var Vm=class{constructor(e,r,n,o,s,a,c){this._fetcher=e;this._domainService=r;this._expService=n;this._envService=o;this._authService=s;this._telemetryService=a;this._familyMap=new Map;this._lastFetchTime=0;this._taskSingler=new W7;this._logger=c.getLogger("ModelMetadataFetcher")}static{this.ALL_MODEL_KEY="allModels"}async getAllChatModels(){await this._taskSingler.getOrCreate(Vm.ALL_MODEL_KEY,this._fetchModels.bind(this));let e=[];for(let[,r]of this._familyMap)for(let n of r)mB(n)&&e.push(n);return e}async getChatModel(e){await this._taskSingler.getOrCreate(Vm.ALL_MODEL_KEY,this._fetchModels.bind(this));let r;if(e==="gpt-4"?r=this._familyMap.get("gpt-4o")?.[0]??this._familyMap.get("gpt-4-turbo")?.[0]:r=this._familyMap.get(e)?.[0],r=r?await this._findExpOverride(r):void 0,!r||!mB(r))throw this._lastFetchError||new Error(`Unable to resolve chat model with family selection: ${e}`);return r}async getEmbeddingsModel(e){await this._taskSingler.getOrCreate(Vm.ALL_MODEL_KEY,this._fetchModels.bind(this));let r=this._familyMap.get(e)?.[0];if(r=r?await this._findExpOverride(r):void 0,!r||!oie(r))throw this._lastFetchError||new Error(`Unable to resolve embeddings model with family selection: ${e}`);return r}_shouldRefreshModels(){if(this._familyMap.size===0)return!0;let e=10*60*1e3,r=Date.now();return this._lastFetchTime?r-this._lastFetchTime>e:!0}async _fetchModels(e){if(!e&&!this._shouldRefreshModels())return;let r=(await this._authService.getCopilotToken()).token,n=Br();try{let o=await yV(this._fetcher,this._envService,this._telemetryService,this._domainService,this._domainService.capiModelsURL,r,await Ff(process.env.HMAC_SECRET),"model-access",n);if(this._lastFetchTime=Date.now(),o.status<200||o.status>=300){if(o.status===429&&this._familyMap.size>0){this._logger.warn(`Rate limited while fetching models ${n}`);return}throw new Error(`Failed to fetch models (${n}): ${await o.text()||o.statusText||`HTTP ${o.status}`}`)}this._familyMap.clear();let s=(await o.json()).data;for(let a of s){let c=a.capabilities.family;this._familyMap.has(c)||this._familyMap.set(c,[]),this._familyMap.get(c)?.push(a)}this._lastFetchError=void 0}catch(o){this._logger.error(`Failed to fetch models (${n})`,o),this._lastFetchError=o,this._lastFetchTime=0}}async _fetchModel(e){let r=(await this._authService.getCopilotToken()).token;try{let o=await(await yV(this._fetcher,this._envService,this._telemetryService,this._domainService,`${this._domainService.capiModelsURL}/${e}`,r,await Ff(process.env.HMAC_SECRET),"model-access",Br())).json();return this._familyMap.has(o.capabilities.family)?this._familyMap.get(o.capabilities.family)?.push(o):this._familyMap.set(o.capabilities.family,[o]),o}catch{return}}async _findExpOverride(e){let r={},n=await this._expService.getTreatmentVariableAsync("vscode","copilotchat.modelOverrides",!0);try{r=JSON.parse(n||"{}")}catch{}if(r[e.id]){for(let[,s]of this._familyMap){let a=s.find(c=>c.id===r[e.id]);if(a)return a}e=await this._taskSingler.getOrCreate(r[e.id],()=>this._fetchModel(r[e.id]))??e}return e}};Vm=O([x(0,$r),x(1,yn),x(2,Ut),x(3,Rt),x(4,Nt),x(5,me),x(6,ue)],Vm);var IT=class{constructor(e){this.accessor=e;this._chatEndpoints=new Map;this._embeddingEndpoints=new Map;this.accessor.get(Nt).onDidAuthenticationChange(()=>{let r=this.accessor.get(ye).getConfig(fe.DebugOverrideChatEngine),n=this.accessor.get(ye).getConfig(fe.DebugOverrideEmbeddingsModel),o=this.accessor.get(Nt).copilotToken?.isInternal??!1;o&&r&&(this._overridenChatModel=r),o&&n&&(this._overridenEmbeddingsModel=n)}),this._modelFetcher=new Vm(e.get($r),e.get(yn),e.get(Ut),e.get(Rt),e.get(Nt),e.get(me),e.get(ue))}async shouldDisableSnippy(){let e=await this.accessor.get(Nt).getCopilotToken(),r=this.accessor.get(ar).extensionMode===$c.Development;return e.isInternal&&r}async getOrCreateChatEndpointInstance(e){let r=e.id,n=this._chatEndpoints.get(r);if(!n){let o=await Zue(this.accessor,e),s=await this.shouldDisableSnippy();n=new AS(this.accessor.get(yn),e,o,s),this._chatEndpoints.set(r,n)}return n}async getOrCreateEmbeddingEndpointInstance(e){let r=e.id,n=this._embeddingEndpoints.get(r);return n||(n=new $7(e,this.accessor.get(yn)),this._embeddingEndpoints.set(r,n)),n}async getChatEndpoint(e){if(this._overridenChatModel)return this.getOrCreateChatEndpointInstance({id:this._overridenChatModel,name:"Custom Overriden Chat Model",version:"1.0.0",capabilities:{family:"custom",type:"chat"}});let r=await this._modelFetcher.getChatModel(e);return this.getOrCreateChatEndpointInstance(r)}async getEmbeddingsEndpoint(e){if(this._overridenEmbeddingsModel)return this.getOrCreateEmbeddingEndpointInstance({id:this._overridenEmbeddingsModel,name:"Custom Overriden Embeddings Model",version:"1.0.0",capabilities:{family:"custom",type:"embeddings"}});let r=await this._modelFetcher.getEmbeddingsModel(e==="ada"?"text-embedding-ada-002":"text-embedding-3-small");return this.getOrCreateEmbeddingEndpointInstance(r)}async getAllChatEndpoints(){let e=await this._modelFetcher.getAllChatModels(),r=[];for(let n of e){let o=await this.getOrCreateChatEndpointInstance(n);r.push(o)}return r}};IT=O([x(0,je)],IT);var dDe=z(require("path")),pDe=z(require("vscode"));var Y7=z(at());var K7=class extends Q{render(){return vscpp(vscppf,null,vscpp(Y7.SystemMessage,null,vscpp(Qte,null),vscpp(yi,null)),vscpp(Y7.UserMessage,null,vscpp(Xte,{templates:this.props.templates,features:this.props.features,filenames:this.props.filenames})))}},Qte=class extends Q{render(){return vscpp(vscppf,null,"You are an AI programming assistant.",vscpp("br",null),"You are helping a software developer to configure a Dev Container by picking a configuration template and features.")}},Xte=class extends Q{render(){return vscpp(vscppf,null,"This is a partial list of workspace files:",vscpp("br",null),this.props.filenames.map(e=>`- ${e}
`).join(""),vscpp("br",null),"Based on the workspace files, please suggest the best template from the list of templates below.",vscpp("br",null),"First identify the relevant files ignoring common files, then pick the best template and reply with the best template's id.",vscpp("br",null),"This is the list of available templates:",vscpp("br",null),this.props.templates.map(e=>`- ${e.id}: ${e.name||e.id}: ${e.description||e.name||e.id}
`).join(""),vscpp("br",null),"Also based on the workspace files, please suggest all relevant features from the list of features below.",vscpp("br",null),"First identify the relevant files ignoring common files, then pick all relevant features and reply with the relevant features' ids.",vscpp("br",null),"This is the list of available features:",vscpp("br",null),this.props.features.map(e=>`- ${e.id}: ${e.name||e.id}: ${e.description||e.name||e.id}
`).join(""),vscpp("br",null))}};var Wct=["alpine","debian","docker-existing-docker-compose","docker-existing-dockerfile","docker-in-docker","docker-outside-of-docker","docker-outside-of-docker-compose","ubuntu","universal"].map(t=>`ghcr.io/devcontainers/templates/${t}`),Kct=["common-utils","git"].map(t=>`ghcr.io/devcontainers/features/${t}`),Q7=class{constructor(e){this.accessor=e;this.telemetryService=e.get(me),this.logger=e.get(ue).getPromptResponseLogger("Dev Container Configuration Generator"),this.options=e.get(Sn)}async generate(e,r,n){if(!r.length)return{type:"success",template:void 0,features:[]};let o=Date.now(),s=await this.accessor.get(Le).getChatEndpoint("gpt-3.5-turbo"),a=Math.floor(s.modelMaxPromptTokens*4/3),c=this.processFilenames(r,a),u=e.templates.filter(g=>!Wct.includes(g.id)),l=(e.features||[]).filter(g=>!Kct.includes(g.id)),p=await $e.create(this.accessor.get(te),s,K7,{filenames:c,templates:u,features:l}).render(),f=Date.now(),m=await this.accessor.get(Bt).fetchOne(p.messages,void 0,n,3,s,void 0,{temperature:this.options.temperature,top_p:this.options.topP},{messageSource:"command.generateDevContainerConfigPrompt"});this.logger.logResponse(m);let h=m.type==="success"?this.processGeneratedConfig(m.value,u,l):void 0;return this.telemetryService.sendMSFTTelemetryEvent("devcontainer.generateConfig",{model:s.model,requestId:m.requestId,responseType:m.type,templateId:h?.template,featureIds:h?.features.join(",")},{originalFilenameCount:r.length,originalFilenameLength:r.join("").length,processedFilenameCount:c.length,processedFilenameLength:c.join("").length,timeToRequest:f-o,timeToComplete:Date.now()-o}),{type:"success",template:h?.template,features:h?.features||[]}}processFilenames(e,r){let n=[...e],o=Math.floor(r*.9),s=n.join(`
`).length;if(s>o)for(;s>o&&n.length>0;){let a=n.pop();s-=a.length}return n}processGeneratedConfig(e,r,n){let o=r.find(s=>new RegExp(`\\b${k0(s.id)}\\b`).test(e))?.id;return o==="ghcr.io/devcontainers/templates/javascript-node"&&(o="ghcr.io/devcontainers/templates/typescript-node"),{template:o,features:n.filter(s=>new RegExp(`\\b${k0(s.id)}\\b`).test(e)).map(s=>s.id)}}};var CT=class{constructor(e){this.accessor=e}async generateConfiguration(e,r){if(r.isCancellationRequested)return{type:"cancelled"};let n=this.accessor.get(Kc),o=(await Promise.all(["*","*/*","*/*/*"].map(a=>n.findFilesWithDefaultExcludes(new pDe.RelativePattern(e.rootUri,a),1e3,r)))).flat().map(a=>dDe.posix.relative(e.rootUri.path,a.path));return new Q7(this.accessor).generate(e.index,o,r)}};CT=O([x(0,je)],CT);var PA=z(require("path")),xa=require("vscode");var I_=z(at());var X7=class extends Q{render(){return vscpp(vscppf,null,vscpp(I_.SystemMessage,null,vscpp(Jte,null),vscpp(Zt,null),vscpp(cr,null)),vscpp(I_.UserMessage,{priority:700,name:"changes"},"# CODE CHANGES:",vscpp("br",null),this.props.diff.map(e=>vscpp(Oe,{uri:null,code:e}))),this.props.recentCommitMessages.user.length>0&&vscpp(I_.UserMessage,{priority:600,name:"user-commits"},"# RECENT USER COMMITS:",vscpp("br",null),this.props.recentCommitMessages.user.map(e=>vscpp(Oe,{uri:null,languageId:"text",code:e}))),this.props.recentCommitMessages.repository.length>0&&vscpp(I_.UserMessage,{priority:500,name:"recent-commits"},"# RECENT REPOSITORY COMMITS:",vscpp("br",null),this.props.recentCommitMessages.repository.map(e=>vscpp(Oe,{uri:null,languageId:"text",code:e}))),vscpp(I_.UserMessage,null,"Remember to ONLY return a single markdown ```text code block with the suggested commit message. NO OTHER PROSE! If you write more than the commit message, your commit message gets lost.",vscpp("br",null),"Example:",vscpp("br",null),vscpp(Oe,{uri:null,languageId:"text",code:"commit message goes here"})))}},Jte=class extends Q{render(){return vscpp(vscppf,null,"You are an AI programming assistant, helping a software developer to come with the best git commit message for their code changes.",vscpp("br",null),"You excel in interpreting the purpose behind code changes to craft succinct, clear commit messages that adhere to the repository's guidelines.",vscpp("br",null),"# Examples of commit messages:",vscpp("br",null),vscpp(Oe,{uri:null,languageId:"text",code:"feat: improve page load with lazy loading for images"}),vscpp(Oe,{uri:null,languageId:"text",code:"Fix bug preventing submitting the signup form"}),vscpp(Oe,{uri:null,languageId:"text",code:"chore: update npm dependency to latest stable version"}),vscpp(Oe,{uri:null,languageId:"text",code:"Update landing page banner color per client request"}),vscpp("br",null),vscpp("br",null),"# First, think step-by-step:",vscpp("br",null),"1. Analyze the CODE CHANGES thoroughly to understand what's been modified.",vscpp("br",null),"2. Identify the purpose of the changes to answer the *why* for the commit messages, also considering the optionally provided RECENT USER COMMITS.",vscpp("br",null),"3. Review the provided RECENT REPOSITORY COMMITS to identify established commit message conventions. Focus on the format and style, ignoring commit-specific details like refs, tags, and authors.",vscpp("br",null),"4. Generate a thoughtful and succinct commit message for the given CODE CHANGES. It MUST follow the the established writing conventions. 5. Remove any meta information like issue references, tags, or author names from the commit message. The developer will add them.",vscpp("br",null),"6. Now only show your message, wrapped with a single markdown ```text codeblock! Do not provide any explanations or details",vscpp("br",null))}};var J7=class{constructor(e){this.accessor=e;this.telemetryService=e.get(me),this.logger=e.get(ue).getPromptResponseLogger("git commit message generator"),this.options=e.get(Sn)}async generateGitCommitMessage(e,r,n,o){let s=Date.now(),a=await this.accessor.get(Le).getChatEndpoint("gpt-3.5-turbo"),c=Math.floor(a.modelMaxPromptTokens*4/3),u=this.processDiff(e,c),d=await $e.create(this.accessor.get(te),a,X7,{diff:u,recentCommitMessages:r}).render(void 0,void 0),p=Math.min(this.options.temperature*(1+n),2),f=Date.now(),m=await this.accessor.get(Bt).fetchOne(d.messages,void 0,o,3,a,{agent:"git-commit"},{temperature:p,top_p:this.options.topP},{messageSource:"command.generateGitCommitMessagePrompt"});if(this.logger.logResponse(m),this.telemetryService.sendMSFTTelemetryEvent("git.generateCommitMessage",{model:a.model,requestId:m.requestId,responseType:m.type},{attemptCount:n+1,originalDiffFileCount:e.length,originalDiffLength:e.join("").length,processedDiffFileCount:u.length,processedDiffLength:u.join("").length,timeToRequest:f-s,timeToComplete:Date.now()-s}),m.type!=="success")return;let[h,g]=this.processGeneratedCommitMessage(m.value);return h!=="oneTextCodeBlock"&&this.telemetryService.sendMSFTTelemetryEvent("git.generateCommitMessageIncorrectResponseFormat",{requestId:m.requestId,responseFormat:h}),g}processDiff(e,r){let n=[...e],o=r-Math.floor(r*.2),s=n.join(`

`).length;if(s>o)for(n.sort((a,c)=>a.length-c.length);s>o&&n.length>0;){let a=n.pop();s-=a.length}return n}processGeneratedCommitMessage(e){let n=/^```text\s*([\s\S]+?)\s*```$/m.exec(e);return n===null?["noTextCodeBlock",e]:n.length!==2?["multipleTextCodeBlocks",e]:["oneTextCodeBlock",n[1]]}};var ET=class{constructor(e){this.accessor=e;this._commitMessages=new Map;this._disposables=new Tt;this._repositoryDisposables=new k_;this._logger=e.get(ue).getLogger("GitCommitMessageService");let r=()=>{this._disposables.add(this._gitExtensionApi.onDidOpenRepository(this._onDidOpenRepository,this)),this._disposables.add(this._gitExtensionApi.onDidCloseRepository(this._onDidCloseRepository,this));for(let o of this._gitExtensionApi.repositories)this._onDidOpenRepository(o)},n=this.accessor.get(es);this._gitExtensionApi=n.getExtensionApi(),this._gitExtensionApi?r():this._disposables.add(n.onDidChange(o=>{o.enabled&&(this._gitExtensionApi=n.getExtensionApi(),r())}))}async generateCommitMessage(e,r=an.None){if(!r.isCancellationRequested)return xa.window.withProgress({location:xa.ProgressLocation.SourceControl},async()=>{let n=await this._getChanges(e);if(this._logger.info(`Changes (before context exclusion): ${n.length} file(s)`),n.length===0){xa.window.showInformationMessage(xa.l10n.t("Cannot generate a commit message because there are no changes."));return}let o=await this._applyContentExclusion(n);if(this._logger.info(`Changes (after context exclusion): ${o.length} file(s)`),o.length===0){xa.window.showInformationMessage(xa.l10n.t("Cannot generate a commit message because the changes were excluded from the context due to content exclusion rules."));return}let s=this._getAttemptCount(e,o),a=await this._getRecentCommitMessages(e),u=await new J7(this.accessor).generateGitCommitMessage(o,a,s,r);if(u&&e.state.HEAD&&e.state.HEAD.commit){let l=this._commitMessages.get(e.rootUri.toString())??new Map;l.set(e.state.HEAD.commit,{attemptCount:s,changes:o,message:u}),this._commitMessages.set(e.rootUri.toString(),l)}return u})}getRepository(e){return this._gitExtensionApi?this._gitExtensionApi.repositories.length===1?this._gitExtensionApi.repositories[0]:(e=e??xa.window.activeTextEditor?.document.uri,e?this._gitExtensionApi.getRepository(e):null):null}async _applyContentExclusion(e){let r=[],n=this.accessor.get(De);for(let o of e){if(o.originalUri===void 0&&o.modifiedUri===void 0){this._logger.info("Ignoring change due to missing originalUri and modifiedUri.");continue}if(o.originalUri&&await n.isCopilotIgnored(o.originalUri)){this._logger.info(`Ignoring change due to content exclusion rule based on originalUri: ${o.originalUri.toString()}`);continue}if(o.modifiedUri&&o.modifiedUri!==o.originalUri&&await n.isCopilotIgnored(o.modifiedUri)){this._logger.info(`Ignoring change due to content exclusion rule based on modifiedUri: ${o.modifiedUri.toString()}`);continue}r.push(o.diff)}return r}_getAttemptCount(e,r){let o=this._commitMessages.get(e.rootUri.toString())?.get(e.state.HEAD?.commit??"");if(!o||o.changes.length!==r.length)return 0;for(let s=0;s<r.length;s++)if(o.changes[s]!==r[s])return 0;return o.attemptCount+1}async _getChanges(e){let r=await e.diff(!0);if(r!=="")return this._parseGitDiff(e,r);let n=await e.diff(),o=this._parseGitDiff(e,n);return o.push(...await this._getUntrackedChanges(e)),o}async _getRecentCommitMessages(e){let r=[],n=[];try{let o=await e.log({maxEntries:10});r.push(...o.map(c=>c.message));let s=await e.getConfig("user.name")??await e.getGlobalConfig("user.name"),a=await e.log({maxEntries:10,author:s});n.push(...a.map(c=>c.message))}catch{}return{repository:r,user:n}}async _getUntrackedChanges(e){let r=[];for(let n of e.state.workingTreeChanges.filter(o=>o.status===7))r.push({modifiedUri:n.uri,diff:await this._getUntrackedChangePatch(e,n.uri)});for(let n of e.state.untrackedChanges??[])r.push({modifiedUri:n.uri,diff:await this._getUntrackedChangePatch(e,n.uri)});return r}async _getUntrackedChangePatch(e,r){this._logger.info(`Generating patch file for untracked file: ${r.toString()}`);let n=[];try{let o=await xa.workspace.fs.readFile(r),s=PA.relative(e.rootUri.fsPath,r.fsPath);n.push(`diff --git a/${s} b/${s}`),n.push("--- /dev/null",`+++ b/${s}`),n.push(`@@ -0,0 +1,${o.length} @@`),n.push(...o.toString().split(`
`).map(a=>`+${a}`))}catch(o){this._logger.error(`Failed to generate patch file for untracked file: ${r.toString()}`,o)}return n.join(`
`)}_parseGitDiff(e,r){let n=[],o=u=>{let l=/^---\s(.*)\n\+\+\+\s(.*)$/m.exec(u);if(!l||l.length!==3)return{originalUri:void 0,modifiedUri:void 0};let d=l[1]==="/dev/null"?void 0:xa.Uri.file(PA.join(e.rootUri.fsPath,l[1].substring(2))),p=l[2]==="/dev/null"?void 0:xa.Uri.file(PA.join(e.rootUri.fsPath,l[2].substring(2)));return{originalUri:d,modifiedUri:p}},s=0,a,c=/^diff --git a\/(.+?) b\/(.+?)$/gm;do{if(a=c.exec(r),a===null)break;if(s<a.index){let u=r.substring(s,a.index),{originalUri:l,modifiedUri:d}=o(u);n.push({diff:u,originalUri:l,modifiedUri:d})}s=a.index}while(!0);if(s<r.length){let u=r.substring(s),{originalUri:l,modifiedUri:d}=o(u);n.push({diff:u,originalUri:l,modifiedUri:d})}return n}_onDidOpenRepository(e){typeof e.onDidCommit!==void 0&&this._repositoryDisposables.set(e,e.onDidCommit(()=>this._onDidCommit(e),this))}_onDidCloseRepository(e){this._repositoryDisposables.deleteAndDispose(e),this._commitMessages.delete(e.rootUri.toString())}async _onDidCommit(e){let r=e.state.HEAD;if(!r?.commit)return;let n=this._commitMessages.get(e.rootUri.toString());if(!n)return;let o=await e.getCommit(r.commit),s=o.parents.length>0?o.parents[0]:"",a=n.get(s);if(!a)return;let c=Gw(o.message,a.message);this.accessor.get(me).sendMSFTTelemetryEvent("git.generateCommitMessageSurvival",void 0,{attemptCount:a.attemptCount,survivalRateFourGram:c}),n.delete(s),this._commitMessages.set(e.rootUri.toString(),n)}dispose(){this._repositoryDisposables.dispose(),this._disposables.dispose()}};ET=O([x(0,je)],ET);var fDe=require("vscode");var TT=class{constructor(e,r){this._chatVariableService=e,this._fsService=r}async resolveVariablesInPrompt(e,r){let n=[];for(let o of r){let s=o.value;if(s instanceof fDe.Uri){let c=(await this._fsService.readFile(s)).toString().replace(/\r/g,"");s=gi("",c)}let a=this._chatVariableService.getVariable(o.name);n.push({kind:a?.kind??"variable",userMessages:[Yct(o.name)+s]}),o.range&&(e=e.slice(0,o.range[0])+`[#${o.name}](#${o.name}-context)`+e.slice(o.range[1]))}return{parts:n,message:e}}};TT=O([x(0,ag),x(1,zr)],TT);function Yct(t){return`# ${t.toUpperCase()} CONTEXT
`}async function hDe(t,e,r){let n=e.extensionMode===_0.ExtensionMode.Test;t.define(ye,new A3),t.define(pg,new _O),t.define(CS,new lO),t.define(id,new yD),t.define(Y1,new D3),t.define(N3,new L3),t.define(Jx,new q3),t.define(Rt,new H3),t.define(zr,new j3),t.define(sle,new IO),t.define(w3,new z3),t.define(s1,new K3),t.define(uO,new Y3),t.define(n5,new r5),t.define(kt,new a5),t.define(eo,new M7),t.define(su,new q7),t.define(dr,new UD),t.define(cO,n?new aO:new Q3),t.define(ar,e),t.define(GO,new $3),t.define(rf,new H7),t.define(Sn,{_serviceBrand:void 0,maxResponseTokens:void 0,temperature:.1,topP:1,additionalPromptContext:t.get(ye).getConfig(fe.ConversationAdditionalPromptContext),rejectionMessage:_0.l10n.t("Sorry, but I can only assist with programming related questions.")}),t.define(rh,new Be(MS)),t.define(ue,new Be(Xp,[[new hD,new gD(r)]])),t.define(E3,new Be(lI)),t.define(R3,Qfe(t)),t.define($r,new Be(bI)),t.define(yn,new Be(gI)),t.define(bD,new Be(H_)),t.define(IS,new Be(SS));let o=e.extension.packageJSON.internalAIKey??"",s=e.extension.packageJSON.ariaKey??"";n?(await mDe(t,e,o,s,"copilot-test",!0),t.define(iw,zue(t.get(te)))):(await mDe(t,e,o,s,e.extension.packageJSON.name,_0.env.isTelemetryEnabled),t.define(iw,new Be(RS))),t.define(Nt,new Be(Q_,[!0])),t.define(Le,new Be(IT)),t.define(mt,new Be(xI,[!0])),t.define(Da,new Be(e1)),t.define(De,new Be(B0)),t.define(Fo,new Be(hI)),t.define(Z0,new Be(Mx)),t.define(vl,new Be(qx)),t.define(Vh,new Be(t1)),t.define(ag,new Be(_S)),t.define(vL,new Be(o5)),t.define(yL,new Be(s5)),t.define(Dh,new Be(mf)),t.define(Kc,new Be(Py)),t.define(tO,new Be(pS)),t.define(nh,new Be(CI)),t.define(es,new Be(vI)),t.define(XD,new Be(ET)),t.define(go,new Be(Iu)),t.define(lu,new Be(yI)),t.define(C4,new Be(xS)),t.define(KD,new Be(CT)),t.define(vo,new Be(II)),t.define(bo,new Be(V3)),t.define(Ai,new Be(G3)),t.define(s4,new Be(P3)),t.define(WD,new Be(xT)),t.define(I1,new Be(S1)),t.define(df,new Be(dL)),t.define(Bt,new Be(b0)),t.define(E1,new Be(ST)),t.define(Je,new Be(mT)),t.define(ul,new Be(Z_)),t.define(LR,new Be(bS)),t.define(Oh,new Be(vf,[void 0])),t.define(u4,new Be(F1)),t.define(du,new Be($1)),t.define(U4,new Be(Q1)),t.define(bO,new Be(TT)),t.define($D,new Be(W_)),t.define(E4,new Be(G1)),t.define(gO,new Be(hO)),t.define(NS,new Be(DS)),t.define(Xx,new Be(Qx))}async function Qct(t,e){if(_0.ExtensionMode.Production===e.extensionMode){let r=t.get(me),n=await twe(e,r,t.get(Rt).isPreRelease());t.define(Ut,n)}else t.define(Ut,new GD)}async function mDe(t,e,r,n,o,s){_0.ExtensionMode.Production===e.extensionMode?t.define(me,new Be(fT,[e.extension.packageJSON.name,r,n,MTe,FTe])):t.define(me,new c5),Qct(t,e)}var Kw=Gc.window.createOutputChannel("GitHub Copilot Chat",{log:!0});async function Xct(t,e){if(t.extensionMode===Gc.ExtensionMode.Test&&!e)return t;if(Gc.l10n.bundle&&AA.config({contents:Gc.l10n.bundle}),t.subscriptions.push(Kw),Gc.chat._version!==1){await Gc.window.showErrorMessage(AA.t("{0} is not compatible with this version of {1}. Please make sure that you have the latest versions of the extension and {1} installed.","GitHub Copilot Chat","VS Code"),AA.t("Show Extension"))&&await Gc.commands.executeCommand("workbench.extensions.action.showExtensionsWithIds",["GitHub.copilot-chat"]);return}let r=await vDe(t);t.subscriptions.push(yDe(r));let n=r.get(me);return r.get(Rt).isProduction()||Jct(),await Zct(r,t),n.sendGHTelemetryEvent("extension.activate"),Gc.ExtensionMode.Test===t.extensionMode?r:{getAPI(s){if(s>KT.version)throw new Error("Invalid Copilot Chat extension API version. Please upgrade Copilot Chat.");return new KT(r)}}}function Jct(){try{require("source-map-support").install(),require("dotenv").config({path:[gDe.resolve(__dirname,"../.env")]})}catch(t){console.error(t)}}async function vDe(t){let e=new lD;return t.subscriptions.push(e),await hDe(e,t,Kw),e.get(De).init(),e.get(U4),e.seal(),e}function yDe(t){return{dispose:async()=>{t.get(me).sendGHTelemetryEvent("extension.deactivate")}}}async function Zct(t,e){let r=t.get(ue).getLogger("contributions"),n=t.get(te),o=[];for(let s of nme){let a;try{if(a=n.invokeFunction(s.create),P_(a)&&e.subscriptions.push(a),a?.activationBlocker){let c=Ws.create(),u=a.id||"UNKNOWN";o.push(a.activationBlocker.finally(()=>{r.info(`activationBlocker from '${u}' took for ${Math.round(c.elapsed())}ms`)}))}}catch(c){r.error(`Error while loading contribution: ${c}`,c)}}await Promise.allSettled(o)}0&&(module.exports={activate,createExtensionContext,onDeactivate,outputChannel});
//!!! DO NOT modify, this file was COPIED from 'microsoft/vscode'
/*! Bundled license information:

@vscode/prompt-tsx/dist/base/util/arrays.js:
  (*!!! DO NOT modify, this file was COPIED from 'microsoft/vscode' *)

@microsoft/applicationinsights-web-snippet/dist/esm/applicationinsights-web-snippet.js:
  (*!
   * Application Insights JavaScript SDK - Web Snippet, 1.0.1
   * Copyright (c) Microsoft and contributors. All rights reserved.
   *)

mime-db/index.js:
  (*!
   * mime-db
   * Copyright(c) 2014 Jonathan Ong
   * Copyright(c) 2015-2022 Douglas Christopher Wilson
   * MIT Licensed
   *)

mime-types/index.js:
  (*!
   * mime-types
   * Copyright(c) 2014 Jonathan Ong
   * Copyright(c) 2015 Douglas Christopher Wilson
   * MIT Licensed
   *)
*/
